<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training</title>
<!--Generated on Wed Sep 25 06:11:40 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2407.21439v2/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#S1" title="In MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#S2" title="In MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#S2.SS1" title="In 2 Related Work ‣ MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Multimodal Large Language Model</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#S2.SS2" title="In 2 Related Work ‣ MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Multimodal Retrieval-augmented Generation</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#S3" title="In MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Methodology</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#S3.SS1" title="In 3 Methodology ‣ MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Preliminaries</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#S3.SS2" title="In 3 Methodology ‣ MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Multimodal Retriever</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#S3.SS3" title="In 3 Methodology ‣ MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Inducing Ranking Ability of MLLMs</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#S3.SS3.SSS0.Px1" title="In 3.3 Inducing Ranking Ability of MLLMs ‣ 3 Methodology ‣ MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_title">Ranking Data Construction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#S3.SS3.SSS0.Px2" title="In 3.3 Inducing Ranking Ability of MLLMs ‣ 3 Methodology ‣ MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_title">Knowledge-enhanced Reranking</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#S3.SS3.SSS0.Px3" title="In 3.3 Inducing Ranking Ability of MLLMs ‣ 3 Methodology ‣ MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_title">Adaptive Threshold</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#S3.SS4" title="In 3 Methodology ‣ MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4 </span>Noise-injected Training</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#S3.SS4.SSS0.Px1" title="In 3.4 Noise-injected Training ‣ 3 Methodology ‣ MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_title">Noise-injected Data Construction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#S3.SS4.SSS0.Px2" title="In 3.4 Noise-injected Training ‣ 3 Methodology ‣ MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_title">Noise-injected Logits Contrasting</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#S4" title="In MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experiments and Analysis</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#S4.SS1" title="In 4 Experiments and Analysis ‣ MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Experiment Setup</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#S4.SS1.SSS0.Px1" title="In 4.1 Experiment Setup ‣ 4 Experiments and Analysis ‣ MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_title">Datasets and Evaluation Metrics</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#S4.SS2" title="In 4 Experiments and Analysis ‣ MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Evaluation on Multimodal Knowledge-seeking</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#S4.SS2.SSS0.Px1" title="In 4.2 Evaluation on Multimodal Knowledge-seeking ‣ 4 Experiments and Analysis ‣ MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_title">Results of Retrieval</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#S4.SS2.SSS0.Px2" title="In 4.2 Evaluation on Multimodal Knowledge-seeking ‣ 4 Experiments and Analysis ‣ MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_title">Generalizabilities of Caption-aware Instruction Tuning</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#S4.SS3" title="In 4 Experiments and Analysis ‣ MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Evaluation on Multimodal Retrieval-augmented Generation</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#S4.SS3.SSS0.Px1" title="In 4.3 Evaluation on Multimodal Retrieval-augmented Generation ‣ 4 Experiments and Analysis ‣ MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_title">Reranking Performance with Thresholds</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#S4.SS3.SSS0.Px2" title="In 4.3 Evaluation on Multimodal Retrieval-augmented Generation ‣ 4 Experiments and Analysis ‣ MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_title">Results of Retrieval-augmented Generation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#S4.SS3.SSS0.Px3" title="In 4.3 Evaluation on Multimodal Retrieval-augmented Generation ‣ 4 Experiments and Analysis ‣ MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_title">Ablation Studies</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#S4.SS4" title="In 4 Experiments and Analysis ‣ MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Qualititive Analysis</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#S5" title="In MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#A1" title="In MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Data Statistics and Evaluation Metrics</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#A2" title="In MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Implementation Details</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#A3" title="In MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C </span>Computational Efficiency</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#A4" title="In MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D </span>Effect of Captions</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#A5" title="In MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">E </span>Performance on Caption-to-image Retrieval</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#A6" title="In MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">F </span>More Evaluations on LLaVA-v1.5-13B</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#A6.SS0.SSS0.Px1" title="In Appendix F More Evaluations on LLaVA-v1.5-13B ‣ MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_title">Low-resource Settings on WebQA</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#A6.SS0.SSS0.Px2" title="In Appendix F More Evaluations on LLaVA-v1.5-13B ‣ MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_title">Reranking Performance with Thresholds</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#A6.SS0.SSS0.Px3" title="In Appendix F More Evaluations on LLaVA-v1.5-13B ‣ MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_title">Results of Retrieval-augmented Generation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#A6.SS0.SSS0.Px4" title="In Appendix F More Evaluations on LLaVA-v1.5-13B ‣ MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_title">Ablation Studies</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#A7" title="In MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">G </span>More Case Studies</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Zhanpeng Chen<sup class="ltx_sup" id="id7.7.id1"><span class="ltx_text ltx_font_italic" id="id7.7.id1.1">21</span></sup><span class="ltx_note ltx_role_footnote" id="footnotex1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Equal contribution.</span></span></span>  Chengjin Xu<sup class="ltx_sup" id="id8.8.id2"><span class="ltx_text ltx_font_italic" id="id8.8.id2.1">1</span></sup><span class="ltx_note ltx_role_footnote" id="footnotex2"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Equal contribution.</span></span></span>  Yiyan Qi<sup class="ltx_sup" id="id9.9.id3">1</sup>  Jian Guo<sup class="ltx_sup" id="id10.10.id4"><span class="ltx_text ltx_font_italic" id="id10.10.id4.1">1</span></sup><span class="ltx_note ltx_role_footnote" id="footnotex3"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>Corresponding author.</span></span></span>
<br class="ltx_break"/><sup class="ltx_sup" id="id11.11.id5">1</sup>IDEA Research, International Digital Economy Academy 
<br class="ltx_break"/><sup class="ltx_sup" id="id12.12.id6">2</sup>Peking University
<br class="ltx_break"/>
</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id13.id1">Multimodal Large Language Models (MLLMs) have demonstrated remarkable capabilities in processing and generating content across multiple data modalities. However, a significant drawback of MLLMs is their reliance on static training data, leading to outdated information and limited contextual awareness. This static nature hampers their ability to provide accurate and up-to-date responses, particularly in dynamic or rapidly evolving contexts. Though integrating Multimodal Retrieval-augmented Generation (Multimodal RAG) offers a promising solution, the system would inevitably encounter the multi-granularity noisy correspondence (MNC) problem, which hinders accurate retrieval and generation. In this work, we propose <span class="ltx_text ltx_font_bold" id="id13.id1.1">RagVL</span>, a novel framework with knowledge-enhanced reranking and noise-injected training, to address these limitations. We instruction-tune the MLLM with a simple yet effective instruction template to induce its ranking ability and serve it as a reranker to precisely filter the top-k retrieved images. For generation, we inject visual noise during training at the data and token levels to enhance the generator’s robustness. Extensive experiments on the subsets of two datasets that require retrieving and reasoning over images to answer a given query verify the effectiveness of our method. Code and models are available at <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/IDEA-FinAI/RagVL" title="">https://github.com/IDEA-FinAI/RagVL</a>.</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para ltx_noindent" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">As an attempt towards Artificial General Intelligence (AGI), Large Language Models (LLMs) have made significant strides in language understanding and human-like text generation <cite class="ltx_cite ltx_citemacro_citep">(Brown et al., <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#bib.bib6" title="">2020</a>; Achiam et al., <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#bib.bib1" title="">2023</a>; Touvron et al., <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#bib.bib41" title="">2023</a>)</cite>. However, true AGI requires more than just linguistic capabilities. It necessitates a comprehensive understanding and interaction with the world, encompassing multiple modalities beyond text. Thus, the recent progress of Multimodal Large Language Models (MLLMs) in handling multimodal information has attracted the community. By processing and generating content across different modalities, MLLMs aim to create a more holistic and nuanced understanding of the world, closer to how humans perceive and interpret information. This integration of modalities enables MLLMs to perform tasks that require contextual understanding from multiple data sources, such as Visual Question Answering (VQA) <cite class="ltx_cite ltx_citemacro_citep">(Goyal et al., <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#bib.bib15" title="">2017</a>; Hudson &amp; Manning, <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#bib.bib21" title="">2019</a>; Marino et al., <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#bib.bib34" title="">2019</a>)</cite>, Table Question Answering <cite class="ltx_cite ltx_citemacro_citep">(Lu et al., <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#bib.bib33" title="">2022</a>)</cite>, Text-to-image Generation <cite class="ltx_cite ltx_citemacro_citep">(Ramesh et al., <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#bib.bib37" title="">2021</a>; Yu et al., <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#bib.bib47" title="">2022</a>; Aghajanyan et al., <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#bib.bib2" title="">2022</a>)</cite>, etc.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Nevertheless, the promising performance of language models primarily relies on the knowledge implicitly stored in their massive parameters, leading to several issues such as long-tail knowledge gaps <cite class="ltx_cite ltx_citemacro_citep">(Asai et al., <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#bib.bib3" title="">2024</a>)</cite>, generating hallucinations <cite class="ltx_cite ltx_citemacro_citep">(Ye &amp; Durrett, <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#bib.bib45" title="">2022</a>)</cite>, and poor model interpretability. To better adapt to knowledge-intensive tasks and real-world scenarios, Retrieval-augmented Language Models (RALM) <cite class="ltx_cite ltx_citemacro_citep">(Lewis et al., <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#bib.bib27" title="">2020</a>; Lin et al., <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#bib.bib30" title="">2023</a>; Izacard &amp; Grave, <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#bib.bib22" title="">2020</a>; Karpukhin et al., <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#bib.bib23" title="">2020</a>)</cite> employ a dense retriever to retrieve up-to-date knowledge from external memories for grounded generation. Similarly, Multimodal Retrieval-augmented Generation (Multimodal RAG) enhances MLLMs by dynamically retrieving relevant information from external multimodal data sources before generation. This allows the models to incorporate real-time, contextually accurate visual information, significantly improving the factuality and accuracy of their outputs.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="302" id="S1.F1.g1" src="x1.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Difference between traditional VQA and multimodal knowledge-seeking question answering. An example from WebQA <cite class="ltx_cite ltx_citemacro_citep">(Chang et al., <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#bib.bib7" title="">2022</a>)</cite> reveals the challenge of multi-granularity noisy correspondence (MNC).</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">As illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_tag">1</span></a>, to answer the information-seeking query, the model must retrieve and reason over external visual knowledge, which differs from traditional VQA on the left and is non-trivial. To solve this, MuRAG <cite class="ltx_cite ltx_citemacro_citep">(Chen et al., <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#bib.bib8" title="">2022</a>)</cite> makes the first endeavor to extend RAG to multiple modalities. It is built upon ViT <cite class="ltx_cite ltx_citemacro_citep">(Dosovitskiy et al., <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#bib.bib11" title="">2020</a>)</cite> and T5 <cite class="ltx_cite ltx_citemacro_citep">(Raffel et al., <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#bib.bib36" title="">2020</a>)</cite> and pre-trained to encode image-text pairs for both answer generation and retrieval. MuRAG embeds items into an external memory and handles queries for retrieving multimodal knowledge from the same memory.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">However, integrating multimodal RAG would inevitably introduce the multi-granularity noisy correspondence problem (MNC) <cite class="ltx_cite ltx_citemacro_citep">(Huang et al., <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#bib.bib20" title="">2021</a>)</cite>. As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_tag">1</span></a>, MNC refers to the noise at two different granularities:
(I) <span class="ltx_text ltx_font_italic" id="S1.p4.1.1">Coarse-grained noise (query-caption)</span>. During the retrieval stage, coarse-grained captions result in retrieving similar but negative images (e.g., <span class="ltx_text ltx_font_italic" id="S1.p4.1.2">‘Uxmal Gobernador Uxmal,Yucatan, Mexico Governer’s Palace, seen from House of the Old Woman’</span> and <span class="ltx_text ltx_font_italic" id="S1.p4.1.3">‘Palacio del Gobernador-Uxmal-Yucatan-Mexico0277 Palace of the Governor in Uxmal’</span>).
(II) <span class="ltx_text ltx_font_italic" id="S1.p4.1.4">Fine-grained noise (query-image)</span>. The retriever and generator must distinguish fine-grained visual elements to formulate the responses. Any discrepancies between the images and the question can introduce noise, thereby compromising the accuracy of the results. In this scenario, the classical CLIP <cite class="ltx_cite ltx_citemacro_citep">(Radford et al., <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#bib.bib35" title="">2021</a>)</cite> struggles to match the query with the image during the retrieval phase (see in Table <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#S4.T1" title="Table 1 ‣ Datasets and Evaluation Metrics ‣ 4.1 Experiment Setup ‣ 4 Experiments and Analysis ‣ MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_tag">1</span></a>). Also, identifying the correct correspondence amidst the fine-grained noise to provide an answer to the query is a challenge.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">To this end, we propose <span class="ltx_text ltx_font_bold" id="S1.p5.1.1">RagVL</span>, a novel framework with knowledge-enhanced reranking and noise-injected training, to mitigate MNC in multimodal RAG. In the retrieval stage, we instruction-tune the MLLM with a simple yet effective instruction template to induce its ranking ability. Given that MLLMs are inherently capable of understanding cross-modal information, we employ the fine-tuned model as a reranker to evaluate the relevance between the query and the image, which precisely selects top-<math alttext="N" class="ltx_Math" display="inline" id="S1.p5.1.m1.1"><semantics id="S1.p5.1.m1.1a"><mi id="S1.p5.1.m1.1.1" xref="S1.p5.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S1.p5.1.m1.1b"><ci id="S1.p5.1.m1.1.1.cmml" xref="S1.p5.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p5.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S1.p5.1.m1.1d">italic_N</annotation></semantics></math> candidates that are more related to the query semantically. Subsequently, we apply an adaptive threshold to filter the candidates, collaborating with the reranker to alleviate the fine-grained mismatches. To further mitigate the impact of fine-grained mismatches during the generation phase, we introduce noise at both data and token levels in the training process. Specifically, at the data level, we perform negative sampling for single-image input questions within the single/multiple-image interleaved dataset, supplementing them with references from hard negative images. At the token level, we introduce additional visual uncertainty to images through Gaussian noise and reassign training loss weights by comparing the logits of the distorted and original inputs.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">In a nutshell, the main contributions of this work are as follows:</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We achieve effective and robust multimodal retrieval-augmented generation with a three-stage pipeline. Additionally, we address the inherent multi-granularity noisy correspondence (MNC) problem in multimodal retrieval-augmented generation.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">We introduce the knowledge-enhanced reranking and noise-injected training technique to mitigate the coarse-grained and fine-grained noise from MNC.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">Extensive experiments on multimodal knowledge-seeking QA and retrieval tasks demonstrate the effectiveness of the proposed framework.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Multimodal Large Language Model</h3>
<div class="ltx_para ltx_noindent" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">Recent advances in Multimodal Large Language Models (MLLMs) have demonstrated impressive performances in handling multi-format information <cite class="ltx_cite ltx_citemacro_citep">(Driess et al., <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#bib.bib13" title="">2023</a>; Huang et al., <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#bib.bib19" title="">2024</a>; Achiam et al., <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#bib.bib1" title="">2023</a>)</cite>. MLLMs are generally built upon existing Large Language Models (LLMs) and integrating visual information as input tokens by utilizing an additional vision encoder (<span class="ltx_text ltx_font_italic" id="S2.SS1.p1.1.1">e.g.</span> CLIP) and a bridging connector (<span class="ltx_text ltx_font_italic" id="S2.SS1.p1.1.2">e.g.</span> MLP). For instance, LLaVA <cite class="ltx_cite ltx_citemacro_citep">(Liu et al., <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#bib.bib32" title="">2024b</a>; <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#bib.bib31" title="">a</a>)</cite> adopts one/two linear MLP to project visual tokens and align the feature dimension with word embeddings, while BLIP-2 <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#bib.bib28" title="">2023</a>)</cite> leverages a group of learnable query tokens to extract information in a query-based manner.
By connecting the visual and textual modalities, MLLMs significantly enhance human-AI interaction and demonstrate remarkable capabilities in understanding and generating multimodal content. Despite these advances, MLLMs tend to underperform in knowledge-intensive tasks (<span class="ltx_text ltx_font_italic" id="S2.SS1.p1.1.3">e.g.</span> WebQA and MultimodalQA <cite class="ltx_cite ltx_citemacro_citep">(Talmor et al., <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#bib.bib39" title="">2021</a>)</cite>) that require seeking up-to-date information. Since the knowledge stored in their massive parameters is currently limited, it is crucial for MLLMs to resort to external memories for grounded generation.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Multimodal Retrieval-augmented Generation</h3>
<div class="ltx_para ltx_noindent" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">Enhancing language models by incorporating relevant information from diverse knowledge sources has been shown to improve performance across various NLP tasks <cite class="ltx_cite ltx_citemacro_citep">(Borgeaud et al., <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#bib.bib5" title="">2022</a>; Lewis et al., <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#bib.bib27" title="">2020</a>)</cite>. DPR <cite class="ltx_cite ltx_citemacro_citep">(Karpukhin et al., <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#bib.bib23" title="">2020</a>)</cite> trains the retriever using in-batch documents and samples negative examples for contrastive learning, allowing the pre-trained retriever to excel in open-domain question answering. REALM <cite class="ltx_cite ltx_citemacro_citep">(Guu et al., <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#bib.bib17" title="">2020</a>)</cite> and RAG <cite class="ltx_cite ltx_citemacro_citep">(Lewis et al., <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#bib.bib27" title="">2020</a>)</cite> treat the retrieved passages as latent variables and train the retriever-generator system jointly, leading to more effective retrieval-augmented generation models. Inspired by textual RAG, Plug-and-play <cite class="ltx_cite ltx_citemacro_citep">(Tiong et al., <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#bib.bib40" title="">2022</a>)</cite> retrieves relevant image patches using GradCAM <cite class="ltx_cite ltx_citemacro_citep">(Selvaraju et al., <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#bib.bib38" title="">2017</a>)</cite> to localize relevant parts based on the query. MuRAG <cite class="ltx_cite ltx_citemacro_citep">(Chen et al., <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#bib.bib8" title="">2022</a>)</cite> proposes the first multimodal retrieval-augmented Transformer, which accesses an external non-parametric multimodal memory to augment language generation. To better connect candidates and model their relations during retrieval, SKURG <cite class="ltx_cite ltx_citemacro_citep">(Yang et al., <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#bib.bib43" title="">2023</a>)</cite> employs an Entity-centered Fusion Encoder to align sources from different modalities and determines the number of retrieval steps adaptively using a unified Retrieval-generation Decoder. However, none of these works specifically focus on MNC in multimodal RAG, which is the primary focus of our research. Experimental results show that the proposed knowledge-enhanced reranking and noise-injected training effectively improves multimodal RAG.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Methodology</h2>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Preliminaries</h3>
<div class="ltx_para ltx_noindent" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.7">The traditional Retrieval-augmented Language Model (RALM) acquires knowledge from the external memory <math alttext="\mathcal{M}" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">\mathcal{M}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">caligraphic_M</annotation></semantics></math> and utilizes the knowledge in grounded outputs to promote accurate and explainable generation. The retriever <math alttext="\mathcal{R}" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.1"><semantics id="S3.SS1.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">ℛ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">ℛ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">\mathcal{R}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.1d">caligraphic_R</annotation></semantics></math> first retrieves the top-<math alttext="K" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.1"><semantics id="S3.SS1.p1.3.m3.1a"><mi id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><ci id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.1d">italic_K</annotation></semantics></math> most relevant contexts <math alttext="\mathcal{C}=\{c_{1},\cdots,c_{k}\}" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m4.3"><semantics id="S3.SS1.p1.4.m4.3a"><mrow id="S3.SS1.p1.4.m4.3.3" xref="S3.SS1.p1.4.m4.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.4.m4.3.3.4" xref="S3.SS1.p1.4.m4.3.3.4.cmml">𝒞</mi><mo id="S3.SS1.p1.4.m4.3.3.3" xref="S3.SS1.p1.4.m4.3.3.3.cmml">=</mo><mrow id="S3.SS1.p1.4.m4.3.3.2.2" xref="S3.SS1.p1.4.m4.3.3.2.3.cmml"><mo id="S3.SS1.p1.4.m4.3.3.2.2.3" stretchy="false" xref="S3.SS1.p1.4.m4.3.3.2.3.cmml">{</mo><msub id="S3.SS1.p1.4.m4.2.2.1.1.1" xref="S3.SS1.p1.4.m4.2.2.1.1.1.cmml"><mi id="S3.SS1.p1.4.m4.2.2.1.1.1.2" xref="S3.SS1.p1.4.m4.2.2.1.1.1.2.cmml">c</mi><mn id="S3.SS1.p1.4.m4.2.2.1.1.1.3" xref="S3.SS1.p1.4.m4.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.4.m4.3.3.2.2.4" xref="S3.SS1.p1.4.m4.3.3.2.3.cmml">,</mo><mi id="S3.SS1.p1.4.m4.1.1" mathvariant="normal" xref="S3.SS1.p1.4.m4.1.1.cmml">⋯</mi><mo id="S3.SS1.p1.4.m4.3.3.2.2.5" xref="S3.SS1.p1.4.m4.3.3.2.3.cmml">,</mo><msub id="S3.SS1.p1.4.m4.3.3.2.2.2" xref="S3.SS1.p1.4.m4.3.3.2.2.2.cmml"><mi id="S3.SS1.p1.4.m4.3.3.2.2.2.2" xref="S3.SS1.p1.4.m4.3.3.2.2.2.2.cmml">c</mi><mi id="S3.SS1.p1.4.m4.3.3.2.2.2.3" xref="S3.SS1.p1.4.m4.3.3.2.2.2.3.cmml">k</mi></msub><mo id="S3.SS1.p1.4.m4.3.3.2.2.6" stretchy="false" xref="S3.SS1.p1.4.m4.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.3b"><apply id="S3.SS1.p1.4.m4.3.3.cmml" xref="S3.SS1.p1.4.m4.3.3"><eq id="S3.SS1.p1.4.m4.3.3.3.cmml" xref="S3.SS1.p1.4.m4.3.3.3"></eq><ci id="S3.SS1.p1.4.m4.3.3.4.cmml" xref="S3.SS1.p1.4.m4.3.3.4">𝒞</ci><set id="S3.SS1.p1.4.m4.3.3.2.3.cmml" xref="S3.SS1.p1.4.m4.3.3.2.2"><apply id="S3.SS1.p1.4.m4.2.2.1.1.1.cmml" xref="S3.SS1.p1.4.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.4.m4.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.4.m4.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.4.m4.2.2.1.1.1.2">𝑐</ci><cn id="S3.SS1.p1.4.m4.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS1.p1.4.m4.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">⋯</ci><apply id="S3.SS1.p1.4.m4.3.3.2.2.2.cmml" xref="S3.SS1.p1.4.m4.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.3.3.2.2.2.1.cmml" xref="S3.SS1.p1.4.m4.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.4.m4.3.3.2.2.2.2.cmml" xref="S3.SS1.p1.4.m4.3.3.2.2.2.2">𝑐</ci><ci id="S3.SS1.p1.4.m4.3.3.2.2.2.3.cmml" xref="S3.SS1.p1.4.m4.3.3.2.2.2.3">𝑘</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.3c">\mathcal{C}=\{c_{1},\cdots,c_{k}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m4.3d">caligraphic_C = { italic_c start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , ⋯ , italic_c start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT }</annotation></semantics></math> from <math alttext="\mathcal{M}" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m5.1"><semantics id="S3.SS1.p1.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><ci id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">\mathcal{M}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m5.1d">caligraphic_M</annotation></semantics></math> for the given question <math alttext="q" class="ltx_Math" display="inline" id="S3.SS1.p1.6.m6.1"><semantics id="S3.SS1.p1.6.m6.1a"><mi id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><ci id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">q</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.6.m6.1d">italic_q</annotation></semantics></math>. Subsequently, the autoregressive language model generates answers based on these retrieved contexts. Under the multimodal setting, the retriever needs to compare the textual queries with the multimodal documents and find the best matches for the generator <math alttext="\mathcal{G}" class="ltx_Math" display="inline" id="S3.SS1.p1.7.m7.1"><semantics id="S3.SS1.p1.7.m7.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><ci id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">\mathcal{G}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.7.m7.1d">caligraphic_G</annotation></semantics></math>. In this paper, we focus on retrieving the visual-related contexts to study open-world multimodal question answering.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Multimodal Retriever</h3>
<div class="ltx_para ltx_noindent" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.10">We follow the dual-encoder architecture based on CLIP text encoder <math alttext="\Phi_{text}" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.1"><semantics id="S3.SS2.p1.1.m1.1a"><msub id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.1.1.2" mathvariant="normal" xref="S3.SS2.p1.1.m1.1.1.2.cmml">Φ</mi><mrow id="S3.SS2.p1.1.m1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.3.cmml"><mi id="S3.SS2.p1.1.m1.1.1.3.2" xref="S3.SS2.p1.1.m1.1.1.3.2.cmml">t</mi><mo id="S3.SS2.p1.1.m1.1.1.3.1" xref="S3.SS2.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.1.m1.1.1.3.3" xref="S3.SS2.p1.1.m1.1.1.3.3.cmml">e</mi><mo id="S3.SS2.p1.1.m1.1.1.3.1a" xref="S3.SS2.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.1.m1.1.1.3.4" xref="S3.SS2.p1.1.m1.1.1.3.4.cmml">x</mi><mo id="S3.SS2.p1.1.m1.1.1.3.1b" xref="S3.SS2.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.1.m1.1.1.3.5" xref="S3.SS2.p1.1.m1.1.1.3.5.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2">Φ</ci><apply id="S3.SS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3"><times id="S3.SS2.p1.1.m1.1.1.3.1.cmml" xref="S3.SS2.p1.1.m1.1.1.3.1"></times><ci id="S3.SS2.p1.1.m1.1.1.3.2.cmml" xref="S3.SS2.p1.1.m1.1.1.3.2">𝑡</ci><ci id="S3.SS2.p1.1.m1.1.1.3.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3.3">𝑒</ci><ci id="S3.SS2.p1.1.m1.1.1.3.4.cmml" xref="S3.SS2.p1.1.m1.1.1.3.4">𝑥</ci><ci id="S3.SS2.p1.1.m1.1.1.3.5.cmml" xref="S3.SS2.p1.1.m1.1.1.3.5">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">\Phi_{text}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.1d">roman_Φ start_POSTSUBSCRIPT italic_t italic_e italic_x italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and image encoder <math alttext="\Phi_{img}" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.1"><semantics id="S3.SS2.p1.2.m2.1a"><msub id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><mi id="S3.SS2.p1.2.m2.1.1.2" mathvariant="normal" xref="S3.SS2.p1.2.m2.1.1.2.cmml">Φ</mi><mrow id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml"><mi id="S3.SS2.p1.2.m2.1.1.3.2" xref="S3.SS2.p1.2.m2.1.1.3.2.cmml">i</mi><mo id="S3.SS2.p1.2.m2.1.1.3.1" xref="S3.SS2.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.2.m2.1.1.3.3" xref="S3.SS2.p1.2.m2.1.1.3.3.cmml">m</mi><mo id="S3.SS2.p1.2.m2.1.1.3.1a" xref="S3.SS2.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.2.m2.1.1.3.4" xref="S3.SS2.p1.2.m2.1.1.3.4.cmml">g</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2">Φ</ci><apply id="S3.SS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3"><times id="S3.SS2.p1.2.m2.1.1.3.1.cmml" xref="S3.SS2.p1.2.m2.1.1.3.1"></times><ci id="S3.SS2.p1.2.m2.1.1.3.2.cmml" xref="S3.SS2.p1.2.m2.1.1.3.2">𝑖</ci><ci id="S3.SS2.p1.2.m2.1.1.3.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3.3">𝑚</ci><ci id="S3.SS2.p1.2.m2.1.1.3.4.cmml" xref="S3.SS2.p1.2.m2.1.1.3.4">𝑔</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">\Phi_{img}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.1d">roman_Φ start_POSTSUBSCRIPT italic_i italic_m italic_g end_POSTSUBSCRIPT</annotation></semantics></math>. Before the retrieval stage, given image-query pairs <math alttext="(v,q)" class="ltx_Math" display="inline" id="S3.SS2.p1.3.m3.2"><semantics id="S3.SS2.p1.3.m3.2a"><mrow id="S3.SS2.p1.3.m3.2.3.2" xref="S3.SS2.p1.3.m3.2.3.1.cmml"><mo id="S3.SS2.p1.3.m3.2.3.2.1" stretchy="false" xref="S3.SS2.p1.3.m3.2.3.1.cmml">(</mo><mi id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml">v</mi><mo id="S3.SS2.p1.3.m3.2.3.2.2" xref="S3.SS2.p1.3.m3.2.3.1.cmml">,</mo><mi id="S3.SS2.p1.3.m3.2.2" xref="S3.SS2.p1.3.m3.2.2.cmml">q</mi><mo id="S3.SS2.p1.3.m3.2.3.2.3" stretchy="false" xref="S3.SS2.p1.3.m3.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.2b"><interval closure="open" id="S3.SS2.p1.3.m3.2.3.1.cmml" xref="S3.SS2.p1.3.m3.2.3.2"><ci id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">𝑣</ci><ci id="S3.SS2.p1.3.m3.2.2.cmml" xref="S3.SS2.p1.3.m3.2.2">𝑞</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.2c">(v,q)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.3.m3.2d">( italic_v , italic_q )</annotation></semantics></math> from the dataset <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S3.SS2.p1.4.m4.1"><semantics id="S3.SS2.p1.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><ci id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.4.m4.1d">caligraphic_D</annotation></semantics></math>, we first apply the image encoder <math alttext="\Phi_{img}" class="ltx_Math" display="inline" id="S3.SS2.p1.5.m5.1"><semantics id="S3.SS2.p1.5.m5.1a"><msub id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml"><mi id="S3.SS2.p1.5.m5.1.1.2" mathvariant="normal" xref="S3.SS2.p1.5.m5.1.1.2.cmml">Φ</mi><mrow id="S3.SS2.p1.5.m5.1.1.3" xref="S3.SS2.p1.5.m5.1.1.3.cmml"><mi id="S3.SS2.p1.5.m5.1.1.3.2" xref="S3.SS2.p1.5.m5.1.1.3.2.cmml">i</mi><mo id="S3.SS2.p1.5.m5.1.1.3.1" xref="S3.SS2.p1.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.5.m5.1.1.3.3" xref="S3.SS2.p1.5.m5.1.1.3.3.cmml">m</mi><mo id="S3.SS2.p1.5.m5.1.1.3.1a" xref="S3.SS2.p1.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.5.m5.1.1.3.4" xref="S3.SS2.p1.5.m5.1.1.3.4.cmml">g</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><apply id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.1.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.p1.5.m5.1.1.2.cmml" xref="S3.SS2.p1.5.m5.1.1.2">Φ</ci><apply id="S3.SS2.p1.5.m5.1.1.3.cmml" xref="S3.SS2.p1.5.m5.1.1.3"><times id="S3.SS2.p1.5.m5.1.1.3.1.cmml" xref="S3.SS2.p1.5.m5.1.1.3.1"></times><ci id="S3.SS2.p1.5.m5.1.1.3.2.cmml" xref="S3.SS2.p1.5.m5.1.1.3.2">𝑖</ci><ci id="S3.SS2.p1.5.m5.1.1.3.3.cmml" xref="S3.SS2.p1.5.m5.1.1.3.3">𝑚</ci><ci id="S3.SS2.p1.5.m5.1.1.3.4.cmml" xref="S3.SS2.p1.5.m5.1.1.3.4">𝑔</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">\Phi_{img}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.5.m5.1d">roman_Φ start_POSTSUBSCRIPT italic_i italic_m italic_g end_POSTSUBSCRIPT</annotation></semantics></math> to encode each image and build the image memory <math alttext="\mathcal{M}" class="ltx_Math" display="inline" id="S3.SS2.p1.6.m6.1"><semantics id="S3.SS2.p1.6.m6.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.1b"><ci id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.1c">\mathcal{M}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.6.m6.1d">caligraphic_M</annotation></semantics></math> using faiss <cite class="ltx_cite ltx_citemacro_citep">(Douze et al., <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#bib.bib12" title="">2024</a>)</cite>. From the external memory <math alttext="\mathcal{M}" class="ltx_Math" display="inline" id="S3.SS2.p1.7.m7.1"><semantics id="S3.SS2.p1.7.m7.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.7.m7.1.1" xref="S3.SS2.p1.7.m7.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m7.1b"><ci id="S3.SS2.p1.7.m7.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m7.1c">\mathcal{M}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.7.m7.1d">caligraphic_M</annotation></semantics></math>, the retriever aims to retrieve a small set of images that support the textual query <math alttext="q" class="ltx_Math" display="inline" id="S3.SS2.p1.8.m8.1"><semantics id="S3.SS2.p1.8.m8.1a"><mi id="S3.SS2.p1.8.m8.1.1" xref="S3.SS2.p1.8.m8.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m8.1b"><ci id="S3.SS2.p1.8.m8.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.8.m8.1c">q</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.8.m8.1d">italic_q</annotation></semantics></math>. Specifically, we encode the query with the text encoder <math alttext="\Phi_{text}" class="ltx_Math" display="inline" id="S3.SS2.p1.9.m9.1"><semantics id="S3.SS2.p1.9.m9.1a"><msub id="S3.SS2.p1.9.m9.1.1" xref="S3.SS2.p1.9.m9.1.1.cmml"><mi id="S3.SS2.p1.9.m9.1.1.2" mathvariant="normal" xref="S3.SS2.p1.9.m9.1.1.2.cmml">Φ</mi><mrow id="S3.SS2.p1.9.m9.1.1.3" xref="S3.SS2.p1.9.m9.1.1.3.cmml"><mi id="S3.SS2.p1.9.m9.1.1.3.2" xref="S3.SS2.p1.9.m9.1.1.3.2.cmml">t</mi><mo id="S3.SS2.p1.9.m9.1.1.3.1" xref="S3.SS2.p1.9.m9.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.9.m9.1.1.3.3" xref="S3.SS2.p1.9.m9.1.1.3.3.cmml">e</mi><mo id="S3.SS2.p1.9.m9.1.1.3.1a" xref="S3.SS2.p1.9.m9.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.9.m9.1.1.3.4" xref="S3.SS2.p1.9.m9.1.1.3.4.cmml">x</mi><mo id="S3.SS2.p1.9.m9.1.1.3.1b" xref="S3.SS2.p1.9.m9.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.9.m9.1.1.3.5" xref="S3.SS2.p1.9.m9.1.1.3.5.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.9.m9.1b"><apply id="S3.SS2.p1.9.m9.1.1.cmml" xref="S3.SS2.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.9.m9.1.1.1.cmml" xref="S3.SS2.p1.9.m9.1.1">subscript</csymbol><ci id="S3.SS2.p1.9.m9.1.1.2.cmml" xref="S3.SS2.p1.9.m9.1.1.2">Φ</ci><apply id="S3.SS2.p1.9.m9.1.1.3.cmml" xref="S3.SS2.p1.9.m9.1.1.3"><times id="S3.SS2.p1.9.m9.1.1.3.1.cmml" xref="S3.SS2.p1.9.m9.1.1.3.1"></times><ci id="S3.SS2.p1.9.m9.1.1.3.2.cmml" xref="S3.SS2.p1.9.m9.1.1.3.2">𝑡</ci><ci id="S3.SS2.p1.9.m9.1.1.3.3.cmml" xref="S3.SS2.p1.9.m9.1.1.3.3">𝑒</ci><ci id="S3.SS2.p1.9.m9.1.1.3.4.cmml" xref="S3.SS2.p1.9.m9.1.1.3.4">𝑥</ci><ci id="S3.SS2.p1.9.m9.1.1.3.5.cmml" xref="S3.SS2.p1.9.m9.1.1.3.5">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.9.m9.1c">\Phi_{text}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.9.m9.1d">roman_Φ start_POSTSUBSCRIPT italic_t italic_e italic_x italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and use MIPS over all of the image candidates <math alttext="v\in\mathcal{M}" class="ltx_Math" display="inline" id="S3.SS2.p1.10.m10.1"><semantics id="S3.SS2.p1.10.m10.1a"><mrow id="S3.SS2.p1.10.m10.1.1" xref="S3.SS2.p1.10.m10.1.1.cmml"><mi id="S3.SS2.p1.10.m10.1.1.2" xref="S3.SS2.p1.10.m10.1.1.2.cmml">v</mi><mo id="S3.SS2.p1.10.m10.1.1.1" xref="S3.SS2.p1.10.m10.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.10.m10.1.1.3" xref="S3.SS2.p1.10.m10.1.1.3.cmml">ℳ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.10.m10.1b"><apply id="S3.SS2.p1.10.m10.1.1.cmml" xref="S3.SS2.p1.10.m10.1.1"><in id="S3.SS2.p1.10.m10.1.1.1.cmml" xref="S3.SS2.p1.10.m10.1.1.1"></in><ci id="S3.SS2.p1.10.m10.1.1.2.cmml" xref="S3.SS2.p1.10.m10.1.1.2">𝑣</ci><ci id="S3.SS2.p1.10.m10.1.1.3.cmml" xref="S3.SS2.p1.10.m10.1.1.3">ℳ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.10.m10.1c">v\in\mathcal{M}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.10.m10.1d">italic_v ∈ caligraphic_M</annotation></semantics></math> as follows,</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{\mathcal{M}}=TopK(\mathcal{M}|q)=\underset{v\in\mathcal{M}}{TopK}\ \ \Phi%
_{text}(q)\cdot\Phi_{img}(v)." class="ltx_Math" display="block" id="S3.E1.m1.3"><semantics id="S3.E1.m1.3a"><mrow id="S3.E1.m1.3.3.1"><mrow id="S3.E1.m1.3.3.1.1.2" xref="S3.E1.m1.3.3.1.1.3.cmml"><mrow id="S3.E1.m1.3.3.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.cmml"><mover accent="true" id="S3.E1.m1.3.3.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.3.3.1.1.1.1.3.2" xref="S3.E1.m1.3.3.1.1.1.1.3.2.cmml">ℳ</mi><mo id="S3.E1.m1.3.3.1.1.1.1.3.1" xref="S3.E1.m1.3.3.1.1.1.1.3.1.cmml">^</mo></mover><mo id="S3.E1.m1.3.3.1.1.1.1.4" xref="S3.E1.m1.3.3.1.1.1.1.4.cmml">=</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.1.3.cmml">T</mi><mo id="S3.E1.m1.3.3.1.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.1.2.cmml">⁢</mo><mi id="S3.E1.m1.3.3.1.1.1.1.1.4" xref="S3.E1.m1.3.3.1.1.1.1.1.4.cmml">o</mi><mo id="S3.E1.m1.3.3.1.1.1.1.1.2a" xref="S3.E1.m1.3.3.1.1.1.1.1.2.cmml">⁢</mo><mi id="S3.E1.m1.3.3.1.1.1.1.1.5" xref="S3.E1.m1.3.3.1.1.1.1.1.5.cmml">p</mi><mo id="S3.E1.m1.3.3.1.1.1.1.1.2b" xref="S3.E1.m1.3.3.1.1.1.1.1.2.cmml">⁢</mo><mi id="S3.E1.m1.3.3.1.1.1.1.1.6" xref="S3.E1.m1.3.3.1.1.1.1.1.6.cmml">K</mi><mo id="S3.E1.m1.3.3.1.1.1.1.1.2c" xref="S3.E1.m1.3.3.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E1.m1.3.3.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">ℳ</mi><mo fence="false" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.3.cmml">q</mi></mrow><mo id="S3.E1.m1.3.3.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.3.3.1.1.1.1.5" xref="S3.E1.m1.3.3.1.1.1.1.5.cmml">=</mo><munder accentunder="true" id="S3.E1.m1.3.3.1.1.1.1.6" xref="S3.E1.m1.3.3.1.1.1.1.6.cmml"><mrow id="S3.E1.m1.3.3.1.1.1.1.6.2" xref="S3.E1.m1.3.3.1.1.1.1.6.2.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.6.2.2" xref="S3.E1.m1.3.3.1.1.1.1.6.2.2.cmml">T</mi><mo id="S3.E1.m1.3.3.1.1.1.1.6.2.1" xref="S3.E1.m1.3.3.1.1.1.1.6.2.1.cmml">⁢</mo><mi id="S3.E1.m1.3.3.1.1.1.1.6.2.3" xref="S3.E1.m1.3.3.1.1.1.1.6.2.3.cmml">o</mi><mo id="S3.E1.m1.3.3.1.1.1.1.6.2.1a" xref="S3.E1.m1.3.3.1.1.1.1.6.2.1.cmml">⁢</mo><mi id="S3.E1.m1.3.3.1.1.1.1.6.2.4" xref="S3.E1.m1.3.3.1.1.1.1.6.2.4.cmml">p</mi><mo id="S3.E1.m1.3.3.1.1.1.1.6.2.1b" xref="S3.E1.m1.3.3.1.1.1.1.6.2.1.cmml">⁢</mo><mi id="S3.E1.m1.3.3.1.1.1.1.6.2.5" xref="S3.E1.m1.3.3.1.1.1.1.6.2.5.cmml">K</mi></mrow><mrow id="S3.E1.m1.3.3.1.1.1.1.6.1" xref="S3.E1.m1.3.3.1.1.1.1.6.1.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.6.1.2" xref="S3.E1.m1.3.3.1.1.1.1.6.1.2.cmml">v</mi><mo id="S3.E1.m1.3.3.1.1.1.1.6.1.1" xref="S3.E1.m1.3.3.1.1.1.1.6.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.3.3.1.1.1.1.6.1.3" xref="S3.E1.m1.3.3.1.1.1.1.6.1.3.cmml">ℳ</mi></mrow></munder></mrow><mspace id="S3.E1.m1.3.3.1.1.2.3" width="1em" xref="S3.E1.m1.3.3.1.1.3a.cmml"></mspace><mrow id="S3.E1.m1.3.3.1.1.2.2" xref="S3.E1.m1.3.3.1.1.2.2.cmml"><mrow id="S3.E1.m1.3.3.1.1.2.2.2" xref="S3.E1.m1.3.3.1.1.2.2.2.cmml"><mrow id="S3.E1.m1.3.3.1.1.2.2.2.2" xref="S3.E1.m1.3.3.1.1.2.2.2.2.cmml"><msub id="S3.E1.m1.3.3.1.1.2.2.2.2.2" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2.cmml"><mi id="S3.E1.m1.3.3.1.1.2.2.2.2.2.2" mathvariant="normal" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.cmml">Φ</mi><mrow id="S3.E1.m1.3.3.1.1.2.2.2.2.2.3" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2.3.cmml"><mi id="S3.E1.m1.3.3.1.1.2.2.2.2.2.3.2" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2.3.2.cmml">t</mi><mo id="S3.E1.m1.3.3.1.1.2.2.2.2.2.3.1" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S3.E1.m1.3.3.1.1.2.2.2.2.2.3.3" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2.3.3.cmml">e</mi><mo id="S3.E1.m1.3.3.1.1.2.2.2.2.2.3.1a" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S3.E1.m1.3.3.1.1.2.2.2.2.2.3.4" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2.3.4.cmml">x</mi><mo id="S3.E1.m1.3.3.1.1.2.2.2.2.2.3.1b" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S3.E1.m1.3.3.1.1.2.2.2.2.2.3.5" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2.3.5.cmml">t</mi></mrow></msub><mo id="S3.E1.m1.3.3.1.1.2.2.2.2.1" xref="S3.E1.m1.3.3.1.1.2.2.2.2.1.cmml">⁢</mo><mrow id="S3.E1.m1.3.3.1.1.2.2.2.2.3.2" xref="S3.E1.m1.3.3.1.1.2.2.2.2.cmml"><mo id="S3.E1.m1.3.3.1.1.2.2.2.2.3.2.1" stretchy="false" xref="S3.E1.m1.3.3.1.1.2.2.2.2.cmml">(</mo><mi id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">q</mi><mo id="S3.E1.m1.3.3.1.1.2.2.2.2.3.2.2" rspace="0.055em" stretchy="false" xref="S3.E1.m1.3.3.1.1.2.2.2.2.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.3.3.1.1.2.2.2.1" rspace="0.222em" xref="S3.E1.m1.3.3.1.1.2.2.2.1.cmml">⋅</mo><msub id="S3.E1.m1.3.3.1.1.2.2.2.3" xref="S3.E1.m1.3.3.1.1.2.2.2.3.cmml"><mi id="S3.E1.m1.3.3.1.1.2.2.2.3.2" mathvariant="normal" xref="S3.E1.m1.3.3.1.1.2.2.2.3.2.cmml">Φ</mi><mrow id="S3.E1.m1.3.3.1.1.2.2.2.3.3" xref="S3.E1.m1.3.3.1.1.2.2.2.3.3.cmml"><mi id="S3.E1.m1.3.3.1.1.2.2.2.3.3.2" xref="S3.E1.m1.3.3.1.1.2.2.2.3.3.2.cmml">i</mi><mo id="S3.E1.m1.3.3.1.1.2.2.2.3.3.1" xref="S3.E1.m1.3.3.1.1.2.2.2.3.3.1.cmml">⁢</mo><mi id="S3.E1.m1.3.3.1.1.2.2.2.3.3.3" xref="S3.E1.m1.3.3.1.1.2.2.2.3.3.3.cmml">m</mi><mo id="S3.E1.m1.3.3.1.1.2.2.2.3.3.1a" xref="S3.E1.m1.3.3.1.1.2.2.2.3.3.1.cmml">⁢</mo><mi id="S3.E1.m1.3.3.1.1.2.2.2.3.3.4" xref="S3.E1.m1.3.3.1.1.2.2.2.3.3.4.cmml">g</mi></mrow></msub></mrow><mo id="S3.E1.m1.3.3.1.1.2.2.1" xref="S3.E1.m1.3.3.1.1.2.2.1.cmml">⁢</mo><mrow id="S3.E1.m1.3.3.1.1.2.2.3.2" xref="S3.E1.m1.3.3.1.1.2.2.cmml"><mo id="S3.E1.m1.3.3.1.1.2.2.3.2.1" stretchy="false" xref="S3.E1.m1.3.3.1.1.2.2.cmml">(</mo><mi id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml">v</mi><mo id="S3.E1.m1.3.3.1.1.2.2.3.2.2" stretchy="false" xref="S3.E1.m1.3.3.1.1.2.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E1.m1.3.3.1.2" lspace="0em">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.3b"><apply id="S3.E1.m1.3.3.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.3a.cmml" xref="S3.E1.m1.3.3.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E1.m1.3.3.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1"><and id="S3.E1.m1.3.3.1.1.1.1a.cmml" xref="S3.E1.m1.3.3.1.1.1.1"></and><apply id="S3.E1.m1.3.3.1.1.1.1b.cmml" xref="S3.E1.m1.3.3.1.1.1.1"><eq id="S3.E1.m1.3.3.1.1.1.1.4.cmml" xref="S3.E1.m1.3.3.1.1.1.1.4"></eq><apply id="S3.E1.m1.3.3.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3"><ci id="S3.E1.m1.3.3.1.1.1.1.3.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3.1">^</ci><ci id="S3.E1.m1.3.3.1.1.1.1.3.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3.2">ℳ</ci></apply><apply id="S3.E1.m1.3.3.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1"><times id="S3.E1.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.2"></times><ci id="S3.E1.m1.3.3.1.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.3">𝑇</ci><ci id="S3.E1.m1.3.3.1.1.1.1.1.4.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.4">𝑜</ci><ci id="S3.E1.m1.3.3.1.1.1.1.1.5.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.5">𝑝</ci><ci id="S3.E1.m1.3.3.1.1.1.1.1.6.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.6">𝐾</ci><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2">ℳ</ci><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.3">𝑞</ci></apply></apply></apply><apply id="S3.E1.m1.3.3.1.1.1.1c.cmml" xref="S3.E1.m1.3.3.1.1.1.1"><eq id="S3.E1.m1.3.3.1.1.1.1.5.cmml" xref="S3.E1.m1.3.3.1.1.1.1.5"></eq><share href="https://arxiv.org/html/2407.21439v2#S3.E1.m1.3.3.1.1.1.1.1.cmml" id="S3.E1.m1.3.3.1.1.1.1d.cmml" xref="S3.E1.m1.3.3.1.1.1.1"></share><apply id="S3.E1.m1.3.3.1.1.1.1.6.cmml" xref="S3.E1.m1.3.3.1.1.1.1.6"><apply id="S3.E1.m1.3.3.1.1.1.1.6.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.6.1"><in id="S3.E1.m1.3.3.1.1.1.1.6.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.6.1.1"></in><ci id="S3.E1.m1.3.3.1.1.1.1.6.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.6.1.2">𝑣</ci><ci id="S3.E1.m1.3.3.1.1.1.1.6.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.6.1.3">ℳ</ci></apply><apply id="S3.E1.m1.3.3.1.1.1.1.6.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.6.2"><times id="S3.E1.m1.3.3.1.1.1.1.6.2.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.6.2.1"></times><ci id="S3.E1.m1.3.3.1.1.1.1.6.2.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.6.2.2">𝑇</ci><ci id="S3.E1.m1.3.3.1.1.1.1.6.2.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.6.2.3">𝑜</ci><ci id="S3.E1.m1.3.3.1.1.1.1.6.2.4.cmml" xref="S3.E1.m1.3.3.1.1.1.1.6.2.4">𝑝</ci><ci id="S3.E1.m1.3.3.1.1.1.1.6.2.5.cmml" xref="S3.E1.m1.3.3.1.1.1.1.6.2.5">𝐾</ci></apply></apply></apply></apply><apply id="S3.E1.m1.3.3.1.1.2.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2"><times id="S3.E1.m1.3.3.1.1.2.2.1.cmml" xref="S3.E1.m1.3.3.1.1.2.2.1"></times><apply id="S3.E1.m1.3.3.1.1.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2"><ci id="S3.E1.m1.3.3.1.1.2.2.2.1.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.1">⋅</ci><apply id="S3.E1.m1.3.3.1.1.2.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.2"><times id="S3.E1.m1.3.3.1.1.2.2.2.2.1.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.2.1"></times><apply id="S3.E1.m1.3.3.1.1.2.2.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.2.2.2.2.2.1.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2.2">Φ</ci><apply id="S3.E1.m1.3.3.1.1.2.2.2.2.2.3.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2.3"><times id="S3.E1.m1.3.3.1.1.2.2.2.2.2.3.1.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2.3.1"></times><ci id="S3.E1.m1.3.3.1.1.2.2.2.2.2.3.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2.3.2">𝑡</ci><ci id="S3.E1.m1.3.3.1.1.2.2.2.2.2.3.3.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2.3.3">𝑒</ci><ci id="S3.E1.m1.3.3.1.1.2.2.2.2.2.3.4.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2.3.4">𝑥</ci><ci id="S3.E1.m1.3.3.1.1.2.2.2.2.2.3.5.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2.3.5">𝑡</ci></apply></apply><ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">𝑞</ci></apply><apply id="S3.E1.m1.3.3.1.1.2.2.2.3.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.2.2.2.3.1.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.3">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.2.2.2.3.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.3.2">Φ</ci><apply id="S3.E1.m1.3.3.1.1.2.2.2.3.3.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.3.3"><times id="S3.E1.m1.3.3.1.1.2.2.2.3.3.1.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.3.3.1"></times><ci id="S3.E1.m1.3.3.1.1.2.2.2.3.3.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.3.3.2">𝑖</ci><ci id="S3.E1.m1.3.3.1.1.2.2.2.3.3.3.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.3.3.3">𝑚</ci><ci id="S3.E1.m1.3.3.1.1.2.2.2.3.3.4.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.3.3.4">𝑔</ci></apply></apply></apply><ci id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2">𝑣</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.3c">\hat{\mathcal{M}}=TopK(\mathcal{M}|q)=\underset{v\in\mathcal{M}}{TopK}\ \ \Phi%
_{text}(q)\cdot\Phi_{img}(v).</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.3d">over^ start_ARG caligraphic_M end_ARG = italic_T italic_o italic_p italic_K ( caligraphic_M | italic_q ) = start_UNDERACCENT italic_v ∈ caligraphic_M end_UNDERACCENT start_ARG italic_T italic_o italic_p italic_K end_ARG roman_Φ start_POSTSUBSCRIPT italic_t italic_e italic_x italic_t end_POSTSUBSCRIPT ( italic_q ) ⋅ roman_Φ start_POSTSUBSCRIPT italic_i italic_m italic_g end_POSTSUBSCRIPT ( italic_v ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p1.13">The top-<math alttext="K" class="ltx_Math" display="inline" id="S3.SS2.p1.11.m1.1"><semantics id="S3.SS2.p1.11.m1.1a"><mi id="S3.SS2.p1.11.m1.1.1" xref="S3.SS2.p1.11.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.11.m1.1b"><ci id="S3.SS2.p1.11.m1.1.1.cmml" xref="S3.SS2.p1.11.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.11.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.11.m1.1d">italic_K</annotation></semantics></math> images with the highest inner product scores, <span class="ltx_text ltx_font_italic" id="S3.SS2.p1.13.1">i.e.</span> the nearest top-<math alttext="K" class="ltx_Math" display="inline" id="S3.SS2.p1.12.m2.1"><semantics id="S3.SS2.p1.12.m2.1a"><mi id="S3.SS2.p1.12.m2.1.1" xref="S3.SS2.p1.12.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.12.m2.1b"><ci id="S3.SS2.p1.12.m2.1.1.cmml" xref="S3.SS2.p1.12.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.12.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.12.m2.1d">italic_K</annotation></semantics></math> neighbors <math alttext="\hat{\mathcal{M}}=\{v_{1},v_{2},\cdots,v_{k}\}" class="ltx_Math" display="inline" id="S3.SS2.p1.13.m3.4"><semantics id="S3.SS2.p1.13.m3.4a"><mrow id="S3.SS2.p1.13.m3.4.4" xref="S3.SS2.p1.13.m3.4.4.cmml"><mover accent="true" id="S3.SS2.p1.13.m3.4.4.5" xref="S3.SS2.p1.13.m3.4.4.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.13.m3.4.4.5.2" xref="S3.SS2.p1.13.m3.4.4.5.2.cmml">ℳ</mi><mo id="S3.SS2.p1.13.m3.4.4.5.1" xref="S3.SS2.p1.13.m3.4.4.5.1.cmml">^</mo></mover><mo id="S3.SS2.p1.13.m3.4.4.4" xref="S3.SS2.p1.13.m3.4.4.4.cmml">=</mo><mrow id="S3.SS2.p1.13.m3.4.4.3.3" xref="S3.SS2.p1.13.m3.4.4.3.4.cmml"><mo id="S3.SS2.p1.13.m3.4.4.3.3.4" stretchy="false" xref="S3.SS2.p1.13.m3.4.4.3.4.cmml">{</mo><msub id="S3.SS2.p1.13.m3.2.2.1.1.1" xref="S3.SS2.p1.13.m3.2.2.1.1.1.cmml"><mi id="S3.SS2.p1.13.m3.2.2.1.1.1.2" xref="S3.SS2.p1.13.m3.2.2.1.1.1.2.cmml">v</mi><mn id="S3.SS2.p1.13.m3.2.2.1.1.1.3" xref="S3.SS2.p1.13.m3.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.p1.13.m3.4.4.3.3.5" xref="S3.SS2.p1.13.m3.4.4.3.4.cmml">,</mo><msub id="S3.SS2.p1.13.m3.3.3.2.2.2" xref="S3.SS2.p1.13.m3.3.3.2.2.2.cmml"><mi id="S3.SS2.p1.13.m3.3.3.2.2.2.2" xref="S3.SS2.p1.13.m3.3.3.2.2.2.2.cmml">v</mi><mn id="S3.SS2.p1.13.m3.3.3.2.2.2.3" xref="S3.SS2.p1.13.m3.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS2.p1.13.m3.4.4.3.3.6" xref="S3.SS2.p1.13.m3.4.4.3.4.cmml">,</mo><mi id="S3.SS2.p1.13.m3.1.1" mathvariant="normal" xref="S3.SS2.p1.13.m3.1.1.cmml">⋯</mi><mo id="S3.SS2.p1.13.m3.4.4.3.3.7" xref="S3.SS2.p1.13.m3.4.4.3.4.cmml">,</mo><msub id="S3.SS2.p1.13.m3.4.4.3.3.3" xref="S3.SS2.p1.13.m3.4.4.3.3.3.cmml"><mi id="S3.SS2.p1.13.m3.4.4.3.3.3.2" xref="S3.SS2.p1.13.m3.4.4.3.3.3.2.cmml">v</mi><mi id="S3.SS2.p1.13.m3.4.4.3.3.3.3" xref="S3.SS2.p1.13.m3.4.4.3.3.3.3.cmml">k</mi></msub><mo id="S3.SS2.p1.13.m3.4.4.3.3.8" stretchy="false" xref="S3.SS2.p1.13.m3.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.13.m3.4b"><apply id="S3.SS2.p1.13.m3.4.4.cmml" xref="S3.SS2.p1.13.m3.4.4"><eq id="S3.SS2.p1.13.m3.4.4.4.cmml" xref="S3.SS2.p1.13.m3.4.4.4"></eq><apply id="S3.SS2.p1.13.m3.4.4.5.cmml" xref="S3.SS2.p1.13.m3.4.4.5"><ci id="S3.SS2.p1.13.m3.4.4.5.1.cmml" xref="S3.SS2.p1.13.m3.4.4.5.1">^</ci><ci id="S3.SS2.p1.13.m3.4.4.5.2.cmml" xref="S3.SS2.p1.13.m3.4.4.5.2">ℳ</ci></apply><set id="S3.SS2.p1.13.m3.4.4.3.4.cmml" xref="S3.SS2.p1.13.m3.4.4.3.3"><apply id="S3.SS2.p1.13.m3.2.2.1.1.1.cmml" xref="S3.SS2.p1.13.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.13.m3.2.2.1.1.1.1.cmml" xref="S3.SS2.p1.13.m3.2.2.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.13.m3.2.2.1.1.1.2.cmml" xref="S3.SS2.p1.13.m3.2.2.1.1.1.2">𝑣</ci><cn id="S3.SS2.p1.13.m3.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS2.p1.13.m3.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS2.p1.13.m3.3.3.2.2.2.cmml" xref="S3.SS2.p1.13.m3.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.13.m3.3.3.2.2.2.1.cmml" xref="S3.SS2.p1.13.m3.3.3.2.2.2">subscript</csymbol><ci id="S3.SS2.p1.13.m3.3.3.2.2.2.2.cmml" xref="S3.SS2.p1.13.m3.3.3.2.2.2.2">𝑣</ci><cn id="S3.SS2.p1.13.m3.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS2.p1.13.m3.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS2.p1.13.m3.1.1.cmml" xref="S3.SS2.p1.13.m3.1.1">⋯</ci><apply id="S3.SS2.p1.13.m3.4.4.3.3.3.cmml" xref="S3.SS2.p1.13.m3.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p1.13.m3.4.4.3.3.3.1.cmml" xref="S3.SS2.p1.13.m3.4.4.3.3.3">subscript</csymbol><ci id="S3.SS2.p1.13.m3.4.4.3.3.3.2.cmml" xref="S3.SS2.p1.13.m3.4.4.3.3.3.2">𝑣</ci><ci id="S3.SS2.p1.13.m3.4.4.3.3.3.3.cmml" xref="S3.SS2.p1.13.m3.4.4.3.3.3.3">𝑘</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.13.m3.4c">\hat{\mathcal{M}}=\{v_{1},v_{2},\cdots,v_{k}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.13.m3.4d">over^ start_ARG caligraphic_M end_ARG = { italic_v start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_v start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , italic_v start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT }</annotation></semantics></math>, are retrieved as the candidate images for answer generation.</p>
</div>
<figure class="ltx_figure" id="S3.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="323" id="S3.F2.g1" src="x2.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Overview of our proposed RagVL. In the retrieval stage, we utilize the CLIP model and faiss to find the top-<math alttext="K" class="ltx_Math" display="inline" id="S3.F2.5.m1.1"><semantics id="S3.F2.5.m1.1b"><mi id="S3.F2.5.m1.1.1" xref="S3.F2.5.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.F2.5.m1.1c"><ci id="S3.F2.5.m1.1.1.cmml" xref="S3.F2.5.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.5.m1.1d">K</annotation><annotation encoding="application/x-llamapun" id="S3.F2.5.m1.1e">italic_K</annotation></semantics></math> most relevant images through Maximum Inner Product Search (MIPS) <cite class="ltx_cite ltx_citemacro_citep">(Guo et al., <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#bib.bib16" title="">2020</a>)</cite>. Subsequently, the highly similar top-<math alttext="K" class="ltx_Math" display="inline" id="S3.F2.6.m2.1"><semantics id="S3.F2.6.m2.1b"><mi id="S3.F2.6.m2.1.1" xref="S3.F2.6.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.F2.6.m2.1c"><ci id="S3.F2.6.m2.1.1.cmml" xref="S3.F2.6.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.6.m2.1d">K</annotation><annotation encoding="application/x-llamapun" id="S3.F2.6.m2.1e">italic_K</annotation></semantics></math> images are reranked into top-<math alttext="N" class="ltx_Math" display="inline" id="S3.F2.7.m3.1"><semantics id="S3.F2.7.m3.1b"><mi id="S3.F2.7.m3.1.1" xref="S3.F2.7.m3.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.F2.7.m3.1c"><ci id="S3.F2.7.m3.1.1.cmml" xref="S3.F2.7.m3.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.7.m3.1d">N</annotation><annotation encoding="application/x-llamapun" id="S3.F2.7.m3.1e">italic_N</annotation></semantics></math> with the fine-tuned MLLM reranker. Finally, the top-<math alttext="N" class="ltx_Math" display="inline" id="S3.F2.8.m4.1"><semantics id="S3.F2.8.m4.1b"><mi id="S3.F2.8.m4.1.1" xref="S3.F2.8.m4.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.F2.8.m4.1c"><ci id="S3.F2.8.m4.1.1.cmml" xref="S3.F2.8.m4.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.8.m4.1d">N</annotation><annotation encoding="application/x-llamapun" id="S3.F2.8.m4.1e">italic_N</annotation></semantics></math> images are fed into the MLLM generator along with the query for accurate generation.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Inducing Ranking Ability of MLLMs</h3>
<div class="ltx_para ltx_noindent" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">CLIP stands out across a wide range of multimodal representations and retrieval tasks as a powerful and highly transferable model. However, when encountering long-tail distribution or domain-specific terms, CLIP fails to match the proper pairs across text and images. It results in lower accuracy and higher demand of <math alttext="k" class="ltx_Math" display="inline" id="S3.SS3.p1.1.m1.1"><semantics id="S3.SS3.p1.1.m1.1a"><mi id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><ci id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.1.m1.1d">italic_k</annotation></semantics></math> value to increase the recall rate of supporting materials, which is time- and resource-consuming. More importantly, simply aligning different modalities is insufficient for real-time multimodal queries, leading to severe performance degradation in knowledge-intensive situations (see in Table <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#S4.T1" title="Table 1 ‣ Datasets and Evaluation Metrics ‣ 4.1 Experiment Setup ‣ 4 Experiments and Analysis ‣ MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_tag">1</span></a>). To mitigate this, we resort to MLLMs for their capabilities of semantic understanding. In general, MLLMs are pre-trained on vast image-text pairs for feature alignment and fine-tuned on language-image instruction-tuning datasets for instruction following. With this pre-injected multimodal knowledge, they are inherently capable of understanding semantically relevant contents across both visual and textual modalities at a deeper level, while CLIP merely computes similarity between vectors. Therefore, to mitigate the bottleneck challenge of multimodal RAG, we introduce the flexible knowledge-enhanced reranking to induce the ranking ability of MLLMs.</p>
</div>
<section class="ltx_paragraph" id="S3.SS3.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Ranking Data Construction</h4>
<div class="ltx_para ltx_noindent" id="S3.SS3.SSS0.Px1.p1">
<p class="ltx_p" id="S3.SS3.SSS0.Px1.p1.1">To enhance the ranking capability of MLLMs, we construct the instruction-following data based on each multimodal QA dataset. We treat each query and the ground truth images as relevant, while the hard negative images as irrelevant. We construct two types of ranking tasks and require the model to generate ‘Yes’ for the relevant pairs and ‘No’ for the irrelevant pairs. Intuitively, the caption-aware style brings more additional knowledge for the model to distinguish the relevance between the image and query. Therefore, we train the reranker with the caption-aware ranking task. In addition, the instruction tuning for ranking can be either blended into the supervised fine-tuning of downstream tasks or conducted separately. See the details of the instruction template in Table <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#A4.T9" title="Table 9 ‣ Appendix D Effect of Captions ‣ MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_tag">9</span></a>.</p>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS3.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Knowledge-enhanced Reranking</h4>
<div class="ltx_para ltx_noindent" id="S3.SS3.SSS0.Px2.p1">
<p class="ltx_p" id="S3.SS3.SSS0.Px2.p1.3">By simply asking the question “<span class="ltx_text ltx_font_italic" id="S3.SS3.SSS0.Px2.p1.3.1">Based on the image and its caption, is the image relevant to the question? Answer ‘Yes’ or ‘No’</span>.”, we measure the relevance between the image and query with the probability <math alttext="p" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p1.1.m1.1"><semantics id="S3.SS3.SSS0.Px2.p1.1.m1.1a"><mi id="S3.SS3.SSS0.Px2.p1.1.m1.1.1" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.1.m1.1b"><ci id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.1.m1.1c">p</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p1.1.m1.1d">italic_p</annotation></semantics></math> of generating ‘Yes’ calculated from the output logits. Thus, reranking the top-<math alttext="K" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p1.2.m2.1"><semantics id="S3.SS3.SSS0.Px2.p1.2.m2.1a"><mi id="S3.SS3.SSS0.Px2.p1.2.m2.1.1" xref="S3.SS3.SSS0.Px2.p1.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.2.m2.1b"><ci id="S3.SS3.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p1.2.m2.1d">italic_K</annotation></semantics></math> candidates into top-<math alttext="N" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p1.3.m3.1"><semantics id="S3.SS3.SSS0.Px2.p1.3.m3.1a"><mi id="S3.SS3.SSS0.Px2.p1.3.m3.1.1" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.3.m3.1b"><ci id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.3.m3.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p1.3.m3.1d">italic_N</annotation></semantics></math> can be formulated as follows,</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\tilde{\mathcal{M}}=TopN(\hat{\mathcal{M}}|\phi)=\underset{(v,c)\in\hat{%
\mathcal{M}}}{TopN}p_{\phi}(v,c,q)," class="ltx_Math" display="block" id="S3.E2.m1.6"><semantics id="S3.E2.m1.6a"><mrow id="S3.E2.m1.6.6.1" xref="S3.E2.m1.6.6.1.1.cmml"><mrow id="S3.E2.m1.6.6.1.1" xref="S3.E2.m1.6.6.1.1.cmml"><mover accent="true" id="S3.E2.m1.6.6.1.1.3" xref="S3.E2.m1.6.6.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.6.6.1.1.3.2" xref="S3.E2.m1.6.6.1.1.3.2.cmml">ℳ</mi><mo id="S3.E2.m1.6.6.1.1.3.1" xref="S3.E2.m1.6.6.1.1.3.1.cmml">~</mo></mover><mo id="S3.E2.m1.6.6.1.1.4" xref="S3.E2.m1.6.6.1.1.4.cmml">=</mo><mrow id="S3.E2.m1.6.6.1.1.1" xref="S3.E2.m1.6.6.1.1.1.cmml"><mi id="S3.E2.m1.6.6.1.1.1.3" xref="S3.E2.m1.6.6.1.1.1.3.cmml">T</mi><mo id="S3.E2.m1.6.6.1.1.1.2" xref="S3.E2.m1.6.6.1.1.1.2.cmml">⁢</mo><mi id="S3.E2.m1.6.6.1.1.1.4" xref="S3.E2.m1.6.6.1.1.1.4.cmml">o</mi><mo id="S3.E2.m1.6.6.1.1.1.2a" xref="S3.E2.m1.6.6.1.1.1.2.cmml">⁢</mo><mi id="S3.E2.m1.6.6.1.1.1.5" xref="S3.E2.m1.6.6.1.1.1.5.cmml">p</mi><mo id="S3.E2.m1.6.6.1.1.1.2b" xref="S3.E2.m1.6.6.1.1.1.2.cmml">⁢</mo><mi id="S3.E2.m1.6.6.1.1.1.6" xref="S3.E2.m1.6.6.1.1.1.6.cmml">N</mi><mo id="S3.E2.m1.6.6.1.1.1.2c" xref="S3.E2.m1.6.6.1.1.1.2.cmml">⁢</mo><mrow id="S3.E2.m1.6.6.1.1.1.1.1" xref="S3.E2.m1.6.6.1.1.1.1.1.1.cmml"><mo id="S3.E2.m1.6.6.1.1.1.1.1.2" stretchy="false" xref="S3.E2.m1.6.6.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.6.6.1.1.1.1.1.1" xref="S3.E2.m1.6.6.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E2.m1.6.6.1.1.1.1.1.1.2" xref="S3.E2.m1.6.6.1.1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.6.6.1.1.1.1.1.1.2.2" xref="S3.E2.m1.6.6.1.1.1.1.1.1.2.2.cmml">ℳ</mi><mo id="S3.E2.m1.6.6.1.1.1.1.1.1.2.1" xref="S3.E2.m1.6.6.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mo fence="false" id="S3.E2.m1.6.6.1.1.1.1.1.1.1" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.E2.m1.6.6.1.1.1.1.1.1.3" xref="S3.E2.m1.6.6.1.1.1.1.1.1.3.cmml">ϕ</mi></mrow><mo id="S3.E2.m1.6.6.1.1.1.1.1.3" stretchy="false" xref="S3.E2.m1.6.6.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.6.6.1.1.5" xref="S3.E2.m1.6.6.1.1.5.cmml">=</mo><mrow id="S3.E2.m1.6.6.1.1.6" xref="S3.E2.m1.6.6.1.1.6.cmml"><munder accentunder="true" id="S3.E2.m1.2.2" xref="S3.E2.m1.2.2.cmml"><mrow id="S3.E2.m1.2.2.3" xref="S3.E2.m1.2.2.3.cmml"><mi id="S3.E2.m1.2.2.3.2" xref="S3.E2.m1.2.2.3.2.cmml">T</mi><mo id="S3.E2.m1.2.2.3.1" xref="S3.E2.m1.2.2.3.1.cmml">⁢</mo><mi id="S3.E2.m1.2.2.3.3" xref="S3.E2.m1.2.2.3.3.cmml">o</mi><mo id="S3.E2.m1.2.2.3.1a" xref="S3.E2.m1.2.2.3.1.cmml">⁢</mo><mi id="S3.E2.m1.2.2.3.4" xref="S3.E2.m1.2.2.3.4.cmml">p</mi><mo id="S3.E2.m1.2.2.3.1b" xref="S3.E2.m1.2.2.3.1.cmml">⁢</mo><mi id="S3.E2.m1.2.2.3.5" xref="S3.E2.m1.2.2.3.5.cmml">N</mi></mrow><mrow id="S3.E2.m1.2.2.2" xref="S3.E2.m1.2.2.2.cmml"><mrow id="S3.E2.m1.2.2.2.4.2" xref="S3.E2.m1.2.2.2.4.1.cmml"><mo id="S3.E2.m1.2.2.2.4.2.1" stretchy="false" xref="S3.E2.m1.2.2.2.4.1.cmml">(</mo><mi id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml">v</mi><mo id="S3.E2.m1.2.2.2.4.2.2" xref="S3.E2.m1.2.2.2.4.1.cmml">,</mo><mi id="S3.E2.m1.2.2.2.2" xref="S3.E2.m1.2.2.2.2.cmml">c</mi><mo id="S3.E2.m1.2.2.2.4.2.3" stretchy="false" xref="S3.E2.m1.2.2.2.4.1.cmml">)</mo></mrow><mo id="S3.E2.m1.2.2.2.3" xref="S3.E2.m1.2.2.2.3.cmml">∈</mo><mover accent="true" id="S3.E2.m1.2.2.2.5" xref="S3.E2.m1.2.2.2.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.2.2.2.5.2" xref="S3.E2.m1.2.2.2.5.2.cmml">ℳ</mi><mo id="S3.E2.m1.2.2.2.5.1" xref="S3.E2.m1.2.2.2.5.1.cmml">^</mo></mover></mrow></munder><mo id="S3.E2.m1.6.6.1.1.6.1" xref="S3.E2.m1.6.6.1.1.6.1.cmml">⁢</mo><msub id="S3.E2.m1.6.6.1.1.6.2" xref="S3.E2.m1.6.6.1.1.6.2.cmml"><mi id="S3.E2.m1.6.6.1.1.6.2.2" xref="S3.E2.m1.6.6.1.1.6.2.2.cmml">p</mi><mi id="S3.E2.m1.6.6.1.1.6.2.3" xref="S3.E2.m1.6.6.1.1.6.2.3.cmml">ϕ</mi></msub><mo id="S3.E2.m1.6.6.1.1.6.1a" xref="S3.E2.m1.6.6.1.1.6.1.cmml">⁢</mo><mrow id="S3.E2.m1.6.6.1.1.6.3.2" xref="S3.E2.m1.6.6.1.1.6.3.1.cmml"><mo id="S3.E2.m1.6.6.1.1.6.3.2.1" stretchy="false" xref="S3.E2.m1.6.6.1.1.6.3.1.cmml">(</mo><mi id="S3.E2.m1.3.3" xref="S3.E2.m1.3.3.cmml">v</mi><mo id="S3.E2.m1.6.6.1.1.6.3.2.2" xref="S3.E2.m1.6.6.1.1.6.3.1.cmml">,</mo><mi id="S3.E2.m1.4.4" xref="S3.E2.m1.4.4.cmml">c</mi><mo id="S3.E2.m1.6.6.1.1.6.3.2.3" xref="S3.E2.m1.6.6.1.1.6.3.1.cmml">,</mo><mi id="S3.E2.m1.5.5" xref="S3.E2.m1.5.5.cmml">q</mi><mo id="S3.E2.m1.6.6.1.1.6.3.2.4" stretchy="false" xref="S3.E2.m1.6.6.1.1.6.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E2.m1.6.6.1.2" xref="S3.E2.m1.6.6.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.6b"><apply id="S3.E2.m1.6.6.1.1.cmml" xref="S3.E2.m1.6.6.1"><and id="S3.E2.m1.6.6.1.1a.cmml" xref="S3.E2.m1.6.6.1"></and><apply id="S3.E2.m1.6.6.1.1b.cmml" xref="S3.E2.m1.6.6.1"><eq id="S3.E2.m1.6.6.1.1.4.cmml" xref="S3.E2.m1.6.6.1.1.4"></eq><apply id="S3.E2.m1.6.6.1.1.3.cmml" xref="S3.E2.m1.6.6.1.1.3"><ci id="S3.E2.m1.6.6.1.1.3.1.cmml" xref="S3.E2.m1.6.6.1.1.3.1">~</ci><ci id="S3.E2.m1.6.6.1.1.3.2.cmml" xref="S3.E2.m1.6.6.1.1.3.2">ℳ</ci></apply><apply id="S3.E2.m1.6.6.1.1.1.cmml" xref="S3.E2.m1.6.6.1.1.1"><times id="S3.E2.m1.6.6.1.1.1.2.cmml" xref="S3.E2.m1.6.6.1.1.1.2"></times><ci id="S3.E2.m1.6.6.1.1.1.3.cmml" xref="S3.E2.m1.6.6.1.1.1.3">𝑇</ci><ci id="S3.E2.m1.6.6.1.1.1.4.cmml" xref="S3.E2.m1.6.6.1.1.1.4">𝑜</ci><ci id="S3.E2.m1.6.6.1.1.1.5.cmml" xref="S3.E2.m1.6.6.1.1.1.5">𝑝</ci><ci id="S3.E2.m1.6.6.1.1.1.6.cmml" xref="S3.E2.m1.6.6.1.1.1.6">𝑁</ci><apply id="S3.E2.m1.6.6.1.1.1.1.1.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1"><csymbol cd="latexml" id="S3.E2.m1.6.6.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.E2.m1.6.6.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.2"><ci id="S3.E2.m1.6.6.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.2.1">^</ci><ci id="S3.E2.m1.6.6.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.2.2">ℳ</ci></apply><ci id="S3.E2.m1.6.6.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.3">italic-ϕ</ci></apply></apply></apply><apply id="S3.E2.m1.6.6.1.1c.cmml" xref="S3.E2.m1.6.6.1"><eq id="S3.E2.m1.6.6.1.1.5.cmml" xref="S3.E2.m1.6.6.1.1.5"></eq><share href="https://arxiv.org/html/2407.21439v2#S3.E2.m1.6.6.1.1.1.cmml" id="S3.E2.m1.6.6.1.1d.cmml" xref="S3.E2.m1.6.6.1"></share><apply id="S3.E2.m1.6.6.1.1.6.cmml" xref="S3.E2.m1.6.6.1.1.6"><times id="S3.E2.m1.6.6.1.1.6.1.cmml" xref="S3.E2.m1.6.6.1.1.6.1"></times><apply id="S3.E2.m1.2.2.cmml" xref="S3.E2.m1.2.2"><apply id="S3.E2.m1.2.2.2.cmml" xref="S3.E2.m1.2.2.2"><in id="S3.E2.m1.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.3"></in><interval closure="open" id="S3.E2.m1.2.2.2.4.1.cmml" xref="S3.E2.m1.2.2.2.4.2"><ci id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1">𝑣</ci><ci id="S3.E2.m1.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2">𝑐</ci></interval><apply id="S3.E2.m1.2.2.2.5.cmml" xref="S3.E2.m1.2.2.2.5"><ci id="S3.E2.m1.2.2.2.5.1.cmml" xref="S3.E2.m1.2.2.2.5.1">^</ci><ci id="S3.E2.m1.2.2.2.5.2.cmml" xref="S3.E2.m1.2.2.2.5.2">ℳ</ci></apply></apply><apply id="S3.E2.m1.2.2.3.cmml" xref="S3.E2.m1.2.2.3"><times id="S3.E2.m1.2.2.3.1.cmml" xref="S3.E2.m1.2.2.3.1"></times><ci id="S3.E2.m1.2.2.3.2.cmml" xref="S3.E2.m1.2.2.3.2">𝑇</ci><ci id="S3.E2.m1.2.2.3.3.cmml" xref="S3.E2.m1.2.2.3.3">𝑜</ci><ci id="S3.E2.m1.2.2.3.4.cmml" xref="S3.E2.m1.2.2.3.4">𝑝</ci><ci id="S3.E2.m1.2.2.3.5.cmml" xref="S3.E2.m1.2.2.3.5">𝑁</ci></apply></apply><apply id="S3.E2.m1.6.6.1.1.6.2.cmml" xref="S3.E2.m1.6.6.1.1.6.2"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.1.1.6.2.1.cmml" xref="S3.E2.m1.6.6.1.1.6.2">subscript</csymbol><ci id="S3.E2.m1.6.6.1.1.6.2.2.cmml" xref="S3.E2.m1.6.6.1.1.6.2.2">𝑝</ci><ci id="S3.E2.m1.6.6.1.1.6.2.3.cmml" xref="S3.E2.m1.6.6.1.1.6.2.3">italic-ϕ</ci></apply><vector id="S3.E2.m1.6.6.1.1.6.3.1.cmml" xref="S3.E2.m1.6.6.1.1.6.3.2"><ci id="S3.E2.m1.3.3.cmml" xref="S3.E2.m1.3.3">𝑣</ci><ci id="S3.E2.m1.4.4.cmml" xref="S3.E2.m1.4.4">𝑐</ci><ci id="S3.E2.m1.5.5.cmml" xref="S3.E2.m1.5.5">𝑞</ci></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.6c">\tilde{\mathcal{M}}=TopN(\hat{\mathcal{M}}|\phi)=\underset{(v,c)\in\hat{%
\mathcal{M}}}{TopN}p_{\phi}(v,c,q),</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.6d">over~ start_ARG caligraphic_M end_ARG = italic_T italic_o italic_p italic_N ( over^ start_ARG caligraphic_M end_ARG | italic_ϕ ) = start_UNDERACCENT ( italic_v , italic_c ) ∈ over^ start_ARG caligraphic_M end_ARG end_UNDERACCENT start_ARG italic_T italic_o italic_p italic_N end_ARG italic_p start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_v , italic_c , italic_q ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S3.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext='p_{\phi}(v,c,q)=\frac{\exp(logit(y_{1}=\text{``Yes"}|v,c,q))}{\exp(logit(y_{1}%
=\text{``Yes"}|v,c,q))+\exp(logit(y_{1}=\text{``No"}|v,c,q))},' class="ltx_Math" display="block" id="S3.E3.m1.19"><semantics id="S3.E3.m1.19a"><mrow id="S3.E3.m1.19.19.1" xref="S3.E3.m1.19.19.1.1.cmml"><mrow id="S3.E3.m1.19.19.1.1" xref="S3.E3.m1.19.19.1.1.cmml"><mrow id="S3.E3.m1.19.19.1.1.2" xref="S3.E3.m1.19.19.1.1.2.cmml"><msub id="S3.E3.m1.19.19.1.1.2.2" xref="S3.E3.m1.19.19.1.1.2.2.cmml"><mi id="S3.E3.m1.19.19.1.1.2.2.2" xref="S3.E3.m1.19.19.1.1.2.2.2.cmml">p</mi><mi id="S3.E3.m1.19.19.1.1.2.2.3" xref="S3.E3.m1.19.19.1.1.2.2.3.cmml">ϕ</mi></msub><mo id="S3.E3.m1.19.19.1.1.2.1" xref="S3.E3.m1.19.19.1.1.2.1.cmml">⁢</mo><mrow id="S3.E3.m1.19.19.1.1.2.3.2" xref="S3.E3.m1.19.19.1.1.2.3.1.cmml"><mo id="S3.E3.m1.19.19.1.1.2.3.2.1" stretchy="false" xref="S3.E3.m1.19.19.1.1.2.3.1.cmml">(</mo><mi id="S3.E3.m1.16.16" xref="S3.E3.m1.16.16.cmml">v</mi><mo id="S3.E3.m1.19.19.1.1.2.3.2.2" xref="S3.E3.m1.19.19.1.1.2.3.1.cmml">,</mo><mi id="S3.E3.m1.17.17" xref="S3.E3.m1.17.17.cmml">c</mi><mo id="S3.E3.m1.19.19.1.1.2.3.2.3" xref="S3.E3.m1.19.19.1.1.2.3.1.cmml">,</mo><mi id="S3.E3.m1.18.18" xref="S3.E3.m1.18.18.cmml">q</mi><mo id="S3.E3.m1.19.19.1.1.2.3.2.4" stretchy="false" xref="S3.E3.m1.19.19.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.19.19.1.1.1" xref="S3.E3.m1.19.19.1.1.1.cmml">=</mo><mfrac id="S3.E3.m1.15.15" xref="S3.E3.m1.15.15.cmml"><mrow id="S3.E3.m1.5.5.5.5" xref="S3.E3.m1.5.5.5.6.cmml"><mi id="S3.E3.m1.4.4.4.4" xref="S3.E3.m1.4.4.4.4.cmml">exp</mi><mo id="S3.E3.m1.5.5.5.5a" xref="S3.E3.m1.5.5.5.6.cmml">⁡</mo><mrow id="S3.E3.m1.5.5.5.5.1" xref="S3.E3.m1.5.5.5.6.cmml"><mo id="S3.E3.m1.5.5.5.5.1.2" stretchy="false" xref="S3.E3.m1.5.5.5.6.cmml">(</mo><mrow id="S3.E3.m1.5.5.5.5.1.1" xref="S3.E3.m1.5.5.5.5.1.1.cmml"><mi id="S3.E3.m1.5.5.5.5.1.1.3" xref="S3.E3.m1.5.5.5.5.1.1.3.cmml">l</mi><mo id="S3.E3.m1.5.5.5.5.1.1.2" xref="S3.E3.m1.5.5.5.5.1.1.2.cmml">⁢</mo><mi id="S3.E3.m1.5.5.5.5.1.1.4" xref="S3.E3.m1.5.5.5.5.1.1.4.cmml">o</mi><mo id="S3.E3.m1.5.5.5.5.1.1.2a" xref="S3.E3.m1.5.5.5.5.1.1.2.cmml">⁢</mo><mi id="S3.E3.m1.5.5.5.5.1.1.5" xref="S3.E3.m1.5.5.5.5.1.1.5.cmml">g</mi><mo id="S3.E3.m1.5.5.5.5.1.1.2b" xref="S3.E3.m1.5.5.5.5.1.1.2.cmml">⁢</mo><mi id="S3.E3.m1.5.5.5.5.1.1.6" xref="S3.E3.m1.5.5.5.5.1.1.6.cmml">i</mi><mo id="S3.E3.m1.5.5.5.5.1.1.2c" xref="S3.E3.m1.5.5.5.5.1.1.2.cmml">⁢</mo><mi id="S3.E3.m1.5.5.5.5.1.1.7" xref="S3.E3.m1.5.5.5.5.1.1.7.cmml">t</mi><mo id="S3.E3.m1.5.5.5.5.1.1.2d" xref="S3.E3.m1.5.5.5.5.1.1.2.cmml">⁢</mo><mrow id="S3.E3.m1.5.5.5.5.1.1.1.1" xref="S3.E3.m1.5.5.5.5.1.1.1.1.1.cmml"><mo id="S3.E3.m1.5.5.5.5.1.1.1.1.2" stretchy="false" xref="S3.E3.m1.5.5.5.5.1.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.5.5.5.5.1.1.1.1.1" xref="S3.E3.m1.5.5.5.5.1.1.1.1.1.cmml"><msub id="S3.E3.m1.5.5.5.5.1.1.1.1.1.2" xref="S3.E3.m1.5.5.5.5.1.1.1.1.1.2.cmml"><mi id="S3.E3.m1.5.5.5.5.1.1.1.1.1.2.2" xref="S3.E3.m1.5.5.5.5.1.1.1.1.1.2.2.cmml">y</mi><mn id="S3.E3.m1.5.5.5.5.1.1.1.1.1.2.3" xref="S3.E3.m1.5.5.5.5.1.1.1.1.1.2.3.cmml">1</mn></msub><mo id="S3.E3.m1.5.5.5.5.1.1.1.1.1.1" xref="S3.E3.m1.5.5.5.5.1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E3.m1.5.5.5.5.1.1.1.1.1.3" xref="S3.E3.m1.5.5.5.5.1.1.1.1.1.3.cmml"><mtext id="S3.E3.m1.5.5.5.5.1.1.1.1.1.3.2" xref="S3.E3.m1.5.5.5.5.1.1.1.1.1.3.2a.cmml">“Yes”</mtext><mo fence="false" id="S3.E3.m1.5.5.5.5.1.1.1.1.1.3.1" xref="S3.E3.m1.5.5.5.5.1.1.1.1.1.3.1.cmml">|</mo><mrow id="S3.E3.m1.5.5.5.5.1.1.1.1.1.3.3.2" xref="S3.E3.m1.5.5.5.5.1.1.1.1.1.3.3.1.cmml"><mi id="S3.E3.m1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml">v</mi><mo id="S3.E3.m1.5.5.5.5.1.1.1.1.1.3.3.2.1" xref="S3.E3.m1.5.5.5.5.1.1.1.1.1.3.3.1.cmml">,</mo><mi id="S3.E3.m1.2.2.2.2" xref="S3.E3.m1.2.2.2.2.cmml">c</mi><mo id="S3.E3.m1.5.5.5.5.1.1.1.1.1.3.3.2.2" xref="S3.E3.m1.5.5.5.5.1.1.1.1.1.3.3.1.cmml">,</mo><mi id="S3.E3.m1.3.3.3.3" xref="S3.E3.m1.3.3.3.3.cmml">q</mi></mrow></mrow></mrow><mo id="S3.E3.m1.5.5.5.5.1.1.1.1.3" stretchy="false" xref="S3.E3.m1.5.5.5.5.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.5.5.5.5.1.3" stretchy="false" xref="S3.E3.m1.5.5.5.6.cmml">)</mo></mrow></mrow><mrow id="S3.E3.m1.15.15.15" xref="S3.E3.m1.15.15.15.cmml"><mrow id="S3.E3.m1.14.14.14.9.1" xref="S3.E3.m1.14.14.14.9.2.cmml"><mi id="S3.E3.m1.9.9.9.4" xref="S3.E3.m1.9.9.9.4.cmml">exp</mi><mo id="S3.E3.m1.14.14.14.9.1a" xref="S3.E3.m1.14.14.14.9.2.cmml">⁡</mo><mrow id="S3.E3.m1.14.14.14.9.1.1" xref="S3.E3.m1.14.14.14.9.2.cmml"><mo id="S3.E3.m1.14.14.14.9.1.1.2" stretchy="false" xref="S3.E3.m1.14.14.14.9.2.cmml">(</mo><mrow id="S3.E3.m1.14.14.14.9.1.1.1" xref="S3.E3.m1.14.14.14.9.1.1.1.cmml"><mi id="S3.E3.m1.14.14.14.9.1.1.1.3" xref="S3.E3.m1.14.14.14.9.1.1.1.3.cmml">l</mi><mo id="S3.E3.m1.14.14.14.9.1.1.1.2" xref="S3.E3.m1.14.14.14.9.1.1.1.2.cmml">⁢</mo><mi id="S3.E3.m1.14.14.14.9.1.1.1.4" xref="S3.E3.m1.14.14.14.9.1.1.1.4.cmml">o</mi><mo id="S3.E3.m1.14.14.14.9.1.1.1.2a" xref="S3.E3.m1.14.14.14.9.1.1.1.2.cmml">⁢</mo><mi id="S3.E3.m1.14.14.14.9.1.1.1.5" xref="S3.E3.m1.14.14.14.9.1.1.1.5.cmml">g</mi><mo id="S3.E3.m1.14.14.14.9.1.1.1.2b" xref="S3.E3.m1.14.14.14.9.1.1.1.2.cmml">⁢</mo><mi id="S3.E3.m1.14.14.14.9.1.1.1.6" xref="S3.E3.m1.14.14.14.9.1.1.1.6.cmml">i</mi><mo id="S3.E3.m1.14.14.14.9.1.1.1.2c" xref="S3.E3.m1.14.14.14.9.1.1.1.2.cmml">⁢</mo><mi id="S3.E3.m1.14.14.14.9.1.1.1.7" xref="S3.E3.m1.14.14.14.9.1.1.1.7.cmml">t</mi><mo id="S3.E3.m1.14.14.14.9.1.1.1.2d" xref="S3.E3.m1.14.14.14.9.1.1.1.2.cmml">⁢</mo><mrow id="S3.E3.m1.14.14.14.9.1.1.1.1.1" xref="S3.E3.m1.14.14.14.9.1.1.1.1.1.1.cmml"><mo id="S3.E3.m1.14.14.14.9.1.1.1.1.1.2" stretchy="false" xref="S3.E3.m1.14.14.14.9.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.14.14.14.9.1.1.1.1.1.1" xref="S3.E3.m1.14.14.14.9.1.1.1.1.1.1.cmml"><msub id="S3.E3.m1.14.14.14.9.1.1.1.1.1.1.2" xref="S3.E3.m1.14.14.14.9.1.1.1.1.1.1.2.cmml"><mi id="S3.E3.m1.14.14.14.9.1.1.1.1.1.1.2.2" xref="S3.E3.m1.14.14.14.9.1.1.1.1.1.1.2.2.cmml">y</mi><mn id="S3.E3.m1.14.14.14.9.1.1.1.1.1.1.2.3" xref="S3.E3.m1.14.14.14.9.1.1.1.1.1.1.2.3.cmml">1</mn></msub><mo id="S3.E3.m1.14.14.14.9.1.1.1.1.1.1.1" xref="S3.E3.m1.14.14.14.9.1.1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E3.m1.14.14.14.9.1.1.1.1.1.1.3" xref="S3.E3.m1.14.14.14.9.1.1.1.1.1.1.3.cmml"><mtext id="S3.E3.m1.14.14.14.9.1.1.1.1.1.1.3.2" xref="S3.E3.m1.14.14.14.9.1.1.1.1.1.1.3.2a.cmml">“Yes”</mtext><mo fence="false" id="S3.E3.m1.14.14.14.9.1.1.1.1.1.1.3.1" xref="S3.E3.m1.14.14.14.9.1.1.1.1.1.1.3.1.cmml">|</mo><mrow id="S3.E3.m1.14.14.14.9.1.1.1.1.1.1.3.3.2" xref="S3.E3.m1.14.14.14.9.1.1.1.1.1.1.3.3.1.cmml"><mi id="S3.E3.m1.6.6.6.1" xref="S3.E3.m1.6.6.6.1.cmml">v</mi><mo id="S3.E3.m1.14.14.14.9.1.1.1.1.1.1.3.3.2.1" xref="S3.E3.m1.14.14.14.9.1.1.1.1.1.1.3.3.1.cmml">,</mo><mi id="S3.E3.m1.7.7.7.2" xref="S3.E3.m1.7.7.7.2.cmml">c</mi><mo id="S3.E3.m1.14.14.14.9.1.1.1.1.1.1.3.3.2.2" xref="S3.E3.m1.14.14.14.9.1.1.1.1.1.1.3.3.1.cmml">,</mo><mi id="S3.E3.m1.8.8.8.3" xref="S3.E3.m1.8.8.8.3.cmml">q</mi></mrow></mrow></mrow><mo id="S3.E3.m1.14.14.14.9.1.1.1.1.1.3" stretchy="false" xref="S3.E3.m1.14.14.14.9.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.14.14.14.9.1.1.3" stretchy="false" xref="S3.E3.m1.14.14.14.9.2.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.15.15.15.11" xref="S3.E3.m1.15.15.15.11.cmml">+</mo><mrow id="S3.E3.m1.15.15.15.10.1" xref="S3.E3.m1.15.15.15.10.2.cmml"><mi id="S3.E3.m1.13.13.13.8" xref="S3.E3.m1.13.13.13.8.cmml">exp</mi><mo id="S3.E3.m1.15.15.15.10.1a" xref="S3.E3.m1.15.15.15.10.2.cmml">⁡</mo><mrow id="S3.E3.m1.15.15.15.10.1.1" xref="S3.E3.m1.15.15.15.10.2.cmml"><mo id="S3.E3.m1.15.15.15.10.1.1.2" stretchy="false" xref="S3.E3.m1.15.15.15.10.2.cmml">(</mo><mrow id="S3.E3.m1.15.15.15.10.1.1.1" xref="S3.E3.m1.15.15.15.10.1.1.1.cmml"><mi id="S3.E3.m1.15.15.15.10.1.1.1.3" xref="S3.E3.m1.15.15.15.10.1.1.1.3.cmml">l</mi><mo id="S3.E3.m1.15.15.15.10.1.1.1.2" xref="S3.E3.m1.15.15.15.10.1.1.1.2.cmml">⁢</mo><mi id="S3.E3.m1.15.15.15.10.1.1.1.4" xref="S3.E3.m1.15.15.15.10.1.1.1.4.cmml">o</mi><mo id="S3.E3.m1.15.15.15.10.1.1.1.2a" xref="S3.E3.m1.15.15.15.10.1.1.1.2.cmml">⁢</mo><mi id="S3.E3.m1.15.15.15.10.1.1.1.5" xref="S3.E3.m1.15.15.15.10.1.1.1.5.cmml">g</mi><mo id="S3.E3.m1.15.15.15.10.1.1.1.2b" xref="S3.E3.m1.15.15.15.10.1.1.1.2.cmml">⁢</mo><mi id="S3.E3.m1.15.15.15.10.1.1.1.6" xref="S3.E3.m1.15.15.15.10.1.1.1.6.cmml">i</mi><mo id="S3.E3.m1.15.15.15.10.1.1.1.2c" xref="S3.E3.m1.15.15.15.10.1.1.1.2.cmml">⁢</mo><mi id="S3.E3.m1.15.15.15.10.1.1.1.7" xref="S3.E3.m1.15.15.15.10.1.1.1.7.cmml">t</mi><mo id="S3.E3.m1.15.15.15.10.1.1.1.2d" xref="S3.E3.m1.15.15.15.10.1.1.1.2.cmml">⁢</mo><mrow id="S3.E3.m1.15.15.15.10.1.1.1.1.1" xref="S3.E3.m1.15.15.15.10.1.1.1.1.1.1.cmml"><mo id="S3.E3.m1.15.15.15.10.1.1.1.1.1.2" stretchy="false" xref="S3.E3.m1.15.15.15.10.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.15.15.15.10.1.1.1.1.1.1" xref="S3.E3.m1.15.15.15.10.1.1.1.1.1.1.cmml"><msub id="S3.E3.m1.15.15.15.10.1.1.1.1.1.1.2" xref="S3.E3.m1.15.15.15.10.1.1.1.1.1.1.2.cmml"><mi id="S3.E3.m1.15.15.15.10.1.1.1.1.1.1.2.2" xref="S3.E3.m1.15.15.15.10.1.1.1.1.1.1.2.2.cmml">y</mi><mn id="S3.E3.m1.15.15.15.10.1.1.1.1.1.1.2.3" xref="S3.E3.m1.15.15.15.10.1.1.1.1.1.1.2.3.cmml">1</mn></msub><mo id="S3.E3.m1.15.15.15.10.1.1.1.1.1.1.1" xref="S3.E3.m1.15.15.15.10.1.1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E3.m1.15.15.15.10.1.1.1.1.1.1.3" xref="S3.E3.m1.15.15.15.10.1.1.1.1.1.1.3.cmml"><mtext id="S3.E3.m1.15.15.15.10.1.1.1.1.1.1.3.2" xref="S3.E3.m1.15.15.15.10.1.1.1.1.1.1.3.2a.cmml">“No”</mtext><mo fence="false" id="S3.E3.m1.15.15.15.10.1.1.1.1.1.1.3.1" xref="S3.E3.m1.15.15.15.10.1.1.1.1.1.1.3.1.cmml">|</mo><mrow id="S3.E3.m1.15.15.15.10.1.1.1.1.1.1.3.3.2" xref="S3.E3.m1.15.15.15.10.1.1.1.1.1.1.3.3.1.cmml"><mi id="S3.E3.m1.10.10.10.5" xref="S3.E3.m1.10.10.10.5.cmml">v</mi><mo id="S3.E3.m1.15.15.15.10.1.1.1.1.1.1.3.3.2.1" xref="S3.E3.m1.15.15.15.10.1.1.1.1.1.1.3.3.1.cmml">,</mo><mi id="S3.E3.m1.11.11.11.6" xref="S3.E3.m1.11.11.11.6.cmml">c</mi><mo id="S3.E3.m1.15.15.15.10.1.1.1.1.1.1.3.3.2.2" xref="S3.E3.m1.15.15.15.10.1.1.1.1.1.1.3.3.1.cmml">,</mo><mi id="S3.E3.m1.12.12.12.7" xref="S3.E3.m1.12.12.12.7.cmml">q</mi></mrow></mrow></mrow><mo id="S3.E3.m1.15.15.15.10.1.1.1.1.1.3" stretchy="false" xref="S3.E3.m1.15.15.15.10.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.15.15.15.10.1.1.3" stretchy="false" xref="S3.E3.m1.15.15.15.10.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow><mo id="S3.E3.m1.19.19.1.2" xref="S3.E3.m1.19.19.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.19b"><apply id="S3.E3.m1.19.19.1.1.cmml" xref="S3.E3.m1.19.19.1"><eq id="S3.E3.m1.19.19.1.1.1.cmml" xref="S3.E3.m1.19.19.1.1.1"></eq><apply id="S3.E3.m1.19.19.1.1.2.cmml" xref="S3.E3.m1.19.19.1.1.2"><times id="S3.E3.m1.19.19.1.1.2.1.cmml" xref="S3.E3.m1.19.19.1.1.2.1"></times><apply id="S3.E3.m1.19.19.1.1.2.2.cmml" xref="S3.E3.m1.19.19.1.1.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.19.19.1.1.2.2.1.cmml" xref="S3.E3.m1.19.19.1.1.2.2">subscript</csymbol><ci id="S3.E3.m1.19.19.1.1.2.2.2.cmml" xref="S3.E3.m1.19.19.1.1.2.2.2">𝑝</ci><ci id="S3.E3.m1.19.19.1.1.2.2.3.cmml" xref="S3.E3.m1.19.19.1.1.2.2.3">italic-ϕ</ci></apply><vector id="S3.E3.m1.19.19.1.1.2.3.1.cmml" xref="S3.E3.m1.19.19.1.1.2.3.2"><ci id="S3.E3.m1.16.16.cmml" xref="S3.E3.m1.16.16">𝑣</ci><ci id="S3.E3.m1.17.17.cmml" xref="S3.E3.m1.17.17">𝑐</ci><ci id="S3.E3.m1.18.18.cmml" xref="S3.E3.m1.18.18">𝑞</ci></vector></apply><apply id="S3.E3.m1.15.15.cmml" xref="S3.E3.m1.15.15"><divide id="S3.E3.m1.15.15.16.cmml" xref="S3.E3.m1.15.15"></divide><apply id="S3.E3.m1.5.5.5.6.cmml" xref="S3.E3.m1.5.5.5.5"><exp id="S3.E3.m1.4.4.4.4.cmml" xref="S3.E3.m1.4.4.4.4"></exp><apply id="S3.E3.m1.5.5.5.5.1.1.cmml" xref="S3.E3.m1.5.5.5.5.1.1"><times id="S3.E3.m1.5.5.5.5.1.1.2.cmml" xref="S3.E3.m1.5.5.5.5.1.1.2"></times><ci id="S3.E3.m1.5.5.5.5.1.1.3.cmml" xref="S3.E3.m1.5.5.5.5.1.1.3">𝑙</ci><ci id="S3.E3.m1.5.5.5.5.1.1.4.cmml" xref="S3.E3.m1.5.5.5.5.1.1.4">𝑜</ci><ci id="S3.E3.m1.5.5.5.5.1.1.5.cmml" xref="S3.E3.m1.5.5.5.5.1.1.5">𝑔</ci><ci id="S3.E3.m1.5.5.5.5.1.1.6.cmml" xref="S3.E3.m1.5.5.5.5.1.1.6">𝑖</ci><ci id="S3.E3.m1.5.5.5.5.1.1.7.cmml" xref="S3.E3.m1.5.5.5.5.1.1.7">𝑡</ci><apply id="S3.E3.m1.5.5.5.5.1.1.1.1.1.cmml" xref="S3.E3.m1.5.5.5.5.1.1.1.1"><eq id="S3.E3.m1.5.5.5.5.1.1.1.1.1.1.cmml" xref="S3.E3.m1.5.5.5.5.1.1.1.1.1.1"></eq><apply id="S3.E3.m1.5.5.5.5.1.1.1.1.1.2.cmml" xref="S3.E3.m1.5.5.5.5.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.5.5.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.5.5.5.5.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E3.m1.5.5.5.5.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.5.5.5.5.1.1.1.1.1.2.2">𝑦</ci><cn id="S3.E3.m1.5.5.5.5.1.1.1.1.1.2.3.cmml" type="integer" xref="S3.E3.m1.5.5.5.5.1.1.1.1.1.2.3">1</cn></apply><apply id="S3.E3.m1.5.5.5.5.1.1.1.1.1.3.cmml" xref="S3.E3.m1.5.5.5.5.1.1.1.1.1.3"><csymbol cd="latexml" id="S3.E3.m1.5.5.5.5.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.5.5.5.5.1.1.1.1.1.3.1">conditional</csymbol><ci id="S3.E3.m1.5.5.5.5.1.1.1.1.1.3.2a.cmml" xref="S3.E3.m1.5.5.5.5.1.1.1.1.1.3.2"><mtext id="S3.E3.m1.5.5.5.5.1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.5.5.5.5.1.1.1.1.1.3.2">“Yes”</mtext></ci><list id="S3.E3.m1.5.5.5.5.1.1.1.1.1.3.3.1.cmml" xref="S3.E3.m1.5.5.5.5.1.1.1.1.1.3.3.2"><ci id="S3.E3.m1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1">𝑣</ci><ci id="S3.E3.m1.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2">𝑐</ci><ci id="S3.E3.m1.3.3.3.3.cmml" xref="S3.E3.m1.3.3.3.3">𝑞</ci></list></apply></apply></apply></apply><apply id="S3.E3.m1.15.15.15.cmml" xref="S3.E3.m1.15.15.15"><plus id="S3.E3.m1.15.15.15.11.cmml" xref="S3.E3.m1.15.15.15.11"></plus><apply id="S3.E3.m1.14.14.14.9.2.cmml" xref="S3.E3.m1.14.14.14.9.1"><exp id="S3.E3.m1.9.9.9.4.cmml" xref="S3.E3.m1.9.9.9.4"></exp><apply id="S3.E3.m1.14.14.14.9.1.1.1.cmml" xref="S3.E3.m1.14.14.14.9.1.1.1"><times id="S3.E3.m1.14.14.14.9.1.1.1.2.cmml" xref="S3.E3.m1.14.14.14.9.1.1.1.2"></times><ci id="S3.E3.m1.14.14.14.9.1.1.1.3.cmml" xref="S3.E3.m1.14.14.14.9.1.1.1.3">𝑙</ci><ci id="S3.E3.m1.14.14.14.9.1.1.1.4.cmml" xref="S3.E3.m1.14.14.14.9.1.1.1.4">𝑜</ci><ci id="S3.E3.m1.14.14.14.9.1.1.1.5.cmml" xref="S3.E3.m1.14.14.14.9.1.1.1.5">𝑔</ci><ci id="S3.E3.m1.14.14.14.9.1.1.1.6.cmml" xref="S3.E3.m1.14.14.14.9.1.1.1.6">𝑖</ci><ci id="S3.E3.m1.14.14.14.9.1.1.1.7.cmml" xref="S3.E3.m1.14.14.14.9.1.1.1.7">𝑡</ci><apply id="S3.E3.m1.14.14.14.9.1.1.1.1.1.1.cmml" xref="S3.E3.m1.14.14.14.9.1.1.1.1.1"><eq id="S3.E3.m1.14.14.14.9.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.14.14.14.9.1.1.1.1.1.1.1"></eq><apply id="S3.E3.m1.14.14.14.9.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.14.14.14.9.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.14.14.14.9.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.14.14.14.9.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E3.m1.14.14.14.9.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.14.14.14.9.1.1.1.1.1.1.2.2">𝑦</ci><cn id="S3.E3.m1.14.14.14.9.1.1.1.1.1.1.2.3.cmml" type="integer" xref="S3.E3.m1.14.14.14.9.1.1.1.1.1.1.2.3">1</cn></apply><apply id="S3.E3.m1.14.14.14.9.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.14.14.14.9.1.1.1.1.1.1.3"><csymbol cd="latexml" id="S3.E3.m1.14.14.14.9.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.14.14.14.9.1.1.1.1.1.1.3.1">conditional</csymbol><ci id="S3.E3.m1.14.14.14.9.1.1.1.1.1.1.3.2a.cmml" xref="S3.E3.m1.14.14.14.9.1.1.1.1.1.1.3.2"><mtext id="S3.E3.m1.14.14.14.9.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.14.14.14.9.1.1.1.1.1.1.3.2">“Yes”</mtext></ci><list id="S3.E3.m1.14.14.14.9.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E3.m1.14.14.14.9.1.1.1.1.1.1.3.3.2"><ci id="S3.E3.m1.6.6.6.1.cmml" xref="S3.E3.m1.6.6.6.1">𝑣</ci><ci id="S3.E3.m1.7.7.7.2.cmml" xref="S3.E3.m1.7.7.7.2">𝑐</ci><ci id="S3.E3.m1.8.8.8.3.cmml" xref="S3.E3.m1.8.8.8.3">𝑞</ci></list></apply></apply></apply></apply><apply id="S3.E3.m1.15.15.15.10.2.cmml" xref="S3.E3.m1.15.15.15.10.1"><exp id="S3.E3.m1.13.13.13.8.cmml" xref="S3.E3.m1.13.13.13.8"></exp><apply id="S3.E3.m1.15.15.15.10.1.1.1.cmml" xref="S3.E3.m1.15.15.15.10.1.1.1"><times id="S3.E3.m1.15.15.15.10.1.1.1.2.cmml" xref="S3.E3.m1.15.15.15.10.1.1.1.2"></times><ci id="S3.E3.m1.15.15.15.10.1.1.1.3.cmml" xref="S3.E3.m1.15.15.15.10.1.1.1.3">𝑙</ci><ci id="S3.E3.m1.15.15.15.10.1.1.1.4.cmml" xref="S3.E3.m1.15.15.15.10.1.1.1.4">𝑜</ci><ci id="S3.E3.m1.15.15.15.10.1.1.1.5.cmml" xref="S3.E3.m1.15.15.15.10.1.1.1.5">𝑔</ci><ci id="S3.E3.m1.15.15.15.10.1.1.1.6.cmml" xref="S3.E3.m1.15.15.15.10.1.1.1.6">𝑖</ci><ci id="S3.E3.m1.15.15.15.10.1.1.1.7.cmml" xref="S3.E3.m1.15.15.15.10.1.1.1.7">𝑡</ci><apply id="S3.E3.m1.15.15.15.10.1.1.1.1.1.1.cmml" xref="S3.E3.m1.15.15.15.10.1.1.1.1.1"><eq id="S3.E3.m1.15.15.15.10.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.15.15.15.10.1.1.1.1.1.1.1"></eq><apply id="S3.E3.m1.15.15.15.10.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.15.15.15.10.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.15.15.15.10.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.15.15.15.10.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E3.m1.15.15.15.10.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.15.15.15.10.1.1.1.1.1.1.2.2">𝑦</ci><cn id="S3.E3.m1.15.15.15.10.1.1.1.1.1.1.2.3.cmml" type="integer" xref="S3.E3.m1.15.15.15.10.1.1.1.1.1.1.2.3">1</cn></apply><apply id="S3.E3.m1.15.15.15.10.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.15.15.15.10.1.1.1.1.1.1.3"><csymbol cd="latexml" id="S3.E3.m1.15.15.15.10.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.15.15.15.10.1.1.1.1.1.1.3.1">conditional</csymbol><ci id="S3.E3.m1.15.15.15.10.1.1.1.1.1.1.3.2a.cmml" xref="S3.E3.m1.15.15.15.10.1.1.1.1.1.1.3.2"><mtext id="S3.E3.m1.15.15.15.10.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.15.15.15.10.1.1.1.1.1.1.3.2">“No”</mtext></ci><list id="S3.E3.m1.15.15.15.10.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E3.m1.15.15.15.10.1.1.1.1.1.1.3.3.2"><ci id="S3.E3.m1.10.10.10.5.cmml" xref="S3.E3.m1.10.10.10.5">𝑣</ci><ci id="S3.E3.m1.11.11.11.6.cmml" xref="S3.E3.m1.11.11.11.6">𝑐</ci><ci id="S3.E3.m1.12.12.12.7.cmml" xref="S3.E3.m1.12.12.12.7">𝑞</ci></list></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.19c">p_{\phi}(v,c,q)=\frac{\exp(logit(y_{1}=\text{``Yes"}|v,c,q))}{\exp(logit(y_{1}%
=\text{``Yes"}|v,c,q))+\exp(logit(y_{1}=\text{``No"}|v,c,q))},</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.19d">italic_p start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_v , italic_c , italic_q ) = divide start_ARG roman_exp ( italic_l italic_o italic_g italic_i italic_t ( italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = “Yes” | italic_v , italic_c , italic_q ) ) end_ARG start_ARG roman_exp ( italic_l italic_o italic_g italic_i italic_t ( italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = “Yes” | italic_v , italic_c , italic_q ) ) + roman_exp ( italic_l italic_o italic_g italic_i italic_t ( italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = “No” | italic_v , italic_c , italic_q ) ) end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS0.Px2.p1.8">where <math alttext="v" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p1.4.m1.1"><semantics id="S3.SS3.SSS0.Px2.p1.4.m1.1a"><mi id="S3.SS3.SSS0.Px2.p1.4.m1.1.1" xref="S3.SS3.SSS0.Px2.p1.4.m1.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.4.m1.1b"><ci id="S3.SS3.SSS0.Px2.p1.4.m1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.4.m1.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.4.m1.1c">v</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p1.4.m1.1d">italic_v</annotation></semantics></math>, <math alttext="c" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p1.5.m2.1"><semantics id="S3.SS3.SSS0.Px2.p1.5.m2.1a"><mi id="S3.SS3.SSS0.Px2.p1.5.m2.1.1" xref="S3.SS3.SSS0.Px2.p1.5.m2.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.5.m2.1b"><ci id="S3.SS3.SSS0.Px2.p1.5.m2.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.5.m2.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.5.m2.1c">c</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p1.5.m2.1d">italic_c</annotation></semantics></math>, and <math alttext="q" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p1.6.m3.1"><semantics id="S3.SS3.SSS0.Px2.p1.6.m3.1a"><mi id="S3.SS3.SSS0.Px2.p1.6.m3.1.1" xref="S3.SS3.SSS0.Px2.p1.6.m3.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.6.m3.1b"><ci id="S3.SS3.SSS0.Px2.p1.6.m3.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.6.m3.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.6.m3.1c">q</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p1.6.m3.1d">italic_q</annotation></semantics></math> denote the image, corresponding caption, and query, respectively. <math alttext="\phi" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p1.7.m4.1"><semantics id="S3.SS3.SSS0.Px2.p1.7.m4.1a"><mi id="S3.SS3.SSS0.Px2.p1.7.m4.1.1" xref="S3.SS3.SSS0.Px2.p1.7.m4.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.7.m4.1b"><ci id="S3.SS3.SSS0.Px2.p1.7.m4.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.7.m4.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.7.m4.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p1.7.m4.1d">italic_ϕ</annotation></semantics></math> is the weight of the reranker. <math alttext="y_{1}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p1.8.m5.1"><semantics id="S3.SS3.SSS0.Px2.p1.8.m5.1a"><msub id="S3.SS3.SSS0.Px2.p1.8.m5.1.1" xref="S3.SS3.SSS0.Px2.p1.8.m5.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p1.8.m5.1.1.2" xref="S3.SS3.SSS0.Px2.p1.8.m5.1.1.2.cmml">y</mi><mn id="S3.SS3.SSS0.Px2.p1.8.m5.1.1.3" xref="S3.SS3.SSS0.Px2.p1.8.m5.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.8.m5.1b"><apply id="S3.SS3.SSS0.Px2.p1.8.m5.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.8.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.8.m5.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.8.m5.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.8.m5.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.8.m5.1.1.2">𝑦</ci><cn id="S3.SS3.SSS0.Px2.p1.8.m5.1.1.3.cmml" type="integer" xref="S3.SS3.SSS0.Px2.p1.8.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.8.m5.1c">y_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p1.8.m5.1d">italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> denotes the first token in the generated output.</p>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS3.SSS0.Px3">
<h4 class="ltx_title ltx_title_paragraph">Adaptive Threshold</h4>
<div class="ltx_para ltx_noindent" id="S3.SS3.SSS0.Px3.p1">
<p class="ltx_p" id="S3.SS3.SSS0.Px3.p1.4">Since the reranked images might still have low relevance <math alttext="p" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px3.p1.1.m1.1"><semantics id="S3.SS3.SSS0.Px3.p1.1.m1.1a"><mi id="S3.SS3.SSS0.Px3.p1.1.m1.1.1" xref="S3.SS3.SSS0.Px3.p1.1.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px3.p1.1.m1.1b"><ci id="S3.SS3.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS0.Px3.p1.1.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px3.p1.1.m1.1c">p</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px3.p1.1.m1.1d">italic_p</annotation></semantics></math> to the query, they can negatively affect answer generation, potentially performing worse than not including the images. To further improve the retrieval accuracy, we apply an adaptive threshold <math alttext="\eta" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px3.p1.2.m2.1"><semantics id="S3.SS3.SSS0.Px3.p1.2.m2.1a"><mi id="S3.SS3.SSS0.Px3.p1.2.m2.1.1" xref="S3.SS3.SSS0.Px3.p1.2.m2.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px3.p1.2.m2.1b"><ci id="S3.SS3.SSS0.Px3.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS0.Px3.p1.2.m2.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px3.p1.2.m2.1c">\eta</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px3.p1.2.m2.1d">italic_η</annotation></semantics></math> to filter out candidates when <math alttext="p&lt;\eta" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px3.p1.3.m3.1"><semantics id="S3.SS3.SSS0.Px3.p1.3.m3.1a"><mrow id="S3.SS3.SSS0.Px3.p1.3.m3.1.1" xref="S3.SS3.SSS0.Px3.p1.3.m3.1.1.cmml"><mi id="S3.SS3.SSS0.Px3.p1.3.m3.1.1.2" xref="S3.SS3.SSS0.Px3.p1.3.m3.1.1.2.cmml">p</mi><mo id="S3.SS3.SSS0.Px3.p1.3.m3.1.1.1" xref="S3.SS3.SSS0.Px3.p1.3.m3.1.1.1.cmml">&lt;</mo><mi id="S3.SS3.SSS0.Px3.p1.3.m3.1.1.3" xref="S3.SS3.SSS0.Px3.p1.3.m3.1.1.3.cmml">η</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px3.p1.3.m3.1b"><apply id="S3.SS3.SSS0.Px3.p1.3.m3.1.1.cmml" xref="S3.SS3.SSS0.Px3.p1.3.m3.1.1"><lt id="S3.SS3.SSS0.Px3.p1.3.m3.1.1.1.cmml" xref="S3.SS3.SSS0.Px3.p1.3.m3.1.1.1"></lt><ci id="S3.SS3.SSS0.Px3.p1.3.m3.1.1.2.cmml" xref="S3.SS3.SSS0.Px3.p1.3.m3.1.1.2">𝑝</ci><ci id="S3.SS3.SSS0.Px3.p1.3.m3.1.1.3.cmml" xref="S3.SS3.SSS0.Px3.p1.3.m3.1.1.3">𝜂</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px3.p1.3.m3.1c">p&lt;\eta</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px3.p1.3.m3.1d">italic_p &lt; italic_η</annotation></semantics></math>. We set two types of thresholds: the natural threshold and the adaptive threshold. The natural threshold refers to <math alttext="\eta=0.5" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px3.p1.4.m4.1"><semantics id="S3.SS3.SSS0.Px3.p1.4.m4.1a"><mrow id="S3.SS3.SSS0.Px3.p1.4.m4.1.1" xref="S3.SS3.SSS0.Px3.p1.4.m4.1.1.cmml"><mi id="S3.SS3.SSS0.Px3.p1.4.m4.1.1.2" xref="S3.SS3.SSS0.Px3.p1.4.m4.1.1.2.cmml">η</mi><mo id="S3.SS3.SSS0.Px3.p1.4.m4.1.1.1" xref="S3.SS3.SSS0.Px3.p1.4.m4.1.1.1.cmml">=</mo><mn id="S3.SS3.SSS0.Px3.p1.4.m4.1.1.3" xref="S3.SS3.SSS0.Px3.p1.4.m4.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px3.p1.4.m4.1b"><apply id="S3.SS3.SSS0.Px3.p1.4.m4.1.1.cmml" xref="S3.SS3.SSS0.Px3.p1.4.m4.1.1"><eq id="S3.SS3.SSS0.Px3.p1.4.m4.1.1.1.cmml" xref="S3.SS3.SSS0.Px3.p1.4.m4.1.1.1"></eq><ci id="S3.SS3.SSS0.Px3.p1.4.m4.1.1.2.cmml" xref="S3.SS3.SSS0.Px3.p1.4.m4.1.1.2">𝜂</ci><cn id="S3.SS3.SSS0.Px3.p1.4.m4.1.1.3.cmml" type="float" xref="S3.SS3.SSS0.Px3.p1.4.m4.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px3.p1.4.m4.1c">\eta=0.5</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px3.p1.4.m4.1d">italic_η = 0.5</annotation></semantics></math>, which is the natural boundary for our binary classification ranking. For more precise retrieval, we experiment on the validation set and utilize the intersection point of the interpolated curve of exact match and mismatch as the adaptive threshold. In this way, the model can avoid the distraction from irrelevant images. By forcing the MLLM to jointly consider the query, caption, and image, the simple yet effective question template stimulates and enhances the model’s ranking ability with multimodal knowledge, thereby supporting the trustworthy generation.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Noise-injected Training</h3>
<div class="ltx_para ltx_noindent" id="S3.SS4.p1">
<p class="ltx_p" id="S3.SS4.p1.1">Compared to providing a fixed number of images each time, the task with single/multiple images interleaved is more aligned with real-world scenarios. However, it also presents challenges in determining the optimal number of images to provide each time and in extracting relevant information rather than distracting information from the provided images. Though the reranker performs well in selecting relevant images, irrelevant ones still inevitably disturb the accurate generation.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS4.p2">
<p class="ltx_p" id="S3.SS4.p2.1">Inspired by VCD <cite class="ltx_cite ltx_citemacro_citep">(Leng et al., <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#bib.bib26" title="">2024</a>)</cite>, visual uncertainty amplifies language priors, and contrasting the logits obtained from the enhanced language priors with the original logits can better highlight visual relevance. In light of this, we propose enhancing the model’s robustness by injecting visual noise during training, both at the data level and token level:
(I) For single-image/multi-image interleaved datasets, we sample randomly from the hard negatives to ensure that each instruction-following data has the same amount of image input.
(II) We introduce additional visual uncertainty by applying a Gaussian noise mask and contrasting the logits to reweight the loss for each token.</p>
</div>
<section class="ltx_paragraph" id="S3.SS4.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Noise-injected Data Construction</h4>
<div class="ltx_para ltx_noindent" id="S3.SS4.SSS0.Px1.p1">
<p class="ltx_p" id="S3.SS4.SSS0.Px1.p1.1">For datasets that may require both single and multiple image inputs, we standardize the number of image inputs for each sample in the instruction-following data to the maximum number needed for any question. In the case of WebQA, where each question requires 1-2 images for answering, we randomly sample 1 image from the hard negatives as an injected noise for the single-image query. The model is required to distinguish between relevant and irrelevant visual information, which strengthens its capability of visual understanding.</p>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS4.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Noise-injected Logits Contrasting</h4>
<div class="ltx_para ltx_noindent" id="S3.SS4.SSS0.Px2.p1">
<p class="ltx_p" id="S3.SS4.SSS0.Px2.p1.18">Although injecting noise into the dataset can help the model better adapt to noisy environments, it can also be a double-edged sword, making the training process more unpredictable. Instead of the simple Maximum Likelihood Estimation (MLE) loss, we need a more robust objective <cite class="ltx_cite ltx_citemacro_citep">(Xiao et al., <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#bib.bib42" title="">2024</a>)</cite> to guide the model to learn the correlation between visual tokens and textual (query) tokens accurately. Thus, we resort to reweight the training loss and first employ the forward diffusion process <cite class="ltx_cite ltx_citemacro_citep">(Ho et al., <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#bib.bib18" title="">2020</a>)</cite> to distort the image:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="f\left(v_{t}\mid v_{t-1}\right)=\mathcal{N}\left(v_{t};\sqrt{1-\gamma}v_{t-1},%
\gamma\mathbf{I}\right),\ f\left(v_{T}\mid v_{0}\right)=\prod_{t=1}^{T}f\left(%
v_{t}\mid v_{t-1}\right)," class="ltx_Math" display="block" id="S3.E4.m1.1"><semantics id="S3.E4.m1.1a"><mrow id="S3.E4.m1.1.1.1"><mrow id="S3.E4.m1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.3.cmml"><mrow id="S3.E4.m1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.cmml"><mrow id="S3.E4.m1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.1.1.3.cmml">f</mi><mo id="S3.E4.m1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E4.m1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E4.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">v</mi><mi id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">∣</mo><msub id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">v</mi><mrow id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.3.3.1" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.E4.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.1.1.1.1.1.1.5" xref="S3.E4.m1.1.1.1.1.1.1.5.cmml">=</mo><mrow id="S3.E4.m1.1.1.1.1.1.1.4" xref="S3.E4.m1.1.1.1.1.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.1.1.1.1.1.1.4.5" xref="S3.E4.m1.1.1.1.1.1.1.4.5.cmml">𝒩</mi><mo id="S3.E4.m1.1.1.1.1.1.1.4.4" xref="S3.E4.m1.1.1.1.1.1.1.4.4.cmml">⁢</mo><mrow id="S3.E4.m1.1.1.1.1.1.1.4.3.3" xref="S3.E4.m1.1.1.1.1.1.1.4.3.4.cmml"><mo id="S3.E4.m1.1.1.1.1.1.1.4.3.3.4" xref="S3.E4.m1.1.1.1.1.1.1.4.3.4.cmml">(</mo><msub id="S3.E4.m1.1.1.1.1.1.1.2.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.2.1.1.1.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1.2.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.1.2.1.1.1.2.cmml">v</mi><mi id="S3.E4.m1.1.1.1.1.1.1.2.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.1.2.1.1.1.3.cmml">t</mi></msub><mo id="S3.E4.m1.1.1.1.1.1.1.4.3.3.5" xref="S3.E4.m1.1.1.1.1.1.1.4.3.4.cmml">;</mo><mrow id="S3.E4.m1.1.1.1.1.1.1.3.2.2.2" xref="S3.E4.m1.1.1.1.1.1.1.3.2.2.2.cmml"><msqrt id="S3.E4.m1.1.1.1.1.1.1.3.2.2.2.2" xref="S3.E4.m1.1.1.1.1.1.1.3.2.2.2.2.cmml"><mrow id="S3.E4.m1.1.1.1.1.1.1.3.2.2.2.2.2" xref="S3.E4.m1.1.1.1.1.1.1.3.2.2.2.2.2.cmml"><mn id="S3.E4.m1.1.1.1.1.1.1.3.2.2.2.2.2.2" xref="S3.E4.m1.1.1.1.1.1.1.3.2.2.2.2.2.2.cmml">1</mn><mo id="S3.E4.m1.1.1.1.1.1.1.3.2.2.2.2.2.1" xref="S3.E4.m1.1.1.1.1.1.1.3.2.2.2.2.2.1.cmml">−</mo><mi id="S3.E4.m1.1.1.1.1.1.1.3.2.2.2.2.2.3" xref="S3.E4.m1.1.1.1.1.1.1.3.2.2.2.2.2.3.cmml">γ</mi></mrow></msqrt><mo id="S3.E4.m1.1.1.1.1.1.1.3.2.2.2.1" xref="S3.E4.m1.1.1.1.1.1.1.3.2.2.2.1.cmml">⁢</mo><msub id="S3.E4.m1.1.1.1.1.1.1.3.2.2.2.3" xref="S3.E4.m1.1.1.1.1.1.1.3.2.2.2.3.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1.3.2.2.2.3.2" xref="S3.E4.m1.1.1.1.1.1.1.3.2.2.2.3.2.cmml">v</mi><mrow id="S3.E4.m1.1.1.1.1.1.1.3.2.2.2.3.3" xref="S3.E4.m1.1.1.1.1.1.1.3.2.2.2.3.3.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1.3.2.2.2.3.3.2" xref="S3.E4.m1.1.1.1.1.1.1.3.2.2.2.3.3.2.cmml">t</mi><mo id="S3.E4.m1.1.1.1.1.1.1.3.2.2.2.3.3.1" xref="S3.E4.m1.1.1.1.1.1.1.3.2.2.2.3.3.1.cmml">−</mo><mn id="S3.E4.m1.1.1.1.1.1.1.3.2.2.2.3.3.3" xref="S3.E4.m1.1.1.1.1.1.1.3.2.2.2.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.E4.m1.1.1.1.1.1.1.4.3.3.6" xref="S3.E4.m1.1.1.1.1.1.1.4.3.4.cmml">,</mo><mrow id="S3.E4.m1.1.1.1.1.1.1.4.3.3.3" xref="S3.E4.m1.1.1.1.1.1.1.4.3.3.3.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1.4.3.3.3.2" xref="S3.E4.m1.1.1.1.1.1.1.4.3.3.3.2.cmml">γ</mi><mo id="S3.E4.m1.1.1.1.1.1.1.4.3.3.3.1" xref="S3.E4.m1.1.1.1.1.1.1.4.3.3.3.1.cmml">⁢</mo><mi id="S3.E4.m1.1.1.1.1.1.1.4.3.3.3.3" xref="S3.E4.m1.1.1.1.1.1.1.4.3.3.3.3.cmml">𝐈</mi></mrow><mo id="S3.E4.m1.1.1.1.1.1.1.4.3.3.7" xref="S3.E4.m1.1.1.1.1.1.1.4.3.4.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E4.m1.1.1.1.1.2.3" rspace="0.667em" xref="S3.E4.m1.1.1.1.1.3a.cmml">,</mo><mrow id="S3.E4.m1.1.1.1.1.2.2" xref="S3.E4.m1.1.1.1.1.2.2.cmml"><mrow id="S3.E4.m1.1.1.1.1.2.2.1" xref="S3.E4.m1.1.1.1.1.2.2.1.cmml"><mi id="S3.E4.m1.1.1.1.1.2.2.1.3" xref="S3.E4.m1.1.1.1.1.2.2.1.3.cmml">f</mi><mo id="S3.E4.m1.1.1.1.1.2.2.1.2" xref="S3.E4.m1.1.1.1.1.2.2.1.2.cmml">⁢</mo><mrow id="S3.E4.m1.1.1.1.1.2.2.1.1.1" xref="S3.E4.m1.1.1.1.1.2.2.1.1.1.1.cmml"><mo id="S3.E4.m1.1.1.1.1.2.2.1.1.1.2" xref="S3.E4.m1.1.1.1.1.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.1.1.1.1.2.2.1.1.1.1" xref="S3.E4.m1.1.1.1.1.2.2.1.1.1.1.cmml"><msub id="S3.E4.m1.1.1.1.1.2.2.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.2.2.1.1.1.1.2.cmml"><mi id="S3.E4.m1.1.1.1.1.2.2.1.1.1.1.2.2" xref="S3.E4.m1.1.1.1.1.2.2.1.1.1.1.2.2.cmml">v</mi><mi id="S3.E4.m1.1.1.1.1.2.2.1.1.1.1.2.3" xref="S3.E4.m1.1.1.1.1.2.2.1.1.1.1.2.3.cmml">T</mi></msub><mo id="S3.E4.m1.1.1.1.1.2.2.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.2.2.1.1.1.1.1.cmml">∣</mo><msub id="S3.E4.m1.1.1.1.1.2.2.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.2.2.1.1.1.1.3.cmml"><mi id="S3.E4.m1.1.1.1.1.2.2.1.1.1.1.3.2" xref="S3.E4.m1.1.1.1.1.2.2.1.1.1.1.3.2.cmml">v</mi><mn id="S3.E4.m1.1.1.1.1.2.2.1.1.1.1.3.3" xref="S3.E4.m1.1.1.1.1.2.2.1.1.1.1.3.3.cmml">0</mn></msub></mrow><mo id="S3.E4.m1.1.1.1.1.2.2.1.1.1.3" xref="S3.E4.m1.1.1.1.1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.1.1.1.1.2.2.3" rspace="0.111em" xref="S3.E4.m1.1.1.1.1.2.2.3.cmml">=</mo><mrow id="S3.E4.m1.1.1.1.1.2.2.2" xref="S3.E4.m1.1.1.1.1.2.2.2.cmml"><munderover id="S3.E4.m1.1.1.1.1.2.2.2.2" xref="S3.E4.m1.1.1.1.1.2.2.2.2.cmml"><mo id="S3.E4.m1.1.1.1.1.2.2.2.2.2.2" movablelimits="false" xref="S3.E4.m1.1.1.1.1.2.2.2.2.2.2.cmml">∏</mo><mrow id="S3.E4.m1.1.1.1.1.2.2.2.2.2.3" xref="S3.E4.m1.1.1.1.1.2.2.2.2.2.3.cmml"><mi id="S3.E4.m1.1.1.1.1.2.2.2.2.2.3.2" xref="S3.E4.m1.1.1.1.1.2.2.2.2.2.3.2.cmml">t</mi><mo id="S3.E4.m1.1.1.1.1.2.2.2.2.2.3.1" xref="S3.E4.m1.1.1.1.1.2.2.2.2.2.3.1.cmml">=</mo><mn id="S3.E4.m1.1.1.1.1.2.2.2.2.2.3.3" xref="S3.E4.m1.1.1.1.1.2.2.2.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E4.m1.1.1.1.1.2.2.2.2.3" xref="S3.E4.m1.1.1.1.1.2.2.2.2.3.cmml">T</mi></munderover><mrow id="S3.E4.m1.1.1.1.1.2.2.2.1" xref="S3.E4.m1.1.1.1.1.2.2.2.1.cmml"><mi id="S3.E4.m1.1.1.1.1.2.2.2.1.3" xref="S3.E4.m1.1.1.1.1.2.2.2.1.3.cmml">f</mi><mo id="S3.E4.m1.1.1.1.1.2.2.2.1.2" xref="S3.E4.m1.1.1.1.1.2.2.2.1.2.cmml">⁢</mo><mrow id="S3.E4.m1.1.1.1.1.2.2.2.1.1.1" xref="S3.E4.m1.1.1.1.1.2.2.2.1.1.1.1.cmml"><mo id="S3.E4.m1.1.1.1.1.2.2.2.1.1.1.2" xref="S3.E4.m1.1.1.1.1.2.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.1.1.1.1.2.2.2.1.1.1.1" xref="S3.E4.m1.1.1.1.1.2.2.2.1.1.1.1.cmml"><msub id="S3.E4.m1.1.1.1.1.2.2.2.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.2.2.2.1.1.1.1.2.cmml"><mi id="S3.E4.m1.1.1.1.1.2.2.2.1.1.1.1.2.2" xref="S3.E4.m1.1.1.1.1.2.2.2.1.1.1.1.2.2.cmml">v</mi><mi id="S3.E4.m1.1.1.1.1.2.2.2.1.1.1.1.2.3" xref="S3.E4.m1.1.1.1.1.2.2.2.1.1.1.1.2.3.cmml">t</mi></msub><mo id="S3.E4.m1.1.1.1.1.2.2.2.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.2.2.2.1.1.1.1.1.cmml">∣</mo><msub id="S3.E4.m1.1.1.1.1.2.2.2.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.2.2.2.1.1.1.1.3.cmml"><mi id="S3.E4.m1.1.1.1.1.2.2.2.1.1.1.1.3.2" xref="S3.E4.m1.1.1.1.1.2.2.2.1.1.1.1.3.2.cmml">v</mi><mrow id="S3.E4.m1.1.1.1.1.2.2.2.1.1.1.1.3.3" xref="S3.E4.m1.1.1.1.1.2.2.2.1.1.1.1.3.3.cmml"><mi id="S3.E4.m1.1.1.1.1.2.2.2.1.1.1.1.3.3.2" xref="S3.E4.m1.1.1.1.1.2.2.2.1.1.1.1.3.3.2.cmml">t</mi><mo id="S3.E4.m1.1.1.1.1.2.2.2.1.1.1.1.3.3.1" xref="S3.E4.m1.1.1.1.1.2.2.2.1.1.1.1.3.3.1.cmml">−</mo><mn id="S3.E4.m1.1.1.1.1.2.2.2.1.1.1.1.3.3.3" xref="S3.E4.m1.1.1.1.1.2.2.2.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.E4.m1.1.1.1.1.2.2.2.1.1.1.3" xref="S3.E4.m1.1.1.1.1.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.E4.m1.1.1.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.1b"><apply id="S3.E4.m1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.3a.cmml" xref="S3.E4.m1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E4.m1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1"><eq id="S3.E4.m1.1.1.1.1.1.1.5.cmml" xref="S3.E4.m1.1.1.1.1.1.1.5"></eq><apply id="S3.E4.m1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1"><times id="S3.E4.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.2"></times><ci id="S3.E4.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.3">𝑓</ci><apply id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.2.2">𝑣</ci><ci id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.3.2">𝑣</ci><apply id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.3.3"><minus id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.3.3.1"></minus><ci id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.3.3.2">𝑡</ci><cn id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply><apply id="S3.E4.m1.1.1.1.1.1.1.4.cmml" xref="S3.E4.m1.1.1.1.1.1.1.4"><times id="S3.E4.m1.1.1.1.1.1.1.4.4.cmml" xref="S3.E4.m1.1.1.1.1.1.1.4.4"></times><ci id="S3.E4.m1.1.1.1.1.1.1.4.5.cmml" xref="S3.E4.m1.1.1.1.1.1.1.4.5">𝒩</ci><list id="S3.E4.m1.1.1.1.1.1.1.4.3.4.cmml" xref="S3.E4.m1.1.1.1.1.1.1.4.3.3"><apply id="S3.E4.m1.1.1.1.1.1.1.2.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.2.1.1.1">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.2.1.1.1.2">𝑣</ci><ci id="S3.E4.m1.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.2.1.1.1.3">𝑡</ci></apply><apply id="S3.E4.m1.1.1.1.1.1.1.3.2.2.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.3.2.2.2"><times id="S3.E4.m1.1.1.1.1.1.1.3.2.2.2.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.3.2.2.2.1"></times><apply id="S3.E4.m1.1.1.1.1.1.1.3.2.2.2.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.3.2.2.2.2"><root id="S3.E4.m1.1.1.1.1.1.1.3.2.2.2.2a.cmml" xref="S3.E4.m1.1.1.1.1.1.1.3.2.2.2.2"></root><apply id="S3.E4.m1.1.1.1.1.1.1.3.2.2.2.2.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.3.2.2.2.2.2"><minus id="S3.E4.m1.1.1.1.1.1.1.3.2.2.2.2.2.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.3.2.2.2.2.2.1"></minus><cn id="S3.E4.m1.1.1.1.1.1.1.3.2.2.2.2.2.2.cmml" type="integer" xref="S3.E4.m1.1.1.1.1.1.1.3.2.2.2.2.2.2">1</cn><ci id="S3.E4.m1.1.1.1.1.1.1.3.2.2.2.2.2.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.3.2.2.2.2.2.3">𝛾</ci></apply></apply><apply id="S3.E4.m1.1.1.1.1.1.1.3.2.2.2.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.3.2.2.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.1.3.2.2.2.3.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.3.2.2.2.3">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.1.1.3.2.2.2.3.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.3.2.2.2.3.2">𝑣</ci><apply id="S3.E4.m1.1.1.1.1.1.1.3.2.2.2.3.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.3.2.2.2.3.3"><minus id="S3.E4.m1.1.1.1.1.1.1.3.2.2.2.3.3.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.3.2.2.2.3.3.1"></minus><ci id="S3.E4.m1.1.1.1.1.1.1.3.2.2.2.3.3.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.3.2.2.2.3.3.2">𝑡</ci><cn id="S3.E4.m1.1.1.1.1.1.1.3.2.2.2.3.3.3.cmml" type="integer" xref="S3.E4.m1.1.1.1.1.1.1.3.2.2.2.3.3.3">1</cn></apply></apply></apply><apply id="S3.E4.m1.1.1.1.1.1.1.4.3.3.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.4.3.3.3"><times id="S3.E4.m1.1.1.1.1.1.1.4.3.3.3.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.4.3.3.3.1"></times><ci id="S3.E4.m1.1.1.1.1.1.1.4.3.3.3.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.4.3.3.3.2">𝛾</ci><ci id="S3.E4.m1.1.1.1.1.1.1.4.3.3.3.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.4.3.3.3.3">𝐈</ci></apply></list></apply></apply><apply id="S3.E4.m1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.1.1.1.1.2.2"><eq id="S3.E4.m1.1.1.1.1.2.2.3.cmml" xref="S3.E4.m1.1.1.1.1.2.2.3"></eq><apply id="S3.E4.m1.1.1.1.1.2.2.1.cmml" xref="S3.E4.m1.1.1.1.1.2.2.1"><times id="S3.E4.m1.1.1.1.1.2.2.1.2.cmml" xref="S3.E4.m1.1.1.1.1.2.2.1.2"></times><ci id="S3.E4.m1.1.1.1.1.2.2.1.3.cmml" xref="S3.E4.m1.1.1.1.1.2.2.1.3">𝑓</ci><apply id="S3.E4.m1.1.1.1.1.2.2.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.2.2.1.1.1"><csymbol cd="latexml" id="S3.E4.m1.1.1.1.1.2.2.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.2.2.1.1.1.1.1">conditional</csymbol><apply id="S3.E4.m1.1.1.1.1.2.2.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.2.2.1.1.1.1.2.1.cmml" xref="S3.E4.m1.1.1.1.1.2.2.1.1.1.1.2">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.2.2.1.1.1.1.2.2.cmml" xref="S3.E4.m1.1.1.1.1.2.2.1.1.1.1.2.2">𝑣</ci><ci id="S3.E4.m1.1.1.1.1.2.2.1.1.1.1.2.3.cmml" xref="S3.E4.m1.1.1.1.1.2.2.1.1.1.1.2.3">𝑇</ci></apply><apply id="S3.E4.m1.1.1.1.1.2.2.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.2.2.1.1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.1.1.2.2.1.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.2.2.1.1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.1.1.2.2.1.1.1.1.3.2">𝑣</ci><cn id="S3.E4.m1.1.1.1.1.2.2.1.1.1.1.3.3.cmml" type="integer" xref="S3.E4.m1.1.1.1.1.2.2.1.1.1.1.3.3">0</cn></apply></apply></apply><apply id="S3.E4.m1.1.1.1.1.2.2.2.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2"><apply id="S3.E4.m1.1.1.1.1.2.2.2.2.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2.2">superscript</csymbol><apply id="S3.E4.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.2.2.2.2.2.1.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2.2">subscript</csymbol><csymbol cd="latexml" id="S3.E4.m1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2.2.2.2">product</csymbol><apply id="S3.E4.m1.1.1.1.1.2.2.2.2.2.3.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2.2.2.3"><eq id="S3.E4.m1.1.1.1.1.2.2.2.2.2.3.1.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2.2.2.3.1"></eq><ci id="S3.E4.m1.1.1.1.1.2.2.2.2.2.3.2.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2.2.2.3.2">𝑡</ci><cn id="S3.E4.m1.1.1.1.1.2.2.2.2.2.3.3.cmml" type="integer" xref="S3.E4.m1.1.1.1.1.2.2.2.2.2.3.3">1</cn></apply></apply><ci id="S3.E4.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2.2.3">𝑇</ci></apply><apply id="S3.E4.m1.1.1.1.1.2.2.2.1.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2.1"><times id="S3.E4.m1.1.1.1.1.2.2.2.1.2.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2.1.2"></times><ci id="S3.E4.m1.1.1.1.1.2.2.2.1.3.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2.1.3">𝑓</ci><apply id="S3.E4.m1.1.1.1.1.2.2.2.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2.1.1.1"><csymbol cd="latexml" id="S3.E4.m1.1.1.1.1.2.2.2.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2.1.1.1.1.1">conditional</csymbol><apply id="S3.E4.m1.1.1.1.1.2.2.2.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.2.2.2.1.1.1.1.2.1.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2.1.1.1.1.2">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.2.2.2.1.1.1.1.2.2.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2.1.1.1.1.2.2">𝑣</ci><ci id="S3.E4.m1.1.1.1.1.2.2.2.1.1.1.1.2.3.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.E4.m1.1.1.1.1.2.2.2.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.2.2.2.1.1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2.1.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.2.2.2.1.1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2.1.1.1.1.3.2">𝑣</ci><apply id="S3.E4.m1.1.1.1.1.2.2.2.1.1.1.1.3.3.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2.1.1.1.1.3.3"><minus id="S3.E4.m1.1.1.1.1.2.2.2.1.1.1.1.3.3.1.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2.1.1.1.1.3.3.1"></minus><ci id="S3.E4.m1.1.1.1.1.2.2.2.1.1.1.1.3.3.2.cmml" xref="S3.E4.m1.1.1.1.1.2.2.2.1.1.1.1.3.3.2">𝑡</ci><cn id="S3.E4.m1.1.1.1.1.2.2.2.1.1.1.1.3.3.3.cmml" type="integer" xref="S3.E4.m1.1.1.1.1.2.2.2.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.1c">f\left(v_{t}\mid v_{t-1}\right)=\mathcal{N}\left(v_{t};\sqrt{1-\gamma}v_{t-1},%
\gamma\mathbf{I}\right),\ f\left(v_{T}\mid v_{0}\right)=\prod_{t=1}^{T}f\left(%
v_{t}\mid v_{t-1}\right),</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.1d">italic_f ( italic_v start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∣ italic_v start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT ) = caligraphic_N ( italic_v start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ; square-root start_ARG 1 - italic_γ end_ARG italic_v start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT , italic_γ bold_I ) , italic_f ( italic_v start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT ∣ italic_v start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) = ∏ start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_f ( italic_v start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∣ italic_v start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.SSS0.Px2.p1.10">where <math alttext="\mathbf{I}" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px2.p1.1.m1.1"><semantics id="S3.SS4.SSS0.Px2.p1.1.m1.1a"><mi id="S3.SS4.SSS0.Px2.p1.1.m1.1.1" xref="S3.SS4.SSS0.Px2.p1.1.m1.1.1.cmml">𝐈</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px2.p1.1.m1.1b"><ci id="S3.SS4.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.1.m1.1.1">𝐈</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px2.p1.1.m1.1c">\mathbf{I}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px2.p1.1.m1.1d">bold_I</annotation></semantics></math> and <math alttext="v_{0}" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px2.p1.2.m2.1"><semantics id="S3.SS4.SSS0.Px2.p1.2.m2.1a"><msub id="S3.SS4.SSS0.Px2.p1.2.m2.1.1" xref="S3.SS4.SSS0.Px2.p1.2.m2.1.1.cmml"><mi id="S3.SS4.SSS0.Px2.p1.2.m2.1.1.2" xref="S3.SS4.SSS0.Px2.p1.2.m2.1.1.2.cmml">v</mi><mn id="S3.SS4.SSS0.Px2.p1.2.m2.1.1.3" xref="S3.SS4.SSS0.Px2.p1.2.m2.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px2.p1.2.m2.1b"><apply id="S3.SS4.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p1.2.m2.1.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS4.SSS0.Px2.p1.2.m2.1.1.2.cmml" xref="S3.SS4.SSS0.Px2.p1.2.m2.1.1.2">𝑣</ci><cn id="S3.SS4.SSS0.Px2.p1.2.m2.1.1.3.cmml" type="integer" xref="S3.SS4.SSS0.Px2.p1.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px2.p1.2.m2.1c">v_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px2.p1.2.m2.1d">italic_v start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> denote an identity matrix and the original image, respectively. We gradually distort the original image by adding the Gaussian noise for <math alttext="T" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px2.p1.3.m3.1"><semantics id="S3.SS4.SSS0.Px2.p1.3.m3.1a"><mi id="S3.SS4.SSS0.Px2.p1.3.m3.1.1" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px2.p1.3.m3.1b"><ci id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px2.p1.3.m3.1c">T</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px2.p1.3.m3.1d">italic_T</annotation></semantics></math> steps and <math alttext="\gamma" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px2.p1.4.m4.1"><semantics id="S3.SS4.SSS0.Px2.p1.4.m4.1a"><mi id="S3.SS4.SSS0.Px2.p1.4.m4.1.1" xref="S3.SS4.SSS0.Px2.p1.4.m4.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px2.p1.4.m4.1b"><ci id="S3.SS4.SSS0.Px2.p1.4.m4.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.4.m4.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px2.p1.4.m4.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px2.p1.4.m4.1d">italic_γ</annotation></semantics></math> controls the the amount of noise added in each step. Subsequently, given a textual query <math alttext="x" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px2.p1.5.m5.1"><semantics id="S3.SS4.SSS0.Px2.p1.5.m5.1a"><mi id="S3.SS4.SSS0.Px2.p1.5.m5.1.1" xref="S3.SS4.SSS0.Px2.p1.5.m5.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px2.p1.5.m5.1b"><ci id="S3.SS4.SSS0.Px2.p1.5.m5.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.5.m5.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px2.p1.5.m5.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px2.p1.5.m5.1d">italic_x</annotation></semantics></math> and an image input <math alttext="v" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px2.p1.6.m6.1"><semantics id="S3.SS4.SSS0.Px2.p1.6.m6.1a"><mi id="S3.SS4.SSS0.Px2.p1.6.m6.1.1" xref="S3.SS4.SSS0.Px2.p1.6.m6.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px2.p1.6.m6.1b"><ci id="S3.SS4.SSS0.Px2.p1.6.m6.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.6.m6.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px2.p1.6.m6.1c">v</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px2.p1.6.m6.1d">italic_v</annotation></semantics></math>, the model generates two logit distributions conditioned on different visual posteriors: the original <math alttext="v" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px2.p1.7.m7.1"><semantics id="S3.SS4.SSS0.Px2.p1.7.m7.1a"><mi id="S3.SS4.SSS0.Px2.p1.7.m7.1.1" xref="S3.SS4.SSS0.Px2.p1.7.m7.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px2.p1.7.m7.1b"><ci id="S3.SS4.SSS0.Px2.p1.7.m7.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.7.m7.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px2.p1.7.m7.1c">v</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px2.p1.7.m7.1d">italic_v</annotation></semantics></math> and distorted <math alttext="v^{*}" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px2.p1.8.m8.1"><semantics id="S3.SS4.SSS0.Px2.p1.8.m8.1a"><msup id="S3.SS4.SSS0.Px2.p1.8.m8.1.1" xref="S3.SS4.SSS0.Px2.p1.8.m8.1.1.cmml"><mi id="S3.SS4.SSS0.Px2.p1.8.m8.1.1.2" xref="S3.SS4.SSS0.Px2.p1.8.m8.1.1.2.cmml">v</mi><mo id="S3.SS4.SSS0.Px2.p1.8.m8.1.1.3" xref="S3.SS4.SSS0.Px2.p1.8.m8.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px2.p1.8.m8.1b"><apply id="S3.SS4.SSS0.Px2.p1.8.m8.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p1.8.m8.1.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.8.m8.1.1">superscript</csymbol><ci id="S3.SS4.SSS0.Px2.p1.8.m8.1.1.2.cmml" xref="S3.SS4.SSS0.Px2.p1.8.m8.1.1.2">𝑣</ci><times id="S3.SS4.SSS0.Px2.p1.8.m8.1.1.3.cmml" xref="S3.SS4.SSS0.Px2.p1.8.m8.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px2.p1.8.m8.1c">v^{*}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px2.p1.8.m8.1d">italic_v start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math>. By contrasting the logit distributions obtained from these two conditions, we can get the contrastive probability distribution of the <math alttext="i" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px2.p1.9.m9.1"><semantics id="S3.SS4.SSS0.Px2.p1.9.m9.1a"><mi id="S3.SS4.SSS0.Px2.p1.9.m9.1.1" xref="S3.SS4.SSS0.Px2.p1.9.m9.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px2.p1.9.m9.1b"><ci id="S3.SS4.SSS0.Px2.p1.9.m9.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.9.m9.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px2.p1.9.m9.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px2.p1.9.m9.1d">italic_i</annotation></semantics></math>-th sample at time step <math alttext="t" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px2.p1.10.m10.1"><semantics id="S3.SS4.SSS0.Px2.p1.10.m10.1a"><mi id="S3.SS4.SSS0.Px2.p1.10.m10.1.1" xref="S3.SS4.SSS0.Px2.p1.10.m10.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px2.p1.10.m10.1b"><ci id="S3.SS4.SSS0.Px2.p1.10.m10.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.10.m10.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px2.p1.10.m10.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px2.p1.10.m10.1d">italic_t</annotation></semantics></math> as follows,</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\Delta logit(y_{i,t}|v_{i},v^{*}_{i},x_{i},y_{i,&lt;t})=logit_{\theta}(y_{i,t}|v_%
{i},x_{i},y_{i,&lt;t})-logit_{\theta}(y_{i,t}|v^{*}_{i},x_{i},y_{i,&lt;t})," class="ltx_Math" display="block" id="S3.E5.m1.13"><semantics id="S3.E5.m1.13a"><mrow id="S3.E5.m1.13.13.1" xref="S3.E5.m1.13.13.1.1.cmml"><mrow id="S3.E5.m1.13.13.1.1" xref="S3.E5.m1.13.13.1.1.cmml"><mrow id="S3.E5.m1.13.13.1.1.1" xref="S3.E5.m1.13.13.1.1.1.cmml"><mi id="S3.E5.m1.13.13.1.1.1.3" mathvariant="normal" xref="S3.E5.m1.13.13.1.1.1.3.cmml">Δ</mi><mo id="S3.E5.m1.13.13.1.1.1.2" xref="S3.E5.m1.13.13.1.1.1.2.cmml">⁢</mo><mi id="S3.E5.m1.13.13.1.1.1.4" xref="S3.E5.m1.13.13.1.1.1.4.cmml">l</mi><mo id="S3.E5.m1.13.13.1.1.1.2a" xref="S3.E5.m1.13.13.1.1.1.2.cmml">⁢</mo><mi id="S3.E5.m1.13.13.1.1.1.5" xref="S3.E5.m1.13.13.1.1.1.5.cmml">o</mi><mo id="S3.E5.m1.13.13.1.1.1.2b" xref="S3.E5.m1.13.13.1.1.1.2.cmml">⁢</mo><mi id="S3.E5.m1.13.13.1.1.1.6" xref="S3.E5.m1.13.13.1.1.1.6.cmml">g</mi><mo id="S3.E5.m1.13.13.1.1.1.2c" xref="S3.E5.m1.13.13.1.1.1.2.cmml">⁢</mo><mi id="S3.E5.m1.13.13.1.1.1.7" xref="S3.E5.m1.13.13.1.1.1.7.cmml">i</mi><mo id="S3.E5.m1.13.13.1.1.1.2d" xref="S3.E5.m1.13.13.1.1.1.2.cmml">⁢</mo><mi id="S3.E5.m1.13.13.1.1.1.8" xref="S3.E5.m1.13.13.1.1.1.8.cmml">t</mi><mo id="S3.E5.m1.13.13.1.1.1.2e" xref="S3.E5.m1.13.13.1.1.1.2.cmml">⁢</mo><mrow id="S3.E5.m1.13.13.1.1.1.1.1" xref="S3.E5.m1.13.13.1.1.1.1.1.1.cmml"><mo id="S3.E5.m1.13.13.1.1.1.1.1.2" stretchy="false" xref="S3.E5.m1.13.13.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E5.m1.13.13.1.1.1.1.1.1" xref="S3.E5.m1.13.13.1.1.1.1.1.1.cmml"><msub id="S3.E5.m1.13.13.1.1.1.1.1.1.6" xref="S3.E5.m1.13.13.1.1.1.1.1.1.6.cmml"><mi id="S3.E5.m1.13.13.1.1.1.1.1.1.6.2" xref="S3.E5.m1.13.13.1.1.1.1.1.1.6.2.cmml">y</mi><mrow id="S3.E5.m1.2.2.2.4" xref="S3.E5.m1.2.2.2.3.cmml"><mi id="S3.E5.m1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml">i</mi><mo id="S3.E5.m1.2.2.2.4.1" xref="S3.E5.m1.2.2.2.3.cmml">,</mo><mi id="S3.E5.m1.2.2.2.2" xref="S3.E5.m1.2.2.2.2.cmml">t</mi></mrow></msub><mo fence="false" id="S3.E5.m1.13.13.1.1.1.1.1.1.5" xref="S3.E5.m1.13.13.1.1.1.1.1.1.5.cmml">|</mo><mrow id="S3.E5.m1.13.13.1.1.1.1.1.1.4.4" xref="S3.E5.m1.13.13.1.1.1.1.1.1.4.5.cmml"><msub id="S3.E5.m1.13.13.1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.13.13.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.13.13.1.1.1.1.1.1.1.1.1.2" xref="S3.E5.m1.13.13.1.1.1.1.1.1.1.1.1.2.cmml">v</mi><mi id="S3.E5.m1.13.13.1.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.13.13.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E5.m1.13.13.1.1.1.1.1.1.4.4.5" xref="S3.E5.m1.13.13.1.1.1.1.1.1.4.5.cmml">,</mo><msubsup id="S3.E5.m1.13.13.1.1.1.1.1.1.2.2.2" xref="S3.E5.m1.13.13.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E5.m1.13.13.1.1.1.1.1.1.2.2.2.2.2" xref="S3.E5.m1.13.13.1.1.1.1.1.1.2.2.2.2.2.cmml">v</mi><mi id="S3.E5.m1.13.13.1.1.1.1.1.1.2.2.2.3" xref="S3.E5.m1.13.13.1.1.1.1.1.1.2.2.2.3.cmml">i</mi><mo id="S3.E5.m1.13.13.1.1.1.1.1.1.2.2.2.2.3" xref="S3.E5.m1.13.13.1.1.1.1.1.1.2.2.2.2.3.cmml">∗</mo></msubsup><mo id="S3.E5.m1.13.13.1.1.1.1.1.1.4.4.6" xref="S3.E5.m1.13.13.1.1.1.1.1.1.4.5.cmml">,</mo><msub id="S3.E5.m1.13.13.1.1.1.1.1.1.3.3.3" xref="S3.E5.m1.13.13.1.1.1.1.1.1.3.3.3.cmml"><mi id="S3.E5.m1.13.13.1.1.1.1.1.1.3.3.3.2" xref="S3.E5.m1.13.13.1.1.1.1.1.1.3.3.3.2.cmml">x</mi><mi id="S3.E5.m1.13.13.1.1.1.1.1.1.3.3.3.3" xref="S3.E5.m1.13.13.1.1.1.1.1.1.3.3.3.3.cmml">i</mi></msub><mo id="S3.E5.m1.13.13.1.1.1.1.1.1.4.4.7" xref="S3.E5.m1.13.13.1.1.1.1.1.1.4.5.cmml">,</mo><msub id="S3.E5.m1.13.13.1.1.1.1.1.1.4.4.4" xref="S3.E5.m1.13.13.1.1.1.1.1.1.4.4.4.cmml"><mi id="S3.E5.m1.13.13.1.1.1.1.1.1.4.4.4.2" xref="S3.E5.m1.13.13.1.1.1.1.1.1.4.4.4.2.cmml">y</mi><mrow id="S3.E5.m1.4.4.2.2" xref="S3.E5.m1.4.4.2.3.cmml"><mi id="S3.E5.m1.3.3.1.1" xref="S3.E5.m1.3.3.1.1.cmml">i</mi><mo id="S3.E5.m1.4.4.2.2.2" xref="S3.E5.m1.4.4.2.3.cmml">,</mo><mrow id="S3.E5.m1.4.4.2.2.1" xref="S3.E5.m1.4.4.2.2.1.cmml"><mi id="S3.E5.m1.4.4.2.2.1.2" xref="S3.E5.m1.4.4.2.2.1.2.cmml"></mi><mo id="S3.E5.m1.4.4.2.2.1.1" xref="S3.E5.m1.4.4.2.2.1.1.cmml">&lt;</mo><mi id="S3.E5.m1.4.4.2.2.1.3" xref="S3.E5.m1.4.4.2.2.1.3.cmml">t</mi></mrow></mrow></msub></mrow></mrow><mo id="S3.E5.m1.13.13.1.1.1.1.1.3" stretchy="false" xref="S3.E5.m1.13.13.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.13.13.1.1.4" xref="S3.E5.m1.13.13.1.1.4.cmml">=</mo><mrow id="S3.E5.m1.13.13.1.1.3" xref="S3.E5.m1.13.13.1.1.3.cmml"><mrow id="S3.E5.m1.13.13.1.1.2.1" xref="S3.E5.m1.13.13.1.1.2.1.cmml"><mi id="S3.E5.m1.13.13.1.1.2.1.3" xref="S3.E5.m1.13.13.1.1.2.1.3.cmml">l</mi><mo id="S3.E5.m1.13.13.1.1.2.1.2" xref="S3.E5.m1.13.13.1.1.2.1.2.cmml">⁢</mo><mi id="S3.E5.m1.13.13.1.1.2.1.4" xref="S3.E5.m1.13.13.1.1.2.1.4.cmml">o</mi><mo id="S3.E5.m1.13.13.1.1.2.1.2a" xref="S3.E5.m1.13.13.1.1.2.1.2.cmml">⁢</mo><mi id="S3.E5.m1.13.13.1.1.2.1.5" xref="S3.E5.m1.13.13.1.1.2.1.5.cmml">g</mi><mo id="S3.E5.m1.13.13.1.1.2.1.2b" xref="S3.E5.m1.13.13.1.1.2.1.2.cmml">⁢</mo><mi id="S3.E5.m1.13.13.1.1.2.1.6" xref="S3.E5.m1.13.13.1.1.2.1.6.cmml">i</mi><mo id="S3.E5.m1.13.13.1.1.2.1.2c" xref="S3.E5.m1.13.13.1.1.2.1.2.cmml">⁢</mo><msub id="S3.E5.m1.13.13.1.1.2.1.7" xref="S3.E5.m1.13.13.1.1.2.1.7.cmml"><mi id="S3.E5.m1.13.13.1.1.2.1.7.2" xref="S3.E5.m1.13.13.1.1.2.1.7.2.cmml">t</mi><mi id="S3.E5.m1.13.13.1.1.2.1.7.3" xref="S3.E5.m1.13.13.1.1.2.1.7.3.cmml">θ</mi></msub><mo id="S3.E5.m1.13.13.1.1.2.1.2d" xref="S3.E5.m1.13.13.1.1.2.1.2.cmml">⁢</mo><mrow id="S3.E5.m1.13.13.1.1.2.1.1.1" xref="S3.E5.m1.13.13.1.1.2.1.1.1.1.cmml"><mo id="S3.E5.m1.13.13.1.1.2.1.1.1.2" stretchy="false" xref="S3.E5.m1.13.13.1.1.2.1.1.1.1.cmml">(</mo><mrow id="S3.E5.m1.13.13.1.1.2.1.1.1.1" xref="S3.E5.m1.13.13.1.1.2.1.1.1.1.cmml"><msub id="S3.E5.m1.13.13.1.1.2.1.1.1.1.5" xref="S3.E5.m1.13.13.1.1.2.1.1.1.1.5.cmml"><mi id="S3.E5.m1.13.13.1.1.2.1.1.1.1.5.2" xref="S3.E5.m1.13.13.1.1.2.1.1.1.1.5.2.cmml">y</mi><mrow id="S3.E5.m1.6.6.2.4" xref="S3.E5.m1.6.6.2.3.cmml"><mi id="S3.E5.m1.5.5.1.1" xref="S3.E5.m1.5.5.1.1.cmml">i</mi><mo id="S3.E5.m1.6.6.2.4.1" xref="S3.E5.m1.6.6.2.3.cmml">,</mo><mi id="S3.E5.m1.6.6.2.2" xref="S3.E5.m1.6.6.2.2.cmml">t</mi></mrow></msub><mo fence="false" id="S3.E5.m1.13.13.1.1.2.1.1.1.1.4" xref="S3.E5.m1.13.13.1.1.2.1.1.1.1.4.cmml">|</mo><mrow id="S3.E5.m1.13.13.1.1.2.1.1.1.1.3.3" xref="S3.E5.m1.13.13.1.1.2.1.1.1.1.3.4.cmml"><msub id="S3.E5.m1.13.13.1.1.2.1.1.1.1.1.1.1" xref="S3.E5.m1.13.13.1.1.2.1.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.13.13.1.1.2.1.1.1.1.1.1.1.2" xref="S3.E5.m1.13.13.1.1.2.1.1.1.1.1.1.1.2.cmml">v</mi><mi id="S3.E5.m1.13.13.1.1.2.1.1.1.1.1.1.1.3" xref="S3.E5.m1.13.13.1.1.2.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E5.m1.13.13.1.1.2.1.1.1.1.3.3.4" xref="S3.E5.m1.13.13.1.1.2.1.1.1.1.3.4.cmml">,</mo><msub id="S3.E5.m1.13.13.1.1.2.1.1.1.1.2.2.2" xref="S3.E5.m1.13.13.1.1.2.1.1.1.1.2.2.2.cmml"><mi id="S3.E5.m1.13.13.1.1.2.1.1.1.1.2.2.2.2" xref="S3.E5.m1.13.13.1.1.2.1.1.1.1.2.2.2.2.cmml">x</mi><mi id="S3.E5.m1.13.13.1.1.2.1.1.1.1.2.2.2.3" xref="S3.E5.m1.13.13.1.1.2.1.1.1.1.2.2.2.3.cmml">i</mi></msub><mo id="S3.E5.m1.13.13.1.1.2.1.1.1.1.3.3.5" xref="S3.E5.m1.13.13.1.1.2.1.1.1.1.3.4.cmml">,</mo><msub id="S3.E5.m1.13.13.1.1.2.1.1.1.1.3.3.3" xref="S3.E5.m1.13.13.1.1.2.1.1.1.1.3.3.3.cmml"><mi id="S3.E5.m1.13.13.1.1.2.1.1.1.1.3.3.3.2" xref="S3.E5.m1.13.13.1.1.2.1.1.1.1.3.3.3.2.cmml">y</mi><mrow id="S3.E5.m1.8.8.2.2" xref="S3.E5.m1.8.8.2.3.cmml"><mi id="S3.E5.m1.7.7.1.1" xref="S3.E5.m1.7.7.1.1.cmml">i</mi><mo id="S3.E5.m1.8.8.2.2.2" xref="S3.E5.m1.8.8.2.3.cmml">,</mo><mrow id="S3.E5.m1.8.8.2.2.1" xref="S3.E5.m1.8.8.2.2.1.cmml"><mi id="S3.E5.m1.8.8.2.2.1.2" xref="S3.E5.m1.8.8.2.2.1.2.cmml"></mi><mo id="S3.E5.m1.8.8.2.2.1.1" xref="S3.E5.m1.8.8.2.2.1.1.cmml">&lt;</mo><mi id="S3.E5.m1.8.8.2.2.1.3" xref="S3.E5.m1.8.8.2.2.1.3.cmml">t</mi></mrow></mrow></msub></mrow></mrow><mo id="S3.E5.m1.13.13.1.1.2.1.1.1.3" stretchy="false" xref="S3.E5.m1.13.13.1.1.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.13.13.1.1.3.3" xref="S3.E5.m1.13.13.1.1.3.3.cmml">−</mo><mrow id="S3.E5.m1.13.13.1.1.3.2" xref="S3.E5.m1.13.13.1.1.3.2.cmml"><mi id="S3.E5.m1.13.13.1.1.3.2.3" xref="S3.E5.m1.13.13.1.1.3.2.3.cmml">l</mi><mo id="S3.E5.m1.13.13.1.1.3.2.2" xref="S3.E5.m1.13.13.1.1.3.2.2.cmml">⁢</mo><mi id="S3.E5.m1.13.13.1.1.3.2.4" xref="S3.E5.m1.13.13.1.1.3.2.4.cmml">o</mi><mo id="S3.E5.m1.13.13.1.1.3.2.2a" xref="S3.E5.m1.13.13.1.1.3.2.2.cmml">⁢</mo><mi id="S3.E5.m1.13.13.1.1.3.2.5" xref="S3.E5.m1.13.13.1.1.3.2.5.cmml">g</mi><mo id="S3.E5.m1.13.13.1.1.3.2.2b" xref="S3.E5.m1.13.13.1.1.3.2.2.cmml">⁢</mo><mi id="S3.E5.m1.13.13.1.1.3.2.6" xref="S3.E5.m1.13.13.1.1.3.2.6.cmml">i</mi><mo id="S3.E5.m1.13.13.1.1.3.2.2c" xref="S3.E5.m1.13.13.1.1.3.2.2.cmml">⁢</mo><msub id="S3.E5.m1.13.13.1.1.3.2.7" xref="S3.E5.m1.13.13.1.1.3.2.7.cmml"><mi id="S3.E5.m1.13.13.1.1.3.2.7.2" xref="S3.E5.m1.13.13.1.1.3.2.7.2.cmml">t</mi><mi id="S3.E5.m1.13.13.1.1.3.2.7.3" xref="S3.E5.m1.13.13.1.1.3.2.7.3.cmml">θ</mi></msub><mo id="S3.E5.m1.13.13.1.1.3.2.2d" xref="S3.E5.m1.13.13.1.1.3.2.2.cmml">⁢</mo><mrow id="S3.E5.m1.13.13.1.1.3.2.1.1" xref="S3.E5.m1.13.13.1.1.3.2.1.1.1.cmml"><mo id="S3.E5.m1.13.13.1.1.3.2.1.1.2" stretchy="false" xref="S3.E5.m1.13.13.1.1.3.2.1.1.1.cmml">(</mo><mrow id="S3.E5.m1.13.13.1.1.3.2.1.1.1" xref="S3.E5.m1.13.13.1.1.3.2.1.1.1.cmml"><msub id="S3.E5.m1.13.13.1.1.3.2.1.1.1.5" xref="S3.E5.m1.13.13.1.1.3.2.1.1.1.5.cmml"><mi id="S3.E5.m1.13.13.1.1.3.2.1.1.1.5.2" xref="S3.E5.m1.13.13.1.1.3.2.1.1.1.5.2.cmml">y</mi><mrow id="S3.E5.m1.10.10.2.4" xref="S3.E5.m1.10.10.2.3.cmml"><mi id="S3.E5.m1.9.9.1.1" xref="S3.E5.m1.9.9.1.1.cmml">i</mi><mo id="S3.E5.m1.10.10.2.4.1" xref="S3.E5.m1.10.10.2.3.cmml">,</mo><mi id="S3.E5.m1.10.10.2.2" xref="S3.E5.m1.10.10.2.2.cmml">t</mi></mrow></msub><mo fence="false" id="S3.E5.m1.13.13.1.1.3.2.1.1.1.4" xref="S3.E5.m1.13.13.1.1.3.2.1.1.1.4.cmml">|</mo><mrow id="S3.E5.m1.13.13.1.1.3.2.1.1.1.3.3" xref="S3.E5.m1.13.13.1.1.3.2.1.1.1.3.4.cmml"><msubsup id="S3.E5.m1.13.13.1.1.3.2.1.1.1.1.1.1" xref="S3.E5.m1.13.13.1.1.3.2.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.13.13.1.1.3.2.1.1.1.1.1.1.2.2" xref="S3.E5.m1.13.13.1.1.3.2.1.1.1.1.1.1.2.2.cmml">v</mi><mi id="S3.E5.m1.13.13.1.1.3.2.1.1.1.1.1.1.3" xref="S3.E5.m1.13.13.1.1.3.2.1.1.1.1.1.1.3.cmml">i</mi><mo id="S3.E5.m1.13.13.1.1.3.2.1.1.1.1.1.1.2.3" xref="S3.E5.m1.13.13.1.1.3.2.1.1.1.1.1.1.2.3.cmml">∗</mo></msubsup><mo id="S3.E5.m1.13.13.1.1.3.2.1.1.1.3.3.4" xref="S3.E5.m1.13.13.1.1.3.2.1.1.1.3.4.cmml">,</mo><msub id="S3.E5.m1.13.13.1.1.3.2.1.1.1.2.2.2" xref="S3.E5.m1.13.13.1.1.3.2.1.1.1.2.2.2.cmml"><mi id="S3.E5.m1.13.13.1.1.3.2.1.1.1.2.2.2.2" xref="S3.E5.m1.13.13.1.1.3.2.1.1.1.2.2.2.2.cmml">x</mi><mi id="S3.E5.m1.13.13.1.1.3.2.1.1.1.2.2.2.3" xref="S3.E5.m1.13.13.1.1.3.2.1.1.1.2.2.2.3.cmml">i</mi></msub><mo id="S3.E5.m1.13.13.1.1.3.2.1.1.1.3.3.5" xref="S3.E5.m1.13.13.1.1.3.2.1.1.1.3.4.cmml">,</mo><msub id="S3.E5.m1.13.13.1.1.3.2.1.1.1.3.3.3" xref="S3.E5.m1.13.13.1.1.3.2.1.1.1.3.3.3.cmml"><mi id="S3.E5.m1.13.13.1.1.3.2.1.1.1.3.3.3.2" xref="S3.E5.m1.13.13.1.1.3.2.1.1.1.3.3.3.2.cmml">y</mi><mrow id="S3.E5.m1.12.12.2.2" xref="S3.E5.m1.12.12.2.3.cmml"><mi id="S3.E5.m1.11.11.1.1" xref="S3.E5.m1.11.11.1.1.cmml">i</mi><mo id="S3.E5.m1.12.12.2.2.2" xref="S3.E5.m1.12.12.2.3.cmml">,</mo><mrow id="S3.E5.m1.12.12.2.2.1" xref="S3.E5.m1.12.12.2.2.1.cmml"><mi id="S3.E5.m1.12.12.2.2.1.2" xref="S3.E5.m1.12.12.2.2.1.2.cmml"></mi><mo id="S3.E5.m1.12.12.2.2.1.1" xref="S3.E5.m1.12.12.2.2.1.1.cmml">&lt;</mo><mi id="S3.E5.m1.12.12.2.2.1.3" xref="S3.E5.m1.12.12.2.2.1.3.cmml">t</mi></mrow></mrow></msub></mrow></mrow><mo id="S3.E5.m1.13.13.1.1.3.2.1.1.3" stretchy="false" xref="S3.E5.m1.13.13.1.1.3.2.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E5.m1.13.13.1.2" xref="S3.E5.m1.13.13.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.13b"><apply id="S3.E5.m1.13.13.1.1.cmml" xref="S3.E5.m1.13.13.1"><eq id="S3.E5.m1.13.13.1.1.4.cmml" xref="S3.E5.m1.13.13.1.1.4"></eq><apply id="S3.E5.m1.13.13.1.1.1.cmml" xref="S3.E5.m1.13.13.1.1.1"><times id="S3.E5.m1.13.13.1.1.1.2.cmml" xref="S3.E5.m1.13.13.1.1.1.2"></times><ci id="S3.E5.m1.13.13.1.1.1.3.cmml" xref="S3.E5.m1.13.13.1.1.1.3">Δ</ci><ci id="S3.E5.m1.13.13.1.1.1.4.cmml" xref="S3.E5.m1.13.13.1.1.1.4">𝑙</ci><ci id="S3.E5.m1.13.13.1.1.1.5.cmml" xref="S3.E5.m1.13.13.1.1.1.5">𝑜</ci><ci id="S3.E5.m1.13.13.1.1.1.6.cmml" xref="S3.E5.m1.13.13.1.1.1.6">𝑔</ci><ci id="S3.E5.m1.13.13.1.1.1.7.cmml" xref="S3.E5.m1.13.13.1.1.1.7">𝑖</ci><ci id="S3.E5.m1.13.13.1.1.1.8.cmml" xref="S3.E5.m1.13.13.1.1.1.8">𝑡</ci><apply id="S3.E5.m1.13.13.1.1.1.1.1.1.cmml" xref="S3.E5.m1.13.13.1.1.1.1.1"><csymbol cd="latexml" id="S3.E5.m1.13.13.1.1.1.1.1.1.5.cmml" xref="S3.E5.m1.13.13.1.1.1.1.1.1.5">conditional</csymbol><apply id="S3.E5.m1.13.13.1.1.1.1.1.1.6.cmml" xref="S3.E5.m1.13.13.1.1.1.1.1.1.6"><csymbol cd="ambiguous" id="S3.E5.m1.13.13.1.1.1.1.1.1.6.1.cmml" xref="S3.E5.m1.13.13.1.1.1.1.1.1.6">subscript</csymbol><ci id="S3.E5.m1.13.13.1.1.1.1.1.1.6.2.cmml" xref="S3.E5.m1.13.13.1.1.1.1.1.1.6.2">𝑦</ci><list id="S3.E5.m1.2.2.2.3.cmml" xref="S3.E5.m1.2.2.2.4"><ci id="S3.E5.m1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1">𝑖</ci><ci id="S3.E5.m1.2.2.2.2.cmml" xref="S3.E5.m1.2.2.2.2">𝑡</ci></list></apply><list id="S3.E5.m1.13.13.1.1.1.1.1.1.4.5.cmml" xref="S3.E5.m1.13.13.1.1.1.1.1.1.4.4"><apply id="S3.E5.m1.13.13.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.13.13.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.13.13.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.13.13.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.13.13.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.13.13.1.1.1.1.1.1.1.1.1.2">𝑣</ci><ci id="S3.E5.m1.13.13.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.13.13.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E5.m1.13.13.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E5.m1.13.13.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.13.13.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E5.m1.13.13.1.1.1.1.1.1.2.2.2">subscript</csymbol><apply id="S3.E5.m1.13.13.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E5.m1.13.13.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.13.13.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E5.m1.13.13.1.1.1.1.1.1.2.2.2">superscript</csymbol><ci id="S3.E5.m1.13.13.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E5.m1.13.13.1.1.1.1.1.1.2.2.2.2.2">𝑣</ci><times id="S3.E5.m1.13.13.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E5.m1.13.13.1.1.1.1.1.1.2.2.2.2.3"></times></apply><ci id="S3.E5.m1.13.13.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E5.m1.13.13.1.1.1.1.1.1.2.2.2.3">𝑖</ci></apply><apply id="S3.E5.m1.13.13.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E5.m1.13.13.1.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.13.13.1.1.1.1.1.1.3.3.3.1.cmml" xref="S3.E5.m1.13.13.1.1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S3.E5.m1.13.13.1.1.1.1.1.1.3.3.3.2.cmml" xref="S3.E5.m1.13.13.1.1.1.1.1.1.3.3.3.2">𝑥</ci><ci id="S3.E5.m1.13.13.1.1.1.1.1.1.3.3.3.3.cmml" xref="S3.E5.m1.13.13.1.1.1.1.1.1.3.3.3.3">𝑖</ci></apply><apply id="S3.E5.m1.13.13.1.1.1.1.1.1.4.4.4.cmml" xref="S3.E5.m1.13.13.1.1.1.1.1.1.4.4.4"><csymbol cd="ambiguous" id="S3.E5.m1.13.13.1.1.1.1.1.1.4.4.4.1.cmml" xref="S3.E5.m1.13.13.1.1.1.1.1.1.4.4.4">subscript</csymbol><ci id="S3.E5.m1.13.13.1.1.1.1.1.1.4.4.4.2.cmml" xref="S3.E5.m1.13.13.1.1.1.1.1.1.4.4.4.2">𝑦</ci><list id="S3.E5.m1.4.4.2.3.cmml" xref="S3.E5.m1.4.4.2.2"><ci id="S3.E5.m1.3.3.1.1.cmml" xref="S3.E5.m1.3.3.1.1">𝑖</ci><apply id="S3.E5.m1.4.4.2.2.1.cmml" xref="S3.E5.m1.4.4.2.2.1"><lt id="S3.E5.m1.4.4.2.2.1.1.cmml" xref="S3.E5.m1.4.4.2.2.1.1"></lt><csymbol cd="latexml" id="S3.E5.m1.4.4.2.2.1.2.cmml" xref="S3.E5.m1.4.4.2.2.1.2">absent</csymbol><ci id="S3.E5.m1.4.4.2.2.1.3.cmml" xref="S3.E5.m1.4.4.2.2.1.3">𝑡</ci></apply></list></apply></list></apply></apply><apply id="S3.E5.m1.13.13.1.1.3.cmml" xref="S3.E5.m1.13.13.1.1.3"><minus id="S3.E5.m1.13.13.1.1.3.3.cmml" xref="S3.E5.m1.13.13.1.1.3.3"></minus><apply id="S3.E5.m1.13.13.1.1.2.1.cmml" xref="S3.E5.m1.13.13.1.1.2.1"><times id="S3.E5.m1.13.13.1.1.2.1.2.cmml" xref="S3.E5.m1.13.13.1.1.2.1.2"></times><ci id="S3.E5.m1.13.13.1.1.2.1.3.cmml" xref="S3.E5.m1.13.13.1.1.2.1.3">𝑙</ci><ci id="S3.E5.m1.13.13.1.1.2.1.4.cmml" xref="S3.E5.m1.13.13.1.1.2.1.4">𝑜</ci><ci id="S3.E5.m1.13.13.1.1.2.1.5.cmml" xref="S3.E5.m1.13.13.1.1.2.1.5">𝑔</ci><ci id="S3.E5.m1.13.13.1.1.2.1.6.cmml" xref="S3.E5.m1.13.13.1.1.2.1.6">𝑖</ci><apply id="S3.E5.m1.13.13.1.1.2.1.7.cmml" xref="S3.E5.m1.13.13.1.1.2.1.7"><csymbol cd="ambiguous" id="S3.E5.m1.13.13.1.1.2.1.7.1.cmml" xref="S3.E5.m1.13.13.1.1.2.1.7">subscript</csymbol><ci id="S3.E5.m1.13.13.1.1.2.1.7.2.cmml" xref="S3.E5.m1.13.13.1.1.2.1.7.2">𝑡</ci><ci id="S3.E5.m1.13.13.1.1.2.1.7.3.cmml" xref="S3.E5.m1.13.13.1.1.2.1.7.3">𝜃</ci></apply><apply id="S3.E5.m1.13.13.1.1.2.1.1.1.1.cmml" xref="S3.E5.m1.13.13.1.1.2.1.1.1"><csymbol cd="latexml" id="S3.E5.m1.13.13.1.1.2.1.1.1.1.4.cmml" xref="S3.E5.m1.13.13.1.1.2.1.1.1.1.4">conditional</csymbol><apply id="S3.E5.m1.13.13.1.1.2.1.1.1.1.5.cmml" xref="S3.E5.m1.13.13.1.1.2.1.1.1.1.5"><csymbol cd="ambiguous" id="S3.E5.m1.13.13.1.1.2.1.1.1.1.5.1.cmml" xref="S3.E5.m1.13.13.1.1.2.1.1.1.1.5">subscript</csymbol><ci id="S3.E5.m1.13.13.1.1.2.1.1.1.1.5.2.cmml" xref="S3.E5.m1.13.13.1.1.2.1.1.1.1.5.2">𝑦</ci><list id="S3.E5.m1.6.6.2.3.cmml" xref="S3.E5.m1.6.6.2.4"><ci id="S3.E5.m1.5.5.1.1.cmml" xref="S3.E5.m1.5.5.1.1">𝑖</ci><ci id="S3.E5.m1.6.6.2.2.cmml" xref="S3.E5.m1.6.6.2.2">𝑡</ci></list></apply><list id="S3.E5.m1.13.13.1.1.2.1.1.1.1.3.4.cmml" xref="S3.E5.m1.13.13.1.1.2.1.1.1.1.3.3"><apply id="S3.E5.m1.13.13.1.1.2.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.13.13.1.1.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.13.13.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.13.13.1.1.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.13.13.1.1.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.13.13.1.1.2.1.1.1.1.1.1.1.2">𝑣</ci><ci id="S3.E5.m1.13.13.1.1.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.13.13.1.1.2.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E5.m1.13.13.1.1.2.1.1.1.1.2.2.2.cmml" xref="S3.E5.m1.13.13.1.1.2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.13.13.1.1.2.1.1.1.1.2.2.2.1.cmml" xref="S3.E5.m1.13.13.1.1.2.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E5.m1.13.13.1.1.2.1.1.1.1.2.2.2.2.cmml" xref="S3.E5.m1.13.13.1.1.2.1.1.1.1.2.2.2.2">𝑥</ci><ci id="S3.E5.m1.13.13.1.1.2.1.1.1.1.2.2.2.3.cmml" xref="S3.E5.m1.13.13.1.1.2.1.1.1.1.2.2.2.3">𝑖</ci></apply><apply id="S3.E5.m1.13.13.1.1.2.1.1.1.1.3.3.3.cmml" xref="S3.E5.m1.13.13.1.1.2.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.13.13.1.1.2.1.1.1.1.3.3.3.1.cmml" xref="S3.E5.m1.13.13.1.1.2.1.1.1.1.3.3.3">subscript</csymbol><ci id="S3.E5.m1.13.13.1.1.2.1.1.1.1.3.3.3.2.cmml" xref="S3.E5.m1.13.13.1.1.2.1.1.1.1.3.3.3.2">𝑦</ci><list id="S3.E5.m1.8.8.2.3.cmml" xref="S3.E5.m1.8.8.2.2"><ci id="S3.E5.m1.7.7.1.1.cmml" xref="S3.E5.m1.7.7.1.1">𝑖</ci><apply id="S3.E5.m1.8.8.2.2.1.cmml" xref="S3.E5.m1.8.8.2.2.1"><lt id="S3.E5.m1.8.8.2.2.1.1.cmml" xref="S3.E5.m1.8.8.2.2.1.1"></lt><csymbol cd="latexml" id="S3.E5.m1.8.8.2.2.1.2.cmml" xref="S3.E5.m1.8.8.2.2.1.2">absent</csymbol><ci id="S3.E5.m1.8.8.2.2.1.3.cmml" xref="S3.E5.m1.8.8.2.2.1.3">𝑡</ci></apply></list></apply></list></apply></apply><apply id="S3.E5.m1.13.13.1.1.3.2.cmml" xref="S3.E5.m1.13.13.1.1.3.2"><times id="S3.E5.m1.13.13.1.1.3.2.2.cmml" xref="S3.E5.m1.13.13.1.1.3.2.2"></times><ci id="S3.E5.m1.13.13.1.1.3.2.3.cmml" xref="S3.E5.m1.13.13.1.1.3.2.3">𝑙</ci><ci id="S3.E5.m1.13.13.1.1.3.2.4.cmml" xref="S3.E5.m1.13.13.1.1.3.2.4">𝑜</ci><ci id="S3.E5.m1.13.13.1.1.3.2.5.cmml" xref="S3.E5.m1.13.13.1.1.3.2.5">𝑔</ci><ci id="S3.E5.m1.13.13.1.1.3.2.6.cmml" xref="S3.E5.m1.13.13.1.1.3.2.6">𝑖</ci><apply id="S3.E5.m1.13.13.1.1.3.2.7.cmml" xref="S3.E5.m1.13.13.1.1.3.2.7"><csymbol cd="ambiguous" id="S3.E5.m1.13.13.1.1.3.2.7.1.cmml" xref="S3.E5.m1.13.13.1.1.3.2.7">subscript</csymbol><ci id="S3.E5.m1.13.13.1.1.3.2.7.2.cmml" xref="S3.E5.m1.13.13.1.1.3.2.7.2">𝑡</ci><ci id="S3.E5.m1.13.13.1.1.3.2.7.3.cmml" xref="S3.E5.m1.13.13.1.1.3.2.7.3">𝜃</ci></apply><apply id="S3.E5.m1.13.13.1.1.3.2.1.1.1.cmml" xref="S3.E5.m1.13.13.1.1.3.2.1.1"><csymbol cd="latexml" id="S3.E5.m1.13.13.1.1.3.2.1.1.1.4.cmml" xref="S3.E5.m1.13.13.1.1.3.2.1.1.1.4">conditional</csymbol><apply id="S3.E5.m1.13.13.1.1.3.2.1.1.1.5.cmml" xref="S3.E5.m1.13.13.1.1.3.2.1.1.1.5"><csymbol cd="ambiguous" id="S3.E5.m1.13.13.1.1.3.2.1.1.1.5.1.cmml" xref="S3.E5.m1.13.13.1.1.3.2.1.1.1.5">subscript</csymbol><ci id="S3.E5.m1.13.13.1.1.3.2.1.1.1.5.2.cmml" xref="S3.E5.m1.13.13.1.1.3.2.1.1.1.5.2">𝑦</ci><list id="S3.E5.m1.10.10.2.3.cmml" xref="S3.E5.m1.10.10.2.4"><ci id="S3.E5.m1.9.9.1.1.cmml" xref="S3.E5.m1.9.9.1.1">𝑖</ci><ci id="S3.E5.m1.10.10.2.2.cmml" xref="S3.E5.m1.10.10.2.2">𝑡</ci></list></apply><list id="S3.E5.m1.13.13.1.1.3.2.1.1.1.3.4.cmml" xref="S3.E5.m1.13.13.1.1.3.2.1.1.1.3.3"><apply id="S3.E5.m1.13.13.1.1.3.2.1.1.1.1.1.1.cmml" xref="S3.E5.m1.13.13.1.1.3.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.13.13.1.1.3.2.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.13.13.1.1.3.2.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E5.m1.13.13.1.1.3.2.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.13.13.1.1.3.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.13.13.1.1.3.2.1.1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.13.13.1.1.3.2.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E5.m1.13.13.1.1.3.2.1.1.1.1.1.1.2.2.cmml" xref="S3.E5.m1.13.13.1.1.3.2.1.1.1.1.1.1.2.2">𝑣</ci><times id="S3.E5.m1.13.13.1.1.3.2.1.1.1.1.1.1.2.3.cmml" xref="S3.E5.m1.13.13.1.1.3.2.1.1.1.1.1.1.2.3"></times></apply><ci id="S3.E5.m1.13.13.1.1.3.2.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.13.13.1.1.3.2.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E5.m1.13.13.1.1.3.2.1.1.1.2.2.2.cmml" xref="S3.E5.m1.13.13.1.1.3.2.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.13.13.1.1.3.2.1.1.1.2.2.2.1.cmml" xref="S3.E5.m1.13.13.1.1.3.2.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E5.m1.13.13.1.1.3.2.1.1.1.2.2.2.2.cmml" xref="S3.E5.m1.13.13.1.1.3.2.1.1.1.2.2.2.2">𝑥</ci><ci id="S3.E5.m1.13.13.1.1.3.2.1.1.1.2.2.2.3.cmml" xref="S3.E5.m1.13.13.1.1.3.2.1.1.1.2.2.2.3">𝑖</ci></apply><apply id="S3.E5.m1.13.13.1.1.3.2.1.1.1.3.3.3.cmml" xref="S3.E5.m1.13.13.1.1.3.2.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.13.13.1.1.3.2.1.1.1.3.3.3.1.cmml" xref="S3.E5.m1.13.13.1.1.3.2.1.1.1.3.3.3">subscript</csymbol><ci id="S3.E5.m1.13.13.1.1.3.2.1.1.1.3.3.3.2.cmml" xref="S3.E5.m1.13.13.1.1.3.2.1.1.1.3.3.3.2">𝑦</ci><list id="S3.E5.m1.12.12.2.3.cmml" xref="S3.E5.m1.12.12.2.2"><ci id="S3.E5.m1.11.11.1.1.cmml" xref="S3.E5.m1.11.11.1.1">𝑖</ci><apply id="S3.E5.m1.12.12.2.2.1.cmml" xref="S3.E5.m1.12.12.2.2.1"><lt id="S3.E5.m1.12.12.2.2.1.1.cmml" xref="S3.E5.m1.12.12.2.2.1.1"></lt><csymbol cd="latexml" id="S3.E5.m1.12.12.2.2.1.2.cmml" xref="S3.E5.m1.12.12.2.2.1.2">absent</csymbol><ci id="S3.E5.m1.12.12.2.2.1.3.cmml" xref="S3.E5.m1.12.12.2.2.1.3">𝑡</ci></apply></list></apply></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.13c">\Delta logit(y_{i,t}|v_{i},v^{*}_{i},x_{i},y_{i,&lt;t})=logit_{\theta}(y_{i,t}|v_%
{i},x_{i},y_{i,&lt;t})-logit_{\theta}(y_{i,t}|v^{*}_{i},x_{i},y_{i,&lt;t}),</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.13d">roman_Δ italic_l italic_o italic_g italic_i italic_t ( italic_y start_POSTSUBSCRIPT italic_i , italic_t end_POSTSUBSCRIPT | italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_v start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_i , &lt; italic_t end_POSTSUBSCRIPT ) = italic_l italic_o italic_g italic_i italic_t start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_i , italic_t end_POSTSUBSCRIPT | italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_i , &lt; italic_t end_POSTSUBSCRIPT ) - italic_l italic_o italic_g italic_i italic_t start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_i , italic_t end_POSTSUBSCRIPT | italic_v start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_i , &lt; italic_t end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.SSS0.Px2.p1.15">where <math alttext="y_{i,t}" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px2.p1.11.m1.2"><semantics id="S3.SS4.SSS0.Px2.p1.11.m1.2a"><msub id="S3.SS4.SSS0.Px2.p1.11.m1.2.3" xref="S3.SS4.SSS0.Px2.p1.11.m1.2.3.cmml"><mi id="S3.SS4.SSS0.Px2.p1.11.m1.2.3.2" xref="S3.SS4.SSS0.Px2.p1.11.m1.2.3.2.cmml">y</mi><mrow id="S3.SS4.SSS0.Px2.p1.11.m1.2.2.2.4" xref="S3.SS4.SSS0.Px2.p1.11.m1.2.2.2.3.cmml"><mi id="S3.SS4.SSS0.Px2.p1.11.m1.1.1.1.1" xref="S3.SS4.SSS0.Px2.p1.11.m1.1.1.1.1.cmml">i</mi><mo id="S3.SS4.SSS0.Px2.p1.11.m1.2.2.2.4.1" xref="S3.SS4.SSS0.Px2.p1.11.m1.2.2.2.3.cmml">,</mo><mi id="S3.SS4.SSS0.Px2.p1.11.m1.2.2.2.2" xref="S3.SS4.SSS0.Px2.p1.11.m1.2.2.2.2.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px2.p1.11.m1.2b"><apply id="S3.SS4.SSS0.Px2.p1.11.m1.2.3.cmml" xref="S3.SS4.SSS0.Px2.p1.11.m1.2.3"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p1.11.m1.2.3.1.cmml" xref="S3.SS4.SSS0.Px2.p1.11.m1.2.3">subscript</csymbol><ci id="S3.SS4.SSS0.Px2.p1.11.m1.2.3.2.cmml" xref="S3.SS4.SSS0.Px2.p1.11.m1.2.3.2">𝑦</ci><list id="S3.SS4.SSS0.Px2.p1.11.m1.2.2.2.3.cmml" xref="S3.SS4.SSS0.Px2.p1.11.m1.2.2.2.4"><ci id="S3.SS4.SSS0.Px2.p1.11.m1.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.11.m1.1.1.1.1">𝑖</ci><ci id="S3.SS4.SSS0.Px2.p1.11.m1.2.2.2.2.cmml" xref="S3.SS4.SSS0.Px2.p1.11.m1.2.2.2.2">𝑡</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px2.p1.11.m1.2c">y_{i,t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px2.p1.11.m1.2d">italic_y start_POSTSUBSCRIPT italic_i , italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="y_{i,&lt;t}" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px2.p1.12.m2.2"><semantics id="S3.SS4.SSS0.Px2.p1.12.m2.2a"><msub id="S3.SS4.SSS0.Px2.p1.12.m2.2.3" xref="S3.SS4.SSS0.Px2.p1.12.m2.2.3.cmml"><mi id="S3.SS4.SSS0.Px2.p1.12.m2.2.3.2" xref="S3.SS4.SSS0.Px2.p1.12.m2.2.3.2.cmml">y</mi><mrow id="S3.SS4.SSS0.Px2.p1.12.m2.2.2.2.2" xref="S3.SS4.SSS0.Px2.p1.12.m2.2.2.2.3.cmml"><mi id="S3.SS4.SSS0.Px2.p1.12.m2.1.1.1.1" xref="S3.SS4.SSS0.Px2.p1.12.m2.1.1.1.1.cmml">i</mi><mo id="S3.SS4.SSS0.Px2.p1.12.m2.2.2.2.2.2" xref="S3.SS4.SSS0.Px2.p1.12.m2.2.2.2.3.cmml">,</mo><mrow id="S3.SS4.SSS0.Px2.p1.12.m2.2.2.2.2.1" xref="S3.SS4.SSS0.Px2.p1.12.m2.2.2.2.2.1.cmml"><mi id="S3.SS4.SSS0.Px2.p1.12.m2.2.2.2.2.1.2" xref="S3.SS4.SSS0.Px2.p1.12.m2.2.2.2.2.1.2.cmml"></mi><mo id="S3.SS4.SSS0.Px2.p1.12.m2.2.2.2.2.1.1" xref="S3.SS4.SSS0.Px2.p1.12.m2.2.2.2.2.1.1.cmml">&lt;</mo><mi id="S3.SS4.SSS0.Px2.p1.12.m2.2.2.2.2.1.3" xref="S3.SS4.SSS0.Px2.p1.12.m2.2.2.2.2.1.3.cmml">t</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px2.p1.12.m2.2b"><apply id="S3.SS4.SSS0.Px2.p1.12.m2.2.3.cmml" xref="S3.SS4.SSS0.Px2.p1.12.m2.2.3"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p1.12.m2.2.3.1.cmml" xref="S3.SS4.SSS0.Px2.p1.12.m2.2.3">subscript</csymbol><ci id="S3.SS4.SSS0.Px2.p1.12.m2.2.3.2.cmml" xref="S3.SS4.SSS0.Px2.p1.12.m2.2.3.2">𝑦</ci><list id="S3.SS4.SSS0.Px2.p1.12.m2.2.2.2.3.cmml" xref="S3.SS4.SSS0.Px2.p1.12.m2.2.2.2.2"><ci id="S3.SS4.SSS0.Px2.p1.12.m2.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.12.m2.1.1.1.1">𝑖</ci><apply id="S3.SS4.SSS0.Px2.p1.12.m2.2.2.2.2.1.cmml" xref="S3.SS4.SSS0.Px2.p1.12.m2.2.2.2.2.1"><lt id="S3.SS4.SSS0.Px2.p1.12.m2.2.2.2.2.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.12.m2.2.2.2.2.1.1"></lt><csymbol cd="latexml" id="S3.SS4.SSS0.Px2.p1.12.m2.2.2.2.2.1.2.cmml" xref="S3.SS4.SSS0.Px2.p1.12.m2.2.2.2.2.1.2">absent</csymbol><ci id="S3.SS4.SSS0.Px2.p1.12.m2.2.2.2.2.1.3.cmml" xref="S3.SS4.SSS0.Px2.p1.12.m2.2.2.2.2.1.3">𝑡</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px2.p1.12.m2.2c">y_{i,&lt;t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px2.p1.12.m2.2d">italic_y start_POSTSUBSCRIPT italic_i , &lt; italic_t end_POSTSUBSCRIPT</annotation></semantics></math> denote the token at time step <math alttext="t" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px2.p1.13.m3.1"><semantics id="S3.SS4.SSS0.Px2.p1.13.m3.1a"><mi id="S3.SS4.SSS0.Px2.p1.13.m3.1.1" xref="S3.SS4.SSS0.Px2.p1.13.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px2.p1.13.m3.1b"><ci id="S3.SS4.SSS0.Px2.p1.13.m3.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.13.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px2.p1.13.m3.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px2.p1.13.m3.1d">italic_t</annotation></semantics></math> and the generated tokens sequence up to the time step <math alttext="t-1" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px2.p1.14.m4.1"><semantics id="S3.SS4.SSS0.Px2.p1.14.m4.1a"><mrow id="S3.SS4.SSS0.Px2.p1.14.m4.1.1" xref="S3.SS4.SSS0.Px2.p1.14.m4.1.1.cmml"><mi id="S3.SS4.SSS0.Px2.p1.14.m4.1.1.2" xref="S3.SS4.SSS0.Px2.p1.14.m4.1.1.2.cmml">t</mi><mo id="S3.SS4.SSS0.Px2.p1.14.m4.1.1.1" xref="S3.SS4.SSS0.Px2.p1.14.m4.1.1.1.cmml">−</mo><mn id="S3.SS4.SSS0.Px2.p1.14.m4.1.1.3" xref="S3.SS4.SSS0.Px2.p1.14.m4.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px2.p1.14.m4.1b"><apply id="S3.SS4.SSS0.Px2.p1.14.m4.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.14.m4.1.1"><minus id="S3.SS4.SSS0.Px2.p1.14.m4.1.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.14.m4.1.1.1"></minus><ci id="S3.SS4.SSS0.Px2.p1.14.m4.1.1.2.cmml" xref="S3.SS4.SSS0.Px2.p1.14.m4.1.1.2">𝑡</ci><cn id="S3.SS4.SSS0.Px2.p1.14.m4.1.1.3.cmml" type="integer" xref="S3.SS4.SSS0.Px2.p1.14.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px2.p1.14.m4.1c">t-1</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px2.p1.14.m4.1d">italic_t - 1</annotation></semantics></math> of the <math alttext="i" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px2.p1.15.m5.1"><semantics id="S3.SS4.SSS0.Px2.p1.15.m5.1a"><mi id="S3.SS4.SSS0.Px2.p1.15.m5.1.1" xref="S3.SS4.SSS0.Px2.p1.15.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px2.p1.15.m5.1b"><ci id="S3.SS4.SSS0.Px2.p1.15.m5.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.15.m5.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px2.p1.15.m5.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px2.p1.15.m5.1d">italic_i</annotation></semantics></math>-th sample, respectively. Subsequently, we can obtain the visual correlation weight:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{w}_{i,t}=\Delta logit(y_{i,t}|v_{i},v^{*}_{i},x_{i},y_{i,&lt;t})." class="ltx_Math" display="block" id="S3.E6.m1.7"><semantics id="S3.E6.m1.7a"><mrow id="S3.E6.m1.7.7.1" xref="S3.E6.m1.7.7.1.1.cmml"><mrow id="S3.E6.m1.7.7.1.1" xref="S3.E6.m1.7.7.1.1.cmml"><msub id="S3.E6.m1.7.7.1.1.3" xref="S3.E6.m1.7.7.1.1.3.cmml"><mi id="S3.E6.m1.7.7.1.1.3.2" xref="S3.E6.m1.7.7.1.1.3.2.cmml">𝐰</mi><mrow id="S3.E6.m1.2.2.2.4" xref="S3.E6.m1.2.2.2.3.cmml"><mi id="S3.E6.m1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml">i</mi><mo id="S3.E6.m1.2.2.2.4.1" xref="S3.E6.m1.2.2.2.3.cmml">,</mo><mi id="S3.E6.m1.2.2.2.2" xref="S3.E6.m1.2.2.2.2.cmml">t</mi></mrow></msub><mo id="S3.E6.m1.7.7.1.1.2" xref="S3.E6.m1.7.7.1.1.2.cmml">=</mo><mrow id="S3.E6.m1.7.7.1.1.1" xref="S3.E6.m1.7.7.1.1.1.cmml"><mi id="S3.E6.m1.7.7.1.1.1.3" mathvariant="normal" xref="S3.E6.m1.7.7.1.1.1.3.cmml">Δ</mi><mo id="S3.E6.m1.7.7.1.1.1.2" xref="S3.E6.m1.7.7.1.1.1.2.cmml">⁢</mo><mi id="S3.E6.m1.7.7.1.1.1.4" xref="S3.E6.m1.7.7.1.1.1.4.cmml">l</mi><mo id="S3.E6.m1.7.7.1.1.1.2a" xref="S3.E6.m1.7.7.1.1.1.2.cmml">⁢</mo><mi id="S3.E6.m1.7.7.1.1.1.5" xref="S3.E6.m1.7.7.1.1.1.5.cmml">o</mi><mo id="S3.E6.m1.7.7.1.1.1.2b" xref="S3.E6.m1.7.7.1.1.1.2.cmml">⁢</mo><mi id="S3.E6.m1.7.7.1.1.1.6" xref="S3.E6.m1.7.7.1.1.1.6.cmml">g</mi><mo id="S3.E6.m1.7.7.1.1.1.2c" xref="S3.E6.m1.7.7.1.1.1.2.cmml">⁢</mo><mi id="S3.E6.m1.7.7.1.1.1.7" xref="S3.E6.m1.7.7.1.1.1.7.cmml">i</mi><mo id="S3.E6.m1.7.7.1.1.1.2d" xref="S3.E6.m1.7.7.1.1.1.2.cmml">⁢</mo><mi id="S3.E6.m1.7.7.1.1.1.8" xref="S3.E6.m1.7.7.1.1.1.8.cmml">t</mi><mo id="S3.E6.m1.7.7.1.1.1.2e" xref="S3.E6.m1.7.7.1.1.1.2.cmml">⁢</mo><mrow id="S3.E6.m1.7.7.1.1.1.1.1" xref="S3.E6.m1.7.7.1.1.1.1.1.1.cmml"><mo id="S3.E6.m1.7.7.1.1.1.1.1.2" stretchy="false" xref="S3.E6.m1.7.7.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E6.m1.7.7.1.1.1.1.1.1" xref="S3.E6.m1.7.7.1.1.1.1.1.1.cmml"><msub id="S3.E6.m1.7.7.1.1.1.1.1.1.6" xref="S3.E6.m1.7.7.1.1.1.1.1.1.6.cmml"><mi id="S3.E6.m1.7.7.1.1.1.1.1.1.6.2" xref="S3.E6.m1.7.7.1.1.1.1.1.1.6.2.cmml">y</mi><mrow id="S3.E6.m1.4.4.2.4" xref="S3.E6.m1.4.4.2.3.cmml"><mi id="S3.E6.m1.3.3.1.1" xref="S3.E6.m1.3.3.1.1.cmml">i</mi><mo id="S3.E6.m1.4.4.2.4.1" xref="S3.E6.m1.4.4.2.3.cmml">,</mo><mi id="S3.E6.m1.4.4.2.2" xref="S3.E6.m1.4.4.2.2.cmml">t</mi></mrow></msub><mo fence="false" id="S3.E6.m1.7.7.1.1.1.1.1.1.5" xref="S3.E6.m1.7.7.1.1.1.1.1.1.5.cmml">|</mo><mrow id="S3.E6.m1.7.7.1.1.1.1.1.1.4.4" xref="S3.E6.m1.7.7.1.1.1.1.1.1.4.5.cmml"><msub id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml">v</mi><mi id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E6.m1.7.7.1.1.1.1.1.1.4.4.5" xref="S3.E6.m1.7.7.1.1.1.1.1.1.4.5.cmml">,</mo><msubsup id="S3.E6.m1.7.7.1.1.1.1.1.1.2.2.2" xref="S3.E6.m1.7.7.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E6.m1.7.7.1.1.1.1.1.1.2.2.2.2.2" xref="S3.E6.m1.7.7.1.1.1.1.1.1.2.2.2.2.2.cmml">v</mi><mi id="S3.E6.m1.7.7.1.1.1.1.1.1.2.2.2.3" xref="S3.E6.m1.7.7.1.1.1.1.1.1.2.2.2.3.cmml">i</mi><mo id="S3.E6.m1.7.7.1.1.1.1.1.1.2.2.2.2.3" xref="S3.E6.m1.7.7.1.1.1.1.1.1.2.2.2.2.3.cmml">∗</mo></msubsup><mo id="S3.E6.m1.7.7.1.1.1.1.1.1.4.4.6" xref="S3.E6.m1.7.7.1.1.1.1.1.1.4.5.cmml">,</mo><msub id="S3.E6.m1.7.7.1.1.1.1.1.1.3.3.3" xref="S3.E6.m1.7.7.1.1.1.1.1.1.3.3.3.cmml"><mi id="S3.E6.m1.7.7.1.1.1.1.1.1.3.3.3.2" xref="S3.E6.m1.7.7.1.1.1.1.1.1.3.3.3.2.cmml">x</mi><mi id="S3.E6.m1.7.7.1.1.1.1.1.1.3.3.3.3" xref="S3.E6.m1.7.7.1.1.1.1.1.1.3.3.3.3.cmml">i</mi></msub><mo id="S3.E6.m1.7.7.1.1.1.1.1.1.4.4.7" xref="S3.E6.m1.7.7.1.1.1.1.1.1.4.5.cmml">,</mo><msub id="S3.E6.m1.7.7.1.1.1.1.1.1.4.4.4" xref="S3.E6.m1.7.7.1.1.1.1.1.1.4.4.4.cmml"><mi id="S3.E6.m1.7.7.1.1.1.1.1.1.4.4.4.2" xref="S3.E6.m1.7.7.1.1.1.1.1.1.4.4.4.2.cmml">y</mi><mrow id="S3.E6.m1.6.6.2.2" xref="S3.E6.m1.6.6.2.3.cmml"><mi id="S3.E6.m1.5.5.1.1" xref="S3.E6.m1.5.5.1.1.cmml">i</mi><mo id="S3.E6.m1.6.6.2.2.2" xref="S3.E6.m1.6.6.2.3.cmml">,</mo><mrow id="S3.E6.m1.6.6.2.2.1" xref="S3.E6.m1.6.6.2.2.1.cmml"><mi id="S3.E6.m1.6.6.2.2.1.2" xref="S3.E6.m1.6.6.2.2.1.2.cmml"></mi><mo id="S3.E6.m1.6.6.2.2.1.1" xref="S3.E6.m1.6.6.2.2.1.1.cmml">&lt;</mo><mi id="S3.E6.m1.6.6.2.2.1.3" xref="S3.E6.m1.6.6.2.2.1.3.cmml">t</mi></mrow></mrow></msub></mrow></mrow><mo id="S3.E6.m1.7.7.1.1.1.1.1.3" stretchy="false" xref="S3.E6.m1.7.7.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E6.m1.7.7.1.2" lspace="0em" xref="S3.E6.m1.7.7.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.7b"><apply id="S3.E6.m1.7.7.1.1.cmml" xref="S3.E6.m1.7.7.1"><eq id="S3.E6.m1.7.7.1.1.2.cmml" xref="S3.E6.m1.7.7.1.1.2"></eq><apply id="S3.E6.m1.7.7.1.1.3.cmml" xref="S3.E6.m1.7.7.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.7.7.1.1.3.1.cmml" xref="S3.E6.m1.7.7.1.1.3">subscript</csymbol><ci id="S3.E6.m1.7.7.1.1.3.2.cmml" xref="S3.E6.m1.7.7.1.1.3.2">𝐰</ci><list id="S3.E6.m1.2.2.2.3.cmml" xref="S3.E6.m1.2.2.2.4"><ci id="S3.E6.m1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1">𝑖</ci><ci id="S3.E6.m1.2.2.2.2.cmml" xref="S3.E6.m1.2.2.2.2">𝑡</ci></list></apply><apply id="S3.E6.m1.7.7.1.1.1.cmml" xref="S3.E6.m1.7.7.1.1.1"><times id="S3.E6.m1.7.7.1.1.1.2.cmml" xref="S3.E6.m1.7.7.1.1.1.2"></times><ci id="S3.E6.m1.7.7.1.1.1.3.cmml" xref="S3.E6.m1.7.7.1.1.1.3">Δ</ci><ci id="S3.E6.m1.7.7.1.1.1.4.cmml" xref="S3.E6.m1.7.7.1.1.1.4">𝑙</ci><ci id="S3.E6.m1.7.7.1.1.1.5.cmml" xref="S3.E6.m1.7.7.1.1.1.5">𝑜</ci><ci id="S3.E6.m1.7.7.1.1.1.6.cmml" xref="S3.E6.m1.7.7.1.1.1.6">𝑔</ci><ci id="S3.E6.m1.7.7.1.1.1.7.cmml" xref="S3.E6.m1.7.7.1.1.1.7">𝑖</ci><ci id="S3.E6.m1.7.7.1.1.1.8.cmml" xref="S3.E6.m1.7.7.1.1.1.8">𝑡</ci><apply id="S3.E6.m1.7.7.1.1.1.1.1.1.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1"><csymbol cd="latexml" id="S3.E6.m1.7.7.1.1.1.1.1.1.5.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.5">conditional</csymbol><apply id="S3.E6.m1.7.7.1.1.1.1.1.1.6.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.6"><csymbol cd="ambiguous" id="S3.E6.m1.7.7.1.1.1.1.1.1.6.1.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.6">subscript</csymbol><ci id="S3.E6.m1.7.7.1.1.1.1.1.1.6.2.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.6.2">𝑦</ci><list id="S3.E6.m1.4.4.2.3.cmml" xref="S3.E6.m1.4.4.2.4"><ci id="S3.E6.m1.3.3.1.1.cmml" xref="S3.E6.m1.3.3.1.1">𝑖</ci><ci id="S3.E6.m1.4.4.2.2.cmml" xref="S3.E6.m1.4.4.2.2">𝑡</ci></list></apply><list id="S3.E6.m1.7.7.1.1.1.1.1.1.4.5.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.4.4"><apply id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.2">𝑣</ci><ci id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E6.m1.7.7.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.7.7.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.2.2.2">subscript</csymbol><apply id="S3.E6.m1.7.7.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.7.7.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.2.2.2">superscript</csymbol><ci id="S3.E6.m1.7.7.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.2.2.2.2.2">𝑣</ci><times id="S3.E6.m1.7.7.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.2.2.2.2.3"></times></apply><ci id="S3.E6.m1.7.7.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.2.2.2.3">𝑖</ci></apply><apply id="S3.E6.m1.7.7.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E6.m1.7.7.1.1.1.1.1.1.3.3.3.1.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S3.E6.m1.7.7.1.1.1.1.1.1.3.3.3.2.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.3.3.3.2">𝑥</ci><ci id="S3.E6.m1.7.7.1.1.1.1.1.1.3.3.3.3.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.3.3.3.3">𝑖</ci></apply><apply id="S3.E6.m1.7.7.1.1.1.1.1.1.4.4.4.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.4.4.4"><csymbol cd="ambiguous" id="S3.E6.m1.7.7.1.1.1.1.1.1.4.4.4.1.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.4.4.4">subscript</csymbol><ci id="S3.E6.m1.7.7.1.1.1.1.1.1.4.4.4.2.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.4.4.4.2">𝑦</ci><list id="S3.E6.m1.6.6.2.3.cmml" xref="S3.E6.m1.6.6.2.2"><ci id="S3.E6.m1.5.5.1.1.cmml" xref="S3.E6.m1.5.5.1.1">𝑖</ci><apply id="S3.E6.m1.6.6.2.2.1.cmml" xref="S3.E6.m1.6.6.2.2.1"><lt id="S3.E6.m1.6.6.2.2.1.1.cmml" xref="S3.E6.m1.6.6.2.2.1.1"></lt><csymbol cd="latexml" id="S3.E6.m1.6.6.2.2.1.2.cmml" xref="S3.E6.m1.6.6.2.2.1.2">absent</csymbol><ci id="S3.E6.m1.6.6.2.2.1.3.cmml" xref="S3.E6.m1.6.6.2.2.1.3">𝑡</ci></apply></list></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.7c">\mathbf{w}_{i,t}=\Delta logit(y_{i,t}|v_{i},v^{*}_{i},x_{i},y_{i,&lt;t}).</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.7d">bold_w start_POSTSUBSCRIPT italic_i , italic_t end_POSTSUBSCRIPT = roman_Δ italic_l italic_o italic_g italic_i italic_t ( italic_y start_POSTSUBSCRIPT italic_i , italic_t end_POSTSUBSCRIPT | italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_v start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_i , &lt; italic_t end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.SSS0.Px2.p1.19">Following <cite class="ltx_cite ltx_citemacro_cite">Xiao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#bib.bib42" title="">2024</a>)</cite> to post-process and smooth the weights, we finally reassign the weight of each token in the vanilla MLE loss, which can be formulated as follows,</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{INJ}^{i,t}=-\frac{{\mathbf{\tilde{w}}}_{i,t}}{\sum_{k=1}^{l}{%
\mathbf{\tilde{w}}}_{i,k}}\cdot logp_{\theta}(y_{i,t}|v_{i},x_{i},y_{i,&lt;t})," class="ltx_Math" display="block" id="S3.E7.m1.11"><semantics id="S3.E7.m1.11a"><mrow id="S3.E7.m1.11.11.1" xref="S3.E7.m1.11.11.1.1.cmml"><mrow id="S3.E7.m1.11.11.1.1" xref="S3.E7.m1.11.11.1.1.cmml"><msubsup id="S3.E7.m1.11.11.1.1.3" xref="S3.E7.m1.11.11.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.11.11.1.1.3.2.2" xref="S3.E7.m1.11.11.1.1.3.2.2.cmml">ℒ</mi><mrow id="S3.E7.m1.11.11.1.1.3.2.3" xref="S3.E7.m1.11.11.1.1.3.2.3.cmml"><mi id="S3.E7.m1.11.11.1.1.3.2.3.2" xref="S3.E7.m1.11.11.1.1.3.2.3.2.cmml">I</mi><mo id="S3.E7.m1.11.11.1.1.3.2.3.1" xref="S3.E7.m1.11.11.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.E7.m1.11.11.1.1.3.2.3.3" xref="S3.E7.m1.11.11.1.1.3.2.3.3.cmml">N</mi><mo id="S3.E7.m1.11.11.1.1.3.2.3.1a" xref="S3.E7.m1.11.11.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.E7.m1.11.11.1.1.3.2.3.4" xref="S3.E7.m1.11.11.1.1.3.2.3.4.cmml">J</mi></mrow><mrow id="S3.E7.m1.2.2.2.4" xref="S3.E7.m1.2.2.2.3.cmml"><mi id="S3.E7.m1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.cmml">i</mi><mo id="S3.E7.m1.2.2.2.4.1" xref="S3.E7.m1.2.2.2.3.cmml">,</mo><mi id="S3.E7.m1.2.2.2.2" xref="S3.E7.m1.2.2.2.2.cmml">t</mi></mrow></msubsup><mo id="S3.E7.m1.11.11.1.1.2" xref="S3.E7.m1.11.11.1.1.2.cmml">=</mo><mrow id="S3.E7.m1.11.11.1.1.1" xref="S3.E7.m1.11.11.1.1.1.cmml"><mo id="S3.E7.m1.11.11.1.1.1a" xref="S3.E7.m1.11.11.1.1.1.cmml">−</mo><mrow id="S3.E7.m1.11.11.1.1.1.1" xref="S3.E7.m1.11.11.1.1.1.1.cmml"><mrow id="S3.E7.m1.11.11.1.1.1.1.3" xref="S3.E7.m1.11.11.1.1.1.1.3.cmml"><mfrac id="S3.E7.m1.6.6" xref="S3.E7.m1.6.6.cmml"><msub id="S3.E7.m1.4.4.2" xref="S3.E7.m1.4.4.2.cmml"><mover accent="true" id="S3.E7.m1.4.4.2.4" xref="S3.E7.m1.4.4.2.4.cmml"><mi id="S3.E7.m1.4.4.2.4.2" xref="S3.E7.m1.4.4.2.4.2.cmml">𝐰</mi><mo id="S3.E7.m1.4.4.2.4.1" xref="S3.E7.m1.4.4.2.4.1.cmml">~</mo></mover><mrow id="S3.E7.m1.4.4.2.2.2.4" xref="S3.E7.m1.4.4.2.2.2.3.cmml"><mi id="S3.E7.m1.3.3.1.1.1.1" xref="S3.E7.m1.3.3.1.1.1.1.cmml">i</mi><mo id="S3.E7.m1.4.4.2.2.2.4.1" xref="S3.E7.m1.4.4.2.2.2.3.cmml">,</mo><mi id="S3.E7.m1.4.4.2.2.2.2" xref="S3.E7.m1.4.4.2.2.2.2.cmml">t</mi></mrow></msub><mrow id="S3.E7.m1.6.6.4" xref="S3.E7.m1.6.6.4.cmml"><msubsup id="S3.E7.m1.6.6.4.3" xref="S3.E7.m1.6.6.4.3.cmml"><mo id="S3.E7.m1.6.6.4.3.2.2" xref="S3.E7.m1.6.6.4.3.2.2.cmml">∑</mo><mrow id="S3.E7.m1.6.6.4.3.2.3" xref="S3.E7.m1.6.6.4.3.2.3.cmml"><mi id="S3.E7.m1.6.6.4.3.2.3.2" xref="S3.E7.m1.6.6.4.3.2.3.2.cmml">k</mi><mo id="S3.E7.m1.6.6.4.3.2.3.1" xref="S3.E7.m1.6.6.4.3.2.3.1.cmml">=</mo><mn id="S3.E7.m1.6.6.4.3.2.3.3" xref="S3.E7.m1.6.6.4.3.2.3.3.cmml">1</mn></mrow><mi id="S3.E7.m1.6.6.4.3.3" xref="S3.E7.m1.6.6.4.3.3.cmml">l</mi></msubsup><msub id="S3.E7.m1.6.6.4.4" xref="S3.E7.m1.6.6.4.4.cmml"><mover accent="true" id="S3.E7.m1.6.6.4.4.2" xref="S3.E7.m1.6.6.4.4.2.cmml"><mi id="S3.E7.m1.6.6.4.4.2.2" xref="S3.E7.m1.6.6.4.4.2.2.cmml">𝐰</mi><mo id="S3.E7.m1.6.6.4.4.2.1" xref="S3.E7.m1.6.6.4.4.2.1.cmml">~</mo></mover><mrow id="S3.E7.m1.6.6.4.2.2.4" xref="S3.E7.m1.6.6.4.2.2.3.cmml"><mi id="S3.E7.m1.5.5.3.1.1.1" xref="S3.E7.m1.5.5.3.1.1.1.cmml">i</mi><mo id="S3.E7.m1.6.6.4.2.2.4.1" xref="S3.E7.m1.6.6.4.2.2.3.cmml">,</mo><mi id="S3.E7.m1.6.6.4.2.2.2" xref="S3.E7.m1.6.6.4.2.2.2.cmml">k</mi></mrow></msub></mrow></mfrac><mo id="S3.E7.m1.11.11.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S3.E7.m1.11.11.1.1.1.1.3.1.cmml">⋅</mo><mi id="S3.E7.m1.11.11.1.1.1.1.3.2" xref="S3.E7.m1.11.11.1.1.1.1.3.2.cmml">l</mi></mrow><mo id="S3.E7.m1.11.11.1.1.1.1.2" xref="S3.E7.m1.11.11.1.1.1.1.2.cmml">⁢</mo><mi id="S3.E7.m1.11.11.1.1.1.1.4" xref="S3.E7.m1.11.11.1.1.1.1.4.cmml">o</mi><mo id="S3.E7.m1.11.11.1.1.1.1.2a" xref="S3.E7.m1.11.11.1.1.1.1.2.cmml">⁢</mo><mi id="S3.E7.m1.11.11.1.1.1.1.5" xref="S3.E7.m1.11.11.1.1.1.1.5.cmml">g</mi><mo id="S3.E7.m1.11.11.1.1.1.1.2b" xref="S3.E7.m1.11.11.1.1.1.1.2.cmml">⁢</mo><msub id="S3.E7.m1.11.11.1.1.1.1.6" xref="S3.E7.m1.11.11.1.1.1.1.6.cmml"><mi id="S3.E7.m1.11.11.1.1.1.1.6.2" xref="S3.E7.m1.11.11.1.1.1.1.6.2.cmml">p</mi><mi id="S3.E7.m1.11.11.1.1.1.1.6.3" xref="S3.E7.m1.11.11.1.1.1.1.6.3.cmml">θ</mi></msub><mo id="S3.E7.m1.11.11.1.1.1.1.2c" xref="S3.E7.m1.11.11.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E7.m1.11.11.1.1.1.1.1.1" xref="S3.E7.m1.11.11.1.1.1.1.1.1.1.cmml"><mo id="S3.E7.m1.11.11.1.1.1.1.1.1.2" stretchy="false" xref="S3.E7.m1.11.11.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E7.m1.11.11.1.1.1.1.1.1.1" xref="S3.E7.m1.11.11.1.1.1.1.1.1.1.cmml"><msub id="S3.E7.m1.11.11.1.1.1.1.1.1.1.5" xref="S3.E7.m1.11.11.1.1.1.1.1.1.1.5.cmml"><mi id="S3.E7.m1.11.11.1.1.1.1.1.1.1.5.2" xref="S3.E7.m1.11.11.1.1.1.1.1.1.1.5.2.cmml">y</mi><mrow id="S3.E7.m1.8.8.2.4" xref="S3.E7.m1.8.8.2.3.cmml"><mi id="S3.E7.m1.7.7.1.1" xref="S3.E7.m1.7.7.1.1.cmml">i</mi><mo id="S3.E7.m1.8.8.2.4.1" xref="S3.E7.m1.8.8.2.3.cmml">,</mo><mi id="S3.E7.m1.8.8.2.2" xref="S3.E7.m1.8.8.2.2.cmml">t</mi></mrow></msub><mo fence="false" id="S3.E7.m1.11.11.1.1.1.1.1.1.1.4" xref="S3.E7.m1.11.11.1.1.1.1.1.1.1.4.cmml">|</mo><mrow id="S3.E7.m1.11.11.1.1.1.1.1.1.1.3.3" xref="S3.E7.m1.11.11.1.1.1.1.1.1.1.3.4.cmml"><msub id="S3.E7.m1.11.11.1.1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.11.11.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E7.m1.11.11.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.11.11.1.1.1.1.1.1.1.1.1.1.2.cmml">v</mi><mi id="S3.E7.m1.11.11.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.11.11.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E7.m1.11.11.1.1.1.1.1.1.1.3.3.4" xref="S3.E7.m1.11.11.1.1.1.1.1.1.1.3.4.cmml">,</mo><msub id="S3.E7.m1.11.11.1.1.1.1.1.1.1.2.2.2" xref="S3.E7.m1.11.11.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E7.m1.11.11.1.1.1.1.1.1.1.2.2.2.2" xref="S3.E7.m1.11.11.1.1.1.1.1.1.1.2.2.2.2.cmml">x</mi><mi id="S3.E7.m1.11.11.1.1.1.1.1.1.1.2.2.2.3" xref="S3.E7.m1.11.11.1.1.1.1.1.1.1.2.2.2.3.cmml">i</mi></msub><mo id="S3.E7.m1.11.11.1.1.1.1.1.1.1.3.3.5" xref="S3.E7.m1.11.11.1.1.1.1.1.1.1.3.4.cmml">,</mo><msub id="S3.E7.m1.11.11.1.1.1.1.1.1.1.3.3.3" xref="S3.E7.m1.11.11.1.1.1.1.1.1.1.3.3.3.cmml"><mi id="S3.E7.m1.11.11.1.1.1.1.1.1.1.3.3.3.2" xref="S3.E7.m1.11.11.1.1.1.1.1.1.1.3.3.3.2.cmml">y</mi><mrow id="S3.E7.m1.10.10.2.2" xref="S3.E7.m1.10.10.2.3.cmml"><mi id="S3.E7.m1.9.9.1.1" xref="S3.E7.m1.9.9.1.1.cmml">i</mi><mo id="S3.E7.m1.10.10.2.2.2" xref="S3.E7.m1.10.10.2.3.cmml">,</mo><mrow id="S3.E7.m1.10.10.2.2.1" xref="S3.E7.m1.10.10.2.2.1.cmml"><mi id="S3.E7.m1.10.10.2.2.1.2" xref="S3.E7.m1.10.10.2.2.1.2.cmml"></mi><mo id="S3.E7.m1.10.10.2.2.1.1" xref="S3.E7.m1.10.10.2.2.1.1.cmml">&lt;</mo><mi id="S3.E7.m1.10.10.2.2.1.3" xref="S3.E7.m1.10.10.2.2.1.3.cmml">t</mi></mrow></mrow></msub></mrow></mrow><mo id="S3.E7.m1.11.11.1.1.1.1.1.1.3" stretchy="false" xref="S3.E7.m1.11.11.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E7.m1.11.11.1.2" xref="S3.E7.m1.11.11.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.11b"><apply id="S3.E7.m1.11.11.1.1.cmml" xref="S3.E7.m1.11.11.1"><eq id="S3.E7.m1.11.11.1.1.2.cmml" xref="S3.E7.m1.11.11.1.1.2"></eq><apply id="S3.E7.m1.11.11.1.1.3.cmml" xref="S3.E7.m1.11.11.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.11.11.1.1.3.1.cmml" xref="S3.E7.m1.11.11.1.1.3">superscript</csymbol><apply id="S3.E7.m1.11.11.1.1.3.2.cmml" xref="S3.E7.m1.11.11.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.11.11.1.1.3.2.1.cmml" xref="S3.E7.m1.11.11.1.1.3">subscript</csymbol><ci id="S3.E7.m1.11.11.1.1.3.2.2.cmml" xref="S3.E7.m1.11.11.1.1.3.2.2">ℒ</ci><apply id="S3.E7.m1.11.11.1.1.3.2.3.cmml" xref="S3.E7.m1.11.11.1.1.3.2.3"><times id="S3.E7.m1.11.11.1.1.3.2.3.1.cmml" xref="S3.E7.m1.11.11.1.1.3.2.3.1"></times><ci id="S3.E7.m1.11.11.1.1.3.2.3.2.cmml" xref="S3.E7.m1.11.11.1.1.3.2.3.2">𝐼</ci><ci id="S3.E7.m1.11.11.1.1.3.2.3.3.cmml" xref="S3.E7.m1.11.11.1.1.3.2.3.3">𝑁</ci><ci id="S3.E7.m1.11.11.1.1.3.2.3.4.cmml" xref="S3.E7.m1.11.11.1.1.3.2.3.4">𝐽</ci></apply></apply><list id="S3.E7.m1.2.2.2.3.cmml" xref="S3.E7.m1.2.2.2.4"><ci id="S3.E7.m1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1">𝑖</ci><ci id="S3.E7.m1.2.2.2.2.cmml" xref="S3.E7.m1.2.2.2.2">𝑡</ci></list></apply><apply id="S3.E7.m1.11.11.1.1.1.cmml" xref="S3.E7.m1.11.11.1.1.1"><minus id="S3.E7.m1.11.11.1.1.1.2.cmml" xref="S3.E7.m1.11.11.1.1.1"></minus><apply id="S3.E7.m1.11.11.1.1.1.1.cmml" xref="S3.E7.m1.11.11.1.1.1.1"><times id="S3.E7.m1.11.11.1.1.1.1.2.cmml" xref="S3.E7.m1.11.11.1.1.1.1.2"></times><apply id="S3.E7.m1.11.11.1.1.1.1.3.cmml" xref="S3.E7.m1.11.11.1.1.1.1.3"><ci id="S3.E7.m1.11.11.1.1.1.1.3.1.cmml" xref="S3.E7.m1.11.11.1.1.1.1.3.1">⋅</ci><apply id="S3.E7.m1.6.6.cmml" xref="S3.E7.m1.6.6"><divide id="S3.E7.m1.6.6.5.cmml" xref="S3.E7.m1.6.6"></divide><apply id="S3.E7.m1.4.4.2.cmml" xref="S3.E7.m1.4.4.2"><csymbol cd="ambiguous" id="S3.E7.m1.4.4.2.3.cmml" xref="S3.E7.m1.4.4.2">subscript</csymbol><apply id="S3.E7.m1.4.4.2.4.cmml" xref="S3.E7.m1.4.4.2.4"><ci id="S3.E7.m1.4.4.2.4.1.cmml" xref="S3.E7.m1.4.4.2.4.1">~</ci><ci id="S3.E7.m1.4.4.2.4.2.cmml" xref="S3.E7.m1.4.4.2.4.2">𝐰</ci></apply><list id="S3.E7.m1.4.4.2.2.2.3.cmml" xref="S3.E7.m1.4.4.2.2.2.4"><ci id="S3.E7.m1.3.3.1.1.1.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1">𝑖</ci><ci id="S3.E7.m1.4.4.2.2.2.2.cmml" xref="S3.E7.m1.4.4.2.2.2.2">𝑡</ci></list></apply><apply id="S3.E7.m1.6.6.4.cmml" xref="S3.E7.m1.6.6.4"><apply id="S3.E7.m1.6.6.4.3.cmml" xref="S3.E7.m1.6.6.4.3"><csymbol cd="ambiguous" id="S3.E7.m1.6.6.4.3.1.cmml" xref="S3.E7.m1.6.6.4.3">superscript</csymbol><apply id="S3.E7.m1.6.6.4.3.2.cmml" xref="S3.E7.m1.6.6.4.3"><csymbol cd="ambiguous" id="S3.E7.m1.6.6.4.3.2.1.cmml" xref="S3.E7.m1.6.6.4.3">subscript</csymbol><sum id="S3.E7.m1.6.6.4.3.2.2.cmml" xref="S3.E7.m1.6.6.4.3.2.2"></sum><apply id="S3.E7.m1.6.6.4.3.2.3.cmml" xref="S3.E7.m1.6.6.4.3.2.3"><eq id="S3.E7.m1.6.6.4.3.2.3.1.cmml" xref="S3.E7.m1.6.6.4.3.2.3.1"></eq><ci id="S3.E7.m1.6.6.4.3.2.3.2.cmml" xref="S3.E7.m1.6.6.4.3.2.3.2">𝑘</ci><cn id="S3.E7.m1.6.6.4.3.2.3.3.cmml" type="integer" xref="S3.E7.m1.6.6.4.3.2.3.3">1</cn></apply></apply><ci id="S3.E7.m1.6.6.4.3.3.cmml" xref="S3.E7.m1.6.6.4.3.3">𝑙</ci></apply><apply id="S3.E7.m1.6.6.4.4.cmml" xref="S3.E7.m1.6.6.4.4"><csymbol cd="ambiguous" id="S3.E7.m1.6.6.4.4.1.cmml" xref="S3.E7.m1.6.6.4.4">subscript</csymbol><apply id="S3.E7.m1.6.6.4.4.2.cmml" xref="S3.E7.m1.6.6.4.4.2"><ci id="S3.E7.m1.6.6.4.4.2.1.cmml" xref="S3.E7.m1.6.6.4.4.2.1">~</ci><ci id="S3.E7.m1.6.6.4.4.2.2.cmml" xref="S3.E7.m1.6.6.4.4.2.2">𝐰</ci></apply><list id="S3.E7.m1.6.6.4.2.2.3.cmml" xref="S3.E7.m1.6.6.4.2.2.4"><ci id="S3.E7.m1.5.5.3.1.1.1.cmml" xref="S3.E7.m1.5.5.3.1.1.1">𝑖</ci><ci id="S3.E7.m1.6.6.4.2.2.2.cmml" xref="S3.E7.m1.6.6.4.2.2.2">𝑘</ci></list></apply></apply></apply><ci id="S3.E7.m1.11.11.1.1.1.1.3.2.cmml" xref="S3.E7.m1.11.11.1.1.1.1.3.2">𝑙</ci></apply><ci id="S3.E7.m1.11.11.1.1.1.1.4.cmml" xref="S3.E7.m1.11.11.1.1.1.1.4">𝑜</ci><ci id="S3.E7.m1.11.11.1.1.1.1.5.cmml" xref="S3.E7.m1.11.11.1.1.1.1.5">𝑔</ci><apply id="S3.E7.m1.11.11.1.1.1.1.6.cmml" xref="S3.E7.m1.11.11.1.1.1.1.6"><csymbol cd="ambiguous" id="S3.E7.m1.11.11.1.1.1.1.6.1.cmml" xref="S3.E7.m1.11.11.1.1.1.1.6">subscript</csymbol><ci id="S3.E7.m1.11.11.1.1.1.1.6.2.cmml" xref="S3.E7.m1.11.11.1.1.1.1.6.2">𝑝</ci><ci id="S3.E7.m1.11.11.1.1.1.1.6.3.cmml" xref="S3.E7.m1.11.11.1.1.1.1.6.3">𝜃</ci></apply><apply id="S3.E7.m1.11.11.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.11.11.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E7.m1.11.11.1.1.1.1.1.1.1.4.cmml" xref="S3.E7.m1.11.11.1.1.1.1.1.1.1.4">conditional</csymbol><apply id="S3.E7.m1.11.11.1.1.1.1.1.1.1.5.cmml" xref="S3.E7.m1.11.11.1.1.1.1.1.1.1.5"><csymbol cd="ambiguous" id="S3.E7.m1.11.11.1.1.1.1.1.1.1.5.1.cmml" xref="S3.E7.m1.11.11.1.1.1.1.1.1.1.5">subscript</csymbol><ci id="S3.E7.m1.11.11.1.1.1.1.1.1.1.5.2.cmml" xref="S3.E7.m1.11.11.1.1.1.1.1.1.1.5.2">𝑦</ci><list id="S3.E7.m1.8.8.2.3.cmml" xref="S3.E7.m1.8.8.2.4"><ci id="S3.E7.m1.7.7.1.1.cmml" xref="S3.E7.m1.7.7.1.1">𝑖</ci><ci id="S3.E7.m1.8.8.2.2.cmml" xref="S3.E7.m1.8.8.2.2">𝑡</ci></list></apply><list id="S3.E7.m1.11.11.1.1.1.1.1.1.1.3.4.cmml" xref="S3.E7.m1.11.11.1.1.1.1.1.1.1.3.3"><apply id="S3.E7.m1.11.11.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.11.11.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.11.11.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.11.11.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E7.m1.11.11.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.11.11.1.1.1.1.1.1.1.1.1.1.2">𝑣</ci><ci id="S3.E7.m1.11.11.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.11.11.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E7.m1.11.11.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E7.m1.11.11.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.11.11.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E7.m1.11.11.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E7.m1.11.11.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E7.m1.11.11.1.1.1.1.1.1.1.2.2.2.2">𝑥</ci><ci id="S3.E7.m1.11.11.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E7.m1.11.11.1.1.1.1.1.1.1.2.2.2.3">𝑖</ci></apply><apply id="S3.E7.m1.11.11.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E7.m1.11.11.1.1.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E7.m1.11.11.1.1.1.1.1.1.1.3.3.3.1.cmml" xref="S3.E7.m1.11.11.1.1.1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S3.E7.m1.11.11.1.1.1.1.1.1.1.3.3.3.2.cmml" xref="S3.E7.m1.11.11.1.1.1.1.1.1.1.3.3.3.2">𝑦</ci><list id="S3.E7.m1.10.10.2.3.cmml" xref="S3.E7.m1.10.10.2.2"><ci id="S3.E7.m1.9.9.1.1.cmml" xref="S3.E7.m1.9.9.1.1">𝑖</ci><apply id="S3.E7.m1.10.10.2.2.1.cmml" xref="S3.E7.m1.10.10.2.2.1"><lt id="S3.E7.m1.10.10.2.2.1.1.cmml" xref="S3.E7.m1.10.10.2.2.1.1"></lt><csymbol cd="latexml" id="S3.E7.m1.10.10.2.2.1.2.cmml" xref="S3.E7.m1.10.10.2.2.1.2">absent</csymbol><ci id="S3.E7.m1.10.10.2.2.1.3.cmml" xref="S3.E7.m1.10.10.2.2.1.3">𝑡</ci></apply></list></apply></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.11c">\mathcal{L}_{INJ}^{i,t}=-\frac{{\mathbf{\tilde{w}}}_{i,t}}{\sum_{k=1}^{l}{%
\mathbf{\tilde{w}}}_{i,k}}\cdot logp_{\theta}(y_{i,t}|v_{i},x_{i},y_{i,&lt;t}),</annotation><annotation encoding="application/x-llamapun" id="S3.E7.m1.11d">caligraphic_L start_POSTSUBSCRIPT italic_I italic_N italic_J end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i , italic_t end_POSTSUPERSCRIPT = - divide start_ARG over~ start_ARG bold_w end_ARG start_POSTSUBSCRIPT italic_i , italic_t end_POSTSUBSCRIPT end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT over~ start_ARG bold_w end_ARG start_POSTSUBSCRIPT italic_i , italic_k end_POSTSUBSCRIPT end_ARG ⋅ italic_l italic_o italic_g italic_p start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_i , italic_t end_POSTSUBSCRIPT | italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_i , &lt; italic_t end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.SSS0.Px2.p1.17">where <math alttext="l" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px2.p1.16.m1.1"><semantics id="S3.SS4.SSS0.Px2.p1.16.m1.1a"><mi id="S3.SS4.SSS0.Px2.p1.16.m1.1.1" xref="S3.SS4.SSS0.Px2.p1.16.m1.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px2.p1.16.m1.1b"><ci id="S3.SS4.SSS0.Px2.p1.16.m1.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.16.m1.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px2.p1.16.m1.1c">l</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px2.p1.16.m1.1d">italic_l</annotation></semantics></math> and <math alttext="\mathbf{\tilde{w}}" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px2.p1.17.m2.1"><semantics id="S3.SS4.SSS0.Px2.p1.17.m2.1a"><mover accent="true" id="S3.SS4.SSS0.Px2.p1.17.m2.1.1" xref="S3.SS4.SSS0.Px2.p1.17.m2.1.1.cmml"><mi id="S3.SS4.SSS0.Px2.p1.17.m2.1.1.2" xref="S3.SS4.SSS0.Px2.p1.17.m2.1.1.2.cmml">𝐰</mi><mo id="S3.SS4.SSS0.Px2.p1.17.m2.1.1.1" xref="S3.SS4.SSS0.Px2.p1.17.m2.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px2.p1.17.m2.1b"><apply id="S3.SS4.SSS0.Px2.p1.17.m2.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.17.m2.1.1"><ci id="S3.SS4.SSS0.Px2.p1.17.m2.1.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.17.m2.1.1.1">~</ci><ci id="S3.SS4.SSS0.Px2.p1.17.m2.1.1.2.cmml" xref="S3.SS4.SSS0.Px2.p1.17.m2.1.1.2">𝐰</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px2.p1.17.m2.1c">\mathbf{\tilde{w}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px2.p1.17.m2.1d">over~ start_ARG bold_w end_ARG</annotation></semantics></math> represent the length of textual tokens and the smooth weight, respectively.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments and Analysis</h2>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Experiment Setup</h3>
<section class="ltx_paragraph" id="S4.SS1.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Datasets and Evaluation Metrics</h4>
<div class="ltx_para ltx_noindent" id="S4.SS1.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS1.SSS0.Px1.p1.1">For evaluation, we consider the image-related subsets of two multimodal QA datasets WebQA and MultimodalQA. Both datasets contain multimodal knowledge-seeking query-answer pairs. Since the test set labels from both datasets are not publicly available, we report the results on the validation set. Each query is associated with a set of hard negative distractors so that two evaluation setups can be used, namely distractor and full-wiki. However, we only consider the full-wiki setting to demonstrate the superiority of our <span class="ltx_text ltx_font_italic" id="S4.SS1.SSS0.Px1.p1.1.1">retrieval-rerank-generation</span> pipeline. Additionally, we conduct more experiments on Flickr30K <cite class="ltx_cite ltx_citemacro_citep">(Young et al., <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#bib.bib46" title="">2014</a>)</cite> and MS-COCO <cite class="ltx_cite ltx_citemacro_citep">(Lin et al., <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#bib.bib29" title="">2014</a>)</cite> to evaluate the performance on caption-to-image retrieval tasks. More details can be found in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#A1" title="Appendix A Data Statistics and Evaluation Metrics ‣ MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_tag">A</span></a>,  <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#A2" title="Appendix B Implementation Details ‣ MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_tag">B</span></a> and  <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#A5" title="Appendix E Performance on Caption-to-image Retrieval ‣ MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_tag">E</span></a>.</p>
</div>
<figure class="ltx_table" id="S4.T1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Performance of knowledge-enhanced rerankers on multimodal knowledge-seeking. The reranking is conducted based on the top 20 candidates from the retrievers (see details in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#A1" title="Appendix A Data Statistics and Evaluation Metrics ‣ MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_tag">A</span></a>). The best scores in each setting are in <span class="ltx_text ltx_font_bold" id="S4.T1.2.1">bold</span>.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T1.3">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T1.3.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="S4.T1.3.1.1.1" rowspan="2" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text" id="S4.T1.3.1.1.1.1">Methods</span></th>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="3" id="S4.T1.3.1.1.2" style="padding-left:12.8pt;padding-right:12.8pt;">MultimodalQA</td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="3" id="S4.T1.3.1.1.3" style="padding-left:12.8pt;padding-right:12.8pt;">WebQA</td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.2.2">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.2.2.1" style="padding-left:12.8pt;padding-right:12.8pt;">R@1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.2.2.2" style="padding-left:12.8pt;padding-right:12.8pt;">R@5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.2.2.3" style="padding-left:12.8pt;padding-right:12.8pt;">R@10</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.2.2.4" style="padding-left:12.8pt;padding-right:12.8pt;">R@2</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.2.2.5" style="padding-left:12.8pt;padding-right:12.8pt;">R@5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.2.2.6" style="padding-left:12.8pt;padding-right:12.8pt;">R@10</td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T1.3.3.3.1" style="padding-left:12.8pt;padding-right:12.8pt;">CLIP-ViT-L/14-336px</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.3.3.2" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.3.3.3.2.1">84.78</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.3.3.3" style="padding-left:12.8pt;padding-right:12.8pt;">94.35</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.3.3.4" style="padding-left:12.8pt;padding-right:12.8pt;">95.65</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.3.3.5" style="padding-left:12.8pt;padding-right:12.8pt;">57.10</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.3.3.6" style="padding-left:12.8pt;padding-right:12.8pt;">71.96</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.3.3.7" style="padding-left:12.8pt;padding-right:12.8pt;">84.86</td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.3.4.4.1" style="padding-left:12.8pt;padding-right:12.8pt;">     <span class="ltx_text ltx_font_italic" id="S4.T1.3.4.4.1.1">w/ SFT</span>
</th>
<td class="ltx_td ltx_align_center" id="S4.T1.3.4.4.2" style="padding-left:12.8pt;padding-right:12.8pt;">83.04</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.4.4.3" style="padding-left:12.8pt;padding-right:12.8pt;">94.35</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.4.4.4" style="padding-left:12.8pt;padding-right:12.8pt;">94.78</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.4.4.5" style="padding-left:12.8pt;padding-right:12.8pt;">55.09</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.4.4.6" style="padding-left:12.8pt;padding-right:12.8pt;">73.23</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.4.4.7" style="padding-left:12.8pt;padding-right:12.8pt;">81.94</td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.5.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.3.5.5.1" style="padding-left:12.8pt;padding-right:12.8pt;">Vis-BGE-base</th>
<td class="ltx_td ltx_align_center" id="S4.T1.3.5.5.2" style="padding-left:12.8pt;padding-right:12.8pt;">49.57</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.5.5.3" style="padding-left:12.8pt;padding-right:12.8pt;">74.78</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.5.5.4" style="padding-left:12.8pt;padding-right:12.8pt;">82.61</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.5.5.5" style="padding-left:12.8pt;padding-right:12.8pt;">28.78</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.5.5.6" style="padding-left:12.8pt;padding-right:12.8pt;">43.62</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.5.5.7" style="padding-left:12.8pt;padding-right:12.8pt;">54.56</td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.3.6.6.1" style="padding-left:12.8pt;padding-right:12.8pt;">Vis-BGE-m3</th>
<td class="ltx_td ltx_align_center" id="S4.T1.3.6.6.2" style="padding-left:12.8pt;padding-right:12.8pt;">43.48</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.6.6.3" style="padding-left:12.8pt;padding-right:12.8pt;">66.52</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.6.6.4" style="padding-left:12.8pt;padding-right:12.8pt;">72.17</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.6.6.5" style="padding-left:12.8pt;padding-right:12.8pt;">26.69</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.6.6.6" style="padding-left:12.8pt;padding-right:12.8pt;">40.75</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.6.6.7" style="padding-left:12.8pt;padding-right:12.8pt;">51.14</td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.7.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.3.7.7.1" style="padding-left:12.8pt;padding-right:12.8pt;">InternVL-C</th>
<td class="ltx_td ltx_align_center" id="S4.T1.3.7.7.2" style="padding-left:12.8pt;padding-right:12.8pt;">82.17</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.7.7.3" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.3.7.7.3.1">95.65</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.7.7.4" style="padding-left:12.8pt;padding-right:12.8pt;">96.96</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.7.7.5" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.3.7.7.5.1">64.90</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.7.7.6" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.3.7.7.6.1">81.22</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.7.7.7" style="padding-left:12.8pt;padding-right:12.8pt;">88.09</td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.8.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.3.8.8.1" style="padding-left:12.8pt;padding-right:12.8pt;">InternVL-G</th>
<td class="ltx_td ltx_align_center" id="S4.T1.3.8.8.2" style="padding-left:12.8pt;padding-right:12.8pt;">82.17</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.8.8.3" style="padding-left:12.8pt;padding-right:12.8pt;">95.22</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.8.8.4" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.3.8.8.4.1">97.39</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.8.8.5" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.3.8.8.5.1">64.90</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.8.8.6" style="padding-left:12.8pt;padding-right:12.8pt;">80.23</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.8.8.7" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.3.8.8.7.1">88.28</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.9.9">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="7" id="S4.T1.3.9.9.1" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text ltx_font_italic" id="S4.T1.3.9.9.1.1">Reranking Top-K from CLIP-ViT-L/14-336px</span></th>
</tr>
<tr class="ltx_tr" id="S4.T1.3.10.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T1.3.10.10.1" style="padding-left:12.8pt;padding-right:12.8pt;">LLaVA-v1.5-13B</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.10.10.2" style="padding-left:12.8pt;padding-right:12.8pt;">72.61</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.10.10.3" style="padding-left:12.8pt;padding-right:12.8pt;">90.87</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.10.10.4" style="padding-left:12.8pt;padding-right:12.8pt;">95.22</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.10.10.5" style="padding-left:12.8pt;padding-right:12.8pt;">45.35</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.10.10.6" style="padding-left:12.8pt;padding-right:12.8pt;">65.87</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.10.10.7" style="padding-left:12.8pt;padding-right:12.8pt;">80.56</td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.11.11" style="background-color:#D9D9D9;">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.3.11.11.1" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text" id="S4.T1.3.11.11.1.1" style="background-color:#D9D9D9;">     <span class="ltx_text ltx_font_italic" id="S4.T1.3.11.11.1.1.1">w/ caption-aware</span> IT</span></th>
<td class="ltx_td ltx_align_center" id="S4.T1.3.11.11.2" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.3.11.11.2.1" style="background-color:#D9D9D9;">98.26</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.11.11.3" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.3.11.11.3.1" style="background-color:#D9D9D9;">98.26</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.11.11.4" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.3.11.11.4.1" style="background-color:#D9D9D9;">98.26</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.11.11.5" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text" id="S4.T1.3.11.11.5.1" style="background-color:#D9D9D9;">79.74</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.11.11.6" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text" id="S4.T1.3.11.11.6.1" style="background-color:#D9D9D9;">88.14</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.11.11.7" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text" id="S4.T1.3.11.11.7.1" style="background-color:#D9D9D9;">89.77</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.12.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.3.12.12.1" style="padding-left:12.8pt;padding-right:12.8pt;">mPLUG-Owl2</th>
<td class="ltx_td ltx_align_center" id="S4.T1.3.12.12.2" style="padding-left:12.8pt;padding-right:12.8pt;">67.83</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.12.12.3" style="padding-left:12.8pt;padding-right:12.8pt;">87.39</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.12.12.4" style="padding-left:12.8pt;padding-right:12.8pt;">93.91</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.12.12.5" style="padding-left:12.8pt;padding-right:12.8pt;">43.26</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.12.12.6" style="padding-left:12.8pt;padding-right:12.8pt;">63.80</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.12.12.7" style="padding-left:12.8pt;padding-right:12.8pt;">79.38</td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.13.13" style="background-color:#D9D9D9;">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.3.13.13.1" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text" id="S4.T1.3.13.13.1.1" style="background-color:#D9D9D9;">     <span class="ltx_text ltx_font_italic" id="S4.T1.3.13.13.1.1.1">w/ caption-aware</span> IT</span></th>
<td class="ltx_td ltx_align_center" id="S4.T1.3.13.13.2" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text" id="S4.T1.3.13.13.2.1" style="background-color:#D9D9D9;">90.87</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.13.13.3" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text" id="S4.T1.3.13.13.3.1" style="background-color:#D9D9D9;">96.09</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.13.13.4" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text" id="S4.T1.3.13.13.4.1" style="background-color:#D9D9D9;">97.39</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.13.13.5" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text" id="S4.T1.3.13.13.5.1" style="background-color:#D9D9D9;">71.27</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.13.13.6" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text" id="S4.T1.3.13.13.6.1" style="background-color:#D9D9D9;">85.08</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.13.13.7" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text" id="S4.T1.3.13.13.7.1" style="background-color:#D9D9D9;">88.97</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.14.14">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.3.14.14.1" style="padding-left:12.8pt;padding-right:12.8pt;">Qwen-VL-Chat</th>
<td class="ltx_td ltx_align_center" id="S4.T1.3.14.14.2" style="padding-left:12.8pt;padding-right:12.8pt;">68.26</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.14.14.3" style="padding-left:12.8pt;padding-right:12.8pt;">89.57</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.14.14.4" style="padding-left:12.8pt;padding-right:12.8pt;">92.61</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.14.14.5" style="padding-left:12.8pt;padding-right:12.8pt;">47.64</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.14.14.6" style="padding-left:12.8pt;padding-right:12.8pt;">67.22</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.14.14.7" style="padding-left:12.8pt;padding-right:12.8pt;">80.42</td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.15.15" style="background-color:#D9D9D9;">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.3.15.15.1" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text" id="S4.T1.3.15.15.1.1" style="background-color:#D9D9D9;">     <span class="ltx_text ltx_font_italic" id="S4.T1.3.15.15.1.1.1">w/ caption-aware</span> IT</span></th>
<td class="ltx_td ltx_align_center" id="S4.T1.3.15.15.2" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text" id="S4.T1.3.15.15.2.1" style="background-color:#D9D9D9;">91.30</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.15.15.3" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text" id="S4.T1.3.15.15.3.1" style="background-color:#D9D9D9;">95.65</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.15.15.4" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text" id="S4.T1.3.15.15.4.1" style="background-color:#D9D9D9;">97.39</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.15.15.5" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text" id="S4.T1.3.15.15.5.1" style="background-color:#D9D9D9;">80.12</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.15.15.6" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text" id="S4.T1.3.15.15.6.1" style="background-color:#D9D9D9;">88.53</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.15.15.7" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.3.15.15.7.1" style="background-color:#D9D9D9;">89.96</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.16.16">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.3.16.16.1" style="padding-left:12.8pt;padding-right:12.8pt;">InternVL2-1B</th>
<td class="ltx_td ltx_align_center" id="S4.T1.3.16.16.2" style="padding-left:12.8pt;padding-right:12.8pt;">47.39</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.16.16.3" style="padding-left:12.8pt;padding-right:12.8pt;">84.78</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.16.16.4" style="padding-left:12.8pt;padding-right:12.8pt;">93.91</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.16.16.5" style="padding-left:12.8pt;padding-right:12.8pt;">34.99</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.16.16.6" style="padding-left:12.8pt;padding-right:12.8pt;">57.49</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.16.16.7" style="padding-left:12.8pt;padding-right:12.8pt;">74.72</td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.17.17" style="background-color:#D9D9D9;">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.3.17.17.1" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text" id="S4.T1.3.17.17.1.1" style="background-color:#D9D9D9;">     <span class="ltx_text ltx_font_italic" id="S4.T1.3.17.17.1.1.1">w/ caption-aware</span> IT</span></th>
<td class="ltx_td ltx_align_center" id="S4.T1.3.17.17.2" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.3.17.17.2.1" style="background-color:#D9D9D9;">98.26</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.17.17.3" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.3.17.17.3.1" style="background-color:#D9D9D9;">98.26</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.17.17.4" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.3.17.17.4.1" style="background-color:#D9D9D9;">98.26</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.17.17.5" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.3.17.17.5.1" style="background-color:#D9D9D9;">82.00</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.17.17.6" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text" id="S4.T1.3.17.17.6.1" style="background-color:#D9D9D9;">88.78</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.17.17.7" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text" id="S4.T1.3.17.17.7.1" style="background-color:#D9D9D9;">89.94</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.18.18">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.3.18.18.1" style="padding-left:12.8pt;padding-right:12.8pt;">InternVL2-2B</th>
<td class="ltx_td ltx_align_center" id="S4.T1.3.18.18.2" style="padding-left:12.8pt;padding-right:12.8pt;">66.52</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.18.18.3" style="padding-left:12.8pt;padding-right:12.8pt;">88.70</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.18.18.4" style="padding-left:12.8pt;padding-right:12.8pt;">93.91</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.18.18.5" style="padding-left:12.8pt;padding-right:12.8pt;">42.79</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.18.18.6" style="padding-left:12.8pt;padding-right:12.8pt;">62.48</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.18.18.7" style="padding-left:12.8pt;padding-right:12.8pt;">77.97</td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.19.19" style="background-color:#D9D9D9;">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.3.19.19.1" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text" id="S4.T1.3.19.19.1.1" style="background-color:#D9D9D9;">     <span class="ltx_text ltx_font_italic" id="S4.T1.3.19.19.1.1.1">w/ caption-aware</span> IT</span></th>
<td class="ltx_td ltx_align_center" id="S4.T1.3.19.19.2" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.3.19.19.2.1" style="background-color:#D9D9D9;">98.26</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.19.19.3" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.3.19.19.3.1" style="background-color:#D9D9D9;">98.26</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.19.19.4" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.3.19.19.4.1" style="background-color:#D9D9D9;">98.26</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.19.19.5" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text" id="S4.T1.3.19.19.5.1" style="background-color:#D9D9D9;">81.91</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.19.19.6" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.3.19.19.6.1" style="background-color:#D9D9D9;">88.94</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.19.19.7" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text" id="S4.T1.3.19.19.7.1" style="background-color:#D9D9D9;">89.94</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.20.20">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="7" id="S4.T1.3.20.20.1" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text ltx_font_italic" id="S4.T1.3.20.20.1.1">Reranking Top-K from Different Retrievers</span></th>
</tr>
<tr class="ltx_tr" id="S4.T1.3.21.21">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T1.3.21.21.1" style="padding-left:12.8pt;padding-right:12.8pt;">LLaVA-v1.5-13B</th>
<td class="ltx_td ltx_border_t" id="S4.T1.3.21.21.2" style="padding-left:12.8pt;padding-right:12.8pt;"></td>
<td class="ltx_td ltx_border_t" id="S4.T1.3.21.21.3" style="padding-left:12.8pt;padding-right:12.8pt;"></td>
<td class="ltx_td ltx_border_t" id="S4.T1.3.21.21.4" style="padding-left:12.8pt;padding-right:12.8pt;"></td>
<td class="ltx_td ltx_border_t" id="S4.T1.3.21.21.5" style="padding-left:12.8pt;padding-right:12.8pt;"></td>
<td class="ltx_td ltx_border_t" id="S4.T1.3.21.21.6" style="padding-left:12.8pt;padding-right:12.8pt;"></td>
<td class="ltx_td ltx_border_t" id="S4.T1.3.21.21.7" style="padding-left:12.8pt;padding-right:12.8pt;"></td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.22.22">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.3.22.22.1" style="padding-left:12.8pt;padding-right:12.8pt;">     <span class="ltx_text ltx_font_italic" id="S4.T1.3.22.22.1.1">w/ Vis-BGE-base</span>
</th>
<td class="ltx_td ltx_align_center" id="S4.T1.3.22.22.2" style="padding-left:12.8pt;padding-right:12.8pt;">88.70</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.22.22.3" style="padding-left:12.8pt;padding-right:12.8pt;">88.70</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.22.22.4" style="padding-left:12.8pt;padding-right:12.8pt;">88.70</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.22.22.5" style="padding-left:12.8pt;padding-right:12.8pt;">59.61</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.22.22.6" style="padding-left:12.8pt;padding-right:12.8pt;">64.71</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.22.22.7" style="padding-left:12.8pt;padding-right:12.8pt;">65.70</td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.23.23">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.3.23.23.1" style="padding-left:12.8pt;padding-right:12.8pt;">     <span class="ltx_text ltx_font_italic" id="S4.T1.3.23.23.1.1">w/ Vis-BGE-m3</span>
</th>
<td class="ltx_td ltx_align_center" id="S4.T1.3.23.23.2" style="padding-left:12.8pt;padding-right:12.8pt;">84.78</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.23.23.3" style="padding-left:12.8pt;padding-right:12.8pt;">84.78</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.23.23.4" style="padding-left:12.8pt;padding-right:12.8pt;">84.78</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.23.23.5" style="padding-left:12.8pt;padding-right:12.8pt;">57.57</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.23.23.6" style="padding-left:12.8pt;padding-right:12.8pt;">62.26</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.23.23.7" style="padding-left:12.8pt;padding-right:12.8pt;">63.03</td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.24.24">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.3.24.24.1" style="padding-left:12.8pt;padding-right:12.8pt;">     <span class="ltx_text ltx_font_italic" id="S4.T1.3.24.24.1.1">w/ InternVL-C</span>
</th>
<td class="ltx_td ltx_align_center" id="S4.T1.3.24.24.2" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.3.24.24.2.1">98.70</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.24.24.3" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.3.24.24.3.1">98.70</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.24.24.4" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.3.24.24.4.1">98.70</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.24.24.5" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.3.24.24.5.1">82.08</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.24.24.6" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.3.24.24.6.1">90.79</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.24.24.7" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.3.24.24.7.1">92.72</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.25.25">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S4.T1.3.25.25.1" style="padding-left:12.8pt;padding-right:12.8pt;">     <span class="ltx_text ltx_font_italic" id="S4.T1.3.25.25.1.1">w/ InternVL-G</span>
</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.3.25.25.2" style="padding-left:12.8pt;padding-right:12.8pt;">97.83</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.3.25.25.3" style="padding-left:12.8pt;padding-right:12.8pt;">97.83</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.3.25.25.4" style="padding-left:12.8pt;padding-right:12.8pt;">97.83</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.3.25.25.5" style="padding-left:12.8pt;padding-right:12.8pt;">81.91</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.3.25.25.6" style="padding-left:12.8pt;padding-right:12.8pt;">90.24</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.3.25.25.7" style="padding-left:12.8pt;padding-right:12.8pt;">92.31</td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Evaluation on Multimodal Knowledge-seeking</h3>
<section class="ltx_paragraph" id="S4.SS2.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Results of Retrieval</h4>
<div class="ltx_para ltx_noindent" id="S4.SS2.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS2.SSS0.Px1.p1.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#S4.T1" title="Table 1 ‣ Datasets and Evaluation Metrics ‣ 4.1 Experiment Setup ‣ 4 Experiments and Analysis ‣ MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_tag">1</span></a> shows the performance of knowledge-enhanced rerankers on MulitmodalQA and WebQA. The experimental results show that the retriever performs weakly regarding precise recall (R@1 and R@2) on both datasets, making it difficult for accurate multimodal retrieval-augmented generation. Since the captions from the two datasets are basically names of objects or places, it isn’t easy to adapt to the scenarios using vanilla contrastive learning, as proven in the table. After inducing the ranking abilities of MLLMs, our proposed method effectively improves the retrieval performance by a large margin. Specifically, with five MLLMs, our method consistently improves R@2 on WebQA by an average of 40%. Notably, on MultimodalQA, it reaches the upper limit of Recall@20 (98.26%) from CLIP on LLaVA-v1.5-13B and InternVL2-1/2B. These demonstrate the superior performance of our proposed method in multimodal knowledge retrieval.</p>
</div>
<figure class="ltx_figure" id="S4.F3">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F3.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="494" id="S4.F3.sf1.g1" src="x3.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(a) </span>Generalizability of reranking.</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F3.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="471" id="S4.F3.sf2.g1" src="x4.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(b) </span>Low-resource settings on WebQA.</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Generalizabilities of caption-aware instruction tuning. (a) compares the performance of the reranker fine-tuned on WebQA with the one fine-tuned on MultimodalQA, evaluated on MultimodalQA. (b) visualizes the changes in the probability distribution of correctly recalled items and the recall rate of the reranker under low-resource settings as the scale of the training dataset varies.</figcaption>
</figure>
<figure class="ltx_figure" id="S4.F4">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F4.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="564" id="S4.F4.sf1.g1" src="x5.png" width="761"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(a) </span>Train set</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F4.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="564" id="S4.F4.sf2.g1" src="x6.png" width="761"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(b) </span>Validation set</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F4.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="564" id="S4.F4.sf3.g1" src="x7.png" width="761"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(c) </span>Test set</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Density distribution of the relevance probability of correct and incorrect recalls on WebQA after reranking from the InternVL2-2B reranker.</figcaption>
</figure>
<figure class="ltx_table" id="S4.T2">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Performance of InternVL2-2B reranker on two benchmark datasets. <span class="ltx_text ltx_font_italic" id="S4.T2.6.1">P</span> and <span class="ltx_text ltx_font_italic" id="S4.T2.7.2">R</span> denote precision and recall, respectively. The best scores in each setting are in <span class="ltx_text ltx_font_bold" id="S4.T2.8.3">bold</span>.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T2.2">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T2.2.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="S4.T2.2.3.1.1" rowspan="2" style="padding-left:11.4pt;padding-right:11.4pt;"><span class="ltx_text" id="S4.T2.2.3.1.1.1">Methods</span></th>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="3" id="S4.T2.2.3.1.2" style="padding-left:11.4pt;padding-right:11.4pt;">MultimodalQA</td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="3" id="S4.T2.2.3.1.3" style="padding-left:11.4pt;padding-right:11.4pt;">WebQA</td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.4.2">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.4.2.1" style="padding-left:11.4pt;padding-right:11.4pt;">P</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.4.2.2" style="padding-left:11.4pt;padding-right:11.4pt;">R</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.4.2.3" style="padding-left:11.4pt;padding-right:11.4pt;">F1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.4.2.4" style="padding-left:11.4pt;padding-right:11.4pt;">P</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.4.2.5" style="padding-left:11.4pt;padding-right:11.4pt;">R</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.4.2.6" style="padding-left:11.4pt;padding-right:11.4pt;">F1</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T2.1.1.1" style="padding-left:11.4pt;padding-right:11.4pt;">CLIP Top-<math alttext="N" class="ltx_Math" display="inline" id="S4.T2.1.1.1.m1.1"><semantics id="S4.T2.1.1.1.m1.1a"><mi id="S4.T2.1.1.1.m1.1.1" xref="S4.T2.1.1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.T2.1.1.1.m1.1b"><ci id="S4.T2.1.1.1.m1.1.1.cmml" xref="S4.T2.1.1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.1.1.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S4.T2.1.1.1.m1.1d">italic_N</annotation></semantics></math>
</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.2" style="padding-left:11.4pt;padding-right:11.4pt;">84.78</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.3" style="padding-left:11.4pt;padding-right:11.4pt;">84.78</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.4" style="padding-left:11.4pt;padding-right:11.4pt;">84.78</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.5" style="padding-left:11.4pt;padding-right:11.4pt;">41.24</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.6" style="padding-left:11.4pt;padding-right:11.4pt;">57.10</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.7" style="padding-left:11.4pt;padding-right:11.4pt;">47.89</td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.5.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="7" id="S4.T2.2.5.3.1" style="padding-left:11.4pt;padding-right:11.4pt;"><span class="ltx_text ltx_font_italic" id="S4.T2.2.5.3.1.1">Caption-aware Instruction Tuning</span></th>
</tr>
<tr class="ltx_tr" id="S4.T2.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T2.2.2.1" style="padding-left:11.4pt;padding-right:11.4pt;">CLIP Top-<math alttext="K" class="ltx_Math" display="inline" id="S4.T2.2.2.1.m1.1"><semantics id="S4.T2.2.2.1.m1.1a"><mi id="S4.T2.2.2.1.m1.1.1" xref="S4.T2.2.2.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.T2.2.2.1.m1.1b"><ci id="S4.T2.2.2.1.m1.1.1.cmml" xref="S4.T2.2.2.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.2.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.T2.2.2.1.m1.1d">italic_K</annotation></semantics></math> + Reranker</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.2.2" style="padding-left:11.4pt;padding-right:11.4pt;">98.26</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.2.3" style="padding-left:11.4pt;padding-right:11.4pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.2.2.3.1">98.26</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.2.4" style="padding-left:11.4pt;padding-right:11.4pt;">98.26</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.2.5" style="padding-left:11.4pt;padding-right:11.4pt;">59.26</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.2.6" style="padding-left:11.4pt;padding-right:11.4pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.2.2.6.1">82.05</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.2.7" style="padding-left:11.4pt;padding-right:11.4pt;">68.82</td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.6.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T2.2.6.4.1" style="padding-left:11.4pt;padding-right:11.4pt;">     <span class="ltx_text ltx_font_italic" id="S4.T2.2.6.4.1.1">w/</span> Natural Threshold</th>
<td class="ltx_td ltx_align_center" id="S4.T2.2.6.4.2" style="padding-left:11.4pt;padding-right:11.4pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.2.6.4.2.1">100.00</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.6.4.3" style="padding-left:11.4pt;padding-right:11.4pt;">97.83</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.6.4.4" style="padding-left:11.4pt;padding-right:11.4pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.2.6.4.4.1">98.90</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.6.4.5" style="padding-left:11.4pt;padding-right:11.4pt;">74.89</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.6.4.6" style="padding-left:11.4pt;padding-right:11.4pt;">80.59</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.6.4.7" style="padding-left:11.4pt;padding-right:11.4pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.2.6.4.7.1">77.64</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.7.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S4.T2.2.7.5.1" style="padding-left:11.4pt;padding-right:11.4pt;">     <span class="ltx_text ltx_font_italic" id="S4.T2.2.7.5.1.1">w/</span> Adaptive Threshold</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.2.7.5.2" style="padding-left:11.4pt;padding-right:11.4pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.2.7.5.2.1">100.00</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.2.7.5.3" style="padding-left:11.4pt;padding-right:11.4pt;">97.83</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.2.7.5.4" style="padding-left:11.4pt;padding-right:11.4pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.2.7.5.4.1">98.90</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.2.7.5.5" style="padding-left:11.4pt;padding-right:11.4pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.2.7.5.5.1">88.34</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.2.7.5.6" style="padding-left:11.4pt;padding-right:11.4pt;">68.29</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.2.7.5.7" style="padding-left:11.4pt;padding-right:11.4pt;">77.03</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_paragraph" id="S4.SS2.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Generalizabilities of Caption-aware Instruction Tuning</h4>
<div class="ltx_para ltx_noindent" id="S4.SS2.SSS0.Px2.p1">
<p class="ltx_p" id="S4.SS2.SSS0.Px2.p1.1">To further validate the generalizability of our method, on one hand, we test the reranker fine-tuned on the WebQA training set on MMQA. As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#S4.F3.sf1" title="In Figure 3 ‣ Results of Retrieval ‣ 4.2 Evaluation on Multimodal Knowledge-seeking ‣ 4 Experiments and Analysis ‣ MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_tag">3(a)</span></a>, the reranker trained on WebQA exhibits competitive performance in terms of R@1, R@5, and R@10, and even matches the original reranker’s performance with InternVL2-1/2B. On the other hand, we randomly select different portions of data from WebQA to train InternVL2-2B in a low-resource setting, and obtain the probability distribution of the reranker outputting ‘<span class="ltx_text ltx_font_italic" id="S4.SS2.SSS0.Px2.p1.1.1">Yes</span>’ for correctly recalled images. Figure <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#S4.F3.sf2" title="In Figure 3 ‣ Results of Retrieval ‣ 4.2 Evaluation on Multimodal Knowledge-seeking ‣ 4 Experiments and Analysis ‣ MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_tag">3(b)</span></a> shows the robust performance of our proposed method under the low-resource settings. With only 2.5% of the original data, the reranker significantly outperforms the strong retriever baseline, InternVL-G, in terms of R@2. As the data scale increases, the probability of correctly recalling images also improves, stabilizing around 20%, and the recall metrics follow a similar trend. In summary, these two points fully demonstrate the strong generalizability of our proposed method across datasets as well as in low-resource settings within the same dataset, making it easily adaptable to more scenarios. We provide an evaluation on LLaVA-v1.5-13B and make further discussion in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#A6" title="Appendix F More Evaluations on LLaVA-v1.5-13B ‣ MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_tag">F</span></a>.</p>
</div>
<figure class="ltx_table" id="S4.T3">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Performance of multimodal knowledge-seeking question answering on WebQA and MultimodalQA. In addition to the overall results, we report the accuracy of single-image and multi-image input with <span class="ltx_text ltx_font_italic" id="S4.T3.10.1">Single.</span> and <span class="ltx_text ltx_font_italic" id="S4.T3.11.2">Multi.</span> for WebQA, respectively. <span class="ltx_text ltx_font_italic" id="S4.T3.12.3">Oracle</span> refers to directly feeding the ground truth image to the generator after <span class="ltx_text ltx_font_italic" id="S4.T3.13.4">NIT (Noise-injected Training)</span>. The best scores in each setting are in <span class="ltx_text ltx_font_bold" id="S4.T3.14.5">bold</span>.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T3.4">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T3.4.5.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="S4.T3.4.5.1.1" rowspan="2" style="padding-left:14.2pt;padding-right:14.2pt;"><span class="ltx_text" id="S4.T3.4.5.1.1.1">Methods</span></th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.4.5.1.2" style="padding-left:14.2pt;padding-right:14.2pt;">MultimodalQA</td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="3" id="S4.T3.4.5.1.3" style="padding-left:14.2pt;padding-right:14.2pt;">WebQA</td>
</tr>
<tr class="ltx_tr" id="S4.T3.4.6.2">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.4.6.2.1" style="padding-left:14.2pt;padding-right:14.2pt;">EM</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.4.6.2.2" style="padding-left:14.2pt;padding-right:14.2pt;">Single.</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.4.6.2.3" style="padding-left:14.2pt;padding-right:14.2pt;">Multi.</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.4.6.2.4" style="padding-left:14.2pt;padding-right:14.2pt;">Overall</td>
</tr>
<tr class="ltx_tr" id="S4.T3.4.7.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="5" id="S4.T3.4.7.3.1" style="padding-left:14.2pt;padding-right:14.2pt;"><span class="ltx_text ltx_font_italic" id="S4.T3.4.7.3.1.1">w/o Retrieval-augmented Generation</span></th>
</tr>
<tr class="ltx_tr" id="S4.T3.4.8.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T3.4.8.4.1" style="padding-left:14.2pt;padding-right:14.2pt;">Qwen2‑0.5B‑Instruct</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.4.8.4.2" style="padding-left:14.2pt;padding-right:14.2pt;">10.43</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.4.8.4.3" style="padding-left:14.2pt;padding-right:14.2pt;">17.29</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.4.8.4.4" style="padding-left:14.2pt;padding-right:14.2pt;">19.33</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.4.8.4.5" style="padding-left:14.2pt;padding-right:14.2pt;">18.20</td>
</tr>
<tr class="ltx_tr" id="S4.T3.4.9.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T3.4.9.5.1" style="padding-left:14.2pt;padding-right:14.2pt;">internlm2‑chat‑1_8b</th>
<td class="ltx_td ltx_align_center" id="S4.T3.4.9.5.2" style="padding-left:14.2pt;padding-right:14.2pt;">10.43</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.9.5.3" style="padding-left:14.2pt;padding-right:14.2pt;">23.25</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.9.5.4" style="padding-left:14.2pt;padding-right:14.2pt;">32.58</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.9.5.5" style="padding-left:14.2pt;padding-right:14.2pt;">27.40</td>
</tr>
<tr class="ltx_tr" id="S4.T3.4.10.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T3.4.10.6.1" style="padding-left:14.2pt;padding-right:14.2pt;">gpt-3.5-turbo-0125</th>
<td class="ltx_td ltx_align_center" id="S4.T3.4.10.6.2" style="padding-left:14.2pt;padding-right:14.2pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.4.10.6.2.1">25.22</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.10.6.3" style="padding-left:14.2pt;padding-right:14.2pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.4.10.6.3.1">40.80</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.10.6.4" style="padding-left:14.2pt;padding-right:14.2pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.4.10.6.4.1">54.49</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.10.6.5" style="padding-left:14.2pt;padding-right:14.2pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.4.10.6.5.1">46.88</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.4.11.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T3.4.11.7.1" style="padding-left:14.2pt;padding-right:14.2pt;">InternVL2-1B</th>
<td class="ltx_td ltx_align_center" id="S4.T3.4.11.7.2" style="padding-left:14.2pt;padding-right:14.2pt;">19.57</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.11.7.3" style="padding-left:14.2pt;padding-right:14.2pt;">26.10</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.11.7.4" style="padding-left:14.2pt;padding-right:14.2pt;">43.57</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.11.7.5" style="padding-left:14.2pt;padding-right:14.2pt;">33.86</td>
</tr>
<tr class="ltx_tr" id="S4.T3.4.12.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T3.4.12.8.1" style="padding-left:14.2pt;padding-right:14.2pt;">InternVL2-2B</th>
<td class="ltx_td ltx_align_center" id="S4.T3.4.12.8.2" style="padding-left:14.2pt;padding-right:14.2pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.4.12.8.2.1">25.22</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.12.8.3" style="padding-left:14.2pt;padding-right:14.2pt;">30.37</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.12.8.4" style="padding-left:14.2pt;padding-right:14.2pt;">48.20</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.12.8.5" style="padding-left:14.2pt;padding-right:14.2pt;">38.29</td>
</tr>
<tr class="ltx_tr" id="S4.T3.4.13.9">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="5" id="S4.T3.4.13.9.1" style="padding-left:14.2pt;padding-right:14.2pt;"><span class="ltx_text ltx_font_italic" id="S4.T3.4.13.9.1.1">InternVL2-1B w/ Retrieval-augmented Generation</span></th>
</tr>
<tr class="ltx_tr" id="S4.T3.4.14.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T3.4.14.10.1" style="padding-left:14.2pt;padding-right:14.2pt;">InternVL2-1B</th>
<td class="ltx_td ltx_border_t" id="S4.T3.4.14.10.2" style="padding-left:14.2pt;padding-right:14.2pt;"></td>
<td class="ltx_td ltx_border_t" id="S4.T3.4.14.10.3" style="padding-left:14.2pt;padding-right:14.2pt;"></td>
<td class="ltx_td ltx_border_t" id="S4.T3.4.14.10.4" style="padding-left:14.2pt;padding-right:14.2pt;"></td>
<td class="ltx_td ltx_border_t" id="S4.T3.4.14.10.5" style="padding-left:14.2pt;padding-right:14.2pt;"></td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T3.1.1.1" style="padding-left:14.2pt;padding-right:14.2pt;">      <span class="ltx_text ltx_font_italic" id="S4.T3.1.1.1.1">w/</span> CLIP Top-<math alttext="N" class="ltx_Math" display="inline" id="S4.T3.1.1.1.m1.1"><semantics id="S4.T3.1.1.1.m1.1a"><mi id="S4.T3.1.1.1.m1.1.1" xref="S4.T3.1.1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.T3.1.1.1.m1.1b"><ci id="S4.T3.1.1.1.m1.1.1.cmml" xref="S4.T3.1.1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.1.1.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S4.T3.1.1.1.m1.1d">italic_N</annotation></semantics></math>
</th>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.2" style="padding-left:14.2pt;padding-right:14.2pt;">50.87</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.3" style="padding-left:14.2pt;padding-right:14.2pt;">35.98</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.4" style="padding-left:14.2pt;padding-right:14.2pt;">48.65</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.5" style="padding-left:14.2pt;padding-right:14.2pt;">41.61</td>
</tr>
<tr class="ltx_tr" id="S4.T3.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T3.2.2.1" style="padding-left:14.2pt;padding-right:14.2pt;">      <span class="ltx_text ltx_font_italic" id="S4.T3.2.2.1.1">w/</span> InternVL-G Top-<math alttext="N" class="ltx_Math" display="inline" id="S4.T3.2.2.1.m1.1"><semantics id="S4.T3.2.2.1.m1.1a"><mi id="S4.T3.2.2.1.m1.1.1" xref="S4.T3.2.2.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.T3.2.2.1.m1.1b"><ci id="S4.T3.2.2.1.m1.1.1.cmml" xref="S4.T3.2.2.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.2.2.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S4.T3.2.2.1.m1.1d">italic_N</annotation></semantics></math>
</th>
<td class="ltx_td ltx_align_center" id="S4.T3.2.2.2" style="padding-left:14.2pt;padding-right:14.2pt;">49.57</td>
<td class="ltx_td ltx_align_center" id="S4.T3.2.2.3" style="padding-left:14.2pt;padding-right:14.2pt;">38.88</td>
<td class="ltx_td ltx_align_center" id="S4.T3.2.2.4" style="padding-left:14.2pt;padding-right:14.2pt;">49.11</td>
<td class="ltx_td ltx_align_center" id="S4.T3.2.2.5" style="padding-left:14.2pt;padding-right:14.2pt;">43.43</td>
</tr>
<tr class="ltx_tr" id="S4.T3.4.15.11">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T3.4.15.11.1" style="padding-left:14.2pt;padding-right:14.2pt;">
<span class="ltx_text ltx_font_bold" id="S4.T3.4.15.11.1.1">RagVL</span> <span class="ltx_text ltx_font_italic" id="S4.T3.4.15.11.1.2">w/o NIT</span>
</th>
<td class="ltx_td ltx_align_center" id="S4.T3.4.15.11.2" style="padding-left:14.2pt;padding-right:14.2pt;">54.78</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.15.11.3" style="padding-left:14.2pt;padding-right:14.2pt;">38.09</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.15.11.4" style="padding-left:14.2pt;padding-right:14.2pt;">50.91</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.15.11.5" style="padding-left:14.2pt;padding-right:14.2pt;">43.79</td>
</tr>
<tr class="ltx_tr" id="S4.T3.4.16.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T3.4.16.12.1" style="padding-left:14.2pt;padding-right:14.2pt;">      <span class="ltx_text ltx_font_italic" id="S4.T3.4.16.12.1.1">w/</span> Natural Threshold</th>
<td class="ltx_td ltx_align_center" id="S4.T3.4.16.12.2" style="padding-left:14.2pt;padding-right:14.2pt;">54.78</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.16.12.3" style="padding-left:14.2pt;padding-right:14.2pt;">40.43</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.16.12.4" style="padding-left:14.2pt;padding-right:14.2pt;">50.96</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.16.12.5" style="padding-left:14.2pt;padding-right:14.2pt;">45.11</td>
</tr>
<tr class="ltx_tr" id="S4.T3.4.17.13">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T3.4.17.13.1" style="padding-left:14.2pt;padding-right:14.2pt;">      <span class="ltx_text ltx_font_italic" id="S4.T3.4.17.13.1.1">w/</span> Adaptive Threshold</th>
<td class="ltx_td ltx_align_center" id="S4.T3.4.17.13.2" style="padding-left:14.2pt;padding-right:14.2pt;">54.78</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.17.13.3" style="padding-left:14.2pt;padding-right:14.2pt;">40.64</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.17.13.4" style="padding-left:14.2pt;padding-right:14.2pt;">50.98</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.17.13.5" style="padding-left:14.2pt;padding-right:14.2pt;">45.23</td>
</tr>
<tr class="ltx_tr" id="S4.T3.4.18.14">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T3.4.18.14.1" style="padding-left:14.2pt;padding-right:14.2pt;">
<span class="ltx_text ltx_font_bold" id="S4.T3.4.18.14.1.1">RagVL</span> <span class="ltx_text ltx_font_italic" id="S4.T3.4.18.14.1.2">w/ NIT</span>
</th>
<td class="ltx_td ltx_align_center" id="S4.T3.4.18.14.2" style="padding-left:14.2pt;padding-right:14.2pt;">68.26</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.18.14.3" style="padding-left:14.2pt;padding-right:14.2pt;">53.07</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.18.14.4" style="padding-left:14.2pt;padding-right:14.2pt;">72.53</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.18.14.5" style="padding-left:14.2pt;padding-right:14.2pt;">61.72</td>
</tr>
<tr class="ltx_tr" id="S4.T3.4.19.15" style="background-color:#D9D9D9;">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T3.4.19.15.1" style="padding-left:14.2pt;padding-right:14.2pt;"><span class="ltx_text" id="S4.T3.4.19.15.1.1" style="background-color:#D9D9D9;">      <span class="ltx_text ltx_font_italic" id="S4.T3.4.19.15.1.1.1">w/</span> Natural Threshold</span></th>
<td class="ltx_td ltx_align_center" id="S4.T3.4.19.15.2" style="padding-left:14.2pt;padding-right:14.2pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.4.19.15.2.1" style="background-color:#D9D9D9;">68.70</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.19.15.3" style="padding-left:14.2pt;padding-right:14.2pt;"><span class="ltx_text" id="S4.T3.4.19.15.3.1" style="background-color:#D9D9D9;">56.68</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.19.15.4" style="padding-left:14.2pt;padding-right:14.2pt;"><span class="ltx_text" id="S4.T3.4.19.15.4.1" style="background-color:#D9D9D9;">72.49</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.19.15.5" style="padding-left:14.2pt;padding-right:14.2pt;"><span class="ltx_text" id="S4.T3.4.19.15.5.1" style="background-color:#D9D9D9;">63.71</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.4.20.16" style="background-color:#D9D9D9;">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T3.4.20.16.1" style="padding-left:14.2pt;padding-right:14.2pt;"><span class="ltx_text" id="S4.T3.4.20.16.1.1" style="background-color:#D9D9D9;">      <span class="ltx_text ltx_font_italic" id="S4.T3.4.20.16.1.1.1">w/</span> Adaptive Threshold</span></th>
<td class="ltx_td ltx_align_center" id="S4.T3.4.20.16.2" style="padding-left:14.2pt;padding-right:14.2pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.4.20.16.2.1" style="background-color:#D9D9D9;">68.70</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.20.16.3" style="padding-left:14.2pt;padding-right:14.2pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.4.20.16.3.1" style="background-color:#D9D9D9;">56.71</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.20.16.4" style="padding-left:14.2pt;padding-right:14.2pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.4.20.16.4.1" style="background-color:#D9D9D9;">72.60</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.20.16.5" style="padding-left:14.2pt;padding-right:14.2pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.4.20.16.5.1" style="background-color:#D9D9D9;">63.78</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.4.21.17">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T3.4.21.17.1" style="padding-left:14.2pt;padding-right:14.2pt;">Oracle</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.4.21.17.2" style="padding-left:14.2pt;padding-right:14.2pt;">69.13</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.4.21.17.3" style="padding-left:14.2pt;padding-right:14.2pt;">60.09</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.4.21.17.4" style="padding-left:14.2pt;padding-right:14.2pt;">73.23</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.4.21.17.5" style="padding-left:14.2pt;padding-right:14.2pt;">65.93</td>
</tr>
<tr class="ltx_tr" id="S4.T3.4.22.18">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="5" id="S4.T3.4.22.18.1" style="padding-left:14.2pt;padding-right:14.2pt;"><span class="ltx_text ltx_font_italic" id="S4.T3.4.22.18.1.1">InternVL2-2B w/ Retrieval-augmented Generation</span></th>
</tr>
<tr class="ltx_tr" id="S4.T3.4.23.19">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T3.4.23.19.1" style="padding-left:14.2pt;padding-right:14.2pt;">InternVL2-2B</th>
<td class="ltx_td ltx_border_t" id="S4.T3.4.23.19.2" style="padding-left:14.2pt;padding-right:14.2pt;"></td>
<td class="ltx_td ltx_border_t" id="S4.T3.4.23.19.3" style="padding-left:14.2pt;padding-right:14.2pt;"></td>
<td class="ltx_td ltx_border_t" id="S4.T3.4.23.19.4" style="padding-left:14.2pt;padding-right:14.2pt;"></td>
<td class="ltx_td ltx_border_t" id="S4.T3.4.23.19.5" style="padding-left:14.2pt;padding-right:14.2pt;"></td>
</tr>
<tr class="ltx_tr" id="S4.T3.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T3.3.3.1" style="padding-left:14.2pt;padding-right:14.2pt;">      <span class="ltx_text ltx_font_italic" id="S4.T3.3.3.1.1">w/</span> CLIP Top-<math alttext="N" class="ltx_Math" display="inline" id="S4.T3.3.3.1.m1.1"><semantics id="S4.T3.3.3.1.m1.1a"><mi id="S4.T3.3.3.1.m1.1.1" xref="S4.T3.3.3.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.T3.3.3.1.m1.1b"><ci id="S4.T3.3.3.1.m1.1.1.cmml" xref="S4.T3.3.3.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.3.3.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S4.T3.3.3.1.m1.1d">italic_N</annotation></semantics></math>
</th>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.2" style="padding-left:14.2pt;padding-right:14.2pt;">61.30</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.3" style="padding-left:14.2pt;padding-right:14.2pt;">40.80</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.4" style="padding-left:14.2pt;padding-right:14.2pt;">48.88</td>
<td class="ltx_td ltx_align_center" id="S4.T3.3.3.5" style="padding-left:14.2pt;padding-right:14.2pt;">44.39</td>
</tr>
<tr class="ltx_tr" id="S4.T3.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T3.4.4.1" style="padding-left:14.2pt;padding-right:14.2pt;">      <span class="ltx_text ltx_font_italic" id="S4.T3.4.4.1.1">w/</span> InternVL-G Top-<math alttext="N" class="ltx_Math" display="inline" id="S4.T3.4.4.1.m1.1"><semantics id="S4.T3.4.4.1.m1.1a"><mi id="S4.T3.4.4.1.m1.1.1" xref="S4.T3.4.4.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.T3.4.4.1.m1.1b"><ci id="S4.T3.4.4.1.m1.1.1.cmml" xref="S4.T3.4.4.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.4.4.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S4.T3.4.4.1.m1.1d">italic_N</annotation></semantics></math>
</th>
<td class="ltx_td ltx_align_center" id="S4.T3.4.4.2" style="padding-left:14.2pt;padding-right:14.2pt;">60.00</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.4.3" style="padding-left:14.2pt;padding-right:14.2pt;">41.92</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.4.4" style="padding-left:14.2pt;padding-right:14.2pt;">48.45</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.4.5" style="padding-left:14.2pt;padding-right:14.2pt;">44.82</td>
</tr>
<tr class="ltx_tr" id="S4.T3.4.24.20">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T3.4.24.20.1" style="padding-left:14.2pt;padding-right:14.2pt;">
<span class="ltx_text ltx_font_bold" id="S4.T3.4.24.20.1.1">RagVL</span> <span class="ltx_text ltx_font_italic" id="S4.T3.4.24.20.1.2">w/o NIT</span>
</th>
<td class="ltx_td ltx_align_center" id="S4.T3.4.24.20.2" style="padding-left:14.2pt;padding-right:14.2pt;">64.78</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.24.20.3" style="padding-left:14.2pt;padding-right:14.2pt;">41.68</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.24.20.4" style="padding-left:14.2pt;padding-right:14.2pt;">48.40</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.24.20.5" style="padding-left:14.2pt;padding-right:14.2pt;">44.67</td>
</tr>
<tr class="ltx_tr" id="S4.T3.4.25.21">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T3.4.25.21.1" style="padding-left:14.2pt;padding-right:14.2pt;">      <span class="ltx_text ltx_font_italic" id="S4.T3.4.25.21.1.1">w/</span> Natural Threshold</th>
<td class="ltx_td ltx_align_center" id="S4.T3.4.25.21.2" style="padding-left:14.2pt;padding-right:14.2pt;">65.65</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.25.21.3" style="padding-left:14.2pt;padding-right:14.2pt;">44.71</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.25.21.4" style="padding-left:14.2pt;padding-right:14.2pt;">48.97</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.25.21.5" style="padding-left:14.2pt;padding-right:14.2pt;">46.60</td>
</tr>
<tr class="ltx_tr" id="S4.T3.4.26.22">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T3.4.26.22.1" style="padding-left:14.2pt;padding-right:14.2pt;">      <span class="ltx_text ltx_font_italic" id="S4.T3.4.26.22.1.1">w/</span> Adaptive Threshold</th>
<td class="ltx_td ltx_align_center" id="S4.T3.4.26.22.2" style="padding-left:14.2pt;padding-right:14.2pt;">65.65</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.26.22.3" style="padding-left:14.2pt;padding-right:14.2pt;">44.37</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.26.22.4" style="padding-left:14.2pt;padding-right:14.2pt;">48.98</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.26.22.5" style="padding-left:14.2pt;padding-right:14.2pt;">46.42</td>
</tr>
<tr class="ltx_tr" id="S4.T3.4.27.23">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T3.4.27.23.1" style="padding-left:14.2pt;padding-right:14.2pt;">
<span class="ltx_text ltx_font_bold" id="S4.T3.4.27.23.1.1">RagVL</span> <span class="ltx_text ltx_font_italic" id="S4.T3.4.27.23.1.2">w/ NIT</span>
</th>
<td class="ltx_td ltx_align_center" id="S4.T3.4.27.23.2" style="padding-left:14.2pt;padding-right:14.2pt;">73.04</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.27.23.3" style="padding-left:14.2pt;padding-right:14.2pt;">53.91</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.27.23.4" style="padding-left:14.2pt;padding-right:14.2pt;">72.62</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.27.23.5" style="padding-left:14.2pt;padding-right:14.2pt;">62.23</td>
</tr>
<tr class="ltx_tr" id="S4.T3.4.28.24" style="background-color:#D9D9D9;">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T3.4.28.24.1" style="padding-left:14.2pt;padding-right:14.2pt;"><span class="ltx_text" id="S4.T3.4.28.24.1.1" style="background-color:#D9D9D9;">      <span class="ltx_text ltx_font_italic" id="S4.T3.4.28.24.1.1.1">w/</span> Natural Threshold</span></th>
<td class="ltx_td ltx_align_center" id="S4.T3.4.28.24.2" style="padding-left:14.2pt;padding-right:14.2pt;"><span class="ltx_text" id="S4.T3.4.28.24.2.1" style="background-color:#D9D9D9;">73.48</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.28.24.3" style="padding-left:14.2pt;padding-right:14.2pt;"><span class="ltx_text" id="S4.T3.4.28.24.3.1" style="background-color:#D9D9D9;">57.25</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.28.24.4" style="padding-left:14.2pt;padding-right:14.2pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.4.28.24.4.1" style="background-color:#D9D9D9;">73.01</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.28.24.5" style="padding-left:14.2pt;padding-right:14.2pt;"><span class="ltx_text" id="S4.T3.4.28.24.5.1" style="background-color:#D9D9D9;">64.25</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.4.29.25" style="background-color:#D9D9D9;">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T3.4.29.25.1" style="padding-left:14.2pt;padding-right:14.2pt;"><span class="ltx_text" id="S4.T3.4.29.25.1.1" style="background-color:#D9D9D9;">      <span class="ltx_text ltx_font_italic" id="S4.T3.4.29.25.1.1.1">w/</span> Adaptive Threshold</span></th>
<td class="ltx_td ltx_align_center" id="S4.T3.4.29.25.2" style="padding-left:14.2pt;padding-right:14.2pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.4.29.25.2.1" style="background-color:#D9D9D9;">73.48</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.29.25.3" style="padding-left:14.2pt;padding-right:14.2pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.4.29.25.3.1" style="background-color:#D9D9D9;">57.94</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.29.25.4" style="padding-left:14.2pt;padding-right:14.2pt;"><span class="ltx_text" id="S4.T3.4.29.25.4.1" style="background-color:#D9D9D9;">72.47</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.29.25.5" style="padding-left:14.2pt;padding-right:14.2pt;"><span class="ltx_text ltx_font_bold" id="S4.T3.4.29.25.5.1" style="background-color:#D9D9D9;">64.40</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.4.30.26">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="S4.T3.4.30.26.1" style="padding-left:14.2pt;padding-right:14.2pt;">Oracle</th>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T3.4.30.26.2" style="padding-left:14.2pt;padding-right:14.2pt;">73.48</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T3.4.30.26.3" style="padding-left:14.2pt;padding-right:14.2pt;">60.66</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T3.4.30.26.4" style="padding-left:14.2pt;padding-right:14.2pt;">73.59</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T3.4.30.26.5" style="padding-left:14.2pt;padding-right:14.2pt;">66.41</td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Evaluation on Multimodal Retrieval-augmented Generation</h3>
<section class="ltx_paragraph" id="S4.SS3.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Reranking Performance with Thresholds</h4>
<div class="ltx_para ltx_noindent" id="S4.SS3.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS3.SSS0.Px1.p1.1">Due to the strong performance of the reranker in low-resource settings, we train InternVL2-1/2B as the rerankers using only 20% of the data, considering efficiency. As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#S4.F4" title="Figure 4 ‣ Results of Retrieval ‣ 4.2 Evaluation on Multimodal Knowledge-seeking ‣ 4 Experiments and Analysis ‣ MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_tag">4</span></a>, we collect the relevance probability of the image candidates after reranking and the results prove the superiority of our proposed knowledge-enhanced reranking. Among the train, validation, and test sets, the relevance probabilities of correct recalls are concentrated in the highest range. Since there is still a portion of erroneous recalls, we plotted the interpolated curves of correct recalls and erroneous recalls on the validation set and took the x-coordinate of their intersection point as the adaptive threshold. Due to the perfect performance on MultimodalQA with the natural threshold, we set the adaptive threshold to the same as the natural threshold.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.SSS0.Px1.p2">
<p class="ltx_p" id="S4.SS3.SSS0.Px1.p2.5">As demonstrated in Table <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#S4.T2" title="Table 2 ‣ Results of Retrieval ‣ 4.2 Evaluation on Multimodal Knowledge-seeking ‣ 4 Experiments and Analysis ‣ MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_tag">2</span></a>, our proposed knowledge-enhanced reranking method demonstrates superior performances. We train the reranker with the caption-aware instructions and achieve better performance across all metrics compared to directly using CLIP for top-<math alttext="N" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px1.p2.1.m1.1"><semantics id="S4.SS3.SSS0.Px1.p2.1.m1.1a"><mi id="S4.SS3.SSS0.Px1.p2.1.m1.1.1" xref="S4.SS3.SSS0.Px1.p2.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p2.1.m1.1b"><ci id="S4.SS3.SSS0.Px1.p2.1.m1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p2.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p2.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px1.p2.1.m1.1d">italic_N</annotation></semantics></math> retrieval. When the adaptive threshold <math alttext="\eta" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px1.p2.2.m2.1"><semantics id="S4.SS3.SSS0.Px1.p2.2.m2.1a"><mi id="S4.SS3.SSS0.Px1.p2.2.m2.1.1" xref="S4.SS3.SSS0.Px1.p2.2.m2.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p2.2.m2.1b"><ci id="S4.SS3.SSS0.Px1.p2.2.m2.1.1.cmml" xref="S4.SS3.SSS0.Px1.p2.2.m2.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p2.2.m2.1c">\eta</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px1.p2.2.m2.1d">italic_η</annotation></semantics></math> is activated, the model accurately filters out irrelevant images, improving <span class="ltx_text ltx_font_italic" id="S4.SS3.SSS0.Px1.p2.5.1">accuracy</span> and <span class="ltx_text ltx_font_italic" id="S4.SS3.SSS0.Px1.p2.5.2">F1</span> score. Specifically, in WebQA, when <math alttext="\eta" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px1.p2.3.m3.1"><semantics id="S4.SS3.SSS0.Px1.p2.3.m3.1a"><mi id="S4.SS3.SSS0.Px1.p2.3.m3.1.1" xref="S4.SS3.SSS0.Px1.p2.3.m3.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p2.3.m3.1b"><ci id="S4.SS3.SSS0.Px1.p2.3.m3.1.1.cmml" xref="S4.SS3.SSS0.Px1.p2.3.m3.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p2.3.m3.1c">\eta</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px1.p2.3.m3.1d">italic_η</annotation></semantics></math> is set to an intuitively reasonable value of 0.5, the corresponding F1 score increases by 29.75%. In MultimodalQA, the reranker successfully identifies all ground truth images from the retrieved top-<math alttext="K" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px1.p2.4.m4.1"><semantics id="S4.SS3.SSS0.Px1.p2.4.m4.1a"><mi id="S4.SS3.SSS0.Px1.p2.4.m4.1.1" xref="S4.SS3.SSS0.Px1.p2.4.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p2.4.m4.1b"><ci id="S4.SS3.SSS0.Px1.p2.4.m4.1.1.cmml" xref="S4.SS3.SSS0.Px1.p2.4.m4.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p2.4.m4.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px1.p2.4.m4.1d">italic_K</annotation></semantics></math> candidates when <math alttext="\eta" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px1.p2.5.m5.1"><semantics id="S4.SS3.SSS0.Px1.p2.5.m5.1a"><mi id="S4.SS3.SSS0.Px1.p2.5.m5.1.1" xref="S4.SS3.SSS0.Px1.p2.5.m5.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p2.5.m5.1b"><ci id="S4.SS3.SSS0.Px1.p2.5.m5.1.1.cmml" xref="S4.SS3.SSS0.Px1.p2.5.m5.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p2.5.m5.1c">\eta</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px1.p2.5.m5.1d">italic_η</annotation></semantics></math> is set to 0.5, proving the strong capability of our proposed method in retrieval reranking.</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS3.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Results of Retrieval-augmented Generation</h4>
<div class="ltx_para ltx_noindent" id="S4.SS3.SSS0.Px2.p1">
<p class="ltx_p" id="S4.SS3.SSS0.Px2.p1.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#S4.T3" title="Table 3 ‣ Generalizabilities of Caption-aware Instruction Tuning ‣ 4.2 Evaluation on Multimodal Knowledge-seeking ‣ 4 Experiments and Analysis ‣ MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_tag">3</span></a> displays the results on multimodal question answering which requires retrieving images. The baselines without retrieval show limited performance, even the powerful gpt-3.5-turbo-0125 fails to answer the knowledge-intensive questions. Notably, the backbone LLMs of InternVL2-1/2B (Qwen2-0.5B-Instruct and internlm2-chat-1_8b) perform poorly while their multimodal counterparts are somewhat improved. This phenomenon indicates that MLLMs can indeed learn world knowledge from different modalities and store it inside the parameters. Moreover, as a more timely and flexible approach for knowledge updates, retrieval-augmented generation also offers the potential for better knowledge integration in MLLMs.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.SSS0.Px2.p2">
<p class="ltx_p" id="S4.SS3.SSS0.Px2.p2.1">After applying our proposed pipeline, all configurations on InternVL2-1B and InternVL2-2B demonstrate excellent performance of retrieval-augmented generation, approaching or even surpassing the performance of <span class="ltx_text ltx_font_italic" id="S4.SS3.SSS0.Px2.p2.1.1">Oracle</span>. When the natural threshold is activated, there is a significant increase in the accuracy of recalling the correct images (as shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#S4.T2" title="Table 2 ‣ Results of Retrieval ‣ 4.2 Evaluation on Multimodal Knowledge-seeking ‣ 4 Experiments and Analysis ‣ MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_tag">2</span></a>), leading to substantial improvements in all metrics across both datasets. Moreover, this improvement is more evident in the single-image scenario. This is because we fixed the number of images recalled each time, and setting the threshold allows us to filter out erroneously recalled images, resulting in a consistent performance enhancement. However, when adopting adaptive thresholds, the improvement in results is not as significant as with natural thresholds. This can be seen from Table <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#S4.T2" title="Table 2 ‣ Results of Retrieval ‣ 4.2 Evaluation on Multimodal Knowledge-seeking ‣ 4 Experiments and Analysis ‣ MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_tag">2</span></a>, where, despite a substantial increase in accuracy, there is a significant drop in recall. Therefore, natural thresholds are a better and more efficient choice for retrieval-augmented generation.</p>
</div>
<figure class="ltx_table ltx_align_floatright" id="S4.T4">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>Ablation study on WebQA with InternVL2-2B. <span class="ltx_text ltx_font_italic" id="S4.T4.4.1">NLC</span> and <span class="ltx_text ltx_font_italic" id="S4.T4.5.2">ND</span> refer to Noise-injected Logits Contrasting and Noise-injected Data, respectively.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T4.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T4.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S4.T4.1.2.1.1" rowspan="2" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="S4.T4.1.2.1.1.1">Methods</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3" id="S4.T4.1.2.1.2" style="padding-left:4.3pt;padding-right:4.3pt;">WebQA</th>
</tr>
<tr class="ltx_tr" id="S4.T4.1.3.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T4.1.3.2.1" style="padding-left:4.3pt;padding-right:4.3pt;">Single.</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T4.1.3.2.2" style="padding-left:4.3pt;padding-right:4.3pt;">Multi.</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T4.1.3.2.3" style="padding-left:4.3pt;padding-right:4.3pt;">Overall</th>
</tr>
<tr class="ltx_tr" id="S4.T4.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t" id="S4.T4.1.1.1" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text ltx_font_bold" id="S4.T4.1.1.1.1">RagVL (<math alttext="\eta=0.5" class="ltx_Math" display="inline" id="S4.T4.1.1.1.1.m1.1"><semantics id="S4.T4.1.1.1.1.m1.1a"><mrow id="S4.T4.1.1.1.1.m1.1.1" xref="S4.T4.1.1.1.1.m1.1.1.cmml"><mi id="S4.T4.1.1.1.1.m1.1.1.2" xref="S4.T4.1.1.1.1.m1.1.1.2.cmml">η</mi><mo id="S4.T4.1.1.1.1.m1.1.1.1" xref="S4.T4.1.1.1.1.m1.1.1.1.cmml">=</mo><mn id="S4.T4.1.1.1.1.m1.1.1.3" xref="S4.T4.1.1.1.1.m1.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.1.1.1.1.m1.1b"><apply id="S4.T4.1.1.1.1.m1.1.1.cmml" xref="S4.T4.1.1.1.1.m1.1.1"><eq id="S4.T4.1.1.1.1.m1.1.1.1.cmml" xref="S4.T4.1.1.1.1.m1.1.1.1"></eq><ci id="S4.T4.1.1.1.1.m1.1.1.2.cmml" xref="S4.T4.1.1.1.1.m1.1.1.2">𝜂</ci><cn id="S4.T4.1.1.1.1.m1.1.1.3.cmml" type="float" xref="S4.T4.1.1.1.1.m1.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.1.1.1.1.m1.1c">\eta=0.5</annotation><annotation encoding="application/x-llamapun" id="S4.T4.1.1.1.1.m1.1d">italic_η = 0.5</annotation></semantics></math>)</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T4.1.1.2" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text ltx_font_bold" id="S4.T4.1.1.2.1">57.25</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T4.1.1.3" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text ltx_font_bold" id="S4.T4.1.1.3.1">73.01</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T4.1.1.4" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text ltx_font_bold" id="S4.T4.1.1.4.1">64.25</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T4.1.4.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T4.1.4.1.1" style="padding-left:4.3pt;padding-right:4.3pt;">
<span class="ltx_text ltx_font_italic" id="S4.T4.1.4.1.1.1">w/o</span> Reranker</th>
<td class="ltx_td ltx_align_center" id="S4.T4.1.4.1.2" style="padding-left:4.3pt;padding-right:4.3pt;">53.63</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.4.1.3" style="padding-left:4.3pt;padding-right:4.3pt;">71.79</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.4.1.4" style="padding-left:4.3pt;padding-right:4.3pt;">61.70</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.5.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T4.1.5.2.1" style="padding-left:4.3pt;padding-right:4.3pt;">
<span class="ltx_text ltx_font_italic" id="S4.T4.1.5.2.1.1">w/o</span> ND</th>
<td class="ltx_td ltx_align_center" id="S4.T4.1.5.2.2" style="padding-left:4.3pt;padding-right:4.3pt;">57.11</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.5.2.3" style="padding-left:4.3pt;padding-right:4.3pt;">71.24</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.5.2.4" style="padding-left:4.3pt;padding-right:4.3pt;">63.39</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.6.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T4.1.6.3.1" style="padding-left:4.3pt;padding-right:4.3pt;">
<span class="ltx_text ltx_font_italic" id="S4.T4.1.6.3.1.1">w/o</span> NLC</th>
<td class="ltx_td ltx_align_center" id="S4.T4.1.6.3.2" style="padding-left:4.3pt;padding-right:4.3pt;">56.42</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.6.3.3" style="padding-left:4.3pt;padding-right:4.3pt;">72.40</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.6.3.4" style="padding-left:4.3pt;padding-right:4.3pt;">63.52</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.7.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S4.T4.1.7.4.1" style="padding-left:4.3pt;padding-right:4.3pt;">
<span class="ltx_text ltx_font_italic" id="S4.T4.1.7.4.1.1">w/o</span> ND &amp; NLC</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.1.7.4.2" style="padding-left:4.3pt;padding-right:4.3pt;">56.27</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.1.7.4.3" style="padding-left:4.3pt;padding-right:4.3pt;">70.10</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.1.7.4.4" style="padding-left:4.3pt;padding-right:4.3pt;">62.42</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_paragraph" id="S4.SS3.SSS0.Px3">
<h4 class="ltx_title ltx_title_paragraph">Ablation Studies</h4>
<div class="ltx_para ltx_noindent" id="S4.SS3.SSS0.Px3.p1">
<p class="ltx_p" id="S4.SS3.SSS0.Px3.p1.1">To validate the efficacy of each component in our proposed method, we conduct a set of ablation experiments on WebQA with InternVL2-2B, and the results are reported in Table <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#S4.T4" title="Table 4 ‣ Results of Retrieval-augmented Generation ‣ 4.3 Evaluation on Multimodal Retrieval-augmented Generation ‣ 4 Experiments and Analysis ‣ MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_tag">4</span></a>. For “<span class="ltx_text ltx_font_italic" id="S4.SS3.SSS0.Px3.p1.1.1">w/o Reranker</span>”, we directly retrieve Top-2 images with CLIP in the inference stage. The use of the reranker in RagVL shows an improvement in all metrics (<span class="ltx_text ltx_font_italic" id="S4.SS3.SSS0.Px3.p1.1.2">Single.</span>, <span class="ltx_text ltx_font_italic" id="S4.SS3.SSS0.Px3.p1.1.3">Multi.</span> and <span class="ltx_text ltx_font_italic" id="S4.SS3.SSS0.Px3.p1.1.4">Overall</span>) compared to “<span class="ltx_text ltx_font_italic" id="S4.SS3.SSS0.Px3.p1.1.5">w/o Reranker</span>”. For “<span class="ltx_text ltx_font_italic" id="S4.SS3.SSS0.Px3.p1.1.6">w/o ND</span>”, we replace the noise-injected dataset with the vanilla dataset. Ablating <span class="ltx_text ltx_font_italic" id="S4.SS3.SSS0.Px3.p1.1.7">ND</span> results in a performance decrease on all metrics. Introducing noise at both data and token levels helps the model learn to distinguish between the candidate images more effectively in multi-image inference. Since <span class="ltx_text ltx_font_italic" id="S4.SS3.SSS0.Px3.p1.1.8">NLC</span> enhances the model’s robustness at the token level, ablating it leads to a decrease in all metrics on WebQA. This decline is more pronounced when both <span class="ltx_text ltx_font_italic" id="S4.SS3.SSS0.Px3.p1.1.9">NLC</span> and <span class="ltx_text ltx_font_italic" id="S4.SS3.SSS0.Px3.p1.1.10">ND</span> are ablated, especially in multi-image inference scenarios. Therefore, our proposed training method, which injects noise at the data and token levels, helps reduce the distractions from noise and mitigate MNC during inference time.</p>
</div>
<figure class="ltx_figure" id="S4.F5">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_bottom" id="S4.F5.3" style="width:397.5pt;">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="171" id="S4.F5.1.g1" src="x8.png" width="228"/></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="171" id="S4.F5.2.g2" src="x9.png" width="228"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="171" id="S4.F5.3.g3" src="x10.png" width="228"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(d) </span>“How many primary colors are found <span class="ltx_text" id="S4.F5.3.2.1" style="color:#B10404;">on the head of the Violet Turaco?</span>”</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_bottom" id="S4.F5.9" style="width:397.5pt;">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="153" id="S4.F5.4.g1" src="x11.png" width="228"/></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="153" id="S4.F5.5.g2" src="x12.png" width="228"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="153" id="S4.F5.6.g3" src="x13.png" width="228"/></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="171" id="S4.F5.7.g4" src="x14.png" width="228"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="171" id="S4.F5.8.g5" src="x15.png" width="228"/></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="171" id="S4.F5.9.g6" src="x16.png" width="228"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(e) </span>“Which is better maintained, <span class="ltx_text" id="S4.F5.9.3.1" style="color:#B10404;">the carving on the front</span> of the Palace of the Governor in Uxmal or <span class="ltx_text" id="S4.F5.9.4.2" style="color:#B10404;">the Bird carving above the doorway</span> in Mexico, Architecture?”</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Visualization of attention heatmaps <span class="ltx_text ltx_font_italic" id="S4.F5.15.1">w/</span> and <span class="ltx_text ltx_font_italic" id="S4.F5.16.2">w/o NIT</span>. Displayed from left to right are the attention maps for the base model (<span class="ltx_text ltx_font_italic" id="S4.F5.17.3">w/o IT</span>), the model fine-tuned <span class="ltx_text ltx_font_italic" id="S4.F5.18.4">w/o NIT</span>, and the model fine-tuned <span class="ltx_text ltx_font_italic" id="S4.F5.19.5">w/ NIT</span>, respectively, with each corresponding to its respective question in the caption.</figcaption>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Qualititive Analysis</h3>
<div class="ltx_para ltx_noindent" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.1">As illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#S4.F5" title="Figure 5 ‣ Ablation Studies ‣ 4.3 Evaluation on Multimodal Retrieval-augmented Generation ‣ 4 Experiments and Analysis ‣ MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_tag">5</span></a>, we visualize the attention heatmaps from the three models, providing insights into how each model focuses on the details of the input image. The attention weights are calculated by accumulating the attention score between image tokens and text tokens across all layers. Obviously, the model <span class="ltx_text ltx_font_italic" id="S4.SS4.p1.1.1">w/ NIT</span> provides more focused attention on the crucial parts of the query than the other two models. More cases can be seen in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#A7" title="Appendix G More Case Studies ‣ MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_tag">G</span></a>.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>
<div class="ltx_para ltx_noindent" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">In this paper, we present a robust framework for enhancing Multimodal Large Language Models (MLLMs) through knowledge-enhanced reranking and noise-injected training to tackle the multi-granularity noisy correspondence (MNC) problem in multimodal retrieval-augmented generation. Our comprehensive approach addresses both coarse-grained and fine-grained noise, significantly improving retrieval accuracy and generation robustness. The results from our extensive experiments on the WebQA and MultimodalQA datasets demonstrate the superiority of our proposed method, especially in scenarios requiring fine-grained visual understanding and robust generation. By instruction-tuning MLLMs for reranking and injecting visual noise during training, we enhance the model’s capability to handle real-world noisy data and improve its overall performance in multimodal tasks.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Achiam et al. (2023)</span>
<span class="ltx_bibblock">
Josh Achiam, Steven Adler, Sandhini Agarwal, Lama Ahmad, Ilge Akkaya, Florencia Leoni Aleman, Diogo Almeida, Janko Altenschmidt, Sam Altman, Shyamal Anadkat, et al.

</span>
<span class="ltx_bibblock">Gpt-4 technical report.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">arXiv preprint arXiv:2303.08774</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Aghajanyan et al. (2022)</span>
<span class="ltx_bibblock">
Armen Aghajanyan, Bernie Huang, Candace Ross, Vladimir Karpukhin, Hu Xu, Naman Goyal, Dmytro Okhonko, Mandar Joshi, Gargi Ghosh, Mike Lewis, et al.

</span>
<span class="ltx_bibblock">Cm3: A causal masked multimodal model of the internet.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">arXiv preprint arXiv:2201.07520</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Asai et al. (2024)</span>
<span class="ltx_bibblock">
Akari Asai, Zexuan Zhong, Danqi Chen, Pang Wei Koh, Luke Zettlemoyer, Hannaneh Hajishirzi, and Wen-tau Yih.

</span>
<span class="ltx_bibblock">Reliable, adaptable, and attributable language models with retrieval.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">arXiv preprint arXiv:2403.03187</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bai et al. (2023)</span>
<span class="ltx_bibblock">
Jinze Bai, Shuai Bai, Shusheng Yang, Shijie Wang, Sinan Tan, Peng Wang, Junyang Lin, Chang Zhou, and Jingren Zhou.

</span>
<span class="ltx_bibblock">Qwen-vl: A frontier large vision-language model with versatile abilities.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">arXiv preprint arXiv:2308.12966</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Borgeaud et al. (2022)</span>
<span class="ltx_bibblock">
Sebastian Borgeaud, Arthur Mensch, Jordan Hoffmann, Trevor Cai, Eliza Rutherford, Katie Millican, George Bm Van Den Driessche, Jean-Baptiste Lespiau, Bogdan Damoc, Aidan Clark, et al.

</span>
<span class="ltx_bibblock">Improving language models by retrieving from trillions of tokens.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">International conference on machine learning</em>, pp.  2206–2240. PMLR, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Brown et al. (2020)</span>
<span class="ltx_bibblock">
Tom Brown, Benjamin Mann, Nick Ryder, Melanie Subbiah, Jared D Kaplan, Prafulla Dhariwal, Arvind Neelakantan, Pranav Shyam, Girish Sastry, Amanda Askell, et al.

</span>
<span class="ltx_bibblock">Language models are few-shot learners.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">Advances in neural information processing systems</em>, 33:1877–1901, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chang et al. (2022)</span>
<span class="ltx_bibblock">
Yingshan Chang, Mridu Narang, Hisami Suzuki, Guihong Cao, Jianfeng Gao, and Yonatan Bisk.

</span>
<span class="ltx_bibblock">Webqa: Multihop and multimodal qa.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</em>, pp.  16495–16504, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2022)</span>
<span class="ltx_bibblock">
Wenhu Chen, Hexiang Hu, Xi Chen, Pat Verga, and William W Cohen.

</span>
<span class="ltx_bibblock">Murag: Multimodal retrieval-augmented generator for open question answering over images and text.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">arXiv preprint arXiv:2210.02928</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2024)</span>
<span class="ltx_bibblock">
Zhe Chen, Jiannan Wu, Wenhai Wang, Weijie Su, Guo Chen, Sen Xing, Muyan Zhong, Qinglong Zhang, Xizhou Zhu, Lewei Lu, et al.

</span>
<span class="ltx_bibblock">Internvl: Scaling up vision foundation models and aligning for generic visual-linguistic tasks.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pp.  24185–24198, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dao et al. (2022)</span>
<span class="ltx_bibblock">
Tri Dao, Daniel Y. Fu, Stefano Ermon, Atri Rudra, and Christopher Ré.

</span>
<span class="ltx_bibblock">FlashAttention: Fast and memory-efficient exact attention with IO-awareness.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">Advances in Neural Information Processing Systems (NeurIPS)</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dosovitskiy et al. (2020)</span>
<span class="ltx_bibblock">
Alexey Dosovitskiy, Lucas Beyer, Alexander Kolesnikov, Dirk Weissenborn, Xiaohua Zhai, Thomas Unterthiner, Mostafa Dehghani, Matthias Minderer, Georg Heigold, Sylvain Gelly, et al.

</span>
<span class="ltx_bibblock">An image is worth 16x16 words: Transformers for image recognition at scale.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">arXiv preprint arXiv:2010.11929</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Douze et al. (2024)</span>
<span class="ltx_bibblock">
Matthijs Douze, Alexandr Guzhva, Chengqi Deng, Jeff Johnson, Gergely Szilvasy, Pierre-Emmanuel Mazaré, Maria Lomeli, Lucas Hosseini, and Hervé Jégou.

</span>
<span class="ltx_bibblock">The faiss library.

</span>
<span class="ltx_bibblock">2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Driess et al. (2023)</span>
<span class="ltx_bibblock">
Danny Driess, Fei Xia, Mehdi SM Sajjadi, Corey Lynch, Aakanksha Chowdhery, Brian Ichter, Ayzaan Wahid, Jonathan Tompson, Quan Vuong, Tianhe Yu, et al.

</span>
<span class="ltx_bibblock">Palm-e: An embodied multimodal language model.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">arXiv preprint arXiv:2303.03378</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gim et al. (2024)</span>
<span class="ltx_bibblock">
In Gim, Guojun Chen, Seung-seob Lee, Nikhil Sarda, Anurag Khandelwal, and Lin Zhong.

</span>
<span class="ltx_bibblock">Prompt cache: Modular attention reuse for low-latency inference.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">Proceedings of Machine learning and systems</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Goyal et al. (2017)</span>
<span class="ltx_bibblock">
Yash Goyal, Tejas Khot, Douglas Summers-Stay, Dhruv Batra, and Devi Parikh.

</span>
<span class="ltx_bibblock">Making the v in vqa matter: Elevating the role of image understanding in visual question answering.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">Proceedings of the IEEE conference on computer vision and pattern recognition</em>, pp.  6904–6913, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et al. (2020)</span>
<span class="ltx_bibblock">
Ruiqi Guo, Philip Sun, Erik Lindgren, Quan Geng, David Simcha, Felix Chern, and Sanjiv Kumar.

</span>
<span class="ltx_bibblock">Accelerating large-scale inference with anisotropic vector quantization.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">International Conference on Machine Learning</em>, pp.  3887–3896. PMLR, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guu et al. (2020)</span>
<span class="ltx_bibblock">
Kelvin Guu, Kenton Lee, Zora Tung, Panupong Pasupat, and Mingwei Chang.

</span>
<span class="ltx_bibblock">Retrieval augmented language model pre-training.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">International conference on machine learning</em>, pp.  3929–3938. PMLR, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ho et al. (2020)</span>
<span class="ltx_bibblock">
Jonathan Ho, Ajay Jain, and Pieter Abbeel.

</span>
<span class="ltx_bibblock">Denoising diffusion probabilistic models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">Advances in neural information processing systems</em>, 33:6840–6851, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang et al. (2024)</span>
<span class="ltx_bibblock">
Shaohan Huang, Li Dong, Wenhui Wang, Yaru Hao, Saksham Singhal, Shuming Ma, Tengchao Lv, Lei Cui, Owais Khan Mohammed, Barun Patra, et al.

</span>
<span class="ltx_bibblock">Language is not all you need: Aligning perception with language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">Advances in Neural Information Processing Systems</em>, 36, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang et al. (2021)</span>
<span class="ltx_bibblock">
Zhenyu Huang, Guocheng Niu, Xiao Liu, Wenbiao Ding, Xinyan Xiao, Hua Wu, and Xi Peng.

</span>
<span class="ltx_bibblock">Learning with noisy correspondence for cross-modal matching.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">Advances in Neural Information Processing Systems</em>, 34:29406–29419, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hudson &amp; Manning (2019)</span>
<span class="ltx_bibblock">
Drew A Hudson and Christopher D Manning.

</span>
<span class="ltx_bibblock">Gqa: A new dataset for real-world visual reasoning and compositional question answering.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</em>, pp.  6700–6709, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Izacard &amp; Grave (2020)</span>
<span class="ltx_bibblock">
Gautier Izacard and Edouard Grave.

</span>
<span class="ltx_bibblock">Leveraging passage retrieval with generative models for open domain question answering.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">arXiv preprint arXiv:2007.01282</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Karpukhin et al. (2020)</span>
<span class="ltx_bibblock">
Vladimir Karpukhin, Barlas Oğuz, Sewon Min, Patrick Lewis, Ledell Wu, Sergey Edunov, Danqi Chen, and Wen-tau Yih.

</span>
<span class="ltx_bibblock">Dense passage retrieval for open-domain question answering.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">arXiv preprint arXiv:2004.04906</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kwon et al. (2023)</span>
<span class="ltx_bibblock">
Woosuk Kwon, Zhuohan Li, Siyuan Zhuang, Ying Sheng, Lianmin Zheng, Cody Hao Yu, Joseph E. Gonzalez, Hao Zhang, and Ion Stoica.

</span>
<span class="ltx_bibblock">Efficient memory management for large language model serving with pagedattention.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">Proceedings of the ACM SIGOPS 29th Symposium on Operating Systems Principles</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lee et al. (2018)</span>
<span class="ltx_bibblock">
Kuang-Huei Lee, Xi Chen, Gang Hua, Houdong Hu, and Xiaodong He.

</span>
<span class="ltx_bibblock">Stacked cross attention for image-text matching.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">Proceedings of the European conference on computer vision (ECCV)</em>, pp.  201–216, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Leng et al. (2024)</span>
<span class="ltx_bibblock">
Sicong Leng, Hang Zhang, Guanzheng Chen, Xin Li, Shijian Lu, Chunyan Miao, and Lidong Bing.

</span>
<span class="ltx_bibblock">Mitigating object hallucinations in large vision-language models through visual contrastive decoding.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pp.  13872–13882, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lewis et al. (2020)</span>
<span class="ltx_bibblock">
Patrick Lewis, Ethan Perez, Aleksandra Piktus, Fabio Petroni, Vladimir Karpukhin, Naman Goyal, Heinrich Küttler, Mike Lewis, Wen-tau Yih, Tim Rocktäschel, et al.

</span>
<span class="ltx_bibblock">Retrieval-augmented generation for knowledge-intensive nlp tasks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">Advances in Neural Information Processing Systems</em>, 33:9459–9474, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2023)</span>
<span class="ltx_bibblock">
Junnan Li, Dongxu Li, Silvio Savarese, and Steven Hoi.

</span>
<span class="ltx_bibblock">Blip-2: Bootstrapping language-image pre-training with frozen image encoders and large language models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">International conference on machine learning</em>, pp.  19730–19742. PMLR, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al. (2014)</span>
<span class="ltx_bibblock">
Tsung-Yi Lin, Michael Maire, Serge Belongie, James Hays, Pietro Perona, Deva Ramanan, Piotr Dollár, and C Lawrence Zitnick.

</span>
<span class="ltx_bibblock">Microsoft coco: Common objects in context.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">Computer Vision–ECCV 2014: 13th European Conference, Zurich, Switzerland, September 6-12, 2014, Proceedings, Part V 13</em>, pp.  740–755. Springer, 2014.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al. (2023)</span>
<span class="ltx_bibblock">
Xi Victoria Lin, Xilun Chen, Mingda Chen, Weijia Shi, Maria Lomeli, Rich James, Pedro Rodriguez, Jacob Kahn, Gergely Szilvasy, Mike Lewis, et al.

</span>
<span class="ltx_bibblock">Ra-dit: Retrieval-augmented dual instruction tuning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">arXiv preprint arXiv:2310.01352</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2024a)</span>
<span class="ltx_bibblock">
Haotian Liu, Chunyuan Li, Yuheng Li, and Yong Jae Lee.

</span>
<span class="ltx_bibblock">Improved baselines with visual instruction tuning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pp.  26296–26306, 2024a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2024b)</span>
<span class="ltx_bibblock">
Haotian Liu, Chunyuan Li, Qingyang Wu, and Yong Jae Lee.

</span>
<span class="ltx_bibblock">Visual instruction tuning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">Advances in neural information processing systems</em>, 36, 2024b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lu et al. (2022)</span>
<span class="ltx_bibblock">
Pan Lu, Liang Qiu, Kai-Wei Chang, Ying Nian Wu, Song-Chun Zhu, Tanmay Rajpurohit, Peter Clark, and Ashwin Kalyan.

</span>
<span class="ltx_bibblock">Dynamic prompt learning via policy gradient for semi-structured mathematical reasoning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">arXiv preprint arXiv:2209.14610</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Marino et al. (2019)</span>
<span class="ltx_bibblock">
Kenneth Marino, Mohammad Rastegari, Ali Farhadi, and Roozbeh Mottaghi.

</span>
<span class="ltx_bibblock">Ok-vqa: A visual question answering benchmark requiring external knowledge.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">Proceedings of the IEEE/cvf conference on computer vision and pattern recognition</em>, pp.  3195–3204, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Radford et al. (2021)</span>
<span class="ltx_bibblock">
Alec Radford, Jong Wook Kim, Chris Hallacy, Aditya Ramesh, Gabriel Goh, Sandhini Agarwal, Girish Sastry, Amanda Askell, Pamela Mishkin, Jack Clark, et al.

</span>
<span class="ltx_bibblock">Learning transferable visual models from natural language supervision.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">International conference on machine learning</em>, pp.  8748–8763. PMLR, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Raffel et al. (2020)</span>
<span class="ltx_bibblock">
Colin Raffel, Noam Shazeer, Adam Roberts, Katherine Lee, Sharan Narang, Michael Matena, Yanqi Zhou, Wei Li, and Peter J Liu.

</span>
<span class="ltx_bibblock">Exploring the limits of transfer learning with a unified text-to-text transformer.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">Journal of machine learning research</em>, 21(140):1–67, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ramesh et al. (2021)</span>
<span class="ltx_bibblock">
Aditya Ramesh, Mikhail Pavlov, Gabriel Goh, Scott Gray, Chelsea Voss, Alec Radford, Mark Chen, and Ilya Sutskever.

</span>
<span class="ltx_bibblock">Zero-shot text-to-image generation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">International conference on machine learning</em>, pp.  8821–8831. Pmlr, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Selvaraju et al. (2017)</span>
<span class="ltx_bibblock">
Ramprasaath R Selvaraju, Michael Cogswell, Abhishek Das, Ramakrishna Vedantam, Devi Parikh, and Dhruv Batra.

</span>
<span class="ltx_bibblock">Grad-cam: Visual explanations from deep networks via gradient-based localization.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">Proceedings of the IEEE international conference on computer vision</em>, pp.  618–626, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Talmor et al. (2021)</span>
<span class="ltx_bibblock">
Alon Talmor, Ori Yoran, Amnon Catav, Dan Lahav, Yizhong Wang, Akari Asai, Gabriel Ilharco, Hannaneh Hajishirzi, and Jonathan Berant.

</span>
<span class="ltx_bibblock">Multimodalqa: Complex question answering over text, tables and images.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">arXiv preprint arXiv:2104.06039</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tiong et al. (2022)</span>
<span class="ltx_bibblock">
Anthony Meng Huat Tiong, Junnan Li, Boyang Li, Silvio Savarese, and Steven CH Hoi.

</span>
<span class="ltx_bibblock">Plug-and-play vqa: Zero-shot vqa by conjoining large pretrained models with zero training.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">arXiv preprint arXiv:2210.08773</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et al. (2023)</span>
<span class="ltx_bibblock">
Hugo Touvron, Thibaut Lavril, Gautier Izacard, Xavier Martinet, Marie-Anne Lachaux, Timothée Lacroix, Baptiste Rozière, Naman Goyal, Eric Hambro, Faisal Azhar, et al.

</span>
<span class="ltx_bibblock">Llama: Open and efficient foundation language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">arXiv preprint arXiv:2302.13971</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xiao et al. (2024)</span>
<span class="ltx_bibblock">
Xin Xiao, Bohong Wu, Jiacong Wang, Chunyuan Li, Xun Zhou, and Haoyuan Guo.

</span>
<span class="ltx_bibblock">Seeing the image: Prioritizing visual correlation by contrastive alignment.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib42.1.1">arXiv preprint arXiv:2405.17871</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. (2023)</span>
<span class="ltx_bibblock">
Qian Yang, Qian Chen, Wen Wang, Baotian Hu, and Min Zhang.

</span>
<span class="ltx_bibblock">Enhancing multi-modal multi-hop question answering via structured knowledge and unified retrieval-generation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib43.1.1">Proceedings of the 31st ACM International Conference on Multimedia</em>, pp.  5223–5234, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ye et al. (2024)</span>
<span class="ltx_bibblock">
Qinghao Ye, Haiyang Xu, Jiabo Ye, Ming Yan, Anwen Hu, Haowei Liu, Qi Qian, Ji Zhang, and Fei Huang.

</span>
<span class="ltx_bibblock">mplug-owl2: Revolutionizing multi-modal large language model with modality collaboration.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib44.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pp.  13040–13051, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ye &amp; Durrett (2022)</span>
<span class="ltx_bibblock">
Xi Ye and Greg Durrett.

</span>
<span class="ltx_bibblock">The unreliability of explanations in few-shot prompting for textual reasoning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib45.1.1">Advances in neural information processing systems</em>, 35:30378–30392, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Young et al. (2014)</span>
<span class="ltx_bibblock">
Peter Young, Alice Lai, Micah Hodosh, and Julia Hockenmaier.

</span>
<span class="ltx_bibblock">From image descriptions to visual denotations: New similarity metrics for semantic inference over event descriptions.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib46.1.1">Transactions of the Association for Computational Linguistics</em>, 2:67–78, 2014.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al. (2022)</span>
<span class="ltx_bibblock">
Jiahui Yu, Yuanzhong Xu, Jing Yu Koh, Thang Luong, Gunjan Baid, Zirui Wang, Vijay Vasudevan, Alexander Ku, Yinfei Yang, Burcu Karagol Ayan, et al.

</span>
<span class="ltx_bibblock">Scaling autoregressive models for content-rich text-to-image generation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib47.1.1">arXiv preprint arXiv:2206.10789</em>, 2(3):5, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al. (2024)</span>
<span class="ltx_bibblock">
Yue Yu, Wei Ping, Zihan Liu, Boxin Wang, Jiaxuan You, Chao Zhang, Mohammad Shoeybi, and Bryan Catanzaro.

</span>
<span class="ltx_bibblock">Rankrag: Unifying context ranking with retrieval-augmented generation in llms.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib48.1.1">arXiv preprint arXiv:2407.02485</em>, 2024.

</span>
</li>
</ul>
</section>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Data Statistics and Evaluation Metrics</h2>
<figure class="ltx_table" id="A1.T6">
<div class="ltx_flex_figure ltx_flex_table">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="A1.T6.fig1" style="width:119.2pt;">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Table 5: </span>Overall statistics of datasets.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A1.T6.fig1.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A1.T6.fig1.1.1.1">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="A1.T6.fig1.1.1.1.1" style="padding-left:1.4pt;padding-right:1.4pt;">Dataset</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_tt" id="A1.T6.fig1.1.1.1.2" style="padding-left:1.4pt;padding-right:1.4pt;">Train</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_tt" id="A1.T6.fig1.1.1.1.3" style="padding-left:1.4pt;padding-right:1.4pt;">Dev</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_tt" id="A1.T6.fig1.1.1.1.4" style="padding-left:1.4pt;padding-right:1.4pt;">Test</td>
</tr>
<tr class="ltx_tr" id="A1.T6.fig1.1.2.2">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A1.T6.fig1.1.2.2.1" style="padding-left:1.4pt;padding-right:1.4pt;">WebQA</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A1.T6.fig1.1.2.2.2" style="padding-left:1.4pt;padding-right:1.4pt;">15K</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A1.T6.fig1.1.2.2.3" style="padding-left:1.4pt;padding-right:1.4pt;">3.7K</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A1.T6.fig1.1.2.2.4" style="padding-left:1.4pt;padding-right:1.4pt;">2.5K</td>
</tr>
<tr class="ltx_tr" id="A1.T6.fig1.1.3.3">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row" id="A1.T6.fig1.1.3.3.1" style="padding-left:1.4pt;padding-right:1.4pt;">MultimodalQA</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A1.T6.fig1.1.3.3.2" style="padding-left:1.4pt;padding-right:1.4pt;">2K</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A1.T6.fig1.1.3.3.3" style="padding-left:1.4pt;padding-right:1.4pt;">420</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A1.T6.fig1.1.3.3.4" style="padding-left:1.4pt;padding-right:1.4pt;">230</td>
</tr>
<tr class="ltx_tr" id="A1.T6.fig1.1.4.4">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row" id="A1.T6.fig1.1.4.4.1" style="padding-left:1.4pt;padding-right:1.4pt;">Flickr30K</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A1.T6.fig1.1.4.4.2" style="padding-left:1.4pt;padding-right:1.4pt;">29K</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A1.T6.fig1.1.4.4.3" style="padding-left:1.4pt;padding-right:1.4pt;">1K</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A1.T6.fig1.1.4.4.4" style="padding-left:1.4pt;padding-right:1.4pt;">1K</td>
</tr>
<tr class="ltx_tr" id="A1.T6.fig1.1.5.5">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="A1.T6.fig1.1.5.5.1" style="padding-left:1.4pt;padding-right:1.4pt;">MS-COCO</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" id="A1.T6.fig1.1.5.5.2" style="padding-left:1.4pt;padding-right:1.4pt;">113K</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" id="A1.T6.fig1.1.5.5.3" style="padding-left:1.4pt;padding-right:1.4pt;">5K</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" id="A1.T6.fig1.1.5.5.4" style="padding-left:1.4pt;padding-right:1.4pt;">5K</td>
</tr>
</tbody>
</table>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="A1.T6.fig2" style="width:258.4pt;">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Table 6: </span>Recall@20 of different retrievers.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A1.T6.fig2.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A1.T6.fig2.1.1.1">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A1.T6.fig2.1.1.1.1" style="padding-left:1.4pt;padding-right:1.4pt;">Methods</th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T6.fig2.1.1.1.2" style="padding-left:1.4pt;padding-right:1.4pt;">MultimodalQA</th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T6.fig2.1.1.1.3" style="padding-left:1.4pt;padding-right:1.4pt;">WebQA</th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T6.fig2.1.1.1.4" style="padding-left:1.4pt;padding-right:1.4pt;">Flickr30K</th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T6.fig2.1.1.1.5" style="padding-left:1.4pt;padding-right:1.4pt;">MS-COCO</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A1.T6.fig2.1.2.1">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A1.T6.fig2.1.2.1.1" style="padding-left:1.4pt;padding-right:1.4pt;">CLIP-ViT-L/14-336px</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A1.T6.fig2.1.2.1.2" style="padding-left:1.4pt;padding-right:1.4pt;">98.26</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A1.T6.fig2.1.2.1.3" style="padding-left:1.4pt;padding-right:1.4pt;">90.27</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A1.T6.fig2.1.2.1.4" style="padding-left:1.4pt;padding-right:1.4pt;">96.54</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A1.T6.fig2.1.2.1.5" style="padding-left:1.4pt;padding-right:1.4pt;">96.84</td>
</tr>
<tr class="ltx_tr" id="A1.T6.fig2.1.3.2">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row" id="A1.T6.fig2.1.3.2.1" style="padding-left:1.4pt;padding-right:1.4pt;">Vis-BGE-base</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A1.T6.fig2.1.3.2.2" style="padding-left:1.4pt;padding-right:1.4pt;">88.70</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A1.T6.fig2.1.3.2.3" style="padding-left:1.4pt;padding-right:1.4pt;">65.89</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A1.T6.fig2.1.3.2.4" style="padding-left:1.4pt;padding-right:1.4pt;">93.64</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A1.T6.fig2.1.3.2.5" style="padding-left:1.4pt;padding-right:1.4pt;">95.86</td>
</tr>
<tr class="ltx_tr" id="A1.T6.fig2.1.4.3">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row" id="A1.T6.fig2.1.4.3.1" style="padding-left:1.4pt;padding-right:1.4pt;">Vis-BGE-m3</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A1.T6.fig2.1.4.3.2" style="padding-left:1.4pt;padding-right:1.4pt;">84.78</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A1.T6.fig2.1.4.3.3" style="padding-left:1.4pt;padding-right:1.4pt;">63.14</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A1.T6.fig2.1.4.3.4" style="padding-left:1.4pt;padding-right:1.4pt;">91.48</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A1.T6.fig2.1.4.3.5" style="padding-left:1.4pt;padding-right:1.4pt;">91.98</td>
</tr>
<tr class="ltx_tr" id="A1.T6.fig2.1.5.4">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row" id="A1.T6.fig2.1.5.4.1" style="padding-left:1.4pt;padding-right:1.4pt;">InternVL-C</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A1.T6.fig2.1.5.4.2" style="padding-left:1.4pt;padding-right:1.4pt;">98.70</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A1.T6.fig2.1.5.4.3" style="padding-left:1.4pt;padding-right:1.4pt;">93.27</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A1.T6.fig2.1.5.4.4" style="padding-left:1.4pt;padding-right:1.4pt;">98.92</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A1.T6.fig2.1.5.4.5" style="padding-left:1.4pt;padding-right:1.4pt;">98.64</td>
</tr>
<tr class="ltx_tr" id="A1.T6.fig2.1.6.5">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="A1.T6.fig2.1.6.5.1" style="padding-left:1.4pt;padding-right:1.4pt;">InternVL-G</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" id="A1.T6.fig2.1.6.5.2" style="padding-left:1.4pt;padding-right:1.4pt;">97.83</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" id="A1.T6.fig2.1.6.5.3" style="padding-left:1.4pt;padding-right:1.4pt;">92.78</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" id="A1.T6.fig2.1.6.5.4" style="padding-left:1.4pt;padding-right:1.4pt;">99.22</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" id="A1.T6.fig2.1.6.5.5" style="padding-left:1.4pt;padding-right:1.4pt;">99.02</td>
</tr>
</tbody>
</table>
</figure>
</div>
</div>
</figure>
<div class="ltx_para ltx_noindent" id="A1.p1">
<p class="ltx_p" id="A1.p1.1"><span class="ltx_text ltx_font_bold" id="A1.p1.1.1">WebQA</span> consists of queries requiring 1-2 images or text snippets, while 44% of image-based and 99% of text-based queries need multiple knowledge sources. Following the vanilla evaluation setting, we measure the overlap of key entities between the generated output and ground truth answer as <span class="ltx_text ltx_font_italic" id="A1.p1.1.2">Accuracy</span>.</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.p2">
<p class="ltx_p" id="A1.p2.1"><span class="ltx_text ltx_font_bold" id="A1.p2.1.1">MultimodalQA</span> contains multimodal questions over tables, text, and images. We focus on the QA pairs requiring only image information, which are annotated as ‘ImageQ’ and attached to 1 image each. The evaluation metric used is Exact Match (<span class="ltx_text ltx_font_italic" id="A1.p2.1.2">EM</span>).</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.p3">
<p class="ltx_p" id="A1.p3.1"><span class="ltx_text ltx_font_bold" id="A1.p3.1.1">Flickr30K</span> consists of 31,000 images sourced from Flickr, each accompanied by five captions. Consistent with the setup of <cite class="ltx_cite ltx_citemacro_cite">Lee et al. (<a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#bib.bib25" title="">2018</a>)</cite>, we allocate 1,000 images for validation, 1,000 for testing, and use the remaining images for training.</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.p4">
<p class="ltx_p" id="A1.p4.1"><span class="ltx_text ltx_font_bold" id="A1.p4.1.1">MS-COCO</span> comprises 123,287 images, each paired with five captions. Following the protocol in <cite class="ltx_cite ltx_citemacro_cite">Lee et al. (<a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#bib.bib25" title="">2018</a>)</cite>, we designate 113,287 images for training, 5,000 for validation, and 5,000 for testing.</p>
</div>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Implementation Details</h2>
<div class="ltx_para ltx_noindent" id="A2.p1">
<p class="ltx_p" id="A2.p1.4">To evaluate the effectiveness and generalizability of our proposed method, this paper leverages several cutting-edge MLLMs as the backbone, including LLaVA-v1.5-13B <cite class="ltx_cite ltx_citemacro_citep">(Liu et al., <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#bib.bib31" title="">2024a</a>)</cite>, mPLUG-Owl2 <cite class="ltx_cite ltx_citemacro_citep">(Ye et al., <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#bib.bib44" title="">2024</a>)</cite>, Qwen-VL-Chat <cite class="ltx_cite ltx_citemacro_citep">(Bai et al., <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#bib.bib4" title="">2023</a>)</cite>, and InternVL <cite class="ltx_cite ltx_citemacro_citep">(Chen et al., <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#bib.bib9" title="">2024</a>)</cite>. We employ the frozen CLIP-ViT-L/14-336px as the vision and text encoder. For <span class="ltx_text ltx_font_italic" id="A2.p1.4.1">RagVL</span>, we first train the reranker model with the caption-aware ranking task. Subsequently, we use CLIP to retrieve top-<math alttext="K" class="ltx_Math" display="inline" id="A2.p1.1.m1.1"><semantics id="A2.p1.1.m1.1a"><mi id="A2.p1.1.m1.1.1" xref="A2.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A2.p1.1.m1.1b"><ci id="A2.p1.1.m1.1.1.cmml" xref="A2.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="A2.p1.1.m1.1d">italic_K</annotation></semantics></math> candidates and rerank them into top-<math alttext="N" class="ltx_Math" display="inline" id="A2.p1.2.m2.1"><semantics id="A2.p1.2.m2.1a"><mi id="A2.p1.2.m2.1.1" xref="A2.p1.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="A2.p1.2.m2.1b"><ci id="A2.p1.2.m2.1.1.cmml" xref="A2.p1.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.2.m2.1c">N</annotation><annotation encoding="application/x-llamapun" id="A2.p1.2.m2.1d">italic_N</annotation></semantics></math> with the fine-tuned reranker. <math alttext="K" class="ltx_Math" display="inline" id="A2.p1.3.m3.1"><semantics id="A2.p1.3.m3.1a"><mi id="A2.p1.3.m3.1.1" xref="A2.p1.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A2.p1.3.m3.1b"><ci id="A2.p1.3.m3.1.1.cmml" xref="A2.p1.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.3.m3.1c">K</annotation><annotation encoding="application/x-llamapun" id="A2.p1.3.m3.1d">italic_K</annotation></semantics></math> is set to 20, while <math alttext="N" class="ltx_Math" display="inline" id="A2.p1.4.m4.1"><semantics id="A2.p1.4.m4.1a"><mi id="A2.p1.4.m4.1.1" xref="A2.p1.4.m4.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="A2.p1.4.m4.1b"><ci id="A2.p1.4.m4.1.1.cmml" xref="A2.p1.4.m4.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.4.m4.1c">N</annotation><annotation encoding="application/x-llamapun" id="A2.p1.4.m4.1d">italic_N</annotation></semantics></math> is set to 2 for WebQA and 1 for MultimodalQA. For evaluation, we use greedy decoding to ensure reproducibility and report the best performance. All experiments are conducted on 8 40G NVIDIA A100 GPUs.</p>
</div>
<figure class="ltx_table" id="A2.T7">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 7: </span>Inference time per sample. Each inference with the reranker involves 20 evaluations of image relevance and one generation of an answer.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A2.T7.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A2.T7.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A2.T7.1.1.1.1" style="padding-left:5.7pt;padding-right:5.7pt;">Approach</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A2.T7.1.1.1.2" style="padding-left:5.7pt;padding-right:5.7pt;">Time Cost</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A2.T7.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A2.T7.1.2.1.1" style="padding-left:5.7pt;padding-right:5.7pt;">CLIP Top-K</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T7.1.2.1.2" style="padding-left:5.7pt;padding-right:5.7pt;">1.23s</td>
</tr>
<tr class="ltx_tr" id="A2.T7.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T7.1.3.2.1" style="padding-left:5.7pt;padding-right:5.7pt;">   + InternVL2-2B reranker</th>
<td class="ltx_td ltx_align_center" id="A2.T7.1.3.2.2" style="padding-left:5.7pt;padding-right:5.7pt;">5.11s</td>
</tr>
<tr class="ltx_tr" id="A2.T7.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="A2.T7.1.4.3.1" style="padding-left:5.7pt;padding-right:5.7pt;">   + LLaVA-v1.5-13B reranker</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A2.T7.1.4.3.2" style="padding-left:5.7pt;padding-right:5.7pt;">6.24s</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_appendix" id="A3">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Computational Efficiency</h2>
<div class="ltx_para ltx_noindent" id="A3.p1">
<p class="ltx_p" id="A3.p1.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#A2.T7" title="Table 7 ‣ Appendix B Implementation Details ‣ MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_tag">7</span></a> presents the inference time for different settings on 4 A100 GPUs. As shown, <span class="ltx_text ltx_font_italic" id="A3.p1.1.1">“CLIP Top-K”</span> only requires a small amount of time due to fast inner product search, while our proposed method requires more time on reranking the retrieved candidates. Though the MLLM reranker shows powerful retrieval performance, the efficiency will be a major issue that limits its development.</p>
</div>
<div class="ltx_para ltx_noindent" id="A3.p2">
<p class="ltx_p" id="A3.p2.1">Thanks to advances in inference acceleration, we can address the efficiency issue from different perspectives. For example, FlashAttention <cite class="ltx_cite ltx_citemacro_citep">(Dao et al., <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#bib.bib10" title="">2022</a>)</cite> enables faster inference with lower resources by using tiling to reduce the number of memory reads/writes between GPU memories. PagedAttention <cite class="ltx_cite ltx_citemacro_citep">(Kwon et al., <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#bib.bib24" title="">2023</a>)</cite> resorts to the classical virtual memory and paging techniques in operating systems to achieve near-zero waste and flexible sharing of KV cache memory. To be more specific, we can share the attention calculation of textual tokens among different candidates and parallelize the computation of visual tokens to maximize resource utilization and accelerate inference since the textual instructions of all candidates during the reranking process are identical. As a successful attempt, Prompt Cache <cite class="ltx_cite ltx_citemacro_citep">(Gim et al., <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#bib.bib14" title="">2024</a>)</cite> has made similar efforts to reduce latency in time-to-first-token, which improves 8x for GPU-based inference and maintains output accuracy.</p>
</div>
</section>
<section class="ltx_appendix" id="A4">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Effect of Captions</h2>
<figure class="ltx_table ltx_align_floatright" id="A4.T8">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 8: </span>Reranking performance of different models on WebQA.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A4.T8.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A4.T8.1.1.1">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="A4.T8.1.1.1.1" rowspan="2" style="padding-left:1.4pt;padding-right:1.4pt;"><span class="ltx_text" id="A4.T8.1.1.1.1.1">Methods</span></th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_tt" id="A4.T8.1.1.1.2" style="padding-left:1.4pt;padding-right:1.4pt;">WebQA Ranking</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_tt" id="A4.T8.1.1.1.3" style="padding-left:1.4pt;padding-right:1.4pt;">WebQA QA</td>
</tr>
<tr class="ltx_tr" id="A4.T8.1.2.2">
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A4.T8.1.2.2.1" style="padding-left:1.4pt;padding-right:1.4pt;">Acc</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A4.T8.1.2.2.2" style="padding-left:1.4pt;padding-right:1.4pt;">Recall@2</td>
</tr>
<tr class="ltx_tr" id="A4.T8.1.3.3">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A4.T8.1.3.3.1" style="padding-left:1.4pt;padding-right:1.4pt;">CLIP-ViT-L/14-336px</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A4.T8.1.3.3.2" style="padding-left:1.4pt;padding-right:1.4pt;">-</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="A4.T8.1.3.3.3" style="padding-left:1.4pt;padding-right:1.4pt;">57.10</td>
</tr>
<tr class="ltx_tr" id="A4.T8.1.4.4">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_th ltx_th_row" id="A4.T8.1.4.4.1" style="padding-left:1.4pt;padding-right:1.4pt;">LLaVA-v1.5-13B</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A4.T8.1.4.4.2" style="padding-left:1.4pt;padding-right:1.4pt;">67.74</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A4.T8.1.4.4.3" style="padding-left:1.4pt;padding-right:1.4pt;">45.35</td>
</tr>
<tr class="ltx_tr" id="A4.T8.1.5.5">
<th class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_row" id="A4.T8.1.5.5.1" style="padding-left:1.4pt;padding-right:1.4pt;">
<span class="ltx_text ltx_font_italic" id="A4.T8.1.5.5.1.1">w/ caption-agnostic</span> IT</th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A4.T8.1.5.5.2" style="padding-left:1.4pt;padding-right:1.4pt;">89.62</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="A4.T8.1.5.5.3" style="padding-left:1.4pt;padding-right:1.4pt;">54.45</td>
</tr>
<tr class="ltx_tr" id="A4.T8.1.6.6" style="background-color:#D9D9D9;">
<th class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="A4.T8.1.6.6.1" style="padding-left:1.4pt;padding-right:1.4pt;"><span class="ltx_text ltx_font_italic" id="A4.T8.1.6.6.1.1" style="background-color:#D9D9D9;">w/ caption-aware<span class="ltx_text ltx_font_upright" id="A4.T8.1.6.6.1.1.1"> IT</span></span></th>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" id="A4.T8.1.6.6.2" style="padding-left:1.4pt;padding-right:1.4pt;"><span class="ltx_text ltx_font_bold" id="A4.T8.1.6.6.2.1" style="background-color:#D9D9D9;">93.99</span></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" id="A4.T8.1.6.6.3" style="padding-left:1.4pt;padding-right:1.4pt;"><span class="ltx_text ltx_font_bold" id="A4.T8.1.6.6.3.1" style="background-color:#D9D9D9;">79.74</span></td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para ltx_noindent" id="A4.p1">
<p class="ltx_p" id="A4.p1.1">We conduct experiments on test sets of WebQA ranking and QA datasets to verify the validity of captions in retrieving relevant sources. In WebQA QA task, we retrieve top-20 candidate images using CLIP and rerank them into top-2 with our instruction-tuned reranker models. As shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#A4.T8" title="Table 8 ‣ Appendix D Effect of Captions ‣ MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_tag">8</span></a>, the vanilla LLaVA-v1.5-13B performs poorly on both tasks. The models trained on the ranking task outperform the baseline, particularly the one trained on the caption-aware task. This demonstrates the superiority of our simple yet effective instruction templates in inducing the ranking ability of MLLMs.</p>
</div>
<figure class="ltx_table" id="A4.T9">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 9: </span>The instruction template for ranking and generation tasks. The retrieval-augmented QA task allows multi-image input, whereas the ranking tasks consider one image at a time.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A4.T9.9">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A4.T9.9.10.1">
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="A4.T9.9.10.1.1" style="padding-left:2.8pt;padding-right:2.8pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T9.9.10.1.1.1">
<span class="ltx_p" id="A4.T9.9.10.1.1.1.1" style="width:128.0pt;"><span class="ltx_text ltx_font_bold" id="A4.T9.9.10.1.1.1.1.1">Task</span></span>
</span>
</th>
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="A4.T9.9.10.1.2" style="padding-left:2.8pt;padding-right:2.8pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T9.9.10.1.2.1">
<span class="ltx_p" id="A4.T9.9.10.1.2.1.1" style="width:207.7pt;"><span class="ltx_text ltx_font_bold" id="A4.T9.9.10.1.2.1.1.1">Instruction</span></span>
</span>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A4.T9.9.10.1.3" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text ltx_font_bold" id="A4.T9.9.10.1.3.1">Answer</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A4.T9.5.5">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="A4.T9.5.5.6" style="padding-left:2.8pt;padding-right:2.8pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T9.5.5.6.1">
<span class="ltx_p" id="A4.T9.5.5.6.1.1" style="width:128.0pt;">Multimodal Retrieval-augmented QA</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="A4.T9.5.5.5" style="padding-left:2.8pt;padding-right:2.8pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T9.5.5.5.5">
<span class="ltx_p" id="A4.T9.5.5.5.5.5" style="width:207.7pt;"><math alttext="&lt;" class="ltx_Math" display="inline" id="A4.T9.1.1.1.1.1.m1.1"><semantics id="A4.T9.1.1.1.1.1.m1.1a"><mo id="A4.T9.1.1.1.1.1.m1.1.1" xref="A4.T9.1.1.1.1.1.m1.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="A4.T9.1.1.1.1.1.m1.1b"><lt id="A4.T9.1.1.1.1.1.m1.1.1.cmml" xref="A4.T9.1.1.1.1.1.m1.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="A4.T9.1.1.1.1.1.m1.1c">&lt;</annotation><annotation encoding="application/x-llamapun" id="A4.T9.1.1.1.1.1.m1.1d">&lt;</annotation></semantics></math>image<math alttext="&gt;" class="ltx_Math" display="inline" id="A4.T9.2.2.2.2.2.m2.1"><semantics id="A4.T9.2.2.2.2.2.m2.1a"><mo id="A4.T9.2.2.2.2.2.m2.1.1" xref="A4.T9.2.2.2.2.2.m2.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="A4.T9.2.2.2.2.2.m2.1b"><gt id="A4.T9.2.2.2.2.2.m2.1.1.cmml" xref="A4.T9.2.2.2.2.2.m2.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="A4.T9.2.2.2.2.2.m2.1c">&gt;</annotation><annotation encoding="application/x-llamapun" id="A4.T9.2.2.2.2.2.m2.1d">&gt;</annotation></semantics></math> <math alttext="\cdots" class="ltx_Math" display="inline" id="A4.T9.3.3.3.3.3.m3.1"><semantics id="A4.T9.3.3.3.3.3.m3.1a"><mi id="A4.T9.3.3.3.3.3.m3.1.1" mathvariant="normal" xref="A4.T9.3.3.3.3.3.m3.1.1.cmml">⋯</mi><annotation-xml encoding="MathML-Content" id="A4.T9.3.3.3.3.3.m3.1b"><ci id="A4.T9.3.3.3.3.3.m3.1.1.cmml" xref="A4.T9.3.3.3.3.3.m3.1.1">⋯</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.T9.3.3.3.3.3.m3.1c">\cdots</annotation><annotation encoding="application/x-llamapun" id="A4.T9.3.3.3.3.3.m3.1d">⋯</annotation></semantics></math> <math alttext="&lt;" class="ltx_Math" display="inline" id="A4.T9.4.4.4.4.4.m4.1"><semantics id="A4.T9.4.4.4.4.4.m4.1a"><mo id="A4.T9.4.4.4.4.4.m4.1.1" xref="A4.T9.4.4.4.4.4.m4.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="A4.T9.4.4.4.4.4.m4.1b"><lt id="A4.T9.4.4.4.4.4.m4.1.1.cmml" xref="A4.T9.4.4.4.4.4.m4.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="A4.T9.4.4.4.4.4.m4.1c">&lt;</annotation><annotation encoding="application/x-llamapun" id="A4.T9.4.4.4.4.4.m4.1d">&lt;</annotation></semantics></math>image<math alttext="&gt;" class="ltx_Math" display="inline" id="A4.T9.5.5.5.5.5.m5.1"><semantics id="A4.T9.5.5.5.5.5.m5.1a"><mo id="A4.T9.5.5.5.5.5.m5.1.1" xref="A4.T9.5.5.5.5.5.m5.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="A4.T9.5.5.5.5.5.m5.1b"><gt id="A4.T9.5.5.5.5.5.m5.1.1.cmml" xref="A4.T9.5.5.5.5.5.m5.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="A4.T9.5.5.5.5.5.m5.1c">&gt;</annotation><annotation encoding="application/x-llamapun" id="A4.T9.5.5.5.5.5.m5.1d">&gt;</annotation></semantics></math> {<span class="ltx_text ltx_font_typewriter" id="A4.T9.5.5.5.5.5.1">question</span>}</span>
</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A4.T9.5.5.7" style="padding-left:2.8pt;padding-right:2.8pt;">A phrase</td>
</tr>
<tr class="ltx_tr" id="A4.T9.7.7">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="A4.T9.7.7.3" style="padding-left:2.8pt;padding-right:2.8pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T9.7.7.3.1">
<span class="ltx_p" id="A4.T9.7.7.3.1.1" style="width:128.0pt;"><span class="ltx_text" id="A4.T9.7.7.3.1.1.1">Caption-agnostic Ranking</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="A4.T9.7.7.2" style="padding-left:2.8pt;padding-right:2.8pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T9.7.7.2.2">
<span class="ltx_p" id="A4.T9.7.7.2.2.2" style="width:207.7pt;"><math alttext="&lt;" class="ltx_Math" display="inline" id="A4.T9.6.6.1.1.1.m1.1"><semantics id="A4.T9.6.6.1.1.1.m1.1a"><mo id="A4.T9.6.6.1.1.1.m1.1.1" xref="A4.T9.6.6.1.1.1.m1.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="A4.T9.6.6.1.1.1.m1.1b"><lt id="A4.T9.6.6.1.1.1.m1.1.1.cmml" xref="A4.T9.6.6.1.1.1.m1.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="A4.T9.6.6.1.1.1.m1.1c">&lt;</annotation><annotation encoding="application/x-llamapun" id="A4.T9.6.6.1.1.1.m1.1d">&lt;</annotation></semantics></math>image<math alttext="&gt;" class="ltx_Math" display="inline" id="A4.T9.7.7.2.2.2.m2.1"><semantics id="A4.T9.7.7.2.2.2.m2.1a"><mo id="A4.T9.7.7.2.2.2.m2.1.1" xref="A4.T9.7.7.2.2.2.m2.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="A4.T9.7.7.2.2.2.m2.1b"><gt id="A4.T9.7.7.2.2.2.m2.1.1.cmml" xref="A4.T9.7.7.2.2.2.m2.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="A4.T9.7.7.2.2.2.m2.1c">&gt;</annotation><annotation encoding="application/x-llamapun" id="A4.T9.7.7.2.2.2.m2.1d">&gt;</annotation></semantics></math> Question:{<span class="ltx_text ltx_font_typewriter" id="A4.T9.7.7.2.2.2.1">question</span>} Is this image relevant to the question? Answer ‘Yes’ or ‘No’.</span>
</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A4.T9.7.7.4" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="A4.T9.7.7.4.1">Yes / No</span></td>
</tr>
<tr class="ltx_tr" id="A4.T9.9.9">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_r ltx_border_t" id="A4.T9.9.9.3" rowspan="3" style="padding-left:2.8pt;padding-right:2.8pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T9.9.9.3.1">
<span class="ltx_p" id="A4.T9.9.9.3.1.1" style="width:128.0pt;"><span class="ltx_text" id="A4.T9.9.9.3.1.1.1">Caption-aware Ranking (QA)</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_r ltx_border_t" id="A4.T9.9.9.2" style="padding-left:2.8pt;padding-right:2.8pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T9.9.9.2.2">
<span class="ltx_p" id="A4.T9.9.9.2.2.2" style="width:207.7pt;"><math alttext="&lt;" class="ltx_Math" display="inline" id="A4.T9.8.8.1.1.1.m1.1"><semantics id="A4.T9.8.8.1.1.1.m1.1a"><mo id="A4.T9.8.8.1.1.1.m1.1.1" xref="A4.T9.8.8.1.1.1.m1.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="A4.T9.8.8.1.1.1.m1.1b"><lt id="A4.T9.8.8.1.1.1.m1.1.1.cmml" xref="A4.T9.8.8.1.1.1.m1.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="A4.T9.8.8.1.1.1.m1.1c">&lt;</annotation><annotation encoding="application/x-llamapun" id="A4.T9.8.8.1.1.1.m1.1d">&lt;</annotation></semantics></math>image<math alttext="&gt;" class="ltx_Math" display="inline" id="A4.T9.9.9.2.2.2.m2.1"><semantics id="A4.T9.9.9.2.2.2.m2.1a"><mo id="A4.T9.9.9.2.2.2.m2.1.1" xref="A4.T9.9.9.2.2.2.m2.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="A4.T9.9.9.2.2.2.m2.1b"><gt id="A4.T9.9.9.2.2.2.m2.1.1.cmml" xref="A4.T9.9.9.2.2.2.m2.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="A4.T9.9.9.2.2.2.m2.1c">&gt;</annotation><annotation encoding="application/x-llamapun" id="A4.T9.9.9.2.2.2.m2.1d">&gt;</annotation></semantics></math> Image Caption:{<span class="ltx_text ltx_font_typewriter" id="A4.T9.9.9.2.2.2.1">caption</span>} Question:{<span class="ltx_text ltx_font_typewriter" id="A4.T9.9.9.2.2.2.2">question</span>} Based on the image and its caption, is the image relevant to the question? Answer “Yes” or “No”.</span>
</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="A4.T9.9.9.4" rowspan="3" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="A4.T9.9.9.4.1">Yes / No</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_appendix" id="A5">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix E </span>Performance on Caption-to-image Retrieval</h2>
<div class="ltx_para ltx_noindent" id="A5.p1">
<p class="ltx_p" id="A5.p1.2">To further verify the effectiveness and generalizability of our proposed reranking method, we conduct more experiments on Flickr30K and MS-COCO. We construct the reranking tasks and prompt the reranker with the instruction “<math alttext="&lt;" class="ltx_Math" display="inline" id="A5.p1.1.m1.1"><semantics id="A5.p1.1.m1.1a"><mo id="A5.p1.1.m1.1.1" xref="A5.p1.1.m1.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="A5.p1.1.m1.1b"><lt id="A5.p1.1.m1.1.1.cmml" xref="A5.p1.1.m1.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="A5.p1.1.m1.1c">&lt;</annotation><annotation encoding="application/x-llamapun" id="A5.p1.1.m1.1d">&lt;</annotation></semantics></math><span class="ltx_text ltx_font_italic" id="A5.p1.2.1">image<math alttext="&gt;" class="ltx_Math" display="inline" id="A5.p1.2.1.m1.1"><semantics id="A5.p1.2.1.m1.1a"><mo id="A5.p1.2.1.m1.1.1" xref="A5.p1.2.1.m1.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="A5.p1.2.1.m1.1b"><gt id="A5.p1.2.1.m1.1.1.cmml" xref="A5.p1.2.1.m1.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="A5.p1.2.1.m1.1c">&gt;</annotation><annotation encoding="application/x-llamapun" id="A5.p1.2.1.m1.1d">&gt;</annotation></semantics></math> Image Caption:</span>{<span class="ltx_text ltx_font_typewriter ltx_font_italic" id="A5.p1.2.2">caption</span>}<span class="ltx_text ltx_font_italic" id="A5.p1.2.3"> Is the image relevant to the caption? Answer ‘Yes’ or ‘No’</span>”. As shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#A5.T10" title="Table 10 ‣ Appendix E Performance on Caption-to-image Retrieval ‣ MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_tag">10</span></a>, our proposed method still outperforms the majority of existing retrievers across all metrics, except for InternVL-G, which is specifically designed for image-text matching. Our approach primarily focuses on cases where the query is a question, and the keys are captions and images. In contrast, in these two caption-to-image retrieval datasets, the query is a caption, and the key is an image. Thus, our method not only demonstrates superior performance in multimodal RAG but also maintains generalizability and competitiveness in traditional text-to-image retrieval.</p>
</div>
<figure class="ltx_table" id="A5.T10">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 10: </span>Performance of knowledge-enhanced rerankers on caption-to-image retrieval. The best scores in each setting are in <span class="ltx_text ltx_font_bold" id="A5.T10.4.1">bold</span>.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A5.T10.2">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A5.T10.2.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="A5.T10.2.3.1.1" rowspan="2" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text" id="A5.T10.2.3.1.1.1">Methods</span></th>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="3" id="A5.T10.2.3.1.2" style="padding-left:12.8pt;padding-right:12.8pt;">Flickr30K</td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="3" id="A5.T10.2.3.1.3" style="padding-left:12.8pt;padding-right:12.8pt;">MS-COCO</td>
</tr>
<tr class="ltx_tr" id="A5.T10.2.4.2">
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T10.2.4.2.1" style="padding-left:12.8pt;padding-right:12.8pt;">R@1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T10.2.4.2.2" style="padding-left:12.8pt;padding-right:12.8pt;">R@5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T10.2.4.2.3" style="padding-left:12.8pt;padding-right:12.8pt;">R@10</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T10.2.4.2.4" style="padding-left:12.8pt;padding-right:12.8pt;">R@1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T10.2.4.2.5" style="padding-left:12.8pt;padding-right:12.8pt;">R@5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T10.2.4.2.6" style="padding-left:12.8pt;padding-right:12.8pt;">R@10</td>
</tr>
<tr class="ltx_tr" id="A5.T10.2.5.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A5.T10.2.5.3.1" style="padding-left:12.8pt;padding-right:12.8pt;">CLIP-ViT-L/14-336px</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T10.2.5.3.2" style="padding-left:12.8pt;padding-right:12.8pt;">66.90</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T10.2.5.3.3" style="padding-left:12.8pt;padding-right:12.8pt;">89.00</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T10.2.5.3.4" style="padding-left:12.8pt;padding-right:12.8pt;">93.36</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T10.2.5.3.5" style="padding-left:12.8pt;padding-right:12.8pt;">57.18</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T10.2.5.3.6" style="padding-left:12.8pt;padding-right:12.8pt;">83.24</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T10.2.5.3.7" style="padding-left:12.8pt;padding-right:12.8pt;">91.90</td>
</tr>
<tr class="ltx_tr" id="A5.T10.2.6.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A5.T10.2.6.4.1" style="padding-left:12.8pt;padding-right:12.8pt;">Vis-BGE-base</th>
<td class="ltx_td ltx_align_center" id="A5.T10.2.6.4.2" style="padding-left:12.8pt;padding-right:12.8pt;">57.38</td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.6.4.3" style="padding-left:12.8pt;padding-right:12.8pt;">83.28</td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.6.4.4" style="padding-left:12.8pt;padding-right:12.8pt;">89.60</td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.6.4.5" style="padding-left:12.8pt;padding-right:12.8pt;">52.94</td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.6.4.6" style="padding-left:12.8pt;padding-right:12.8pt;">81.22</td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.6.4.7" style="padding-left:12.8pt;padding-right:12.8pt;">90.12</td>
</tr>
<tr class="ltx_tr" id="A5.T10.2.7.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A5.T10.2.7.5.1" style="padding-left:12.8pt;padding-right:12.8pt;">Vis-BGE-m3</th>
<td class="ltx_td ltx_align_center" id="A5.T10.2.7.5.2" style="padding-left:12.8pt;padding-right:12.8pt;">52.18</td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.7.5.3" style="padding-left:12.8pt;padding-right:12.8pt;">78.18</td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.7.5.4" style="padding-left:12.8pt;padding-right:12.8pt;">86.06</td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.7.5.5" style="padding-left:12.8pt;padding-right:12.8pt;">43.14</td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.7.5.6" style="padding-left:12.8pt;padding-right:12.8pt;">73.44</td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.7.5.7" style="padding-left:12.8pt;padding-right:12.8pt;">84.42</td>
</tr>
<tr class="ltx_tr" id="A5.T10.2.8.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A5.T10.2.8.6.1" style="padding-left:12.8pt;padding-right:12.8pt;">InternVL-C</th>
<td class="ltx_td ltx_align_center" id="A5.T10.2.8.6.2" style="padding-left:12.8pt;padding-right:12.8pt;">81.50</td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.8.6.3" style="padding-left:12.8pt;padding-right:12.8pt;">95.94</td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.8.6.4" style="padding-left:12.8pt;padding-right:12.8pt;">97.82</td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.8.6.5" style="padding-left:12.8pt;padding-right:12.8pt;">71.82</td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.8.6.6" style="padding-left:12.8pt;padding-right:12.8pt;">92.06</td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.8.6.7" style="padding-left:12.8pt;padding-right:12.8pt;">96.62</td>
</tr>
<tr class="ltx_tr" id="A5.T10.2.9.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A5.T10.2.9.7.1" style="padding-left:12.8pt;padding-right:12.8pt;">InternVL-G</th>
<td class="ltx_td ltx_align_center" id="A5.T10.2.9.7.2" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text ltx_font_bold" id="A5.T10.2.9.7.2.1">84.28</span></td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.9.7.3" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text ltx_font_bold" id="A5.T10.2.9.7.3.1">96.88</span></td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.9.7.4" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text ltx_font_bold" id="A5.T10.2.9.7.4.1">98.44</span></td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.9.7.5" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text ltx_font_bold" id="A5.T10.2.9.7.5.1">76.20</span></td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.9.7.6" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text ltx_font_bold" id="A5.T10.2.9.7.6.1">94.24</span></td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.9.7.7" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text ltx_font_bold" id="A5.T10.2.9.7.7.1">97.54</span></td>
</tr>
<tr class="ltx_tr" id="A5.T10.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="7" id="A5.T10.1.1.1" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text ltx_font_italic" id="A5.T10.1.1.1.1">Reranking Top-<math alttext="K" class="ltx_Math" display="inline" id="A5.T10.1.1.1.1.m1.1"><semantics id="A5.T10.1.1.1.1.m1.1a"><mi id="A5.T10.1.1.1.1.m1.1.1" xref="A5.T10.1.1.1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A5.T10.1.1.1.1.m1.1b"><ci id="A5.T10.1.1.1.1.m1.1.1.cmml" xref="A5.T10.1.1.1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.T10.1.1.1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="A5.T10.1.1.1.1.m1.1d">italic_K</annotation></semantics></math> from CLIP-ViT-L/14-336px</span></th>
</tr>
<tr class="ltx_tr" id="A5.T10.2.10.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A5.T10.2.10.8.1" style="padding-left:12.8pt;padding-right:12.8pt;">LLaVA-v1.5-13B</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T10.2.10.8.2" style="padding-left:12.8pt;padding-right:12.8pt;">79.90</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T10.2.10.8.3" style="padding-left:12.8pt;padding-right:12.8pt;">94.52</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T10.2.10.8.4" style="padding-left:12.8pt;padding-right:12.8pt;">96.24</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T10.2.10.8.5" style="padding-left:12.8pt;padding-right:12.8pt;">71.10</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T10.2.10.8.6" style="padding-left:12.8pt;padding-right:12.8pt;">92.02</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A5.T10.2.10.8.7" style="padding-left:12.8pt;padding-right:12.8pt;">95.96</td>
</tr>
<tr class="ltx_tr" id="A5.T10.2.11.9" style="background-color:#D9D9D9;">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A5.T10.2.11.9.1" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text" id="A5.T10.2.11.9.1.1" style="background-color:#D9D9D9;">     <span class="ltx_text ltx_font_italic" id="A5.T10.2.11.9.1.1.1">w/ caption-aware</span> IT</span></th>
<td class="ltx_td ltx_align_center" id="A5.T10.2.11.9.2" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text" id="A5.T10.2.11.9.2.1" style="background-color:#D9D9D9;">83.04</span></td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.11.9.3" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text ltx_font_bold" id="A5.T10.2.11.9.3.1" style="background-color:#D9D9D9;">95.34</span></td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.11.9.4" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text" id="A5.T10.2.11.9.4.1" style="background-color:#D9D9D9;">96.34</span></td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.11.9.5" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text" id="A5.T10.2.11.9.5.1" style="background-color:#D9D9D9;">74.64</span></td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.11.9.6" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text" id="A5.T10.2.11.9.6.1" style="background-color:#D9D9D9;">93.16</span></td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.11.9.7" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text" id="A5.T10.2.11.9.7.1" style="background-color:#D9D9D9;">95.62</span></td>
</tr>
<tr class="ltx_tr" id="A5.T10.2.12.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A5.T10.2.12.10.1" style="padding-left:12.8pt;padding-right:12.8pt;">mPLUG-Owl2</th>
<td class="ltx_td ltx_align_center" id="A5.T10.2.12.10.2" style="padding-left:12.8pt;padding-right:12.8pt;">76.16</td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.12.10.3" style="padding-left:12.8pt;padding-right:12.8pt;">94.12</td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.12.10.4" style="padding-left:12.8pt;padding-right:12.8pt;">95.98</td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.12.10.5" style="padding-left:12.8pt;padding-right:12.8pt;">65.44</td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.12.10.6" style="padding-left:12.8pt;padding-right:12.8pt;">90.34</td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.12.10.7" style="padding-left:12.8pt;padding-right:12.8pt;">95.38</td>
</tr>
<tr class="ltx_tr" id="A5.T10.2.13.11" style="background-color:#D9D9D9;">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A5.T10.2.13.11.1" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text" id="A5.T10.2.13.11.1.1" style="background-color:#D9D9D9;">     <span class="ltx_text ltx_font_italic" id="A5.T10.2.13.11.1.1.1">w/ caption-aware</span> IT</span></th>
<td class="ltx_td ltx_align_center" id="A5.T10.2.13.11.2" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text" id="A5.T10.2.13.11.2.1" style="background-color:#D9D9D9;">81.38</span></td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.13.11.3" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text" id="A5.T10.2.13.11.3.1" style="background-color:#D9D9D9;">94.70</span></td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.13.11.4" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text" id="A5.T10.2.13.11.4.1" style="background-color:#D9D9D9;">96.08</span></td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.13.11.5" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text" id="A5.T10.2.13.11.5.1" style="background-color:#D9D9D9;">69.96</span></td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.13.11.6" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text" id="A5.T10.2.13.11.6.1" style="background-color:#D9D9D9;">91.30</span></td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.13.11.7" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text" id="A5.T10.2.13.11.7.1" style="background-color:#D9D9D9;">95.36</span></td>
</tr>
<tr class="ltx_tr" id="A5.T10.2.14.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A5.T10.2.14.12.1" style="padding-left:12.8pt;padding-right:12.8pt;">Qwen-VL-Chat</th>
<td class="ltx_td ltx_align_center" id="A5.T10.2.14.12.2" style="padding-left:12.8pt;padding-right:12.8pt;">82.70</td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.14.12.3" style="padding-left:12.8pt;padding-right:12.8pt;">94.80</td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.14.12.4" style="padding-left:12.8pt;padding-right:12.8pt;">96.26</td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.14.12.5" style="padding-left:12.8pt;padding-right:12.8pt;">74.40</td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.14.12.6" style="padding-left:12.8pt;padding-right:12.8pt;">92.72</td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.14.12.7" style="padding-left:12.8pt;padding-right:12.8pt;">95.98</td>
</tr>
<tr class="ltx_tr" id="A5.T10.2.15.13" style="background-color:#D9D9D9;">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A5.T10.2.15.13.1" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text" id="A5.T10.2.15.13.1.1" style="background-color:#D9D9D9;">     <span class="ltx_text ltx_font_italic" id="A5.T10.2.15.13.1.1.1">w/ caption-aware</span> IT</span></th>
<td class="ltx_td ltx_align_center" id="A5.T10.2.15.13.2" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text ltx_font_bold" id="A5.T10.2.15.13.2.1" style="background-color:#D9D9D9;">84.40</span></td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.15.13.3" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text" id="A5.T10.2.15.13.3.1" style="background-color:#D9D9D9;">95.18</span></td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.15.13.4" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text" id="A5.T10.2.15.13.4.1" style="background-color:#D9D9D9;">96.30</span></td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.15.13.5" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text ltx_font_bold" id="A5.T10.2.15.13.5.1" style="background-color:#D9D9D9;">76.62</span></td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.15.13.6" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text ltx_font_bold" id="A5.T10.2.15.13.6.1" style="background-color:#D9D9D9;">93.56</span></td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.15.13.7" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text ltx_font_bold" id="A5.T10.2.15.13.7.1" style="background-color:#D9D9D9;">96.26</span></td>
</tr>
<tr class="ltx_tr" id="A5.T10.2.16.14">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A5.T10.2.16.14.1" style="padding-left:12.8pt;padding-right:12.8pt;">InternVL2-1B</th>
<td class="ltx_td ltx_align_center" id="A5.T10.2.16.14.2" style="padding-left:12.8pt;padding-right:12.8pt;">67.74</td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.16.14.3" style="padding-left:12.8pt;padding-right:12.8pt;">92.56</td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.16.14.4" style="padding-left:12.8pt;padding-right:12.8pt;">96.04</td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.16.14.5" style="padding-left:12.8pt;padding-right:12.8pt;">55.76</td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.16.14.6" style="padding-left:12.8pt;padding-right:12.8pt;">87.14</td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.16.14.7" style="padding-left:12.8pt;padding-right:12.8pt;">94.02</td>
</tr>
<tr class="ltx_tr" id="A5.T10.2.17.15" style="background-color:#D9D9D9;">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A5.T10.2.17.15.1" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text" id="A5.T10.2.17.15.1.1" style="background-color:#D9D9D9;">     <span class="ltx_text ltx_font_italic" id="A5.T10.2.17.15.1.1.1">w/ caption-aware</span> IT</span></th>
<td class="ltx_td ltx_align_center" id="A5.T10.2.17.15.2" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text" id="A5.T10.2.17.15.2.1" style="background-color:#D9D9D9;">83.02</span></td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.17.15.3" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text" id="A5.T10.2.17.15.3.1" style="background-color:#D9D9D9;">95.12</span></td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.17.15.4" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text ltx_font_bold" id="A5.T10.2.17.15.4.1" style="background-color:#D9D9D9;">96.38</span></td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.17.15.5" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text" id="A5.T10.2.17.15.5.1" style="background-color:#D9D9D9;">74.24</span></td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.17.15.6" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text" id="A5.T10.2.17.15.6.1" style="background-color:#D9D9D9;">92.78</span></td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.17.15.7" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text" id="A5.T10.2.17.15.7.1" style="background-color:#D9D9D9;">96.02</span></td>
</tr>
<tr class="ltx_tr" id="A5.T10.2.18.16">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A5.T10.2.18.16.1" style="padding-left:12.8pt;padding-right:12.8pt;">InternVL2-2B</th>
<td class="ltx_td ltx_align_center" id="A5.T10.2.18.16.2" style="padding-left:12.8pt;padding-right:12.8pt;">67.74</td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.18.16.3" style="padding-left:12.8pt;padding-right:12.8pt;">92.56</td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.18.16.4" style="padding-left:12.8pt;padding-right:12.8pt;">96.04</td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.18.16.5" style="padding-left:12.8pt;padding-right:12.8pt;">71.32</td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.18.16.6" style="padding-left:12.8pt;padding-right:12.8pt;">92.06</td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.18.16.7" style="padding-left:12.8pt;padding-right:12.8pt;">95.82</td>
</tr>
<tr class="ltx_tr" id="A5.T10.2.19.17" style="background-color:#D9D9D9;">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A5.T10.2.19.17.1" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text" id="A5.T10.2.19.17.1.1" style="background-color:#D9D9D9;">     <span class="ltx_text ltx_font_italic" id="A5.T10.2.19.17.1.1.1">w/ caption-aware</span> IT</span></th>
<td class="ltx_td ltx_align_center" id="A5.T10.2.19.17.2" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text" id="A5.T10.2.19.17.2.1" style="background-color:#D9D9D9;">83.78</span></td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.19.17.3" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text" id="A5.T10.2.19.17.3.1" style="background-color:#D9D9D9;">95.14</span></td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.19.17.4" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text" id="A5.T10.2.19.17.4.1" style="background-color:#D9D9D9;">96.32</span></td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.19.17.5" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text" id="A5.T10.2.19.17.5.1" style="background-color:#D9D9D9;">75.86</span></td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.19.17.6" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text" id="A5.T10.2.19.17.6.1" style="background-color:#D9D9D9;">93.40</span></td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.19.17.7" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text" id="A5.T10.2.19.17.7.1" style="background-color:#D9D9D9;">96.10</span></td>
</tr>
<tr class="ltx_tr" id="A5.T10.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="7" id="A5.T10.2.2.1" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text ltx_font_italic" id="A5.T10.2.2.1.1">Reranking Top-<math alttext="K" class="ltx_Math" display="inline" id="A5.T10.2.2.1.1.m1.1"><semantics id="A5.T10.2.2.1.1.m1.1a"><mi id="A5.T10.2.2.1.1.m1.1.1" xref="A5.T10.2.2.1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A5.T10.2.2.1.1.m1.1b"><ci id="A5.T10.2.2.1.1.m1.1.1.cmml" xref="A5.T10.2.2.1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.T10.2.2.1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="A5.T10.2.2.1.1.m1.1d">italic_K</annotation></semantics></math> from Different Retrievers</span></th>
</tr>
<tr class="ltx_tr" id="A5.T10.2.20.18">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A5.T10.2.20.18.1" style="padding-left:12.8pt;padding-right:12.8pt;">LLaVA-v1.5-13B</th>
<td class="ltx_td ltx_border_t" id="A5.T10.2.20.18.2" style="padding-left:12.8pt;padding-right:12.8pt;"></td>
<td class="ltx_td ltx_border_t" id="A5.T10.2.20.18.3" style="padding-left:12.8pt;padding-right:12.8pt;"></td>
<td class="ltx_td ltx_border_t" id="A5.T10.2.20.18.4" style="padding-left:12.8pt;padding-right:12.8pt;"></td>
<td class="ltx_td ltx_border_t" id="A5.T10.2.20.18.5" style="padding-left:12.8pt;padding-right:12.8pt;"></td>
<td class="ltx_td ltx_border_t" id="A5.T10.2.20.18.6" style="padding-left:12.8pt;padding-right:12.8pt;"></td>
<td class="ltx_td ltx_border_t" id="A5.T10.2.20.18.7" style="padding-left:12.8pt;padding-right:12.8pt;"></td>
</tr>
<tr class="ltx_tr" id="A5.T10.2.21.19">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A5.T10.2.21.19.1" style="padding-left:12.8pt;padding-right:12.8pt;">     <span class="ltx_text ltx_font_italic" id="A5.T10.2.21.19.1.1">w/ Vis-BGE-base</span>
</th>
<td class="ltx_td ltx_align_center" id="A5.T10.2.21.19.2" style="padding-left:12.8pt;padding-right:12.8pt;">80.76</td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.21.19.3" style="padding-left:12.8pt;padding-right:12.8pt;">92.56</td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.21.19.4" style="padding-left:12.8pt;padding-right:12.8pt;">93.44</td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.21.19.5" style="padding-left:12.8pt;padding-right:12.8pt;">74.12</td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.21.19.6" style="padding-left:12.8pt;padding-right:12.8pt;">92.36</td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.21.19.7" style="padding-left:12.8pt;padding-right:12.8pt;">95.02</td>
</tr>
<tr class="ltx_tr" id="A5.T10.2.22.20">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A5.T10.2.22.20.1" style="padding-left:12.8pt;padding-right:12.8pt;">     <span class="ltx_text ltx_font_italic" id="A5.T10.2.22.20.1.1">w/ Vis-BGE-m3</span>
</th>
<td class="ltx_td ltx_align_center" id="A5.T10.2.22.20.2" style="padding-left:12.8pt;padding-right:12.8pt;">79.64</td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.22.20.3" style="padding-left:12.8pt;padding-right:12.8pt;">90.46</td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.22.20.4" style="padding-left:12.8pt;padding-right:12.8pt;">91.34</td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.22.20.5" style="padding-left:12.8pt;padding-right:12.8pt;">71.94</td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.22.20.6" style="padding-left:12.8pt;padding-right:12.8pt;">88.96</td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.22.20.7" style="padding-left:12.8pt;padding-right:12.8pt;">91.18</td>
</tr>
<tr class="ltx_tr" id="A5.T10.2.23.21">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A5.T10.2.23.21.1" style="padding-left:12.8pt;padding-right:12.8pt;">     <span class="ltx_text ltx_font_italic" id="A5.T10.2.23.21.1.1">w/ InternVL-C</span>
</th>
<td class="ltx_td ltx_align_center" id="A5.T10.2.23.21.2" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text ltx_font_bold" id="A5.T10.2.23.21.2.1">83.56</span></td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.23.21.3" style="padding-left:12.8pt;padding-right:12.8pt;">97.12</td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.23.21.4" style="padding-left:12.8pt;padding-right:12.8pt;">98.58</td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.23.21.5" style="padding-left:12.8pt;padding-right:12.8pt;">75.00</td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.23.21.6" style="padding-left:12.8pt;padding-right:12.8pt;">94.26</td>
<td class="ltx_td ltx_align_center" id="A5.T10.2.23.21.7" style="padding-left:12.8pt;padding-right:12.8pt;">97.36</td>
</tr>
<tr class="ltx_tr" id="A5.T10.2.24.22">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="A5.T10.2.24.22.1" style="padding-left:12.8pt;padding-right:12.8pt;">     <span class="ltx_text ltx_font_italic" id="A5.T10.2.24.22.1.1">w/ InternVL-G</span>
</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A5.T10.2.24.22.2" style="padding-left:12.8pt;padding-right:12.8pt;">83.26</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A5.T10.2.24.22.3" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text ltx_font_bold" id="A5.T10.2.24.22.3.1">97.16</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A5.T10.2.24.22.4" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text ltx_font_bold" id="A5.T10.2.24.22.4.1">98.80</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A5.T10.2.24.22.5" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text ltx_font_bold" id="A5.T10.2.24.22.5.1">75.06</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A5.T10.2.24.22.6" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text ltx_font_bold" id="A5.T10.2.24.22.6.1">94.36</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A5.T10.2.24.22.7" style="padding-left:12.8pt;padding-right:12.8pt;"><span class="ltx_text ltx_font_bold" id="A5.T10.2.24.22.7.1">97.60</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_appendix" id="A6">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix F </span>More Evaluations on LLaVA-v1.5-13B</h2>
<section class="ltx_paragraph" id="A6.SS0.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Low-resource Settings on WebQA</h4>
<figure class="ltx_figure ltx_align_floatright" id="A6.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="216" id="A6.F6.g1" src="x17.png" width="381"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Retrieval performance on WebQA with LLaVA-v1.5-13B under low-resource settings.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="A6.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="A6.SS0.SSS0.Px1.p1.1">As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#A6.F6" title="Figure 6 ‣ Low-resource Settings on WebQA ‣ Appendix F More Evaluations on LLaVA-v1.5-13B ‣ MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_tag">6</span></a>, the experiments with LLaVA-v1.5-13B under low-resource settings also verified the robustness of our proposed method in reranker training. With only 2.5% of the original data, the reranker significantly surpasses the original baseline, InternVL-G, in R@2 and almost reaches the performance peak. This inspires us to further explore the performance of low-resource instruction fine-tuning for models with different parameter sizes in future work, aiming to enhance the generalizability and efficiency of MLLMs in instruction fine-tuning and downstream task deployment.</p>
</div>
<figure class="ltx_figure" id="A6.F7">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F7.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="564" id="A6.F7.sf1.g1" src="x18.png" width="761"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(a) </span>Train set</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F7.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="564" id="A6.F7.sf2.g1" src="x19.png" width="761"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(b) </span>Validation set</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A6.F7.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="564" id="A6.F7.sf3.g1" src="x20.png" width="761"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(c) </span>Test set</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Density distribution of the relevance probability of correct and incorrect recalls on WebQA after reranking from the LLaVA-v1.5-13B reranker.</figcaption>
</figure>
<figure class="ltx_table" id="A6.T11">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 11: </span>Performance of LLaVA-v1.5-13B reranker on two benchmark datasets. <span class="ltx_text ltx_font_italic" id="A6.T11.7.1">P</span> and <span class="ltx_text ltx_font_italic" id="A6.T11.8.2">R</span> denote precision and recall, respectively. The best scores in each setting are in <span class="ltx_text ltx_font_bold" id="A6.T11.9.3">bold</span>.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A6.T11.3">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A6.T11.3.4.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A6.T11.3.4.1.1" rowspan="2" style="padding-left:11.4pt;padding-right:11.4pt;"><span class="ltx_text" id="A6.T11.3.4.1.1.1">Methods</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3" id="A6.T11.3.4.1.2" style="padding-left:11.4pt;padding-right:11.4pt;">MultimodalQA</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3" id="A6.T11.3.4.1.3" style="padding-left:11.4pt;padding-right:11.4pt;">WebQA</th>
</tr>
<tr class="ltx_tr" id="A6.T11.3.5.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A6.T11.3.5.2.1" style="padding-left:11.4pt;padding-right:11.4pt;">P</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A6.T11.3.5.2.2" style="padding-left:11.4pt;padding-right:11.4pt;">R</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A6.T11.3.5.2.3" style="padding-left:11.4pt;padding-right:11.4pt;">F1</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A6.T11.3.5.2.4" style="padding-left:11.4pt;padding-right:11.4pt;">P</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A6.T11.3.5.2.5" style="padding-left:11.4pt;padding-right:11.4pt;">R</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A6.T11.3.5.2.6" style="padding-left:11.4pt;padding-right:11.4pt;">F1</th>
</tr>
<tr class="ltx_tr" id="A6.T11.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t" id="A6.T11.1.1.1" style="padding-left:11.4pt;padding-right:11.4pt;">CLIP Top-<math alttext="N" class="ltx_Math" display="inline" id="A6.T11.1.1.1.m1.1"><semantics id="A6.T11.1.1.1.m1.1a"><mi id="A6.T11.1.1.1.m1.1.1" xref="A6.T11.1.1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="A6.T11.1.1.1.m1.1b"><ci id="A6.T11.1.1.1.m1.1.1.cmml" xref="A6.T11.1.1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.T11.1.1.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="A6.T11.1.1.1.m1.1d">italic_N</annotation></semantics></math>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A6.T11.1.1.2" style="padding-left:11.4pt;padding-right:11.4pt;">84.78</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A6.T11.1.1.3" style="padding-left:11.4pt;padding-right:11.4pt;">84.78</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A6.T11.1.1.4" style="padding-left:11.4pt;padding-right:11.4pt;">84.78</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A6.T11.1.1.5" style="padding-left:11.4pt;padding-right:11.4pt;">41.24</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A6.T11.1.1.6" style="padding-left:11.4pt;padding-right:11.4pt;">57.10</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A6.T11.1.1.7" style="padding-left:11.4pt;padding-right:11.4pt;">47.89</th>
</tr>
<tr class="ltx_tr" id="A6.T11.3.6.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_t" colspan="7" id="A6.T11.3.6.3.1" style="padding-left:11.4pt;padding-right:11.4pt;"><span class="ltx_text ltx_font_italic" id="A6.T11.3.6.3.1.1">Blended Instruction Tuning</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A6.T11.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A6.T11.2.2.1" style="padding-left:11.4pt;padding-right:11.4pt;">CLIP Top-<math alttext="K" class="ltx_Math" display="inline" id="A6.T11.2.2.1.m1.1"><semantics id="A6.T11.2.2.1.m1.1a"><mi id="A6.T11.2.2.1.m1.1.1" xref="A6.T11.2.2.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A6.T11.2.2.1.m1.1b"><ci id="A6.T11.2.2.1.m1.1.1.cmml" xref="A6.T11.2.2.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.T11.2.2.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="A6.T11.2.2.1.m1.1d">italic_K</annotation></semantics></math> + Reranker</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T11.2.2.2" style="padding-left:11.4pt;padding-right:11.4pt;">98.26</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T11.2.2.3" style="padding-left:11.4pt;padding-right:11.4pt;"><span class="ltx_text ltx_font_bold" id="A6.T11.2.2.3.1">98.26</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T11.2.2.4" style="padding-left:11.4pt;padding-right:11.4pt;">98.26</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T11.2.2.5" style="padding-left:11.4pt;padding-right:11.4pt;">57.05</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T11.2.2.6" style="padding-left:11.4pt;padding-right:11.4pt;"><span class="ltx_text ltx_font_bold" id="A6.T11.2.2.6.1">78.99</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T11.2.2.7" style="padding-left:11.4pt;padding-right:11.4pt;">66.25</td>
</tr>
<tr class="ltx_tr" id="A6.T11.3.7.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A6.T11.3.7.1.1" style="padding-left:11.4pt;padding-right:11.4pt;">     <span class="ltx_text ltx_font_italic" id="A6.T11.3.7.1.1.1">w/</span> Natural Threshold</th>
<td class="ltx_td ltx_align_center" id="A6.T11.3.7.1.2" style="padding-left:11.4pt;padding-right:11.4pt;"><span class="ltx_text ltx_font_bold" id="A6.T11.3.7.1.2.1">100.00</span></td>
<td class="ltx_td ltx_align_center" id="A6.T11.3.7.1.3" style="padding-left:11.4pt;padding-right:11.4pt;">97.39</td>
<td class="ltx_td ltx_align_center" id="A6.T11.3.7.1.4" style="padding-left:11.4pt;padding-right:11.4pt;"><span class="ltx_text ltx_font_bold" id="A6.T11.3.7.1.4.1">98.68</span></td>
<td class="ltx_td ltx_align_center" id="A6.T11.3.7.1.5" style="padding-left:11.4pt;padding-right:11.4pt;">67.94</td>
<td class="ltx_td ltx_align_center" id="A6.T11.3.7.1.6" style="padding-left:11.4pt;padding-right:11.4pt;">78.00</td>
<td class="ltx_td ltx_align_center" id="A6.T11.3.7.1.7" style="padding-left:11.4pt;padding-right:11.4pt;"><span class="ltx_text ltx_font_bold" id="A6.T11.3.7.1.7.1">72.62</span></td>
</tr>
<tr class="ltx_tr" id="A6.T11.3.8.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A6.T11.3.8.2.1" style="padding-left:11.4pt;padding-right:11.4pt;">     <span class="ltx_text ltx_font_italic" id="A6.T11.3.8.2.1.1">w/</span> Adaptive Threshold</th>
<td class="ltx_td ltx_align_center" id="A6.T11.3.8.2.2" style="padding-left:11.4pt;padding-right:11.4pt;"><span class="ltx_text ltx_font_bold" id="A6.T11.3.8.2.2.1">100.00</span></td>
<td class="ltx_td ltx_align_center" id="A6.T11.3.8.2.3" style="padding-left:11.4pt;padding-right:11.4pt;">97.39</td>
<td class="ltx_td ltx_align_center" id="A6.T11.3.8.2.4" style="padding-left:11.4pt;padding-right:11.4pt;"><span class="ltx_text ltx_font_bold" id="A6.T11.3.8.2.4.1">98.68</span></td>
<td class="ltx_td ltx_align_center" id="A6.T11.3.8.2.5" style="padding-left:11.4pt;padding-right:11.4pt;"><span class="ltx_text ltx_font_bold" id="A6.T11.3.8.2.5.1">84.13</span></td>
<td class="ltx_td ltx_align_center" id="A6.T11.3.8.2.6" style="padding-left:11.4pt;padding-right:11.4pt;">62.70</td>
<td class="ltx_td ltx_align_center" id="A6.T11.3.8.2.7" style="padding-left:11.4pt;padding-right:11.4pt;">71.85</td>
</tr>
<tr class="ltx_tr" id="A6.T11.3.9.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="7" id="A6.T11.3.9.3.1" style="padding-left:11.4pt;padding-right:11.4pt;"><span class="ltx_text ltx_font_italic" id="A6.T11.3.9.3.1.1">Ranking-only Instruction Tuning</span></th>
</tr>
<tr class="ltx_tr" id="A6.T11.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A6.T11.3.3.1" style="padding-left:11.4pt;padding-right:11.4pt;">CLIP Top-<math alttext="K" class="ltx_Math" display="inline" id="A6.T11.3.3.1.m1.1"><semantics id="A6.T11.3.3.1.m1.1a"><mi id="A6.T11.3.3.1.m1.1.1" xref="A6.T11.3.3.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A6.T11.3.3.1.m1.1b"><ci id="A6.T11.3.3.1.m1.1.1.cmml" xref="A6.T11.3.3.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.T11.3.3.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="A6.T11.3.3.1.m1.1d">italic_K</annotation></semantics></math> + Reranker</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T11.3.3.2" style="padding-left:11.4pt;padding-right:11.4pt;">98.26</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T11.3.3.3" style="padding-left:11.4pt;padding-right:11.4pt;"><span class="ltx_text ltx_font_bold" id="A6.T11.3.3.3.1">98.26</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T11.3.3.4" style="padding-left:11.4pt;padding-right:11.4pt;">98.26</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T11.3.3.5" style="padding-left:11.4pt;padding-right:11.4pt;">57.59</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T11.3.3.6" style="padding-left:11.4pt;padding-right:11.4pt;"><span class="ltx_text ltx_font_bold" id="A6.T11.3.3.6.1">79.74</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T11.3.3.7" style="padding-left:11.4pt;padding-right:11.4pt;">66.87</td>
</tr>
<tr class="ltx_tr" id="A6.T11.3.10.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A6.T11.3.10.4.1" style="padding-left:11.4pt;padding-right:11.4pt;">     <span class="ltx_text ltx_font_italic" id="A6.T11.3.10.4.1.1">w/</span> Natural Threshold</th>
<td class="ltx_td ltx_align_center" id="A6.T11.3.10.4.2" style="padding-left:11.4pt;padding-right:11.4pt;"><span class="ltx_text ltx_font_bold" id="A6.T11.3.10.4.2.1">100.00</span></td>
<td class="ltx_td ltx_align_center" id="A6.T11.3.10.4.3" style="padding-left:11.4pt;padding-right:11.4pt;">97.83</td>
<td class="ltx_td ltx_align_center" id="A6.T11.3.10.4.4" style="padding-left:11.4pt;padding-right:11.4pt;"><span class="ltx_text ltx_font_bold" id="A6.T11.3.10.4.4.1">98.90</span></td>
<td class="ltx_td ltx_align_center" id="A6.T11.3.10.4.5" style="padding-left:11.4pt;padding-right:11.4pt;">68.31</td>
<td class="ltx_td ltx_align_center" id="A6.T11.3.10.4.6" style="padding-left:11.4pt;padding-right:11.4pt;">78.52</td>
<td class="ltx_td ltx_align_center" id="A6.T11.3.10.4.7" style="padding-left:11.4pt;padding-right:11.4pt;">73.06</td>
</tr>
<tr class="ltx_tr" id="A6.T11.3.11.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="A6.T11.3.11.5.1" style="padding-left:11.4pt;padding-right:11.4pt;">     <span class="ltx_text ltx_font_italic" id="A6.T11.3.11.5.1.1">w/</span> Adaptive Threshold</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T11.3.11.5.2" style="padding-left:11.4pt;padding-right:11.4pt;"><span class="ltx_text ltx_font_bold" id="A6.T11.3.11.5.2.1">100.00</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T11.3.11.5.3" style="padding-left:11.4pt;padding-right:11.4pt;">97.83</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T11.3.11.5.4" style="padding-left:11.4pt;padding-right:11.4pt;"><span class="ltx_text ltx_font_bold" id="A6.T11.3.11.5.4.1">98.90</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T11.3.11.5.5" style="padding-left:11.4pt;padding-right:11.4pt;"><span class="ltx_text ltx_font_bold" id="A6.T11.3.11.5.5.1">80.38</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T11.3.11.5.6" style="padding-left:11.4pt;padding-right:11.4pt;">68.35</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T11.3.11.5.7" style="padding-left:11.4pt;padding-right:11.4pt;"><span class="ltx_text ltx_font_bold" id="A6.T11.3.11.5.7.1">73.88</span></td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_table" id="A6.T12">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 12: </span>Ablation study on WebQA with LLaVA-v1.5-13B. <span class="ltx_text ltx_font_italic" id="A6.T12.4.1">NLC</span> and <span class="ltx_text ltx_font_italic" id="A6.T12.5.2">ND</span> refer to Noise-injected Logits Contrasting and Noise-injected Data, respectively.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A6.T12.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A6.T12.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A6.T12.1.2.1.1" rowspan="2" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text" id="A6.T12.1.2.1.1.1">Methods</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3" id="A6.T12.1.2.1.2" style="padding-left:4.3pt;padding-right:4.3pt;">WebQA</th>
</tr>
<tr class="ltx_tr" id="A6.T12.1.3.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A6.T12.1.3.2.1" style="padding-left:4.3pt;padding-right:4.3pt;">Single.</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A6.T12.1.3.2.2" style="padding-left:4.3pt;padding-right:4.3pt;">Multi.</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A6.T12.1.3.2.3" style="padding-left:4.3pt;padding-right:4.3pt;">Overall</th>
</tr>
<tr class="ltx_tr" id="A6.T12.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t" id="A6.T12.1.1.1" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text ltx_font_bold" id="A6.T12.1.1.1.1">RagVL (<math alttext="\eta=0.5" class="ltx_Math" display="inline" id="A6.T12.1.1.1.1.m1.1"><semantics id="A6.T12.1.1.1.1.m1.1a"><mrow id="A6.T12.1.1.1.1.m1.1.1" xref="A6.T12.1.1.1.1.m1.1.1.cmml"><mi id="A6.T12.1.1.1.1.m1.1.1.2" xref="A6.T12.1.1.1.1.m1.1.1.2.cmml">η</mi><mo id="A6.T12.1.1.1.1.m1.1.1.1" xref="A6.T12.1.1.1.1.m1.1.1.1.cmml">=</mo><mn id="A6.T12.1.1.1.1.m1.1.1.3" xref="A6.T12.1.1.1.1.m1.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="A6.T12.1.1.1.1.m1.1b"><apply id="A6.T12.1.1.1.1.m1.1.1.cmml" xref="A6.T12.1.1.1.1.m1.1.1"><eq id="A6.T12.1.1.1.1.m1.1.1.1.cmml" xref="A6.T12.1.1.1.1.m1.1.1.1"></eq><ci id="A6.T12.1.1.1.1.m1.1.1.2.cmml" xref="A6.T12.1.1.1.1.m1.1.1.2">𝜂</ci><cn id="A6.T12.1.1.1.1.m1.1.1.3.cmml" type="float" xref="A6.T12.1.1.1.1.m1.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.T12.1.1.1.1.m1.1c">\eta=0.5</annotation><annotation encoding="application/x-llamapun" id="A6.T12.1.1.1.1.m1.1d">italic_η = 0.5</annotation></semantics></math>)</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A6.T12.1.1.2" style="padding-left:4.3pt;padding-right:4.3pt;">60.86</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A6.T12.1.1.3" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text ltx_font_bold" id="A6.T12.1.1.3.1">76.83</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A6.T12.1.1.4" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text ltx_font_bold" id="A6.T12.1.1.4.1">67.95</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A6.T12.1.4.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A6.T12.1.4.1.1" style="padding-left:4.3pt;padding-right:4.3pt;">
<span class="ltx_text ltx_font_italic" id="A6.T12.1.4.1.1.1">w/o</span> Reranker</th>
<td class="ltx_td ltx_align_center" id="A6.T12.1.4.1.2" style="padding-left:4.3pt;padding-right:4.3pt;">58.67</td>
<td class="ltx_td ltx_align_center" id="A6.T12.1.4.1.3" style="padding-left:4.3pt;padding-right:4.3pt;">75.66</td>
<td class="ltx_td ltx_align_center" id="A6.T12.1.4.1.4" style="padding-left:4.3pt;padding-right:4.3pt;">66.22</td>
</tr>
<tr class="ltx_tr" id="A6.T12.1.5.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A6.T12.1.5.2.1" style="padding-left:4.3pt;padding-right:4.3pt;">
<span class="ltx_text ltx_font_italic" id="A6.T12.1.5.2.1.1">w/o</span> ND</th>
<td class="ltx_td ltx_align_center" id="A6.T12.1.5.2.2" style="padding-left:4.3pt;padding-right:4.3pt;"><span class="ltx_text ltx_font_bold" id="A6.T12.1.5.2.2.1">61.67</span></td>
<td class="ltx_td ltx_align_center" id="A6.T12.1.5.2.3" style="padding-left:4.3pt;padding-right:4.3pt;">75.19</td>
<td class="ltx_td ltx_align_center" id="A6.T12.1.5.2.4" style="padding-left:4.3pt;padding-right:4.3pt;">67.68</td>
</tr>
<tr class="ltx_tr" id="A6.T12.1.6.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A6.T12.1.6.3.1" style="padding-left:4.3pt;padding-right:4.3pt;">
<span class="ltx_text ltx_font_italic" id="A6.T12.1.6.3.1.1">w/o</span> NLC</th>
<td class="ltx_td ltx_align_center" id="A6.T12.1.6.3.2" style="padding-left:4.3pt;padding-right:4.3pt;">60.08</td>
<td class="ltx_td ltx_align_center" id="A6.T12.1.6.3.3" style="padding-left:4.3pt;padding-right:4.3pt;">76.24</td>
<td class="ltx_td ltx_align_center" id="A6.T12.1.6.3.4" style="padding-left:4.3pt;padding-right:4.3pt;">67.26</td>
</tr>
<tr class="ltx_tr" id="A6.T12.1.7.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A6.T12.1.7.4.1" style="padding-left:4.3pt;padding-right:4.3pt;">
<span class="ltx_text ltx_font_italic" id="A6.T12.1.7.4.1.1">w/o</span> ND &amp; NLC</th>
<td class="ltx_td ltx_align_center" id="A6.T12.1.7.4.2" style="padding-left:4.3pt;padding-right:4.3pt;">60.68</td>
<td class="ltx_td ltx_align_center" id="A6.T12.1.7.4.3" style="padding-left:4.3pt;padding-right:4.3pt;">74.92</td>
<td class="ltx_td ltx_align_center" id="A6.T12.1.7.4.4" style="padding-left:4.3pt;padding-right:4.3pt;">67.01</td>
</tr>
<tr class="ltx_tr" id="A6.T12.1.8.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="A6.T12.1.8.5.1" style="padding-left:4.3pt;padding-right:4.3pt;">
<span class="ltx_text ltx_font_italic" id="A6.T12.1.8.5.1.1">w/</span> Blended Reranker</th>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="A6.T12.1.8.5.2" style="padding-left:4.3pt;padding-right:4.3pt;">58.15</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="A6.T12.1.8.5.3" style="padding-left:4.3pt;padding-right:4.3pt;">74.97</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="A6.T12.1.8.5.4" style="padding-left:4.3pt;padding-right:4.3pt;">65.63</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_paragraph" id="A6.SS0.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Reranking Performance with Thresholds</h4>
<div class="ltx_para ltx_noindent" id="A6.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="A6.SS0.SSS0.Px2.p1.1">Similarly, we train LLaVA-v1.5-13B as the reranker using only 20% of the data. As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#A6.F7" title="Figure 7 ‣ Low-resource Settings on WebQA ‣ Appendix F More Evaluations on LLaVA-v1.5-13B ‣ MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_tag">7</span></a>, the relevance probabilities of correct recalls are concentrated in the highest range. The adaptive threshold is high enough to filter out most of the incorrect candidates.</p>
</div>
<div class="ltx_para ltx_noindent" id="A6.SS0.SSS0.Px2.p2">
<p class="ltx_p" id="A6.SS0.SSS0.Px2.p2.5">As shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#A6.T11" title="Table 11 ‣ Low-resource Settings on WebQA ‣ Appendix F More Evaluations on LLaVA-v1.5-13B ‣ MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_tag">11</span></a>, our proposed knowledge-enhanced reranking method demonstrates superior performances. We train the reranker under two settings: (i)Blended training of ranking and QA tasks. (ii) Training exclusively with the ranking task. Whether training with the blended or separate setting, our approach achieves better performance across all metrics than directly using CLIP for top-<math alttext="N" class="ltx_Math" display="inline" id="A6.SS0.SSS0.Px2.p2.1.m1.1"><semantics id="A6.SS0.SSS0.Px2.p2.1.m1.1a"><mi id="A6.SS0.SSS0.Px2.p2.1.m1.1.1" xref="A6.SS0.SSS0.Px2.p2.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="A6.SS0.SSS0.Px2.p2.1.m1.1b"><ci id="A6.SS0.SSS0.Px2.p2.1.m1.1.1.cmml" xref="A6.SS0.SSS0.Px2.p2.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.SS0.SSS0.Px2.p2.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="A6.SS0.SSS0.Px2.p2.1.m1.1d">italic_N</annotation></semantics></math> retrieval. When the adaptive threshold <math alttext="\eta" class="ltx_Math" display="inline" id="A6.SS0.SSS0.Px2.p2.2.m2.1"><semantics id="A6.SS0.SSS0.Px2.p2.2.m2.1a"><mi id="A6.SS0.SSS0.Px2.p2.2.m2.1.1" xref="A6.SS0.SSS0.Px2.p2.2.m2.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="A6.SS0.SSS0.Px2.p2.2.m2.1b"><ci id="A6.SS0.SSS0.Px2.p2.2.m2.1.1.cmml" xref="A6.SS0.SSS0.Px2.p2.2.m2.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.SS0.SSS0.Px2.p2.2.m2.1c">\eta</annotation><annotation encoding="application/x-llamapun" id="A6.SS0.SSS0.Px2.p2.2.m2.1d">italic_η</annotation></semantics></math> is activated, the model accurately filters out irrelevant images, resulting in improved <span class="ltx_text ltx_font_italic" id="A6.SS0.SSS0.Px2.p2.5.1">accuracy</span> and <span class="ltx_text ltx_font_italic" id="A6.SS0.SSS0.Px2.p2.5.2">F1</span> score. Specifically, in WebQA, when <math alttext="\eta" class="ltx_Math" display="inline" id="A6.SS0.SSS0.Px2.p2.3.m3.1"><semantics id="A6.SS0.SSS0.Px2.p2.3.m3.1a"><mi id="A6.SS0.SSS0.Px2.p2.3.m3.1.1" xref="A6.SS0.SSS0.Px2.p2.3.m3.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="A6.SS0.SSS0.Px2.p2.3.m3.1b"><ci id="A6.SS0.SSS0.Px2.p2.3.m3.1.1.cmml" xref="A6.SS0.SSS0.Px2.p2.3.m3.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.SS0.SSS0.Px2.p2.3.m3.1c">\eta</annotation><annotation encoding="application/x-llamapun" id="A6.SS0.SSS0.Px2.p2.3.m3.1d">italic_η</annotation></semantics></math> is set to an intuitively reasonable value of 0.5, the corresponding F1 score increases by 25.17% after training on the ranking-only task. In MultimodalQA, the reranker successfully identifies all ground truth images from the retrieved top-<math alttext="K" class="ltx_Math" display="inline" id="A6.SS0.SSS0.Px2.p2.4.m4.1"><semantics id="A6.SS0.SSS0.Px2.p2.4.m4.1a"><mi id="A6.SS0.SSS0.Px2.p2.4.m4.1.1" xref="A6.SS0.SSS0.Px2.p2.4.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A6.SS0.SSS0.Px2.p2.4.m4.1b"><ci id="A6.SS0.SSS0.Px2.p2.4.m4.1.1.cmml" xref="A6.SS0.SSS0.Px2.p2.4.m4.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.SS0.SSS0.Px2.p2.4.m4.1c">K</annotation><annotation encoding="application/x-llamapun" id="A6.SS0.SSS0.Px2.p2.4.m4.1d">italic_K</annotation></semantics></math> candidates when <math alttext="\eta" class="ltx_Math" display="inline" id="A6.SS0.SSS0.Px2.p2.5.m5.1"><semantics id="A6.SS0.SSS0.Px2.p2.5.m5.1a"><mi id="A6.SS0.SSS0.Px2.p2.5.m5.1.1" xref="A6.SS0.SSS0.Px2.p2.5.m5.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="A6.SS0.SSS0.Px2.p2.5.m5.1b"><ci id="A6.SS0.SSS0.Px2.p2.5.m5.1.1.cmml" xref="A6.SS0.SSS0.Px2.p2.5.m5.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.SS0.SSS0.Px2.p2.5.m5.1c">\eta</annotation><annotation encoding="application/x-llamapun" id="A6.SS0.SSS0.Px2.p2.5.m5.1d">italic_η</annotation></semantics></math> is set to 0.5, proving the strong capability of our proposed method in retrieval reranking.</p>
</div>
<div class="ltx_para ltx_noindent" id="A6.SS0.SSS0.Px2.p3">
<p class="ltx_p" id="A6.SS0.SSS0.Px2.p3.1">For “<span class="ltx_text ltx_font_italic" id="A6.SS0.SSS0.Px2.p3.1.1">w/ Blended Reranker</span>”, we utilize the blended reranker for both reranking and generation, which is trained with noise-injected data and vanilla MLE loss. Though we directly mix the ranking and QA datasets due to a lack of sufficient datasets, the blended reranker still performs competitively. Since training the blended reranker requires precise adjustments <cite class="ltx_cite ltx_citemacro_citep">(Yu et al., <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#bib.bib48" title="">2024</a>)</cite> to the composition of the training datasets to achieve better results, the results show a promising direction for future research (unifying reranker and generator), which further demonstrates the generalizability and superiority of our proposed method.</p>
</div>
</section>
<section class="ltx_paragraph" id="A6.SS0.SSS0.Px3">
<h4 class="ltx_title ltx_title_paragraph">Results of Retrieval-augmented Generation</h4>
<div class="ltx_para ltx_noindent" id="A6.SS0.SSS0.Px3.p1">
<p class="ltx_p" id="A6.SS0.SSS0.Px3.p1.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#A6.T13" title="Table 13 ‣ Results of Retrieval-augmented Generation ‣ Appendix F More Evaluations on LLaVA-v1.5-13B ‣ MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_tag">13</span></a> displays the results of LLaVA-v1.5-13B on MultimodalQA and WebQA. Our proposed approach still outperforms baselines on all configurations. Due to a larger amount of parameters, LLaVA-v1.5-13B outperforms InternVL2-1/2B in answer generation. What’s more, the adaptive threshold works better on LLaVA-v1.5-13B because the relevance probabilities of correct recalls are more focused in the high range. Therefore, our proposed method is also applicable to models with larger parameters.</p>
</div>
<figure class="ltx_table" id="A6.T13">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 13: </span>Performance of multimodal question answering on two benchmark datasets requiring image retrieval. In addition to the overall results, we report the accuracy of single-image and multi-image input with <span class="ltx_text ltx_font_italic" id="A6.T13.7.1">Single.</span> and <span class="ltx_text ltx_font_italic" id="A6.T13.8.2">Multi.</span> for WebQA, respectively. <span class="ltx_text ltx_font_italic" id="A6.T13.9.3">Oracle</span> refers to directly feeding the ground truth image to the generator. The best scores in each training setting are in <span class="ltx_text ltx_font_bold" id="A6.T13.10.4">bold</span>.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A6.T13.2">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A6.T13.2.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="A6.T13.2.3.1.1" rowspan="2" style="padding-left:14.2pt;padding-right:14.2pt;"><span class="ltx_text" id="A6.T13.2.3.1.1.1">Methods</span></th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A6.T13.2.3.1.2" style="padding-left:14.2pt;padding-right:14.2pt;">MultimodalQA</td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="3" id="A6.T13.2.3.1.3" style="padding-left:14.2pt;padding-right:14.2pt;">WebQA</td>
</tr>
<tr class="ltx_tr" id="A6.T13.2.4.2">
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T13.2.4.2.1" style="padding-left:14.2pt;padding-right:14.2pt;">EM</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T13.2.4.2.2" style="padding-left:14.2pt;padding-right:14.2pt;">Single.</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T13.2.4.2.3" style="padding-left:14.2pt;padding-right:14.2pt;">Multi.</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T13.2.4.2.4" style="padding-left:14.2pt;padding-right:14.2pt;">Overall</td>
</tr>
<tr class="ltx_tr" id="A6.T13.2.5.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="5" id="A6.T13.2.5.3.1" style="padding-left:14.2pt;padding-right:14.2pt;"><span class="ltx_text ltx_font_italic" id="A6.T13.2.5.3.1.1">w/o Retrieval-augmented Generation</span></th>
</tr>
<tr class="ltx_tr" id="A6.T13.2.6.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A6.T13.2.6.4.1" style="padding-left:14.2pt;padding-right:14.2pt;">Vicuna-v1.5-13B</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T13.2.6.4.2" style="padding-left:14.2pt;padding-right:14.2pt;">8.26</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T13.2.6.4.3" style="padding-left:14.2pt;padding-right:14.2pt;">32.43</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T13.2.6.4.4" style="padding-left:14.2pt;padding-right:14.2pt;">42.82</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T13.2.6.4.5" style="padding-left:14.2pt;padding-right:14.2pt;">37.05</td>
</tr>
<tr class="ltx_tr" id="A6.T13.2.7.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A6.T13.2.7.5.1" style="padding-left:14.2pt;padding-right:14.2pt;">Llama-2-13b-chat-hf</th>
<td class="ltx_td ltx_align_center" id="A6.T13.2.7.5.2" style="padding-left:14.2pt;padding-right:14.2pt;">0.43</td>
<td class="ltx_td ltx_align_center" id="A6.T13.2.7.5.3" style="padding-left:14.2pt;padding-right:14.2pt;">16.23</td>
<td class="ltx_td ltx_align_center" id="A6.T13.2.7.5.4" style="padding-left:14.2pt;padding-right:14.2pt;">21.27</td>
<td class="ltx_td ltx_align_center" id="A6.T13.2.7.5.5" style="padding-left:14.2pt;padding-right:14.2pt;">18.47</td>
</tr>
<tr class="ltx_tr" id="A6.T13.2.8.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A6.T13.2.8.6.1" style="padding-left:14.2pt;padding-right:14.2pt;">LLaVA-v1.5-13B</th>
<td class="ltx_td ltx_align_center" id="A6.T13.2.8.6.2" style="padding-left:14.2pt;padding-right:14.2pt;">42.61</td>
<td class="ltx_td ltx_align_center" id="A6.T13.2.8.6.3" style="padding-left:14.2pt;padding-right:14.2pt;">31.92</td>
<td class="ltx_td ltx_align_center" id="A6.T13.2.8.6.4" style="padding-left:14.2pt;padding-right:14.2pt;">50.37</td>
<td class="ltx_td ltx_align_center" id="A6.T13.2.8.6.5" style="padding-left:14.2pt;padding-right:14.2pt;">40.12</td>
</tr>
<tr class="ltx_tr" id="A6.T13.2.9.7">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="5" id="A6.T13.2.9.7.1" style="padding-left:14.2pt;padding-right:14.2pt;"><span class="ltx_text ltx_font_italic" id="A6.T13.2.9.7.1.1">LLaVA-v1.5-13B w/ Retrieval-augmented Generation</span></th>
</tr>
<tr class="ltx_tr" id="A6.T13.2.10.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A6.T13.2.10.8.1" style="padding-left:14.2pt;padding-right:14.2pt;">LLaVA-v1.5-13B</th>
<td class="ltx_td ltx_border_t" id="A6.T13.2.10.8.2" style="padding-left:14.2pt;padding-right:14.2pt;"></td>
<td class="ltx_td ltx_border_t" id="A6.T13.2.10.8.3" style="padding-left:14.2pt;padding-right:14.2pt;"></td>
<td class="ltx_td ltx_border_t" id="A6.T13.2.10.8.4" style="padding-left:14.2pt;padding-right:14.2pt;"></td>
<td class="ltx_td ltx_border_t" id="A6.T13.2.10.8.5" style="padding-left:14.2pt;padding-right:14.2pt;"></td>
</tr>
<tr class="ltx_tr" id="A6.T13.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A6.T13.1.1.1" style="padding-left:14.2pt;padding-right:14.2pt;">      <span class="ltx_text ltx_font_italic" id="A6.T13.1.1.1.1">w/</span> CLIP Top-<math alttext="N" class="ltx_Math" display="inline" id="A6.T13.1.1.1.m1.1"><semantics id="A6.T13.1.1.1.m1.1a"><mi id="A6.T13.1.1.1.m1.1.1" xref="A6.T13.1.1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="A6.T13.1.1.1.m1.1b"><ci id="A6.T13.1.1.1.m1.1.1.cmml" xref="A6.T13.1.1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.T13.1.1.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="A6.T13.1.1.1.m1.1d">italic_N</annotation></semantics></math>
</th>
<td class="ltx_td ltx_align_center" id="A6.T13.1.1.2" style="padding-left:14.2pt;padding-right:14.2pt;">75.65</td>
<td class="ltx_td ltx_align_center" id="A6.T13.1.1.3" style="padding-left:14.2pt;padding-right:14.2pt;">41.29</td>
<td class="ltx_td ltx_align_center" id="A6.T13.1.1.4" style="padding-left:14.2pt;padding-right:14.2pt;">47.54</td>
<td class="ltx_td ltx_align_center" id="A6.T13.1.1.5" style="padding-left:14.2pt;padding-right:14.2pt;">44.07</td>
</tr>
<tr class="ltx_tr" id="A6.T13.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A6.T13.2.2.1" style="padding-left:14.2pt;padding-right:14.2pt;">      <span class="ltx_text ltx_font_italic" id="A6.T13.2.2.1.1">w/</span> InternVL-G Top-<math alttext="N" class="ltx_Math" display="inline" id="A6.T13.2.2.1.m1.1"><semantics id="A6.T13.2.2.1.m1.1a"><mi id="A6.T13.2.2.1.m1.1.1" xref="A6.T13.2.2.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="A6.T13.2.2.1.m1.1b"><ci id="A6.T13.2.2.1.m1.1.1.cmml" xref="A6.T13.2.2.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.T13.2.2.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="A6.T13.2.2.1.m1.1d">italic_N</annotation></semantics></math>
</th>
<td class="ltx_td ltx_align_center" id="A6.T13.2.2.2" style="padding-left:14.2pt;padding-right:14.2pt;">75.22</td>
<td class="ltx_td ltx_align_center" id="A6.T13.2.2.3" style="padding-left:14.2pt;padding-right:14.2pt;">42.37</td>
<td class="ltx_td ltx_align_center" id="A6.T13.2.2.4" style="padding-left:14.2pt;padding-right:14.2pt;">47.71</td>
<td class="ltx_td ltx_align_center" id="A6.T13.2.2.5" style="padding-left:14.2pt;padding-right:14.2pt;">44.74</td>
</tr>
<tr class="ltx_tr" id="A6.T13.2.11.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A6.T13.2.11.9.1" style="padding-left:14.2pt;padding-right:14.2pt;">
<span class="ltx_text ltx_font_bold" id="A6.T13.2.11.9.1.1">RagVL</span> <span class="ltx_text ltx_font_italic" id="A6.T13.2.11.9.1.2">w/o NIT</span>
</th>
<td class="ltx_td ltx_align_center" id="A6.T13.2.11.9.2" style="padding-left:14.2pt;padding-right:14.2pt;">78.70</td>
<td class="ltx_td ltx_align_center" id="A6.T13.2.11.9.3" style="padding-left:14.2pt;padding-right:14.2pt;">41.03</td>
<td class="ltx_td ltx_align_center" id="A6.T13.2.11.9.4" style="padding-left:14.2pt;padding-right:14.2pt;">48.09</td>
<td class="ltx_td ltx_align_center" id="A6.T13.2.11.9.5" style="padding-left:14.2pt;padding-right:14.2pt;">44.17</td>
</tr>
<tr class="ltx_tr" id="A6.T13.2.12.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A6.T13.2.12.10.1" style="padding-left:14.2pt;padding-right:14.2pt;">      <span class="ltx_text ltx_font_italic" id="A6.T13.2.12.10.1.1">w/</span> Natural Threshold</th>
<td class="ltx_td ltx_align_center" id="A6.T13.2.12.10.2" style="padding-left:14.2pt;padding-right:14.2pt;">79.57</td>
<td class="ltx_td ltx_align_center" id="A6.T13.2.12.10.3" style="padding-left:14.2pt;padding-right:14.2pt;">44.50</td>
<td class="ltx_td ltx_align_center" id="A6.T13.2.12.10.4" style="padding-left:14.2pt;padding-right:14.2pt;">48.47</td>
<td class="ltx_td ltx_align_center" id="A6.T13.2.12.10.5" style="padding-left:14.2pt;padding-right:14.2pt;">46.26</td>
</tr>
<tr class="ltx_tr" id="A6.T13.2.13.11">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A6.T13.2.13.11.1" style="padding-left:14.2pt;padding-right:14.2pt;">      <span class="ltx_text ltx_font_italic" id="A6.T13.2.13.11.1.1">w/</span> Adaptive Threshold</th>
<td class="ltx_td ltx_align_center" id="A6.T13.2.13.11.2" style="padding-left:14.2pt;padding-right:14.2pt;">79.57</td>
<td class="ltx_td ltx_align_center" id="A6.T13.2.13.11.3" style="padding-left:14.2pt;padding-right:14.2pt;">44.05</td>
<td class="ltx_td ltx_align_center" id="A6.T13.2.13.11.4" style="padding-left:14.2pt;padding-right:14.2pt;">49.00</td>
<td class="ltx_td ltx_align_center" id="A6.T13.2.13.11.5" style="padding-left:14.2pt;padding-right:14.2pt;">46.25</td>
</tr>
<tr class="ltx_tr" id="A6.T13.2.14.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A6.T13.2.14.12.1" style="padding-left:14.2pt;padding-right:14.2pt;">
<span class="ltx_text ltx_font_bold" id="A6.T13.2.14.12.1.1">RagVL</span> <span class="ltx_text ltx_font_italic" id="A6.T13.2.14.12.1.2">w/ NIT</span>
</th>
<td class="ltx_td ltx_align_center" id="A6.T13.2.14.12.2" style="padding-left:14.2pt;padding-right:14.2pt;">78.70</td>
<td class="ltx_td ltx_align_center" id="A6.T13.2.14.12.3" style="padding-left:14.2pt;padding-right:14.2pt;">57.06</td>
<td class="ltx_td ltx_align_center" id="A6.T13.2.14.12.4" style="padding-left:14.2pt;padding-right:14.2pt;">76.18</td>
<td class="ltx_td ltx_align_center" id="A6.T13.2.14.12.5" style="padding-left:14.2pt;padding-right:14.2pt;">65.56</td>
</tr>
<tr class="ltx_tr" id="A6.T13.2.15.13">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A6.T13.2.15.13.1" style="padding-left:14.2pt;padding-right:14.2pt;">      <span class="ltx_text ltx_font_italic" id="A6.T13.2.15.13.1.1">w/</span> Natural Threshold</th>
<td class="ltx_td ltx_align_center" id="A6.T13.2.15.13.2" style="padding-left:14.2pt;padding-right:14.2pt;"><span class="ltx_text ltx_font_bold" id="A6.T13.2.15.13.2.1">79.57</span></td>
<td class="ltx_td ltx_align_center" id="A6.T13.2.15.13.3" style="padding-left:14.2pt;padding-right:14.2pt;">60.86</td>
<td class="ltx_td ltx_align_center" id="A6.T13.2.15.13.4" style="padding-left:14.2pt;padding-right:14.2pt;">76.83</td>
<td class="ltx_td ltx_align_center" id="A6.T13.2.15.13.5" style="padding-left:14.2pt;padding-right:14.2pt;">67.95</td>
</tr>
<tr class="ltx_tr" id="A6.T13.2.16.14">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A6.T13.2.16.14.1" style="padding-left:14.2pt;padding-right:14.2pt;">      <span class="ltx_text ltx_font_italic" id="A6.T13.2.16.14.1.1">w/</span> Adaptive Threshold</th>
<td class="ltx_td ltx_align_center" id="A6.T13.2.16.14.2" style="padding-left:14.2pt;padding-right:14.2pt;"><span class="ltx_text ltx_font_bold" id="A6.T13.2.16.14.2.1">79.57</span></td>
<td class="ltx_td ltx_align_center" id="A6.T13.2.16.14.3" style="padding-left:14.2pt;padding-right:14.2pt;"><span class="ltx_text ltx_font_bold" id="A6.T13.2.16.14.3.1">61.76</span></td>
<td class="ltx_td ltx_align_center" id="A6.T13.2.16.14.4" style="padding-left:14.2pt;padding-right:14.2pt;"><span class="ltx_text ltx_font_bold" id="A6.T13.2.16.14.4.1">76.90</span></td>
<td class="ltx_td ltx_align_center" id="A6.T13.2.16.14.5" style="padding-left:14.2pt;padding-right:14.2pt;"><span class="ltx_text ltx_font_bold" id="A6.T13.2.16.14.5.1">68.49</span></td>
</tr>
<tr class="ltx_tr" id="A6.T13.2.17.15">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="A6.T13.2.17.15.1" style="padding-left:14.2pt;padding-right:14.2pt;">Oracle</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T13.2.17.15.2" style="padding-left:14.2pt;padding-right:14.2pt;">79.13</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T13.2.17.15.3" style="padding-left:14.2pt;padding-right:14.2pt;">65.51</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T13.2.17.15.4" style="padding-left:14.2pt;padding-right:14.2pt;">77.04</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T13.2.17.15.5" style="padding-left:14.2pt;padding-right:14.2pt;">70.63</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_paragraph" id="A6.SS0.SSS0.Px4">
<h4 class="ltx_title ltx_title_paragraph">Ablation Studies</h4>
<div class="ltx_para ltx_noindent" id="A6.SS0.SSS0.Px4.p1">
<p class="ltx_p" id="A6.SS0.SSS0.Px4.p1.1">As shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2407.21439v2#A6.T12" title="Table 12 ‣ Low-resource Settings on WebQA ‣ Appendix F More Evaluations on LLaVA-v1.5-13B ‣ MLLM Is a Strong Reranker: Advancing Multimodal Retrieval-augmented Generation via Knowledge-enhanced Reranking and Noise-injected Training"><span class="ltx_text ltx_ref_tag">12</span></a>, we ablate the proposed approaches on WebQA with LLaVA-v1.5-13B. Similar to the results from InternVL2-2B, the benefits from reranking and noise injection are still significant. Specially, to explore the possibility of unifying reranker and generator, we utilize the blended reranker for both retrieval and generation. The results are very promising, and there is still significant room for optimization.</p>
</div>
</section>
</section>
<section class="ltx_appendix" id="A7">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix G </span>More Case Studies</h2>
<div class="ltx_para ltx_noindent" id="A7.p1">
<p class="ltx_p" id="A7.p1.1">In this section, we provide more attention heatmap visualization of cases requiring single image or multiple images for inferencing.</p>
</div>
<figure class="ltx_figure" id="A7.F8">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_bottom" id="A7.F8.3" style="width:397.5pt;">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="148" id="A7.F8.1.g1" src="x21.png" width="228"/></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="148" id="A7.F8.2.g2" src="x22.png" width="228"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="148" id="A7.F8.3.g3" src="x23.png" width="228"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(d) </span>“Are <span class="ltx_text" id="A7.F8.3.3.1" style="color:#B10404;">the homes at the Main Shopping Street in Enniskillen</span> or <span class="ltx_text" id="A7.F8.3.4.2" style="color:#B10404;">the church behind it</span> taller?”</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_bottom" id="A7.F8.6" style="width:397.5pt;">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="171" id="A7.F8.4.g1" src="x24.png" width="228"/></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="171" id="A7.F8.5.g2" src="x25.png" width="228"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="171" id="A7.F8.6.g3" src="x26.png" width="228"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(e) </span>“What color is <span class="ltx_text" id="A7.F8.6.2.1" style="color:#B10404;">the facade of bakery</span> Sattin et Fils in Rethel, France?”</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_bottom" id="A7.F8.9" style="width:397.5pt;">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="171" id="A7.F8.7.g1" src="x27.png" width="228"/></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="171" id="A7.F8.8.g2" src="x28.png" width="228"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="171" id="A7.F8.9.g3" src="x29.png" width="228"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(f) </span>“What text is on <span class="ltx_text" id="A7.F8.9.2.1" style="color:#B10404;">the signage in front of the Rijksmuseum?</span>”</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_bottom" id="A7.F8.12" style="width:397.5pt;">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_portrait" height="439" id="A7.F8.10.g1" src="x30.png" width="228"/></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_portrait" height="439" id="A7.F8.11.g2" src="x31.png" width="228"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_portrait" height="439" id="A7.F8.12.g3" src="x32.png" width="228"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(g) </span>“What color is <span class="ltx_text" id="A7.F8.12.2.1" style="color:#B10404;">the logo on China Merchants Bank Tower?</span>”</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>More single-image cases on WebQA.</figcaption>
</figure>
<figure class="ltx_figure" id="A7.F9">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_bottom" id="A7.F9.6" style="width:397.5pt;">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_portrait" height="343" id="A7.F9.1.g1" src="x33.png" width="228"/></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_portrait" height="343" id="A7.F9.2.g2" src="x34.png" width="228"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_portrait" height="343" id="A7.F9.3.g3" src="x35.png" width="228"/></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_portrait" height="305" id="A7.F9.4.g4" src="x36.png" width="229"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_portrait" height="305" id="A7.F9.5.g5" src="x37.png" width="229"/></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_portrait" height="305" id="A7.F9.6.g6" src="x38.png" width="229"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(a) </span>“Which <span class="ltx_text" id="A7.F9.6.3.1" style="color:#B10404;">guitar</span> looks more like a tool that <span class="ltx_text" id="A7.F9.6.4.2" style="color:#B10404;">might cut a tree</span>; Gene Simmons’ Guitar or Gibson L-3 archtop guitar?”</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_bottom" id="A7.F9.12" style="width:397.5pt;">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_figure_panel ltx_img_landscape" height="171" id="A7.F9.7.g1" src="x39.png" width="228"/></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="171" id="A7.F9.8.g2" src="x40.png" width="228"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="171" id="A7.F9.9.g3" src="x41.png" width="228"/></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="152" id="A7.F9.10.g4" src="x42.png" width="228"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="152" id="A7.F9.11.g5" src="x43.png" width="228"/></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="152" id="A7.F9.12.g6" src="x44.png" width="228"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(b) </span>“Are the colors of the word <span class="ltx_text" id="A7.F9.12.2.1" style="color:#B10404;">lyric</span> different in the Lyric Theater, Blacksburg and Lyric Theater, Georgia signs?”</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>More multi-image cases on WebQA.</figcaption>
</figure>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Wed Sep 25 06:11:40 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
