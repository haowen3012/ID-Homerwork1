<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Retrieval Augmented Generation for Dynamic Graph Modeling</title>
<!--Generated on Mon Aug 26 09:19:39 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2408.14523v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#S1" title="In Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#S2" title="In Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#S2.SS0.SSS0.Px1" title="In 2 Related Work ‣ Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_title">Dynamic Graph Modeling.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#S2.SS0.SSS0.Px2" title="In 2 Related Work ‣ Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_title">Retrieval Augmented Generation.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#S3" title="In Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Preliminaries</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#S3.SS0.SSS0.Px1" title="In 3 Preliminaries ‣ Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_title">Sequence Mapping of Dynamic Graphs.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#S3.SS0.SSS0.Px2" title="In 3 Preliminaries ‣ Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_title">Problem Formulation.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#S4" title="In Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Proposed Model: RAG4DyG</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#S4.SS1" title="In 4 Proposed Model: RAG4DyG ‣ Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Time- and Context-Aware Retriever</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#S4.SS1.SSS0.Px1" title="In 4.1 Time- and Context-Aware Retriever ‣ 4 Proposed Model: RAG4DyG ‣ Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_title">Retrieval Annotation.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#S4.SS1.SSS0.Px2" title="In 4.1 Time- and Context-Aware Retriever ‣ 4 Proposed Model: RAG4DyG ‣ Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_title">Time-aware Contrastive Learning.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection">
<a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#S4.SS1.SSSx1" title="In 4.1 Time- and Context-Aware Retriever ‣ 4 Proposed Model: RAG4DyG ‣ Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_title">Context-aware Contrastive Learning.</span></a>
<ol class="ltx_toclist ltx_toclist_subsubsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#S4.SS1.SSSx1.Px1" title="In Context-aware Contrastive Learning. ‣ 4.1 Time- and Context-Aware Retriever ‣ 4 Proposed Model: RAG4DyG ‣ Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_title">Training and Inference for Retrieval.</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#S4.SS2" title="In 4 Proposed Model: RAG4DyG ‣ Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Graph Fusion-based Generator</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection">
<a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#S4.SS2.SSSx1" title="In 4.2 Graph Fusion-based Generator ‣ 4 Proposed Model: RAG4DyG ‣ Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_title">Graph Fusion.</span></a>
<ol class="ltx_toclist ltx_toclist_subsubsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#S4.SS2.SSSx1.Px1" title="In Graph Fusion. ‣ 4.2 Graph Fusion-based Generator ‣ 4 Proposed Model: RAG4DyG ‣ Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_title">Training and inference.</span></a></li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#S5" title="In Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Experiment</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#S5.SS1" title="In 5 Experiment ‣ Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Experimental Setup</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#S5.SS1.SSSx1" title="In 5.1 Experimental Setup ‣ 5 Experiment ‣ Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_title">Datasets.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#S5.SS1.SSSx2" title="In 5.1 Experimental Setup ‣ 5 Experiment ‣ Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_title">Baselines.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#S5.SS1.SSSx3" title="In 5.1 Experimental Setup ‣ 5 Experiment ‣ Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_title">Implementation Details.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#S5.SS1.SSSx4" title="In 5.1 Experimental Setup ‣ 5 Experiment ‣ Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_title">Evaluation Metrics.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#S5.SS2" title="In 5 Experiment ‣ Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Performance Comparison</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#S5.SS3" title="In 5 Experiment ‣ Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3 </span>Model Analysis</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#S5.SS3.SSSx1" title="In 5.3 Model Analysis ‣ 5 Experiment ‣ Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_title">Ablation Study.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#S5.SS3.SSSx2" title="In 5.3 Model Analysis ‣ 5 Experiment ‣ Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_title">Effect of Different Retrieval Methods.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#S5.SS3.SSSx3" title="In 5.3 Model Analysis ‣ 5 Experiment ‣ Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_title">Effect of the Number of Demonstrations <span class="ltx_text ltx_font_italic">K</span>.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#S5.SS3.SSSx4" title="In 5.3 Model Analysis ‣ 5 Experiment ‣ Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_title">Effect of Different Fusion Strategies.</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#S6" title="In Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#A1" title="In Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Retrieval Data Annotation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#A2" title="In Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>More Details about Baselines</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#A3" title="In Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C </span>More Experimental Results</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#A4" title="In Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D </span>Hyper-parameter Settings</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Retrieval Augmented Generation for Dynamic Graph Modeling</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Yuxia Wu,
Yuan Fang,
Lizi Liao
</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id1.id1">Dynamic graph modeling is crucial for analyzing evolving patterns in various applications. Existing approaches often integrate graph neural networks with temporal modules or redefine dynamic graph modeling as a generative sequence task. However, these methods typically rely on isolated historical contexts of the target nodes from a narrow perspective, neglecting occurrences of similar patterns or relevant cases associated with other nodes. In this work, we introduce the Retrieval-Augmented Generation for Dynamic Graph Modeling (RAG4DyG) framework, which leverages guidance from contextually and temporally analogous examples to broaden the perspective of each node. This approach presents two critical challenges: (1) How to identify and retrieve high-quality demonstrations that are contextually and temporally analogous to dynamic graph samples? (2) How can these demonstrations be effectively integrated to improve dynamic graph modeling? To address these challenges, we propose RAG4DyG, which enriches the understanding of historical contexts by retrieving and learning from contextually and temporally pertinent demonstrations. Specifically, we employ a time- and context-aware contrastive learning module to identify and retrieve relevant cases for each query sequence. Moreover, we design a graph fusion strategy to integrate the retrieved cases, thereby augmenting the inherent historical contexts for improved prediction. Extensive experiments on real-world datasets across different domains demonstrate the effectiveness of RAG4DyG for dynamic graph modeling.
</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<figure class="ltx_figure" id="S1.F1">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S1.F1.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="122" id="S1.F1.sf1.g1" src="x1.png" width="305"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(a) </span>RAG in NLP</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S1.F1.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="145" id="S1.F1.sf2.g1" src="x2.png" width="342"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(b) </span>RAG in dynamic graphs</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Illustration of RAG in NLP and dynamic graph modeling. (a) In NLP, RAG leverages pre-trained language models to encode text and retrieve semantically similar or related demonstrations, which are further concatenated to enhance the generation task. (b) Our work addresses the challenges of complex temporal and structural characteristics of dynamic graphs, incorporating RAG through time- and context-aware retrieval and graph fusion modules.</figcaption>
</figure>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Dynamic graphs, which track the temporal evolution of nodes and edges, are essential for analyzing complex systems across domains like social networks, citation networks etc. Existing methods for dynamic graph modeling fall into two main categories: discrete-time and continuous-time approaches <cite class="ltx_cite ltx_citemacro_citep">(Feng et al. <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib7" title="">2024</a>)</cite>. Discrete-time methods divide the timeline into intervals, capturing the graph’s state at each point <cite class="ltx_cite ltx_citemacro_citep">(Sankar et al. <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib24" title="">2020</a>)</cite>, but they lack temporal granularity by overlooking event dynamics within intervals. Continuous-time approaches, on the other hand, model temporal dynamics continuously, without discretization, allowing for more detailed representations <cite class="ltx_cite ltx_citemacro_citep">(Trivedi et al. <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib25" title="">2019</a>; Xu et al. <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib31" title="">2020</a>; Wen and Fang <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib28" title="">2022</a>)</cite>. Our work aligns with continuous-time approaches, aiming to capture fine-grained time steps for more accurate dynamic graph modeling.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Traditional approaches for dynamic graph modeling predominantly rely on integrating graph neural networks (GNNs) with specialized temporal modules,
such as recurrent neural networks <cite class="ltx_cite ltx_citemacro_citep">(Pareja et al. <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib22" title="">2020</a>)</cite>, self-attention <cite class="ltx_cite ltx_citemacro_citep">(Sankar et al. <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib24" title="">2020</a>)</cite> and temporal point processes <cite class="ltx_cite ltx_citemacro_citep">(Wen and Fang <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib28" title="">2022</a>)</cite>, which update the graph representations over time. Although powerful, these methods suffer from the inherent limitations of GNNs, such as difficulty with long-term dependencies, and over-smoothing or over-squashing issues <cite class="ltx_cite ltx_citemacro_citep">(Chen et al. <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib2" title="">2020</a>; Alon and Yahav <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib1" title="">2020</a>)</cite>. Recently, a simple and effective approach called SimpleDyG <cite class="ltx_cite ltx_citemacro_citep">(Wu, Fang, and Liao <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib29" title="">2024</a>)</cite> redefines dynamic graph modeling as a generative sequence
modeling task and leverages the strengths of sequence models like Transformers to capture long-range dependencies within temporal sequences effectively.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Despite significant advancements in dynamic graph modeling, current approaches heavily depend on isolated historical contexts of the target nodes, limiting each node’s perspective to its ego network. The limited context makes it difficult to quickly adapt to diverse emerging patterns. For example, in a social network, when users transit to new behavioral patterns or when new users with minimal historical interactions are introduced, traditional models that focus on the historical contexts of individual nodes might not respond effectively to these changes. To overcome these limitations, we draw inspiration from the Retrieval-Augmented Generation (RAG) technique originated from the Natural Language Processing (NLP) field <cite class="ltx_cite ltx_citemacro_citep">(Gao et al. <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib8" title="">2023</a>)</cite>. As shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#S1.F1.sf1" title="In Figure 1 ‣ 1 Introduction ‣ Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_tag">1(a)</span></a>, RAG broadens the context through the retrieval of additional demonstrations, achieving considerable success in NLP. In this work, we aim to integrate RAG into dynamic graph modeling to incorporate a broader and more relevant contextual understanding beyond the historical interactions of individual nodes. However, leveraging RAG for dynamic graph modeling presents two critical challenges.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">First, <span class="ltx_text ltx_font_italic" id="S1.p4.1.1">how do we harvest high-quality demonstrations for dynamic graphs?</span>
This involves selecting the most contextually and temporally relevant samples to enrich the current state of a target node. Unlike RAG for NLP, where external textual data and a pre-trained language model (LM) naturally support demonstration retrieval as shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#S1.F1.sf1" title="In Figure 1 ‣ 1 Introduction ‣ Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_tag">1(a)</span></a>, dynamic graph modeling requires careful consideration of the data sources and the ability to handle complex structural and temporal patterns as shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#S1.F1.sf2" title="In Figure 1 ‣ 1 Introduction ‣ Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_tag">1(b)</span></a>. To address this, we introduce a novel time-aware contrastive learning strategy that leverages internal training data for demonstration retrieval.
Following SimpleDyG <cite class="ltx_cite ltx_citemacro_citep">(Wu, Fang, and Liao <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib29" title="">2024</a>)</cite>, we regard dynamic graph modeling as a sequence modeling task and the prediction of future events as a sequence generation problem. Hence, we define a <em class="ltx_emph ltx_font_italic" id="S1.p4.1.2">query sequence</em> for a target node as its historical interaction sequence. Next, we automatically annotate the retrieval training pool by assessing the similarity to the query. Given the training pool, our model consists of two contrastive modules: time-aware and context-aware contrastive learning. The former utilizes a time decay function to prioritize samples that are temporally close to the query, while the latter incorporates data augmentation techniques such as masking and cropping to improve the model’s ability to retrieve complex structural patterns.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">Second, <span class="ltx_text ltx_font_italic" id="S1.p5.1.1">how do we effectively integrate the retrieved demonstrations into the dynamic graph model?</span> This involves fusing the retrieved demonstrations to enrich the historical context of each target node and enhance subsequent predictions. Directly concatenating the retrieved demonstrations with the query sequence not only results in a lengthy sequence unsuited for generative predictions but also overlooks the structural patterns among the retrieved demonstrations. To address this, we propose graph fusion, leveraging the graph structures inherent to the demonstrations and fusing them into a summary graph, as shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#S1.F1.sf2" title="In Figure 1 ‣ 1 Introduction ‣ Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_tag">1(b)</span></a>. We then apply a GNN-based readout to learn the representation of the fused summary graph, which is prepended to the query sequence before being fed into the sequence generation model.</p>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">Our contributions can be summarized as follows.
(1) We propose a novel Retrieval-Augmented Generation approach for Dynamic Graph modeling named RAG4DyG. It employs a retriever to broaden the historical interactions with contextually and temporally relevant demonstrations, leading to enhanced generative predictions on dynamic graphs.
(2) We propose a time-aware contrastive learning module that incorporates temporal and structural information for demonstration retrieval. Additionally, we design a graph fusion module to effectively integrate the retrieved demonstrations, leveraging structural enhancements for subsequent predictions. (3) We conduct extensive experiments to validate our approach, demonstrating the effectiveness of RAG4DyG in various domains.</p>
</div>
<figure class="ltx_figure" id="S1.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="302" id="S1.F2.g1" src="x3.png" width="682"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Overall framework of RAG4DyG. (a) Sequence modeling for dynamic graphs. (b) The retriever finds top-<span class="ltx_text ltx_font_italic" id="S1.F2.2.1">K</span> temporally and contextually relevant demonstrations. (c) Graph fusion integrates the retrieved demonstrations for subsequent generation.</figcaption>
</figure>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Dynamic Graph Modeling.</h5>
<div class="ltx_para" id="S2.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px1.p1.1">Existing approaches for dynamic graphs can be categorized into discrete-time and continuous-time methods. Discrete-time methods regard a dynamic graph as a sequence of static graph snapshots captured at various time steps. Each snapshot represents the graph structure at a specific time step. These methods typically adopt GNNs to model the structural information of each snapshot, and then incorporate a sequence model <cite class="ltx_cite ltx_citemacro_citep">(Pareja et al. <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib22" title="">2020</a>; Sankar et al. <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib24" title="">2020</a>)</cite> to capture the changes across snapshots. However, these approaches neglect fine-grained time information within a snapshot. In contrast, continuous-time methods model graph evolution as a continuous process, capturing all time steps for more precise temporal modeling.
These methods often integrate GNNs with specially designed temporal modules, such as temporal random walk <cite class="ltx_cite ltx_citemacro_citep">(Wang et al. <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib27" title="">2021</a>)</cite>, temporal graph attention <cite class="ltx_cite ltx_citemacro_citep">(Xu et al. <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib31" title="">2020</a>; Rossi et al. <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib23" title="">2020</a>)</cite>, MLP-mixer <cite class="ltx_cite ltx_citemacro_citep">(Cong et al. <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib3" title="">2022</a>)</cite> and temporal point processes <cite class="ltx_cite ltx_citemacro_citep">(Trivedi et al. <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib25" title="">2019</a>; Ji et al. <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib12" title="">2021</a>; Wen and Fang <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib28" title="">2022</a>)</cite>. Recently, researchers have proposed a simple and effective architecture called SimpleDyG <cite class="ltx_cite ltx_citemacro_citep">(Wu, Fang, and Liao <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib29" title="">2024</a>)</cite>, which reformulates the dynamic graph modeling as a sequence modeling task. Specifically, it maps the dynamic graph into a series of node sequences and feeds them into a generative sequence model. Subsequently, predicting future events can be framed as a sequence generation problem.</p>
</div>
</section>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Retrieval Augmented Generation.</h5>
<div class="ltx_para" id="S2.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px2.p1.1">Recently, the RAG paradigm has attracted increasing attention <cite class="ltx_cite ltx_citemacro_citep">(Gao et al. <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib8" title="">2023</a>)</cite>. Specifically, RAG first leverages the retriever to search and extract relevant documents from some databases, which then serve as additional context to enhance the generation process. Related studies have demonstrated the great potential of RAG in various tasks such as language processing <cite class="ltx_cite ltx_citemacro_citep">(Karpukhin et al. <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib14" title="">2020</a>; Jiang et al. <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib13" title="">2023</a>)</cite>, recommendation systems <cite class="ltx_cite ltx_citemacro_citep">(Ye et al. <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib32" title="">2022</a>; Dao et al. <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib4" title="">2024</a>)</cite>, and computer vision <cite class="ltx_cite ltx_citemacro_citep">(Liu et al. <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib19" title="">2023</a>; Kim et al. <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib15" title="">2024</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S2.SS0.SSS0.Px2.p2">
<p class="ltx_p" id="S2.SS0.SSS0.Px2.p2.1">In the graph modeling field, existing RAG efforts have primarily focused on static and text-attributed graphs to enhance the generation capabilities of Large Language Models, supporting graph-related tasks such as code summarization <cite class="ltx_cite ltx_citemacro_citep">(Liu et al. <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib20" title="">2021</a>)</cite> and textual graph question answering <cite class="ltx_cite ltx_citemacro_citep">(He et al. <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib9" title="">2024</a>; Hu et al. <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib10" title="">2024</a>)</cite>. However, exploiting RAG techniques for dynamic graphs and graphs without textual information remains largely unexplored.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Preliminaries</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">In this section, we introduce the sequence modeling of dynamic graphs and the problem formulation.</p>
</div>
<section class="ltx_paragraph" id="S3.SS0.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Sequence Mapping of Dynamic Graphs.</h5>
<div class="ltx_para" id="S3.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="S3.SS0.SSS0.Px1.p1.12">We denote a dynamic graph as <math alttext="G=(V,E,F,\mathcal{T})" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px1.p1.1.m1.4"><semantics id="S3.SS0.SSS0.Px1.p1.1.m1.4a"><mrow id="S3.SS0.SSS0.Px1.p1.1.m1.4.5" xref="S3.SS0.SSS0.Px1.p1.1.m1.4.5.cmml"><mi id="S3.SS0.SSS0.Px1.p1.1.m1.4.5.2" xref="S3.SS0.SSS0.Px1.p1.1.m1.4.5.2.cmml">G</mi><mo id="S3.SS0.SSS0.Px1.p1.1.m1.4.5.1" xref="S3.SS0.SSS0.Px1.p1.1.m1.4.5.1.cmml">=</mo><mrow id="S3.SS0.SSS0.Px1.p1.1.m1.4.5.3.2" xref="S3.SS0.SSS0.Px1.p1.1.m1.4.5.3.1.cmml"><mo id="S3.SS0.SSS0.Px1.p1.1.m1.4.5.3.2.1" stretchy="false" xref="S3.SS0.SSS0.Px1.p1.1.m1.4.5.3.1.cmml">(</mo><mi id="S3.SS0.SSS0.Px1.p1.1.m1.1.1" xref="S3.SS0.SSS0.Px1.p1.1.m1.1.1.cmml">V</mi><mo id="S3.SS0.SSS0.Px1.p1.1.m1.4.5.3.2.2" xref="S3.SS0.SSS0.Px1.p1.1.m1.4.5.3.1.cmml">,</mo><mi id="S3.SS0.SSS0.Px1.p1.1.m1.2.2" xref="S3.SS0.SSS0.Px1.p1.1.m1.2.2.cmml">E</mi><mo id="S3.SS0.SSS0.Px1.p1.1.m1.4.5.3.2.3" xref="S3.SS0.SSS0.Px1.p1.1.m1.4.5.3.1.cmml">,</mo><mi id="S3.SS0.SSS0.Px1.p1.1.m1.3.3" xref="S3.SS0.SSS0.Px1.p1.1.m1.3.3.cmml">F</mi><mo id="S3.SS0.SSS0.Px1.p1.1.m1.4.5.3.2.4" xref="S3.SS0.SSS0.Px1.p1.1.m1.4.5.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSS0.Px1.p1.1.m1.4.4" xref="S3.SS0.SSS0.Px1.p1.1.m1.4.4.cmml">𝒯</mi><mo id="S3.SS0.SSS0.Px1.p1.1.m1.4.5.3.2.5" stretchy="false" xref="S3.SS0.SSS0.Px1.p1.1.m1.4.5.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.1.m1.4b"><apply id="S3.SS0.SSS0.Px1.p1.1.m1.4.5.cmml" xref="S3.SS0.SSS0.Px1.p1.1.m1.4.5"><eq id="S3.SS0.SSS0.Px1.p1.1.m1.4.5.1.cmml" xref="S3.SS0.SSS0.Px1.p1.1.m1.4.5.1"></eq><ci id="S3.SS0.SSS0.Px1.p1.1.m1.4.5.2.cmml" xref="S3.SS0.SSS0.Px1.p1.1.m1.4.5.2">𝐺</ci><vector id="S3.SS0.SSS0.Px1.p1.1.m1.4.5.3.1.cmml" xref="S3.SS0.SSS0.Px1.p1.1.m1.4.5.3.2"><ci id="S3.SS0.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.1.m1.1.1">𝑉</ci><ci id="S3.SS0.SSS0.Px1.p1.1.m1.2.2.cmml" xref="S3.SS0.SSS0.Px1.p1.1.m1.2.2">𝐸</ci><ci id="S3.SS0.SSS0.Px1.p1.1.m1.3.3.cmml" xref="S3.SS0.SSS0.Px1.p1.1.m1.3.3">𝐹</ci><ci id="S3.SS0.SSS0.Px1.p1.1.m1.4.4.cmml" xref="S3.SS0.SSS0.Px1.p1.1.m1.4.4">𝒯</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.1.m1.4c">G=(V,E,F,\mathcal{T})</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px1.p1.1.m1.4d">italic_G = ( italic_V , italic_E , italic_F , caligraphic_T )</annotation></semantics></math> comprising a set of nodes <math alttext="V" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px1.p1.2.m2.1"><semantics id="S3.SS0.SSS0.Px1.p1.2.m2.1a"><mi id="S3.SS0.SSS0.Px1.p1.2.m2.1.1" xref="S3.SS0.SSS0.Px1.p1.2.m2.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.2.m2.1b"><ci id="S3.SS0.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.2.m2.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.2.m2.1c">V</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px1.p1.2.m2.1d">italic_V</annotation></semantics></math>, edges <math alttext="E" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px1.p1.3.m3.1"><semantics id="S3.SS0.SSS0.Px1.p1.3.m3.1a"><mi id="S3.SS0.SSS0.Px1.p1.3.m3.1.1" xref="S3.SS0.SSS0.Px1.p1.3.m3.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.3.m3.1b"><ci id="S3.SS0.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.3.m3.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.3.m3.1c">E</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px1.p1.3.m3.1d">italic_E</annotation></semantics></math>, a node feature matrix <math alttext="F" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px1.p1.4.m4.1"><semantics id="S3.SS0.SSS0.Px1.p1.4.m4.1a"><mi id="S3.SS0.SSS0.Px1.p1.4.m4.1.1" xref="S3.SS0.SSS0.Px1.p1.4.m4.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.4.m4.1b"><ci id="S3.SS0.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.4.m4.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.4.m4.1c">F</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px1.p1.4.m4.1d">italic_F</annotation></semantics></math> if available, and a time domain <math alttext="\mathcal{T}" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px1.p1.5.m5.1"><semantics id="S3.SS0.SSS0.Px1.p1.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSS0.Px1.p1.5.m5.1.1" xref="S3.SS0.SSS0.Px1.p1.5.m5.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.5.m5.1b"><ci id="S3.SS0.SSS0.Px1.p1.5.m5.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.5.m5.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.5.m5.1c">\mathcal{T}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px1.p1.5.m5.1d">caligraphic_T</annotation></semantics></math>. To map a dynamic graph into sequences, we follow SimpleDyG <cite class="ltx_cite ltx_citemacro_citep">(Wu, Fang, and Liao <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib29" title="">2024</a>)</cite>.
Specifically, let <math alttext="D=\{(x_{i},y_{i})\}_{i=1}^{M}" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px1.p1.6.m6.1"><semantics id="S3.SS0.SSS0.Px1.p1.6.m6.1a"><mrow id="S3.SS0.SSS0.Px1.p1.6.m6.1.1" xref="S3.SS0.SSS0.Px1.p1.6.m6.1.1.cmml"><mi id="S3.SS0.SSS0.Px1.p1.6.m6.1.1.3" xref="S3.SS0.SSS0.Px1.p1.6.m6.1.1.3.cmml">D</mi><mo id="S3.SS0.SSS0.Px1.p1.6.m6.1.1.2" xref="S3.SS0.SSS0.Px1.p1.6.m6.1.1.2.cmml">=</mo><msubsup id="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1" xref="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.cmml"><mrow id="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.1.1.1" xref="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.1.1.2.cmml"><mo id="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.1.1.2.cmml">{</mo><mrow id="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.1.1.1.1.2" xref="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.1.1.1.1.3.cmml"><mo id="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.1.1.1.1.2.3" stretchy="false" xref="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.1.1.1.1.3.cmml">(</mo><msub id="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.1.1.1.1.1.1" xref="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.1.1.1.1.1.1.2" xref="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.1.1.1.1.1.1.3" xref="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.1.1.1.1.2.4" xref="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.1.1.1.1.3.cmml">,</mo><msub id="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.1.1.1.1.2.2" xref="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.1.1.1.1.2.2.2" xref="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.1.1.1.1.2.2.2.cmml">y</mi><mi id="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.1.1.1.1.2.2.3" xref="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.1.1.1.1.2.2.3.cmml">i</mi></msub><mo id="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.1.1.1.1.2.5" stretchy="false" xref="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo id="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.1.3" xref="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.1.3.cmml"><mi id="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.1.3.2" xref="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.1.3.2.cmml">i</mi><mo id="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.1.3.1" xref="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.1.3.1.cmml">=</mo><mn id="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.1.3.3" xref="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.3" xref="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.3.cmml">M</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.6.m6.1b"><apply id="S3.SS0.SSS0.Px1.p1.6.m6.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.6.m6.1.1"><eq id="S3.SS0.SSS0.Px1.p1.6.m6.1.1.2.cmml" xref="S3.SS0.SSS0.Px1.p1.6.m6.1.1.2"></eq><ci id="S3.SS0.SSS0.Px1.p1.6.m6.1.1.3.cmml" xref="S3.SS0.SSS0.Px1.p1.6.m6.1.1.3">𝐷</ci><apply id="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1">superscript</csymbol><apply id="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1">subscript</csymbol><set id="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.1.1.1"><interval closure="open" id="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.1.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.1.1.1.1.2"><apply id="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.1.1.1.1.2.2.2">𝑦</ci><ci id="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply></interval></set><apply id="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.1.3"><eq id="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.1.3.1"></eq><ci id="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.1.3.2">𝑖</ci><cn id="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.1.3.3.cmml" type="integer" xref="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px1.p1.6.m6.1.1.1.3">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.6.m6.1c">D=\{(x_{i},y_{i})\}_{i=1}^{M}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px1.p1.6.m6.1d">italic_D = { ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT</annotation></semantics></math> denote the set of training samples, where each sample is a pair <math alttext="(x_{i},y_{i})" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px1.p1.7.m7.2"><semantics id="S3.SS0.SSS0.Px1.p1.7.m7.2a"><mrow id="S3.SS0.SSS0.Px1.p1.7.m7.2.2.2" xref="S3.SS0.SSS0.Px1.p1.7.m7.2.2.3.cmml"><mo id="S3.SS0.SSS0.Px1.p1.7.m7.2.2.2.3" stretchy="false" xref="S3.SS0.SSS0.Px1.p1.7.m7.2.2.3.cmml">(</mo><msub id="S3.SS0.SSS0.Px1.p1.7.m7.1.1.1.1" xref="S3.SS0.SSS0.Px1.p1.7.m7.1.1.1.1.cmml"><mi id="S3.SS0.SSS0.Px1.p1.7.m7.1.1.1.1.2" xref="S3.SS0.SSS0.Px1.p1.7.m7.1.1.1.1.2.cmml">x</mi><mi id="S3.SS0.SSS0.Px1.p1.7.m7.1.1.1.1.3" xref="S3.SS0.SSS0.Px1.p1.7.m7.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS0.SSS0.Px1.p1.7.m7.2.2.2.4" xref="S3.SS0.SSS0.Px1.p1.7.m7.2.2.3.cmml">,</mo><msub id="S3.SS0.SSS0.Px1.p1.7.m7.2.2.2.2" xref="S3.SS0.SSS0.Px1.p1.7.m7.2.2.2.2.cmml"><mi id="S3.SS0.SSS0.Px1.p1.7.m7.2.2.2.2.2" xref="S3.SS0.SSS0.Px1.p1.7.m7.2.2.2.2.2.cmml">y</mi><mi id="S3.SS0.SSS0.Px1.p1.7.m7.2.2.2.2.3" xref="S3.SS0.SSS0.Px1.p1.7.m7.2.2.2.2.3.cmml">i</mi></msub><mo id="S3.SS0.SSS0.Px1.p1.7.m7.2.2.2.5" stretchy="false" xref="S3.SS0.SSS0.Px1.p1.7.m7.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.7.m7.2b"><interval closure="open" id="S3.SS0.SSS0.Px1.p1.7.m7.2.2.3.cmml" xref="S3.SS0.SSS0.Px1.p1.7.m7.2.2.2"><apply id="S3.SS0.SSS0.Px1.p1.7.m7.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.7.m7.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px1.p1.7.m7.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.7.m7.1.1.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px1.p1.7.m7.1.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px1.p1.7.m7.1.1.1.1.2">𝑥</ci><ci id="S3.SS0.SSS0.Px1.p1.7.m7.1.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px1.p1.7.m7.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS0.SSS0.Px1.p1.7.m7.2.2.2.2.cmml" xref="S3.SS0.SSS0.Px1.p1.7.m7.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px1.p1.7.m7.2.2.2.2.1.cmml" xref="S3.SS0.SSS0.Px1.p1.7.m7.2.2.2.2">subscript</csymbol><ci id="S3.SS0.SSS0.Px1.p1.7.m7.2.2.2.2.2.cmml" xref="S3.SS0.SSS0.Px1.p1.7.m7.2.2.2.2.2">𝑦</ci><ci id="S3.SS0.SSS0.Px1.p1.7.m7.2.2.2.2.3.cmml" xref="S3.SS0.SSS0.Px1.p1.7.m7.2.2.2.2.3">𝑖</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.7.m7.2c">(x_{i},y_{i})</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px1.p1.7.m7.2d">( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math>, representing the input and output sequences for a target node <math alttext="v_{i}\in V" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px1.p1.8.m8.1"><semantics id="S3.SS0.SSS0.Px1.p1.8.m8.1a"><mrow id="S3.SS0.SSS0.Px1.p1.8.m8.1.1" xref="S3.SS0.SSS0.Px1.p1.8.m8.1.1.cmml"><msub id="S3.SS0.SSS0.Px1.p1.8.m8.1.1.2" xref="S3.SS0.SSS0.Px1.p1.8.m8.1.1.2.cmml"><mi id="S3.SS0.SSS0.Px1.p1.8.m8.1.1.2.2" xref="S3.SS0.SSS0.Px1.p1.8.m8.1.1.2.2.cmml">v</mi><mi id="S3.SS0.SSS0.Px1.p1.8.m8.1.1.2.3" xref="S3.SS0.SSS0.Px1.p1.8.m8.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS0.SSS0.Px1.p1.8.m8.1.1.1" xref="S3.SS0.SSS0.Px1.p1.8.m8.1.1.1.cmml">∈</mo><mi id="S3.SS0.SSS0.Px1.p1.8.m8.1.1.3" xref="S3.SS0.SSS0.Px1.p1.8.m8.1.1.3.cmml">V</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.8.m8.1b"><apply id="S3.SS0.SSS0.Px1.p1.8.m8.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.8.m8.1.1"><in id="S3.SS0.SSS0.Px1.p1.8.m8.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.8.m8.1.1.1"></in><apply id="S3.SS0.SSS0.Px1.p1.8.m8.1.1.2.cmml" xref="S3.SS0.SSS0.Px1.p1.8.m8.1.1.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px1.p1.8.m8.1.1.2.1.cmml" xref="S3.SS0.SSS0.Px1.p1.8.m8.1.1.2">subscript</csymbol><ci id="S3.SS0.SSS0.Px1.p1.8.m8.1.1.2.2.cmml" xref="S3.SS0.SSS0.Px1.p1.8.m8.1.1.2.2">𝑣</ci><ci id="S3.SS0.SSS0.Px1.p1.8.m8.1.1.2.3.cmml" xref="S3.SS0.SSS0.Px1.p1.8.m8.1.1.2.3">𝑖</ci></apply><ci id="S3.SS0.SSS0.Px1.p1.8.m8.1.1.3.cmml" xref="S3.SS0.SSS0.Px1.p1.8.m8.1.1.3">𝑉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.8.m8.1c">v_{i}\in V</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px1.p1.8.m8.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ italic_V</annotation></semantics></math>. The input <math alttext="x_{i}" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px1.p1.9.m9.1"><semantics id="S3.SS0.SSS0.Px1.p1.9.m9.1a"><msub id="S3.SS0.SSS0.Px1.p1.9.m9.1.1" xref="S3.SS0.SSS0.Px1.p1.9.m9.1.1.cmml"><mi id="S3.SS0.SSS0.Px1.p1.9.m9.1.1.2" xref="S3.SS0.SSS0.Px1.p1.9.m9.1.1.2.cmml">x</mi><mi id="S3.SS0.SSS0.Px1.p1.9.m9.1.1.3" xref="S3.SS0.SSS0.Px1.p1.9.m9.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.9.m9.1b"><apply id="S3.SS0.SSS0.Px1.p1.9.m9.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px1.p1.9.m9.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.9.m9.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px1.p1.9.m9.1.1.2.cmml" xref="S3.SS0.SSS0.Px1.p1.9.m9.1.1.2">𝑥</ci><ci id="S3.SS0.SSS0.Px1.p1.9.m9.1.1.3.cmml" xref="S3.SS0.SSS0.Px1.p1.9.m9.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.9.m9.1c">x_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px1.p1.9.m9.1d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is a chronologically ordered sequence of nodes that have historically interacted with <math alttext="v_{i}" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px1.p1.10.m10.1"><semantics id="S3.SS0.SSS0.Px1.p1.10.m10.1a"><msub id="S3.SS0.SSS0.Px1.p1.10.m10.1.1" xref="S3.SS0.SSS0.Px1.p1.10.m10.1.1.cmml"><mi id="S3.SS0.SSS0.Px1.p1.10.m10.1.1.2" xref="S3.SS0.SSS0.Px1.p1.10.m10.1.1.2.cmml">v</mi><mi id="S3.SS0.SSS0.Px1.p1.10.m10.1.1.3" xref="S3.SS0.SSS0.Px1.p1.10.m10.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.10.m10.1b"><apply id="S3.SS0.SSS0.Px1.p1.10.m10.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px1.p1.10.m10.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.10.m10.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px1.p1.10.m10.1.1.2.cmml" xref="S3.SS0.SSS0.Px1.p1.10.m10.1.1.2">𝑣</ci><ci id="S3.SS0.SSS0.Px1.p1.10.m10.1.1.3.cmml" xref="S3.SS0.SSS0.Px1.p1.10.m10.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.10.m10.1c">v_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px1.p1.10.m10.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, while the output <math alttext="y_{i}" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px1.p1.11.m11.1"><semantics id="S3.SS0.SSS0.Px1.p1.11.m11.1a"><msub id="S3.SS0.SSS0.Px1.p1.11.m11.1.1" xref="S3.SS0.SSS0.Px1.p1.11.m11.1.1.cmml"><mi id="S3.SS0.SSS0.Px1.p1.11.m11.1.1.2" xref="S3.SS0.SSS0.Px1.p1.11.m11.1.1.2.cmml">y</mi><mi id="S3.SS0.SSS0.Px1.p1.11.m11.1.1.3" xref="S3.SS0.SSS0.Px1.p1.11.m11.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.11.m11.1b"><apply id="S3.SS0.SSS0.Px1.p1.11.m11.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px1.p1.11.m11.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.11.m11.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px1.p1.11.m11.1.1.2.cmml" xref="S3.SS0.SSS0.Px1.p1.11.m11.1.1.2">𝑦</ci><ci id="S3.SS0.SSS0.Px1.p1.11.m11.1.1.3.cmml" xref="S3.SS0.SSS0.Px1.p1.11.m11.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.11.m11.1c">y_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px1.p1.11.m11.1d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is the ground truth interactions that occurs following the sequence <math alttext="x_{i}" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px1.p1.12.m12.1"><semantics id="S3.SS0.SSS0.Px1.p1.12.m12.1a"><msub id="S3.SS0.SSS0.Px1.p1.12.m12.1.1" xref="S3.SS0.SSS0.Px1.p1.12.m12.1.1.cmml"><mi id="S3.SS0.SSS0.Px1.p1.12.m12.1.1.2" xref="S3.SS0.SSS0.Px1.p1.12.m12.1.1.2.cmml">x</mi><mi id="S3.SS0.SSS0.Px1.p1.12.m12.1.1.3" xref="S3.SS0.SSS0.Px1.p1.12.m12.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.12.m12.1b"><apply id="S3.SS0.SSS0.Px1.p1.12.m12.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px1.p1.12.m12.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.12.m12.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px1.p1.12.m12.1.1.2.cmml" xref="S3.SS0.SSS0.Px1.p1.12.m12.1.1.2">𝑥</ci><ci id="S3.SS0.SSS0.Px1.p1.12.m12.1.1.3.cmml" xref="S3.SS0.SSS0.Px1.p1.12.m12.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.12.m12.1c">x_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px1.p1.12.m12.1d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>. In notations, we have</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A4.EGx1">
<tbody id="S3.Ex1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle x_{i}" class="ltx_Math" display="inline" id="S3.Ex1.m1.1"><semantics id="S3.Ex1.m1.1a"><msub id="S3.Ex1.m1.1.1" xref="S3.Ex1.m1.1.1.cmml"><mi id="S3.Ex1.m1.1.1.2" xref="S3.Ex1.m1.1.1.2.cmml">x</mi><mi id="S3.Ex1.m1.1.1.3" xref="S3.Ex1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.1b"><apply id="S3.Ex1.m1.1.1.cmml" xref="S3.Ex1.m1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.cmml" xref="S3.Ex1.m1.1.1">subscript</csymbol><ci id="S3.Ex1.m1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.2">𝑥</ci><ci id="S3.Ex1.m1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.1c">\displaystyle x_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex1.m1.1d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=[\textit{hist}],v_{i},[\textit{time\_1}],v_{i}^{1,1},v_{i}^{1,2}%
,\ldots,[\textit{time\_t}],v_{i}^{t,1},\ldots," class="ltx_Math" display="inline" id="S3.Ex1.m2.12"><semantics id="S3.Ex1.m2.12a"><mrow id="S3.Ex1.m2.12.12.1" xref="S3.Ex1.m2.12.12.1.1.cmml"><mrow id="S3.Ex1.m2.12.12.1.1" xref="S3.Ex1.m2.12.12.1.1.cmml"><mi id="S3.Ex1.m2.12.12.1.1.9" xref="S3.Ex1.m2.12.12.1.1.9.cmml"></mi><mo id="S3.Ex1.m2.12.12.1.1.8" xref="S3.Ex1.m2.12.12.1.1.8.cmml">=</mo><mrow id="S3.Ex1.m2.12.12.1.1.7.7" xref="S3.Ex1.m2.12.12.1.1.7.8.cmml"><mrow id="S3.Ex1.m2.12.12.1.1.1.1.1.2" xref="S3.Ex1.m2.12.12.1.1.1.1.1.1.cmml"><mo id="S3.Ex1.m2.12.12.1.1.1.1.1.2.1" stretchy="false" xref="S3.Ex1.m2.12.12.1.1.1.1.1.1.1.cmml">[</mo><mtext class="ltx_mathvariant_italic" id="S3.Ex1.m2.7.7" xref="S3.Ex1.m2.7.7a.cmml">hist</mtext><mo id="S3.Ex1.m2.12.12.1.1.1.1.1.2.2" stretchy="false" xref="S3.Ex1.m2.12.12.1.1.1.1.1.1.1.cmml">]</mo></mrow><mo id="S3.Ex1.m2.12.12.1.1.7.7.8" xref="S3.Ex1.m2.12.12.1.1.7.8.cmml">,</mo><msub id="S3.Ex1.m2.12.12.1.1.2.2.2" xref="S3.Ex1.m2.12.12.1.1.2.2.2.cmml"><mi id="S3.Ex1.m2.12.12.1.1.2.2.2.2" xref="S3.Ex1.m2.12.12.1.1.2.2.2.2.cmml">v</mi><mi id="S3.Ex1.m2.12.12.1.1.2.2.2.3" xref="S3.Ex1.m2.12.12.1.1.2.2.2.3.cmml">i</mi></msub><mo id="S3.Ex1.m2.12.12.1.1.7.7.9" xref="S3.Ex1.m2.12.12.1.1.7.8.cmml">,</mo><mrow id="S3.Ex1.m2.12.12.1.1.3.3.3.2" xref="S3.Ex1.m2.12.12.1.1.3.3.3.1.cmml"><mo id="S3.Ex1.m2.12.12.1.1.3.3.3.2.1" stretchy="false" xref="S3.Ex1.m2.12.12.1.1.3.3.3.1.1.cmml">[</mo><mtext class="ltx_mathvariant_italic" id="S3.Ex1.m2.8.8" xref="S3.Ex1.m2.8.8a.cmml">time_1</mtext><mo id="S3.Ex1.m2.12.12.1.1.3.3.3.2.2" stretchy="false" xref="S3.Ex1.m2.12.12.1.1.3.3.3.1.1.cmml">]</mo></mrow><mo id="S3.Ex1.m2.12.12.1.1.7.7.10" xref="S3.Ex1.m2.12.12.1.1.7.8.cmml">,</mo><msubsup id="S3.Ex1.m2.12.12.1.1.4.4.4" xref="S3.Ex1.m2.12.12.1.1.4.4.4.cmml"><mi id="S3.Ex1.m2.12.12.1.1.4.4.4.2.2" xref="S3.Ex1.m2.12.12.1.1.4.4.4.2.2.cmml">v</mi><mi id="S3.Ex1.m2.12.12.1.1.4.4.4.2.3" xref="S3.Ex1.m2.12.12.1.1.4.4.4.2.3.cmml">i</mi><mrow id="S3.Ex1.m2.2.2.2.4" xref="S3.Ex1.m2.2.2.2.3.cmml"><mn id="S3.Ex1.m2.1.1.1.1" xref="S3.Ex1.m2.1.1.1.1.cmml">1</mn><mo id="S3.Ex1.m2.2.2.2.4.1" xref="S3.Ex1.m2.2.2.2.3.cmml">,</mo><mn id="S3.Ex1.m2.2.2.2.2" xref="S3.Ex1.m2.2.2.2.2.cmml">1</mn></mrow></msubsup><mo id="S3.Ex1.m2.12.12.1.1.7.7.11" xref="S3.Ex1.m2.12.12.1.1.7.8.cmml">,</mo><msubsup id="S3.Ex1.m2.12.12.1.1.5.5.5" xref="S3.Ex1.m2.12.12.1.1.5.5.5.cmml"><mi id="S3.Ex1.m2.12.12.1.1.5.5.5.2.2" xref="S3.Ex1.m2.12.12.1.1.5.5.5.2.2.cmml">v</mi><mi id="S3.Ex1.m2.12.12.1.1.5.5.5.2.3" xref="S3.Ex1.m2.12.12.1.1.5.5.5.2.3.cmml">i</mi><mrow id="S3.Ex1.m2.4.4.2.4" xref="S3.Ex1.m2.4.4.2.3.cmml"><mn id="S3.Ex1.m2.3.3.1.1" xref="S3.Ex1.m2.3.3.1.1.cmml">1</mn><mo id="S3.Ex1.m2.4.4.2.4.1" xref="S3.Ex1.m2.4.4.2.3.cmml">,</mo><mn id="S3.Ex1.m2.4.4.2.2" xref="S3.Ex1.m2.4.4.2.2.cmml">2</mn></mrow></msubsup><mo id="S3.Ex1.m2.12.12.1.1.7.7.12" xref="S3.Ex1.m2.12.12.1.1.7.8.cmml">,</mo><mi id="S3.Ex1.m2.10.10" mathvariant="normal" xref="S3.Ex1.m2.10.10.cmml">…</mi><mo id="S3.Ex1.m2.12.12.1.1.7.7.13" xref="S3.Ex1.m2.12.12.1.1.7.8.cmml">,</mo><mrow id="S3.Ex1.m2.12.12.1.1.6.6.6.2" xref="S3.Ex1.m2.12.12.1.1.6.6.6.1.cmml"><mo id="S3.Ex1.m2.12.12.1.1.6.6.6.2.1" stretchy="false" xref="S3.Ex1.m2.12.12.1.1.6.6.6.1.1.cmml">[</mo><mtext class="ltx_mathvariant_italic" id="S3.Ex1.m2.9.9" xref="S3.Ex1.m2.9.9a.cmml">time_t</mtext><mo id="S3.Ex1.m2.12.12.1.1.6.6.6.2.2" stretchy="false" xref="S3.Ex1.m2.12.12.1.1.6.6.6.1.1.cmml">]</mo></mrow><mo id="S3.Ex1.m2.12.12.1.1.7.7.14" xref="S3.Ex1.m2.12.12.1.1.7.8.cmml">,</mo><msubsup id="S3.Ex1.m2.12.12.1.1.7.7.7" xref="S3.Ex1.m2.12.12.1.1.7.7.7.cmml"><mi id="S3.Ex1.m2.12.12.1.1.7.7.7.2.2" xref="S3.Ex1.m2.12.12.1.1.7.7.7.2.2.cmml">v</mi><mi id="S3.Ex1.m2.12.12.1.1.7.7.7.2.3" xref="S3.Ex1.m2.12.12.1.1.7.7.7.2.3.cmml">i</mi><mrow id="S3.Ex1.m2.6.6.2.4" xref="S3.Ex1.m2.6.6.2.3.cmml"><mi id="S3.Ex1.m2.5.5.1.1" xref="S3.Ex1.m2.5.5.1.1.cmml">t</mi><mo id="S3.Ex1.m2.6.6.2.4.1" xref="S3.Ex1.m2.6.6.2.3.cmml">,</mo><mn id="S3.Ex1.m2.6.6.2.2" xref="S3.Ex1.m2.6.6.2.2.cmml">1</mn></mrow></msubsup><mo id="S3.Ex1.m2.12.12.1.1.7.7.15" xref="S3.Ex1.m2.12.12.1.1.7.8.cmml">,</mo><mi id="S3.Ex1.m2.11.11" mathvariant="normal" xref="S3.Ex1.m2.11.11.cmml">…</mi></mrow></mrow><mo id="S3.Ex1.m2.12.12.1.2" xref="S3.Ex1.m2.12.12.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m2.12b"><apply id="S3.Ex1.m2.12.12.1.1.cmml" xref="S3.Ex1.m2.12.12.1"><eq id="S3.Ex1.m2.12.12.1.1.8.cmml" xref="S3.Ex1.m2.12.12.1.1.8"></eq><csymbol cd="latexml" id="S3.Ex1.m2.12.12.1.1.9.cmml" xref="S3.Ex1.m2.12.12.1.1.9">absent</csymbol><list id="S3.Ex1.m2.12.12.1.1.7.8.cmml" xref="S3.Ex1.m2.12.12.1.1.7.7"><apply id="S3.Ex1.m2.12.12.1.1.1.1.1.1.cmml" xref="S3.Ex1.m2.12.12.1.1.1.1.1.2"><csymbol cd="latexml" id="S3.Ex1.m2.12.12.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m2.12.12.1.1.1.1.1.2.1">delimited-[]</csymbol><ci id="S3.Ex1.m2.7.7a.cmml" xref="S3.Ex1.m2.7.7"><mtext class="ltx_mathvariant_italic" id="S3.Ex1.m2.7.7.cmml" xref="S3.Ex1.m2.7.7">hist</mtext></ci></apply><apply id="S3.Ex1.m2.12.12.1.1.2.2.2.cmml" xref="S3.Ex1.m2.12.12.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.Ex1.m2.12.12.1.1.2.2.2.1.cmml" xref="S3.Ex1.m2.12.12.1.1.2.2.2">subscript</csymbol><ci id="S3.Ex1.m2.12.12.1.1.2.2.2.2.cmml" xref="S3.Ex1.m2.12.12.1.1.2.2.2.2">𝑣</ci><ci id="S3.Ex1.m2.12.12.1.1.2.2.2.3.cmml" xref="S3.Ex1.m2.12.12.1.1.2.2.2.3">𝑖</ci></apply><apply id="S3.Ex1.m2.12.12.1.1.3.3.3.1.cmml" xref="S3.Ex1.m2.12.12.1.1.3.3.3.2"><csymbol cd="latexml" id="S3.Ex1.m2.12.12.1.1.3.3.3.1.1.cmml" xref="S3.Ex1.m2.12.12.1.1.3.3.3.2.1">delimited-[]</csymbol><ci id="S3.Ex1.m2.8.8a.cmml" xref="S3.Ex1.m2.8.8"><mtext class="ltx_mathvariant_italic" id="S3.Ex1.m2.8.8.cmml" xref="S3.Ex1.m2.8.8">time_1</mtext></ci></apply><apply id="S3.Ex1.m2.12.12.1.1.4.4.4.cmml" xref="S3.Ex1.m2.12.12.1.1.4.4.4"><csymbol cd="ambiguous" id="S3.Ex1.m2.12.12.1.1.4.4.4.1.cmml" xref="S3.Ex1.m2.12.12.1.1.4.4.4">superscript</csymbol><apply id="S3.Ex1.m2.12.12.1.1.4.4.4.2.cmml" xref="S3.Ex1.m2.12.12.1.1.4.4.4"><csymbol cd="ambiguous" id="S3.Ex1.m2.12.12.1.1.4.4.4.2.1.cmml" xref="S3.Ex1.m2.12.12.1.1.4.4.4">subscript</csymbol><ci id="S3.Ex1.m2.12.12.1.1.4.4.4.2.2.cmml" xref="S3.Ex1.m2.12.12.1.1.4.4.4.2.2">𝑣</ci><ci id="S3.Ex1.m2.12.12.1.1.4.4.4.2.3.cmml" xref="S3.Ex1.m2.12.12.1.1.4.4.4.2.3">𝑖</ci></apply><list id="S3.Ex1.m2.2.2.2.3.cmml" xref="S3.Ex1.m2.2.2.2.4"><cn id="S3.Ex1.m2.1.1.1.1.cmml" type="integer" xref="S3.Ex1.m2.1.1.1.1">1</cn><cn id="S3.Ex1.m2.2.2.2.2.cmml" type="integer" xref="S3.Ex1.m2.2.2.2.2">1</cn></list></apply><apply id="S3.Ex1.m2.12.12.1.1.5.5.5.cmml" xref="S3.Ex1.m2.12.12.1.1.5.5.5"><csymbol cd="ambiguous" id="S3.Ex1.m2.12.12.1.1.5.5.5.1.cmml" xref="S3.Ex1.m2.12.12.1.1.5.5.5">superscript</csymbol><apply id="S3.Ex1.m2.12.12.1.1.5.5.5.2.cmml" xref="S3.Ex1.m2.12.12.1.1.5.5.5"><csymbol cd="ambiguous" id="S3.Ex1.m2.12.12.1.1.5.5.5.2.1.cmml" xref="S3.Ex1.m2.12.12.1.1.5.5.5">subscript</csymbol><ci id="S3.Ex1.m2.12.12.1.1.5.5.5.2.2.cmml" xref="S3.Ex1.m2.12.12.1.1.5.5.5.2.2">𝑣</ci><ci id="S3.Ex1.m2.12.12.1.1.5.5.5.2.3.cmml" xref="S3.Ex1.m2.12.12.1.1.5.5.5.2.3">𝑖</ci></apply><list id="S3.Ex1.m2.4.4.2.3.cmml" xref="S3.Ex1.m2.4.4.2.4"><cn id="S3.Ex1.m2.3.3.1.1.cmml" type="integer" xref="S3.Ex1.m2.3.3.1.1">1</cn><cn id="S3.Ex1.m2.4.4.2.2.cmml" type="integer" xref="S3.Ex1.m2.4.4.2.2">2</cn></list></apply><ci id="S3.Ex1.m2.10.10.cmml" xref="S3.Ex1.m2.10.10">…</ci><apply id="S3.Ex1.m2.12.12.1.1.6.6.6.1.cmml" xref="S3.Ex1.m2.12.12.1.1.6.6.6.2"><csymbol cd="latexml" id="S3.Ex1.m2.12.12.1.1.6.6.6.1.1.cmml" xref="S3.Ex1.m2.12.12.1.1.6.6.6.2.1">delimited-[]</csymbol><ci id="S3.Ex1.m2.9.9a.cmml" xref="S3.Ex1.m2.9.9"><mtext class="ltx_mathvariant_italic" id="S3.Ex1.m2.9.9.cmml" xref="S3.Ex1.m2.9.9">time_t</mtext></ci></apply><apply id="S3.Ex1.m2.12.12.1.1.7.7.7.cmml" xref="S3.Ex1.m2.12.12.1.1.7.7.7"><csymbol cd="ambiguous" id="S3.Ex1.m2.12.12.1.1.7.7.7.1.cmml" xref="S3.Ex1.m2.12.12.1.1.7.7.7">superscript</csymbol><apply id="S3.Ex1.m2.12.12.1.1.7.7.7.2.cmml" xref="S3.Ex1.m2.12.12.1.1.7.7.7"><csymbol cd="ambiguous" id="S3.Ex1.m2.12.12.1.1.7.7.7.2.1.cmml" xref="S3.Ex1.m2.12.12.1.1.7.7.7">subscript</csymbol><ci id="S3.Ex1.m2.12.12.1.1.7.7.7.2.2.cmml" xref="S3.Ex1.m2.12.12.1.1.7.7.7.2.2">𝑣</ci><ci id="S3.Ex1.m2.12.12.1.1.7.7.7.2.3.cmml" xref="S3.Ex1.m2.12.12.1.1.7.7.7.2.3">𝑖</ci></apply><list id="S3.Ex1.m2.6.6.2.3.cmml" xref="S3.Ex1.m2.6.6.2.4"><ci id="S3.Ex1.m2.5.5.1.1.cmml" xref="S3.Ex1.m2.5.5.1.1">𝑡</ci><cn id="S3.Ex1.m2.6.6.2.2.cmml" type="integer" xref="S3.Ex1.m2.6.6.2.2">1</cn></list></apply><ci id="S3.Ex1.m2.11.11.cmml" xref="S3.Ex1.m2.11.11">…</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m2.12c">\displaystyle=[\textit{hist}],v_{i},[\textit{time\_1}],v_{i}^{1,1},v_{i}^{1,2}%
,\ldots,[\textit{time\_t}],v_{i}^{t,1},\ldots,</annotation><annotation encoding="application/x-llamapun" id="S3.Ex1.m2.12d">= [ hist ] , italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , [ time_1 ] , italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 1 , 1 end_POSTSUPERSCRIPT , italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 1 , 2 end_POSTSUPERSCRIPT , … , [ time_t ] , italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t , 1 end_POSTSUPERSCRIPT , … ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\hskip 13.37277pt[\textit{time\_T}],v_{i}^{T,1},\ldots,[\textit{%
eohist}]," class="ltx_Math" display="inline" id="S3.E1.m1.6"><semantics id="S3.E1.m1.6a"><mrow id="S3.E1.m1.6.6.1"><mrow id="S3.E1.m1.6.6.1.1.3" xref="S3.E1.m1.6.6.1.1.4.cmml"><mrow id="S3.E1.m1.6.6.1.1.1.1.2" xref="S3.E1.m1.6.6.1.1.1.1.1.cmml"><mo id="S3.E1.m1.6.6.1.1.1.1.2.1" stretchy="false" xref="S3.E1.m1.6.6.1.1.1.1.1.1.cmml">[</mo><mtext class="ltx_mathvariant_italic" id="S3.E1.m1.3.3" xref="S3.E1.m1.3.3a.cmml">time_T</mtext><mo id="S3.E1.m1.6.6.1.1.1.1.2.2" stretchy="false" xref="S3.E1.m1.6.6.1.1.1.1.1.1.cmml">]</mo></mrow><mo id="S3.E1.m1.6.6.1.1.3.4" xref="S3.E1.m1.6.6.1.1.4.cmml">,</mo><msubsup id="S3.E1.m1.6.6.1.1.2.2" xref="S3.E1.m1.6.6.1.1.2.2.cmml"><mi id="S3.E1.m1.6.6.1.1.2.2.2.2" xref="S3.E1.m1.6.6.1.1.2.2.2.2.cmml">v</mi><mi id="S3.E1.m1.6.6.1.1.2.2.2.3" xref="S3.E1.m1.6.6.1.1.2.2.2.3.cmml">i</mi><mrow id="S3.E1.m1.2.2.2.4" xref="S3.E1.m1.2.2.2.3.cmml"><mi id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml">T</mi><mo id="S3.E1.m1.2.2.2.4.1" xref="S3.E1.m1.2.2.2.3.cmml">,</mo><mn id="S3.E1.m1.2.2.2.2" xref="S3.E1.m1.2.2.2.2.cmml">1</mn></mrow></msubsup><mo id="S3.E1.m1.6.6.1.1.3.5" xref="S3.E1.m1.6.6.1.1.4.cmml">,</mo><mi id="S3.E1.m1.5.5" mathvariant="normal" xref="S3.E1.m1.5.5.cmml">…</mi><mo id="S3.E1.m1.6.6.1.1.3.6" xref="S3.E1.m1.6.6.1.1.4.cmml">,</mo><mrow id="S3.E1.m1.6.6.1.1.3.3.2" xref="S3.E1.m1.6.6.1.1.3.3.1.cmml"><mo id="S3.E1.m1.6.6.1.1.3.3.2.1" stretchy="false" xref="S3.E1.m1.6.6.1.1.3.3.1.1.cmml">[</mo><mtext class="ltx_mathvariant_italic" id="S3.E1.m1.4.4" xref="S3.E1.m1.4.4a.cmml">eohist</mtext><mo id="S3.E1.m1.6.6.1.1.3.3.2.2" stretchy="false" xref="S3.E1.m1.6.6.1.1.3.3.1.1.cmml">]</mo></mrow></mrow><mo id="S3.E1.m1.6.6.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.6b"><list id="S3.E1.m1.6.6.1.1.4.cmml" xref="S3.E1.m1.6.6.1.1.3"><apply id="S3.E1.m1.6.6.1.1.1.1.1.cmml" xref="S3.E1.m1.6.6.1.1.1.1.2"><csymbol cd="latexml" id="S3.E1.m1.6.6.1.1.1.1.1.1.cmml" xref="S3.E1.m1.6.6.1.1.1.1.2.1">delimited-[]</csymbol><ci id="S3.E1.m1.3.3a.cmml" xref="S3.E1.m1.3.3"><mtext class="ltx_mathvariant_italic" id="S3.E1.m1.3.3.cmml" xref="S3.E1.m1.3.3">time_T</mtext></ci></apply><apply id="S3.E1.m1.6.6.1.1.2.2.cmml" xref="S3.E1.m1.6.6.1.1.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.1.1.2.2.1.cmml" xref="S3.E1.m1.6.6.1.1.2.2">superscript</csymbol><apply id="S3.E1.m1.6.6.1.1.2.2.2.cmml" xref="S3.E1.m1.6.6.1.1.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.1.1.2.2.2.1.cmml" xref="S3.E1.m1.6.6.1.1.2.2">subscript</csymbol><ci id="S3.E1.m1.6.6.1.1.2.2.2.2.cmml" xref="S3.E1.m1.6.6.1.1.2.2.2.2">𝑣</ci><ci id="S3.E1.m1.6.6.1.1.2.2.2.3.cmml" xref="S3.E1.m1.6.6.1.1.2.2.2.3">𝑖</ci></apply><list id="S3.E1.m1.2.2.2.3.cmml" xref="S3.E1.m1.2.2.2.4"><ci id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1">𝑇</ci><cn id="S3.E1.m1.2.2.2.2.cmml" type="integer" xref="S3.E1.m1.2.2.2.2">1</cn></list></apply><ci id="S3.E1.m1.5.5.cmml" xref="S3.E1.m1.5.5">…</ci><apply id="S3.E1.m1.6.6.1.1.3.3.1.cmml" xref="S3.E1.m1.6.6.1.1.3.3.2"><csymbol cd="latexml" id="S3.E1.m1.6.6.1.1.3.3.1.1.cmml" xref="S3.E1.m1.6.6.1.1.3.3.2.1">delimited-[]</csymbol><ci id="S3.E1.m1.4.4a.cmml" xref="S3.E1.m1.4.4"><mtext class="ltx_mathvariant_italic" id="S3.E1.m1.4.4.cmml" xref="S3.E1.m1.4.4">eohist</mtext></ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.6c">\displaystyle\hskip 13.37277pt[\textit{time\_T}],v_{i}^{T,1},\ldots,[\textit{%
eohist}],</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.6d">[ time_T ] , italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T , 1 end_POSTSUPERSCRIPT , … , [ eohist ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
<tbody id="S3.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle y_{i}" class="ltx_Math" display="inline" id="S3.E2.m1.1"><semantics id="S3.E2.m1.1a"><msub id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml"><mi id="S3.E2.m1.1.1.2" xref="S3.E2.m1.1.1.2.cmml">y</mi><mi id="S3.E2.m1.1.1.3" xref="S3.E2.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.E2.m1.1b"><apply id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.cmml" xref="S3.E2.m1.1.1">subscript</csymbol><ci id="S3.E2.m1.1.1.2.cmml" xref="S3.E2.m1.1.1.2">𝑦</ci><ci id="S3.E2.m1.1.1.3.cmml" xref="S3.E2.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.1c">\displaystyle y_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.1d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=[\textit{pred}],[\textit{time\_T+1}],v_{i}^{T+1,1},\ldots,[%
\textit{eopred}]," class="ltx_Math" display="inline" id="S3.E2.m2.7"><semantics id="S3.E2.m2.7a"><mrow id="S3.E2.m2.7.7.1" xref="S3.E2.m2.7.7.1.1.cmml"><mrow id="S3.E2.m2.7.7.1.1" xref="S3.E2.m2.7.7.1.1.cmml"><mi id="S3.E2.m2.7.7.1.1.6" xref="S3.E2.m2.7.7.1.1.6.cmml"></mi><mo id="S3.E2.m2.7.7.1.1.5" xref="S3.E2.m2.7.7.1.1.5.cmml">=</mo><mrow id="S3.E2.m2.7.7.1.1.4.4" xref="S3.E2.m2.7.7.1.1.4.5.cmml"><mrow id="S3.E2.m2.7.7.1.1.1.1.1.2" xref="S3.E2.m2.7.7.1.1.1.1.1.1.cmml"><mo id="S3.E2.m2.7.7.1.1.1.1.1.2.1" stretchy="false" xref="S3.E2.m2.7.7.1.1.1.1.1.1.1.cmml">[</mo><mtext class="ltx_mathvariant_italic" id="S3.E2.m2.3.3" xref="S3.E2.m2.3.3a.cmml">pred</mtext><mo id="S3.E2.m2.7.7.1.1.1.1.1.2.2" stretchy="false" xref="S3.E2.m2.7.7.1.1.1.1.1.1.1.cmml">]</mo></mrow><mo id="S3.E2.m2.7.7.1.1.4.4.5" xref="S3.E2.m2.7.7.1.1.4.5.cmml">,</mo><mrow id="S3.E2.m2.7.7.1.1.2.2.2.2" xref="S3.E2.m2.7.7.1.1.2.2.2.1.cmml"><mo id="S3.E2.m2.7.7.1.1.2.2.2.2.1" stretchy="false" xref="S3.E2.m2.7.7.1.1.2.2.2.1.1.cmml">[</mo><mtext class="ltx_mathvariant_italic" id="S3.E2.m2.4.4" xref="S3.E2.m2.4.4a.cmml">time_T+1</mtext><mo id="S3.E2.m2.7.7.1.1.2.2.2.2.2" stretchy="false" xref="S3.E2.m2.7.7.1.1.2.2.2.1.1.cmml">]</mo></mrow><mo id="S3.E2.m2.7.7.1.1.4.4.6" xref="S3.E2.m2.7.7.1.1.4.5.cmml">,</mo><msubsup id="S3.E2.m2.7.7.1.1.3.3.3" xref="S3.E2.m2.7.7.1.1.3.3.3.cmml"><mi id="S3.E2.m2.7.7.1.1.3.3.3.2.2" xref="S3.E2.m2.7.7.1.1.3.3.3.2.2.cmml">v</mi><mi id="S3.E2.m2.7.7.1.1.3.3.3.2.3" xref="S3.E2.m2.7.7.1.1.3.3.3.2.3.cmml">i</mi><mrow id="S3.E2.m2.2.2.2.2" xref="S3.E2.m2.2.2.2.3.cmml"><mrow id="S3.E2.m2.2.2.2.2.1" xref="S3.E2.m2.2.2.2.2.1.cmml"><mi id="S3.E2.m2.2.2.2.2.1.2" xref="S3.E2.m2.2.2.2.2.1.2.cmml">T</mi><mo id="S3.E2.m2.2.2.2.2.1.1" xref="S3.E2.m2.2.2.2.2.1.1.cmml">+</mo><mn id="S3.E2.m2.2.2.2.2.1.3" xref="S3.E2.m2.2.2.2.2.1.3.cmml">1</mn></mrow><mo id="S3.E2.m2.2.2.2.2.2" xref="S3.E2.m2.2.2.2.3.cmml">,</mo><mn id="S3.E2.m2.1.1.1.1" xref="S3.E2.m2.1.1.1.1.cmml">1</mn></mrow></msubsup><mo id="S3.E2.m2.7.7.1.1.4.4.7" xref="S3.E2.m2.7.7.1.1.4.5.cmml">,</mo><mi id="S3.E2.m2.6.6" mathvariant="normal" xref="S3.E2.m2.6.6.cmml">…</mi><mo id="S3.E2.m2.7.7.1.1.4.4.8" xref="S3.E2.m2.7.7.1.1.4.5.cmml">,</mo><mrow id="S3.E2.m2.7.7.1.1.4.4.4.2" xref="S3.E2.m2.7.7.1.1.4.4.4.1.cmml"><mo id="S3.E2.m2.7.7.1.1.4.4.4.2.1" stretchy="false" xref="S3.E2.m2.7.7.1.1.4.4.4.1.1.cmml">[</mo><mtext class="ltx_mathvariant_italic" id="S3.E2.m2.5.5" xref="S3.E2.m2.5.5a.cmml">eopred</mtext><mo id="S3.E2.m2.7.7.1.1.4.4.4.2.2" stretchy="false" xref="S3.E2.m2.7.7.1.1.4.4.4.1.1.cmml">]</mo></mrow></mrow></mrow><mo id="S3.E2.m2.7.7.1.2" xref="S3.E2.m2.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m2.7b"><apply id="S3.E2.m2.7.7.1.1.cmml" xref="S3.E2.m2.7.7.1"><eq id="S3.E2.m2.7.7.1.1.5.cmml" xref="S3.E2.m2.7.7.1.1.5"></eq><csymbol cd="latexml" id="S3.E2.m2.7.7.1.1.6.cmml" xref="S3.E2.m2.7.7.1.1.6">absent</csymbol><list id="S3.E2.m2.7.7.1.1.4.5.cmml" xref="S3.E2.m2.7.7.1.1.4.4"><apply id="S3.E2.m2.7.7.1.1.1.1.1.1.cmml" xref="S3.E2.m2.7.7.1.1.1.1.1.2"><csymbol cd="latexml" id="S3.E2.m2.7.7.1.1.1.1.1.1.1.cmml" xref="S3.E2.m2.7.7.1.1.1.1.1.2.1">delimited-[]</csymbol><ci id="S3.E2.m2.3.3a.cmml" xref="S3.E2.m2.3.3"><mtext class="ltx_mathvariant_italic" id="S3.E2.m2.3.3.cmml" xref="S3.E2.m2.3.3">pred</mtext></ci></apply><apply id="S3.E2.m2.7.7.1.1.2.2.2.1.cmml" xref="S3.E2.m2.7.7.1.1.2.2.2.2"><csymbol cd="latexml" id="S3.E2.m2.7.7.1.1.2.2.2.1.1.cmml" xref="S3.E2.m2.7.7.1.1.2.2.2.2.1">delimited-[]</csymbol><ci id="S3.E2.m2.4.4a.cmml" xref="S3.E2.m2.4.4"><mtext class="ltx_mathvariant_italic" id="S3.E2.m2.4.4.cmml" xref="S3.E2.m2.4.4">time_T+1</mtext></ci></apply><apply id="S3.E2.m2.7.7.1.1.3.3.3.cmml" xref="S3.E2.m2.7.7.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E2.m2.7.7.1.1.3.3.3.1.cmml" xref="S3.E2.m2.7.7.1.1.3.3.3">superscript</csymbol><apply id="S3.E2.m2.7.7.1.1.3.3.3.2.cmml" xref="S3.E2.m2.7.7.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E2.m2.7.7.1.1.3.3.3.2.1.cmml" xref="S3.E2.m2.7.7.1.1.3.3.3">subscript</csymbol><ci id="S3.E2.m2.7.7.1.1.3.3.3.2.2.cmml" xref="S3.E2.m2.7.7.1.1.3.3.3.2.2">𝑣</ci><ci id="S3.E2.m2.7.7.1.1.3.3.3.2.3.cmml" xref="S3.E2.m2.7.7.1.1.3.3.3.2.3">𝑖</ci></apply><list id="S3.E2.m2.2.2.2.3.cmml" xref="S3.E2.m2.2.2.2.2"><apply id="S3.E2.m2.2.2.2.2.1.cmml" xref="S3.E2.m2.2.2.2.2.1"><plus id="S3.E2.m2.2.2.2.2.1.1.cmml" xref="S3.E2.m2.2.2.2.2.1.1"></plus><ci id="S3.E2.m2.2.2.2.2.1.2.cmml" xref="S3.E2.m2.2.2.2.2.1.2">𝑇</ci><cn id="S3.E2.m2.2.2.2.2.1.3.cmml" type="integer" xref="S3.E2.m2.2.2.2.2.1.3">1</cn></apply><cn id="S3.E2.m2.1.1.1.1.cmml" type="integer" xref="S3.E2.m2.1.1.1.1">1</cn></list></apply><ci id="S3.E2.m2.6.6.cmml" xref="S3.E2.m2.6.6">…</ci><apply id="S3.E2.m2.7.7.1.1.4.4.4.1.cmml" xref="S3.E2.m2.7.7.1.1.4.4.4.2"><csymbol cd="latexml" id="S3.E2.m2.7.7.1.1.4.4.4.1.1.cmml" xref="S3.E2.m2.7.7.1.1.4.4.4.2.1">delimited-[]</csymbol><ci id="S3.E2.m2.5.5a.cmml" xref="S3.E2.m2.5.5"><mtext class="ltx_mathvariant_italic" id="S3.E2.m2.5.5.cmml" xref="S3.E2.m2.5.5">eopred</mtext></ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m2.7c">\displaystyle=[\textit{pred}],[\textit{time\_T+1}],v_{i}^{T+1,1},\ldots,[%
\textit{eopred}],</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m2.7d">= [ pred ] , [ time_T+1 ] , italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T + 1 , 1 end_POSTSUPERSCRIPT , … , [ eopred ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS0.SSS0.Px1.p1.19">where <math alttext="[\textit{hist}]" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px1.p1.13.m1.1"><semantics id="S3.SS0.SSS0.Px1.p1.13.m1.1a"><mrow id="S3.SS0.SSS0.Px1.p1.13.m1.1.2.2" xref="S3.SS0.SSS0.Px1.p1.13.m1.1.2.1.cmml"><mo id="S3.SS0.SSS0.Px1.p1.13.m1.1.2.2.1" stretchy="false" xref="S3.SS0.SSS0.Px1.p1.13.m1.1.2.1.1.cmml">[</mo><mtext class="ltx_mathvariant_italic" id="S3.SS0.SSS0.Px1.p1.13.m1.1.1" xref="S3.SS0.SSS0.Px1.p1.13.m1.1.1a.cmml">hist</mtext><mo id="S3.SS0.SSS0.Px1.p1.13.m1.1.2.2.2" stretchy="false" xref="S3.SS0.SSS0.Px1.p1.13.m1.1.2.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.13.m1.1b"><apply id="S3.SS0.SSS0.Px1.p1.13.m1.1.2.1.cmml" xref="S3.SS0.SSS0.Px1.p1.13.m1.1.2.2"><csymbol cd="latexml" id="S3.SS0.SSS0.Px1.p1.13.m1.1.2.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.13.m1.1.2.2.1">delimited-[]</csymbol><ci id="S3.SS0.SSS0.Px1.p1.13.m1.1.1a.cmml" xref="S3.SS0.SSS0.Px1.p1.13.m1.1.1"><mtext class="ltx_mathvariant_italic" id="S3.SS0.SSS0.Px1.p1.13.m1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.13.m1.1.1">hist</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.13.m1.1c">[\textit{hist}]</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px1.p1.13.m1.1d">[ hist ]</annotation></semantics></math>, <math alttext="[\textit{eohist}]" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px1.p1.14.m2.1"><semantics id="S3.SS0.SSS0.Px1.p1.14.m2.1a"><mrow id="S3.SS0.SSS0.Px1.p1.14.m2.1.2.2" xref="S3.SS0.SSS0.Px1.p1.14.m2.1.2.1.cmml"><mo id="S3.SS0.SSS0.Px1.p1.14.m2.1.2.2.1" stretchy="false" xref="S3.SS0.SSS0.Px1.p1.14.m2.1.2.1.1.cmml">[</mo><mtext class="ltx_mathvariant_italic" id="S3.SS0.SSS0.Px1.p1.14.m2.1.1" xref="S3.SS0.SSS0.Px1.p1.14.m2.1.1a.cmml">eohist</mtext><mo id="S3.SS0.SSS0.Px1.p1.14.m2.1.2.2.2" stretchy="false" xref="S3.SS0.SSS0.Px1.p1.14.m2.1.2.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.14.m2.1b"><apply id="S3.SS0.SSS0.Px1.p1.14.m2.1.2.1.cmml" xref="S3.SS0.SSS0.Px1.p1.14.m2.1.2.2"><csymbol cd="latexml" id="S3.SS0.SSS0.Px1.p1.14.m2.1.2.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.14.m2.1.2.2.1">delimited-[]</csymbol><ci id="S3.SS0.SSS0.Px1.p1.14.m2.1.1a.cmml" xref="S3.SS0.SSS0.Px1.p1.14.m2.1.1"><mtext class="ltx_mathvariant_italic" id="S3.SS0.SSS0.Px1.p1.14.m2.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.14.m2.1.1">eohist</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.14.m2.1c">[\textit{eohist}]</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px1.p1.14.m2.1d">[ eohist ]</annotation></semantics></math>, <math alttext="[\textit{pred}]" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px1.p1.15.m3.1"><semantics id="S3.SS0.SSS0.Px1.p1.15.m3.1a"><mrow id="S3.SS0.SSS0.Px1.p1.15.m3.1.2.2" xref="S3.SS0.SSS0.Px1.p1.15.m3.1.2.1.cmml"><mo id="S3.SS0.SSS0.Px1.p1.15.m3.1.2.2.1" stretchy="false" xref="S3.SS0.SSS0.Px1.p1.15.m3.1.2.1.1.cmml">[</mo><mtext class="ltx_mathvariant_italic" id="S3.SS0.SSS0.Px1.p1.15.m3.1.1" xref="S3.SS0.SSS0.Px1.p1.15.m3.1.1a.cmml">pred</mtext><mo id="S3.SS0.SSS0.Px1.p1.15.m3.1.2.2.2" stretchy="false" xref="S3.SS0.SSS0.Px1.p1.15.m3.1.2.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.15.m3.1b"><apply id="S3.SS0.SSS0.Px1.p1.15.m3.1.2.1.cmml" xref="S3.SS0.SSS0.Px1.p1.15.m3.1.2.2"><csymbol cd="latexml" id="S3.SS0.SSS0.Px1.p1.15.m3.1.2.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.15.m3.1.2.2.1">delimited-[]</csymbol><ci id="S3.SS0.SSS0.Px1.p1.15.m3.1.1a.cmml" xref="S3.SS0.SSS0.Px1.p1.15.m3.1.1"><mtext class="ltx_mathvariant_italic" id="S3.SS0.SSS0.Px1.p1.15.m3.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.15.m3.1.1">pred</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.15.m3.1c">[\textit{pred}]</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px1.p1.15.m3.1d">[ pred ]</annotation></semantics></math>, <math alttext="[\textit{eopred}]" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px1.p1.16.m4.1"><semantics id="S3.SS0.SSS0.Px1.p1.16.m4.1a"><mrow id="S3.SS0.SSS0.Px1.p1.16.m4.1.2.2" xref="S3.SS0.SSS0.Px1.p1.16.m4.1.2.1.cmml"><mo id="S3.SS0.SSS0.Px1.p1.16.m4.1.2.2.1" stretchy="false" xref="S3.SS0.SSS0.Px1.p1.16.m4.1.2.1.1.cmml">[</mo><mtext class="ltx_mathvariant_italic" id="S3.SS0.SSS0.Px1.p1.16.m4.1.1" xref="S3.SS0.SSS0.Px1.p1.16.m4.1.1a.cmml">eopred</mtext><mo id="S3.SS0.SSS0.Px1.p1.16.m4.1.2.2.2" stretchy="false" xref="S3.SS0.SSS0.Px1.p1.16.m4.1.2.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.16.m4.1b"><apply id="S3.SS0.SSS0.Px1.p1.16.m4.1.2.1.cmml" xref="S3.SS0.SSS0.Px1.p1.16.m4.1.2.2"><csymbol cd="latexml" id="S3.SS0.SSS0.Px1.p1.16.m4.1.2.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.16.m4.1.2.2.1">delimited-[]</csymbol><ci id="S3.SS0.SSS0.Px1.p1.16.m4.1.1a.cmml" xref="S3.SS0.SSS0.Px1.p1.16.m4.1.1"><mtext class="ltx_mathvariant_italic" id="S3.SS0.SSS0.Px1.p1.16.m4.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.16.m4.1.1">eopred</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.16.m4.1c">[\textit{eopred}]</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px1.p1.16.m4.1d">[ eopred ]</annotation></semantics></math> are special tokens denoting the input and output sequence, and <math alttext="[\textit{time\_1}]" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px1.p1.17.m5.1"><semantics id="S3.SS0.SSS0.Px1.p1.17.m5.1a"><mrow id="S3.SS0.SSS0.Px1.p1.17.m5.1.2.2" xref="S3.SS0.SSS0.Px1.p1.17.m5.1.2.1.cmml"><mo id="S3.SS0.SSS0.Px1.p1.17.m5.1.2.2.1" stretchy="false" xref="S3.SS0.SSS0.Px1.p1.17.m5.1.2.1.1.cmml">[</mo><mtext class="ltx_mathvariant_italic" id="S3.SS0.SSS0.Px1.p1.17.m5.1.1" xref="S3.SS0.SSS0.Px1.p1.17.m5.1.1a.cmml">time_1</mtext><mo id="S3.SS0.SSS0.Px1.p1.17.m5.1.2.2.2" stretchy="false" xref="S3.SS0.SSS0.Px1.p1.17.m5.1.2.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.17.m5.1b"><apply id="S3.SS0.SSS0.Px1.p1.17.m5.1.2.1.cmml" xref="S3.SS0.SSS0.Px1.p1.17.m5.1.2.2"><csymbol cd="latexml" id="S3.SS0.SSS0.Px1.p1.17.m5.1.2.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.17.m5.1.2.2.1">delimited-[]</csymbol><ci id="S3.SS0.SSS0.Px1.p1.17.m5.1.1a.cmml" xref="S3.SS0.SSS0.Px1.p1.17.m5.1.1"><mtext class="ltx_mathvariant_italic" id="S3.SS0.SSS0.Px1.p1.17.m5.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.17.m5.1.1">time_1</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.17.m5.1c">[\textit{time\_1}]</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px1.p1.17.m5.1d">[ time_1 ]</annotation></semantics></math>, <math alttext="\dots" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px1.p1.18.m6.1"><semantics id="S3.SS0.SSS0.Px1.p1.18.m6.1a"><mi id="S3.SS0.SSS0.Px1.p1.18.m6.1.1" mathvariant="normal" xref="S3.SS0.SSS0.Px1.p1.18.m6.1.1.cmml">…</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.18.m6.1b"><ci id="S3.SS0.SSS0.Px1.p1.18.m6.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.18.m6.1.1">…</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.18.m6.1c">\dots</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px1.p1.18.m6.1d">…</annotation></semantics></math>, <math alttext="[\textit{time\_T+1}]" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px1.p1.19.m7.1"><semantics id="S3.SS0.SSS0.Px1.p1.19.m7.1a"><mrow id="S3.SS0.SSS0.Px1.p1.19.m7.1.2.2" xref="S3.SS0.SSS0.Px1.p1.19.m7.1.2.1.cmml"><mo id="S3.SS0.SSS0.Px1.p1.19.m7.1.2.2.1" stretchy="false" xref="S3.SS0.SSS0.Px1.p1.19.m7.1.2.1.1.cmml">[</mo><mtext class="ltx_mathvariant_italic" id="S3.SS0.SSS0.Px1.p1.19.m7.1.1" xref="S3.SS0.SSS0.Px1.p1.19.m7.1.1a.cmml">time_T+1</mtext><mo id="S3.SS0.SSS0.Px1.p1.19.m7.1.2.2.2" stretchy="false" xref="S3.SS0.SSS0.Px1.p1.19.m7.1.2.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.19.m7.1b"><apply id="S3.SS0.SSS0.Px1.p1.19.m7.1.2.1.cmml" xref="S3.SS0.SSS0.Px1.p1.19.m7.1.2.2"><csymbol cd="latexml" id="S3.SS0.SSS0.Px1.p1.19.m7.1.2.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.19.m7.1.2.2.1">delimited-[]</csymbol><ci id="S3.SS0.SSS0.Px1.p1.19.m7.1.1a.cmml" xref="S3.SS0.SSS0.Px1.p1.19.m7.1.1"><mtext class="ltx_mathvariant_italic" id="S3.SS0.SSS0.Px1.p1.19.m7.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.19.m7.1.1">time_T+1</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.19.m7.1c">[\textit{time\_T+1}]</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px1.p1.19.m7.1d">[ time_T+1 ]</annotation></semantics></math> are special time tokens representing different time steps.</p>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS0.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Problem Formulation.</h5>
<div class="ltx_para" id="S3.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="S3.SS0.SSS0.Px2.p1.3">Dynamic graph modeling aims to learn a model that can predict the future interactions of a target node <math alttext="v_{i}" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px2.p1.1.m1.1"><semantics id="S3.SS0.SSS0.Px2.p1.1.m1.1a"><msub id="S3.SS0.SSS0.Px2.p1.1.m1.1.1" xref="S3.SS0.SSS0.Px2.p1.1.m1.1.1.cmml"><mi id="S3.SS0.SSS0.Px2.p1.1.m1.1.1.2" xref="S3.SS0.SSS0.Px2.p1.1.m1.1.1.2.cmml">v</mi><mi id="S3.SS0.SSS0.Px2.p1.1.m1.1.1.3" xref="S3.SS0.SSS0.Px2.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p1.1.m1.1b"><apply id="S3.SS0.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p1.1.m1.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p1.1.m1.1.1.2">𝑣</ci><ci id="S3.SS0.SSS0.Px2.p1.1.m1.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p1.1.m1.1c">v_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px2.p1.1.m1.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, given its historical interactions. That is, given <math alttext="x_{i}" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px2.p1.2.m2.1"><semantics id="S3.SS0.SSS0.Px2.p1.2.m2.1a"><msub id="S3.SS0.SSS0.Px2.p1.2.m2.1.1" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.cmml"><mi id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.2" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.2.cmml">x</mi><mi id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.3" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p1.2.m2.1b"><apply id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.2">𝑥</ci><ci id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p1.2.m2.1c">x_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px2.p1.2.m2.1d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> in Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#S3.E1" title="In Sequence Mapping of Dynamic Graphs. ‣ 3 Preliminaries ‣ Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_tag">1</span></a>), the task is to predict <math alttext="y_{i}" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px2.p1.3.m3.1"><semantics id="S3.SS0.SSS0.Px2.p1.3.m3.1a"><msub id="S3.SS0.SSS0.Px2.p1.3.m3.1.1" xref="S3.SS0.SSS0.Px2.p1.3.m3.1.1.cmml"><mi id="S3.SS0.SSS0.Px2.p1.3.m3.1.1.2" xref="S3.SS0.SSS0.Px2.p1.3.m3.1.1.2.cmml">y</mi><mi id="S3.SS0.SSS0.Px2.p1.3.m3.1.1.3" xref="S3.SS0.SSS0.Px2.p1.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p1.3.m3.1b"><apply id="S3.SS0.SSS0.Px2.p1.3.m3.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p1.3.m3.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m3.1.1.2">𝑦</ci><ci id="S3.SS0.SSS0.Px2.p1.3.m3.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p1.3.m3.1c">y_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px2.p1.3.m3.1d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> in Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#S3.E2" title="In Sequence Mapping of Dynamic Graphs. ‣ 3 Preliminaries ‣ Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_tag">2</span></a>).</p>
</div>
<div class="ltx_para" id="S3.SS0.SSS0.Px2.p2">
<p class="ltx_p" id="S3.SS0.SSS0.Px2.p2.11">In our RAG framework, we regard the
training samples <math alttext="D" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px2.p2.1.m1.1"><semantics id="S3.SS0.SSS0.Px2.p2.1.m1.1a"><mi id="S3.SS0.SSS0.Px2.p2.1.m1.1.1" xref="S3.SS0.SSS0.Px2.p2.1.m1.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p2.1.m1.1b"><ci id="S3.SS0.SSS0.Px2.p2.1.m1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p2.1.m1.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p2.1.m1.1c">D</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px2.p2.1.m1.1d">italic_D</annotation></semantics></math> as a retrieval pool.
Given a target node <math alttext="v_{q}\in V" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px2.p2.2.m2.1"><semantics id="S3.SS0.SSS0.Px2.p2.2.m2.1a"><mrow id="S3.SS0.SSS0.Px2.p2.2.m2.1.1" xref="S3.SS0.SSS0.Px2.p2.2.m2.1.1.cmml"><msub id="S3.SS0.SSS0.Px2.p2.2.m2.1.1.2" xref="S3.SS0.SSS0.Px2.p2.2.m2.1.1.2.cmml"><mi id="S3.SS0.SSS0.Px2.p2.2.m2.1.1.2.2" xref="S3.SS0.SSS0.Px2.p2.2.m2.1.1.2.2.cmml">v</mi><mi id="S3.SS0.SSS0.Px2.p2.2.m2.1.1.2.3" xref="S3.SS0.SSS0.Px2.p2.2.m2.1.1.2.3.cmml">q</mi></msub><mo id="S3.SS0.SSS0.Px2.p2.2.m2.1.1.1" xref="S3.SS0.SSS0.Px2.p2.2.m2.1.1.1.cmml">∈</mo><mi id="S3.SS0.SSS0.Px2.p2.2.m2.1.1.3" xref="S3.SS0.SSS0.Px2.p2.2.m2.1.1.3.cmml">V</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p2.2.m2.1b"><apply id="S3.SS0.SSS0.Px2.p2.2.m2.1.1.cmml" xref="S3.SS0.SSS0.Px2.p2.2.m2.1.1"><in id="S3.SS0.SSS0.Px2.p2.2.m2.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p2.2.m2.1.1.1"></in><apply id="S3.SS0.SSS0.Px2.p2.2.m2.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p2.2.m2.1.1.2.1.cmml" xref="S3.SS0.SSS0.Px2.p2.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p2.2.m2.1.1.2.2.cmml" xref="S3.SS0.SSS0.Px2.p2.2.m2.1.1.2.2">𝑣</ci><ci id="S3.SS0.SSS0.Px2.p2.2.m2.1.1.2.3.cmml" xref="S3.SS0.SSS0.Px2.p2.2.m2.1.1.2.3">𝑞</ci></apply><ci id="S3.SS0.SSS0.Px2.p2.2.m2.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p2.2.m2.1.1.3">𝑉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p2.2.m2.1c">v_{q}\in V</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px2.p2.2.m2.1d">italic_v start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ∈ italic_V</annotation></semantics></math>, its input sequence <math alttext="x_{q}" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px2.p2.3.m3.1"><semantics id="S3.SS0.SSS0.Px2.p2.3.m3.1a"><msub id="S3.SS0.SSS0.Px2.p2.3.m3.1.1" xref="S3.SS0.SSS0.Px2.p2.3.m3.1.1.cmml"><mi id="S3.SS0.SSS0.Px2.p2.3.m3.1.1.2" xref="S3.SS0.SSS0.Px2.p2.3.m3.1.1.2.cmml">x</mi><mi id="S3.SS0.SSS0.Px2.p2.3.m3.1.1.3" xref="S3.SS0.SSS0.Px2.p2.3.m3.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p2.3.m3.1b"><apply id="S3.SS0.SSS0.Px2.p2.3.m3.1.1.cmml" xref="S3.SS0.SSS0.Px2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p2.3.m3.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p2.3.m3.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p2.3.m3.1.1.2">𝑥</ci><ci id="S3.SS0.SSS0.Px2.p2.3.m3.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p2.3.m3.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p2.3.m3.1c">x_{q}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px2.p2.3.m3.1d">italic_x start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> is referred to as the <em class="ltx_emph ltx_font_italic" id="S3.SS0.SSS0.Px2.p2.11.1">query sequence</em>. We first retrieve <math alttext="K" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px2.p2.4.m4.1"><semantics id="S3.SS0.SSS0.Px2.p2.4.m4.1a"><mi id="S3.SS0.SSS0.Px2.p2.4.m4.1.1" xref="S3.SS0.SSS0.Px2.p2.4.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p2.4.m4.1b"><ci id="S3.SS0.SSS0.Px2.p2.4.m4.1.1.cmml" xref="S3.SS0.SSS0.Px2.p2.4.m4.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p2.4.m4.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px2.p2.4.m4.1d">italic_K</annotation></semantics></math> demonstrations <math alttext="R_{q}=\{(x_{k},y_{k})\}_{k=1}^{K}" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px2.p2.5.m5.1"><semantics id="S3.SS0.SSS0.Px2.p2.5.m5.1a"><mrow id="S3.SS0.SSS0.Px2.p2.5.m5.1.1" xref="S3.SS0.SSS0.Px2.p2.5.m5.1.1.cmml"><msub id="S3.SS0.SSS0.Px2.p2.5.m5.1.1.3" xref="S3.SS0.SSS0.Px2.p2.5.m5.1.1.3.cmml"><mi id="S3.SS0.SSS0.Px2.p2.5.m5.1.1.3.2" xref="S3.SS0.SSS0.Px2.p2.5.m5.1.1.3.2.cmml">R</mi><mi id="S3.SS0.SSS0.Px2.p2.5.m5.1.1.3.3" xref="S3.SS0.SSS0.Px2.p2.5.m5.1.1.3.3.cmml">q</mi></msub><mo id="S3.SS0.SSS0.Px2.p2.5.m5.1.1.2" xref="S3.SS0.SSS0.Px2.p2.5.m5.1.1.2.cmml">=</mo><msubsup id="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1" xref="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.cmml"><mrow id="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.1.1.1" xref="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.1.1.2.cmml"><mo id="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.1.1.2.cmml">{</mo><mrow id="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.1.1.1.1.2" xref="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.1.1.1.1.3.cmml"><mo id="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.1.1.1.1.2.3" stretchy="false" xref="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.1.1.1.1.3.cmml">(</mo><msub id="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.1.1.1.1.1.1" xref="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.1.1.1.1.1.1.2" xref="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.1.1.1.1.1.1.3" xref="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.1.1.1.1.2.4" xref="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.1.1.1.1.3.cmml">,</mo><msub id="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.1.1.1.1.2.2" xref="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.1.1.1.1.2.2.2" xref="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.1.1.1.1.2.2.2.cmml">y</mi><mi id="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.1.1.1.1.2.2.3" xref="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.1.1.1.1.2.2.3.cmml">k</mi></msub><mo id="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.1.1.1.1.2.5" stretchy="false" xref="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo id="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.1.3" xref="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.1.3.cmml"><mi id="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.1.3.2" xref="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.1.3.2.cmml">k</mi><mo id="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.1.3.1" xref="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.1.3.1.cmml">=</mo><mn id="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.1.3.3" xref="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.3" xref="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.3.cmml">K</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p2.5.m5.1b"><apply id="S3.SS0.SSS0.Px2.p2.5.m5.1.1.cmml" xref="S3.SS0.SSS0.Px2.p2.5.m5.1.1"><eq id="S3.SS0.SSS0.Px2.p2.5.m5.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p2.5.m5.1.1.2"></eq><apply id="S3.SS0.SSS0.Px2.p2.5.m5.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p2.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p2.5.m5.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px2.p2.5.m5.1.1.3">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p2.5.m5.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px2.p2.5.m5.1.1.3.2">𝑅</ci><ci id="S3.SS0.SSS0.Px2.p2.5.m5.1.1.3.3.cmml" xref="S3.SS0.SSS0.Px2.p2.5.m5.1.1.3.3">𝑞</ci></apply><apply id="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1">superscript</csymbol><apply id="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1">subscript</csymbol><set id="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.1.1.1"><interval closure="open" id="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.1.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.1.1.1.1.2"><apply id="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.1.1.1.1.2.2.2">𝑦</ci><ci id="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.1.1.1.1.2.2.3">𝑘</ci></apply></interval></set><apply id="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.1.3"><eq id="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.1.3.1"></eq><ci id="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.1.3.2">𝑘</ci><cn id="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.1.3.3.cmml" type="integer" xref="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p2.5.m5.1.1.1.3">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p2.5.m5.1c">R_{q}=\{(x_{k},y_{k})\}_{k=1}^{K}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px2.p2.5.m5.1d">italic_R start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT = { ( italic_x start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) } start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT</annotation></semantics></math> for each query sequence <math alttext="x_{q}" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px2.p2.6.m6.1"><semantics id="S3.SS0.SSS0.Px2.p2.6.m6.1a"><msub id="S3.SS0.SSS0.Px2.p2.6.m6.1.1" xref="S3.SS0.SSS0.Px2.p2.6.m6.1.1.cmml"><mi id="S3.SS0.SSS0.Px2.p2.6.m6.1.1.2" xref="S3.SS0.SSS0.Px2.p2.6.m6.1.1.2.cmml">x</mi><mi id="S3.SS0.SSS0.Px2.p2.6.m6.1.1.3" xref="S3.SS0.SSS0.Px2.p2.6.m6.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p2.6.m6.1b"><apply id="S3.SS0.SSS0.Px2.p2.6.m6.1.1.cmml" xref="S3.SS0.SSS0.Px2.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p2.6.m6.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p2.6.m6.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p2.6.m6.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p2.6.m6.1.1.2">𝑥</ci><ci id="S3.SS0.SSS0.Px2.p2.6.m6.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p2.6.m6.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p2.6.m6.1c">x_{q}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px2.p2.6.m6.1d">italic_x start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> based on their contextual and temporal relevance. Next, the retrieved demonstrations <math alttext="R_{q}" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px2.p2.7.m7.1"><semantics id="S3.SS0.SSS0.Px2.p2.7.m7.1a"><msub id="S3.SS0.SSS0.Px2.p2.7.m7.1.1" xref="S3.SS0.SSS0.Px2.p2.7.m7.1.1.cmml"><mi id="S3.SS0.SSS0.Px2.p2.7.m7.1.1.2" xref="S3.SS0.SSS0.Px2.p2.7.m7.1.1.2.cmml">R</mi><mi id="S3.SS0.SSS0.Px2.p2.7.m7.1.1.3" xref="S3.SS0.SSS0.Px2.p2.7.m7.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p2.7.m7.1b"><apply id="S3.SS0.SSS0.Px2.p2.7.m7.1.1.cmml" xref="S3.SS0.SSS0.Px2.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p2.7.m7.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p2.7.m7.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p2.7.m7.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p2.7.m7.1.1.2">𝑅</ci><ci id="S3.SS0.SSS0.Px2.p2.7.m7.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p2.7.m7.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p2.7.m7.1c">R_{q}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px2.p2.7.m7.1d">italic_R start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> are used to enrich the input sequence <math alttext="x_{q}" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px2.p2.8.m8.1"><semantics id="S3.SS0.SSS0.Px2.p2.8.m8.1a"><msub id="S3.SS0.SSS0.Px2.p2.8.m8.1.1" xref="S3.SS0.SSS0.Px2.p2.8.m8.1.1.cmml"><mi id="S3.SS0.SSS0.Px2.p2.8.m8.1.1.2" xref="S3.SS0.SSS0.Px2.p2.8.m8.1.1.2.cmml">x</mi><mi id="S3.SS0.SSS0.Px2.p2.8.m8.1.1.3" xref="S3.SS0.SSS0.Px2.p2.8.m8.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p2.8.m8.1b"><apply id="S3.SS0.SSS0.Px2.p2.8.m8.1.1.cmml" xref="S3.SS0.SSS0.Px2.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p2.8.m8.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p2.8.m8.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p2.8.m8.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p2.8.m8.1.1.2">𝑥</ci><ci id="S3.SS0.SSS0.Px2.p2.8.m8.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p2.8.m8.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p2.8.m8.1c">x_{q}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px2.p2.8.m8.1d">italic_x start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math>, which encompasses the historical interactions of the target node <math alttext="v_{q}" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px2.p2.9.m9.1"><semantics id="S3.SS0.SSS0.Px2.p2.9.m9.1a"><msub id="S3.SS0.SSS0.Px2.p2.9.m9.1.1" xref="S3.SS0.SSS0.Px2.p2.9.m9.1.1.cmml"><mi id="S3.SS0.SSS0.Px2.p2.9.m9.1.1.2" xref="S3.SS0.SSS0.Px2.p2.9.m9.1.1.2.cmml">v</mi><mi id="S3.SS0.SSS0.Px2.p2.9.m9.1.1.3" xref="S3.SS0.SSS0.Px2.p2.9.m9.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p2.9.m9.1b"><apply id="S3.SS0.SSS0.Px2.p2.9.m9.1.1.cmml" xref="S3.SS0.SSS0.Px2.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p2.9.m9.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p2.9.m9.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p2.9.m9.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p2.9.m9.1.1.2">𝑣</ci><ci id="S3.SS0.SSS0.Px2.p2.9.m9.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p2.9.m9.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p2.9.m9.1c">v_{q}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px2.p2.9.m9.1d">italic_v start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math>. The augmented input <math alttext="\{R_{q},x_{q}\}" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px2.p2.10.m10.2"><semantics id="S3.SS0.SSS0.Px2.p2.10.m10.2a"><mrow id="S3.SS0.SSS0.Px2.p2.10.m10.2.2.2" xref="S3.SS0.SSS0.Px2.p2.10.m10.2.2.3.cmml"><mo id="S3.SS0.SSS0.Px2.p2.10.m10.2.2.2.3" stretchy="false" xref="S3.SS0.SSS0.Px2.p2.10.m10.2.2.3.cmml">{</mo><msub id="S3.SS0.SSS0.Px2.p2.10.m10.1.1.1.1" xref="S3.SS0.SSS0.Px2.p2.10.m10.1.1.1.1.cmml"><mi id="S3.SS0.SSS0.Px2.p2.10.m10.1.1.1.1.2" xref="S3.SS0.SSS0.Px2.p2.10.m10.1.1.1.1.2.cmml">R</mi><mi id="S3.SS0.SSS0.Px2.p2.10.m10.1.1.1.1.3" xref="S3.SS0.SSS0.Px2.p2.10.m10.1.1.1.1.3.cmml">q</mi></msub><mo id="S3.SS0.SSS0.Px2.p2.10.m10.2.2.2.4" xref="S3.SS0.SSS0.Px2.p2.10.m10.2.2.3.cmml">,</mo><msub id="S3.SS0.SSS0.Px2.p2.10.m10.2.2.2.2" xref="S3.SS0.SSS0.Px2.p2.10.m10.2.2.2.2.cmml"><mi id="S3.SS0.SSS0.Px2.p2.10.m10.2.2.2.2.2" xref="S3.SS0.SSS0.Px2.p2.10.m10.2.2.2.2.2.cmml">x</mi><mi id="S3.SS0.SSS0.Px2.p2.10.m10.2.2.2.2.3" xref="S3.SS0.SSS0.Px2.p2.10.m10.2.2.2.2.3.cmml">q</mi></msub><mo id="S3.SS0.SSS0.Px2.p2.10.m10.2.2.2.5" stretchy="false" xref="S3.SS0.SSS0.Px2.p2.10.m10.2.2.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p2.10.m10.2b"><set id="S3.SS0.SSS0.Px2.p2.10.m10.2.2.3.cmml" xref="S3.SS0.SSS0.Px2.p2.10.m10.2.2.2"><apply id="S3.SS0.SSS0.Px2.p2.10.m10.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p2.10.m10.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p2.10.m10.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p2.10.m10.1.1.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p2.10.m10.1.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p2.10.m10.1.1.1.1.2">𝑅</ci><ci id="S3.SS0.SSS0.Px2.p2.10.m10.1.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p2.10.m10.1.1.1.1.3">𝑞</ci></apply><apply id="S3.SS0.SSS0.Px2.p2.10.m10.2.2.2.2.cmml" xref="S3.SS0.SSS0.Px2.p2.10.m10.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p2.10.m10.2.2.2.2.1.cmml" xref="S3.SS0.SSS0.Px2.p2.10.m10.2.2.2.2">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p2.10.m10.2.2.2.2.2.cmml" xref="S3.SS0.SSS0.Px2.p2.10.m10.2.2.2.2.2">𝑥</ci><ci id="S3.SS0.SSS0.Px2.p2.10.m10.2.2.2.2.3.cmml" xref="S3.SS0.SSS0.Px2.p2.10.m10.2.2.2.2.3">𝑞</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p2.10.m10.2c">\{R_{q},x_{q}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px2.p2.10.m10.2d">{ italic_R start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT }</annotation></semantics></math> is designed to enhance the predictions of future events in <math alttext="y_{q}" class="ltx_Math" display="inline" id="S3.SS0.SSS0.Px2.p2.11.m11.1"><semantics id="S3.SS0.SSS0.Px2.p2.11.m11.1a"><msub id="S3.SS0.SSS0.Px2.p2.11.m11.1.1" xref="S3.SS0.SSS0.Px2.p2.11.m11.1.1.cmml"><mi id="S3.SS0.SSS0.Px2.p2.11.m11.1.1.2" xref="S3.SS0.SSS0.Px2.p2.11.m11.1.1.2.cmml">y</mi><mi id="S3.SS0.SSS0.Px2.p2.11.m11.1.1.3" xref="S3.SS0.SSS0.Px2.p2.11.m11.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p2.11.m11.1b"><apply id="S3.SS0.SSS0.Px2.p2.11.m11.1.1.cmml" xref="S3.SS0.SSS0.Px2.p2.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px2.p2.11.m11.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p2.11.m11.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px2.p2.11.m11.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p2.11.m11.1.1.2">𝑦</ci><ci id="S3.SS0.SSS0.Px2.p2.11.m11.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p2.11.m11.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p2.11.m11.1c">y_{q}</annotation><annotation encoding="application/x-llamapun" id="S3.SS0.SSS0.Px2.p2.11.m11.1d">italic_y start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Proposed Model: RAG4DyG</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">Our proposed RAG4DyG framework, depicted in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#S1.F2" title="Figure 2 ‣ 1 Introduction ‣ Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_tag">2</span></a>, first trains a generative sequence model for dynamic graphs in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#S1.F2" title="Figure 2 ‣ 1 Introduction ‣ Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_tag">2</span></a>(a). We use SimpleDyG <cite class="ltx_cite ltx_citemacro_citep">(Wu, Fang, and Liao <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib29" title="">2024</a>)</cite> as the backbone for this task. As described in Sect. <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#S3" title="3 Preliminaries ‣ Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_tag">3</span></a>, a dynamic graph <math alttext="G" class="ltx_Math" display="inline" id="S4.p1.1.m1.1"><semantics id="S4.p1.1.m1.1a"><mi id="S4.p1.1.m1.1.1" xref="S4.p1.1.m1.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S4.p1.1.m1.1b"><ci id="S4.p1.1.m1.1.1.cmml" xref="S4.p1.1.m1.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.1.m1.1c">G</annotation><annotation encoding="application/x-llamapun" id="S4.p1.1.m1.1d">italic_G</annotation></semantics></math> is represented as sequences of node interaction records, which are then used to train a Transformer-based sequence model.</p>
</div>
<div class="ltx_para" id="S4.p2">
<p class="ltx_p" id="S4.p2.4">Next, given a query sequence <math alttext="x_{q}" class="ltx_Math" display="inline" id="S4.p2.1.m1.1"><semantics id="S4.p2.1.m1.1a"><msub id="S4.p2.1.m1.1.1" xref="S4.p2.1.m1.1.1.cmml"><mi id="S4.p2.1.m1.1.1.2" xref="S4.p2.1.m1.1.1.2.cmml">x</mi><mi id="S4.p2.1.m1.1.1.3" xref="S4.p2.1.m1.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p2.1.m1.1b"><apply id="S4.p2.1.m1.1.1.cmml" xref="S4.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.p2.1.m1.1.1.1.cmml" xref="S4.p2.1.m1.1.1">subscript</csymbol><ci id="S4.p2.1.m1.1.1.2.cmml" xref="S4.p2.1.m1.1.1.2">𝑥</ci><ci id="S4.p2.1.m1.1.1.3.cmml" xref="S4.p2.1.m1.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.1.m1.1c">x_{q}</annotation><annotation encoding="application/x-llamapun" id="S4.p2.1.m1.1d">italic_x start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> and a retrieval pool <math alttext="D" class="ltx_Math" display="inline" id="S4.p2.2.m2.1"><semantics id="S4.p2.2.m2.1a"><mi id="S4.p2.2.m2.1.1" xref="S4.p2.2.m2.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S4.p2.2.m2.1b"><ci id="S4.p2.2.m2.1.1.cmml" xref="S4.p2.2.m2.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.2.m2.1c">D</annotation><annotation encoding="application/x-llamapun" id="S4.p2.2.m2.1d">italic_D</annotation></semantics></math>, a time- and context-aware retriever is designed to retrieve demonstrations for <math alttext="x_{q}" class="ltx_Math" display="inline" id="S4.p2.3.m3.1"><semantics id="S4.p2.3.m3.1a"><msub id="S4.p2.3.m3.1.1" xref="S4.p2.3.m3.1.1.cmml"><mi id="S4.p2.3.m3.1.1.2" xref="S4.p2.3.m3.1.1.2.cmml">x</mi><mi id="S4.p2.3.m3.1.1.3" xref="S4.p2.3.m3.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p2.3.m3.1b"><apply id="S4.p2.3.m3.1.1.cmml" xref="S4.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.p2.3.m3.1.1.1.cmml" xref="S4.p2.3.m3.1.1">subscript</csymbol><ci id="S4.p2.3.m3.1.1.2.cmml" xref="S4.p2.3.m3.1.1.2">𝑥</ci><ci id="S4.p2.3.m3.1.1.3.cmml" xref="S4.p2.3.m3.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.3.m3.1c">x_{q}</annotation><annotation encoding="application/x-llamapun" id="S4.p2.3.m3.1d">italic_x start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> from <math alttext="D" class="ltx_Math" display="inline" id="S4.p2.4.m4.1"><semantics id="S4.p2.4.m4.1a"><mi id="S4.p2.4.m4.1.1" xref="S4.p2.4.m4.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S4.p2.4.m4.1b"><ci id="S4.p2.4.m4.1.1.cmml" xref="S4.p2.4.m4.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.4.m4.1c">D</annotation><annotation encoding="application/x-llamapun" id="S4.p2.4.m4.1d">italic_D</annotation></semantics></math>, as shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#S1.F2" title="Figure 2 ‣ 1 Introduction ‣ Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_tag">2</span></a>(b). The retriever fine-tunes its encoder (<span class="ltx_text ltx_font_italic" id="S4.p2.4.1">i.e.</span>, the sequence model) to jointly optimize two contrastive losses: a time-aware loss that employs a time decay function, and a context-aware loss that employs sequence augmentation. (Sect. <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#S4.SS1" title="4.1 Time- and Context-Aware Retriever ‣ 4 Proposed Model: RAG4DyG ‣ Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_tag">4.1</span></a>)</p>
</div>
<div class="ltx_para" id="S4.p3">
<p class="ltx_p" id="S4.p3.1">Finally, given top-<span class="ltx_text ltx_font_italic" id="S4.p3.1.1">K</span> demonstrations retrieved from the retrieval pool, we design a graph fusion module as illustrated in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#S1.F2" title="Figure 2 ‣ 1 Introduction ‣ Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_tag">2</span></a>(c). Specifically, we fuse the <span class="ltx_text ltx_font_italic" id="S4.p3.1.2">K</span> demonstrations into a summary graph, leveraging the graph structures inherent to the retrieved demonstrations. The summary graph is further encoded by a GNN, serving as an augmented context that is prepended to the original query sequence. The augmented sequence is subsequently input to the sequence model to predict future events. (Sect. <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#S4.SS2" title="4.2 Graph Fusion-based Generator ‣ 4 Proposed Model: RAG4DyG ‣ Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_tag">4.2</span></a>)</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Time- and Context-Aware Retriever</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">Unlike NLP retrievers, dynamic graph retrieval requires consideration of temporal proximity alongside contextual relevance. To address this, we propose a time- and context-aware retrieval model with two contrastive learning modules. First, we incorporate a time decay mechanism to account for temporal proximity between query and candidate sequences. Second, we use sequence augmentation to capture intrinsic contextual patterns.</p>
</div>
<section class="ltx_paragraph" id="S4.SS1.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Retrieval Annotation.</h5>
<div class="ltx_para" id="S4.SS1.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS1.SSS0.Px1.p1.6">To facilitate contrastive training, we automatically annotate the samples in the retrieval pool <math alttext="D" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p1.1.m1.1"><semantics id="S4.SS1.SSS0.Px1.p1.1.m1.1a"><mi id="S4.SS1.SSS0.Px1.p1.1.m1.1.1" xref="S4.SS1.SSS0.Px1.p1.1.m1.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.1.m1.1b"><ci id="S4.SS1.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.1.m1.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.1.m1.1c">D</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p1.1.m1.1d">italic_D</annotation></semantics></math>. For each query sequence <math alttext="x_{q}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p1.2.m2.1"><semantics id="S4.SS1.SSS0.Px1.p1.2.m2.1a"><msub id="S4.SS1.SSS0.Px1.p1.2.m2.1.1" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1.cmml"><mi id="S4.SS1.SSS0.Px1.p1.2.m2.1.1.2" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1.2.cmml">x</mi><mi id="S4.SS1.SSS0.Px1.p1.2.m2.1.1.3" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.2.m2.1b"><apply id="S4.SS1.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px1.p1.2.m2.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1.2">𝑥</ci><ci id="S4.SS1.SSS0.Px1.p1.2.m2.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.2.m2.1c">x_{q}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p1.2.m2.1d">italic_x start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math>, we annotate its positive sample <math alttext="x_{p}^{+}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p1.3.m3.1"><semantics id="S4.SS1.SSS0.Px1.p1.3.m3.1a"><msubsup id="S4.SS1.SSS0.Px1.p1.3.m3.1.1" xref="S4.SS1.SSS0.Px1.p1.3.m3.1.1.cmml"><mi id="S4.SS1.SSS0.Px1.p1.3.m3.1.1.2.2" xref="S4.SS1.SSS0.Px1.p1.3.m3.1.1.2.2.cmml">x</mi><mi id="S4.SS1.SSS0.Px1.p1.3.m3.1.1.2.3" xref="S4.SS1.SSS0.Px1.p1.3.m3.1.1.2.3.cmml">p</mi><mo id="S4.SS1.SSS0.Px1.p1.3.m3.1.1.3" xref="S4.SS1.SSS0.Px1.p1.3.m3.1.1.3.cmml">+</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.3.m3.1b"><apply id="S4.SS1.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.3.m3.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.3.m3.1.1">superscript</csymbol><apply id="S4.SS1.SSS0.Px1.p1.3.m3.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.3.m3.1.1.2.1.cmml" xref="S4.SS1.SSS0.Px1.p1.3.m3.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px1.p1.3.m3.1.1.2.2.cmml" xref="S4.SS1.SSS0.Px1.p1.3.m3.1.1.2.2">𝑥</ci><ci id="S4.SS1.SSS0.Px1.p1.3.m3.1.1.2.3.cmml" xref="S4.SS1.SSS0.Px1.p1.3.m3.1.1.2.3">𝑝</ci></apply><plus id="S4.SS1.SSS0.Px1.p1.3.m3.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p1.3.m3.1.1.3"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.3.m3.1c">x_{p}^{+}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p1.3.m3.1d">italic_x start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT</annotation></semantics></math> from the pool <math alttext="D" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p1.4.m4.1"><semantics id="S4.SS1.SSS0.Px1.p1.4.m4.1a"><mi id="S4.SS1.SSS0.Px1.p1.4.m4.1.1" xref="S4.SS1.SSS0.Px1.p1.4.m4.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.4.m4.1b"><ci id="S4.SS1.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.4.m4.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.4.m4.1c">D</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p1.4.m4.1d">italic_D</annotation></semantics></math> based on their contextual similarity.
Specifically, we adopt the sequence model pre-trained in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#S1.F2" title="Figure 2 ‣ 1 Introduction ‣ Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_tag">2</span></a>(a) as the encoder and apply mean pooling to obtain sequence representations. Given a query sequence <math alttext="x_{q}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p1.5.m5.1"><semantics id="S4.SS1.SSS0.Px1.p1.5.m5.1a"><msub id="S4.SS1.SSS0.Px1.p1.5.m5.1.1" xref="S4.SS1.SSS0.Px1.p1.5.m5.1.1.cmml"><mi id="S4.SS1.SSS0.Px1.p1.5.m5.1.1.2" xref="S4.SS1.SSS0.Px1.p1.5.m5.1.1.2.cmml">x</mi><mi id="S4.SS1.SSS0.Px1.p1.5.m5.1.1.3" xref="S4.SS1.SSS0.Px1.p1.5.m5.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.5.m5.1b"><apply id="S4.SS1.SSS0.Px1.p1.5.m5.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.5.m5.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.5.m5.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px1.p1.5.m5.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p1.5.m5.1.1.2">𝑥</ci><ci id="S4.SS1.SSS0.Px1.p1.5.m5.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p1.5.m5.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.5.m5.1c">x_{q}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p1.5.m5.1d">italic_x start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> and a candidate sequence <math alttext="x_{p}\in D" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p1.6.m6.1"><semantics id="S4.SS1.SSS0.Px1.p1.6.m6.1a"><mrow id="S4.SS1.SSS0.Px1.p1.6.m6.1.1" xref="S4.SS1.SSS0.Px1.p1.6.m6.1.1.cmml"><msub id="S4.SS1.SSS0.Px1.p1.6.m6.1.1.2" xref="S4.SS1.SSS0.Px1.p1.6.m6.1.1.2.cmml"><mi id="S4.SS1.SSS0.Px1.p1.6.m6.1.1.2.2" xref="S4.SS1.SSS0.Px1.p1.6.m6.1.1.2.2.cmml">x</mi><mi id="S4.SS1.SSS0.Px1.p1.6.m6.1.1.2.3" xref="S4.SS1.SSS0.Px1.p1.6.m6.1.1.2.3.cmml">p</mi></msub><mo id="S4.SS1.SSS0.Px1.p1.6.m6.1.1.1" xref="S4.SS1.SSS0.Px1.p1.6.m6.1.1.1.cmml">∈</mo><mi id="S4.SS1.SSS0.Px1.p1.6.m6.1.1.3" xref="S4.SS1.SSS0.Px1.p1.6.m6.1.1.3.cmml">D</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.6.m6.1b"><apply id="S4.SS1.SSS0.Px1.p1.6.m6.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.6.m6.1.1"><in id="S4.SS1.SSS0.Px1.p1.6.m6.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.6.m6.1.1.1"></in><apply id="S4.SS1.SSS0.Px1.p1.6.m6.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p1.6.m6.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.6.m6.1.1.2.1.cmml" xref="S4.SS1.SSS0.Px1.p1.6.m6.1.1.2">subscript</csymbol><ci id="S4.SS1.SSS0.Px1.p1.6.m6.1.1.2.2.cmml" xref="S4.SS1.SSS0.Px1.p1.6.m6.1.1.2.2">𝑥</ci><ci id="S4.SS1.SSS0.Px1.p1.6.m6.1.1.2.3.cmml" xref="S4.SS1.SSS0.Px1.p1.6.m6.1.1.2.3">𝑝</ci></apply><ci id="S4.SS1.SSS0.Px1.p1.6.m6.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p1.6.m6.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.6.m6.1c">x_{p}\in D</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p1.6.m6.1d">italic_x start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ∈ italic_D</annotation></semantics></math>, we define their contextual similarity as the dot product of their representations:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="s(x_{q},x_{p})=f(x_{q})^{\top}f(x_{p})," class="ltx_Math" display="block" id="S4.E3.m1.1"><semantics id="S4.E3.m1.1a"><mrow id="S4.E3.m1.1.1.1" xref="S4.E3.m1.1.1.1.1.cmml"><mrow id="S4.E3.m1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.cmml"><mrow id="S4.E3.m1.1.1.1.1.2" xref="S4.E3.m1.1.1.1.1.2.cmml"><mi id="S4.E3.m1.1.1.1.1.2.4" xref="S4.E3.m1.1.1.1.1.2.4.cmml">s</mi><mo id="S4.E3.m1.1.1.1.1.2.3" xref="S4.E3.m1.1.1.1.1.2.3.cmml">⁢</mo><mrow id="S4.E3.m1.1.1.1.1.2.2.2" xref="S4.E3.m1.1.1.1.1.2.2.3.cmml"><mo id="S4.E3.m1.1.1.1.1.2.2.2.3" stretchy="false" xref="S4.E3.m1.1.1.1.1.2.2.3.cmml">(</mo><msub id="S4.E3.m1.1.1.1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E3.m1.1.1.1.1.1.1.1.1.2" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S4.E3.m1.1.1.1.1.1.1.1.1.3" xref="S4.E3.m1.1.1.1.1.1.1.1.1.3.cmml">q</mi></msub><mo id="S4.E3.m1.1.1.1.1.2.2.2.4" xref="S4.E3.m1.1.1.1.1.2.2.3.cmml">,</mo><msub id="S4.E3.m1.1.1.1.1.2.2.2.2" xref="S4.E3.m1.1.1.1.1.2.2.2.2.cmml"><mi id="S4.E3.m1.1.1.1.1.2.2.2.2.2" xref="S4.E3.m1.1.1.1.1.2.2.2.2.2.cmml">x</mi><mi id="S4.E3.m1.1.1.1.1.2.2.2.2.3" xref="S4.E3.m1.1.1.1.1.2.2.2.2.3.cmml">p</mi></msub><mo id="S4.E3.m1.1.1.1.1.2.2.2.5" stretchy="false" xref="S4.E3.m1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E3.m1.1.1.1.1.5" xref="S4.E3.m1.1.1.1.1.5.cmml">=</mo><mrow id="S4.E3.m1.1.1.1.1.4" xref="S4.E3.m1.1.1.1.1.4.cmml"><mi id="S4.E3.m1.1.1.1.1.4.4" xref="S4.E3.m1.1.1.1.1.4.4.cmml">f</mi><mo id="S4.E3.m1.1.1.1.1.4.3" xref="S4.E3.m1.1.1.1.1.4.3.cmml">⁢</mo><msup id="S4.E3.m1.1.1.1.1.3.1" xref="S4.E3.m1.1.1.1.1.3.1.cmml"><mrow id="S4.E3.m1.1.1.1.1.3.1.1.1" xref="S4.E3.m1.1.1.1.1.3.1.1.1.1.cmml"><mo id="S4.E3.m1.1.1.1.1.3.1.1.1.2" stretchy="false" xref="S4.E3.m1.1.1.1.1.3.1.1.1.1.cmml">(</mo><msub id="S4.E3.m1.1.1.1.1.3.1.1.1.1" xref="S4.E3.m1.1.1.1.1.3.1.1.1.1.cmml"><mi id="S4.E3.m1.1.1.1.1.3.1.1.1.1.2" xref="S4.E3.m1.1.1.1.1.3.1.1.1.1.2.cmml">x</mi><mi id="S4.E3.m1.1.1.1.1.3.1.1.1.1.3" xref="S4.E3.m1.1.1.1.1.3.1.1.1.1.3.cmml">q</mi></msub><mo id="S4.E3.m1.1.1.1.1.3.1.1.1.3" stretchy="false" xref="S4.E3.m1.1.1.1.1.3.1.1.1.1.cmml">)</mo></mrow><mo id="S4.E3.m1.1.1.1.1.3.1.3" xref="S4.E3.m1.1.1.1.1.3.1.3.cmml">⊤</mo></msup><mo id="S4.E3.m1.1.1.1.1.4.3a" xref="S4.E3.m1.1.1.1.1.4.3.cmml">⁢</mo><mi id="S4.E3.m1.1.1.1.1.4.5" xref="S4.E3.m1.1.1.1.1.4.5.cmml">f</mi><mo id="S4.E3.m1.1.1.1.1.4.3b" xref="S4.E3.m1.1.1.1.1.4.3.cmml">⁢</mo><mrow id="S4.E3.m1.1.1.1.1.4.2.1" xref="S4.E3.m1.1.1.1.1.4.2.1.1.cmml"><mo id="S4.E3.m1.1.1.1.1.4.2.1.2" stretchy="false" xref="S4.E3.m1.1.1.1.1.4.2.1.1.cmml">(</mo><msub id="S4.E3.m1.1.1.1.1.4.2.1.1" xref="S4.E3.m1.1.1.1.1.4.2.1.1.cmml"><mi id="S4.E3.m1.1.1.1.1.4.2.1.1.2" xref="S4.E3.m1.1.1.1.1.4.2.1.1.2.cmml">x</mi><mi id="S4.E3.m1.1.1.1.1.4.2.1.1.3" xref="S4.E3.m1.1.1.1.1.4.2.1.1.3.cmml">p</mi></msub><mo id="S4.E3.m1.1.1.1.1.4.2.1.3" stretchy="false" xref="S4.E3.m1.1.1.1.1.4.2.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E3.m1.1.1.1.2" xref="S4.E3.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E3.m1.1b"><apply id="S4.E3.m1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1"><eq id="S4.E3.m1.1.1.1.1.5.cmml" xref="S4.E3.m1.1.1.1.1.5"></eq><apply id="S4.E3.m1.1.1.1.1.2.cmml" xref="S4.E3.m1.1.1.1.1.2"><times id="S4.E3.m1.1.1.1.1.2.3.cmml" xref="S4.E3.m1.1.1.1.1.2.3"></times><ci id="S4.E3.m1.1.1.1.1.2.4.cmml" xref="S4.E3.m1.1.1.1.1.2.4">𝑠</ci><interval closure="open" id="S4.E3.m1.1.1.1.1.2.2.3.cmml" xref="S4.E3.m1.1.1.1.1.2.2.2"><apply id="S4.E3.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E3.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S4.E3.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.3">𝑞</ci></apply><apply id="S4.E3.m1.1.1.1.1.2.2.2.2.cmml" xref="S4.E3.m1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.2.2.2.2.1.cmml" xref="S4.E3.m1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S4.E3.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S4.E3.m1.1.1.1.1.2.2.2.2.2">𝑥</ci><ci id="S4.E3.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S4.E3.m1.1.1.1.1.2.2.2.2.3">𝑝</ci></apply></interval></apply><apply id="S4.E3.m1.1.1.1.1.4.cmml" xref="S4.E3.m1.1.1.1.1.4"><times id="S4.E3.m1.1.1.1.1.4.3.cmml" xref="S4.E3.m1.1.1.1.1.4.3"></times><ci id="S4.E3.m1.1.1.1.1.4.4.cmml" xref="S4.E3.m1.1.1.1.1.4.4">𝑓</ci><apply id="S4.E3.m1.1.1.1.1.3.1.cmml" xref="S4.E3.m1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.3.1.2.cmml" xref="S4.E3.m1.1.1.1.1.3.1">superscript</csymbol><apply id="S4.E3.m1.1.1.1.1.3.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.3.1.1.1"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.3.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.3.1.1.1">subscript</csymbol><ci id="S4.E3.m1.1.1.1.1.3.1.1.1.1.2.cmml" xref="S4.E3.m1.1.1.1.1.3.1.1.1.1.2">𝑥</ci><ci id="S4.E3.m1.1.1.1.1.3.1.1.1.1.3.cmml" xref="S4.E3.m1.1.1.1.1.3.1.1.1.1.3">𝑞</ci></apply><csymbol cd="latexml" id="S4.E3.m1.1.1.1.1.3.1.3.cmml" xref="S4.E3.m1.1.1.1.1.3.1.3">top</csymbol></apply><ci id="S4.E3.m1.1.1.1.1.4.5.cmml" xref="S4.E3.m1.1.1.1.1.4.5">𝑓</ci><apply id="S4.E3.m1.1.1.1.1.4.2.1.1.cmml" xref="S4.E3.m1.1.1.1.1.4.2.1"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.4.2.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.4.2.1">subscript</csymbol><ci id="S4.E3.m1.1.1.1.1.4.2.1.1.2.cmml" xref="S4.E3.m1.1.1.1.1.4.2.1.1.2">𝑥</ci><ci id="S4.E3.m1.1.1.1.1.4.2.1.1.3.cmml" xref="S4.E3.m1.1.1.1.1.4.2.1.1.3">𝑝</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3.m1.1c">s(x_{q},x_{p})=f(x_{q})^{\top}f(x_{p}),</annotation><annotation encoding="application/x-llamapun" id="S4.E3.m1.1d">italic_s ( italic_x start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ) = italic_f ( italic_x start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT italic_f ( italic_x start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.SSS0.Px1.p1.7">where <math alttext="f(\cdot)" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px1.p1.7.m1.1"><semantics id="S4.SS1.SSS0.Px1.p1.7.m1.1a"><mrow id="S4.SS1.SSS0.Px1.p1.7.m1.1.2" xref="S4.SS1.SSS0.Px1.p1.7.m1.1.2.cmml"><mi id="S4.SS1.SSS0.Px1.p1.7.m1.1.2.2" xref="S4.SS1.SSS0.Px1.p1.7.m1.1.2.2.cmml">f</mi><mo id="S4.SS1.SSS0.Px1.p1.7.m1.1.2.1" xref="S4.SS1.SSS0.Px1.p1.7.m1.1.2.1.cmml">⁢</mo><mrow id="S4.SS1.SSS0.Px1.p1.7.m1.1.2.3.2" xref="S4.SS1.SSS0.Px1.p1.7.m1.1.2.cmml"><mo id="S4.SS1.SSS0.Px1.p1.7.m1.1.2.3.2.1" stretchy="false" xref="S4.SS1.SSS0.Px1.p1.7.m1.1.2.cmml">(</mo><mo id="S4.SS1.SSS0.Px1.p1.7.m1.1.1" lspace="0em" rspace="0em" xref="S4.SS1.SSS0.Px1.p1.7.m1.1.1.cmml">⋅</mo><mo id="S4.SS1.SSS0.Px1.p1.7.m1.1.2.3.2.2" stretchy="false" xref="S4.SS1.SSS0.Px1.p1.7.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.7.m1.1b"><apply id="S4.SS1.SSS0.Px1.p1.7.m1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p1.7.m1.1.2"><times id="S4.SS1.SSS0.Px1.p1.7.m1.1.2.1.cmml" xref="S4.SS1.SSS0.Px1.p1.7.m1.1.2.1"></times><ci id="S4.SS1.SSS0.Px1.p1.7.m1.1.2.2.cmml" xref="S4.SS1.SSS0.Px1.p1.7.m1.1.2.2">𝑓</ci><ci id="S4.SS1.SSS0.Px1.p1.7.m1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.7.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.7.m1.1c">f(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px1.p1.7.m1.1d">italic_f ( ⋅ )</annotation></semantics></math> denotes our encoder.
We leave the detailed annotation process in Appendix A.</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS1.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Time-aware Contrastive Learning.</h5>
<div class="ltx_para" id="S4.SS1.SSS0.Px2.p1">
<p class="ltx_p" id="S4.SS1.SSS0.Px2.p1.5">Temporal information reflects the dynamic changes in historical interactions, which is crucial for dynamic graph modeling. We posit that demonstrations closer in time to the query are more relevant than those further away. Consequently, we utilize a time decay function to account for temporal proximity between the query and candidate sequences, as follows.</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mu(t_{q},t_{p})=\exp(-\lambda|t_{q}-t_{p}|)," class="ltx_Math" display="block" id="S4.E4.m1.2"><semantics id="S4.E4.m1.2a"><mrow id="S4.E4.m1.2.2.1" xref="S4.E4.m1.2.2.1.1.cmml"><mrow id="S4.E4.m1.2.2.1.1" xref="S4.E4.m1.2.2.1.1.cmml"><mrow id="S4.E4.m1.2.2.1.1.2" xref="S4.E4.m1.2.2.1.1.2.cmml"><mi id="S4.E4.m1.2.2.1.1.2.4" xref="S4.E4.m1.2.2.1.1.2.4.cmml">μ</mi><mo id="S4.E4.m1.2.2.1.1.2.3" xref="S4.E4.m1.2.2.1.1.2.3.cmml">⁢</mo><mrow id="S4.E4.m1.2.2.1.1.2.2.2" xref="S4.E4.m1.2.2.1.1.2.2.3.cmml"><mo id="S4.E4.m1.2.2.1.1.2.2.2.3" stretchy="false" xref="S4.E4.m1.2.2.1.1.2.2.3.cmml">(</mo><msub id="S4.E4.m1.2.2.1.1.1.1.1.1" xref="S4.E4.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S4.E4.m1.2.2.1.1.1.1.1.1.2" xref="S4.E4.m1.2.2.1.1.1.1.1.1.2.cmml">t</mi><mi id="S4.E4.m1.2.2.1.1.1.1.1.1.3" xref="S4.E4.m1.2.2.1.1.1.1.1.1.3.cmml">q</mi></msub><mo id="S4.E4.m1.2.2.1.1.2.2.2.4" xref="S4.E4.m1.2.2.1.1.2.2.3.cmml">,</mo><msub id="S4.E4.m1.2.2.1.1.2.2.2.2" xref="S4.E4.m1.2.2.1.1.2.2.2.2.cmml"><mi id="S4.E4.m1.2.2.1.1.2.2.2.2.2" xref="S4.E4.m1.2.2.1.1.2.2.2.2.2.cmml">t</mi><mi id="S4.E4.m1.2.2.1.1.2.2.2.2.3" xref="S4.E4.m1.2.2.1.1.2.2.2.2.3.cmml">p</mi></msub><mo id="S4.E4.m1.2.2.1.1.2.2.2.5" stretchy="false" xref="S4.E4.m1.2.2.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E4.m1.2.2.1.1.4" xref="S4.E4.m1.2.2.1.1.4.cmml">=</mo><mrow id="S4.E4.m1.2.2.1.1.3.1" xref="S4.E4.m1.2.2.1.1.3.2.cmml"><mi id="S4.E4.m1.1.1" xref="S4.E4.m1.1.1.cmml">exp</mi><mo id="S4.E4.m1.2.2.1.1.3.1a" xref="S4.E4.m1.2.2.1.1.3.2.cmml">⁡</mo><mrow id="S4.E4.m1.2.2.1.1.3.1.1" xref="S4.E4.m1.2.2.1.1.3.2.cmml"><mo id="S4.E4.m1.2.2.1.1.3.1.1.2" stretchy="false" xref="S4.E4.m1.2.2.1.1.3.2.cmml">(</mo><mrow id="S4.E4.m1.2.2.1.1.3.1.1.1" xref="S4.E4.m1.2.2.1.1.3.1.1.1.cmml"><mo id="S4.E4.m1.2.2.1.1.3.1.1.1a" xref="S4.E4.m1.2.2.1.1.3.1.1.1.cmml">−</mo><mrow id="S4.E4.m1.2.2.1.1.3.1.1.1.1" xref="S4.E4.m1.2.2.1.1.3.1.1.1.1.cmml"><mi id="S4.E4.m1.2.2.1.1.3.1.1.1.1.3" xref="S4.E4.m1.2.2.1.1.3.1.1.1.1.3.cmml">λ</mi><mo id="S4.E4.m1.2.2.1.1.3.1.1.1.1.2" xref="S4.E4.m1.2.2.1.1.3.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E4.m1.2.2.1.1.3.1.1.1.1.1.1" xref="S4.E4.m1.2.2.1.1.3.1.1.1.1.1.2.cmml"><mo id="S4.E4.m1.2.2.1.1.3.1.1.1.1.1.1.2" stretchy="false" xref="S4.E4.m1.2.2.1.1.3.1.1.1.1.1.2.1.cmml">|</mo><mrow id="S4.E4.m1.2.2.1.1.3.1.1.1.1.1.1.1" xref="S4.E4.m1.2.2.1.1.3.1.1.1.1.1.1.1.cmml"><msub id="S4.E4.m1.2.2.1.1.3.1.1.1.1.1.1.1.2" xref="S4.E4.m1.2.2.1.1.3.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E4.m1.2.2.1.1.3.1.1.1.1.1.1.1.2.2" xref="S4.E4.m1.2.2.1.1.3.1.1.1.1.1.1.1.2.2.cmml">t</mi><mi id="S4.E4.m1.2.2.1.1.3.1.1.1.1.1.1.1.2.3" xref="S4.E4.m1.2.2.1.1.3.1.1.1.1.1.1.1.2.3.cmml">q</mi></msub><mo id="S4.E4.m1.2.2.1.1.3.1.1.1.1.1.1.1.1" xref="S4.E4.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S4.E4.m1.2.2.1.1.3.1.1.1.1.1.1.1.3" xref="S4.E4.m1.2.2.1.1.3.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E4.m1.2.2.1.1.3.1.1.1.1.1.1.1.3.2" xref="S4.E4.m1.2.2.1.1.3.1.1.1.1.1.1.1.3.2.cmml">t</mi><mi id="S4.E4.m1.2.2.1.1.3.1.1.1.1.1.1.1.3.3" xref="S4.E4.m1.2.2.1.1.3.1.1.1.1.1.1.1.3.3.cmml">p</mi></msub></mrow><mo id="S4.E4.m1.2.2.1.1.3.1.1.1.1.1.1.3" stretchy="false" xref="S4.E4.m1.2.2.1.1.3.1.1.1.1.1.2.1.cmml">|</mo></mrow></mrow></mrow><mo id="S4.E4.m1.2.2.1.1.3.1.1.3" stretchy="false" xref="S4.E4.m1.2.2.1.1.3.2.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E4.m1.2.2.1.2" xref="S4.E4.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E4.m1.2b"><apply id="S4.E4.m1.2.2.1.1.cmml" xref="S4.E4.m1.2.2.1"><eq id="S4.E4.m1.2.2.1.1.4.cmml" xref="S4.E4.m1.2.2.1.1.4"></eq><apply id="S4.E4.m1.2.2.1.1.2.cmml" xref="S4.E4.m1.2.2.1.1.2"><times id="S4.E4.m1.2.2.1.1.2.3.cmml" xref="S4.E4.m1.2.2.1.1.2.3"></times><ci id="S4.E4.m1.2.2.1.1.2.4.cmml" xref="S4.E4.m1.2.2.1.1.2.4">𝜇</ci><interval closure="open" id="S4.E4.m1.2.2.1.1.2.2.3.cmml" xref="S4.E4.m1.2.2.1.1.2.2.2"><apply id="S4.E4.m1.2.2.1.1.1.1.1.1.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E4.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E4.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1.2">𝑡</ci><ci id="S4.E4.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1.3">𝑞</ci></apply><apply id="S4.E4.m1.2.2.1.1.2.2.2.2.cmml" xref="S4.E4.m1.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E4.m1.2.2.1.1.2.2.2.2.1.cmml" xref="S4.E4.m1.2.2.1.1.2.2.2.2">subscript</csymbol><ci id="S4.E4.m1.2.2.1.1.2.2.2.2.2.cmml" xref="S4.E4.m1.2.2.1.1.2.2.2.2.2">𝑡</ci><ci id="S4.E4.m1.2.2.1.1.2.2.2.2.3.cmml" xref="S4.E4.m1.2.2.1.1.2.2.2.2.3">𝑝</ci></apply></interval></apply><apply id="S4.E4.m1.2.2.1.1.3.2.cmml" xref="S4.E4.m1.2.2.1.1.3.1"><exp id="S4.E4.m1.1.1.cmml" xref="S4.E4.m1.1.1"></exp><apply id="S4.E4.m1.2.2.1.1.3.1.1.1.cmml" xref="S4.E4.m1.2.2.1.1.3.1.1.1"><minus id="S4.E4.m1.2.2.1.1.3.1.1.1.2.cmml" xref="S4.E4.m1.2.2.1.1.3.1.1.1"></minus><apply id="S4.E4.m1.2.2.1.1.3.1.1.1.1.cmml" xref="S4.E4.m1.2.2.1.1.3.1.1.1.1"><times id="S4.E4.m1.2.2.1.1.3.1.1.1.1.2.cmml" xref="S4.E4.m1.2.2.1.1.3.1.1.1.1.2"></times><ci id="S4.E4.m1.2.2.1.1.3.1.1.1.1.3.cmml" xref="S4.E4.m1.2.2.1.1.3.1.1.1.1.3">𝜆</ci><apply id="S4.E4.m1.2.2.1.1.3.1.1.1.1.1.2.cmml" xref="S4.E4.m1.2.2.1.1.3.1.1.1.1.1.1"><abs id="S4.E4.m1.2.2.1.1.3.1.1.1.1.1.2.1.cmml" xref="S4.E4.m1.2.2.1.1.3.1.1.1.1.1.1.2"></abs><apply id="S4.E4.m1.2.2.1.1.3.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.2.2.1.1.3.1.1.1.1.1.1.1"><minus id="S4.E4.m1.2.2.1.1.3.1.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.2.2.1.1.3.1.1.1.1.1.1.1.1"></minus><apply id="S4.E4.m1.2.2.1.1.3.1.1.1.1.1.1.1.2.cmml" xref="S4.E4.m1.2.2.1.1.3.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E4.m1.2.2.1.1.3.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E4.m1.2.2.1.1.3.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E4.m1.2.2.1.1.3.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E4.m1.2.2.1.1.3.1.1.1.1.1.1.1.2.2">𝑡</ci><ci id="S4.E4.m1.2.2.1.1.3.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E4.m1.2.2.1.1.3.1.1.1.1.1.1.1.2.3">𝑞</ci></apply><apply id="S4.E4.m1.2.2.1.1.3.1.1.1.1.1.1.1.3.cmml" xref="S4.E4.m1.2.2.1.1.3.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E4.m1.2.2.1.1.3.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E4.m1.2.2.1.1.3.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E4.m1.2.2.1.1.3.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E4.m1.2.2.1.1.3.1.1.1.1.1.1.1.3.2">𝑡</ci><ci id="S4.E4.m1.2.2.1.1.3.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E4.m1.2.2.1.1.3.1.1.1.1.1.1.1.3.3">𝑝</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m1.2c">\mu(t_{q},t_{p})=\exp(-\lambda|t_{q}-t_{p}|),</annotation><annotation encoding="application/x-llamapun" id="S4.E4.m1.2d">italic_μ ( italic_t start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT , italic_t start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ) = roman_exp ( - italic_λ | italic_t start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT - italic_t start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT | ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.SSS0.Px2.p1.4">where <math alttext="t_{q}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px2.p1.1.m1.1"><semantics id="S4.SS1.SSS0.Px2.p1.1.m1.1a"><msub id="S4.SS1.SSS0.Px2.p1.1.m1.1.1" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p1.1.m1.1.1.2" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1.2.cmml">t</mi><mi id="S4.SS1.SSS0.Px2.p1.1.m1.1.1.3" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.1.m1.1b"><apply id="S4.SS1.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.1.m1.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1.2">𝑡</ci><ci id="S4.SS1.SSS0.Px2.p1.1.m1.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.1.m1.1c">t_{q}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px2.p1.1.m1.1d">italic_t start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="t_{p}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px2.p1.2.m2.1"><semantics id="S4.SS1.SSS0.Px2.p1.2.m2.1a"><msub id="S4.SS1.SSS0.Px2.p1.2.m2.1.1" xref="S4.SS1.SSS0.Px2.p1.2.m2.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p1.2.m2.1.1.2" xref="S4.SS1.SSS0.Px2.p1.2.m2.1.1.2.cmml">t</mi><mi id="S4.SS1.SSS0.Px2.p1.2.m2.1.1.3" xref="S4.SS1.SSS0.Px2.p1.2.m2.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.2.m2.1b"><apply id="S4.SS1.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.2.m2.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.2.m2.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m2.1.1.2">𝑡</ci><ci id="S4.SS1.SSS0.Px2.p1.2.m2.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m2.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.2.m2.1c">t_{p}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px2.p1.2.m2.1d">italic_t start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math> represent the last interaction time in the query and candidate sequences<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>In the annotated training data, the query time <math alttext="t_{q}" class="ltx_Math" display="inline" id="footnote1.m1.1"><semantics id="footnote1.m1.1b"><msub id="footnote1.m1.1.1" xref="footnote1.m1.1.1.cmml"><mi id="footnote1.m1.1.1.2" xref="footnote1.m1.1.1.2.cmml">t</mi><mi id="footnote1.m1.1.1.3" xref="footnote1.m1.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="footnote1.m1.1c"><apply id="footnote1.m1.1.1.cmml" xref="footnote1.m1.1.1"><csymbol cd="ambiguous" id="footnote1.m1.1.1.1.cmml" xref="footnote1.m1.1.1">subscript</csymbol><ci id="footnote1.m1.1.1.2.cmml" xref="footnote1.m1.1.1.2">𝑡</ci><ci id="footnote1.m1.1.1.3.cmml" xref="footnote1.m1.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote1.m1.1d">t_{q}</annotation><annotation encoding="application/x-llamapun" id="footnote1.m1.1e">italic_t start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> may precede the candidate time <math alttext="t_{p}" class="ltx_Math" display="inline" id="footnote1.m2.1"><semantics id="footnote1.m2.1b"><msub id="footnote1.m2.1.1" xref="footnote1.m2.1.1.cmml"><mi id="footnote1.m2.1.1.2" xref="footnote1.m2.1.1.2.cmml">t</mi><mi id="footnote1.m2.1.1.3" xref="footnote1.m2.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="footnote1.m2.1c"><apply id="footnote1.m2.1.1.cmml" xref="footnote1.m2.1.1"><csymbol cd="ambiguous" id="footnote1.m2.1.1.1.cmml" xref="footnote1.m2.1.1">subscript</csymbol><ci id="footnote1.m2.1.1.2.cmml" xref="footnote1.m2.1.1.2">𝑡</ci><ci id="footnote1.m2.1.1.3.cmml" xref="footnote1.m2.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote1.m2.1d">t_{p}</annotation><annotation encoding="application/x-llamapun" id="footnote1.m2.1e">italic_t start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math>. However, in the validation and test sets, <math alttext="t_{p}" class="ltx_Math" display="inline" id="footnote1.m3.1"><semantics id="footnote1.m3.1b"><msub id="footnote1.m3.1.1" xref="footnote1.m3.1.1.cmml"><mi id="footnote1.m3.1.1.2" xref="footnote1.m3.1.1.2.cmml">t</mi><mi id="footnote1.m3.1.1.3" xref="footnote1.m3.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="footnote1.m3.1c"><apply id="footnote1.m3.1.1.cmml" xref="footnote1.m3.1.1"><csymbol cd="ambiguous" id="footnote1.m3.1.1.1.cmml" xref="footnote1.m3.1.1">subscript</csymbol><ci id="footnote1.m3.1.1.2.cmml" xref="footnote1.m3.1.1.2">𝑡</ci><ci id="footnote1.m3.1.1.3.cmml" xref="footnote1.m3.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote1.m3.1d">t_{p}</annotation><annotation encoding="application/x-llamapun" id="footnote1.m3.1e">italic_t start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math> always precedes <math alttext="t_{q}" class="ltx_Math" display="inline" id="footnote1.m4.1"><semantics id="footnote1.m4.1b"><msub id="footnote1.m4.1.1" xref="footnote1.m4.1.1.cmml"><mi id="footnote1.m4.1.1.2" xref="footnote1.m4.1.1.2.cmml">t</mi><mi id="footnote1.m4.1.1.3" xref="footnote1.m4.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="footnote1.m4.1c"><apply id="footnote1.m4.1.1.cmml" xref="footnote1.m4.1.1"><csymbol cd="ambiguous" id="footnote1.m4.1.1.1.cmml" xref="footnote1.m4.1.1">subscript</csymbol><ci id="footnote1.m4.1.1.2.cmml" xref="footnote1.m4.1.1.2">𝑡</ci><ci id="footnote1.m4.1.1.3.cmml" xref="footnote1.m4.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote1.m4.1d">t_{q}</annotation><annotation encoding="application/x-llamapun" id="footnote1.m4.1e">italic_t start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math>, preventing leakage from a future time.</span></span></span>, respectively. The hyper-parameter <math alttext="\lambda" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px2.p1.3.m3.1"><semantics id="S4.SS1.SSS0.Px2.p1.3.m3.1a"><mi id="S4.SS1.SSS0.Px2.p1.3.m3.1.1" xref="S4.SS1.SSS0.Px2.p1.3.m3.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.3.m3.1b"><ci id="S4.SS1.SSS0.Px2.p1.3.m3.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m3.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.3.m3.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px2.p1.3.m3.1d">italic_λ</annotation></semantics></math> controls the rate of time decay, determining how quickly the importance of interactions decreases with time. Note that <math alttext="0&lt;\mu(\cdot,\cdot)\leq 1" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px2.p1.4.m4.2"><semantics id="S4.SS1.SSS0.Px2.p1.4.m4.2a"><mrow id="S4.SS1.SSS0.Px2.p1.4.m4.2.3" xref="S4.SS1.SSS0.Px2.p1.4.m4.2.3.cmml"><mn id="S4.SS1.SSS0.Px2.p1.4.m4.2.3.2" xref="S4.SS1.SSS0.Px2.p1.4.m4.2.3.2.cmml">0</mn><mo id="S4.SS1.SSS0.Px2.p1.4.m4.2.3.3" xref="S4.SS1.SSS0.Px2.p1.4.m4.2.3.3.cmml">&lt;</mo><mrow id="S4.SS1.SSS0.Px2.p1.4.m4.2.3.4" xref="S4.SS1.SSS0.Px2.p1.4.m4.2.3.4.cmml"><mi id="S4.SS1.SSS0.Px2.p1.4.m4.2.3.4.2" xref="S4.SS1.SSS0.Px2.p1.4.m4.2.3.4.2.cmml">μ</mi><mo id="S4.SS1.SSS0.Px2.p1.4.m4.2.3.4.1" xref="S4.SS1.SSS0.Px2.p1.4.m4.2.3.4.1.cmml">⁢</mo><mrow id="S4.SS1.SSS0.Px2.p1.4.m4.2.3.4.3.2" xref="S4.SS1.SSS0.Px2.p1.4.m4.2.3.4.3.1.cmml"><mo id="S4.SS1.SSS0.Px2.p1.4.m4.2.3.4.3.2.1" stretchy="false" xref="S4.SS1.SSS0.Px2.p1.4.m4.2.3.4.3.1.cmml">(</mo><mo id="S4.SS1.SSS0.Px2.p1.4.m4.1.1" lspace="0em" rspace="0em" xref="S4.SS1.SSS0.Px2.p1.4.m4.1.1.cmml">⋅</mo><mo id="S4.SS1.SSS0.Px2.p1.4.m4.2.3.4.3.2.2" rspace="0em" xref="S4.SS1.SSS0.Px2.p1.4.m4.2.3.4.3.1.cmml">,</mo><mo id="S4.SS1.SSS0.Px2.p1.4.m4.2.2" lspace="0em" rspace="0em" xref="S4.SS1.SSS0.Px2.p1.4.m4.2.2.cmml">⋅</mo><mo id="S4.SS1.SSS0.Px2.p1.4.m4.2.3.4.3.2.3" stretchy="false" xref="S4.SS1.SSS0.Px2.p1.4.m4.2.3.4.3.1.cmml">)</mo></mrow></mrow><mo id="S4.SS1.SSS0.Px2.p1.4.m4.2.3.5" xref="S4.SS1.SSS0.Px2.p1.4.m4.2.3.5.cmml">≤</mo><mn id="S4.SS1.SSS0.Px2.p1.4.m4.2.3.6" xref="S4.SS1.SSS0.Px2.p1.4.m4.2.3.6.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.4.m4.2b"><apply id="S4.SS1.SSS0.Px2.p1.4.m4.2.3.cmml" xref="S4.SS1.SSS0.Px2.p1.4.m4.2.3"><and id="S4.SS1.SSS0.Px2.p1.4.m4.2.3a.cmml" xref="S4.SS1.SSS0.Px2.p1.4.m4.2.3"></and><apply id="S4.SS1.SSS0.Px2.p1.4.m4.2.3b.cmml" xref="S4.SS1.SSS0.Px2.p1.4.m4.2.3"><lt id="S4.SS1.SSS0.Px2.p1.4.m4.2.3.3.cmml" xref="S4.SS1.SSS0.Px2.p1.4.m4.2.3.3"></lt><cn id="S4.SS1.SSS0.Px2.p1.4.m4.2.3.2.cmml" type="integer" xref="S4.SS1.SSS0.Px2.p1.4.m4.2.3.2">0</cn><apply id="S4.SS1.SSS0.Px2.p1.4.m4.2.3.4.cmml" xref="S4.SS1.SSS0.Px2.p1.4.m4.2.3.4"><times id="S4.SS1.SSS0.Px2.p1.4.m4.2.3.4.1.cmml" xref="S4.SS1.SSS0.Px2.p1.4.m4.2.3.4.1"></times><ci id="S4.SS1.SSS0.Px2.p1.4.m4.2.3.4.2.cmml" xref="S4.SS1.SSS0.Px2.p1.4.m4.2.3.4.2">𝜇</ci><interval closure="open" id="S4.SS1.SSS0.Px2.p1.4.m4.2.3.4.3.1.cmml" xref="S4.SS1.SSS0.Px2.p1.4.m4.2.3.4.3.2"><ci id="S4.SS1.SSS0.Px2.p1.4.m4.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.4.m4.1.1">⋅</ci><ci id="S4.SS1.SSS0.Px2.p1.4.m4.2.2.cmml" xref="S4.SS1.SSS0.Px2.p1.4.m4.2.2">⋅</ci></interval></apply></apply><apply id="S4.SS1.SSS0.Px2.p1.4.m4.2.3c.cmml" xref="S4.SS1.SSS0.Px2.p1.4.m4.2.3"><leq id="S4.SS1.SSS0.Px2.p1.4.m4.2.3.5.cmml" xref="S4.SS1.SSS0.Px2.p1.4.m4.2.3.5"></leq><share href="https://arxiv.org/html/2408.14523v1#S4.SS1.SSS0.Px2.p1.4.m4.2.3.4.cmml" id="S4.SS1.SSS0.Px2.p1.4.m4.2.3d.cmml" xref="S4.SS1.SSS0.Px2.p1.4.m4.2.3"></share><cn id="S4.SS1.SSS0.Px2.p1.4.m4.2.3.6.cmml" type="integer" xref="S4.SS1.SSS0.Px2.p1.4.m4.2.3.6">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.4.m4.2c">0&lt;\mu(\cdot,\cdot)\leq 1</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px2.p1.4.m4.2d">0 &lt; italic_μ ( ⋅ , ⋅ ) ≤ 1</annotation></semantics></math>. By using this time decay function, we assign higher importance to the candidates that are temporally closer to the query.</p>
</div>
<div class="ltx_para" id="S4.SS1.SSS0.Px2.p2">
<p class="ltx_p" id="S4.SS1.SSS0.Px2.p2.5">To effectively capture the temporal dynamics of the graph, we incorporates temporal proximity to reweigh the contextual similarity in the contrastive loss:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A4.EGx2">
<tbody id="S4.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle h(x_{q},x_{p})" class="ltx_Math" display="inline" id="S4.E5.m1.2"><semantics id="S4.E5.m1.2a"><mrow id="S4.E5.m1.2.2" xref="S4.E5.m1.2.2.cmml"><mi id="S4.E5.m1.2.2.4" xref="S4.E5.m1.2.2.4.cmml">h</mi><mo id="S4.E5.m1.2.2.3" xref="S4.E5.m1.2.2.3.cmml">⁢</mo><mrow id="S4.E5.m1.2.2.2.2" xref="S4.E5.m1.2.2.2.3.cmml"><mo id="S4.E5.m1.2.2.2.2.3" stretchy="false" xref="S4.E5.m1.2.2.2.3.cmml">(</mo><msub id="S4.E5.m1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.cmml"><mi id="S4.E5.m1.1.1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.1.2.cmml">x</mi><mi id="S4.E5.m1.1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.1.3.cmml">q</mi></msub><mo id="S4.E5.m1.2.2.2.2.4" xref="S4.E5.m1.2.2.2.3.cmml">,</mo><msub id="S4.E5.m1.2.2.2.2.2" xref="S4.E5.m1.2.2.2.2.2.cmml"><mi id="S4.E5.m1.2.2.2.2.2.2" xref="S4.E5.m1.2.2.2.2.2.2.cmml">x</mi><mi id="S4.E5.m1.2.2.2.2.2.3" xref="S4.E5.m1.2.2.2.2.2.3.cmml">p</mi></msub><mo id="S4.E5.m1.2.2.2.2.5" stretchy="false" xref="S4.E5.m1.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E5.m1.2b"><apply id="S4.E5.m1.2.2.cmml" xref="S4.E5.m1.2.2"><times id="S4.E5.m1.2.2.3.cmml" xref="S4.E5.m1.2.2.3"></times><ci id="S4.E5.m1.2.2.4.cmml" xref="S4.E5.m1.2.2.4">ℎ</ci><interval closure="open" id="S4.E5.m1.2.2.2.3.cmml" xref="S4.E5.m1.2.2.2.2"><apply id="S4.E5.m1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.1.2">𝑥</ci><ci id="S4.E5.m1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.1.1.1.1.1.3">𝑞</ci></apply><apply id="S4.E5.m1.2.2.2.2.2.cmml" xref="S4.E5.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E5.m1.2.2.2.2.2.1.cmml" xref="S4.E5.m1.2.2.2.2.2">subscript</csymbol><ci id="S4.E5.m1.2.2.2.2.2.2.cmml" xref="S4.E5.m1.2.2.2.2.2.2">𝑥</ci><ci id="S4.E5.m1.2.2.2.2.2.3.cmml" xref="S4.E5.m1.2.2.2.2.2.3">𝑝</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m1.2c">\displaystyle h(x_{q},x_{p})</annotation><annotation encoding="application/x-llamapun" id="S4.E5.m1.2d">italic_h ( italic_x start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=s(x_{q},x_{p})\mu(t_{q},t_{p})." class="ltx_Math" display="inline" id="S4.E5.m2.1"><semantics id="S4.E5.m2.1a"><mrow id="S4.E5.m2.1.1.1" xref="S4.E5.m2.1.1.1.1.cmml"><mrow id="S4.E5.m2.1.1.1.1" xref="S4.E5.m2.1.1.1.1.cmml"><mi id="S4.E5.m2.1.1.1.1.6" xref="S4.E5.m2.1.1.1.1.6.cmml"></mi><mo id="S4.E5.m2.1.1.1.1.5" xref="S4.E5.m2.1.1.1.1.5.cmml">=</mo><mrow id="S4.E5.m2.1.1.1.1.4" xref="S4.E5.m2.1.1.1.1.4.cmml"><mi id="S4.E5.m2.1.1.1.1.4.6" xref="S4.E5.m2.1.1.1.1.4.6.cmml">s</mi><mo id="S4.E5.m2.1.1.1.1.4.5" xref="S4.E5.m2.1.1.1.1.4.5.cmml">⁢</mo><mrow id="S4.E5.m2.1.1.1.1.2.2.2" xref="S4.E5.m2.1.1.1.1.2.2.3.cmml"><mo id="S4.E5.m2.1.1.1.1.2.2.2.3" stretchy="false" xref="S4.E5.m2.1.1.1.1.2.2.3.cmml">(</mo><msub id="S4.E5.m2.1.1.1.1.1.1.1.1" xref="S4.E5.m2.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E5.m2.1.1.1.1.1.1.1.1.2" xref="S4.E5.m2.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S4.E5.m2.1.1.1.1.1.1.1.1.3" xref="S4.E5.m2.1.1.1.1.1.1.1.1.3.cmml">q</mi></msub><mo id="S4.E5.m2.1.1.1.1.2.2.2.4" xref="S4.E5.m2.1.1.1.1.2.2.3.cmml">,</mo><msub id="S4.E5.m2.1.1.1.1.2.2.2.2" xref="S4.E5.m2.1.1.1.1.2.2.2.2.cmml"><mi id="S4.E5.m2.1.1.1.1.2.2.2.2.2" xref="S4.E5.m2.1.1.1.1.2.2.2.2.2.cmml">x</mi><mi id="S4.E5.m2.1.1.1.1.2.2.2.2.3" xref="S4.E5.m2.1.1.1.1.2.2.2.2.3.cmml">p</mi></msub><mo id="S4.E5.m2.1.1.1.1.2.2.2.5" stretchy="false" xref="S4.E5.m2.1.1.1.1.2.2.3.cmml">)</mo></mrow><mo id="S4.E5.m2.1.1.1.1.4.5a" xref="S4.E5.m2.1.1.1.1.4.5.cmml">⁢</mo><mi id="S4.E5.m2.1.1.1.1.4.7" xref="S4.E5.m2.1.1.1.1.4.7.cmml">μ</mi><mo id="S4.E5.m2.1.1.1.1.4.5b" xref="S4.E5.m2.1.1.1.1.4.5.cmml">⁢</mo><mrow id="S4.E5.m2.1.1.1.1.4.4.2" xref="S4.E5.m2.1.1.1.1.4.4.3.cmml"><mo id="S4.E5.m2.1.1.1.1.4.4.2.3" stretchy="false" xref="S4.E5.m2.1.1.1.1.4.4.3.cmml">(</mo><msub id="S4.E5.m2.1.1.1.1.3.3.1.1" xref="S4.E5.m2.1.1.1.1.3.3.1.1.cmml"><mi id="S4.E5.m2.1.1.1.1.3.3.1.1.2" xref="S4.E5.m2.1.1.1.1.3.3.1.1.2.cmml">t</mi><mi id="S4.E5.m2.1.1.1.1.3.3.1.1.3" xref="S4.E5.m2.1.1.1.1.3.3.1.1.3.cmml">q</mi></msub><mo id="S4.E5.m2.1.1.1.1.4.4.2.4" xref="S4.E5.m2.1.1.1.1.4.4.3.cmml">,</mo><msub id="S4.E5.m2.1.1.1.1.4.4.2.2" xref="S4.E5.m2.1.1.1.1.4.4.2.2.cmml"><mi id="S4.E5.m2.1.1.1.1.4.4.2.2.2" xref="S4.E5.m2.1.1.1.1.4.4.2.2.2.cmml">t</mi><mi id="S4.E5.m2.1.1.1.1.4.4.2.2.3" xref="S4.E5.m2.1.1.1.1.4.4.2.2.3.cmml">p</mi></msub><mo id="S4.E5.m2.1.1.1.1.4.4.2.5" stretchy="false" xref="S4.E5.m2.1.1.1.1.4.4.3.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E5.m2.1.1.1.2" lspace="0em" xref="S4.E5.m2.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E5.m2.1b"><apply id="S4.E5.m2.1.1.1.1.cmml" xref="S4.E5.m2.1.1.1"><eq id="S4.E5.m2.1.1.1.1.5.cmml" xref="S4.E5.m2.1.1.1.1.5"></eq><csymbol cd="latexml" id="S4.E5.m2.1.1.1.1.6.cmml" xref="S4.E5.m2.1.1.1.1.6">absent</csymbol><apply id="S4.E5.m2.1.1.1.1.4.cmml" xref="S4.E5.m2.1.1.1.1.4"><times id="S4.E5.m2.1.1.1.1.4.5.cmml" xref="S4.E5.m2.1.1.1.1.4.5"></times><ci id="S4.E5.m2.1.1.1.1.4.6.cmml" xref="S4.E5.m2.1.1.1.1.4.6">𝑠</ci><interval closure="open" id="S4.E5.m2.1.1.1.1.2.2.3.cmml" xref="S4.E5.m2.1.1.1.1.2.2.2"><apply id="S4.E5.m2.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E5.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E5.m2.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E5.m2.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S4.E5.m2.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E5.m2.1.1.1.1.1.1.1.1.3">𝑞</ci></apply><apply id="S4.E5.m2.1.1.1.1.2.2.2.2.cmml" xref="S4.E5.m2.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E5.m2.1.1.1.1.2.2.2.2.1.cmml" xref="S4.E5.m2.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S4.E5.m2.1.1.1.1.2.2.2.2.2.cmml" xref="S4.E5.m2.1.1.1.1.2.2.2.2.2">𝑥</ci><ci id="S4.E5.m2.1.1.1.1.2.2.2.2.3.cmml" xref="S4.E5.m2.1.1.1.1.2.2.2.2.3">𝑝</ci></apply></interval><ci id="S4.E5.m2.1.1.1.1.4.7.cmml" xref="S4.E5.m2.1.1.1.1.4.7">𝜇</ci><interval closure="open" id="S4.E5.m2.1.1.1.1.4.4.3.cmml" xref="S4.E5.m2.1.1.1.1.4.4.2"><apply id="S4.E5.m2.1.1.1.1.3.3.1.1.cmml" xref="S4.E5.m2.1.1.1.1.3.3.1.1"><csymbol cd="ambiguous" id="S4.E5.m2.1.1.1.1.3.3.1.1.1.cmml" xref="S4.E5.m2.1.1.1.1.3.3.1.1">subscript</csymbol><ci id="S4.E5.m2.1.1.1.1.3.3.1.1.2.cmml" xref="S4.E5.m2.1.1.1.1.3.3.1.1.2">𝑡</ci><ci id="S4.E5.m2.1.1.1.1.3.3.1.1.3.cmml" xref="S4.E5.m2.1.1.1.1.3.3.1.1.3">𝑞</ci></apply><apply id="S4.E5.m2.1.1.1.1.4.4.2.2.cmml" xref="S4.E5.m2.1.1.1.1.4.4.2.2"><csymbol cd="ambiguous" id="S4.E5.m2.1.1.1.1.4.4.2.2.1.cmml" xref="S4.E5.m2.1.1.1.1.4.4.2.2">subscript</csymbol><ci id="S4.E5.m2.1.1.1.1.4.4.2.2.2.cmml" xref="S4.E5.m2.1.1.1.1.4.4.2.2.2">𝑡</ci><ci id="S4.E5.m2.1.1.1.1.4.4.2.2.3.cmml" xref="S4.E5.m2.1.1.1.1.4.4.2.2.3">𝑝</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m2.1c">\displaystyle=s(x_{q},x_{p})\mu(t_{q},t_{p}).</annotation><annotation encoding="application/x-llamapun" id="S4.E5.m2.1d">= italic_s ( italic_x start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ) italic_μ ( italic_t start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT , italic_t start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.SSS0.Px2.p2.6">Subsequently, we adopt in-batch negative sampling based on the following training objective:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A4.EGx3">
<tbody id="S4.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}_{\text{tcl}}" class="ltx_Math" display="inline" id="S4.E6.m1.1"><semantics id="S4.E6.m1.1a"><msub id="S4.E6.m1.1.1" xref="S4.E6.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E6.m1.1.1.2" xref="S4.E6.m1.1.1.2.cmml">ℒ</mi><mtext id="S4.E6.m1.1.1.3" xref="S4.E6.m1.1.1.3a.cmml">tcl</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.E6.m1.1b"><apply id="S4.E6.m1.1.1.cmml" xref="S4.E6.m1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.cmml" xref="S4.E6.m1.1.1">subscript</csymbol><ci id="S4.E6.m1.1.1.2.cmml" xref="S4.E6.m1.1.1.2">ℒ</ci><ci id="S4.E6.m1.1.1.3a.cmml" xref="S4.E6.m1.1.1.3"><mtext id="S4.E6.m1.1.1.3.cmml" mathsize="70%" xref="S4.E6.m1.1.1.3">tcl</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.1c">\displaystyle\mathcal{L}_{\text{tcl}}</annotation><annotation encoding="application/x-llamapun" id="S4.E6.m1.1d">caligraphic_L start_POSTSUBSCRIPT tcl end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=-\log\frac{\exp(h(x_{q},x_{p}^{+}))/\tau}{\sum_{j=1}^{2N}{%
\mathds{1}}_{j\neq q}\exp(h(x_{q},x_{j}))/\tau}," class="ltx_Math" display="inline" id="S4.E6.m2.5"><semantics id="S4.E6.m2.5a"><mrow id="S4.E6.m2.5.5.1" xref="S4.E6.m2.5.5.1.1.cmml"><mrow id="S4.E6.m2.5.5.1.1" xref="S4.E6.m2.5.5.1.1.cmml"><mi id="S4.E6.m2.5.5.1.1.2" xref="S4.E6.m2.5.5.1.1.2.cmml"></mi><mo id="S4.E6.m2.5.5.1.1.1" xref="S4.E6.m2.5.5.1.1.1.cmml">=</mo><mrow id="S4.E6.m2.5.5.1.1.3" xref="S4.E6.m2.5.5.1.1.3.cmml"><mo id="S4.E6.m2.5.5.1.1.3a" rspace="0.167em" xref="S4.E6.m2.5.5.1.1.3.cmml">−</mo><mrow id="S4.E6.m2.5.5.1.1.3.2" xref="S4.E6.m2.5.5.1.1.3.2.cmml"><mi id="S4.E6.m2.5.5.1.1.3.2.1" xref="S4.E6.m2.5.5.1.1.3.2.1.cmml">log</mi><mo id="S4.E6.m2.5.5.1.1.3.2a" lspace="0.167em" xref="S4.E6.m2.5.5.1.1.3.2.cmml">⁡</mo><mstyle displaystyle="true" id="S4.E6.m2.4.4" xref="S4.E6.m2.4.4.cmml"><mfrac id="S4.E6.m2.4.4a" xref="S4.E6.m2.4.4.cmml"><mrow id="S4.E6.m2.2.2.2" xref="S4.E6.m2.2.2.2.cmml"><mrow id="S4.E6.m2.2.2.2.2.1" xref="S4.E6.m2.2.2.2.2.2.cmml"><mi id="S4.E6.m2.1.1.1.1" xref="S4.E6.m2.1.1.1.1.cmml">exp</mi><mo id="S4.E6.m2.2.2.2.2.1a" xref="S4.E6.m2.2.2.2.2.2.cmml">⁡</mo><mrow id="S4.E6.m2.2.2.2.2.1.1" xref="S4.E6.m2.2.2.2.2.2.cmml"><mo id="S4.E6.m2.2.2.2.2.1.1.2" stretchy="false" xref="S4.E6.m2.2.2.2.2.2.cmml">(</mo><mrow id="S4.E6.m2.2.2.2.2.1.1.1" xref="S4.E6.m2.2.2.2.2.1.1.1.cmml"><mi id="S4.E6.m2.2.2.2.2.1.1.1.4" xref="S4.E6.m2.2.2.2.2.1.1.1.4.cmml">h</mi><mo id="S4.E6.m2.2.2.2.2.1.1.1.3" xref="S4.E6.m2.2.2.2.2.1.1.1.3.cmml">⁢</mo><mrow id="S4.E6.m2.2.2.2.2.1.1.1.2.2" xref="S4.E6.m2.2.2.2.2.1.1.1.2.3.cmml"><mo id="S4.E6.m2.2.2.2.2.1.1.1.2.2.3" stretchy="false" xref="S4.E6.m2.2.2.2.2.1.1.1.2.3.cmml">(</mo><msub id="S4.E6.m2.2.2.2.2.1.1.1.1.1.1" xref="S4.E6.m2.2.2.2.2.1.1.1.1.1.1.cmml"><mi id="S4.E6.m2.2.2.2.2.1.1.1.1.1.1.2" xref="S4.E6.m2.2.2.2.2.1.1.1.1.1.1.2.cmml">x</mi><mi id="S4.E6.m2.2.2.2.2.1.1.1.1.1.1.3" xref="S4.E6.m2.2.2.2.2.1.1.1.1.1.1.3.cmml">q</mi></msub><mo id="S4.E6.m2.2.2.2.2.1.1.1.2.2.4" xref="S4.E6.m2.2.2.2.2.1.1.1.2.3.cmml">,</mo><msubsup id="S4.E6.m2.2.2.2.2.1.1.1.2.2.2" xref="S4.E6.m2.2.2.2.2.1.1.1.2.2.2.cmml"><mi id="S4.E6.m2.2.2.2.2.1.1.1.2.2.2.2.2" xref="S4.E6.m2.2.2.2.2.1.1.1.2.2.2.2.2.cmml">x</mi><mi id="S4.E6.m2.2.2.2.2.1.1.1.2.2.2.2.3" xref="S4.E6.m2.2.2.2.2.1.1.1.2.2.2.2.3.cmml">p</mi><mo id="S4.E6.m2.2.2.2.2.1.1.1.2.2.2.3" xref="S4.E6.m2.2.2.2.2.1.1.1.2.2.2.3.cmml">+</mo></msubsup><mo id="S4.E6.m2.2.2.2.2.1.1.1.2.2.5" stretchy="false" xref="S4.E6.m2.2.2.2.2.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E6.m2.2.2.2.2.1.1.3" stretchy="false" xref="S4.E6.m2.2.2.2.2.2.cmml">)</mo></mrow></mrow><mo id="S4.E6.m2.2.2.2.3" xref="S4.E6.m2.2.2.2.3.cmml">/</mo><mi id="S4.E6.m2.2.2.2.4" xref="S4.E6.m2.2.2.2.4.cmml">τ</mi></mrow><mrow id="S4.E6.m2.4.4.4" xref="S4.E6.m2.4.4.4.cmml"><msubsup id="S4.E6.m2.4.4.4.3" xref="S4.E6.m2.4.4.4.3.cmml"><mo id="S4.E6.m2.4.4.4.3.2.2" xref="S4.E6.m2.4.4.4.3.2.2.cmml">∑</mo><mrow id="S4.E6.m2.4.4.4.3.2.3" xref="S4.E6.m2.4.4.4.3.2.3.cmml"><mi id="S4.E6.m2.4.4.4.3.2.3.2" xref="S4.E6.m2.4.4.4.3.2.3.2.cmml">j</mi><mo id="S4.E6.m2.4.4.4.3.2.3.1" xref="S4.E6.m2.4.4.4.3.2.3.1.cmml">=</mo><mn id="S4.E6.m2.4.4.4.3.2.3.3" xref="S4.E6.m2.4.4.4.3.2.3.3.cmml">1</mn></mrow><mrow id="S4.E6.m2.4.4.4.3.3" xref="S4.E6.m2.4.4.4.3.3.cmml"><mn id="S4.E6.m2.4.4.4.3.3.2" xref="S4.E6.m2.4.4.4.3.3.2.cmml">2</mn><mo id="S4.E6.m2.4.4.4.3.3.1" xref="S4.E6.m2.4.4.4.3.3.1.cmml">⁢</mo><mi id="S4.E6.m2.4.4.4.3.3.3" xref="S4.E6.m2.4.4.4.3.3.3.cmml">N</mi></mrow></msubsup><mrow id="S4.E6.m2.4.4.4.2" xref="S4.E6.m2.4.4.4.2.cmml"><mrow id="S4.E6.m2.4.4.4.2.1" xref="S4.E6.m2.4.4.4.2.1.cmml"><msub id="S4.E6.m2.4.4.4.2.1.3" xref="S4.E6.m2.4.4.4.2.1.3.cmml"><mn id="S4.E6.m2.4.4.4.2.1.3.2" xref="S4.E6.m2.4.4.4.2.1.3.2.cmml">𝟙</mn><mrow id="S4.E6.m2.4.4.4.2.1.3.3" xref="S4.E6.m2.4.4.4.2.1.3.3.cmml"><mi id="S4.E6.m2.4.4.4.2.1.3.3.2" xref="S4.E6.m2.4.4.4.2.1.3.3.2.cmml">j</mi><mo id="S4.E6.m2.4.4.4.2.1.3.3.1" xref="S4.E6.m2.4.4.4.2.1.3.3.1.cmml">≠</mo><mi id="S4.E6.m2.4.4.4.2.1.3.3.3" xref="S4.E6.m2.4.4.4.2.1.3.3.3.cmml">q</mi></mrow></msub><mo id="S4.E6.m2.4.4.4.2.1.2" lspace="0.167em" xref="S4.E6.m2.4.4.4.2.1.2.cmml">⁢</mo><mrow id="S4.E6.m2.4.4.4.2.1.1.1" xref="S4.E6.m2.4.4.4.2.1.1.2.cmml"><mi id="S4.E6.m2.3.3.3.1" xref="S4.E6.m2.3.3.3.1.cmml">exp</mi><mo id="S4.E6.m2.4.4.4.2.1.1.1a" xref="S4.E6.m2.4.4.4.2.1.1.2.cmml">⁡</mo><mrow id="S4.E6.m2.4.4.4.2.1.1.1.1" xref="S4.E6.m2.4.4.4.2.1.1.2.cmml"><mo id="S4.E6.m2.4.4.4.2.1.1.1.1.2" stretchy="false" xref="S4.E6.m2.4.4.4.2.1.1.2.cmml">(</mo><mrow id="S4.E6.m2.4.4.4.2.1.1.1.1.1" xref="S4.E6.m2.4.4.4.2.1.1.1.1.1.cmml"><mi id="S4.E6.m2.4.4.4.2.1.1.1.1.1.4" xref="S4.E6.m2.4.4.4.2.1.1.1.1.1.4.cmml">h</mi><mo id="S4.E6.m2.4.4.4.2.1.1.1.1.1.3" xref="S4.E6.m2.4.4.4.2.1.1.1.1.1.3.cmml">⁢</mo><mrow id="S4.E6.m2.4.4.4.2.1.1.1.1.1.2.2" xref="S4.E6.m2.4.4.4.2.1.1.1.1.1.2.3.cmml"><mo id="S4.E6.m2.4.4.4.2.1.1.1.1.1.2.2.3" stretchy="false" xref="S4.E6.m2.4.4.4.2.1.1.1.1.1.2.3.cmml">(</mo><msub id="S4.E6.m2.4.4.4.2.1.1.1.1.1.1.1.1" xref="S4.E6.m2.4.4.4.2.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E6.m2.4.4.4.2.1.1.1.1.1.1.1.1.2" xref="S4.E6.m2.4.4.4.2.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S4.E6.m2.4.4.4.2.1.1.1.1.1.1.1.1.3" xref="S4.E6.m2.4.4.4.2.1.1.1.1.1.1.1.1.3.cmml">q</mi></msub><mo id="S4.E6.m2.4.4.4.2.1.1.1.1.1.2.2.4" xref="S4.E6.m2.4.4.4.2.1.1.1.1.1.2.3.cmml">,</mo><msub id="S4.E6.m2.4.4.4.2.1.1.1.1.1.2.2.2" xref="S4.E6.m2.4.4.4.2.1.1.1.1.1.2.2.2.cmml"><mi id="S4.E6.m2.4.4.4.2.1.1.1.1.1.2.2.2.2" xref="S4.E6.m2.4.4.4.2.1.1.1.1.1.2.2.2.2.cmml">x</mi><mi id="S4.E6.m2.4.4.4.2.1.1.1.1.1.2.2.2.3" xref="S4.E6.m2.4.4.4.2.1.1.1.1.1.2.2.2.3.cmml">j</mi></msub><mo id="S4.E6.m2.4.4.4.2.1.1.1.1.1.2.2.5" stretchy="false" xref="S4.E6.m2.4.4.4.2.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E6.m2.4.4.4.2.1.1.1.1.3" stretchy="false" xref="S4.E6.m2.4.4.4.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E6.m2.4.4.4.2.2" xref="S4.E6.m2.4.4.4.2.2.cmml">/</mo><mi id="S4.E6.m2.4.4.4.2.3" xref="S4.E6.m2.4.4.4.2.3.cmml">τ</mi></mrow></mrow></mfrac></mstyle></mrow></mrow></mrow><mo id="S4.E6.m2.5.5.1.2" xref="S4.E6.m2.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m2.5b"><apply id="S4.E6.m2.5.5.1.1.cmml" xref="S4.E6.m2.5.5.1"><eq id="S4.E6.m2.5.5.1.1.1.cmml" xref="S4.E6.m2.5.5.1.1.1"></eq><csymbol cd="latexml" id="S4.E6.m2.5.5.1.1.2.cmml" xref="S4.E6.m2.5.5.1.1.2">absent</csymbol><apply id="S4.E6.m2.5.5.1.1.3.cmml" xref="S4.E6.m2.5.5.1.1.3"><minus id="S4.E6.m2.5.5.1.1.3.1.cmml" xref="S4.E6.m2.5.5.1.1.3"></minus><apply id="S4.E6.m2.5.5.1.1.3.2.cmml" xref="S4.E6.m2.5.5.1.1.3.2"><log id="S4.E6.m2.5.5.1.1.3.2.1.cmml" xref="S4.E6.m2.5.5.1.1.3.2.1"></log><apply id="S4.E6.m2.4.4.cmml" xref="S4.E6.m2.4.4"><divide id="S4.E6.m2.4.4.5.cmml" xref="S4.E6.m2.4.4"></divide><apply id="S4.E6.m2.2.2.2.cmml" xref="S4.E6.m2.2.2.2"><divide id="S4.E6.m2.2.2.2.3.cmml" xref="S4.E6.m2.2.2.2.3"></divide><apply id="S4.E6.m2.2.2.2.2.2.cmml" xref="S4.E6.m2.2.2.2.2.1"><exp id="S4.E6.m2.1.1.1.1.cmml" xref="S4.E6.m2.1.1.1.1"></exp><apply id="S4.E6.m2.2.2.2.2.1.1.1.cmml" xref="S4.E6.m2.2.2.2.2.1.1.1"><times id="S4.E6.m2.2.2.2.2.1.1.1.3.cmml" xref="S4.E6.m2.2.2.2.2.1.1.1.3"></times><ci id="S4.E6.m2.2.2.2.2.1.1.1.4.cmml" xref="S4.E6.m2.2.2.2.2.1.1.1.4">ℎ</ci><interval closure="open" id="S4.E6.m2.2.2.2.2.1.1.1.2.3.cmml" xref="S4.E6.m2.2.2.2.2.1.1.1.2.2"><apply id="S4.E6.m2.2.2.2.2.1.1.1.1.1.1.cmml" xref="S4.E6.m2.2.2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m2.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E6.m2.2.2.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E6.m2.2.2.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E6.m2.2.2.2.2.1.1.1.1.1.1.2">𝑥</ci><ci id="S4.E6.m2.2.2.2.2.1.1.1.1.1.1.3.cmml" xref="S4.E6.m2.2.2.2.2.1.1.1.1.1.1.3">𝑞</ci></apply><apply id="S4.E6.m2.2.2.2.2.1.1.1.2.2.2.cmml" xref="S4.E6.m2.2.2.2.2.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E6.m2.2.2.2.2.1.1.1.2.2.2.1.cmml" xref="S4.E6.m2.2.2.2.2.1.1.1.2.2.2">superscript</csymbol><apply id="S4.E6.m2.2.2.2.2.1.1.1.2.2.2.2.cmml" xref="S4.E6.m2.2.2.2.2.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E6.m2.2.2.2.2.1.1.1.2.2.2.2.1.cmml" xref="S4.E6.m2.2.2.2.2.1.1.1.2.2.2">subscript</csymbol><ci id="S4.E6.m2.2.2.2.2.1.1.1.2.2.2.2.2.cmml" xref="S4.E6.m2.2.2.2.2.1.1.1.2.2.2.2.2">𝑥</ci><ci id="S4.E6.m2.2.2.2.2.1.1.1.2.2.2.2.3.cmml" xref="S4.E6.m2.2.2.2.2.1.1.1.2.2.2.2.3">𝑝</ci></apply><plus id="S4.E6.m2.2.2.2.2.1.1.1.2.2.2.3.cmml" xref="S4.E6.m2.2.2.2.2.1.1.1.2.2.2.3"></plus></apply></interval></apply></apply><ci id="S4.E6.m2.2.2.2.4.cmml" xref="S4.E6.m2.2.2.2.4">𝜏</ci></apply><apply id="S4.E6.m2.4.4.4.cmml" xref="S4.E6.m2.4.4.4"><apply id="S4.E6.m2.4.4.4.3.cmml" xref="S4.E6.m2.4.4.4.3"><csymbol cd="ambiguous" id="S4.E6.m2.4.4.4.3.1.cmml" xref="S4.E6.m2.4.4.4.3">superscript</csymbol><apply id="S4.E6.m2.4.4.4.3.2.cmml" xref="S4.E6.m2.4.4.4.3"><csymbol cd="ambiguous" id="S4.E6.m2.4.4.4.3.2.1.cmml" xref="S4.E6.m2.4.4.4.3">subscript</csymbol><sum id="S4.E6.m2.4.4.4.3.2.2.cmml" xref="S4.E6.m2.4.4.4.3.2.2"></sum><apply id="S4.E6.m2.4.4.4.3.2.3.cmml" xref="S4.E6.m2.4.4.4.3.2.3"><eq id="S4.E6.m2.4.4.4.3.2.3.1.cmml" xref="S4.E6.m2.4.4.4.3.2.3.1"></eq><ci id="S4.E6.m2.4.4.4.3.2.3.2.cmml" xref="S4.E6.m2.4.4.4.3.2.3.2">𝑗</ci><cn id="S4.E6.m2.4.4.4.3.2.3.3.cmml" type="integer" xref="S4.E6.m2.4.4.4.3.2.3.3">1</cn></apply></apply><apply id="S4.E6.m2.4.4.4.3.3.cmml" xref="S4.E6.m2.4.4.4.3.3"><times id="S4.E6.m2.4.4.4.3.3.1.cmml" xref="S4.E6.m2.4.4.4.3.3.1"></times><cn id="S4.E6.m2.4.4.4.3.3.2.cmml" type="integer" xref="S4.E6.m2.4.4.4.3.3.2">2</cn><ci id="S4.E6.m2.4.4.4.3.3.3.cmml" xref="S4.E6.m2.4.4.4.3.3.3">𝑁</ci></apply></apply><apply id="S4.E6.m2.4.4.4.2.cmml" xref="S4.E6.m2.4.4.4.2"><divide id="S4.E6.m2.4.4.4.2.2.cmml" xref="S4.E6.m2.4.4.4.2.2"></divide><apply id="S4.E6.m2.4.4.4.2.1.cmml" xref="S4.E6.m2.4.4.4.2.1"><times id="S4.E6.m2.4.4.4.2.1.2.cmml" xref="S4.E6.m2.4.4.4.2.1.2"></times><apply id="S4.E6.m2.4.4.4.2.1.3.cmml" xref="S4.E6.m2.4.4.4.2.1.3"><csymbol cd="ambiguous" id="S4.E6.m2.4.4.4.2.1.3.1.cmml" xref="S4.E6.m2.4.4.4.2.1.3">subscript</csymbol><cn id="S4.E6.m2.4.4.4.2.1.3.2.cmml" type="integer" xref="S4.E6.m2.4.4.4.2.1.3.2">1</cn><apply id="S4.E6.m2.4.4.4.2.1.3.3.cmml" xref="S4.E6.m2.4.4.4.2.1.3.3"><neq id="S4.E6.m2.4.4.4.2.1.3.3.1.cmml" xref="S4.E6.m2.4.4.4.2.1.3.3.1"></neq><ci id="S4.E6.m2.4.4.4.2.1.3.3.2.cmml" xref="S4.E6.m2.4.4.4.2.1.3.3.2">𝑗</ci><ci id="S4.E6.m2.4.4.4.2.1.3.3.3.cmml" xref="S4.E6.m2.4.4.4.2.1.3.3.3">𝑞</ci></apply></apply><apply id="S4.E6.m2.4.4.4.2.1.1.2.cmml" xref="S4.E6.m2.4.4.4.2.1.1.1"><exp id="S4.E6.m2.3.3.3.1.cmml" xref="S4.E6.m2.3.3.3.1"></exp><apply id="S4.E6.m2.4.4.4.2.1.1.1.1.1.cmml" xref="S4.E6.m2.4.4.4.2.1.1.1.1.1"><times id="S4.E6.m2.4.4.4.2.1.1.1.1.1.3.cmml" xref="S4.E6.m2.4.4.4.2.1.1.1.1.1.3"></times><ci id="S4.E6.m2.4.4.4.2.1.1.1.1.1.4.cmml" xref="S4.E6.m2.4.4.4.2.1.1.1.1.1.4">ℎ</ci><interval closure="open" id="S4.E6.m2.4.4.4.2.1.1.1.1.1.2.3.cmml" xref="S4.E6.m2.4.4.4.2.1.1.1.1.1.2.2"><apply id="S4.E6.m2.4.4.4.2.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m2.4.4.4.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m2.4.4.4.2.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m2.4.4.4.2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E6.m2.4.4.4.2.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E6.m2.4.4.4.2.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S4.E6.m2.4.4.4.2.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E6.m2.4.4.4.2.1.1.1.1.1.1.1.1.3">𝑞</ci></apply><apply id="S4.E6.m2.4.4.4.2.1.1.1.1.1.2.2.2.cmml" xref="S4.E6.m2.4.4.4.2.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E6.m2.4.4.4.2.1.1.1.1.1.2.2.2.1.cmml" xref="S4.E6.m2.4.4.4.2.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S4.E6.m2.4.4.4.2.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E6.m2.4.4.4.2.1.1.1.1.1.2.2.2.2">𝑥</ci><ci id="S4.E6.m2.4.4.4.2.1.1.1.1.1.2.2.2.3.cmml" xref="S4.E6.m2.4.4.4.2.1.1.1.1.1.2.2.2.3">𝑗</ci></apply></interval></apply></apply></apply><ci id="S4.E6.m2.4.4.4.2.3.cmml" xref="S4.E6.m2.4.4.4.2.3">𝜏</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m2.5c">\displaystyle=-\log\frac{\exp(h(x_{q},x_{p}^{+}))/\tau}{\sum_{j=1}^{2N}{%
\mathds{1}}_{j\neq q}\exp(h(x_{q},x_{j}))/\tau},</annotation><annotation encoding="application/x-llamapun" id="S4.E6.m2.5d">= - roman_log divide start_ARG roman_exp ( italic_h ( italic_x start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT ) ) / italic_τ end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 italic_N end_POSTSUPERSCRIPT blackboard_1 start_POSTSUBSCRIPT italic_j ≠ italic_q end_POSTSUBSCRIPT roman_exp ( italic_h ( italic_x start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ) / italic_τ end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.SSS0.Px2.p2.4">where <math alttext="x_{p}^{+}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px2.p2.1.m1.1"><semantics id="S4.SS1.SSS0.Px2.p2.1.m1.1a"><msubsup id="S4.SS1.SSS0.Px2.p2.1.m1.1.1" xref="S4.SS1.SSS0.Px2.p2.1.m1.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p2.1.m1.1.1.2.2" xref="S4.SS1.SSS0.Px2.p2.1.m1.1.1.2.2.cmml">x</mi><mi id="S4.SS1.SSS0.Px2.p2.1.m1.1.1.2.3" xref="S4.SS1.SSS0.Px2.p2.1.m1.1.1.2.3.cmml">p</mi><mo id="S4.SS1.SSS0.Px2.p2.1.m1.1.1.3" xref="S4.SS1.SSS0.Px2.p2.1.m1.1.1.3.cmml">+</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p2.1.m1.1b"><apply id="S4.SS1.SSS0.Px2.p2.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p2.1.m1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p2.1.m1.1.1">superscript</csymbol><apply id="S4.SS1.SSS0.Px2.p2.1.m1.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p2.1.m1.1.1.2.1.cmml" xref="S4.SS1.SSS0.Px2.p2.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p2.1.m1.1.1.2.2.cmml" xref="S4.SS1.SSS0.Px2.p2.1.m1.1.1.2.2">𝑥</ci><ci id="S4.SS1.SSS0.Px2.p2.1.m1.1.1.2.3.cmml" xref="S4.SS1.SSS0.Px2.p2.1.m1.1.1.2.3">𝑝</ci></apply><plus id="S4.SS1.SSS0.Px2.p2.1.m1.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p2.1.m1.1.1.3"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p2.1.m1.1c">x_{p}^{+}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px2.p2.1.m1.1d">italic_x start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT</annotation></semantics></math> denotes the positive sample of <math alttext="x_{q}" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px2.p2.2.m2.1"><semantics id="S4.SS1.SSS0.Px2.p2.2.m2.1a"><msub id="S4.SS1.SSS0.Px2.p2.2.m2.1.1" xref="S4.SS1.SSS0.Px2.p2.2.m2.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p2.2.m2.1.1.2" xref="S4.SS1.SSS0.Px2.p2.2.m2.1.1.2.cmml">x</mi><mi id="S4.SS1.SSS0.Px2.p2.2.m2.1.1.3" xref="S4.SS1.SSS0.Px2.p2.2.m2.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p2.2.m2.1b"><apply id="S4.SS1.SSS0.Px2.p2.2.m2.1.1.cmml" xref="S4.SS1.SSS0.Px2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p2.2.m2.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p2.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p2.2.m2.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p2.2.m2.1.1.2">𝑥</ci><ci id="S4.SS1.SSS0.Px2.p2.2.m2.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p2.2.m2.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p2.2.m2.1c">x_{q}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px2.p2.2.m2.1d">italic_x start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="N" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px2.p2.3.m3.1"><semantics id="S4.SS1.SSS0.Px2.p2.3.m3.1a"><mi id="S4.SS1.SSS0.Px2.p2.3.m3.1.1" xref="S4.SS1.SSS0.Px2.p2.3.m3.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p2.3.m3.1b"><ci id="S4.SS1.SSS0.Px2.p2.3.m3.1.1.cmml" xref="S4.SS1.SSS0.Px2.p2.3.m3.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p2.3.m3.1c">N</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px2.p2.3.m3.1d">italic_N</annotation></semantics></math> is the batch size, and
<math alttext="\tau" class="ltx_Math" display="inline" id="S4.SS1.SSS0.Px2.p2.4.m4.1"><semantics id="S4.SS1.SSS0.Px2.p2.4.m4.1a"><mi id="S4.SS1.SSS0.Px2.p2.4.m4.1.1" xref="S4.SS1.SSS0.Px2.p2.4.m4.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p2.4.m4.1b"><ci id="S4.SS1.SSS0.Px2.p2.4.m4.1.1.cmml" xref="S4.SS1.SSS0.Px2.p2.4.m4.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p2.4.m4.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS0.Px2.p2.4.m4.1d">italic_τ</annotation></semantics></math> is the temperature parameter.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS1.SSSx1">
<h4 class="ltx_title ltx_title_subsubsection">Context-aware Contrastive Learning.</h4>
<div class="ltx_para" id="S4.SS1.SSSx1.p1">
<p class="ltx_p" id="S4.SS1.SSSx1.p1.1">To better capture the inherent contextual pattern, we further adopt context-aware contrastive learning with data augmentations. For each sequence, we apply two types of augmentations: masking and cropping, which are widely used for sequence modeling <cite class="ltx_cite ltx_citemacro_citep">(Devlin et al. <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib5" title="">2019</a>; Xie et al. <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib30" title="">2022</a>)</cite>. The masking operator randomly replaces a portion of the tokens in the sequence with a special masking token. The cropping operator randomly deletes a contiguous subsequence from the original sequence, reducing the sequence length while preserving the temporal order of the interactions. These augmentations help the model learn robust representations and capture the inherent structural information of the sequence by focusing on its different parts.</p>
</div>
<div class="ltx_para" id="S4.SS1.SSSx1.p2">
<p class="ltx_p" id="S4.SS1.SSSx1.p2.3">We treat two augmented views of the same sequence as positive pairs, and those of different sequences as negative pairs.
Given a sequence <math alttext="x_{q}" class="ltx_Math" display="inline" id="S4.SS1.SSSx1.p2.1.m1.1"><semantics id="S4.SS1.SSSx1.p2.1.m1.1a"><msub id="S4.SS1.SSSx1.p2.1.m1.1.1" xref="S4.SS1.SSSx1.p2.1.m1.1.1.cmml"><mi id="S4.SS1.SSSx1.p2.1.m1.1.1.2" xref="S4.SS1.SSSx1.p2.1.m1.1.1.2.cmml">x</mi><mi id="S4.SS1.SSSx1.p2.1.m1.1.1.3" xref="S4.SS1.SSSx1.p2.1.m1.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSSx1.p2.1.m1.1b"><apply id="S4.SS1.SSSx1.p2.1.m1.1.1.cmml" xref="S4.SS1.SSSx1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSSx1.p2.1.m1.1.1.1.cmml" xref="S4.SS1.SSSx1.p2.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.SSSx1.p2.1.m1.1.1.2.cmml" xref="S4.SS1.SSSx1.p2.1.m1.1.1.2">𝑥</ci><ci id="S4.SS1.SSSx1.p2.1.m1.1.1.3.cmml" xref="S4.SS1.SSSx1.p2.1.m1.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSSx1.p2.1.m1.1c">x_{q}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSSx1.p2.1.m1.1d">italic_x start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> and its two distinct augmented views <math alttext="x^{\prime}_{q}" class="ltx_Math" display="inline" id="S4.SS1.SSSx1.p2.2.m2.1"><semantics id="S4.SS1.SSSx1.p2.2.m2.1a"><msubsup id="S4.SS1.SSSx1.p2.2.m2.1.1" xref="S4.SS1.SSSx1.p2.2.m2.1.1.cmml"><mi id="S4.SS1.SSSx1.p2.2.m2.1.1.2.2" xref="S4.SS1.SSSx1.p2.2.m2.1.1.2.2.cmml">x</mi><mi id="S4.SS1.SSSx1.p2.2.m2.1.1.3" xref="S4.SS1.SSSx1.p2.2.m2.1.1.3.cmml">q</mi><mo id="S4.SS1.SSSx1.p2.2.m2.1.1.2.3" xref="S4.SS1.SSSx1.p2.2.m2.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSSx1.p2.2.m2.1b"><apply id="S4.SS1.SSSx1.p2.2.m2.1.1.cmml" xref="S4.SS1.SSSx1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSSx1.p2.2.m2.1.1.1.cmml" xref="S4.SS1.SSSx1.p2.2.m2.1.1">subscript</csymbol><apply id="S4.SS1.SSSx1.p2.2.m2.1.1.2.cmml" xref="S4.SS1.SSSx1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSSx1.p2.2.m2.1.1.2.1.cmml" xref="S4.SS1.SSSx1.p2.2.m2.1.1">superscript</csymbol><ci id="S4.SS1.SSSx1.p2.2.m2.1.1.2.2.cmml" xref="S4.SS1.SSSx1.p2.2.m2.1.1.2.2">𝑥</ci><ci id="S4.SS1.SSSx1.p2.2.m2.1.1.2.3.cmml" xref="S4.SS1.SSSx1.p2.2.m2.1.1.2.3">′</ci></apply><ci id="S4.SS1.SSSx1.p2.2.m2.1.1.3.cmml" xref="S4.SS1.SSSx1.p2.2.m2.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSSx1.p2.2.m2.1c">x^{\prime}_{q}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSSx1.p2.2.m2.1d">italic_x start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="x^{\prime\prime}_{q}" class="ltx_Math" display="inline" id="S4.SS1.SSSx1.p2.3.m3.1"><semantics id="S4.SS1.SSSx1.p2.3.m3.1a"><msubsup id="S4.SS1.SSSx1.p2.3.m3.1.1" xref="S4.SS1.SSSx1.p2.3.m3.1.1.cmml"><mi id="S4.SS1.SSSx1.p2.3.m3.1.1.2.2" xref="S4.SS1.SSSx1.p2.3.m3.1.1.2.2.cmml">x</mi><mi id="S4.SS1.SSSx1.p2.3.m3.1.1.3" xref="S4.SS1.SSSx1.p2.3.m3.1.1.3.cmml">q</mi><mo id="S4.SS1.SSSx1.p2.3.m3.1.1.2.3" xref="S4.SS1.SSSx1.p2.3.m3.1.1.2.3.cmml">′′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSSx1.p2.3.m3.1b"><apply id="S4.SS1.SSSx1.p2.3.m3.1.1.cmml" xref="S4.SS1.SSSx1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSSx1.p2.3.m3.1.1.1.cmml" xref="S4.SS1.SSSx1.p2.3.m3.1.1">subscript</csymbol><apply id="S4.SS1.SSSx1.p2.3.m3.1.1.2.cmml" xref="S4.SS1.SSSx1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSSx1.p2.3.m3.1.1.2.1.cmml" xref="S4.SS1.SSSx1.p2.3.m3.1.1">superscript</csymbol><ci id="S4.SS1.SSSx1.p2.3.m3.1.1.2.2.cmml" xref="S4.SS1.SSSx1.p2.3.m3.1.1.2.2">𝑥</ci><ci id="S4.SS1.SSSx1.p2.3.m3.1.1.2.3.cmml" xref="S4.SS1.SSSx1.p2.3.m3.1.1.2.3">′′</ci></apply><ci id="S4.SS1.SSSx1.p2.3.m3.1.1.3.cmml" xref="S4.SS1.SSSx1.p2.3.m3.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSSx1.p2.3.m3.1c">x^{\prime\prime}_{q}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSSx1.p2.3.m3.1d">italic_x start_POSTSUPERSCRIPT ′ ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math>, the contrastive loss is defined as:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\text{ccl}}=-\log\frac{\exp(s(x^{\prime}_{q},x^{\prime\prime}_{q}%
)/\tau)}{\sum_{j=1}^{2N}{\mathds{1}}_{j\neq q}\exp s(x^{\prime}_{q},x^{\prime}%
_{j})/\tau}," class="ltx_Math" display="block" id="S4.E7.m1.5"><semantics id="S4.E7.m1.5a"><mrow id="S4.E7.m1.5.5.1" xref="S4.E7.m1.5.5.1.1.cmml"><mrow id="S4.E7.m1.5.5.1.1" xref="S4.E7.m1.5.5.1.1.cmml"><msub id="S4.E7.m1.5.5.1.1.2" xref="S4.E7.m1.5.5.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E7.m1.5.5.1.1.2.2" xref="S4.E7.m1.5.5.1.1.2.2.cmml">ℒ</mi><mtext id="S4.E7.m1.5.5.1.1.2.3" xref="S4.E7.m1.5.5.1.1.2.3a.cmml">ccl</mtext></msub><mo id="S4.E7.m1.5.5.1.1.1" xref="S4.E7.m1.5.5.1.1.1.cmml">=</mo><mrow id="S4.E7.m1.5.5.1.1.3" xref="S4.E7.m1.5.5.1.1.3.cmml"><mo id="S4.E7.m1.5.5.1.1.3a" rspace="0.167em" xref="S4.E7.m1.5.5.1.1.3.cmml">−</mo><mrow id="S4.E7.m1.5.5.1.1.3.2" xref="S4.E7.m1.5.5.1.1.3.2.cmml"><mi id="S4.E7.m1.5.5.1.1.3.2.1" xref="S4.E7.m1.5.5.1.1.3.2.1.cmml">log</mi><mo id="S4.E7.m1.5.5.1.1.3.2a" lspace="0.167em" xref="S4.E7.m1.5.5.1.1.3.2.cmml">⁡</mo><mfrac id="S4.E7.m1.4.4" xref="S4.E7.m1.4.4.cmml"><mrow id="S4.E7.m1.2.2.2.2" xref="S4.E7.m1.2.2.2.3.cmml"><mi id="S4.E7.m1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.cmml">exp</mi><mo id="S4.E7.m1.2.2.2.2a" xref="S4.E7.m1.2.2.2.3.cmml">⁡</mo><mrow id="S4.E7.m1.2.2.2.2.1" xref="S4.E7.m1.2.2.2.3.cmml"><mo id="S4.E7.m1.2.2.2.2.1.2" stretchy="false" xref="S4.E7.m1.2.2.2.3.cmml">(</mo><mrow id="S4.E7.m1.2.2.2.2.1.1" xref="S4.E7.m1.2.2.2.2.1.1.cmml"><mrow id="S4.E7.m1.2.2.2.2.1.1.2" xref="S4.E7.m1.2.2.2.2.1.1.2.cmml"><mi id="S4.E7.m1.2.2.2.2.1.1.2.4" xref="S4.E7.m1.2.2.2.2.1.1.2.4.cmml">s</mi><mo id="S4.E7.m1.2.2.2.2.1.1.2.3" xref="S4.E7.m1.2.2.2.2.1.1.2.3.cmml">⁢</mo><mrow id="S4.E7.m1.2.2.2.2.1.1.2.2.2" xref="S4.E7.m1.2.2.2.2.1.1.2.2.3.cmml"><mo id="S4.E7.m1.2.2.2.2.1.1.2.2.2.3" stretchy="false" xref="S4.E7.m1.2.2.2.2.1.1.2.2.3.cmml">(</mo><msubsup id="S4.E7.m1.2.2.2.2.1.1.1.1.1.1" xref="S4.E7.m1.2.2.2.2.1.1.1.1.1.1.cmml"><mi id="S4.E7.m1.2.2.2.2.1.1.1.1.1.1.2.2" xref="S4.E7.m1.2.2.2.2.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S4.E7.m1.2.2.2.2.1.1.1.1.1.1.3" xref="S4.E7.m1.2.2.2.2.1.1.1.1.1.1.3.cmml">q</mi><mo id="S4.E7.m1.2.2.2.2.1.1.1.1.1.1.2.3" xref="S4.E7.m1.2.2.2.2.1.1.1.1.1.1.2.3.cmml">′</mo></msubsup><mo id="S4.E7.m1.2.2.2.2.1.1.2.2.2.4" xref="S4.E7.m1.2.2.2.2.1.1.2.2.3.cmml">,</mo><msubsup id="S4.E7.m1.2.2.2.2.1.1.2.2.2.2" xref="S4.E7.m1.2.2.2.2.1.1.2.2.2.2.cmml"><mi id="S4.E7.m1.2.2.2.2.1.1.2.2.2.2.2.2" xref="S4.E7.m1.2.2.2.2.1.1.2.2.2.2.2.2.cmml">x</mi><mi id="S4.E7.m1.2.2.2.2.1.1.2.2.2.2.3" xref="S4.E7.m1.2.2.2.2.1.1.2.2.2.2.3.cmml">q</mi><mo id="S4.E7.m1.2.2.2.2.1.1.2.2.2.2.2.3" xref="S4.E7.m1.2.2.2.2.1.1.2.2.2.2.2.3.cmml">′′</mo></msubsup><mo id="S4.E7.m1.2.2.2.2.1.1.2.2.2.5" stretchy="false" xref="S4.E7.m1.2.2.2.2.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E7.m1.2.2.2.2.1.1.3" xref="S4.E7.m1.2.2.2.2.1.1.3.cmml">/</mo><mi id="S4.E7.m1.2.2.2.2.1.1.4" xref="S4.E7.m1.2.2.2.2.1.1.4.cmml">τ</mi></mrow><mo id="S4.E7.m1.2.2.2.2.1.3" stretchy="false" xref="S4.E7.m1.2.2.2.3.cmml">)</mo></mrow></mrow><mrow id="S4.E7.m1.4.4.4" xref="S4.E7.m1.4.4.4.cmml"><msubsup id="S4.E7.m1.4.4.4.3" xref="S4.E7.m1.4.4.4.3.cmml"><mo id="S4.E7.m1.4.4.4.3.2.2" xref="S4.E7.m1.4.4.4.3.2.2.cmml">∑</mo><mrow id="S4.E7.m1.4.4.4.3.2.3" xref="S4.E7.m1.4.4.4.3.2.3.cmml"><mi id="S4.E7.m1.4.4.4.3.2.3.2" xref="S4.E7.m1.4.4.4.3.2.3.2.cmml">j</mi><mo id="S4.E7.m1.4.4.4.3.2.3.1" xref="S4.E7.m1.4.4.4.3.2.3.1.cmml">=</mo><mn id="S4.E7.m1.4.4.4.3.2.3.3" xref="S4.E7.m1.4.4.4.3.2.3.3.cmml">1</mn></mrow><mrow id="S4.E7.m1.4.4.4.3.3" xref="S4.E7.m1.4.4.4.3.3.cmml"><mn id="S4.E7.m1.4.4.4.3.3.2" xref="S4.E7.m1.4.4.4.3.3.2.cmml">2</mn><mo id="S4.E7.m1.4.4.4.3.3.1" xref="S4.E7.m1.4.4.4.3.3.1.cmml">⁢</mo><mi id="S4.E7.m1.4.4.4.3.3.3" xref="S4.E7.m1.4.4.4.3.3.3.cmml">N</mi></mrow></msubsup><mrow id="S4.E7.m1.4.4.4.2" xref="S4.E7.m1.4.4.4.2.cmml"><mrow id="S4.E7.m1.4.4.4.2.2" xref="S4.E7.m1.4.4.4.2.2.cmml"><msub id="S4.E7.m1.4.4.4.2.2.4" xref="S4.E7.m1.4.4.4.2.2.4.cmml"><mn id="S4.E7.m1.4.4.4.2.2.4.2" xref="S4.E7.m1.4.4.4.2.2.4.2.cmml">𝟙</mn><mrow id="S4.E7.m1.4.4.4.2.2.4.3" xref="S4.E7.m1.4.4.4.2.2.4.3.cmml"><mi id="S4.E7.m1.4.4.4.2.2.4.3.2" xref="S4.E7.m1.4.4.4.2.2.4.3.2.cmml">j</mi><mo id="S4.E7.m1.4.4.4.2.2.4.3.1" xref="S4.E7.m1.4.4.4.2.2.4.3.1.cmml">≠</mo><mi id="S4.E7.m1.4.4.4.2.2.4.3.3" xref="S4.E7.m1.4.4.4.2.2.4.3.3.cmml">q</mi></mrow></msub><mo id="S4.E7.m1.4.4.4.2.2.3" lspace="0.167em" xref="S4.E7.m1.4.4.4.2.2.3.cmml">⁢</mo><mrow id="S4.E7.m1.4.4.4.2.2.5" xref="S4.E7.m1.4.4.4.2.2.5.cmml"><mi id="S4.E7.m1.4.4.4.2.2.5.1" xref="S4.E7.m1.4.4.4.2.2.5.1.cmml">exp</mi><mo id="S4.E7.m1.4.4.4.2.2.5a" lspace="0.167em" xref="S4.E7.m1.4.4.4.2.2.5.cmml">⁡</mo><mi id="S4.E7.m1.4.4.4.2.2.5.2" xref="S4.E7.m1.4.4.4.2.2.5.2.cmml">s</mi></mrow><mo id="S4.E7.m1.4.4.4.2.2.3a" xref="S4.E7.m1.4.4.4.2.2.3.cmml">⁢</mo><mrow id="S4.E7.m1.4.4.4.2.2.2.2" xref="S4.E7.m1.4.4.4.2.2.2.3.cmml"><mo id="S4.E7.m1.4.4.4.2.2.2.2.3" stretchy="false" xref="S4.E7.m1.4.4.4.2.2.2.3.cmml">(</mo><msubsup id="S4.E7.m1.3.3.3.1.1.1.1.1" xref="S4.E7.m1.3.3.3.1.1.1.1.1.cmml"><mi id="S4.E7.m1.3.3.3.1.1.1.1.1.2.2" xref="S4.E7.m1.3.3.3.1.1.1.1.1.2.2.cmml">x</mi><mi id="S4.E7.m1.3.3.3.1.1.1.1.1.3" xref="S4.E7.m1.3.3.3.1.1.1.1.1.3.cmml">q</mi><mo id="S4.E7.m1.3.3.3.1.1.1.1.1.2.3" xref="S4.E7.m1.3.3.3.1.1.1.1.1.2.3.cmml">′</mo></msubsup><mo id="S4.E7.m1.4.4.4.2.2.2.2.4" xref="S4.E7.m1.4.4.4.2.2.2.3.cmml">,</mo><msubsup id="S4.E7.m1.4.4.4.2.2.2.2.2" xref="S4.E7.m1.4.4.4.2.2.2.2.2.cmml"><mi id="S4.E7.m1.4.4.4.2.2.2.2.2.2.2" xref="S4.E7.m1.4.4.4.2.2.2.2.2.2.2.cmml">x</mi><mi id="S4.E7.m1.4.4.4.2.2.2.2.2.3" xref="S4.E7.m1.4.4.4.2.2.2.2.2.3.cmml">j</mi><mo id="S4.E7.m1.4.4.4.2.2.2.2.2.2.3" xref="S4.E7.m1.4.4.4.2.2.2.2.2.2.3.cmml">′</mo></msubsup><mo id="S4.E7.m1.4.4.4.2.2.2.2.5" stretchy="false" xref="S4.E7.m1.4.4.4.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E7.m1.4.4.4.2.3" xref="S4.E7.m1.4.4.4.2.3.cmml">/</mo><mi id="S4.E7.m1.4.4.4.2.4" xref="S4.E7.m1.4.4.4.2.4.cmml">τ</mi></mrow></mrow></mfrac></mrow></mrow></mrow><mo id="S4.E7.m1.5.5.1.2" xref="S4.E7.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E7.m1.5b"><apply id="S4.E7.m1.5.5.1.1.cmml" xref="S4.E7.m1.5.5.1"><eq id="S4.E7.m1.5.5.1.1.1.cmml" xref="S4.E7.m1.5.5.1.1.1"></eq><apply id="S4.E7.m1.5.5.1.1.2.cmml" xref="S4.E7.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S4.E7.m1.5.5.1.1.2.1.cmml" xref="S4.E7.m1.5.5.1.1.2">subscript</csymbol><ci id="S4.E7.m1.5.5.1.1.2.2.cmml" xref="S4.E7.m1.5.5.1.1.2.2">ℒ</ci><ci id="S4.E7.m1.5.5.1.1.2.3a.cmml" xref="S4.E7.m1.5.5.1.1.2.3"><mtext id="S4.E7.m1.5.5.1.1.2.3.cmml" mathsize="70%" xref="S4.E7.m1.5.5.1.1.2.3">ccl</mtext></ci></apply><apply id="S4.E7.m1.5.5.1.1.3.cmml" xref="S4.E7.m1.5.5.1.1.3"><minus id="S4.E7.m1.5.5.1.1.3.1.cmml" xref="S4.E7.m1.5.5.1.1.3"></minus><apply id="S4.E7.m1.5.5.1.1.3.2.cmml" xref="S4.E7.m1.5.5.1.1.3.2"><log id="S4.E7.m1.5.5.1.1.3.2.1.cmml" xref="S4.E7.m1.5.5.1.1.3.2.1"></log><apply id="S4.E7.m1.4.4.cmml" xref="S4.E7.m1.4.4"><divide id="S4.E7.m1.4.4.5.cmml" xref="S4.E7.m1.4.4"></divide><apply id="S4.E7.m1.2.2.2.3.cmml" xref="S4.E7.m1.2.2.2.2"><exp id="S4.E7.m1.1.1.1.1.cmml" xref="S4.E7.m1.1.1.1.1"></exp><apply id="S4.E7.m1.2.2.2.2.1.1.cmml" xref="S4.E7.m1.2.2.2.2.1.1"><divide id="S4.E7.m1.2.2.2.2.1.1.3.cmml" xref="S4.E7.m1.2.2.2.2.1.1.3"></divide><apply id="S4.E7.m1.2.2.2.2.1.1.2.cmml" xref="S4.E7.m1.2.2.2.2.1.1.2"><times id="S4.E7.m1.2.2.2.2.1.1.2.3.cmml" xref="S4.E7.m1.2.2.2.2.1.1.2.3"></times><ci id="S4.E7.m1.2.2.2.2.1.1.2.4.cmml" xref="S4.E7.m1.2.2.2.2.1.1.2.4">𝑠</ci><interval closure="open" id="S4.E7.m1.2.2.2.2.1.1.2.2.3.cmml" xref="S4.E7.m1.2.2.2.2.1.1.2.2.2"><apply id="S4.E7.m1.2.2.2.2.1.1.1.1.1.1.cmml" xref="S4.E7.m1.2.2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.2.2.2.2.1.1.1.1.1.1">subscript</csymbol><apply id="S4.E7.m1.2.2.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.2.2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.2.2.2.2.1.1.1.1.1.1.2.1.cmml" xref="S4.E7.m1.2.2.2.2.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E7.m1.2.2.2.2.1.1.1.1.1.1.2.2.cmml" xref="S4.E7.m1.2.2.2.2.1.1.1.1.1.1.2.2">𝑥</ci><ci id="S4.E7.m1.2.2.2.2.1.1.1.1.1.1.2.3.cmml" xref="S4.E7.m1.2.2.2.2.1.1.1.1.1.1.2.3">′</ci></apply><ci id="S4.E7.m1.2.2.2.2.1.1.1.1.1.1.3.cmml" xref="S4.E7.m1.2.2.2.2.1.1.1.1.1.1.3">𝑞</ci></apply><apply id="S4.E7.m1.2.2.2.2.1.1.2.2.2.2.cmml" xref="S4.E7.m1.2.2.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E7.m1.2.2.2.2.1.1.2.2.2.2.1.cmml" xref="S4.E7.m1.2.2.2.2.1.1.2.2.2.2">subscript</csymbol><apply id="S4.E7.m1.2.2.2.2.1.1.2.2.2.2.2.cmml" xref="S4.E7.m1.2.2.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E7.m1.2.2.2.2.1.1.2.2.2.2.2.1.cmml" xref="S4.E7.m1.2.2.2.2.1.1.2.2.2.2">superscript</csymbol><ci id="S4.E7.m1.2.2.2.2.1.1.2.2.2.2.2.2.cmml" xref="S4.E7.m1.2.2.2.2.1.1.2.2.2.2.2.2">𝑥</ci><ci id="S4.E7.m1.2.2.2.2.1.1.2.2.2.2.2.3.cmml" xref="S4.E7.m1.2.2.2.2.1.1.2.2.2.2.2.3">′′</ci></apply><ci id="S4.E7.m1.2.2.2.2.1.1.2.2.2.2.3.cmml" xref="S4.E7.m1.2.2.2.2.1.1.2.2.2.2.3">𝑞</ci></apply></interval></apply><ci id="S4.E7.m1.2.2.2.2.1.1.4.cmml" xref="S4.E7.m1.2.2.2.2.1.1.4">𝜏</ci></apply></apply><apply id="S4.E7.m1.4.4.4.cmml" xref="S4.E7.m1.4.4.4"><apply id="S4.E7.m1.4.4.4.3.cmml" xref="S4.E7.m1.4.4.4.3"><csymbol cd="ambiguous" id="S4.E7.m1.4.4.4.3.1.cmml" xref="S4.E7.m1.4.4.4.3">superscript</csymbol><apply id="S4.E7.m1.4.4.4.3.2.cmml" xref="S4.E7.m1.4.4.4.3"><csymbol cd="ambiguous" id="S4.E7.m1.4.4.4.3.2.1.cmml" xref="S4.E7.m1.4.4.4.3">subscript</csymbol><sum id="S4.E7.m1.4.4.4.3.2.2.cmml" xref="S4.E7.m1.4.4.4.3.2.2"></sum><apply id="S4.E7.m1.4.4.4.3.2.3.cmml" xref="S4.E7.m1.4.4.4.3.2.3"><eq id="S4.E7.m1.4.4.4.3.2.3.1.cmml" xref="S4.E7.m1.4.4.4.3.2.3.1"></eq><ci id="S4.E7.m1.4.4.4.3.2.3.2.cmml" xref="S4.E7.m1.4.4.4.3.2.3.2">𝑗</ci><cn id="S4.E7.m1.4.4.4.3.2.3.3.cmml" type="integer" xref="S4.E7.m1.4.4.4.3.2.3.3">1</cn></apply></apply><apply id="S4.E7.m1.4.4.4.3.3.cmml" xref="S4.E7.m1.4.4.4.3.3"><times id="S4.E7.m1.4.4.4.3.3.1.cmml" xref="S4.E7.m1.4.4.4.3.3.1"></times><cn id="S4.E7.m1.4.4.4.3.3.2.cmml" type="integer" xref="S4.E7.m1.4.4.4.3.3.2">2</cn><ci id="S4.E7.m1.4.4.4.3.3.3.cmml" xref="S4.E7.m1.4.4.4.3.3.3">𝑁</ci></apply></apply><apply id="S4.E7.m1.4.4.4.2.cmml" xref="S4.E7.m1.4.4.4.2"><divide id="S4.E7.m1.4.4.4.2.3.cmml" xref="S4.E7.m1.4.4.4.2.3"></divide><apply id="S4.E7.m1.4.4.4.2.2.cmml" xref="S4.E7.m1.4.4.4.2.2"><times id="S4.E7.m1.4.4.4.2.2.3.cmml" xref="S4.E7.m1.4.4.4.2.2.3"></times><apply id="S4.E7.m1.4.4.4.2.2.4.cmml" xref="S4.E7.m1.4.4.4.2.2.4"><csymbol cd="ambiguous" id="S4.E7.m1.4.4.4.2.2.4.1.cmml" xref="S4.E7.m1.4.4.4.2.2.4">subscript</csymbol><cn id="S4.E7.m1.4.4.4.2.2.4.2.cmml" type="integer" xref="S4.E7.m1.4.4.4.2.2.4.2">1</cn><apply id="S4.E7.m1.4.4.4.2.2.4.3.cmml" xref="S4.E7.m1.4.4.4.2.2.4.3"><neq id="S4.E7.m1.4.4.4.2.2.4.3.1.cmml" xref="S4.E7.m1.4.4.4.2.2.4.3.1"></neq><ci id="S4.E7.m1.4.4.4.2.2.4.3.2.cmml" xref="S4.E7.m1.4.4.4.2.2.4.3.2">𝑗</ci><ci id="S4.E7.m1.4.4.4.2.2.4.3.3.cmml" xref="S4.E7.m1.4.4.4.2.2.4.3.3">𝑞</ci></apply></apply><apply id="S4.E7.m1.4.4.4.2.2.5.cmml" xref="S4.E7.m1.4.4.4.2.2.5"><exp id="S4.E7.m1.4.4.4.2.2.5.1.cmml" xref="S4.E7.m1.4.4.4.2.2.5.1"></exp><ci id="S4.E7.m1.4.4.4.2.2.5.2.cmml" xref="S4.E7.m1.4.4.4.2.2.5.2">𝑠</ci></apply><interval closure="open" id="S4.E7.m1.4.4.4.2.2.2.3.cmml" xref="S4.E7.m1.4.4.4.2.2.2.2"><apply id="S4.E7.m1.3.3.3.1.1.1.1.1.cmml" xref="S4.E7.m1.3.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.3.1.1.1.1.1.1.cmml" xref="S4.E7.m1.3.3.3.1.1.1.1.1">subscript</csymbol><apply id="S4.E7.m1.3.3.3.1.1.1.1.1.2.cmml" xref="S4.E7.m1.3.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.3.1.1.1.1.1.2.1.cmml" xref="S4.E7.m1.3.3.3.1.1.1.1.1">superscript</csymbol><ci id="S4.E7.m1.3.3.3.1.1.1.1.1.2.2.cmml" xref="S4.E7.m1.3.3.3.1.1.1.1.1.2.2">𝑥</ci><ci id="S4.E7.m1.3.3.3.1.1.1.1.1.2.3.cmml" xref="S4.E7.m1.3.3.3.1.1.1.1.1.2.3">′</ci></apply><ci id="S4.E7.m1.3.3.3.1.1.1.1.1.3.cmml" xref="S4.E7.m1.3.3.3.1.1.1.1.1.3">𝑞</ci></apply><apply id="S4.E7.m1.4.4.4.2.2.2.2.2.cmml" xref="S4.E7.m1.4.4.4.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E7.m1.4.4.4.2.2.2.2.2.1.cmml" xref="S4.E7.m1.4.4.4.2.2.2.2.2">subscript</csymbol><apply id="S4.E7.m1.4.4.4.2.2.2.2.2.2.cmml" xref="S4.E7.m1.4.4.4.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E7.m1.4.4.4.2.2.2.2.2.2.1.cmml" xref="S4.E7.m1.4.4.4.2.2.2.2.2">superscript</csymbol><ci id="S4.E7.m1.4.4.4.2.2.2.2.2.2.2.cmml" xref="S4.E7.m1.4.4.4.2.2.2.2.2.2.2">𝑥</ci><ci id="S4.E7.m1.4.4.4.2.2.2.2.2.2.3.cmml" xref="S4.E7.m1.4.4.4.2.2.2.2.2.2.3">′</ci></apply><ci id="S4.E7.m1.4.4.4.2.2.2.2.2.3.cmml" xref="S4.E7.m1.4.4.4.2.2.2.2.2.3">𝑗</ci></apply></interval></apply><ci id="S4.E7.m1.4.4.4.2.4.cmml" xref="S4.E7.m1.4.4.4.2.4">𝜏</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7.m1.5c">\mathcal{L}_{\text{ccl}}=-\log\frac{\exp(s(x^{\prime}_{q},x^{\prime\prime}_{q}%
)/\tau)}{\sum_{j=1}^{2N}{\mathds{1}}_{j\neq q}\exp s(x^{\prime}_{q},x^{\prime}%
_{j})/\tau},</annotation><annotation encoding="application/x-llamapun" id="S4.E7.m1.5d">caligraphic_L start_POSTSUBSCRIPT ccl end_POSTSUBSCRIPT = - roman_log divide start_ARG roman_exp ( italic_s ( italic_x start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT , italic_x start_POSTSUPERSCRIPT ′ ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ) / italic_τ ) end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 italic_N end_POSTSUPERSCRIPT blackboard_1 start_POSTSUBSCRIPT italic_j ≠ italic_q end_POSTSUBSCRIPT roman_exp italic_s ( italic_x start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT , italic_x start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) / italic_τ end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.SSSx1.p2.6">where <math alttext="\tau" class="ltx_Math" display="inline" id="S4.SS1.SSSx1.p2.4.m1.1"><semantics id="S4.SS1.SSSx1.p2.4.m1.1a"><mi id="S4.SS1.SSSx1.p2.4.m1.1.1" xref="S4.SS1.SSSx1.p2.4.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSSx1.p2.4.m1.1b"><ci id="S4.SS1.SSSx1.p2.4.m1.1.1.cmml" xref="S4.SS1.SSSx1.p2.4.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSSx1.p2.4.m1.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSSx1.p2.4.m1.1d">italic_τ</annotation></semantics></math> is the temperature, <math alttext="N" class="ltx_Math" display="inline" id="S4.SS1.SSSx1.p2.5.m2.1"><semantics id="S4.SS1.SSSx1.p2.5.m2.1a"><mi id="S4.SS1.SSSx1.p2.5.m2.1.1" xref="S4.SS1.SSSx1.p2.5.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSSx1.p2.5.m2.1b"><ci id="S4.SS1.SSSx1.p2.5.m2.1.1.cmml" xref="S4.SS1.SSSx1.p2.5.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSSx1.p2.5.m2.1c">N</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSSx1.p2.5.m2.1d">italic_N</annotation></semantics></math> is the batch size and <math alttext="\mathds{1}" class="ltx_Math" display="inline" id="S4.SS1.SSSx1.p2.6.m3.1"><semantics id="S4.SS1.SSSx1.p2.6.m3.1a"><mn id="S4.SS1.SSSx1.p2.6.m3.1.1" xref="S4.SS1.SSSx1.p2.6.m3.1.1.cmml">𝟙</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.SSSx1.p2.6.m3.1b"><cn id="S4.SS1.SSSx1.p2.6.m3.1.1.cmml" type="integer" xref="S4.SS1.SSSx1.p2.6.m3.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSSx1.p2.6.m3.1c">\mathds{1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSSx1.p2.6.m3.1d">blackboard_1</annotation></semantics></math> is an indicator function.</p>
</div>
<section class="ltx_paragraph" id="S4.SS1.SSSx1.Px1">
<h5 class="ltx_title ltx_title_paragraph">Training and Inference for Retrieval.</h5>
<div class="ltx_para" id="S4.SS1.SSSx1.Px1.p1">
<p class="ltx_p" id="S4.SS1.SSSx1.Px1.p1.2">The training objective of our retrieval model is defined as:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\text{ret}}=\mathcal{L}_{\text{tcl}}+\alpha\mathcal{L}_{\text{ccl}}" class="ltx_Math" display="block" id="S4.E8.m1.1"><semantics id="S4.E8.m1.1a"><mrow id="S4.E8.m1.1.1" xref="S4.E8.m1.1.1.cmml"><msub id="S4.E8.m1.1.1.2" xref="S4.E8.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E8.m1.1.1.2.2" xref="S4.E8.m1.1.1.2.2.cmml">ℒ</mi><mtext id="S4.E8.m1.1.1.2.3" xref="S4.E8.m1.1.1.2.3a.cmml">ret</mtext></msub><mo id="S4.E8.m1.1.1.1" xref="S4.E8.m1.1.1.1.cmml">=</mo><mrow id="S4.E8.m1.1.1.3" xref="S4.E8.m1.1.1.3.cmml"><msub id="S4.E8.m1.1.1.3.2" xref="S4.E8.m1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E8.m1.1.1.3.2.2" xref="S4.E8.m1.1.1.3.2.2.cmml">ℒ</mi><mtext id="S4.E8.m1.1.1.3.2.3" xref="S4.E8.m1.1.1.3.2.3a.cmml">tcl</mtext></msub><mo id="S4.E8.m1.1.1.3.1" xref="S4.E8.m1.1.1.3.1.cmml">+</mo><mrow id="S4.E8.m1.1.1.3.3" xref="S4.E8.m1.1.1.3.3.cmml"><mi id="S4.E8.m1.1.1.3.3.2" xref="S4.E8.m1.1.1.3.3.2.cmml">α</mi><mo id="S4.E8.m1.1.1.3.3.1" xref="S4.E8.m1.1.1.3.3.1.cmml">⁢</mo><msub id="S4.E8.m1.1.1.3.3.3" xref="S4.E8.m1.1.1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E8.m1.1.1.3.3.3.2" xref="S4.E8.m1.1.1.3.3.3.2.cmml">ℒ</mi><mtext id="S4.E8.m1.1.1.3.3.3.3" xref="S4.E8.m1.1.1.3.3.3.3a.cmml">ccl</mtext></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E8.m1.1b"><apply id="S4.E8.m1.1.1.cmml" xref="S4.E8.m1.1.1"><eq id="S4.E8.m1.1.1.1.cmml" xref="S4.E8.m1.1.1.1"></eq><apply id="S4.E8.m1.1.1.2.cmml" xref="S4.E8.m1.1.1.2"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.2.1.cmml" xref="S4.E8.m1.1.1.2">subscript</csymbol><ci id="S4.E8.m1.1.1.2.2.cmml" xref="S4.E8.m1.1.1.2.2">ℒ</ci><ci id="S4.E8.m1.1.1.2.3a.cmml" xref="S4.E8.m1.1.1.2.3"><mtext id="S4.E8.m1.1.1.2.3.cmml" mathsize="70%" xref="S4.E8.m1.1.1.2.3">ret</mtext></ci></apply><apply id="S4.E8.m1.1.1.3.cmml" xref="S4.E8.m1.1.1.3"><plus id="S4.E8.m1.1.1.3.1.cmml" xref="S4.E8.m1.1.1.3.1"></plus><apply id="S4.E8.m1.1.1.3.2.cmml" xref="S4.E8.m1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.3.2.1.cmml" xref="S4.E8.m1.1.1.3.2">subscript</csymbol><ci id="S4.E8.m1.1.1.3.2.2.cmml" xref="S4.E8.m1.1.1.3.2.2">ℒ</ci><ci id="S4.E8.m1.1.1.3.2.3a.cmml" xref="S4.E8.m1.1.1.3.2.3"><mtext id="S4.E8.m1.1.1.3.2.3.cmml" mathsize="70%" xref="S4.E8.m1.1.1.3.2.3">tcl</mtext></ci></apply><apply id="S4.E8.m1.1.1.3.3.cmml" xref="S4.E8.m1.1.1.3.3"><times id="S4.E8.m1.1.1.3.3.1.cmml" xref="S4.E8.m1.1.1.3.3.1"></times><ci id="S4.E8.m1.1.1.3.3.2.cmml" xref="S4.E8.m1.1.1.3.3.2">𝛼</ci><apply id="S4.E8.m1.1.1.3.3.3.cmml" xref="S4.E8.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.3.3.3.1.cmml" xref="S4.E8.m1.1.1.3.3.3">subscript</csymbol><ci id="S4.E8.m1.1.1.3.3.3.2.cmml" xref="S4.E8.m1.1.1.3.3.3.2">ℒ</ci><ci id="S4.E8.m1.1.1.3.3.3.3a.cmml" xref="S4.E8.m1.1.1.3.3.3.3"><mtext id="S4.E8.m1.1.1.3.3.3.3.cmml" mathsize="70%" xref="S4.E8.m1.1.1.3.3.3.3">ccl</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8.m1.1c">\mathcal{L}_{\text{ret}}=\mathcal{L}_{\text{tcl}}+\alpha\mathcal{L}_{\text{ccl}}</annotation><annotation encoding="application/x-llamapun" id="S4.E8.m1.1d">caligraphic_L start_POSTSUBSCRIPT ret end_POSTSUBSCRIPT = caligraphic_L start_POSTSUBSCRIPT tcl end_POSTSUBSCRIPT + italic_α caligraphic_L start_POSTSUBSCRIPT ccl end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.SSSx1.Px1.p1.1">where <math alttext="\alpha" class="ltx_Math" display="inline" id="S4.SS1.SSSx1.Px1.p1.1.m1.1"><semantics id="S4.SS1.SSSx1.Px1.p1.1.m1.1a"><mi id="S4.SS1.SSSx1.Px1.p1.1.m1.1.1" xref="S4.SS1.SSSx1.Px1.p1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSSx1.Px1.p1.1.m1.1b"><ci id="S4.SS1.SSSx1.Px1.p1.1.m1.1.1.cmml" xref="S4.SS1.SSSx1.Px1.p1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSSx1.Px1.p1.1.m1.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSSx1.Px1.p1.1.m1.1d">italic_α</annotation></semantics></math> is a coefficient that controls the balance between the two losses.</p>
</div>
<div class="ltx_para" id="S4.SS1.SSSx1.Px1.p2">
<p class="ltx_p" id="S4.SS1.SSSx1.Px1.p2.1">During testing, we utilize the updated sequence model to extract sequence representations and perform demonstration ranking
based on the contextual similarity between the query and candidates.</p>
</div>
</section>
</section>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Graph Fusion-based Generator</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.2">After retrieval, we obtain the top-<span class="ltx_text ltx_font_italic" id="S4.SS2.p1.2.1">K</span> demonstrations <math alttext="R_{q}=\{(x_{k},y_{k})\}_{k=1}^{K}" class="ltx_Math" display="inline" id="S4.SS2.p1.1.m1.1"><semantics id="S4.SS2.p1.1.m1.1a"><mrow id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml"><msub id="S4.SS2.p1.1.m1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.3.cmml"><mi id="S4.SS2.p1.1.m1.1.1.3.2" xref="S4.SS2.p1.1.m1.1.1.3.2.cmml">R</mi><mi id="S4.SS2.p1.1.m1.1.1.3.3" xref="S4.SS2.p1.1.m1.1.1.3.3.cmml">q</mi></msub><mo id="S4.SS2.p1.1.m1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.2.cmml">=</mo><msubsup id="S4.SS2.p1.1.m1.1.1.1" xref="S4.SS2.p1.1.m1.1.1.1.cmml"><mrow id="S4.SS2.p1.1.m1.1.1.1.1.1.1" xref="S4.SS2.p1.1.m1.1.1.1.1.1.2.cmml"><mo id="S4.SS2.p1.1.m1.1.1.1.1.1.1.2" stretchy="false" xref="S4.SS2.p1.1.m1.1.1.1.1.1.2.cmml">{</mo><mrow id="S4.SS2.p1.1.m1.1.1.1.1.1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.1.1.1.1.1.3.cmml"><mo id="S4.SS2.p1.1.m1.1.1.1.1.1.1.1.2.3" stretchy="false" xref="S4.SS2.p1.1.m1.1.1.1.1.1.1.1.3.cmml">(</mo><msub id="S4.SS2.p1.1.m1.1.1.1.1.1.1.1.1.1" xref="S4.SS2.p1.1.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.SS2.p1.1.m1.1.1.1.1.1.1.1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S4.SS2.p1.1.m1.1.1.1.1.1.1.1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S4.SS2.p1.1.m1.1.1.1.1.1.1.1.2.4" xref="S4.SS2.p1.1.m1.1.1.1.1.1.1.1.3.cmml">,</mo><msub id="S4.SS2.p1.1.m1.1.1.1.1.1.1.1.2.2" xref="S4.SS2.p1.1.m1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S4.SS2.p1.1.m1.1.1.1.1.1.1.1.2.2.2" xref="S4.SS2.p1.1.m1.1.1.1.1.1.1.1.2.2.2.cmml">y</mi><mi id="S4.SS2.p1.1.m1.1.1.1.1.1.1.1.2.2.3" xref="S4.SS2.p1.1.m1.1.1.1.1.1.1.1.2.2.3.cmml">k</mi></msub><mo id="S4.SS2.p1.1.m1.1.1.1.1.1.1.1.2.5" stretchy="false" xref="S4.SS2.p1.1.m1.1.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo id="S4.SS2.p1.1.m1.1.1.1.1.1.1.3" stretchy="false" xref="S4.SS2.p1.1.m1.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S4.SS2.p1.1.m1.1.1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.1.1.3.cmml"><mi id="S4.SS2.p1.1.m1.1.1.1.1.3.2" xref="S4.SS2.p1.1.m1.1.1.1.1.3.2.cmml">k</mi><mo id="S4.SS2.p1.1.m1.1.1.1.1.3.1" xref="S4.SS2.p1.1.m1.1.1.1.1.3.1.cmml">=</mo><mn id="S4.SS2.p1.1.m1.1.1.1.1.3.3" xref="S4.SS2.p1.1.m1.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S4.SS2.p1.1.m1.1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.1.3.cmml">K</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><apply id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1"><eq id="S4.SS2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.2"></eq><apply id="S4.SS2.p1.1.m1.1.1.3.cmml" xref="S4.SS2.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.1.1.3.1.cmml" xref="S4.SS2.p1.1.m1.1.1.3">subscript</csymbol><ci id="S4.SS2.p1.1.m1.1.1.3.2.cmml" xref="S4.SS2.p1.1.m1.1.1.3.2">𝑅</ci><ci id="S4.SS2.p1.1.m1.1.1.3.3.cmml" xref="S4.SS2.p1.1.m1.1.1.3.3">𝑞</ci></apply><apply id="S4.SS2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.1">superscript</csymbol><apply id="S4.SS2.p1.1.m1.1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.1.1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.1">subscript</csymbol><set id="S4.SS2.p1.1.m1.1.1.1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.1.1"><interval closure="open" id="S4.SS2.p1.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.1.1.1.2"><apply id="S4.SS2.p1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS2.p1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S4.SS2.p1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S4.SS2.p1.1.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S4.SS2.p1.1.m1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.1.1.1.2.2.2">𝑦</ci><ci id="S4.SS2.p1.1.m1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.1.1.1.2.2.3">𝑘</ci></apply></interval></set><apply id="S4.SS2.p1.1.m1.1.1.1.1.3.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.3"><eq id="S4.SS2.p1.1.m1.1.1.1.1.3.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.3.1"></eq><ci id="S4.SS2.p1.1.m1.1.1.1.1.3.2.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.3.2">𝑘</ci><cn id="S4.SS2.p1.1.m1.1.1.1.1.3.3.cmml" type="integer" xref="S4.SS2.p1.1.m1.1.1.1.1.3.3">1</cn></apply></apply><ci id="S4.SS2.p1.1.m1.1.1.1.3.cmml" xref="S4.SS2.p1.1.m1.1.1.1.3">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">R_{q}=\{(x_{k},y_{k})\}_{k=1}^{K}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.1.m1.1d">italic_R start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT = { ( italic_x start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) } start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT</annotation></semantics></math> for the query <math alttext="x_{q}" class="ltx_Math" display="inline" id="S4.SS2.p1.2.m2.1"><semantics id="S4.SS2.p1.2.m2.1a"><msub id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml"><mi id="S4.SS2.p1.2.m2.1.1.2" xref="S4.SS2.p1.2.m2.1.1.2.cmml">x</mi><mi id="S4.SS2.p1.2.m2.1.1.3" xref="S4.SS2.p1.2.m2.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><apply id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m2.1.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.p1.2.m2.1.1.2.cmml" xref="S4.SS2.p1.2.m2.1.1.2">𝑥</ci><ci id="S4.SS2.p1.2.m2.1.1.3.cmml" xref="S4.SS2.p1.2.m2.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">x_{q}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.2.m2.1d">italic_x start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math>. A straightforward approach is concatenating them with the query sequence. However, this can lead to a lengthy context that limits the model’s prediction capabilities. More importantly, it neglects the structural patterns among these demonstrations. Thus, we first fuse the demonstrations into a summary graph, process it using a GNN, and then prepend the graph readout from the GNN to the query for subsequent generation.</p>
</div>
<section class="ltx_subsubsection" id="S4.SS2.SSSx1">
<h4 class="ltx_title ltx_title_subsubsection">Graph Fusion.</h4>
<div class="ltx_para" id="S4.SS2.SSSx1.p1">
<p class="ltx_p" id="S4.SS2.SSSx1.p1.4">To effectively fuse the demonstrations in <math alttext="R_{q}" class="ltx_Math" display="inline" id="S4.SS2.SSSx1.p1.1.m1.1"><semantics id="S4.SS2.SSSx1.p1.1.m1.1a"><msub id="S4.SS2.SSSx1.p1.1.m1.1.1" xref="S4.SS2.SSSx1.p1.1.m1.1.1.cmml"><mi id="S4.SS2.SSSx1.p1.1.m1.1.1.2" xref="S4.SS2.SSSx1.p1.1.m1.1.1.2.cmml">R</mi><mi id="S4.SS2.SSSx1.p1.1.m1.1.1.3" xref="S4.SS2.SSSx1.p1.1.m1.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSSx1.p1.1.m1.1b"><apply id="S4.SS2.SSSx1.p1.1.m1.1.1.cmml" xref="S4.SS2.SSSx1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSSx1.p1.1.m1.1.1.1.cmml" xref="S4.SS2.SSSx1.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.SSSx1.p1.1.m1.1.1.2.cmml" xref="S4.SS2.SSSx1.p1.1.m1.1.1.2">𝑅</ci><ci id="S4.SS2.SSSx1.p1.1.m1.1.1.3.cmml" xref="S4.SS2.SSSx1.p1.1.m1.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSSx1.p1.1.m1.1c">R_{q}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSSx1.p1.1.m1.1d">italic_R start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math>, we construct a summary graph, whose nodes include all tokens in the retrieved demonstrations, and edges represent the interactions between nodes within each sequence.
Considering that there are common tokens across the retrieved demonstrations (<span class="ltx_text ltx_font_italic" id="S4.SS2.SSSx1.p1.4.1">e.g.</span>, recurring nodes in multiple demonstrations and special tokens like <math alttext="[\textit{hist}]" class="ltx_Math" display="inline" id="S4.SS2.SSSx1.p1.2.m2.1"><semantics id="S4.SS2.SSSx1.p1.2.m2.1a"><mrow id="S4.SS2.SSSx1.p1.2.m2.1.2.2" xref="S4.SS2.SSSx1.p1.2.m2.1.2.1.cmml"><mo id="S4.SS2.SSSx1.p1.2.m2.1.2.2.1" stretchy="false" xref="S4.SS2.SSSx1.p1.2.m2.1.2.1.1.cmml">[</mo><mtext class="ltx_mathvariant_italic" id="S4.SS2.SSSx1.p1.2.m2.1.1" xref="S4.SS2.SSSx1.p1.2.m2.1.1a.cmml">hist</mtext><mo id="S4.SS2.SSSx1.p1.2.m2.1.2.2.2" stretchy="false" xref="S4.SS2.SSSx1.p1.2.m2.1.2.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSSx1.p1.2.m2.1b"><apply id="S4.SS2.SSSx1.p1.2.m2.1.2.1.cmml" xref="S4.SS2.SSSx1.p1.2.m2.1.2.2"><csymbol cd="latexml" id="S4.SS2.SSSx1.p1.2.m2.1.2.1.1.cmml" xref="S4.SS2.SSSx1.p1.2.m2.1.2.2.1">delimited-[]</csymbol><ci id="S4.SS2.SSSx1.p1.2.m2.1.1a.cmml" xref="S4.SS2.SSSx1.p1.2.m2.1.1"><mtext class="ltx_mathvariant_italic" id="S4.SS2.SSSx1.p1.2.m2.1.1.cmml" xref="S4.SS2.SSSx1.p1.2.m2.1.1">hist</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSSx1.p1.2.m2.1c">[\textit{hist}]</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSSx1.p1.2.m2.1d">[ hist ]</annotation></semantics></math>, <math alttext="[\textit{time1}]" class="ltx_Math" display="inline" id="S4.SS2.SSSx1.p1.3.m3.1"><semantics id="S4.SS2.SSSx1.p1.3.m3.1a"><mrow id="S4.SS2.SSSx1.p1.3.m3.1.2.2" xref="S4.SS2.SSSx1.p1.3.m3.1.2.1.cmml"><mo id="S4.SS2.SSSx1.p1.3.m3.1.2.2.1" stretchy="false" xref="S4.SS2.SSSx1.p1.3.m3.1.2.1.1.cmml">[</mo><mtext class="ltx_mathvariant_italic" id="S4.SS2.SSSx1.p1.3.m3.1.1" xref="S4.SS2.SSSx1.p1.3.m3.1.1a.cmml">time1</mtext><mo id="S4.SS2.SSSx1.p1.3.m3.1.2.2.2" stretchy="false" xref="S4.SS2.SSSx1.p1.3.m3.1.2.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSSx1.p1.3.m3.1b"><apply id="S4.SS2.SSSx1.p1.3.m3.1.2.1.cmml" xref="S4.SS2.SSSx1.p1.3.m3.1.2.2"><csymbol cd="latexml" id="S4.SS2.SSSx1.p1.3.m3.1.2.1.1.cmml" xref="S4.SS2.SSSx1.p1.3.m3.1.2.2.1">delimited-[]</csymbol><ci id="S4.SS2.SSSx1.p1.3.m3.1.1a.cmml" xref="S4.SS2.SSSx1.p1.3.m3.1.1"><mtext class="ltx_mathvariant_italic" id="S4.SS2.SSSx1.p1.3.m3.1.1.cmml" xref="S4.SS2.SSSx1.p1.3.m3.1.1">time1</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSSx1.p1.3.m3.1c">[\textit{time1}]</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSSx1.p1.3.m3.1d">[ time1 ]</annotation></semantics></math>, <span class="ltx_text ltx_font_italic" id="S4.SS2.SSSx1.p1.4.2">etc.</span>), we can fuse these demonstrations into a summary graph <math alttext="G_{\text{fus}}" class="ltx_Math" display="inline" id="S4.SS2.SSSx1.p1.4.m4.1"><semantics id="S4.SS2.SSSx1.p1.4.m4.1a"><msub id="S4.SS2.SSSx1.p1.4.m4.1.1" xref="S4.SS2.SSSx1.p1.4.m4.1.1.cmml"><mi id="S4.SS2.SSSx1.p1.4.m4.1.1.2" xref="S4.SS2.SSSx1.p1.4.m4.1.1.2.cmml">G</mi><mtext id="S4.SS2.SSSx1.p1.4.m4.1.1.3" xref="S4.SS2.SSSx1.p1.4.m4.1.1.3a.cmml">fus</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSSx1.p1.4.m4.1b"><apply id="S4.SS2.SSSx1.p1.4.m4.1.1.cmml" xref="S4.SS2.SSSx1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSSx1.p1.4.m4.1.1.1.cmml" xref="S4.SS2.SSSx1.p1.4.m4.1.1">subscript</csymbol><ci id="S4.SS2.SSSx1.p1.4.m4.1.1.2.cmml" xref="S4.SS2.SSSx1.p1.4.m4.1.1.2">𝐺</ci><ci id="S4.SS2.SSSx1.p1.4.m4.1.1.3a.cmml" xref="S4.SS2.SSSx1.p1.4.m4.1.1.3"><mtext id="S4.SS2.SSSx1.p1.4.m4.1.1.3.cmml" mathsize="70%" xref="S4.SS2.SSSx1.p1.4.m4.1.1.3">fus</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSSx1.p1.4.m4.1c">G_{\text{fus}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSSx1.p1.4.m4.1d">italic_G start_POSTSUBSCRIPT fus end_POSTSUBSCRIPT</annotation></semantics></math>.
We then employ a graph convolutional network (GCN) to capture the structural and contextual information within the fused graph, and apply a mean-pooling readout to obtain a representation vector for the graph. The vector is subsequently concatenated with the query sequence representation, as follows.</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A4.EGx4">
<tbody id="S4.E9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle e_{\text{fus}}" class="ltx_Math" display="inline" id="S4.E9.m1.1"><semantics id="S4.E9.m1.1a"><msub id="S4.E9.m1.1.1" xref="S4.E9.m1.1.1.cmml"><mi id="S4.E9.m1.1.1.2" xref="S4.E9.m1.1.1.2.cmml">e</mi><mtext id="S4.E9.m1.1.1.3" xref="S4.E9.m1.1.1.3a.cmml">fus</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.E9.m1.1b"><apply id="S4.E9.m1.1.1.cmml" xref="S4.E9.m1.1.1"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.cmml" xref="S4.E9.m1.1.1">subscript</csymbol><ci id="S4.E9.m1.1.1.2.cmml" xref="S4.E9.m1.1.1.2">𝑒</ci><ci id="S4.E9.m1.1.1.3a.cmml" xref="S4.E9.m1.1.1.3"><mtext id="S4.E9.m1.1.1.3.cmml" mathsize="70%" xref="S4.E9.m1.1.1.3">fus</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E9.m1.1c">\displaystyle e_{\text{fus}}</annotation><annotation encoding="application/x-llamapun" id="S4.E9.m1.1d">italic_e start_POSTSUBSCRIPT fus end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathtt{MeanPooling}(\text{GCN}(G_{\text{fus}}))," class="ltx_Math" display="inline" id="S4.E9.m2.1"><semantics id="S4.E9.m2.1a"><mrow id="S4.E9.m2.1.1.1" xref="S4.E9.m2.1.1.1.1.cmml"><mrow id="S4.E9.m2.1.1.1.1" xref="S4.E9.m2.1.1.1.1.cmml"><mi id="S4.E9.m2.1.1.1.1.3" xref="S4.E9.m2.1.1.1.1.3.cmml"></mi><mo id="S4.E9.m2.1.1.1.1.2" xref="S4.E9.m2.1.1.1.1.2.cmml">=</mo><mrow id="S4.E9.m2.1.1.1.1.1" xref="S4.E9.m2.1.1.1.1.1.cmml"><mi id="S4.E9.m2.1.1.1.1.1.3" xref="S4.E9.m2.1.1.1.1.1.3.cmml">𝙼𝚎𝚊𝚗𝙿𝚘𝚘𝚕𝚒𝚗𝚐</mi><mo id="S4.E9.m2.1.1.1.1.1.2" xref="S4.E9.m2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E9.m2.1.1.1.1.1.1.1" xref="S4.E9.m2.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E9.m2.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E9.m2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E9.m2.1.1.1.1.1.1.1.1" xref="S4.E9.m2.1.1.1.1.1.1.1.1.cmml"><mtext id="S4.E9.m2.1.1.1.1.1.1.1.1.3" xref="S4.E9.m2.1.1.1.1.1.1.1.1.3a.cmml">GCN</mtext><mo id="S4.E9.m2.1.1.1.1.1.1.1.1.2" xref="S4.E9.m2.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E9.m2.1.1.1.1.1.1.1.1.1.1" xref="S4.E9.m2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E9.m2.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E9.m2.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E9.m2.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E9.m2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E9.m2.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E9.m2.1.1.1.1.1.1.1.1.1.1.1.2.cmml">G</mi><mtext id="S4.E9.m2.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E9.m2.1.1.1.1.1.1.1.1.1.1.1.3a.cmml">fus</mtext></msub><mo id="S4.E9.m2.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E9.m2.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E9.m2.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E9.m2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E9.m2.1.1.1.2" xref="S4.E9.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E9.m2.1b"><apply id="S4.E9.m2.1.1.1.1.cmml" xref="S4.E9.m2.1.1.1"><eq id="S4.E9.m2.1.1.1.1.2.cmml" xref="S4.E9.m2.1.1.1.1.2"></eq><csymbol cd="latexml" id="S4.E9.m2.1.1.1.1.3.cmml" xref="S4.E9.m2.1.1.1.1.3">absent</csymbol><apply id="S4.E9.m2.1.1.1.1.1.cmml" xref="S4.E9.m2.1.1.1.1.1"><times id="S4.E9.m2.1.1.1.1.1.2.cmml" xref="S4.E9.m2.1.1.1.1.1.2"></times><ci id="S4.E9.m2.1.1.1.1.1.3.cmml" xref="S4.E9.m2.1.1.1.1.1.3">𝙼𝚎𝚊𝚗𝙿𝚘𝚘𝚕𝚒𝚗𝚐</ci><apply id="S4.E9.m2.1.1.1.1.1.1.1.1.cmml" xref="S4.E9.m2.1.1.1.1.1.1.1"><times id="S4.E9.m2.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E9.m2.1.1.1.1.1.1.1.1.2"></times><ci id="S4.E9.m2.1.1.1.1.1.1.1.1.3a.cmml" xref="S4.E9.m2.1.1.1.1.1.1.1.1.3"><mtext id="S4.E9.m2.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E9.m2.1.1.1.1.1.1.1.1.3">GCN</mtext></ci><apply id="S4.E9.m2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9.m2.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E9.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9.m2.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E9.m2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E9.m2.1.1.1.1.1.1.1.1.1.1.1.2">𝐺</ci><ci id="S4.E9.m2.1.1.1.1.1.1.1.1.1.1.1.3a.cmml" xref="S4.E9.m2.1.1.1.1.1.1.1.1.1.1.1.3"><mtext id="S4.E9.m2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" mathsize="70%" xref="S4.E9.m2.1.1.1.1.1.1.1.1.1.1.1.3">fus</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E9.m2.1c">\displaystyle=\mathtt{MeanPooling}(\text{GCN}(G_{\text{fus}})),</annotation><annotation encoding="application/x-llamapun" id="S4.E9.m2.1d">= typewriter_MeanPooling ( GCN ( italic_G start_POSTSUBSCRIPT fus end_POSTSUBSCRIPT ) ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
<tbody id="S4.E10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\tilde{x}_{q}" class="ltx_Math" display="inline" id="S4.E10.m1.1"><semantics id="S4.E10.m1.1a"><msub id="S4.E10.m1.1.1" xref="S4.E10.m1.1.1.cmml"><mover accent="true" id="S4.E10.m1.1.1.2" xref="S4.E10.m1.1.1.2.cmml"><mi id="S4.E10.m1.1.1.2.2" xref="S4.E10.m1.1.1.2.2.cmml">x</mi><mo id="S4.E10.m1.1.1.2.1" xref="S4.E10.m1.1.1.2.1.cmml">~</mo></mover><mi id="S4.E10.m1.1.1.3" xref="S4.E10.m1.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S4.E10.m1.1b"><apply id="S4.E10.m1.1.1.cmml" xref="S4.E10.m1.1.1"><csymbol cd="ambiguous" id="S4.E10.m1.1.1.1.cmml" xref="S4.E10.m1.1.1">subscript</csymbol><apply id="S4.E10.m1.1.1.2.cmml" xref="S4.E10.m1.1.1.2"><ci id="S4.E10.m1.1.1.2.1.cmml" xref="S4.E10.m1.1.1.2.1">~</ci><ci id="S4.E10.m1.1.1.2.2.cmml" xref="S4.E10.m1.1.1.2.2">𝑥</ci></apply><ci id="S4.E10.m1.1.1.3.cmml" xref="S4.E10.m1.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E10.m1.1c">\displaystyle\tilde{x}_{q}</annotation><annotation encoding="application/x-llamapun" id="S4.E10.m1.1d">over~ start_ARG italic_x end_ARG start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=[e_{\text{fus}}\parallel x_{q}]," class="ltx_Math" display="inline" id="S4.E10.m2.1"><semantics id="S4.E10.m2.1a"><mrow id="S4.E10.m2.1.1.1" xref="S4.E10.m2.1.1.1.1.cmml"><mrow id="S4.E10.m2.1.1.1.1" xref="S4.E10.m2.1.1.1.1.cmml"><mi id="S4.E10.m2.1.1.1.1.3" xref="S4.E10.m2.1.1.1.1.3.cmml"></mi><mo id="S4.E10.m2.1.1.1.1.2" xref="S4.E10.m2.1.1.1.1.2.cmml">=</mo><mrow id="S4.E10.m2.1.1.1.1.1.1" xref="S4.E10.m2.1.1.1.1.1.2.cmml"><mo id="S4.E10.m2.1.1.1.1.1.1.2" stretchy="false" xref="S4.E10.m2.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S4.E10.m2.1.1.1.1.1.1.1" xref="S4.E10.m2.1.1.1.1.1.1.1.cmml"><msub id="S4.E10.m2.1.1.1.1.1.1.1.2" xref="S4.E10.m2.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E10.m2.1.1.1.1.1.1.1.2.2" xref="S4.E10.m2.1.1.1.1.1.1.1.2.2.cmml">e</mi><mtext id="S4.E10.m2.1.1.1.1.1.1.1.2.3" xref="S4.E10.m2.1.1.1.1.1.1.1.2.3a.cmml">fus</mtext></msub><mo id="S4.E10.m2.1.1.1.1.1.1.1.1" xref="S4.E10.m2.1.1.1.1.1.1.1.1.cmml">∥</mo><msub id="S4.E10.m2.1.1.1.1.1.1.1.3" xref="S4.E10.m2.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E10.m2.1.1.1.1.1.1.1.3.2" xref="S4.E10.m2.1.1.1.1.1.1.1.3.2.cmml">x</mi><mi id="S4.E10.m2.1.1.1.1.1.1.1.3.3" xref="S4.E10.m2.1.1.1.1.1.1.1.3.3.cmml">q</mi></msub></mrow><mo id="S4.E10.m2.1.1.1.1.1.1.3" stretchy="false" xref="S4.E10.m2.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S4.E10.m2.1.1.1.2" xref="S4.E10.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E10.m2.1b"><apply id="S4.E10.m2.1.1.1.1.cmml" xref="S4.E10.m2.1.1.1"><eq id="S4.E10.m2.1.1.1.1.2.cmml" xref="S4.E10.m2.1.1.1.1.2"></eq><csymbol cd="latexml" id="S4.E10.m2.1.1.1.1.3.cmml" xref="S4.E10.m2.1.1.1.1.3">absent</csymbol><apply id="S4.E10.m2.1.1.1.1.1.2.cmml" xref="S4.E10.m2.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E10.m2.1.1.1.1.1.2.1.cmml" xref="S4.E10.m2.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.E10.m2.1.1.1.1.1.1.1.cmml" xref="S4.E10.m2.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E10.m2.1.1.1.1.1.1.1.1.cmml" xref="S4.E10.m2.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S4.E10.m2.1.1.1.1.1.1.1.2.cmml" xref="S4.E10.m2.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E10.m2.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E10.m2.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E10.m2.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E10.m2.1.1.1.1.1.1.1.2.2">𝑒</ci><ci id="S4.E10.m2.1.1.1.1.1.1.1.2.3a.cmml" xref="S4.E10.m2.1.1.1.1.1.1.1.2.3"><mtext id="S4.E10.m2.1.1.1.1.1.1.1.2.3.cmml" mathsize="70%" xref="S4.E10.m2.1.1.1.1.1.1.1.2.3">fus</mtext></ci></apply><apply id="S4.E10.m2.1.1.1.1.1.1.1.3.cmml" xref="S4.E10.m2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E10.m2.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E10.m2.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E10.m2.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E10.m2.1.1.1.1.1.1.1.3.2">𝑥</ci><ci id="S4.E10.m2.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E10.m2.1.1.1.1.1.1.1.3.3">𝑞</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E10.m2.1c">\displaystyle=[e_{\text{fus}}\parallel x_{q}],</annotation><annotation encoding="application/x-llamapun" id="S4.E10.m2.1d">= [ italic_e start_POSTSUBSCRIPT fus end_POSTSUBSCRIPT ∥ italic_x start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.SSSx1.p1.6">where <math alttext="e_{\text{fus}}" class="ltx_Math" display="inline" id="S4.SS2.SSSx1.p1.5.m1.1"><semantics id="S4.SS2.SSSx1.p1.5.m1.1a"><msub id="S4.SS2.SSSx1.p1.5.m1.1.1" xref="S4.SS2.SSSx1.p1.5.m1.1.1.cmml"><mi id="S4.SS2.SSSx1.p1.5.m1.1.1.2" xref="S4.SS2.SSSx1.p1.5.m1.1.1.2.cmml">e</mi><mtext id="S4.SS2.SSSx1.p1.5.m1.1.1.3" xref="S4.SS2.SSSx1.p1.5.m1.1.1.3a.cmml">fus</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSSx1.p1.5.m1.1b"><apply id="S4.SS2.SSSx1.p1.5.m1.1.1.cmml" xref="S4.SS2.SSSx1.p1.5.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSSx1.p1.5.m1.1.1.1.cmml" xref="S4.SS2.SSSx1.p1.5.m1.1.1">subscript</csymbol><ci id="S4.SS2.SSSx1.p1.5.m1.1.1.2.cmml" xref="S4.SS2.SSSx1.p1.5.m1.1.1.2">𝑒</ci><ci id="S4.SS2.SSSx1.p1.5.m1.1.1.3a.cmml" xref="S4.SS2.SSSx1.p1.5.m1.1.1.3"><mtext id="S4.SS2.SSSx1.p1.5.m1.1.1.3.cmml" mathsize="70%" xref="S4.SS2.SSSx1.p1.5.m1.1.1.3">fus</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSSx1.p1.5.m1.1c">e_{\text{fus}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSSx1.p1.5.m1.1d">italic_e start_POSTSUBSCRIPT fus end_POSTSUBSCRIPT</annotation></semantics></math> is the fused graph representation, and <math alttext="\tilde{x}_{q}" class="ltx_Math" display="inline" id="S4.SS2.SSSx1.p1.6.m2.1"><semantics id="S4.SS2.SSSx1.p1.6.m2.1a"><msub id="S4.SS2.SSSx1.p1.6.m2.1.1" xref="S4.SS2.SSSx1.p1.6.m2.1.1.cmml"><mover accent="true" id="S4.SS2.SSSx1.p1.6.m2.1.1.2" xref="S4.SS2.SSSx1.p1.6.m2.1.1.2.cmml"><mi id="S4.SS2.SSSx1.p1.6.m2.1.1.2.2" xref="S4.SS2.SSSx1.p1.6.m2.1.1.2.2.cmml">x</mi><mo id="S4.SS2.SSSx1.p1.6.m2.1.1.2.1" xref="S4.SS2.SSSx1.p1.6.m2.1.1.2.1.cmml">~</mo></mover><mi id="S4.SS2.SSSx1.p1.6.m2.1.1.3" xref="S4.SS2.SSSx1.p1.6.m2.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSSx1.p1.6.m2.1b"><apply id="S4.SS2.SSSx1.p1.6.m2.1.1.cmml" xref="S4.SS2.SSSx1.p1.6.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSSx1.p1.6.m2.1.1.1.cmml" xref="S4.SS2.SSSx1.p1.6.m2.1.1">subscript</csymbol><apply id="S4.SS2.SSSx1.p1.6.m2.1.1.2.cmml" xref="S4.SS2.SSSx1.p1.6.m2.1.1.2"><ci id="S4.SS2.SSSx1.p1.6.m2.1.1.2.1.cmml" xref="S4.SS2.SSSx1.p1.6.m2.1.1.2.1">~</ci><ci id="S4.SS2.SSSx1.p1.6.m2.1.1.2.2.cmml" xref="S4.SS2.SSSx1.p1.6.m2.1.1.2.2">𝑥</ci></apply><ci id="S4.SS2.SSSx1.p1.6.m2.1.1.3.cmml" xref="S4.SS2.SSSx1.p1.6.m2.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSSx1.p1.6.m2.1c">\tilde{x}_{q}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSSx1.p1.6.m2.1d">over~ start_ARG italic_x end_ARG start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> is the retrieval-augmented sequence. The augmented sequence is fed into the sequence model, which generates future interactions.</p>
</div>
<section class="ltx_paragraph" id="S4.SS2.SSSx1.Px1">
<h5 class="ltx_title ltx_title_paragraph">Training and inference.</h5>
<div class="ltx_para" id="S4.SS2.SSSx1.Px1.p1">
<p class="ltx_p" id="S4.SS2.SSSx1.Px1.p1.1">We adopt the same sequence model with the same training objective <cite class="ltx_cite ltx_citemacro_citep">(Wu, Fang, and Liao <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib29" title="">2024</a>)</cite> as in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#S1.F2" title="Figure 2 ‣ 1 Introduction ‣ Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_tag">2</span></a>(a). During training, we freeze the parameters of the sequence model, except for the output layer which is updated along with the GCN parameters used for graph fusion.</p>
</div>
<div class="ltx_para" id="S4.SS2.SSSx1.Px1.p2">
<p class="ltx_p" id="S4.SS2.SSSx1.Px1.p2.1">During testing, we first apply the retriever model to retrieve top-<span class="ltx_text ltx_font_italic" id="S4.SS2.SSSx1.Px1.p2.1.1">K</span> demonstrations for each query as introduced in Sect. <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#S4.SS1" title="4.1 Time- and Context-Aware Retriever ‣ 4 Proposed Model: RAG4DyG ‣ Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_tag">4.1</span></a>. Then we perform graph fusion on these demonstrations and concatenate the fused graph representation with the query sequence as illustrated in Eqs. (<a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#S4.E9" title="In Graph Fusion. ‣ 4.2 Graph Fusion-based Generator ‣ 4 Proposed Model: RAG4DyG ‣ Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_tag">9</span></a>) and (<a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#S4.E10" title="In Graph Fusion. ‣ 4.2 Graph Fusion-based Generator ‣ 4 Proposed Model: RAG4DyG ‣ Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_tag">10</span></a>). The concatenated sequence is subsequently fed into the trained sequence model for link prediction.</p>
</div>
</section>
</section>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experiment</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">In this section, we empirically evaluate the proposed model RAG4DyG compared to state-of-the-art methods and conduct a detailed analysis of the performance.</p>
</div>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Experimental Setup</h3>
<section class="ltx_subsubsection" id="S5.SS1.SSSx1">
<h4 class="ltx_title ltx_title_subsubsection">Datasets.</h4>
<div class="ltx_para" id="S5.SS1.SSSx1.p1">
<p class="ltx_p" id="S5.SS1.SSSx1.p1.1">We evaluate the performance of the proposed model on three datasets from different domains including the communication network UCI <cite class="ltx_cite ltx_citemacro_citep">(Panzarasa, Opsahl, and Carley <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib21" title="">2009</a>)</cite>, the citation network Hepth <cite class="ltx_cite ltx_citemacro_citep">(Leskovec, Kleinberg, and Faloutsos <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib17" title="">2005</a>)</cite>, and the multi-turn task-oriented conversation dataset MMConv <cite class="ltx_cite ltx_citemacro_citep">(Liao et al. <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib18" title="">2021</a>)</cite>. We follow the same dataset preprocessing as SimpleDyG <cite class="ltx_cite ltx_citemacro_citep">(Wu, Fang, and Liao <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib29" title="">2024</a>)</cite>. It is important to note that the ML-10M dataset was not used because it is not suitable for RAG; we observed no performance enhancement even when the query was augmented with ground-truth demonstrations.
We summarize the statistics of the three datasets in Table <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#S5.T1" title="Table 1 ‣ Datasets. ‣ 5.1 Experimental Setup ‣ 5 Experiment ‣ Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure class="ltx_table" id="S5.T1">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T1.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T1.1.1.1.1">Dataset</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T1.1.1.1.2">UCI</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T1.1.1.1.3">Hepth</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T1.1.1.1.4">MMConv</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T1.1.2.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.2.1.1">Domain</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.2.1.2">Social</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.2.1.3">Citation</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.2.1.4">Conversation</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.3.2">
<td class="ltx_td ltx_align_center" id="S5.T1.1.3.2.1"># Nodes</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.3.2.2">1,781</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.3.2.3">4,737</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.3.2.4">7,415</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.4.3">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T1.1.4.3.1"># Edges</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T1.1.4.3.2">16,743</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T1.1.4.3.3">14,831</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T1.1.4.3.4">91,986</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Dataset statistics.</figcaption>
</figure>
<figure class="ltx_table" id="S5.T2">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T2.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T2.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S5.T2.1.1.1.1" rowspan="2" style="padding-left:4.7pt;padding-right:4.7pt;"><span class="ltx_text" id="S5.T2.1.1.1.1.1">Method</span></th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="3" id="S5.T2.1.1.1.2" style="padding-left:4.7pt;padding-right:4.7pt;">UCI</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="3" id="S5.T2.1.1.1.3" style="padding-left:4.7pt;padding-right:4.7pt;">Hepth</td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="3" id="S5.T2.1.1.1.4" style="padding-left:4.7pt;padding-right:4.7pt;">MMConv</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.2.2">
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.2.2.1" style="padding-left:4.7pt;padding-right:4.7pt;">Recall@5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.2.2.2" style="padding-left:4.7pt;padding-right:4.7pt;">NDCG@5</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.1.2.2.3" style="padding-left:4.7pt;padding-right:4.7pt;">Jaccard</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.2.2.4" style="padding-left:4.7pt;padding-right:4.7pt;">Recall@5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.2.2.5" style="padding-left:4.7pt;padding-right:4.7pt;">NDCG@5</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.1.2.2.6" style="padding-left:4.7pt;padding-right:4.7pt;">Jaccard</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.2.2.7" style="padding-left:4.7pt;padding-right:4.7pt;">Recall@5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.2.2.8" style="padding-left:4.7pt;padding-right:4.7pt;">NDCG@5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.2.2.9" style="padding-left:4.7pt;padding-right:4.7pt;">Jaccard</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.3.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T2.1.3.3.1" style="padding-left:4.7pt;padding-right:4.7pt;">DySAT</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.3.3.2" style="padding-left:4.7pt;padding-right:4.7pt;">0.009±0.003</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.3.3.3" style="padding-left:4.7pt;padding-right:4.7pt;">0.010±0.003</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.1.3.3.4" style="padding-left:4.7pt;padding-right:4.7pt;">0.010±0.001</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.3.3.5" style="padding-left:4.7pt;padding-right:4.7pt;">0.008±0.004</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.3.3.6" style="padding-left:4.7pt;padding-right:4.7pt;">0.007±0.002</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.1.3.3.7" style="padding-left:4.7pt;padding-right:4.7pt;">0.005±0.001</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.3.3.8" style="padding-left:4.7pt;padding-right:4.7pt;">0.108±0.089</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.3.3.9" style="padding-left:4.7pt;padding-right:4.7pt;">0.102±0.085</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.3.3.10" style="padding-left:4.7pt;padding-right:4.7pt;">0.095±0.080</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.4.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T2.1.4.4.1" style="padding-left:4.7pt;padding-right:4.7pt;">EvolveGCN</th>
<td class="ltx_td ltx_align_center" id="S5.T2.1.4.4.2" style="padding-left:4.7pt;padding-right:4.7pt;">0.072±0.046</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.4.4.3" style="padding-left:4.7pt;padding-right:4.7pt;">0.064±0.045</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.4.4.4" style="padding-left:4.7pt;padding-right:4.7pt;">0.032±0.026</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.4.4.5" style="padding-left:4.7pt;padding-right:4.7pt;">0.008±0.002</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.4.4.6" style="padding-left:4.7pt;padding-right:4.7pt;">0.009±0.004</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.4.4.7" style="padding-left:4.7pt;padding-right:4.7pt;">0.007±0.002</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.4.4.8" style="padding-left:4.7pt;padding-right:4.7pt;">0.050±0.015</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.4.4.9" style="padding-left:4.7pt;padding-right:4.7pt;">0.051±0.021</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.4.4.10" style="padding-left:4.7pt;padding-right:4.7pt;">0.032±0.017</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.5.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T2.1.5.5.1" style="padding-left:4.7pt;padding-right:4.7pt;">DyRep</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.5.5.2" style="padding-left:4.7pt;padding-right:4.7pt;">0.009±0.008</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.5.5.3" style="padding-left:4.7pt;padding-right:4.7pt;">0.011±0.018</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.1.5.5.4" style="padding-left:4.7pt;padding-right:4.7pt;">0.010±0.005</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.5.5.5" style="padding-left:4.7pt;padding-right:4.7pt;">0.009±0.006</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.5.5.6" style="padding-left:4.7pt;padding-right:4.7pt;">0.031±0.024</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.1.5.5.7" style="padding-left:4.7pt;padding-right:4.7pt;">0.010±0.006</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.5.5.8" style="padding-left:4.7pt;padding-right:4.7pt;">0.156±0.054</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.5.5.9" style="padding-left:4.7pt;padding-right:4.7pt;">0.140±0.057</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.5.5.10" style="padding-left:4.7pt;padding-right:4.7pt;">0.067±0.025</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.6.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T2.1.6.6.1" style="padding-left:4.7pt;padding-right:4.7pt;">JODIE</th>
<td class="ltx_td ltx_align_center" id="S5.T2.1.6.6.2" style="padding-left:4.7pt;padding-right:4.7pt;">0.018±0.019</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.6.6.3" style="padding-left:4.7pt;padding-right:4.7pt;">0.022±0.023</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.6.6.4" style="padding-left:4.7pt;padding-right:4.7pt;">0.012±0.009</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.6.6.5" style="padding-left:4.7pt;padding-right:4.7pt;">0.010±0.008</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.6.6.6" style="padding-left:4.7pt;padding-right:4.7pt;">0.031±0.021</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.6.6.7" style="padding-left:4.7pt;padding-right:4.7pt;">0.011±0.008</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.6.6.8" style="padding-left:4.7pt;padding-right:4.7pt;">0.052±0.039</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.6.6.9" style="padding-left:4.7pt;padding-right:4.7pt;">0.041±0.016</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.6.6.10" style="padding-left:4.7pt;padding-right:4.7pt;">0.032±0.022</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.7.7">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T2.1.7.7.1" style="padding-left:4.7pt;padding-right:4.7pt;">TGAT</th>
<td class="ltx_td ltx_align_center" id="S5.T2.1.7.7.2" style="padding-left:4.7pt;padding-right:4.7pt;">0.022±0.004</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.7.7.3" style="padding-left:4.7pt;padding-right:4.7pt;">0.061±0.007</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.7.7.4" style="padding-left:4.7pt;padding-right:4.7pt;">0.020±0.002</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.7.7.5" style="padding-left:4.7pt;padding-right:4.7pt;">0.011±0.007</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.7.7.6" style="padding-left:4.7pt;padding-right:4.7pt;">0.034±0.023</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.7.7.7" style="padding-left:4.7pt;padding-right:4.7pt;">0.011±0.006</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.7.7.8" style="padding-left:4.7pt;padding-right:4.7pt;">0.118±0.004</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.7.7.9" style="padding-left:4.7pt;padding-right:4.7pt;">0.089±0.033</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.7.7.10" style="padding-left:4.7pt;padding-right:4.7pt;">0.058±0.021</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.8.8">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T2.1.8.8.1" style="padding-left:4.7pt;padding-right:4.7pt;">TGN</th>
<td class="ltx_td ltx_align_center" id="S5.T2.1.8.8.2" style="padding-left:4.7pt;padding-right:4.7pt;">0.014±0.010</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.8.8.3" style="padding-left:4.7pt;padding-right:4.7pt;">0.041±0.017</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.8.8.4" style="padding-left:4.7pt;padding-right:4.7pt;">0.011±0.003</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.8.8.5" style="padding-left:4.7pt;padding-right:4.7pt;">0.011±0.006</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.8.8.6" style="padding-left:4.7pt;padding-right:4.7pt;">0.030±0.012</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.8.8.7" style="padding-left:4.7pt;padding-right:4.7pt;">0.008±0.001</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.8.8.8" style="padding-left:4.7pt;padding-right:4.7pt;">0.085±0.050</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.8.8.9" style="padding-left:4.7pt;padding-right:4.7pt;">0.096±0.068</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.8.8.10" style="padding-left:4.7pt;padding-right:4.7pt;">0.066±0.038</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.9.9">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T2.1.9.9.1" style="padding-left:4.7pt;padding-right:4.7pt;">TREND</th>
<td class="ltx_td ltx_align_center" id="S5.T2.1.9.9.2" style="padding-left:4.7pt;padding-right:4.7pt;">0.083±0.015</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.9.9.3" style="padding-left:4.7pt;padding-right:4.7pt;">0.067±0.010</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.9.9.4" style="padding-left:4.7pt;padding-right:4.7pt;">0.039±0.020</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.9.9.5" style="padding-left:4.7pt;padding-right:4.7pt;">0.010±0.008</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.9.9.6" style="padding-left:4.7pt;padding-right:4.7pt;">0.031±0.003</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.9.9.7" style="padding-left:4.7pt;padding-right:4.7pt;">0.010±0.002</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.9.9.8" style="padding-left:4.7pt;padding-right:4.7pt;">0.134±0.030</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.9.9.9" style="padding-left:4.7pt;padding-right:4.7pt;">0.116±0.020</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.9.9.10" style="padding-left:4.7pt;padding-right:4.7pt;">0.060±0.018</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.10.10">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T2.1.10.10.1" style="padding-left:4.7pt;padding-right:4.7pt;">GraphMixer</th>
<td class="ltx_td ltx_align_center" id="S5.T2.1.10.10.2" style="padding-left:4.7pt;padding-right:4.7pt;">0.097±0.019</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.10.10.3" style="padding-left:4.7pt;padding-right:4.7pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.1.10.10.3.1">0.104</span>± 0.013</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.10.10.4" style="padding-left:4.7pt;padding-right:4.7pt;">0.042 ±0.005</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.10.10.5" style="padding-left:4.7pt;padding-right:4.7pt;">0.009±0.002</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.10.10.6" style="padding-left:4.7pt;padding-right:4.7pt;">0.011±0.008</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.10.10.7" style="padding-left:4.7pt;padding-right:4.7pt;">0.010±0.003</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.10.10.8" style="padding-left:4.7pt;padding-right:4.7pt;">
<span class="ltx_text ltx_font_bold" id="S5.T2.1.10.10.8.1">0.206</span>±0.001</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.10.10.9" style="padding-left:4.7pt;padding-right:4.7pt;">0.172±0.029</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.10.10.10" style="padding-left:4.7pt;padding-right:4.7pt;">0.085±0.016</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.11.11">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T2.1.11.11.1" style="padding-left:4.7pt;padding-right:4.7pt;">SimpleDyG</th>
<td class="ltx_td ltx_align_center" id="S5.T2.1.11.11.2" style="padding-left:4.7pt;padding-right:4.7pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.1.11.11.2.1">0.109</span>±0.014</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.11.11.3" style="padding-left:4.7pt;padding-right:4.7pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.1.11.11.3.1">0.104</span>±0.010</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.11.11.4" style="padding-left:4.7pt;padding-right:4.7pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.1.11.11.4.1">0.092</span>±0.014</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.11.11.5" style="padding-left:4.7pt;padding-right:4.7pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.1.11.11.5.1">0.013</span>±0.006</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.11.11.6" style="padding-left:4.7pt;padding-right:4.7pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.1.11.11.6.1">0.035</span>±0.014</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.11.11.7" style="padding-left:4.7pt;padding-right:4.7pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.1.11.11.7.1">0.013</span>±0.006</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.11.11.8" style="padding-left:4.7pt;padding-right:4.7pt;">0.170±0.010</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.11.11.9" style="padding-left:4.7pt;padding-right:4.7pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.1.11.11.9.1">0.184</span>±0.012</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.11.11.10" style="padding-left:4.7pt;padding-right:4.7pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.1.11.11.10.1">0.169</span>±0.010</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.12.12">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t" id="S5.T2.1.12.12.1" style="padding-left:4.7pt;padding-right:4.7pt;">RAG4DyG</th>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T2.1.12.12.2" style="padding-left:4.7pt;padding-right:4.7pt;">
<span class="ltx_text ltx_font_bold" id="S5.T2.1.12.12.2.1">0.111</span>±0.013</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T2.1.12.12.3" style="padding-left:4.7pt;padding-right:4.7pt;">
<span class="ltx_text ltx_font_bold" id="S5.T2.1.12.12.3.1">0.122</span>±0.014</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="S5.T2.1.12.12.4" style="padding-left:4.7pt;padding-right:4.7pt;">
<span class="ltx_text ltx_font_bold" id="S5.T2.1.12.12.4.1">0.097</span>±0.010</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T2.1.12.12.5" style="padding-left:4.7pt;padding-right:4.7pt;">
<span class="ltx_text ltx_font_bold" id="S5.T2.1.12.12.5.1">0.019</span>±0.002</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T2.1.12.12.6" style="padding-left:4.7pt;padding-right:4.7pt;">
<span class="ltx_text ltx_font_bold" id="S5.T2.1.12.12.6.1">0.045</span>±0.003</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="S5.T2.1.12.12.7" style="padding-left:4.7pt;padding-right:4.7pt;">
<span class="ltx_text ltx_font_bold" id="S5.T2.1.12.12.7.1">0.019</span>±0.002</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T2.1.12.12.8" style="padding-left:4.7pt;padding-right:4.7pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S5.T2.1.12.12.8.1">0.194</span>±0.005</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T2.1.12.12.9" style="padding-left:4.7pt;padding-right:4.7pt;">
<span class="ltx_text ltx_font_bold" id="S5.T2.1.12.12.9.1">0.208</span>±0.005</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T2.1.12.12.10" style="padding-left:4.7pt;padding-right:4.7pt;">
<span class="ltx_text ltx_font_bold" id="S5.T2.1.12.12.10.1">0.194</span>±0.005</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span> Performance comparison for dynamic link prediction. (Best results are bolded; runners-up are underlined.)</figcaption>
</figure>
</section>
<section class="ltx_subsubsection" id="S5.SS1.SSSx2">
<h4 class="ltx_title ltx_title_subsubsection">Baselines.</h4>
<div class="ltx_para" id="S5.SS1.SSSx2.p1">
<p class="ltx_p" id="S5.SS1.SSSx2.p1.1">We compare RAG4DyG with the state-of-the-art approaches of dynamic graph modeling. (1) discrete-time approaches: DySAT <cite class="ltx_cite ltx_citemacro_citep">(Sankar et al. <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib24" title="">2020</a>)</cite> and EvolveGCN <cite class="ltx_cite ltx_citemacro_citep">(Pareja et al. <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib22" title="">2020</a>)</cite>; (2) continuous-time approaches: DyRep <cite class="ltx_cite ltx_citemacro_citep">(Trivedi et al. <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib25" title="">2019</a>)</cite>, JODIE <cite class="ltx_cite ltx_citemacro_citep">(Kumar, Zhang, and Leskovec <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib16" title="">2019</a>)</cite>, TGAT <cite class="ltx_cite ltx_citemacro_citep">(Xu et al. <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib31" title="">2020</a>)</cite>, TGN <cite class="ltx_cite ltx_citemacro_citep">(Rossi et al. <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib23" title="">2020</a>)</cite>, TREND <cite class="ltx_cite ltx_citemacro_citep">(Wen and Fang <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib28" title="">2022</a>)</cite>, GraphMixer <cite class="ltx_cite ltx_citemacro_citep">(Cong et al. <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib3" title="">2022</a>)</cite> and SimpleDyG <cite class="ltx_cite ltx_citemacro_citep">(Wu, Fang, and Liao <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib29" title="">2024</a>)</cite>. The details of the baselines can be found in Appendix B.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S5.SS1.SSSx3">
<h4 class="ltx_title ltx_title_subsubsection">Implementation Details.</h4>
<div class="ltx_para" id="S5.SS1.SSSx3.p1">
<p class="ltx_p" id="S5.SS1.SSSx3.p1.3">Following the method outlined in <cite class="ltx_cite ltx_citemacro_citep">(Cong et al. <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib3" title="">2022</a>; Wu, Fang, and Liao <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib29" title="">2024</a>)</cite>, we represent the dynamic graph as an undirected graph. We split all datasets into training, validation, and test sets based on temporal sequence same as SimpleDyG <cite class="ltx_cite ltx_citemacro_citep">(Wu, Fang, and Liao <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib29" title="">2024</a>)</cite>. Given <math alttext="{T}" class="ltx_Math" display="inline" id="S5.SS1.SSSx3.p1.1.m1.1"><semantics id="S5.SS1.SSSx3.p1.1.m1.1a"><mi id="S5.SS1.SSSx3.p1.1.m1.1.1" xref="S5.SS1.SSSx3.p1.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.SSSx3.p1.1.m1.1b"><ci id="S5.SS1.SSSx3.p1.1.m1.1.1.cmml" xref="S5.SS1.SSSx3.p1.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSSx3.p1.1.m1.1c">{T}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSSx3.p1.1.m1.1d">italic_T</annotation></semantics></math> timesteps in each dataset, the data at the final timestep <math alttext="{T}" class="ltx_Math" display="inline" id="S5.SS1.SSSx3.p1.2.m2.1"><semantics id="S5.SS1.SSSx3.p1.2.m2.1a"><mi id="S5.SS1.SSSx3.p1.2.m2.1.1" xref="S5.SS1.SSSx3.p1.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.SSSx3.p1.2.m2.1b"><ci id="S5.SS1.SSSx3.p1.2.m2.1.1.cmml" xref="S5.SS1.SSSx3.p1.2.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSSx3.p1.2.m2.1c">{T}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSSx3.p1.2.m2.1d">italic_T</annotation></semantics></math> is used as the testing set, the data at <math alttext="{T-1}" class="ltx_Math" display="inline" id="S5.SS1.SSSx3.p1.3.m3.1"><semantics id="S5.SS1.SSSx3.p1.3.m3.1a"><mrow id="S5.SS1.SSSx3.p1.3.m3.1.1" xref="S5.SS1.SSSx3.p1.3.m3.1.1.cmml"><mi id="S5.SS1.SSSx3.p1.3.m3.1.1.2" xref="S5.SS1.SSSx3.p1.3.m3.1.1.2.cmml">T</mi><mo id="S5.SS1.SSSx3.p1.3.m3.1.1.1" xref="S5.SS1.SSSx3.p1.3.m3.1.1.1.cmml">−</mo><mn id="S5.SS1.SSSx3.p1.3.m3.1.1.3" xref="S5.SS1.SSSx3.p1.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSSx3.p1.3.m3.1b"><apply id="S5.SS1.SSSx3.p1.3.m3.1.1.cmml" xref="S5.SS1.SSSx3.p1.3.m3.1.1"><minus id="S5.SS1.SSSx3.p1.3.m3.1.1.1.cmml" xref="S5.SS1.SSSx3.p1.3.m3.1.1.1"></minus><ci id="S5.SS1.SSSx3.p1.3.m3.1.1.2.cmml" xref="S5.SS1.SSSx3.p1.3.m3.1.1.2">𝑇</ci><cn id="S5.SS1.SSSx3.p1.3.m3.1.1.3.cmml" type="integer" xref="S5.SS1.SSSx3.p1.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSSx3.p1.3.m3.1c">{T-1}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSSx3.p1.3.m3.1d">italic_T - 1</annotation></semantics></math> is served as the validation set, and the remaining data from earlier timesteps is used for training. All training data including the retrieval pool for the retriever and generator is drawn from this training data split. For retrieval augmented generation model training, we first train SimpleDyG without augmentation using the reported parameter in this paper. Then we fix the parameters of SimipleDyG except for the last linear layer and fine-tune them with the GCN model. The number of GCN layers in the generator model is 1 for all datasets. We repeat each experiment 10 times and report the average results along with the standard deviation. The number of demonstrations is 7 for all datasets. Hyper-parameter tuning is performed on the validation set and we provide the settings in Appendix D.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S5.SS1.SSSx4">
<h4 class="ltx_title ltx_title_subsubsection">Evaluation Metrics.</h4>
<div class="ltx_para" id="S5.SS1.SSSx4.p1">
<p class="ltx_p" id="S5.SS1.SSSx4.p1.1">We evaluate the performance upon three metrics Recall@5, NDCG@5 and Jaccard <cite class="ltx_cite ltx_citemacro_citep">(Wu, Fang, and Liao <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib29" title="">2024</a>)</cite>. Recall@5 and NDCG@5 are widely used in ranking tasks measuring the quality of top-ranked predictions <cite class="ltx_cite ltx_citemacro_citep">(Wang et al. <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib26" title="">2019</a>)</cite>. Recall@5 assesses the proportion of relevant nodes in the top 5 predictions, while NDCG@5 evaluates the ranking quality by considering the positions of the relevant nodes. Jaccard <cite class="ltx_cite ltx_citemacro_citep">(Jaccard <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib11" title="">1901</a>)</cite> measures the similarity between the predicted and ground truth sequences by comparing the intersection and union of the two sets.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Performance Comparison</h3>
<div class="ltx_para" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.1">We evaluate the performance of RAG4DyG for the dynamic link prediction task, and the results compared to the state-of-the-art baselines are presented in Table <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#S5.T2" title="Table 2 ‣ Datasets. ‣ 5.1 Experimental Setup ‣ 5 Experiment ‣ Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_tag">2</span></a>. We make the following observations.</p>
</div>
<div class="ltx_para" id="S5.SS2.p2">
<p class="ltx_p" id="S5.SS2.p2.1">The proposed RAG4DyG generally outperforms all baselines across different datasets under the three metrics.
In particular, compared to SimpleDyG, which is also our backbone, RAG4DyG consistently shows superior performance, highlighting the effectiveness of our retrieval-augmented generation framework.
Note that GraphMixer performs slightly better in Recall@5 on the MMConv dataset, but its significantly lower performance in NDCG@5 and Jaccard indicates that its predictions are not ranked optimally or maintaining the overall set integrity compared to RAG4DyG. This indicates that RAG4DyG can better model the temporal and contextual relationships due to the specific design of the retriever and generator.</p>
</div>
<figure class="ltx_figure" id="S5.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="132" id="S5.F3.g1" src="x4.png" width="326"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Ablation study for retrieval results.</figcaption>
</figure>
<div class="ltx_para" id="S5.SS2.p3">
<p class="ltx_p" id="S5.SS2.p3.1">Second, RAG4DyG exhibits significant advantages in inductive scenarios such as the Hepth dataset. This setting is particularly challenging because it involves nodes not appearing during the training phase, requiring the model to generalize to entirely new structures and relationships.
RAG4DyG’s success is attributed to its retrieval-augmented mechanism, which enhances the model’s ability to generalize by providing rich contextual information relevant to the new, unseen nodes. Unlike models that rely solely on the immediate neighborhood or predefined structures, RAG4DyG dynamically adapts to the new nodes, ensuring that the predictions are guided by the most relevant and similar historical data.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Model Analysis</h3>
<div class="ltx_para" id="S5.SS3.p1">
<p class="ltx_p" id="S5.SS3.p1.1">We analyze the behavior of our model RAG4DyG in several aspects, including an ablation study, an investigation of the effectiveness of different retrieval methods, and an analysis of parameter sensitivity.</p>
</div>
<section class="ltx_subsubsection" id="S5.SS3.SSSx1">
<h4 class="ltx_title ltx_title_subsubsection">Ablation Study.</h4>
<div class="ltx_para" id="S5.SS3.SSSx1.p1">
<p class="ltx_p" id="S5.SS3.SSSx1.p1.1">To evaluate the effectiveness of different modules in the retrieval model, we compare RAG4DyG with two variants <span class="ltx_text ltx_font_italic" id="S5.SS3.SSSx1.p1.1.1">w/o CCL</span> and <span class="ltx_text ltx_font_italic" id="S5.SS3.SSSx1.p1.1.2">w/o Decay</span> which exclude the context-aware contrastive learning and time decay component in the retrieval model. We evaluate the performance for both retrieval and link prediction tasks. We use HR@<span class="ltx_text ltx_font_italic" id="S5.SS3.SSSx1.p1.1.3">k</span> (Hit Ratio@<span class="ltx_text ltx_font_italic" id="S5.SS3.SSSx1.p1.1.4">k</span>) metrics for the retrieval model, measuring the proportion of cases where at least one of the top-<span class="ltx_text ltx_font_italic" id="S5.SS3.SSSx1.p1.1.5">k</span> retrieved items is relevant. As shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#S5.F3" title="Figure 3 ‣ 5.2 Performance Comparison ‣ 5 Experiment ‣ Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_tag">3</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#S5.F4" title="Figure 4 ‣ Ablation Study. ‣ 5.3 Model Analysis ‣ 5 Experiment ‣ Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_tag">4</span></a>, the full model outperforms the two variants, underscoring the benefits of incorporating context-aware contrastive learning and time decay modulation.</p>
</div>
<figure class="ltx_figure" id="S5.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="151" id="S5.F4.g1" src="x5.png" width="325"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Ablation study for link prediction results.</figcaption>
</figure>
</section>
<section class="ltx_subsubsection" id="S5.SS3.SSSx2">
<h4 class="ltx_title ltx_title_subsubsection">Effect of Different Retrieval Methods.</h4>
<div class="ltx_para" id="S5.SS3.SSSx2.p1">
<p class="ltx_p" id="S5.SS3.SSSx2.p1.1">To further investigate the effectiveness of the retrieval model, we compare our model with two different retrieval methods, namely, BM25 and Jaccard, in Table <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#S5.T3" title="Table 3 ‣ Effect of Different Retrieval Methods. ‣ 5.3 Model Analysis ‣ 5 Experiment ‣ Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_tag">3</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#S5.T4" title="Table 4 ‣ Effect of Different Retrieval Methods. ‣ 5.3 Model Analysis ‣ 5 Experiment ‣ Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_tag">4</span></a>.
In Table <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#S5.T4" title="Table 4 ‣ Effect of Different Retrieval Methods. ‣ 5.3 Model Analysis ‣ 5 Experiment ‣ Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_tag">4</span></a>, we only report NDCG@5 and present the remaining metrics in Appendix C.
BM25 <cite class="ltx_cite ltx_citemacro_citep">(Fang, Tao, and Zhai <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib6" title="">2004</a>)</cite> is an extension of the Term Frequency-Inverse Document Frequency (TF-IDF) model, which calculates a relevance score between the query sequence and each candidate sequence in the retrieval pool. The relevance score is derived from the occurrence frequency of the nodes in the query and the retrieval pool.
Jaccard <cite class="ltx_cite ltx_citemacro_citep">(Jaccard <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib11" title="">1901</a>)</cite> measures the similarity between two sets by comparing the size of their intersection to the size of their union. Note that in the citation dataset Hepth, all queries in the test set only contain unseen target nodes that never appear in the retrieval pool and have no historical interactions. As a result, the BM25 and Jaccard scores between the queries and the candidates in the retrieval pool are always zeros. On the other hand, our retrieval model is trained based on the sequence representations. For a query sequence containing only the target node, we can still obtain its representation using the sequence model trained for the retrieval model, and further calculate its contextual similarity with the candidate sequences in the retrieval pool.</p>
</div>
<figure class="ltx_table" id="S5.T3">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T3.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T3.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S5.T3.1.1.1.1" rowspan="2" style="padding-left:3.5pt;padding-right:3.5pt;"><span class="ltx_text" id="S5.T3.1.1.1.1.1">Method</span></th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="2" id="S5.T3.1.1.1.2" style="padding-left:3.5pt;padding-right:3.5pt;">UCI</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="2" id="S5.T3.1.1.1.3" style="padding-left:3.5pt;padding-right:3.5pt;">Hepth</td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S5.T3.1.1.1.4" style="padding-left:3.5pt;padding-right:3.5pt;">MMConv</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.2.2">
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.2.2.1" style="padding-left:3.5pt;padding-right:3.5pt;">HR@1</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.2.2.2" style="padding-left:3.5pt;padding-right:3.5pt;">HR@3</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.2.2.3" style="padding-left:3.5pt;padding-right:3.5pt;">HR@1</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.2.2.4" style="padding-left:3.5pt;padding-right:3.5pt;">HR@3</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.2.2.5" style="padding-left:3.5pt;padding-right:3.5pt;">HR@1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.2.2.6" style="padding-left:3.5pt;padding-right:3.5pt;">HR@3</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.3.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T3.1.3.3.1" style="padding-left:3.5pt;padding-right:3.5pt;"><span class="ltx_text ltx_font_italic" id="S5.T3.1.3.3.1.1">BM25</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.3.3.2" style="padding-left:3.5pt;padding-right:3.5pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.3.3.2.1">0.100</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.3.3.3" style="padding-left:3.5pt;padding-right:3.5pt;">0.136</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.3.3.4" style="padding-left:3.5pt;padding-right:3.5pt;">-</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.3.3.5" style="padding-left:3.5pt;padding-right:3.5pt;">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.3.3.6" style="padding-left:3.5pt;padding-right:3.5pt;">0.025</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.3.3.7" style="padding-left:3.5pt;padding-right:3.5pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.3.3.7.1">0.233</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.4.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T3.1.4.4.1" style="padding-left:3.5pt;padding-right:3.5pt;"><span class="ltx_text ltx_font_italic" id="S5.T3.1.4.4.1.1">Jaccard</span></th>
<td class="ltx_td ltx_align_center" id="S5.T3.1.4.4.2" style="padding-left:3.5pt;padding-right:3.5pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.4.4.2.1">0.100</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.1.4.4.3" style="padding-left:3.5pt;padding-right:3.5pt;">0.109</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.4.4.4" style="padding-left:3.5pt;padding-right:3.5pt;">-</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.1.4.4.5" style="padding-left:3.5pt;padding-right:3.5pt;">-</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.4.4.6" style="padding-left:3.5pt;padding-right:3.5pt;">0.007</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.4.4.7" style="padding-left:3.5pt;padding-right:3.5pt;">0.213</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.5.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T3.1.5.5.1" style="padding-left:3.5pt;padding-right:3.5pt;"><span class="ltx_text ltx_font_italic" id="S5.T3.1.5.5.1.1">RAG4DyG</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.5.5.2" style="padding-left:3.5pt;padding-right:3.5pt;">0.096</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.5.5.3" style="padding-left:3.5pt;padding-right:3.5pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.5.5.3.1">0.153</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.5.5.4" style="padding-left:3.5pt;padding-right:3.5pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.5.5.4.1">0.025</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.5.5.5" style="padding-left:3.5pt;padding-right:3.5pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.5.5.5.1">0.049</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.5.5.6" style="padding-left:3.5pt;padding-right:3.5pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.5.5.6.1">0.034</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.5.5.7" style="padding-left:3.5pt;padding-right:3.5pt;">0.168</td>
</tr>
</tbody>
<tfoot class="ltx_tfoot">
<tr class="ltx_tr" id="S5.T3.1.6.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" colspan="7" id="S5.T3.1.6.1.1" style="padding-left:3.5pt;padding-right:3.5pt;">
<span class="ltx_inline-block ltx_align_top" id="S5.T3.1.6.1.1.1">
<span class="ltx_p" id="S5.T3.1.6.1.1.1.1" style="width:227.6pt;">“-” denotes that the method is unable to perform retrieval. The reason is explained in the corresponding description of this table in Sect. 5.3.</span>
</span>
</th>
</tr>
</tfoot>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Retrieval performance of various retrieval methods. </figcaption>
</figure>
<figure class="ltx_table" id="S5.T4">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S5.T4.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T4.1.1.1">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S5.T4.1.1.1.1">Method</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S5.T4.1.1.1.2">UCI</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S5.T4.1.1.1.3">Hepth</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T4.1.1.1.4">MMConv</td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.2.2">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T4.1.2.2.1"><span class="ltx_text ltx_font_italic" id="S5.T4.1.2.2.1.1">BM25</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T4.1.2.2.2">0.121±0.009</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T4.1.2.2.3">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.2.2.4">0.207±0.003</td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.3.3">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T4.1.3.3.1"><span class="ltx_text ltx_font_italic" id="S5.T4.1.3.3.1.1">Jaccard</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T4.1.3.3.2">0.113±0.011</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T4.1.3.3.3">-</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.3.3.4">0.207±0.005</td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.4.4">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T4.1.4.4.1"><span class="ltx_text ltx_font_italic" id="S5.T4.1.4.4.1.1">RAG4DyG</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T4.1.4.4.2"><span class="ltx_text ltx_font_bold" id="S5.T4.1.4.4.2.1">0.122±0.014</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T4.1.4.4.3"><span class="ltx_text ltx_font_bold" id="S5.T4.1.4.4.3.1">0.045±0.003</span></td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.4.4.4"><span class="ltx_text ltx_font_bold" id="S5.T4.1.4.4.4.1">0.208±0.005</span></td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.5.5">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T4.1.5.5.1"><span class="ltx_text ltx_font_italic" id="S5.T4.1.5.5.1.1">GroundTruth</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T4.1.5.5.2">0.129±0.010</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T4.1.5.5.3">0.062±0.007</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.5.5.4">0.224±0.008</td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.6.6">
<td class="ltx_td ltx_align_left ltx_border_tt" colspan="4" id="S5.T4.1.6.6.1">See the note in Table <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#S5.T3" title="Table 3 ‣ Effect of Different Retrieval Methods. ‣ 5.3 Model Analysis ‣ 5 Experiment ‣ Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_tag">3</span></a> for the explanation of “-”.</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>Generative accuracy of various retrieval methods.</figcaption>
</figure>
<div class="ltx_para" id="S5.SS3.SSSx2.p2">
<p class="ltx_p" id="S5.SS3.SSSx2.p2.1">In Table <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#S5.T3" title="Table 3 ‣ Effect of Different Retrieval Methods. ‣ 5.3 Model Analysis ‣ 5 Experiment ‣ Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_tag">3</span></a>, we analyze the retrieval performance of different retrieval methods. Our retrieval model shows better performance than other retrieval strategies. Notably, in inductive scenarios like the Hepth dataset, BM25 and Jaccard fail to work with new query nodes lacking historical interactions. In contrast, our model can handle them effectively and achieve solid performance. The high <math alttext="HR@3" class="ltx_Math" display="inline" id="S5.SS3.SSSx2.p2.1.m1.1"><semantics id="S5.SS3.SSSx2.p2.1.m1.1a"><mrow id="S5.SS3.SSSx2.p2.1.m1.1.1" xref="S5.SS3.SSSx2.p2.1.m1.1.1.cmml"><mi id="S5.SS3.SSSx2.p2.1.m1.1.1.2" xref="S5.SS3.SSSx2.p2.1.m1.1.1.2.cmml">H</mi><mo id="S5.SS3.SSSx2.p2.1.m1.1.1.1" xref="S5.SS3.SSSx2.p2.1.m1.1.1.1.cmml">⁢</mo><mi id="S5.SS3.SSSx2.p2.1.m1.1.1.3" xref="S5.SS3.SSSx2.p2.1.m1.1.1.3.cmml">R</mi><mo id="S5.SS3.SSSx2.p2.1.m1.1.1.1a" xref="S5.SS3.SSSx2.p2.1.m1.1.1.1.cmml">⁢</mo><mi id="S5.SS3.SSSx2.p2.1.m1.1.1.4" mathvariant="normal" xref="S5.SS3.SSSx2.p2.1.m1.1.1.4.cmml">@</mi><mo id="S5.SS3.SSSx2.p2.1.m1.1.1.1b" xref="S5.SS3.SSSx2.p2.1.m1.1.1.1.cmml">⁢</mo><mn id="S5.SS3.SSSx2.p2.1.m1.1.1.5" xref="S5.SS3.SSSx2.p2.1.m1.1.1.5.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.SSSx2.p2.1.m1.1b"><apply id="S5.SS3.SSSx2.p2.1.m1.1.1.cmml" xref="S5.SS3.SSSx2.p2.1.m1.1.1"><times id="S5.SS3.SSSx2.p2.1.m1.1.1.1.cmml" xref="S5.SS3.SSSx2.p2.1.m1.1.1.1"></times><ci id="S5.SS3.SSSx2.p2.1.m1.1.1.2.cmml" xref="S5.SS3.SSSx2.p2.1.m1.1.1.2">𝐻</ci><ci id="S5.SS3.SSSx2.p2.1.m1.1.1.3.cmml" xref="S5.SS3.SSSx2.p2.1.m1.1.1.3">𝑅</ci><ci id="S5.SS3.SSSx2.p2.1.m1.1.1.4.cmml" xref="S5.SS3.SSSx2.p2.1.m1.1.1.4">@</ci><cn id="S5.SS3.SSSx2.p2.1.m1.1.1.5.cmml" type="integer" xref="S5.SS3.SSSx2.p2.1.m1.1.1.5">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSSx2.p2.1.m1.1c">HR@3</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSSx2.p2.1.m1.1d">italic_H italic_R @ 3</annotation></semantics></math> performance of BM25 and Jaccard on the MMConv dataset can be attributed to the nature of the dialogue dataset, where temporal order is less critical, and certain nodes associated with specific slot values are more discriminative.</p>
</div>
<div class="ltx_para" id="S5.SS3.SSSx2.p3">
<p class="ltx_p" id="S5.SS3.SSSx2.p3.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#S5.T4" title="Table 4 ‣ Effect of Different Retrieval Methods. ‣ 5.3 Model Analysis ‣ 5 Experiment ‣ Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_tag">4</span></a> shows the generative performance of different retrieval methods in the dynamic link prediction task. During testing, we apply the retrieval results obtained from different retrieval methods. We also train a model using the ground-truth retrieval results for a more comprehensive comparison. The “GroundTruth” row represents an upper bound on the performance when using ground-truth retrieval results on the testing data, which, as expected, provides the highest performance metrics. Generally speaking, all retrieval methods show better performance compared to the backbone SimpleDyG without using RAG, demonstrating the effectiveness of the RAG technique for dynamic graph modeling. Our method performs better compared to other retrieval strategies, indicating the effectiveness of contrastive learning in the retrieval model.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S5.SS3.SSSx3">
<h4 class="ltx_title ltx_title_subsubsection">Effect of the Number of Demonstrations <span class="ltx_text ltx_font_italic" id="S5.SS3.SSSx3.1.1">K</span>.</h4>
<div class="ltx_para" id="S5.SS3.SSSx3.p1">
<p class="ltx_p" id="S5.SS3.SSSx3.p1.2">To investigate the influence of the number of demonstrations, we conduct experiments across varying values <math alttext="K\in\{1,3,5,7,9\}" class="ltx_Math" display="inline" id="S5.SS3.SSSx3.p1.1.m1.5"><semantics id="S5.SS3.SSSx3.p1.1.m1.5a"><mrow id="S5.SS3.SSSx3.p1.1.m1.5.6" xref="S5.SS3.SSSx3.p1.1.m1.5.6.cmml"><mi id="S5.SS3.SSSx3.p1.1.m1.5.6.2" xref="S5.SS3.SSSx3.p1.1.m1.5.6.2.cmml">K</mi><mo id="S5.SS3.SSSx3.p1.1.m1.5.6.1" xref="S5.SS3.SSSx3.p1.1.m1.5.6.1.cmml">∈</mo><mrow id="S5.SS3.SSSx3.p1.1.m1.5.6.3.2" xref="S5.SS3.SSSx3.p1.1.m1.5.6.3.1.cmml"><mo id="S5.SS3.SSSx3.p1.1.m1.5.6.3.2.1" stretchy="false" xref="S5.SS3.SSSx3.p1.1.m1.5.6.3.1.cmml">{</mo><mn id="S5.SS3.SSSx3.p1.1.m1.1.1" xref="S5.SS3.SSSx3.p1.1.m1.1.1.cmml">1</mn><mo id="S5.SS3.SSSx3.p1.1.m1.5.6.3.2.2" xref="S5.SS3.SSSx3.p1.1.m1.5.6.3.1.cmml">,</mo><mn id="S5.SS3.SSSx3.p1.1.m1.2.2" xref="S5.SS3.SSSx3.p1.1.m1.2.2.cmml">3</mn><mo id="S5.SS3.SSSx3.p1.1.m1.5.6.3.2.3" xref="S5.SS3.SSSx3.p1.1.m1.5.6.3.1.cmml">,</mo><mn id="S5.SS3.SSSx3.p1.1.m1.3.3" xref="S5.SS3.SSSx3.p1.1.m1.3.3.cmml">5</mn><mo id="S5.SS3.SSSx3.p1.1.m1.5.6.3.2.4" xref="S5.SS3.SSSx3.p1.1.m1.5.6.3.1.cmml">,</mo><mn id="S5.SS3.SSSx3.p1.1.m1.4.4" xref="S5.SS3.SSSx3.p1.1.m1.4.4.cmml">7</mn><mo id="S5.SS3.SSSx3.p1.1.m1.5.6.3.2.5" xref="S5.SS3.SSSx3.p1.1.m1.5.6.3.1.cmml">,</mo><mn id="S5.SS3.SSSx3.p1.1.m1.5.5" xref="S5.SS3.SSSx3.p1.1.m1.5.5.cmml">9</mn><mo id="S5.SS3.SSSx3.p1.1.m1.5.6.3.2.6" stretchy="false" xref="S5.SS3.SSSx3.p1.1.m1.5.6.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.SSSx3.p1.1.m1.5b"><apply id="S5.SS3.SSSx3.p1.1.m1.5.6.cmml" xref="S5.SS3.SSSx3.p1.1.m1.5.6"><in id="S5.SS3.SSSx3.p1.1.m1.5.6.1.cmml" xref="S5.SS3.SSSx3.p1.1.m1.5.6.1"></in><ci id="S5.SS3.SSSx3.p1.1.m1.5.6.2.cmml" xref="S5.SS3.SSSx3.p1.1.m1.5.6.2">𝐾</ci><set id="S5.SS3.SSSx3.p1.1.m1.5.6.3.1.cmml" xref="S5.SS3.SSSx3.p1.1.m1.5.6.3.2"><cn id="S5.SS3.SSSx3.p1.1.m1.1.1.cmml" type="integer" xref="S5.SS3.SSSx3.p1.1.m1.1.1">1</cn><cn id="S5.SS3.SSSx3.p1.1.m1.2.2.cmml" type="integer" xref="S5.SS3.SSSx3.p1.1.m1.2.2">3</cn><cn id="S5.SS3.SSSx3.p1.1.m1.3.3.cmml" type="integer" xref="S5.SS3.SSSx3.p1.1.m1.3.3">5</cn><cn id="S5.SS3.SSSx3.p1.1.m1.4.4.cmml" type="integer" xref="S5.SS3.SSSx3.p1.1.m1.4.4">7</cn><cn id="S5.SS3.SSSx3.p1.1.m1.5.5.cmml" type="integer" xref="S5.SS3.SSSx3.p1.1.m1.5.5">9</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSSx3.p1.1.m1.5c">K\in\{1,3,5,7,9\}</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSSx3.p1.1.m1.5d">italic_K ∈ { 1 , 3 , 5 , 7 , 9 }</annotation></semantics></math>. As shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#S5.F5" title="Figure 5 ‣ Effect of the Number of Demonstrations K. ‣ 5.3 Model Analysis ‣ 5 Experiment ‣ Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_tag">5</span></a>, a higher number of <math alttext="K" class="ltx_Math" display="inline" id="S5.SS3.SSSx3.p1.2.m2.1"><semantics id="S5.SS3.SSSx3.p1.2.m2.1a"><mi id="S5.SS3.SSSx3.p1.2.m2.1.1" xref="S5.SS3.SSSx3.p1.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.SSSx3.p1.2.m2.1b"><ci id="S5.SS3.SSSx3.p1.2.m2.1.1.cmml" xref="S5.SS3.SSSx3.p1.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSSx3.p1.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSSx3.p1.2.m2.1d">italic_K</annotation></semantics></math> yields better prediction performance, that’s because more demonstrations provide richer contextual information, especially in the UCI dataset. However, including too many cases may introduce more noise, which can harm the performance.</p>
</div>
<figure class="ltx_figure" id="S5.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="132" id="S5.F5.g1" src="x6.png" width="330"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Effect of the number of demonstrations <span class="ltx_text ltx_font_italic" id="S5.F5.2.1">K</span>.</figcaption>
</figure>
</section>
<section class="ltx_subsubsection" id="S5.SS3.SSSx4">
<h4 class="ltx_title ltx_title_subsubsection">Effect of Different Fusion Strategies.</h4>
<div class="ltx_para" id="S5.SS3.SSSx4.p1">
<p class="ltx_p" id="S5.SS3.SSSx4.p1.1">To further investigate the effectiveness of the fusion strategy for the top-<span class="ltx_text ltx_font_italic" id="S5.SS3.SSSx4.p1.1.1">K</span> demonstrations, we conduct experiments with different fusion strategies in Table <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#S5.T5" title="Table 5 ‣ Effect of Different Fusion Strategies. ‣ 5.3 Model Analysis ‣ 5 Experiment ‣ Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_tag">5</span></a> for <span class="ltx_text ltx_font_italic" id="S5.SS3.SSSx4.p1.1.2">K</span> <math alttext="=7" class="ltx_Math" display="inline" id="S5.SS3.SSSx4.p1.1.m1.1"><semantics id="S5.SS3.SSSx4.p1.1.m1.1a"><mrow id="S5.SS3.SSSx4.p1.1.m1.1.1" xref="S5.SS3.SSSx4.p1.1.m1.1.1.cmml"><mi id="S5.SS3.SSSx4.p1.1.m1.1.1.2" xref="S5.SS3.SSSx4.p1.1.m1.1.1.2.cmml"></mi><mo id="S5.SS3.SSSx4.p1.1.m1.1.1.1" xref="S5.SS3.SSSx4.p1.1.m1.1.1.1.cmml">=</mo><mn id="S5.SS3.SSSx4.p1.1.m1.1.1.3" xref="S5.SS3.SSSx4.p1.1.m1.1.1.3.cmml">7</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.SSSx4.p1.1.m1.1b"><apply id="S5.SS3.SSSx4.p1.1.m1.1.1.cmml" xref="S5.SS3.SSSx4.p1.1.m1.1.1"><eq id="S5.SS3.SSSx4.p1.1.m1.1.1.1.cmml" xref="S5.SS3.SSSx4.p1.1.m1.1.1.1"></eq><csymbol cd="latexml" id="S5.SS3.SSSx4.p1.1.m1.1.1.2.cmml" xref="S5.SS3.SSSx4.p1.1.m1.1.1.2">absent</csymbol><cn id="S5.SS3.SSSx4.p1.1.m1.1.1.3.cmml" type="integer" xref="S5.SS3.SSSx4.p1.1.m1.1.1.3">7</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSSx4.p1.1.m1.1c">=7</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSSx4.p1.1.m1.1d">= 7</annotation></semantics></math>. We report NDCG@5 in Table <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#S5.T4" title="Table 4 ‣ Effect of Different Retrieval Methods. ‣ 5.3 Model Analysis ‣ 5 Experiment ‣ Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_tag">4</span></a> and present the other metrics in Appendix C. “Concatenation” denotes we directly concatenate the sequences of retrieved demonstrations and prepend them with the query sample sequence and then feed it into the pre-trained SimpleDyG model. “MLP” means we do not consider the graph structure of the demonstrations and replace the graph fusion as an MLP layer (we set the number of the MLP layer as 2). By using the MLP layer, We map the concatenated demonstrations into shorter <span class="ltx_text ltx_font_italic" id="S5.SS3.SSSx4.p1.1.3">m</span>-dimensional embeddings (we empirically set <span class="ltx_text ltx_font_italic" id="S5.SS3.SSSx4.p1.1.4">m</span> to be 15) and then concatenate it with the query sample. Like graph fusion, we only fine-tune the parameters of the MLP and output layer. The results in Table <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#S5.T5" title="Table 5 ‣ Effect of Different Fusion Strategies. ‣ 5.3 Model Analysis ‣ 5 Experiment ‣ Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_tag">5</span></a> show that directly concatenating the retrieved demonstrations with the query sample leads to lower performance compared with other strategies. This is because simple concatenation introduces a lengthy context, which can overwhelm the model with irrelevant information, and it neglects the structural relationships inherent in the demonstrations. The “MLP” strategy improves upon this by mapping the concatenated demonstrations into a shorter feature space, effectively reducing noise and emphasizing more relevant features. This approach yields better results than simple concatenation but still falls short compared to the “GraphFusion” strategy. The superior performance of the “GraphFusion” strategy highlights the importance of considering both the content and the structure of the demonstrations in the fusion process.</p>
</div>
<figure class="ltx_table" id="S5.T5">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T5.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T5.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S5.T5.1.1.1.1" style="padding-left:5.0pt;padding-right:5.0pt;">Fusion strategy</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S5.T5.1.1.1.2" style="padding-left:5.0pt;padding-right:5.0pt;">UCI</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S5.T5.1.1.1.3" style="padding-left:5.0pt;padding-right:5.0pt;">Hepth</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T5.1.1.1.4" style="padding-left:5.0pt;padding-right:5.0pt;">MMConv</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T5.1.2.1">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T5.1.2.1.1" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_italic" id="S5.T5.1.2.1.1.1">Concatenation</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T5.1.2.1.2" style="padding-left:5.0pt;padding-right:5.0pt;">0.036±0.018</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T5.1.2.1.3" style="padding-left:5.0pt;padding-right:5.0pt;">0.007±0.002</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.1.2.1.4" style="padding-left:5.0pt;padding-right:5.0pt;">0.110±0.030</td>
</tr>
<tr class="ltx_tr" id="S5.T5.1.3.2">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T5.1.3.2.1" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_italic" id="S5.T5.1.3.2.1.1">MLP</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T5.1.3.2.2" style="padding-left:5.0pt;padding-right:5.0pt;">0.106±0.017</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T5.1.3.2.3" style="padding-left:5.0pt;padding-right:5.0pt;">0.015±0.002</td>
<td class="ltx_td ltx_align_center" id="S5.T5.1.3.2.4" style="padding-left:5.0pt;padding-right:5.0pt;">0.167±0.006</td>
</tr>
<tr class="ltx_tr" id="S5.T5.1.4.3">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S5.T5.1.4.3.1" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_italic" id="S5.T5.1.4.3.1.1">GraphFusion</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S5.T5.1.4.3.2" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T5.1.4.3.2.1">0.122±0.014</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S5.T5.1.4.3.3" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T5.1.4.3.3.1">0.045±0.003</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T5.1.4.3.4" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T5.1.4.3.4.1">0.208±0.005</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5: </span>Effect of different fusion strategies.</figcaption>
</figure>
</section>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">In this work, we introduced a novel retrieval augmented framework RAG4DyG for dynamic graph modeling, addressing the limitations of existing approaches that often rely on narrow historical contexts. We leverage the RAG technique to broaden the context by incorporating relevant auxiliary information by harvesting high-quality demonstrations for dynamic graph samples and effectively utilizing this demonstration to enhance dynamic graph modeling. Our proposed solution involves a time-aware contrastive learning model to identify and retrieve temporally pertinent cases for each query sequence, coupled with a graph fusion strategy to integrate the inherent historical context with extended temporal contexts. Extensive experiments on real-world datasets across different domains demonstrated the superior performance of RAG4DyG in dynamic graph modeling.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Alon and Yahav (2020)</span>
<span class="ltx_bibblock">
Alon, U.; and Yahav, E. 2020.

</span>
<span class="ltx_bibblock">On the Bottleneck of Graph Neural Networks and its Practical Implications.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">International Conference on Learning Representations</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2020)</span>
<span class="ltx_bibblock">
Chen, D.; Lin, Y.; Li, W.; Li, P.; Zhou, J.; and Sun, X. 2020.

</span>
<span class="ltx_bibblock">Measuring and relieving the over-smoothing problem for graph neural networks from the topological view.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">Proceedings of the AAAI conference on artificial intelligence</em>, volume 34, 3438–3445.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cong et al. (2022)</span>
<span class="ltx_bibblock">
Cong, W.; Zhang, S.; Kang, J.; Yuan, B.; Wu, H.; Zhou, X.; Tong, H.; and Mahdavi, M. 2022.

</span>
<span class="ltx_bibblock">Do We Really Need Complicated Model Architectures For Temporal Networks?

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">The Eleventh International Conference on Learning Representations</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dao et al. (2024)</span>
<span class="ltx_bibblock">
Dao, H.; Deng, Y.; Le, D. D.; and Liao, L. 2024.

</span>
<span class="ltx_bibblock">Broadening the View: Demonstration-augmented Prompt Learning for Conversational Recommendation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">Proceedings of the 47th International ACM SIGIR Conference on Research and Development in Information Retrieval</em>, 785–795.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Devlin et al. (2019)</span>
<span class="ltx_bibblock">
Devlin, J.; Chang, M.-W.; Lee, K.; and Toutanova, K. 2019.

</span>
<span class="ltx_bibblock">BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">Proceedings of the 2019 Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies, Volume 1 (Long and Short Papers)</em>, 4171–4186.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fang, Tao, and Zhai (2004)</span>
<span class="ltx_bibblock">
Fang, H.; Tao, T.; and Zhai, C. 2004.

</span>
<span class="ltx_bibblock">A formal study of information retrieval heuristics.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">Proceedings of the 27th annual international ACM SIGIR conference on Research and development in information retrieval</em>, 49–56.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Feng et al. (2024)</span>
<span class="ltx_bibblock">
Feng, Z.; Wang, R.; Wang, T.; Song, M.; Wu, S.; and He, S. 2024.

</span>
<span class="ltx_bibblock">A Comprehensive Survey of Dynamic Graph Neural Networks: Models, Frameworks, Benchmarks, Experiments and Challenges.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">arXiv preprint arXiv:2405.00476</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gao et al. (2023)</span>
<span class="ltx_bibblock">
Gao, Y.; Xiong, Y.; Gao, X.; Jia, K.; Pan, J.; Bi, Y.; Dai, Y.; Sun, J.; and Wang, H. 2023.

</span>
<span class="ltx_bibblock">Retrieval-augmented generation for large language models: A survey.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">arXiv preprint arXiv:2312.10997</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al. (2024)</span>
<span class="ltx_bibblock">
He, X.; Tian, Y.; Sun, Y.; Chawla, N. V.; Laurent, T.; LeCun, Y.; Bresson, X.; and Hooi, B. 2024.

</span>
<span class="ltx_bibblock">G-retriever: Retrieval-augmented generation for textual graph understanding and question answering.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">arXiv preprint arXiv:2402.07630</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu et al. (2024)</span>
<span class="ltx_bibblock">
Hu, Y.; Lei, Z.; Zhang, Z.; Pan, B.; Ling, C.; and Zhao, L. 2024.

</span>
<span class="ltx_bibblock">GRAG: Graph Retrieval-Augmented Generation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">arXiv preprint arXiv:2405.16506</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jaccard (1901)</span>
<span class="ltx_bibblock">
Jaccard, P. 1901.

</span>
<span class="ltx_bibblock">Étude comparative de la distribution florale dans une portion des Alpes et des Jura.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">Bull Soc Vaudoise Sci Nat</em>, 37: 547–579.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ji et al. (2021)</span>
<span class="ltx_bibblock">
Ji, Y.; Jia, T.; Fang, Y.; and Shi, C. 2021.

</span>
<span class="ltx_bibblock">Dynamic heterogeneous graph embedding via heterogeneous hawkes process.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">Machine Learning and Knowledge Discovery in Databases. Research Track: European Conference, ECML PKDD 2021, Bilbao, Spain, September 13–17, 2021, Proceedings, Part I 21</em>, 388–403. Springer.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang et al. (2023)</span>
<span class="ltx_bibblock">
Jiang, Z.; Xu, F. F.; Gao, L.; Sun, Z.; Liu, Q.; Dwivedi-Yu, J.; Yang, Y.; Callan, J.; and Neubig, G. 2023.

</span>
<span class="ltx_bibblock">Active Retrieval Augmented Generation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">Proceedings of the 2023 Conference on Empirical Methods in Natural Language Processing</em>, 7969–7992.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Karpukhin et al. (2020)</span>
<span class="ltx_bibblock">
Karpukhin, V.; Oguz, B.; Min, S.; Lewis, P.; Wu, L.; Edunov, S.; Chen, D.; and Yih, W.-t. 2020.

</span>
<span class="ltx_bibblock">Dense Passage Retrieval for Open-Domain Question Answering.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">Proceedings of the 2020 Conference on Empirical Methods in Natural Language Processing (EMNLP)</em>, 6769–6781.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kim et al. (2024)</span>
<span class="ltx_bibblock">
Kim, J.; Cho, E.; Kim, S.; and Kim, H. J. 2024.

</span>
<span class="ltx_bibblock">Retrieval-Augmented Open-Vocabulary Object Detection.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, 17427–17436.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kumar, Zhang, and Leskovec (2019)</span>
<span class="ltx_bibblock">
Kumar, S.; Zhang, X.; and Leskovec, J. 2019.

</span>
<span class="ltx_bibblock">Predicting dynamic embedding trajectory in temporal interaction networks.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">Proceedings of the 25th ACM SIGKDD international conference on knowledge discovery &amp; data mining</em>, 1269–1278.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Leskovec, Kleinberg, and Faloutsos (2005)</span>
<span class="ltx_bibblock">
Leskovec, J.; Kleinberg, J.; and Faloutsos, C. 2005.

</span>
<span class="ltx_bibblock">Graphs over time: densification laws, shrinking diameters and possible explanations.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">Proceedings of the eleventh ACM SIGKDD international conference on Knowledge discovery in data mining</em>, 177–187.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liao et al. (2021)</span>
<span class="ltx_bibblock">
Liao, L.; Long, L. H.; Zhang, Z.; Huang, M.; and Chua, T.-S. 2021.

</span>
<span class="ltx_bibblock">MMConv: an environment for multimodal conversational search across multiple domains.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">Proceedings of the 44th international ACM SIGIR conference on research and development in information retrieval</em>, 675–684.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2023)</span>
<span class="ltx_bibblock">
Liu, H.; Son, K.; Yang, J.; Liu, C.; Gao, J.; Lee, Y. J.; and Li, C. 2023.

</span>
<span class="ltx_bibblock">Learning customized visual models with retrieval-augmented knowledge.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, 15148–15158.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2021)</span>
<span class="ltx_bibblock">
Liu, S.; Chen, Y.; Xie, X.; Siow, J. K.; and Liu, Y. 2021.

</span>
<span class="ltx_bibblock">Retrieval-Augmented Generation for Code Summarization via Hybrid GNN.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">International Conference on Learning Representations</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Panzarasa, Opsahl, and Carley (2009)</span>
<span class="ltx_bibblock">
Panzarasa, P.; Opsahl, T.; and Carley, K. M. 2009.

</span>
<span class="ltx_bibblock">Patterns and dynamics of users’ behavior and interaction: Network analysis of an online community.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">Journal of the American Society for Information Science and Technology</em>, 60(5): 911–932.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pareja et al. (2020)</span>
<span class="ltx_bibblock">
Pareja, A.; Domeniconi, G.; Chen, J.; Ma, T.; Suzumura, T.; Kanezashi, H.; Kaler, T.; Schardl, T.; and Leiserson, C. 2020.

</span>
<span class="ltx_bibblock">Evolvegcn: Evolving graph convolutional networks for dynamic graphs.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">Proceedings of the AAAI conference on artificial intelligence</em>, volume 34, 5363–5370.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rossi et al. (2020)</span>
<span class="ltx_bibblock">
Rossi, E.; Chamberlain, B.; Frasca, F.; Eynard, D.; Monti, F.; and Bronstein, M. 2020.

</span>
<span class="ltx_bibblock">Temporal graph networks for deep learning on dynamic graphs.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">arXiv preprint arXiv:2006.10637</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sankar et al. (2020)</span>
<span class="ltx_bibblock">
Sankar, A.; Wu, Y.; Gou, L.; Zhang, W.; and Yang, H. 2020.

</span>
<span class="ltx_bibblock">Dysat: Deep neural representation learning on dynamic graphs via self-attention networks.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">Proceedings of the 13th international conference on web search and data mining</em>, 519–527.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Trivedi et al. (2019)</span>
<span class="ltx_bibblock">
Trivedi, R.; Farajtabar, M.; Biswal, P.; and Zha, H. 2019.

</span>
<span class="ltx_bibblock">Dyrep: Learning representations over dynamic graphs.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">International conference on learning representations</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2019)</span>
<span class="ltx_bibblock">
Wang, X.; He, X.; Wang, M.; Feng, F.; and Chua, T.-S. 2019.

</span>
<span class="ltx_bibblock">Neural graph collaborative filtering.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">Proceedings of the 42nd international ACM SIGIR conference on Research and development in Information Retrieval</em>, 165–174.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2021)</span>
<span class="ltx_bibblock">
Wang, Y.; Chang, Y.-Y.; Liu, Y.; Leskovec, J.; and Li, P. 2021.

</span>
<span class="ltx_bibblock">Inductive Representation Learning in Temporal Networks via Causal Anonymous Walks.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">International Conference on Learning Representations (ICLR)</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wen and Fang (2022)</span>
<span class="ltx_bibblock">
Wen, Z.; and Fang, Y. 2022.

</span>
<span class="ltx_bibblock">Trend: Temporal event and node dynamics for graph representation learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">Proceedings of the ACM Web Conference 2022</em>, 1159–1169.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu, Fang, and Liao (2024)</span>
<span class="ltx_bibblock">
Wu, Y.; Fang, Y.; and Liao, L. 2024.

</span>
<span class="ltx_bibblock">On the Feasibility of Simple Transformer for Dynamic Graph Modeling.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">Proceedings of the ACM on Web Conference 2024</em>, 870–880.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xie et al. (2022)</span>
<span class="ltx_bibblock">
Xie, X.; Sun, F.; Liu, Z.; Wu, S.; Gao, J.; Zhang, J.; Ding, B.; and Cui, B. 2022.

</span>
<span class="ltx_bibblock">Contrastive learning for sequential recommendation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">2022 IEEE 38th international conference on data engineering (ICDE)</em>, 1259–1273. IEEE.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et al. (2020)</span>
<span class="ltx_bibblock">
Xu, D.; Ruan, C.; Korpeoglu, E.; Kumar, S.; and Achan, K. 2020.

</span>
<span class="ltx_bibblock">Inductive representation learning on temporal graphs.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ye et al. (2022)</span>
<span class="ltx_bibblock">
Ye, C.; Liao, L.; Liu, S.; and Chua, T.-S. 2022.

</span>
<span class="ltx_bibblock">Reflecting on experiences for response generation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">Proceedings of the 30th ACM International Conference on Multimedia</em>, 5265–5273.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="Ax1">
<h2 class="ltx_title ltx_title_appendix">Appendix</h2>
</section>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Retrieval Data Annotation</h2>
<div class="ltx_para" id="A1.p1">
<p class="ltx_p" id="A1.p1.6">To facilitate retrieval model training, we regard the samples in the training dataset as our retrieval pool <math alttext="D=\{(x_{i},y_{i})\}_{i=1}^{M}" class="ltx_Math" display="inline" id="A1.p1.1.m1.1"><semantics id="A1.p1.1.m1.1a"><mrow id="A1.p1.1.m1.1.1" xref="A1.p1.1.m1.1.1.cmml"><mi id="A1.p1.1.m1.1.1.3" xref="A1.p1.1.m1.1.1.3.cmml">D</mi><mo id="A1.p1.1.m1.1.1.2" xref="A1.p1.1.m1.1.1.2.cmml">=</mo><msubsup id="A1.p1.1.m1.1.1.1" xref="A1.p1.1.m1.1.1.1.cmml"><mrow id="A1.p1.1.m1.1.1.1.1.1.1" xref="A1.p1.1.m1.1.1.1.1.1.2.cmml"><mo id="A1.p1.1.m1.1.1.1.1.1.1.2" stretchy="false" xref="A1.p1.1.m1.1.1.1.1.1.2.cmml">{</mo><mrow id="A1.p1.1.m1.1.1.1.1.1.1.1.2" xref="A1.p1.1.m1.1.1.1.1.1.1.1.3.cmml"><mo id="A1.p1.1.m1.1.1.1.1.1.1.1.2.3" stretchy="false" xref="A1.p1.1.m1.1.1.1.1.1.1.1.3.cmml">(</mo><msub id="A1.p1.1.m1.1.1.1.1.1.1.1.1.1" xref="A1.p1.1.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.p1.1.m1.1.1.1.1.1.1.1.1.1.2" xref="A1.p1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="A1.p1.1.m1.1.1.1.1.1.1.1.1.1.3" xref="A1.p1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A1.p1.1.m1.1.1.1.1.1.1.1.2.4" xref="A1.p1.1.m1.1.1.1.1.1.1.1.3.cmml">,</mo><msub id="A1.p1.1.m1.1.1.1.1.1.1.1.2.2" xref="A1.p1.1.m1.1.1.1.1.1.1.1.2.2.cmml"><mi id="A1.p1.1.m1.1.1.1.1.1.1.1.2.2.2" xref="A1.p1.1.m1.1.1.1.1.1.1.1.2.2.2.cmml">y</mi><mi id="A1.p1.1.m1.1.1.1.1.1.1.1.2.2.3" xref="A1.p1.1.m1.1.1.1.1.1.1.1.2.2.3.cmml">i</mi></msub><mo id="A1.p1.1.m1.1.1.1.1.1.1.1.2.5" stretchy="false" xref="A1.p1.1.m1.1.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo id="A1.p1.1.m1.1.1.1.1.1.1.3" stretchy="false" xref="A1.p1.1.m1.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="A1.p1.1.m1.1.1.1.1.3" xref="A1.p1.1.m1.1.1.1.1.3.cmml"><mi id="A1.p1.1.m1.1.1.1.1.3.2" xref="A1.p1.1.m1.1.1.1.1.3.2.cmml">i</mi><mo id="A1.p1.1.m1.1.1.1.1.3.1" xref="A1.p1.1.m1.1.1.1.1.3.1.cmml">=</mo><mn id="A1.p1.1.m1.1.1.1.1.3.3" xref="A1.p1.1.m1.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="A1.p1.1.m1.1.1.1.3" xref="A1.p1.1.m1.1.1.1.3.cmml">M</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.1.m1.1b"><apply id="A1.p1.1.m1.1.1.cmml" xref="A1.p1.1.m1.1.1"><eq id="A1.p1.1.m1.1.1.2.cmml" xref="A1.p1.1.m1.1.1.2"></eq><ci id="A1.p1.1.m1.1.1.3.cmml" xref="A1.p1.1.m1.1.1.3">𝐷</ci><apply id="A1.p1.1.m1.1.1.1.cmml" xref="A1.p1.1.m1.1.1.1"><csymbol cd="ambiguous" id="A1.p1.1.m1.1.1.1.2.cmml" xref="A1.p1.1.m1.1.1.1">superscript</csymbol><apply id="A1.p1.1.m1.1.1.1.1.cmml" xref="A1.p1.1.m1.1.1.1"><csymbol cd="ambiguous" id="A1.p1.1.m1.1.1.1.1.2.cmml" xref="A1.p1.1.m1.1.1.1">subscript</csymbol><set id="A1.p1.1.m1.1.1.1.1.1.2.cmml" xref="A1.p1.1.m1.1.1.1.1.1.1"><interval closure="open" id="A1.p1.1.m1.1.1.1.1.1.1.1.3.cmml" xref="A1.p1.1.m1.1.1.1.1.1.1.1.2"><apply id="A1.p1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.p1.1.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.p1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.p1.1.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.p1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.p1.1.m1.1.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="A1.p1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.p1.1.m1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="A1.p1.1.m1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.p1.1.m1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A1.p1.1.m1.1.1.1.1.1.1.1.2.2.1.cmml" xref="A1.p1.1.m1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="A1.p1.1.m1.1.1.1.1.1.1.1.2.2.2.cmml" xref="A1.p1.1.m1.1.1.1.1.1.1.1.2.2.2">𝑦</ci><ci id="A1.p1.1.m1.1.1.1.1.1.1.1.2.2.3.cmml" xref="A1.p1.1.m1.1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply></interval></set><apply id="A1.p1.1.m1.1.1.1.1.3.cmml" xref="A1.p1.1.m1.1.1.1.1.3"><eq id="A1.p1.1.m1.1.1.1.1.3.1.cmml" xref="A1.p1.1.m1.1.1.1.1.3.1"></eq><ci id="A1.p1.1.m1.1.1.1.1.3.2.cmml" xref="A1.p1.1.m1.1.1.1.1.3.2">𝑖</ci><cn id="A1.p1.1.m1.1.1.1.1.3.3.cmml" type="integer" xref="A1.p1.1.m1.1.1.1.1.3.3">1</cn></apply></apply><ci id="A1.p1.1.m1.1.1.1.3.cmml" xref="A1.p1.1.m1.1.1.1.3">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.1.m1.1c">D=\{(x_{i},y_{i})\}_{i=1}^{M}</annotation><annotation encoding="application/x-llamapun" id="A1.p1.1.m1.1d">italic_D = { ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT</annotation></semantics></math> where each pair <math alttext="(x_{i},y_{i})" class="ltx_Math" display="inline" id="A1.p1.2.m2.2"><semantics id="A1.p1.2.m2.2a"><mrow id="A1.p1.2.m2.2.2.2" xref="A1.p1.2.m2.2.2.3.cmml"><mo id="A1.p1.2.m2.2.2.2.3" stretchy="false" xref="A1.p1.2.m2.2.2.3.cmml">(</mo><msub id="A1.p1.2.m2.1.1.1.1" xref="A1.p1.2.m2.1.1.1.1.cmml"><mi id="A1.p1.2.m2.1.1.1.1.2" xref="A1.p1.2.m2.1.1.1.1.2.cmml">x</mi><mi id="A1.p1.2.m2.1.1.1.1.3" xref="A1.p1.2.m2.1.1.1.1.3.cmml">i</mi></msub><mo id="A1.p1.2.m2.2.2.2.4" xref="A1.p1.2.m2.2.2.3.cmml">,</mo><msub id="A1.p1.2.m2.2.2.2.2" xref="A1.p1.2.m2.2.2.2.2.cmml"><mi id="A1.p1.2.m2.2.2.2.2.2" xref="A1.p1.2.m2.2.2.2.2.2.cmml">y</mi><mi id="A1.p1.2.m2.2.2.2.2.3" xref="A1.p1.2.m2.2.2.2.2.3.cmml">i</mi></msub><mo id="A1.p1.2.m2.2.2.2.5" stretchy="false" xref="A1.p1.2.m2.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.2.m2.2b"><interval closure="open" id="A1.p1.2.m2.2.2.3.cmml" xref="A1.p1.2.m2.2.2.2"><apply id="A1.p1.2.m2.1.1.1.1.cmml" xref="A1.p1.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="A1.p1.2.m2.1.1.1.1.1.cmml" xref="A1.p1.2.m2.1.1.1.1">subscript</csymbol><ci id="A1.p1.2.m2.1.1.1.1.2.cmml" xref="A1.p1.2.m2.1.1.1.1.2">𝑥</ci><ci id="A1.p1.2.m2.1.1.1.1.3.cmml" xref="A1.p1.2.m2.1.1.1.1.3">𝑖</ci></apply><apply id="A1.p1.2.m2.2.2.2.2.cmml" xref="A1.p1.2.m2.2.2.2.2"><csymbol cd="ambiguous" id="A1.p1.2.m2.2.2.2.2.1.cmml" xref="A1.p1.2.m2.2.2.2.2">subscript</csymbol><ci id="A1.p1.2.m2.2.2.2.2.2.cmml" xref="A1.p1.2.m2.2.2.2.2.2">𝑦</ci><ci id="A1.p1.2.m2.2.2.2.2.3.cmml" xref="A1.p1.2.m2.2.2.2.2.3">𝑖</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.2.m2.2c">(x_{i},y_{i})</annotation><annotation encoding="application/x-llamapun" id="A1.p1.2.m2.2d">( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math> represents the historical sequence and its corresponding target sequence. Specifically, <math alttext="x_{i}" class="ltx_Math" display="inline" id="A1.p1.3.m3.1"><semantics id="A1.p1.3.m3.1a"><msub id="A1.p1.3.m3.1.1" xref="A1.p1.3.m3.1.1.cmml"><mi id="A1.p1.3.m3.1.1.2" xref="A1.p1.3.m3.1.1.2.cmml">x</mi><mi id="A1.p1.3.m3.1.1.3" xref="A1.p1.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.p1.3.m3.1b"><apply id="A1.p1.3.m3.1.1.cmml" xref="A1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="A1.p1.3.m3.1.1.1.cmml" xref="A1.p1.3.m3.1.1">subscript</csymbol><ci id="A1.p1.3.m3.1.1.2.cmml" xref="A1.p1.3.m3.1.1.2">𝑥</ci><ci id="A1.p1.3.m3.1.1.3.cmml" xref="A1.p1.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.3.m3.1c">x_{i}</annotation><annotation encoding="application/x-llamapun" id="A1.p1.3.m3.1d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is the input sequence before the last time step and <math alttext="y_{i}" class="ltx_Math" display="inline" id="A1.p1.4.m4.1"><semantics id="A1.p1.4.m4.1a"><msub id="A1.p1.4.m4.1.1" xref="A1.p1.4.m4.1.1.cmml"><mi id="A1.p1.4.m4.1.1.2" xref="A1.p1.4.m4.1.1.2.cmml">y</mi><mi id="A1.p1.4.m4.1.1.3" xref="A1.p1.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.p1.4.m4.1b"><apply id="A1.p1.4.m4.1.1.cmml" xref="A1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="A1.p1.4.m4.1.1.1.cmml" xref="A1.p1.4.m4.1.1">subscript</csymbol><ci id="A1.p1.4.m4.1.1.2.cmml" xref="A1.p1.4.m4.1.1.2">𝑦</ci><ci id="A1.p1.4.m4.1.1.3.cmml" xref="A1.p1.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.4.m4.1c">y_{i}</annotation><annotation encoding="application/x-llamapun" id="A1.p1.4.m4.1d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is the output sequence at the last time step. We annotate demonstrations based on the Jaccard similarity of <math alttext="y_{i}" class="ltx_Math" display="inline" id="A1.p1.5.m5.1"><semantics id="A1.p1.5.m5.1a"><msub id="A1.p1.5.m5.1.1" xref="A1.p1.5.m5.1.1.cmml"><mi id="A1.p1.5.m5.1.1.2" xref="A1.p1.5.m5.1.1.2.cmml">y</mi><mi id="A1.p1.5.m5.1.1.3" xref="A1.p1.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.p1.5.m5.1b"><apply id="A1.p1.5.m5.1.1.cmml" xref="A1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="A1.p1.5.m5.1.1.1.cmml" xref="A1.p1.5.m5.1.1">subscript</csymbol><ci id="A1.p1.5.m5.1.1.2.cmml" xref="A1.p1.5.m5.1.1.2">𝑦</ci><ci id="A1.p1.5.m5.1.1.3.cmml" xref="A1.p1.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.5.m5.1c">y_{i}</annotation><annotation encoding="application/x-llamapun" id="A1.p1.5.m5.1d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> among all the pairs in <math alttext="D" class="ltx_Math" display="inline" id="A1.p1.6.m6.1"><semantics id="A1.p1.6.m6.1a"><mi id="A1.p1.6.m6.1.1" xref="A1.p1.6.m6.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="A1.p1.6.m6.1b"><ci id="A1.p1.6.m6.1.1.cmml" xref="A1.p1.6.m6.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.6.m6.1c">D</annotation><annotation encoding="application/x-llamapun" id="A1.p1.6.m6.1d">italic_D</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="A1.p2">
<table class="ltx_equation ltx_eqn_table" id="A1.E11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="r(y_{i},y_{j})=\frac{|y_{i}\cap y_{j}|}{|y_{i}\cup y_{j}|}" class="ltx_Math" display="block" id="A1.E11.m1.4"><semantics id="A1.E11.m1.4a"><mrow id="A1.E11.m1.4.4" xref="A1.E11.m1.4.4.cmml"><mrow id="A1.E11.m1.4.4.2" xref="A1.E11.m1.4.4.2.cmml"><mi id="A1.E11.m1.4.4.2.4" xref="A1.E11.m1.4.4.2.4.cmml">r</mi><mo id="A1.E11.m1.4.4.2.3" xref="A1.E11.m1.4.4.2.3.cmml">⁢</mo><mrow id="A1.E11.m1.4.4.2.2.2" xref="A1.E11.m1.4.4.2.2.3.cmml"><mo id="A1.E11.m1.4.4.2.2.2.3" stretchy="false" xref="A1.E11.m1.4.4.2.2.3.cmml">(</mo><msub id="A1.E11.m1.3.3.1.1.1.1" xref="A1.E11.m1.3.3.1.1.1.1.cmml"><mi id="A1.E11.m1.3.3.1.1.1.1.2" xref="A1.E11.m1.3.3.1.1.1.1.2.cmml">y</mi><mi id="A1.E11.m1.3.3.1.1.1.1.3" xref="A1.E11.m1.3.3.1.1.1.1.3.cmml">i</mi></msub><mo id="A1.E11.m1.4.4.2.2.2.4" xref="A1.E11.m1.4.4.2.2.3.cmml">,</mo><msub id="A1.E11.m1.4.4.2.2.2.2" xref="A1.E11.m1.4.4.2.2.2.2.cmml"><mi id="A1.E11.m1.4.4.2.2.2.2.2" xref="A1.E11.m1.4.4.2.2.2.2.2.cmml">y</mi><mi id="A1.E11.m1.4.4.2.2.2.2.3" xref="A1.E11.m1.4.4.2.2.2.2.3.cmml">j</mi></msub><mo id="A1.E11.m1.4.4.2.2.2.5" stretchy="false" xref="A1.E11.m1.4.4.2.2.3.cmml">)</mo></mrow></mrow><mo id="A1.E11.m1.4.4.3" xref="A1.E11.m1.4.4.3.cmml">=</mo><mfrac id="A1.E11.m1.2.2" xref="A1.E11.m1.2.2.cmml"><mrow id="A1.E11.m1.1.1.1.1" xref="A1.E11.m1.1.1.1.2.cmml"><mo id="A1.E11.m1.1.1.1.1.2" stretchy="false" xref="A1.E11.m1.1.1.1.2.1.cmml">|</mo><mrow id="A1.E11.m1.1.1.1.1.1" xref="A1.E11.m1.1.1.1.1.1.cmml"><msub id="A1.E11.m1.1.1.1.1.1.2" xref="A1.E11.m1.1.1.1.1.1.2.cmml"><mi id="A1.E11.m1.1.1.1.1.1.2.2" xref="A1.E11.m1.1.1.1.1.1.2.2.cmml">y</mi><mi id="A1.E11.m1.1.1.1.1.1.2.3" xref="A1.E11.m1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="A1.E11.m1.1.1.1.1.1.1" xref="A1.E11.m1.1.1.1.1.1.1.cmml">∩</mo><msub id="A1.E11.m1.1.1.1.1.1.3" xref="A1.E11.m1.1.1.1.1.1.3.cmml"><mi id="A1.E11.m1.1.1.1.1.1.3.2" xref="A1.E11.m1.1.1.1.1.1.3.2.cmml">y</mi><mi id="A1.E11.m1.1.1.1.1.1.3.3" xref="A1.E11.m1.1.1.1.1.1.3.3.cmml">j</mi></msub></mrow><mo id="A1.E11.m1.1.1.1.1.3" stretchy="false" xref="A1.E11.m1.1.1.1.2.1.cmml">|</mo></mrow><mrow id="A1.E11.m1.2.2.2.1" xref="A1.E11.m1.2.2.2.2.cmml"><mo id="A1.E11.m1.2.2.2.1.2" stretchy="false" xref="A1.E11.m1.2.2.2.2.1.cmml">|</mo><mrow id="A1.E11.m1.2.2.2.1.1" xref="A1.E11.m1.2.2.2.1.1.cmml"><msub id="A1.E11.m1.2.2.2.1.1.2" xref="A1.E11.m1.2.2.2.1.1.2.cmml"><mi id="A1.E11.m1.2.2.2.1.1.2.2" xref="A1.E11.m1.2.2.2.1.1.2.2.cmml">y</mi><mi id="A1.E11.m1.2.2.2.1.1.2.3" xref="A1.E11.m1.2.2.2.1.1.2.3.cmml">i</mi></msub><mo id="A1.E11.m1.2.2.2.1.1.1" xref="A1.E11.m1.2.2.2.1.1.1.cmml">∪</mo><msub id="A1.E11.m1.2.2.2.1.1.3" xref="A1.E11.m1.2.2.2.1.1.3.cmml"><mi id="A1.E11.m1.2.2.2.1.1.3.2" xref="A1.E11.m1.2.2.2.1.1.3.2.cmml">y</mi><mi id="A1.E11.m1.2.2.2.1.1.3.3" xref="A1.E11.m1.2.2.2.1.1.3.3.cmml">j</mi></msub></mrow><mo id="A1.E11.m1.2.2.2.1.3" stretchy="false" xref="A1.E11.m1.2.2.2.2.1.cmml">|</mo></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="A1.E11.m1.4b"><apply id="A1.E11.m1.4.4.cmml" xref="A1.E11.m1.4.4"><eq id="A1.E11.m1.4.4.3.cmml" xref="A1.E11.m1.4.4.3"></eq><apply id="A1.E11.m1.4.4.2.cmml" xref="A1.E11.m1.4.4.2"><times id="A1.E11.m1.4.4.2.3.cmml" xref="A1.E11.m1.4.4.2.3"></times><ci id="A1.E11.m1.4.4.2.4.cmml" xref="A1.E11.m1.4.4.2.4">𝑟</ci><interval closure="open" id="A1.E11.m1.4.4.2.2.3.cmml" xref="A1.E11.m1.4.4.2.2.2"><apply id="A1.E11.m1.3.3.1.1.1.1.cmml" xref="A1.E11.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="A1.E11.m1.3.3.1.1.1.1.1.cmml" xref="A1.E11.m1.3.3.1.1.1.1">subscript</csymbol><ci id="A1.E11.m1.3.3.1.1.1.1.2.cmml" xref="A1.E11.m1.3.3.1.1.1.1.2">𝑦</ci><ci id="A1.E11.m1.3.3.1.1.1.1.3.cmml" xref="A1.E11.m1.3.3.1.1.1.1.3">𝑖</ci></apply><apply id="A1.E11.m1.4.4.2.2.2.2.cmml" xref="A1.E11.m1.4.4.2.2.2.2"><csymbol cd="ambiguous" id="A1.E11.m1.4.4.2.2.2.2.1.cmml" xref="A1.E11.m1.4.4.2.2.2.2">subscript</csymbol><ci id="A1.E11.m1.4.4.2.2.2.2.2.cmml" xref="A1.E11.m1.4.4.2.2.2.2.2">𝑦</ci><ci id="A1.E11.m1.4.4.2.2.2.2.3.cmml" xref="A1.E11.m1.4.4.2.2.2.2.3">𝑗</ci></apply></interval></apply><apply id="A1.E11.m1.2.2.cmml" xref="A1.E11.m1.2.2"><divide id="A1.E11.m1.2.2.3.cmml" xref="A1.E11.m1.2.2"></divide><apply id="A1.E11.m1.1.1.1.2.cmml" xref="A1.E11.m1.1.1.1.1"><abs id="A1.E11.m1.1.1.1.2.1.cmml" xref="A1.E11.m1.1.1.1.1.2"></abs><apply id="A1.E11.m1.1.1.1.1.1.cmml" xref="A1.E11.m1.1.1.1.1.1"><intersect id="A1.E11.m1.1.1.1.1.1.1.cmml" xref="A1.E11.m1.1.1.1.1.1.1"></intersect><apply id="A1.E11.m1.1.1.1.1.1.2.cmml" xref="A1.E11.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.E11.m1.1.1.1.1.1.2.1.cmml" xref="A1.E11.m1.1.1.1.1.1.2">subscript</csymbol><ci id="A1.E11.m1.1.1.1.1.1.2.2.cmml" xref="A1.E11.m1.1.1.1.1.1.2.2">𝑦</ci><ci id="A1.E11.m1.1.1.1.1.1.2.3.cmml" xref="A1.E11.m1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="A1.E11.m1.1.1.1.1.1.3.cmml" xref="A1.E11.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E11.m1.1.1.1.1.1.3.1.cmml" xref="A1.E11.m1.1.1.1.1.1.3">subscript</csymbol><ci id="A1.E11.m1.1.1.1.1.1.3.2.cmml" xref="A1.E11.m1.1.1.1.1.1.3.2">𝑦</ci><ci id="A1.E11.m1.1.1.1.1.1.3.3.cmml" xref="A1.E11.m1.1.1.1.1.1.3.3">𝑗</ci></apply></apply></apply><apply id="A1.E11.m1.2.2.2.2.cmml" xref="A1.E11.m1.2.2.2.1"><abs id="A1.E11.m1.2.2.2.2.1.cmml" xref="A1.E11.m1.2.2.2.1.2"></abs><apply id="A1.E11.m1.2.2.2.1.1.cmml" xref="A1.E11.m1.2.2.2.1.1"><union id="A1.E11.m1.2.2.2.1.1.1.cmml" xref="A1.E11.m1.2.2.2.1.1.1"></union><apply id="A1.E11.m1.2.2.2.1.1.2.cmml" xref="A1.E11.m1.2.2.2.1.1.2"><csymbol cd="ambiguous" id="A1.E11.m1.2.2.2.1.1.2.1.cmml" xref="A1.E11.m1.2.2.2.1.1.2">subscript</csymbol><ci id="A1.E11.m1.2.2.2.1.1.2.2.cmml" xref="A1.E11.m1.2.2.2.1.1.2.2">𝑦</ci><ci id="A1.E11.m1.2.2.2.1.1.2.3.cmml" xref="A1.E11.m1.2.2.2.1.1.2.3">𝑖</ci></apply><apply id="A1.E11.m1.2.2.2.1.1.3.cmml" xref="A1.E11.m1.2.2.2.1.1.3"><csymbol cd="ambiguous" id="A1.E11.m1.2.2.2.1.1.3.1.cmml" xref="A1.E11.m1.2.2.2.1.1.3">subscript</csymbol><ci id="A1.E11.m1.2.2.2.1.1.3.2.cmml" xref="A1.E11.m1.2.2.2.1.1.3.2">𝑦</ci><ci id="A1.E11.m1.2.2.2.1.1.3.3.cmml" xref="A1.E11.m1.2.2.2.1.1.3.3">𝑗</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E11.m1.4c">r(y_{i},y_{j})=\frac{|y_{i}\cap y_{j}|}{|y_{i}\cup y_{j}|}</annotation><annotation encoding="application/x-llamapun" id="A1.E11.m1.4d">italic_r ( italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) = divide start_ARG | italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∩ italic_y start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT | end_ARG start_ARG | italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∪ italic_y start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT | end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="A1.p3">
<p class="ltx_p" id="A1.p3.1">To control the quality of annotated data, we set a threshold of 0.8 to select highly similar demonstrations for each sample. These filtered annotations are then used to train the retriever model. The number of training samples for UCI, Hepth and MMConv datasets are 9,578, 8,250 and 10,762, respectively.</p>
</div>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>More Details about Baselines</h2>
<div class="ltx_para" id="A2.p1">
<p class="ltx_p" id="A2.p1.1">The details of the baselines are as follows:</p>
</div>
<div class="ltx_para" id="A2.p2">
<ul class="ltx_itemize" id="A2.I1">
<li class="ltx_item" id="A2.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I1.i1.p1">
<p class="ltx_p" id="A2.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="A2.I1.i1.p1.1.1">DySAT</span> <cite class="ltx_cite ltx_citemacro_citep">(Sankar et al. <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib24" title="">2020</a>)</cite> utilizes self-attention mechanisms to capture both structural and temporal patterns in dynamic graphs through discrete-time snapshots.</p>
</div>
</li>
<li class="ltx_item" id="A2.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I1.i2.p1">
<p class="ltx_p" id="A2.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="A2.I1.i2.p1.1.1">EvolveGCN</span> <cite class="ltx_cite ltx_citemacro_citep">(Pareja et al. <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib22" title="">2020</a>)</cite> leverages recurrent neural networks to evolve the graph convolutional network parameters over discrete time steps.</p>
</div>
</li>
<li class="ltx_item" id="A2.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I1.i3.p1">
<p class="ltx_p" id="A2.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="A2.I1.i3.p1.1.1">DyRep</span> <cite class="ltx_cite ltx_citemacro_citep">(Trivedi et al. <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib25" title="">2019</a>)</cite> models dynamic graphs in continuous time by incorporating both temporal point processes and structural dynamics to capture interactions and node dynamics.</p>
</div>
</li>
<li class="ltx_item" id="A2.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I1.i4.p1">
<p class="ltx_p" id="A2.I1.i4.p1.1"><span class="ltx_text ltx_font_bold" id="A2.I1.i4.p1.1.1">JODIE</span> <cite class="ltx_cite ltx_citemacro_citep">(Kumar, Zhang, and Leskovec <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib16" title="">2019</a>)</cite> focuses on user and item embedding trajectories over continuous time, predicting future interactions by modeling user and item embeddings jointly.</p>
</div>
</li>
<li class="ltx_item" id="A2.I1.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I1.i5.p1">
<p class="ltx_p" id="A2.I1.i5.p1.1"><span class="ltx_text ltx_font_bold" id="A2.I1.i5.p1.1.1">TGAT</span> <cite class="ltx_cite ltx_citemacro_citep">(Xu et al. <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib31" title="">2020</a>)</cite> employs temporal graph attention layers and time encoding to capture temporal dependencies and structural information for dynamic graphs.</p>
</div>
</li>
<li class="ltx_item" id="A2.I1.i6" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I1.i6.p1">
<p class="ltx_p" id="A2.I1.i6.p1.1"><span class="ltx_text ltx_font_bold" id="A2.I1.i6.p1.1.1">TGN</span> <cite class="ltx_cite ltx_citemacro_citep">(Rossi et al. <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib23" title="">2020</a>)</cite> combines GNNs with memory modules to maintain node states over continuous time, effectively learning from dynamic interactions.</p>
</div>
</li>
<li class="ltx_item" id="A2.I1.i7" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I1.i7.p1">
<p class="ltx_p" id="A2.I1.i7.p1.1"><span class="ltx_text ltx_font_bold" id="A2.I1.i7.p1.1.1">TREND</span> <cite class="ltx_cite ltx_citemacro_citep">(Wen and Fang <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib28" title="">2022</a>)</cite> integrates temporal dependencies based on Hawkes process and GNN to learn the dynamics of graphs.</p>
</div>
</li>
<li class="ltx_item" id="A2.I1.i8" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I1.i8.p1">
<p class="ltx_p" id="A2.I1.i8.p1.1"><span class="ltx_text ltx_font_bold" id="A2.I1.i8.p1.1.1">GraphMixer</span> <cite class="ltx_cite ltx_citemacro_citep">(Cong et al. <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib3" title="">2022</a>)</cite>
introduces a novel architecture that leverages MLP-mixer to learn link-encoder and node encoder for evolving graphs in continuous time.</p>
</div>
</li>
<li class="ltx_item" id="A2.I1.i9" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I1.i9.p1">
<p class="ltx_p" id="A2.I1.i9.p1.1"><span class="ltx_text ltx_font_bold" id="A2.I1.i9.p1.1.1">SimpleDyG</span> <cite class="ltx_cite ltx_citemacro_citep">(Wu, Fang, and Liao <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib29" title="">2024</a>)</cite> reformulated the dynamic graph modeling as a sequence modeling task and mapped the dynamic interactions of target nodes as sequences with specially designed tokens. It simplifies dynamic graph modeling without complex architectural changes to effectively capture temporal dynamics.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_appendix" id="A3">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>More Experimental Results </h2>
<div class="ltx_para" id="A3.p1">
<p class="ltx_p" id="A3.p1.1">For the effect of different retrieval methods for generative performance in Sec. 5.3, we report the NDCG@5 score in Table <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#S5.T4" title="Table 4 ‣ Effect of Different Retrieval Methods. ‣ 5.3 Model Analysis ‣ 5 Experiment ‣ Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_tag">4</span></a>. Here we report the remaining metrics in Table <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#A3.T6" title="Table 6 ‣ Appendix C More Experimental Results ‣ Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_tag">6</span></a>. The results show that RAG4DyG performs better than BM25 and Jaccard on Recall@5 and Jaccard metrics, which are consistent with the performance of NDCG@5.</p>
</div>
<figure class="ltx_table" id="A3.T6">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="A3.T6.1" style="width:252.9pt;height:65.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-80.9pt,21.1pt) scale(0.609892224186437,0.609892224186437) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A3.T6.1.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A3.T6.1.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="A3.T6.1.1.1.1.1" rowspan="2" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A3.T6.1.1.1.1.1.1">Method</span></th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="2" id="A3.T6.1.1.1.1.2" style="padding-left:2.0pt;padding-right:2.0pt;">UCI</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="2" id="A3.T6.1.1.1.1.3" style="padding-left:2.0pt;padding-right:2.0pt;">Hepth</td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="A3.T6.1.1.1.1.4" style="padding-left:2.0pt;padding-right:2.0pt;">MMConv</td>
</tr>
<tr class="ltx_tr" id="A3.T6.1.1.2.2">
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T6.1.1.2.2.1" style="padding-left:2.0pt;padding-right:2.0pt;">Recall@5</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A3.T6.1.1.2.2.2" style="padding-left:2.0pt;padding-right:2.0pt;">Jaccard</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T6.1.1.2.2.3" style="padding-left:2.0pt;padding-right:2.0pt;">Recall@5</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A3.T6.1.1.2.2.4" style="padding-left:2.0pt;padding-right:2.0pt;">Jaccard</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T6.1.1.2.2.5" style="padding-left:2.0pt;padding-right:2.0pt;">Recall@5</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="A3.T6.1.1.2.2.6" style="padding-left:2.0pt;padding-right:2.0pt;">Jaccard</td>
</tr>
<tr class="ltx_tr" id="A3.T6.1.1.3.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A3.T6.1.1.3.3.1" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_font_italic" id="A3.T6.1.1.3.3.1.1">BM25</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T6.1.1.3.3.2" style="padding-left:2.0pt;padding-right:2.0pt;">
<span class="ltx_text ltx_font_bold" id="A3.T6.1.1.3.3.2.1">0.111</span>±0.007</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A3.T6.1.1.3.3.3" style="padding-left:2.0pt;padding-right:2.0pt;">0.093±0.004</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T6.1.1.3.3.4" style="padding-left:2.0pt;padding-right:2.0pt;">-</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A3.T6.1.1.3.3.5" style="padding-left:2.0pt;padding-right:2.0pt;">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T6.1.1.3.3.6" style="padding-left:2.0pt;padding-right:2.0pt;">0.193±0.003</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="A3.T6.1.1.3.3.7" style="padding-left:2.0pt;padding-right:2.0pt;">0.192±0.003</td>
</tr>
<tr class="ltx_tr" id="A3.T6.1.1.4.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A3.T6.1.1.4.4.1" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_font_italic" id="A3.T6.1.1.4.4.1.1">Jaccard</span></th>
<td class="ltx_td ltx_align_center" id="A3.T6.1.1.4.4.2" style="padding-left:2.0pt;padding-right:2.0pt;">0.104±0.009</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A3.T6.1.1.4.4.3" style="padding-left:2.0pt;padding-right:2.0pt;">0.088±0.010</td>
<td class="ltx_td ltx_align_center" id="A3.T6.1.1.4.4.4" style="padding-left:2.0pt;padding-right:2.0pt;">-</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A3.T6.1.1.4.4.5" style="padding-left:2.0pt;padding-right:2.0pt;">-</td>
<td class="ltx_td ltx_align_center" id="A3.T6.1.1.4.4.6" style="padding-left:2.0pt;padding-right:2.0pt;">0.193±0.004</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A3.T6.1.1.4.4.7" style="padding-left:2.0pt;padding-right:2.0pt;">0.192±0.004</td>
</tr>
<tr class="ltx_tr" id="A3.T6.1.1.5.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A3.T6.1.1.5.5.1" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_font_italic" id="A3.T6.1.1.5.5.1.1">RAG4DyG</span></th>
<td class="ltx_td ltx_align_center" id="A3.T6.1.1.5.5.2" style="padding-left:2.0pt;padding-right:2.0pt;">
<span class="ltx_text ltx_font_bold" id="A3.T6.1.1.5.5.2.1">0.111</span>±0.013</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A3.T6.1.1.5.5.3" style="padding-left:2.0pt;padding-right:2.0pt;">
<span class="ltx_text ltx_font_bold" id="A3.T6.1.1.5.5.3.1">0.097</span>±0.010</td>
<td class="ltx_td ltx_align_center" id="A3.T6.1.1.5.5.4" style="padding-left:2.0pt;padding-right:2.0pt;">
<span class="ltx_text ltx_font_bold" id="A3.T6.1.1.5.5.4.1">0.019</span>±0.002</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A3.T6.1.1.5.5.5" style="padding-left:2.0pt;padding-right:2.0pt;">
<span class="ltx_text ltx_font_bold" id="A3.T6.1.1.5.5.5.1">0.019</span>±0.002</td>
<td class="ltx_td ltx_align_center" id="A3.T6.1.1.5.5.6" style="padding-left:2.0pt;padding-right:2.0pt;">
<span class="ltx_text ltx_font_bold" id="A3.T6.1.1.5.5.6.1">0.194</span>±0.005</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A3.T6.1.1.5.5.7" style="padding-left:2.0pt;padding-right:2.0pt;">
<span class="ltx_text ltx_font_bold" id="A3.T6.1.1.5.5.7.1">0.194</span> ±0.005</td>
</tr>
<tr class="ltx_tr" id="A3.T6.1.1.6.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t" id="A3.T6.1.1.6.6.1" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_font_italic" id="A3.T6.1.1.6.6.1.1">GroundTruth</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="A3.T6.1.1.6.6.2" style="padding-left:2.0pt;padding-right:2.0pt;">0.121±0.010</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="A3.T6.1.1.6.6.3" style="padding-left:2.0pt;padding-right:2.0pt;">0.107±0.012</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="A3.T6.1.1.6.6.4" style="padding-left:2.0pt;padding-right:2.0pt;">0.028±0.004</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="A3.T6.1.1.6.6.5" style="padding-left:2.0pt;padding-right:2.0pt;">0.028±0.004</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="A3.T6.1.1.6.6.6" style="padding-left:2.0pt;padding-right:2.0pt;">0.210±0.008</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb ltx_border_t" id="A3.T6.1.1.6.6.7" style="padding-left:2.0pt;padding-right:2.0pt;">0.208±0.008</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 6: </span>Generative performance of retrieval methods.</figcaption>
</figure>
<div class="ltx_para" id="A3.p2">
<p class="ltx_p" id="A3.p2.1">For the effect of different fusion strategies in Sec. 5.3, the performance of the remaining metrics is shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#A3.T7" title="Table 7 ‣ Appendix C More Experimental Results ‣ Retrieval Augmented Generation for Dynamic Graph Modeling"><span class="ltx_text ltx_ref_tag">7</span></a>. Similarly, the “GraphFusion” strategy outperforms direct concatenation and “MLP”, indicating the effectiveness of the graph structure among demonstrations.</p>
</div>
<figure class="ltx_table" id="A3.T7">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="A3.T7.1" style="width:252.9pt;height:54.2pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-83.5pt,17.9pt) scale(0.602407755443355,0.602407755443355) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A3.T7.1.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A3.T7.1.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="A3.T7.1.1.1.1.1" rowspan="2" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="A3.T7.1.1.1.1.1.1">Fusion strategy</span></th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="2" id="A3.T7.1.1.1.1.2" style="padding-left:2.0pt;padding-right:2.0pt;">UCI</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="2" id="A3.T7.1.1.1.1.3" style="padding-left:2.0pt;padding-right:2.0pt;">Hepth</td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="A3.T7.1.1.1.1.4" style="padding-left:2.0pt;padding-right:2.0pt;">MMConv</td>
</tr>
<tr class="ltx_tr" id="A3.T7.1.1.2.2">
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T7.1.1.2.2.1" style="padding-left:2.0pt;padding-right:2.0pt;">Recall@5</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A3.T7.1.1.2.2.2" style="padding-left:2.0pt;padding-right:2.0pt;">Jaccard</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T7.1.1.2.2.3" style="padding-left:2.0pt;padding-right:2.0pt;">Recall@5</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A3.T7.1.1.2.2.4" style="padding-left:2.0pt;padding-right:2.0pt;">Jaccard</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T7.1.1.2.2.5" style="padding-left:2.0pt;padding-right:2.0pt;">Recall@5</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="A3.T7.1.1.2.2.6" style="padding-left:2.0pt;padding-right:2.0pt;">Jaccard</td>
</tr>
<tr class="ltx_tr" id="A3.T7.1.1.3.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A3.T7.1.1.3.3.1" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_font_italic" id="A3.T7.1.1.3.3.1.1">Concatenation</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T7.1.1.3.3.2" style="padding-left:2.0pt;padding-right:2.0pt;">0.033±0.019</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A3.T7.1.1.3.3.3" style="padding-left:2.0pt;padding-right:2.0pt;">0.029±0.016</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T7.1.1.3.3.4" style="padding-left:2.0pt;padding-right:2.0pt;">0.001±0.002</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A3.T7.1.1.3.3.5" style="padding-left:2.0pt;padding-right:2.0pt;">0.002±0.002</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T7.1.1.3.3.6" style="padding-left:2.0pt;padding-right:2.0pt;">0.103±0.031</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="A3.T7.1.1.3.3.7" style="padding-left:2.0pt;padding-right:2.0pt;">0.103±0.031</td>
</tr>
<tr class="ltx_tr" id="A3.T7.1.1.4.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A3.T7.1.1.4.4.1" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_font_italic" id="A3.T7.1.1.4.4.1.1">MLP</span></th>
<td class="ltx_td ltx_align_center" id="A3.T7.1.1.4.4.2" style="padding-left:2.0pt;padding-right:2.0pt;">0.102±0.018</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A3.T7.1.1.4.4.3" style="padding-left:2.0pt;padding-right:2.0pt;">0.089±0.016</td>
<td class="ltx_td ltx_align_center" id="A3.T7.1.1.4.4.4" style="padding-left:2.0pt;padding-right:2.0pt;">0.006±0.002</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="A3.T7.1.1.4.4.5" style="padding-left:2.0pt;padding-right:2.0pt;">0.006±0.002</td>
<td class="ltx_td ltx_align_center" id="A3.T7.1.1.4.4.6" style="padding-left:2.0pt;padding-right:2.0pt;">0.156±0.006</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A3.T7.1.1.4.4.7" style="padding-left:2.0pt;padding-right:2.0pt;">0.153±0.006</td>
</tr>
<tr class="ltx_tr" id="A3.T7.1.1.5.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="A3.T7.1.1.5.5.1" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_font_italic" id="A3.T7.1.1.5.5.1.1">GraphFusion</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T7.1.1.5.5.2" style="padding-left:2.0pt;padding-right:2.0pt;">
<span class="ltx_text ltx_font_bold" id="A3.T7.1.1.5.5.2.1">0.111</span>±0.013</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="A3.T7.1.1.5.5.3" style="padding-left:2.0pt;padding-right:2.0pt;">
<span class="ltx_text ltx_font_bold" id="A3.T7.1.1.5.5.3.1">0.097</span>±0.010</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T7.1.1.5.5.4" style="padding-left:2.0pt;padding-right:2.0pt;">
<span class="ltx_text ltx_font_bold" id="A3.T7.1.1.5.5.4.1">0.019</span>±0.002</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="A3.T7.1.1.5.5.5" style="padding-left:2.0pt;padding-right:2.0pt;">
<span class="ltx_text ltx_font_bold" id="A3.T7.1.1.5.5.5.1">0.019</span>±0.002</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T7.1.1.5.5.6" style="padding-left:2.0pt;padding-right:2.0pt;">
<span class="ltx_text ltx_font_bold" id="A3.T7.1.1.5.5.6.1">0.194</span>±0.005</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb" id="A3.T7.1.1.5.5.7" style="padding-left:2.0pt;padding-right:2.0pt;">
<span class="ltx_text ltx_font_bold" id="A3.T7.1.1.5.5.7.1">0.194</span> ±0.005</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 7: </span>Effect of different fusion strategies.</figcaption>
</figure>
</section>
<section class="ltx_appendix" id="A4">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Hyper-parameter Settings</h2>
<div class="ltx_para" id="A4.p1">
<p class="ltx_p" id="A4.p1.1">We run all the experiments on an NVIDIA GPU L40 with the same data splitting and follow the hyper-parameter settings reported in SimpleDyG <cite class="ltx_cite ltx_citemacro_citep">(Wu, Fang, and Liao <a class="ltx_ref" href="https://arxiv.org/html/2408.14523v1#bib.bib29" title="">2024</a>)</cite> for all the baselines. For our RAG4DyG method, we report the hyper-parameters as follows.</p>
</div>
<div class="ltx_para" id="A4.p2">
<p class="ltx_p" id="A4.p2.14">The time decay rate <math alttext="\lambda" class="ltx_Math" display="inline" id="A4.p2.1.m1.1"><semantics id="A4.p2.1.m1.1a"><mi id="A4.p2.1.m1.1.1" xref="A4.p2.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="A4.p2.1.m1.1b"><ci id="A4.p2.1.m1.1.1.cmml" xref="A4.p2.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.p2.1.m1.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="A4.p2.1.m1.1d">italic_λ</annotation></semantics></math> for the retrieval model in Eq. (4) was fine-tuned according to the time granularity of different datasets, with days for the UCI dataset, months for the Hepth dataset, and turns for the MMConv dataset. We explored a range of values <math alttext="\lambda=\{1e-4,1e-3,1e-2,1e-1,1,10,100\}" class="ltx_Math" display="inline" id="A4.p2.2.m2.7"><semantics id="A4.p2.2.m2.7a"><mrow id="A4.p2.2.m2.7.7" xref="A4.p2.2.m2.7.7.cmml"><mi id="A4.p2.2.m2.7.7.6" xref="A4.p2.2.m2.7.7.6.cmml">λ</mi><mo id="A4.p2.2.m2.7.7.5" xref="A4.p2.2.m2.7.7.5.cmml">=</mo><mrow id="A4.p2.2.m2.7.7.4.4" xref="A4.p2.2.m2.7.7.4.5.cmml"><mo id="A4.p2.2.m2.7.7.4.4.5" stretchy="false" xref="A4.p2.2.m2.7.7.4.5.cmml">{</mo><mrow id="A4.p2.2.m2.4.4.1.1.1" xref="A4.p2.2.m2.4.4.1.1.1.cmml"><mrow id="A4.p2.2.m2.4.4.1.1.1.2" xref="A4.p2.2.m2.4.4.1.1.1.2.cmml"><mn id="A4.p2.2.m2.4.4.1.1.1.2.2" xref="A4.p2.2.m2.4.4.1.1.1.2.2.cmml">1</mn><mo id="A4.p2.2.m2.4.4.1.1.1.2.1" xref="A4.p2.2.m2.4.4.1.1.1.2.1.cmml">⁢</mo><mi id="A4.p2.2.m2.4.4.1.1.1.2.3" xref="A4.p2.2.m2.4.4.1.1.1.2.3.cmml">e</mi></mrow><mo id="A4.p2.2.m2.4.4.1.1.1.1" xref="A4.p2.2.m2.4.4.1.1.1.1.cmml">−</mo><mn id="A4.p2.2.m2.4.4.1.1.1.3" xref="A4.p2.2.m2.4.4.1.1.1.3.cmml">4</mn></mrow><mo id="A4.p2.2.m2.7.7.4.4.6" xref="A4.p2.2.m2.7.7.4.5.cmml">,</mo><mrow id="A4.p2.2.m2.5.5.2.2.2" xref="A4.p2.2.m2.5.5.2.2.2.cmml"><mrow id="A4.p2.2.m2.5.5.2.2.2.2" xref="A4.p2.2.m2.5.5.2.2.2.2.cmml"><mn id="A4.p2.2.m2.5.5.2.2.2.2.2" xref="A4.p2.2.m2.5.5.2.2.2.2.2.cmml">1</mn><mo id="A4.p2.2.m2.5.5.2.2.2.2.1" xref="A4.p2.2.m2.5.5.2.2.2.2.1.cmml">⁢</mo><mi id="A4.p2.2.m2.5.5.2.2.2.2.3" xref="A4.p2.2.m2.5.5.2.2.2.2.3.cmml">e</mi></mrow><mo id="A4.p2.2.m2.5.5.2.2.2.1" xref="A4.p2.2.m2.5.5.2.2.2.1.cmml">−</mo><mn id="A4.p2.2.m2.5.5.2.2.2.3" xref="A4.p2.2.m2.5.5.2.2.2.3.cmml">3</mn></mrow><mo id="A4.p2.2.m2.7.7.4.4.7" xref="A4.p2.2.m2.7.7.4.5.cmml">,</mo><mrow id="A4.p2.2.m2.6.6.3.3.3" xref="A4.p2.2.m2.6.6.3.3.3.cmml"><mrow id="A4.p2.2.m2.6.6.3.3.3.2" xref="A4.p2.2.m2.6.6.3.3.3.2.cmml"><mn id="A4.p2.2.m2.6.6.3.3.3.2.2" xref="A4.p2.2.m2.6.6.3.3.3.2.2.cmml">1</mn><mo id="A4.p2.2.m2.6.6.3.3.3.2.1" xref="A4.p2.2.m2.6.6.3.3.3.2.1.cmml">⁢</mo><mi id="A4.p2.2.m2.6.6.3.3.3.2.3" xref="A4.p2.2.m2.6.6.3.3.3.2.3.cmml">e</mi></mrow><mo id="A4.p2.2.m2.6.6.3.3.3.1" xref="A4.p2.2.m2.6.6.3.3.3.1.cmml">−</mo><mn id="A4.p2.2.m2.6.6.3.3.3.3" xref="A4.p2.2.m2.6.6.3.3.3.3.cmml">2</mn></mrow><mo id="A4.p2.2.m2.7.7.4.4.8" xref="A4.p2.2.m2.7.7.4.5.cmml">,</mo><mrow id="A4.p2.2.m2.7.7.4.4.4" xref="A4.p2.2.m2.7.7.4.4.4.cmml"><mrow id="A4.p2.2.m2.7.7.4.4.4.2" xref="A4.p2.2.m2.7.7.4.4.4.2.cmml"><mn id="A4.p2.2.m2.7.7.4.4.4.2.2" xref="A4.p2.2.m2.7.7.4.4.4.2.2.cmml">1</mn><mo id="A4.p2.2.m2.7.7.4.4.4.2.1" xref="A4.p2.2.m2.7.7.4.4.4.2.1.cmml">⁢</mo><mi id="A4.p2.2.m2.7.7.4.4.4.2.3" xref="A4.p2.2.m2.7.7.4.4.4.2.3.cmml">e</mi></mrow><mo id="A4.p2.2.m2.7.7.4.4.4.1" xref="A4.p2.2.m2.7.7.4.4.4.1.cmml">−</mo><mn id="A4.p2.2.m2.7.7.4.4.4.3" xref="A4.p2.2.m2.7.7.4.4.4.3.cmml">1</mn></mrow><mo id="A4.p2.2.m2.7.7.4.4.9" xref="A4.p2.2.m2.7.7.4.5.cmml">,</mo><mn id="A4.p2.2.m2.1.1" xref="A4.p2.2.m2.1.1.cmml">1</mn><mo id="A4.p2.2.m2.7.7.4.4.10" xref="A4.p2.2.m2.7.7.4.5.cmml">,</mo><mn id="A4.p2.2.m2.2.2" xref="A4.p2.2.m2.2.2.cmml">10</mn><mo id="A4.p2.2.m2.7.7.4.4.11" xref="A4.p2.2.m2.7.7.4.5.cmml">,</mo><mn id="A4.p2.2.m2.3.3" xref="A4.p2.2.m2.3.3.cmml">100</mn><mo id="A4.p2.2.m2.7.7.4.4.12" stretchy="false" xref="A4.p2.2.m2.7.7.4.5.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.p2.2.m2.7b"><apply id="A4.p2.2.m2.7.7.cmml" xref="A4.p2.2.m2.7.7"><eq id="A4.p2.2.m2.7.7.5.cmml" xref="A4.p2.2.m2.7.7.5"></eq><ci id="A4.p2.2.m2.7.7.6.cmml" xref="A4.p2.2.m2.7.7.6">𝜆</ci><set id="A4.p2.2.m2.7.7.4.5.cmml" xref="A4.p2.2.m2.7.7.4.4"><apply id="A4.p2.2.m2.4.4.1.1.1.cmml" xref="A4.p2.2.m2.4.4.1.1.1"><minus id="A4.p2.2.m2.4.4.1.1.1.1.cmml" xref="A4.p2.2.m2.4.4.1.1.1.1"></minus><apply id="A4.p2.2.m2.4.4.1.1.1.2.cmml" xref="A4.p2.2.m2.4.4.1.1.1.2"><times id="A4.p2.2.m2.4.4.1.1.1.2.1.cmml" xref="A4.p2.2.m2.4.4.1.1.1.2.1"></times><cn id="A4.p2.2.m2.4.4.1.1.1.2.2.cmml" type="integer" xref="A4.p2.2.m2.4.4.1.1.1.2.2">1</cn><ci id="A4.p2.2.m2.4.4.1.1.1.2.3.cmml" xref="A4.p2.2.m2.4.4.1.1.1.2.3">𝑒</ci></apply><cn id="A4.p2.2.m2.4.4.1.1.1.3.cmml" type="integer" xref="A4.p2.2.m2.4.4.1.1.1.3">4</cn></apply><apply id="A4.p2.2.m2.5.5.2.2.2.cmml" xref="A4.p2.2.m2.5.5.2.2.2"><minus id="A4.p2.2.m2.5.5.2.2.2.1.cmml" xref="A4.p2.2.m2.5.5.2.2.2.1"></minus><apply id="A4.p2.2.m2.5.5.2.2.2.2.cmml" xref="A4.p2.2.m2.5.5.2.2.2.2"><times id="A4.p2.2.m2.5.5.2.2.2.2.1.cmml" xref="A4.p2.2.m2.5.5.2.2.2.2.1"></times><cn id="A4.p2.2.m2.5.5.2.2.2.2.2.cmml" type="integer" xref="A4.p2.2.m2.5.5.2.2.2.2.2">1</cn><ci id="A4.p2.2.m2.5.5.2.2.2.2.3.cmml" xref="A4.p2.2.m2.5.5.2.2.2.2.3">𝑒</ci></apply><cn id="A4.p2.2.m2.5.5.2.2.2.3.cmml" type="integer" xref="A4.p2.2.m2.5.5.2.2.2.3">3</cn></apply><apply id="A4.p2.2.m2.6.6.3.3.3.cmml" xref="A4.p2.2.m2.6.6.3.3.3"><minus id="A4.p2.2.m2.6.6.3.3.3.1.cmml" xref="A4.p2.2.m2.6.6.3.3.3.1"></minus><apply id="A4.p2.2.m2.6.6.3.3.3.2.cmml" xref="A4.p2.2.m2.6.6.3.3.3.2"><times id="A4.p2.2.m2.6.6.3.3.3.2.1.cmml" xref="A4.p2.2.m2.6.6.3.3.3.2.1"></times><cn id="A4.p2.2.m2.6.6.3.3.3.2.2.cmml" type="integer" xref="A4.p2.2.m2.6.6.3.3.3.2.2">1</cn><ci id="A4.p2.2.m2.6.6.3.3.3.2.3.cmml" xref="A4.p2.2.m2.6.6.3.3.3.2.3">𝑒</ci></apply><cn id="A4.p2.2.m2.6.6.3.3.3.3.cmml" type="integer" xref="A4.p2.2.m2.6.6.3.3.3.3">2</cn></apply><apply id="A4.p2.2.m2.7.7.4.4.4.cmml" xref="A4.p2.2.m2.7.7.4.4.4"><minus id="A4.p2.2.m2.7.7.4.4.4.1.cmml" xref="A4.p2.2.m2.7.7.4.4.4.1"></minus><apply id="A4.p2.2.m2.7.7.4.4.4.2.cmml" xref="A4.p2.2.m2.7.7.4.4.4.2"><times id="A4.p2.2.m2.7.7.4.4.4.2.1.cmml" xref="A4.p2.2.m2.7.7.4.4.4.2.1"></times><cn id="A4.p2.2.m2.7.7.4.4.4.2.2.cmml" type="integer" xref="A4.p2.2.m2.7.7.4.4.4.2.2">1</cn><ci id="A4.p2.2.m2.7.7.4.4.4.2.3.cmml" xref="A4.p2.2.m2.7.7.4.4.4.2.3">𝑒</ci></apply><cn id="A4.p2.2.m2.7.7.4.4.4.3.cmml" type="integer" xref="A4.p2.2.m2.7.7.4.4.4.3">1</cn></apply><cn id="A4.p2.2.m2.1.1.cmml" type="integer" xref="A4.p2.2.m2.1.1">1</cn><cn id="A4.p2.2.m2.2.2.cmml" type="integer" xref="A4.p2.2.m2.2.2">10</cn><cn id="A4.p2.2.m2.3.3.cmml" type="integer" xref="A4.p2.2.m2.3.3">100</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p2.2.m2.7c">\lambda=\{1e-4,1e-3,1e-2,1e-1,1,10,100\}</annotation><annotation encoding="application/x-llamapun" id="A4.p2.2.m2.7d">italic_λ = { 1 italic_e - 4 , 1 italic_e - 3 , 1 italic_e - 2 , 1 italic_e - 1 , 1 , 10 , 100 }</annotation></semantics></math>, ultimately selecting <math alttext="\lambda=1e-4" class="ltx_Math" display="inline" id="A4.p2.3.m3.1"><semantics id="A4.p2.3.m3.1a"><mrow id="A4.p2.3.m3.1.1" xref="A4.p2.3.m3.1.1.cmml"><mi id="A4.p2.3.m3.1.1.2" xref="A4.p2.3.m3.1.1.2.cmml">λ</mi><mo id="A4.p2.3.m3.1.1.1" xref="A4.p2.3.m3.1.1.1.cmml">=</mo><mrow id="A4.p2.3.m3.1.1.3" xref="A4.p2.3.m3.1.1.3.cmml"><mrow id="A4.p2.3.m3.1.1.3.2" xref="A4.p2.3.m3.1.1.3.2.cmml"><mn id="A4.p2.3.m3.1.1.3.2.2" xref="A4.p2.3.m3.1.1.3.2.2.cmml">1</mn><mo id="A4.p2.3.m3.1.1.3.2.1" xref="A4.p2.3.m3.1.1.3.2.1.cmml">⁢</mo><mi id="A4.p2.3.m3.1.1.3.2.3" xref="A4.p2.3.m3.1.1.3.2.3.cmml">e</mi></mrow><mo id="A4.p2.3.m3.1.1.3.1" xref="A4.p2.3.m3.1.1.3.1.cmml">−</mo><mn id="A4.p2.3.m3.1.1.3.3" xref="A4.p2.3.m3.1.1.3.3.cmml">4</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.p2.3.m3.1b"><apply id="A4.p2.3.m3.1.1.cmml" xref="A4.p2.3.m3.1.1"><eq id="A4.p2.3.m3.1.1.1.cmml" xref="A4.p2.3.m3.1.1.1"></eq><ci id="A4.p2.3.m3.1.1.2.cmml" xref="A4.p2.3.m3.1.1.2">𝜆</ci><apply id="A4.p2.3.m3.1.1.3.cmml" xref="A4.p2.3.m3.1.1.3"><minus id="A4.p2.3.m3.1.1.3.1.cmml" xref="A4.p2.3.m3.1.1.3.1"></minus><apply id="A4.p2.3.m3.1.1.3.2.cmml" xref="A4.p2.3.m3.1.1.3.2"><times id="A4.p2.3.m3.1.1.3.2.1.cmml" xref="A4.p2.3.m3.1.1.3.2.1"></times><cn id="A4.p2.3.m3.1.1.3.2.2.cmml" type="integer" xref="A4.p2.3.m3.1.1.3.2.2">1</cn><ci id="A4.p2.3.m3.1.1.3.2.3.cmml" xref="A4.p2.3.m3.1.1.3.2.3">𝑒</ci></apply><cn id="A4.p2.3.m3.1.1.3.3.cmml" type="integer" xref="A4.p2.3.m3.1.1.3.3">4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p2.3.m3.1c">\lambda=1e-4</annotation><annotation encoding="application/x-llamapun" id="A4.p2.3.m3.1d">italic_λ = 1 italic_e - 4</annotation></semantics></math> for UCI, <math alttext="\lambda=0.1" class="ltx_Math" display="inline" id="A4.p2.4.m4.1"><semantics id="A4.p2.4.m4.1a"><mrow id="A4.p2.4.m4.1.1" xref="A4.p2.4.m4.1.1.cmml"><mi id="A4.p2.4.m4.1.1.2" xref="A4.p2.4.m4.1.1.2.cmml">λ</mi><mo id="A4.p2.4.m4.1.1.1" xref="A4.p2.4.m4.1.1.1.cmml">=</mo><mn id="A4.p2.4.m4.1.1.3" xref="A4.p2.4.m4.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.p2.4.m4.1b"><apply id="A4.p2.4.m4.1.1.cmml" xref="A4.p2.4.m4.1.1"><eq id="A4.p2.4.m4.1.1.1.cmml" xref="A4.p2.4.m4.1.1.1"></eq><ci id="A4.p2.4.m4.1.1.2.cmml" xref="A4.p2.4.m4.1.1.2">𝜆</ci><cn id="A4.p2.4.m4.1.1.3.cmml" type="float" xref="A4.p2.4.m4.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p2.4.m4.1c">\lambda=0.1</annotation><annotation encoding="application/x-llamapun" id="A4.p2.4.m4.1d">italic_λ = 0.1</annotation></semantics></math> for Hepth, and <math alttext="\lambda=10" class="ltx_Math" display="inline" id="A4.p2.5.m5.1"><semantics id="A4.p2.5.m5.1a"><mrow id="A4.p2.5.m5.1.1" xref="A4.p2.5.m5.1.1.cmml"><mi id="A4.p2.5.m5.1.1.2" xref="A4.p2.5.m5.1.1.2.cmml">λ</mi><mo id="A4.p2.5.m5.1.1.1" xref="A4.p2.5.m5.1.1.1.cmml">=</mo><mn id="A4.p2.5.m5.1.1.3" xref="A4.p2.5.m5.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.p2.5.m5.1b"><apply id="A4.p2.5.m5.1.1.cmml" xref="A4.p2.5.m5.1.1"><eq id="A4.p2.5.m5.1.1.1.cmml" xref="A4.p2.5.m5.1.1.1"></eq><ci id="A4.p2.5.m5.1.1.2.cmml" xref="A4.p2.5.m5.1.1.2">𝜆</ci><cn id="A4.p2.5.m5.1.1.3.cmml" type="integer" xref="A4.p2.5.m5.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p2.5.m5.1c">\lambda=10</annotation><annotation encoding="application/x-llamapun" id="A4.p2.5.m5.1d">italic_λ = 10</annotation></semantics></math> for MMConv. The coefficient <math alttext="\alpha" class="ltx_Math" display="inline" id="A4.p2.6.m6.1"><semantics id="A4.p2.6.m6.1a"><mi id="A4.p2.6.m6.1.1" xref="A4.p2.6.m6.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A4.p2.6.m6.1b"><ci id="A4.p2.6.m6.1.1.cmml" xref="A4.p2.6.m6.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.p2.6.m6.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="A4.p2.6.m6.1d">italic_α</annotation></semantics></math> in the loss function (Eq. (8) was tuned across <math alttext="\{0.2,0.4,0.6,0.8,1\}" class="ltx_Math" display="inline" id="A4.p2.7.m7.5"><semantics id="A4.p2.7.m7.5a"><mrow id="A4.p2.7.m7.5.6.2" xref="A4.p2.7.m7.5.6.1.cmml"><mo id="A4.p2.7.m7.5.6.2.1" stretchy="false" xref="A4.p2.7.m7.5.6.1.cmml">{</mo><mn id="A4.p2.7.m7.1.1" xref="A4.p2.7.m7.1.1.cmml">0.2</mn><mo id="A4.p2.7.m7.5.6.2.2" xref="A4.p2.7.m7.5.6.1.cmml">,</mo><mn id="A4.p2.7.m7.2.2" xref="A4.p2.7.m7.2.2.cmml">0.4</mn><mo id="A4.p2.7.m7.5.6.2.3" xref="A4.p2.7.m7.5.6.1.cmml">,</mo><mn id="A4.p2.7.m7.3.3" xref="A4.p2.7.m7.3.3.cmml">0.6</mn><mo id="A4.p2.7.m7.5.6.2.4" xref="A4.p2.7.m7.5.6.1.cmml">,</mo><mn id="A4.p2.7.m7.4.4" xref="A4.p2.7.m7.4.4.cmml">0.8</mn><mo id="A4.p2.7.m7.5.6.2.5" xref="A4.p2.7.m7.5.6.1.cmml">,</mo><mn id="A4.p2.7.m7.5.5" xref="A4.p2.7.m7.5.5.cmml">1</mn><mo id="A4.p2.7.m7.5.6.2.6" stretchy="false" xref="A4.p2.7.m7.5.6.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.p2.7.m7.5b"><set id="A4.p2.7.m7.5.6.1.cmml" xref="A4.p2.7.m7.5.6.2"><cn id="A4.p2.7.m7.1.1.cmml" type="float" xref="A4.p2.7.m7.1.1">0.2</cn><cn id="A4.p2.7.m7.2.2.cmml" type="float" xref="A4.p2.7.m7.2.2">0.4</cn><cn id="A4.p2.7.m7.3.3.cmml" type="float" xref="A4.p2.7.m7.3.3">0.6</cn><cn id="A4.p2.7.m7.4.4.cmml" type="float" xref="A4.p2.7.m7.4.4">0.8</cn><cn id="A4.p2.7.m7.5.5.cmml" type="integer" xref="A4.p2.7.m7.5.5">1</cn></set></annotation-xml><annotation encoding="application/x-tex" id="A4.p2.7.m7.5c">\{0.2,0.4,0.6,0.8,1\}</annotation><annotation encoding="application/x-llamapun" id="A4.p2.7.m7.5d">{ 0.2 , 0.4 , 0.6 , 0.8 , 1 }</annotation></semantics></math>, resulting in final values of <math alttext="\alpha=1" class="ltx_Math" display="inline" id="A4.p2.8.m8.1"><semantics id="A4.p2.8.m8.1a"><mrow id="A4.p2.8.m8.1.1" xref="A4.p2.8.m8.1.1.cmml"><mi id="A4.p2.8.m8.1.1.2" xref="A4.p2.8.m8.1.1.2.cmml">α</mi><mo id="A4.p2.8.m8.1.1.1" xref="A4.p2.8.m8.1.1.1.cmml">=</mo><mn id="A4.p2.8.m8.1.1.3" xref="A4.p2.8.m8.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.p2.8.m8.1b"><apply id="A4.p2.8.m8.1.1.cmml" xref="A4.p2.8.m8.1.1"><eq id="A4.p2.8.m8.1.1.1.cmml" xref="A4.p2.8.m8.1.1.1"></eq><ci id="A4.p2.8.m8.1.1.2.cmml" xref="A4.p2.8.m8.1.1.2">𝛼</ci><cn id="A4.p2.8.m8.1.1.3.cmml" type="integer" xref="A4.p2.8.m8.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p2.8.m8.1c">\alpha=1</annotation><annotation encoding="application/x-llamapun" id="A4.p2.8.m8.1d">italic_α = 1</annotation></semantics></math> for UCI and MMConv dataset, <math alttext="\alpha=0.4" class="ltx_Math" display="inline" id="A4.p2.9.m9.1"><semantics id="A4.p2.9.m9.1a"><mrow id="A4.p2.9.m9.1.1" xref="A4.p2.9.m9.1.1.cmml"><mi id="A4.p2.9.m9.1.1.2" xref="A4.p2.9.m9.1.1.2.cmml">α</mi><mo id="A4.p2.9.m9.1.1.1" xref="A4.p2.9.m9.1.1.1.cmml">=</mo><mn id="A4.p2.9.m9.1.1.3" xref="A4.p2.9.m9.1.1.3.cmml">0.4</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.p2.9.m9.1b"><apply id="A4.p2.9.m9.1.1.cmml" xref="A4.p2.9.m9.1.1"><eq id="A4.p2.9.m9.1.1.1.cmml" xref="A4.p2.9.m9.1.1.1"></eq><ci id="A4.p2.9.m9.1.1.2.cmml" xref="A4.p2.9.m9.1.1.2">𝛼</ci><cn id="A4.p2.9.m9.1.1.3.cmml" type="float" xref="A4.p2.9.m9.1.1.3">0.4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p2.9.m9.1c">\alpha=0.4</annotation><annotation encoding="application/x-llamapun" id="A4.p2.9.m9.1d">italic_α = 0.4</annotation></semantics></math> for Hepth. Additional parameter settings for the three datasets are as follows: the temperature <math alttext="\tau" class="ltx_Math" display="inline" id="A4.p2.10.m10.1"><semantics id="A4.p2.10.m10.1a"><mi id="A4.p2.10.m10.1.1" xref="A4.p2.10.m10.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="A4.p2.10.m10.1b"><ci id="A4.p2.10.m10.1.1.cmml" xref="A4.p2.10.m10.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.p2.10.m10.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="A4.p2.10.m10.1d">italic_τ</annotation></semantics></math> in the two contrastive learning tasks is set to <math alttext="\tau=\{0.1,0.1,0.1\}" class="ltx_Math" display="inline" id="A4.p2.11.m11.3"><semantics id="A4.p2.11.m11.3a"><mrow id="A4.p2.11.m11.3.4" xref="A4.p2.11.m11.3.4.cmml"><mi id="A4.p2.11.m11.3.4.2" xref="A4.p2.11.m11.3.4.2.cmml">τ</mi><mo id="A4.p2.11.m11.3.4.1" xref="A4.p2.11.m11.3.4.1.cmml">=</mo><mrow id="A4.p2.11.m11.3.4.3.2" xref="A4.p2.11.m11.3.4.3.1.cmml"><mo id="A4.p2.11.m11.3.4.3.2.1" stretchy="false" xref="A4.p2.11.m11.3.4.3.1.cmml">{</mo><mn id="A4.p2.11.m11.1.1" xref="A4.p2.11.m11.1.1.cmml">0.1</mn><mo id="A4.p2.11.m11.3.4.3.2.2" xref="A4.p2.11.m11.3.4.3.1.cmml">,</mo><mn id="A4.p2.11.m11.2.2" xref="A4.p2.11.m11.2.2.cmml">0.1</mn><mo id="A4.p2.11.m11.3.4.3.2.3" xref="A4.p2.11.m11.3.4.3.1.cmml">,</mo><mn id="A4.p2.11.m11.3.3" xref="A4.p2.11.m11.3.3.cmml">0.1</mn><mo id="A4.p2.11.m11.3.4.3.2.4" stretchy="false" xref="A4.p2.11.m11.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.p2.11.m11.3b"><apply id="A4.p2.11.m11.3.4.cmml" xref="A4.p2.11.m11.3.4"><eq id="A4.p2.11.m11.3.4.1.cmml" xref="A4.p2.11.m11.3.4.1"></eq><ci id="A4.p2.11.m11.3.4.2.cmml" xref="A4.p2.11.m11.3.4.2">𝜏</ci><set id="A4.p2.11.m11.3.4.3.1.cmml" xref="A4.p2.11.m11.3.4.3.2"><cn id="A4.p2.11.m11.1.1.cmml" type="float" xref="A4.p2.11.m11.1.1">0.1</cn><cn id="A4.p2.11.m11.2.2.cmml" type="float" xref="A4.p2.11.m11.2.2">0.1</cn><cn id="A4.p2.11.m11.3.3.cmml" type="float" xref="A4.p2.11.m11.3.3">0.1</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p2.11.m11.3c">\tau=\{0.1,0.1,0.1\}</annotation><annotation encoding="application/x-llamapun" id="A4.p2.11.m11.3d">italic_τ = { 0.1 , 0.1 , 0.1 }</annotation></semantics></math>; the batch size of the retriever model is <math alttext="N=\{64,128,128\}" class="ltx_Math" display="inline" id="A4.p2.12.m12.3"><semantics id="A4.p2.12.m12.3a"><mrow id="A4.p2.12.m12.3.4" xref="A4.p2.12.m12.3.4.cmml"><mi id="A4.p2.12.m12.3.4.2" xref="A4.p2.12.m12.3.4.2.cmml">N</mi><mo id="A4.p2.12.m12.3.4.1" xref="A4.p2.12.m12.3.4.1.cmml">=</mo><mrow id="A4.p2.12.m12.3.4.3.2" xref="A4.p2.12.m12.3.4.3.1.cmml"><mo id="A4.p2.12.m12.3.4.3.2.1" stretchy="false" xref="A4.p2.12.m12.3.4.3.1.cmml">{</mo><mn id="A4.p2.12.m12.1.1" xref="A4.p2.12.m12.1.1.cmml">64</mn><mo id="A4.p2.12.m12.3.4.3.2.2" xref="A4.p2.12.m12.3.4.3.1.cmml">,</mo><mn id="A4.p2.12.m12.2.2" xref="A4.p2.12.m12.2.2.cmml">128</mn><mo id="A4.p2.12.m12.3.4.3.2.3" xref="A4.p2.12.m12.3.4.3.1.cmml">,</mo><mn id="A4.p2.12.m12.3.3" xref="A4.p2.12.m12.3.3.cmml">128</mn><mo id="A4.p2.12.m12.3.4.3.2.4" stretchy="false" xref="A4.p2.12.m12.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.p2.12.m12.3b"><apply id="A4.p2.12.m12.3.4.cmml" xref="A4.p2.12.m12.3.4"><eq id="A4.p2.12.m12.3.4.1.cmml" xref="A4.p2.12.m12.3.4.1"></eq><ci id="A4.p2.12.m12.3.4.2.cmml" xref="A4.p2.12.m12.3.4.2">𝑁</ci><set id="A4.p2.12.m12.3.4.3.1.cmml" xref="A4.p2.12.m12.3.4.3.2"><cn id="A4.p2.12.m12.1.1.cmml" type="integer" xref="A4.p2.12.m12.1.1">64</cn><cn id="A4.p2.12.m12.2.2.cmml" type="integer" xref="A4.p2.12.m12.2.2">128</cn><cn id="A4.p2.12.m12.3.3.cmml" type="integer" xref="A4.p2.12.m12.3.3">128</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p2.12.m12.3c">N=\{64,128,128\}</annotation><annotation encoding="application/x-llamapun" id="A4.p2.12.m12.3d">italic_N = { 64 , 128 , 128 }</annotation></semantics></math>; and the masking and cropping portions in context-aware contrastive learning are <math alttext="\{0.8,0.8,0.8\}" class="ltx_Math" display="inline" id="A4.p2.13.m13.3"><semantics id="A4.p2.13.m13.3a"><mrow id="A4.p2.13.m13.3.4.2" xref="A4.p2.13.m13.3.4.1.cmml"><mo id="A4.p2.13.m13.3.4.2.1" stretchy="false" xref="A4.p2.13.m13.3.4.1.cmml">{</mo><mn id="A4.p2.13.m13.1.1" xref="A4.p2.13.m13.1.1.cmml">0.8</mn><mo id="A4.p2.13.m13.3.4.2.2" xref="A4.p2.13.m13.3.4.1.cmml">,</mo><mn id="A4.p2.13.m13.2.2" xref="A4.p2.13.m13.2.2.cmml">0.8</mn><mo id="A4.p2.13.m13.3.4.2.3" xref="A4.p2.13.m13.3.4.1.cmml">,</mo><mn id="A4.p2.13.m13.3.3" xref="A4.p2.13.m13.3.3.cmml">0.8</mn><mo id="A4.p2.13.m13.3.4.2.4" stretchy="false" xref="A4.p2.13.m13.3.4.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.p2.13.m13.3b"><set id="A4.p2.13.m13.3.4.1.cmml" xref="A4.p2.13.m13.3.4.2"><cn id="A4.p2.13.m13.1.1.cmml" type="float" xref="A4.p2.13.m13.1.1">0.8</cn><cn id="A4.p2.13.m13.2.2.cmml" type="float" xref="A4.p2.13.m13.2.2">0.8</cn><cn id="A4.p2.13.m13.3.3.cmml" type="float" xref="A4.p2.13.m13.3.3">0.8</cn></set></annotation-xml><annotation encoding="application/x-tex" id="A4.p2.13.m13.3c">\{0.8,0.8,0.8\}</annotation><annotation encoding="application/x-llamapun" id="A4.p2.13.m13.3d">{ 0.8 , 0.8 , 0.8 }</annotation></semantics></math> and <math alttext="\{0.4,0.6,0.6\}" class="ltx_Math" display="inline" id="A4.p2.14.m14.3"><semantics id="A4.p2.14.m14.3a"><mrow id="A4.p2.14.m14.3.4.2" xref="A4.p2.14.m14.3.4.1.cmml"><mo id="A4.p2.14.m14.3.4.2.1" stretchy="false" xref="A4.p2.14.m14.3.4.1.cmml">{</mo><mn id="A4.p2.14.m14.1.1" xref="A4.p2.14.m14.1.1.cmml">0.4</mn><mo id="A4.p2.14.m14.3.4.2.2" xref="A4.p2.14.m14.3.4.1.cmml">,</mo><mn id="A4.p2.14.m14.2.2" xref="A4.p2.14.m14.2.2.cmml">0.6</mn><mo id="A4.p2.14.m14.3.4.2.3" xref="A4.p2.14.m14.3.4.1.cmml">,</mo><mn id="A4.p2.14.m14.3.3" xref="A4.p2.14.m14.3.3.cmml">0.6</mn><mo id="A4.p2.14.m14.3.4.2.4" stretchy="false" xref="A4.p2.14.m14.3.4.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.p2.14.m14.3b"><set id="A4.p2.14.m14.3.4.1.cmml" xref="A4.p2.14.m14.3.4.2"><cn id="A4.p2.14.m14.1.1.cmml" type="float" xref="A4.p2.14.m14.1.1">0.4</cn><cn id="A4.p2.14.m14.2.2.cmml" type="float" xref="A4.p2.14.m14.2.2">0.6</cn><cn id="A4.p2.14.m14.3.3.cmml" type="float" xref="A4.p2.14.m14.3.3">0.6</cn></set></annotation-xml><annotation encoding="application/x-tex" id="A4.p2.14.m14.3c">\{0.4,0.6,0.6\}</annotation><annotation encoding="application/x-llamapun" id="A4.p2.14.m14.3d">{ 0.4 , 0.6 , 0.6 }</annotation></semantics></math>, respectively.</p>
</div>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Mon Aug 26 09:19:39 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
