<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>UncertaintyRAG: Span-Level Uncertainty Enhanced Long-Context Modeling for Retrieval-Augmented Generation</title>
<!--Generated on Thu Oct  3 17:40:06 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2410.02719v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#S1" title="In UncertaintyRAG: Span-Level Uncertainty Enhanced Long-Context Modeling for Retrieval-Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#S2" title="In UncertaintyRAG: Span-Level Uncertainty Enhanced Long-Context Modeling for Retrieval-Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#S2.SS1" title="In 2 Related Work ‣ UncertaintyRAG: Span-Level Uncertainty Enhanced Long-Context Modeling for Retrieval-Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Attention Mechanisms in Long Contexts</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#S2.SS2" title="In 2 Related Work ‣ UncertaintyRAG: Span-Level Uncertainty Enhanced Long-Context Modeling for Retrieval-Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Position Encoding</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#S2.SS3" title="In 2 Related Work ‣ UncertaintyRAG: Span-Level Uncertainty Enhanced Long-Context Modeling for Retrieval-Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3 </span>Retrieval-Augmented Generation</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#S3" title="In UncertaintyRAG: Span-Level Uncertainty Enhanced Long-Context Modeling for Retrieval-Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Methodology</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#S3.SS1" title="In 3 Methodology ‣ UncertaintyRAG: Span-Level Uncertainty Enhanced Long-Context Modeling for Retrieval-Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Span Uncertainty</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#S3.SS2" title="In 3 Methodology ‣ UncertaintyRAG: Span-Level Uncertainty Enhanced Long-Context Modeling for Retrieval-Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Training Strategy</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#S3.SS2.SSS1" title="In 3.2 Training Strategy ‣ 3 Methodology ‣ UncertaintyRAG: Span-Level Uncertainty Enhanced Long-Context Modeling for Retrieval-Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.1 </span>Construction of Positive and Negative Samples</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#S3.SS2.SSS2" title="In 3.2 Training Strategy ‣ 3 Methodology ‣ UncertaintyRAG: Span-Level Uncertainty Enhanced Long-Context Modeling for Retrieval-Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.2 </span>Data Scaling Strategy</span></a>
<ol class="ltx_toclist ltx_toclist_subsubsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#S3.SS2.SSS2.Px1" title="In 3.2.2 Data Scaling Strategy ‣ 3.2 Training Strategy ‣ 3 Methodology ‣ UncertaintyRAG: Span-Level Uncertainty Enhanced Long-Context Modeling for Retrieval-Augmented Generation"><span class="ltx_text ltx_ref_title">Anchor Sample Scaling Strategy</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#S3.SS2.SSS2.Px2" title="In 3.2.2 Data Scaling Strategy ‣ 3.2 Training Strategy ‣ 3 Methodology ‣ UncertaintyRAG: Span-Level Uncertainty Enhanced Long-Context Modeling for Retrieval-Augmented Generation"><span class="ltx_text ltx_ref_title">Positive and Negative Sample Scaling Strategy</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#S3.SS2.SSS3" title="In 3.2 Training Strategy ‣ 3 Methodology ‣ UncertaintyRAG: Span-Level Uncertainty Enhanced Long-Context Modeling for Retrieval-Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.3 </span>Contrastive Learning</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#S3.SS3" title="In 3 Methodology ‣ UncertaintyRAG: Span-Level Uncertainty Enhanced Long-Context Modeling for Retrieval-Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Model Inference</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#S4" title="In UncertaintyRAG: Span-Level Uncertainty Enhanced Long-Context Modeling for Retrieval-Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experiment</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#S4.SS1" title="In 4 Experiment ‣ UncertaintyRAG: Span-Level Uncertainty Enhanced Long-Context Modeling for Retrieval-Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Main Result</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#S4.SS1.SSS0.Px1" title="In 4.1 Main Result ‣ 4 Experiment ‣ UncertaintyRAG: Span-Level Uncertainty Enhanced Long-Context Modeling for Retrieval-Augmented Generation"><span class="ltx_text ltx_ref_title">Analysis of The Impact of Span Uncertainty through SNR Calibration</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#S4.SS1.SSS0.Px2" title="In 4.1 Main Result ‣ 4 Experiment ‣ UncertaintyRAG: Span-Level Uncertainty Enhanced Long-Context Modeling for Retrieval-Augmented Generation"><span class="ltx_text ltx_ref_title">Ablation Study on The Effects of Scaling Up the Data</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#S4.SS1.SSS0.Px3" title="In 4.1 Main Result ‣ 4 Experiment ‣ UncertaintyRAG: Span-Level Uncertainty Enhanced Long-Context Modeling for Retrieval-Augmented Generation"><span class="ltx_text ltx_ref_title">Ablation Study on Chunk Length and The Number of Chunks</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#S4.SS2" title="In 4 Experiment ‣ UncertaintyRAG: Span-Level Uncertainty Enhanced Long-Context Modeling for Retrieval-Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Representation Analysis</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#S4.SS2.SSS0.Px1" title="In 4.2 Representation Analysis ‣ 4 Experiment ‣ UncertaintyRAG: Span-Level Uncertainty Enhanced Long-Context Modeling for Retrieval-Augmented Generation"><span class="ltx_text ltx_ref_title">Representation Similarity Analysis</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#S4.SS2.SSS0.Px2" title="In 4.2 Representation Analysis ‣ 4 Experiment ‣ UncertaintyRAG: Span-Level Uncertainty Enhanced Long-Context Modeling for Retrieval-Augmented Generation"><span class="ltx_text ltx_ref_title">Representation Property Analysis</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#S4.SS3" title="In 4 Experiment ‣ UncertaintyRAG: Span-Level Uncertainty Enhanced Long-Context Modeling for Retrieval-Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Uncertainty Modeling</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#S4.SS3.SSS0.Px1" title="In 4.3 Uncertainty Modeling ‣ 4 Experiment ‣ UncertaintyRAG: Span-Level Uncertainty Enhanced Long-Context Modeling for Retrieval-Augmented Generation"><span class="ltx_text ltx_ref_title">Comparison of Uncertainty Modeling Approaches</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#S4.SS3.SSS0.Px2" title="In 4.3 Uncertainty Modeling ‣ 4 Experiment ‣ UncertaintyRAG: Span-Level Uncertainty Enhanced Long-Context Modeling for Retrieval-Augmented Generation"><span class="ltx_text ltx_ref_title">Uncertainty Calibration Evaluation</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#S5" title="In UncertaintyRAG: Span-Level Uncertainty Enhanced Long-Context Modeling for Retrieval-Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#A1" title="In UncertaintyRAG: Span-Level Uncertainty Enhanced Long-Context Modeling for Retrieval-Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Training Dataset</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#A2" title="In UncertaintyRAG: Span-Level Uncertainty Enhanced Long-Context Modeling for Retrieval-Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Hyperparameter Settings</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#A3" title="In UncertaintyRAG: Span-Level Uncertainty Enhanced Long-Context Modeling for Retrieval-Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C </span>Baselines</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#A4" title="In UncertaintyRAG: Span-Level Uncertainty Enhanced Long-Context Modeling for Retrieval-Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D </span>Prompt Templates</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#A5" title="In UncertaintyRAG: Span-Level Uncertainty Enhanced Long-Context Modeling for Retrieval-Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">E </span>Analysis of Training Data Utilization and Parameter Efficiency</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#A5.SS0.SSS0.Px1" title="In Appendix E Analysis of Training Data Utilization and Parameter Efficiency ‣ UncertaintyRAG: Span-Level Uncertainty Enhanced Long-Context Modeling for Retrieval-Augmented Generation"><span class="ltx_text ltx_ref_title">Reduced Training Data:</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#A5.SS0.SSS0.Px2" title="In Appendix E Analysis of Training Data Utilization and Parameter Efficiency ‣ UncertaintyRAG: Span-Level Uncertainty Enhanced Long-Context Modeling for Retrieval-Augmented Generation"><span class="ltx_text ltx_ref_title">Compact Parameter Size:</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#A6" title="In UncertaintyRAG: Span-Level Uncertainty Enhanced Long-Context Modeling for Retrieval-Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">F </span>Formulations for Different Approaches to Modeling Uncertainty</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#A7" title="In UncertaintyRAG: Span-Level Uncertainty Enhanced Long-Context Modeling for Retrieval-Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">G </span>Pipeline of Uncertainty Calibration Evaluation</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">UncertaintyRAG: Span-Level Uncertainty Enhanced Long-Context Modeling for Retrieval-Augmented Generation</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
<span class="ltx_text ltx_font_bold" id="id6.6.6">Zixuan Li<sup class="ltx_sup" id="id6.6.6.1"><span class="ltx_text ltx_font_medium" id="id6.6.6.1.1">1</span></sup>, Jing Xiong<sup class="ltx_sup" id="id6.6.6.2"><span class="ltx_text ltx_font_medium" id="id6.6.6.2.1">2</span></sup><span class="ltx_note ltx_role_footnotemark" id="footnotex1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">footnotemark: </span><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_medium" id="footnotex1.1.1.1">1</span></span></span></span></span>, Fanghua Ye<sup class="ltx_sup" id="id6.6.6.3"><span class="ltx_text ltx_font_medium" id="id6.6.6.3.1">3</span></sup>, Chuanyang Zheng<sup class="ltx_sup" id="id6.6.6.4"><span class="ltx_text ltx_font_medium" id="id6.6.6.4.1">4</span></sup>, Jianqiao Lu<sup class="ltx_sup" id="id6.6.6.5"><span class="ltx_text ltx_font_medium" id="id6.6.6.5.1">2</span></sup>, Zhongwei Wan<sup class="ltx_sup" id="id6.6.6.6"><span class="ltx_text ltx_font_medium" id="id6.6.6.6.1">8</span></sup>,</span>
<br class="ltx_break"/><span class="ltx_text ltx_font_bold" id="id12.12.12"> Xun Wu<sup class="ltx_sup" id="id12.12.12.1"><span class="ltx_text ltx_font_medium" id="id12.12.12.1.1">7</span></sup>, Xiaodan Liang<sup class="ltx_sup" id="id12.12.12.2"><span class="ltx_text ltx_font_medium" id="id12.12.12.2.1">1</span></sup>, Chengming Li<sup class="ltx_sup" id="id12.12.12.3"><span class="ltx_text ltx_font_medium" id="id12.12.12.3.1">5</span></sup><span class="ltx_note ltx_role_footnotemark" id="footnotex2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_note_type">footnotemark: </span><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_medium" id="footnotex2.1.1.1">2</span></span></span></span></span>, Zhenan Sun<sup class="ltx_sup" id="id12.12.12.4"><span class="ltx_text ltx_font_medium" id="id12.12.12.4.1">6</span></sup>, Lingpeng Kong<sup class="ltx_sup" id="id12.12.12.5"><span class="ltx_text ltx_font_medium" id="id12.12.12.5.1">2</span></sup>, Ngai Wong<sup class="ltx_sup" id="id12.12.12.6"><span class="ltx_text ltx_font_medium" id="id12.12.12.6.1">2</span></sup>
<br class="ltx_break"/><sup class="ltx_sup" id="id12.12.12.7"><span class="ltx_text ltx_font_medium" id="id12.12.12.7.1">1</span></sup></span>SYSU   
<sup class="ltx_sup" id="id13.13.id1">2</sup>HKU   
<sup class="ltx_sup" id="id14.14.id2">3</sup>UCL   
<sup class="ltx_sup" id="id15.15.id3">4</sup>CUHK   
<sup class="ltx_sup" id="id16.16.id4">5</sup>SMBU   
<sup class="ltx_sup" id="id17.17.id5">6</sup>CAS   
<sup class="ltx_sup" id="id18.18.id6">7</sup>MSRA   
<sup class="ltx_sup" id="id19.19.id7">8</sup>OSU
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id20.20.id8">          lizx76@mail2.sysu.edu.cn, junexiong@connect.hku.hk</span>
</span><span class="ltx_author_notes"><span class="ltx_text ltx_font_bold" id="id21.21.id1">These authors contributed equally.</span><span class="ltx_text ltx_font_bold" id="id22.22.id1">Corresponding author.</span></span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id23.id1">We present <span class="ltx_text ltx_font_italic" id="id23.id1.1">UncertaintyRAG</span>, a novel approach for long-context Retrieval-Augmented Generation (RAG) that utilizes Signal-to-Noise Ratio (SNR)-based span uncertainty to estimate similarity between text chunks. This span uncertainty enhances model calibration, improving robustness and mitigating semantic inconsistencies introduced by random chunking. Leveraging this insight, we propose an efficient unsupervised learning technique to train the retrieval model, alongside an effective data sampling and scaling strategy. <span class="ltx_text ltx_font_italic" id="id23.id1.2">UncertaintyRAG</span> outperforms baselines by 2.03% on LLaMA-2-7B, achieving state-of-the-art results while using only 4% of the training data compared to other advanced open-source retrieval models under distribution shift settings. Our method demonstrates strong calibration through span uncertainty, leading to improved generalization and robustness in long-context RAG tasks. Additionally, <span class="ltx_text ltx_font_italic" id="id23.id1.3">UncertaintyRAG</span> provides a lightweight retrieval model that can be integrated into any large language model with varying context window lengths, without the need for fine-tuning, showcasing the flexibility of our approach.</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para ltx_noindent" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Large Language Models (LLMs) have shown impressive capabilities across various natural language tasks, including long-context question-answering (QA), where the model processes a lengthy text and a question to generate a response <cite class="ltx_cite ltx_citemacro_citep">(Caciularu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib5" title="">2022</a>)</cite>. The QA paradigm encompasses a wide range of tasks, such as commonsense reasoning <cite class="ltx_cite ltx_citemacro_citep">(Yang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib80" title="">2018</a>; Geva et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib21" title="">2021</a>)</cite> and mathematical reasoning <cite class="ltx_cite ltx_citemacro_citep">(Cobbe et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib11" title="">2021</a>; Amini et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib2" title="">2019</a>)</cite>. However, due to the limitations in computational resources and the model’s lack of ability to extrapolate context length, handling long-context settings remains a challenge for large language models, although continuous improvements are being made in this area.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Recent advances seek to overcome this limitation by designing linear attention mechanisms <cite class="ltx_cite ltx_citemacro_citep">(Katharopoulos et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib33" title="">2020</a>; Wang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib70" title="">2020</a>; Gu &amp; Dao, <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib22" title="">2023</a>)</cite>, which improve the memory and time efficiency for long sequences. Pruning the KV cache <cite class="ltx_cite ltx_citemacro_citep">(Ge et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib20" title="">2023</a>; Zhang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib82" title="">2024</a>; Agarwal et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib1" title="">2024</a>)</cite> and quantizing the KV cache <cite class="ltx_cite ltx_citemacro_citep">(Hooper et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib26" title="">2024</a>; Liu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib52" title="">2024</a>)</cite> are other approaches to enhancing long context generation by compressing the model’s KV-cache, providing a training-free, lightweight solution to reduce memory and computational overhead. However, these methods are generally difficult to achieve context length extrapolation. Moreover, the aforementioned approaches usually truncate the long-context to just fit the context window of LLMs, which not only prevents LLMs from actually seeing the entire input text but also faces an unacceptable memory overhead in resource-constrained environments. The efficient positional encoding strategy <cite class="ltx_cite ltx_citemacro_citep">(Liu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib50" title="">2023a</a>; Su et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib67" title="">2024</a>)</cite> is a solution that can achieve length extrapolation, but it often requires training the entire LLMs.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Another lightweight solution for handling long contexts is to utilize long-context Retrieval-Augmented Generation (RAG) for long-context chunking <cite class="ltx_cite ltx_citemacro_citep">(Xu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib77" title="">2023b</a>; Jiang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib30" title="">2024b</a>; Sarthi et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib65" title="">2024</a>; Xu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib76" title="">2023a</a>)</cite>, which avoids the need for LLMs to have length extrapolation capability. Long-context retrieval-augmented generation refers to a method in natural language processing where a model retrieves relevant information from large external sources to assist in generating responses. It extends the traditional RAG by handling much longer input contexts, enabling effective processing of broader and more detailed information for tasks like question answering, summarization, and document understanding. Typically, RAG employs existing LLMs with limited context windows to retrieve relevant chunks, either with or without semantic truncation <cite class="ltx_cite ltx_citemacro_citep">(Sarthi et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib65" title="">2024</a>; Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib41" title="">2024a</a>; Jiang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib30" title="">2024b</a>; Xu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib77" title="">2023b</a>; <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib76" title="">a</a>)</cite>. Retrieval models <cite class="ltx_cite ltx_citemacro_citep">(Izacard et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib28" title="">2021</a>; Xiao et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib74" title="">2023b</a>; Chen et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib6" title="">2024</a>; Lin et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib47" title="">2023a</a>)</cite> are commonly used for this purpose; however, they require a large amount of high-quality labeled data for training, which limits their scalability and adaptability. Modern RAG systems rely on complex chunking methods <cite class="ltx_cite ltx_citemacro_citep">(Sarthi et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib65" title="">2024</a>)</cite> and require LLMs to have relatively long context windows <cite class="ltx_cite ltx_citemacro_citep">(Jiang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib30" title="">2024b</a>; Xu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib78" title="">2024</a>)</cite>. Furthermore, the lack of labeled data to determine if (query, chunk) pairs are related <cite class="ltx_cite ltx_citemacro_citep">(Lewis et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib39" title="">2020a</a>; <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib40" title="">b</a>)</cite> poses significant limitations for training retrieval models in RAG systems. Recent research combines RAG with long-context LLMs to handle extended contexts and mitigate semantic incoherence in chunk processing <cite class="ltx_cite ltx_citemacro_citep">(Xu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib77" title="">2023b</a>; Jiang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib30" title="">2024b</a>; Xu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib78" title="">2024</a>; Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib46" title="">2024c</a>; Luo et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib53" title="">2024</a>; Sarthi et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib65" title="">2024</a>; Duarte et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib19" title="">2024</a>)</cite>. Some of the latest work also attempts to inject retrieval capabilities into LLMs through training, enabling them to process and generate long contexts directly <cite class="ltx_cite ltx_citemacro_citep">(He et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib24" title="">2024</a>; Cheng et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib8" title="">2024</a>)</cite>. However, these approaches often require either sophisticated chunking strategies, which are time-consuming during inference, or fine-tuning adapters for specific LLMs to manage chunk representation compression. Additionally, the complexity of these methods makes them vulnerable to distribution shifts. Some methods also necessitate training an LLM with an extended context window or new architecture, which is highly resource-intensive. In contrast, improving a lightweight retrieval model that can be seamlessly integrated into various LLMs without additional training would be a more efficient solution.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">Unlike previous work, our focus is on utilizing calibrated uncertainty quantification to estimate similarity between chunks, thereby training robust retrieval models within RAG. Specifically, we introduce a novel uncertainty estimation technique based on the Signal-to-Noise Ratio (SNR), which stabilizes predictions and reduces biases from random chunk splitting. Our analysis shows that when two chunks are concatenated and fed into the model to estimate similarity, the uncertainty measured by SNR can better reflect their alignment in the semantic space, which we have confirmed in our experiments. Building on this finding, we develop an unsupervised learning technique to train chunk embeddings. This method is decoupled from the long-context modeling capabilities of LLMs and can be adapted to any fixed-length context window, enhancing retrieval robustness without requiring additional fine-tuning or retraining of the LLM itself. By leveraging the LLM’s calibrated self-information, we effectively measure similarity between text chunks, construct accurate positive and negative samples, and train a robust retrieval model. This approach enhances generalization under distribution shifts in long-context retrieval-augmented generation tasks. Moreover, it seamlessly integrates with existing methods by relying solely on external retrieval models, thus avoiding LLM-specific performance dependencies. Specifically, our contributions are as follows:</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p5">
<ol class="ltx_enumerate" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We propose a novel SNR uncertainty measurement technique to achieve better calibration by addressing prediction errors arising from random chunk splitting, thereby improving performance in similarity estimation between chunks.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para ltx_noindent" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">We propose an unsupervised learning approach and train a retrieval model that outperforms strong open-source embedding models in long-context RAG tasks under distribution-shift settings.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para ltx_noindent" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">We design an efficient data sampling strategy to scale data, enhancing our retrieval model training and significantly boosting performance. Compared to models such as BGE-M3, our method improves LLaMA-2-7B by 2.03% after SNR calibration while using only 4% of their data size.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">4.</span>
<div class="ltx_para ltx_noindent" id="S1.I1.i4.p1">
<p class="ltx_p" id="S1.I1.i4.p1.1">We provide an in-depth analysis of the retrieval model, demonstrating continuous improvements across two key metrics.
We explain how uncertainty measurement enhances chunk representation modeling and why data sample scaling contributes to improved performance.</p>
</div>
</li>
</ol>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Attention Mechanisms in Long Contexts</h3>
<div class="ltx_para ltx_noindent" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.4">An effective approach to facilitating long context is to avoid the <math alttext="O(n^{2})" class="ltx_Math" display="inline" id="S2.SS1.p1.1.m1.1"><semantics id="S2.SS1.p1.1.m1.1a"><mrow id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml"><mi id="S2.SS1.p1.1.m1.1.1.3" xref="S2.SS1.p1.1.m1.1.1.3.cmml">O</mi><mo id="S2.SS1.p1.1.m1.1.1.2" xref="S2.SS1.p1.1.m1.1.1.2.cmml">⁢</mo><mrow id="S2.SS1.p1.1.m1.1.1.1.1" xref="S2.SS1.p1.1.m1.1.1.1.1.1.cmml"><mo id="S2.SS1.p1.1.m1.1.1.1.1.2" stretchy="false" xref="S2.SS1.p1.1.m1.1.1.1.1.1.cmml">(</mo><msup id="S2.SS1.p1.1.m1.1.1.1.1.1" xref="S2.SS1.p1.1.m1.1.1.1.1.1.cmml"><mi id="S2.SS1.p1.1.m1.1.1.1.1.1.2" xref="S2.SS1.p1.1.m1.1.1.1.1.1.2.cmml">n</mi><mn id="S2.SS1.p1.1.m1.1.1.1.1.1.3" xref="S2.SS1.p1.1.m1.1.1.1.1.1.3.cmml">2</mn></msup><mo id="S2.SS1.p1.1.m1.1.1.1.1.3" stretchy="false" xref="S2.SS1.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><apply id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1"><times id="S2.SS1.p1.1.m1.1.1.2.cmml" xref="S2.SS1.p1.1.m1.1.1.2"></times><ci id="S2.SS1.p1.1.m1.1.1.3.cmml" xref="S2.SS1.p1.1.m1.1.1.3">𝑂</ci><apply id="S2.SS1.p1.1.m1.1.1.1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.1.m1.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1.1.1">superscript</csymbol><ci id="S2.SS1.p1.1.m1.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.1.m1.1.1.1.1.1.2">𝑛</ci><cn id="S2.SS1.p1.1.m1.1.1.1.1.1.3.cmml" type="integer" xref="S2.SS1.p1.1.m1.1.1.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">O(n^{2})</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.1.m1.1d">italic_O ( italic_n start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math> computational complexity of the standard attention mechanism by designing linear attention mechanisms, sparse attention mechanisms, or low-rank attention mechanisms. These works can be categorized into the following four types: <span class="ltx_text ltx_font_italic" id="S2.SS1.p1.4.1">i)</span> Sparse Attention Mechanisms: Reduce the computational burden of attention by exploiting inherent patterns within the attention mechanism <cite class="ltx_cite ltx_citemacro_citep">(Jiang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib29" title="">2024a</a>; Ribar et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib62" title="">2023</a>; Chen et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib7" title="">2023</a>)</cite>, or alternatively, by pruning the KV cache <cite class="ltx_cite ltx_citemacro_citep">(Liu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib51" title="">2023b</a>; Xiao et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib73" title="">2023a</a>; Pang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib56" title="">2024</a>; Zhang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib82" title="">2024</a>)</cite>. <span class="ltx_text ltx_font_italic" id="S2.SS1.p1.4.2">ii)</span> The attention mechanism with linear complexity: This typically involves transforming models with <math alttext="O(n^{2})" class="ltx_Math" display="inline" id="S2.SS1.p1.2.m2.1"><semantics id="S2.SS1.p1.2.m2.1a"><mrow id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml"><mi id="S2.SS1.p1.2.m2.1.1.3" xref="S2.SS1.p1.2.m2.1.1.3.cmml">O</mi><mo id="S2.SS1.p1.2.m2.1.1.2" xref="S2.SS1.p1.2.m2.1.1.2.cmml">⁢</mo><mrow id="S2.SS1.p1.2.m2.1.1.1.1" xref="S2.SS1.p1.2.m2.1.1.1.1.1.cmml"><mo id="S2.SS1.p1.2.m2.1.1.1.1.2" stretchy="false" xref="S2.SS1.p1.2.m2.1.1.1.1.1.cmml">(</mo><msup id="S2.SS1.p1.2.m2.1.1.1.1.1" xref="S2.SS1.p1.2.m2.1.1.1.1.1.cmml"><mi id="S2.SS1.p1.2.m2.1.1.1.1.1.2" xref="S2.SS1.p1.2.m2.1.1.1.1.1.2.cmml">n</mi><mn id="S2.SS1.p1.2.m2.1.1.1.1.1.3" xref="S2.SS1.p1.2.m2.1.1.1.1.1.3.cmml">2</mn></msup><mo id="S2.SS1.p1.2.m2.1.1.1.1.3" stretchy="false" xref="S2.SS1.p1.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.1b"><apply id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1"><times id="S2.SS1.p1.2.m2.1.1.2.cmml" xref="S2.SS1.p1.2.m2.1.1.2"></times><ci id="S2.SS1.p1.2.m2.1.1.3.cmml" xref="S2.SS1.p1.2.m2.1.1.3">𝑂</ci><apply id="S2.SS1.p1.2.m2.1.1.1.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1">superscript</csymbol><ci id="S2.SS1.p1.2.m2.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.1.2">𝑛</ci><cn id="S2.SS1.p1.2.m2.1.1.1.1.1.3.cmml" type="integer" xref="S2.SS1.p1.2.m2.1.1.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.1c">O(n^{2})</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.2.m2.1d">italic_O ( italic_n start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math> complexity into <math alttext="O(n)" class="ltx_Math" display="inline" id="S2.SS1.p1.3.m3.1"><semantics id="S2.SS1.p1.3.m3.1a"><mrow id="S2.SS1.p1.3.m3.1.2" xref="S2.SS1.p1.3.m3.1.2.cmml"><mi id="S2.SS1.p1.3.m3.1.2.2" xref="S2.SS1.p1.3.m3.1.2.2.cmml">O</mi><mo id="S2.SS1.p1.3.m3.1.2.1" xref="S2.SS1.p1.3.m3.1.2.1.cmml">⁢</mo><mrow id="S2.SS1.p1.3.m3.1.2.3.2" xref="S2.SS1.p1.3.m3.1.2.cmml"><mo id="S2.SS1.p1.3.m3.1.2.3.2.1" stretchy="false" xref="S2.SS1.p1.3.m3.1.2.cmml">(</mo><mi id="S2.SS1.p1.3.m3.1.1" xref="S2.SS1.p1.3.m3.1.1.cmml">n</mi><mo id="S2.SS1.p1.3.m3.1.2.3.2.2" stretchy="false" xref="S2.SS1.p1.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.1b"><apply id="S2.SS1.p1.3.m3.1.2.cmml" xref="S2.SS1.p1.3.m3.1.2"><times id="S2.SS1.p1.3.m3.1.2.1.cmml" xref="S2.SS1.p1.3.m3.1.2.1"></times><ci id="S2.SS1.p1.3.m3.1.2.2.cmml" xref="S2.SS1.p1.3.m3.1.2.2">𝑂</ci><ci id="S2.SS1.p1.3.m3.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.1c">O(n)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.3.m3.1d">italic_O ( italic_n )</annotation></semantics></math> or <math alttext="O(n\log n)" class="ltx_Math" display="inline" id="S2.SS1.p1.4.m4.1"><semantics id="S2.SS1.p1.4.m4.1a"><mrow id="S2.SS1.p1.4.m4.1.1" xref="S2.SS1.p1.4.m4.1.1.cmml"><mi id="S2.SS1.p1.4.m4.1.1.3" xref="S2.SS1.p1.4.m4.1.1.3.cmml">O</mi><mo id="S2.SS1.p1.4.m4.1.1.2" xref="S2.SS1.p1.4.m4.1.1.2.cmml">⁢</mo><mrow id="S2.SS1.p1.4.m4.1.1.1.1" xref="S2.SS1.p1.4.m4.1.1.1.1.1.cmml"><mo id="S2.SS1.p1.4.m4.1.1.1.1.2" stretchy="false" xref="S2.SS1.p1.4.m4.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.p1.4.m4.1.1.1.1.1" xref="S2.SS1.p1.4.m4.1.1.1.1.1.cmml"><mi id="S2.SS1.p1.4.m4.1.1.1.1.1.2" xref="S2.SS1.p1.4.m4.1.1.1.1.1.2.cmml">n</mi><mo id="S2.SS1.p1.4.m4.1.1.1.1.1.1" lspace="0.167em" xref="S2.SS1.p1.4.m4.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S2.SS1.p1.4.m4.1.1.1.1.1.3" xref="S2.SS1.p1.4.m4.1.1.1.1.1.3.cmml"><mi id="S2.SS1.p1.4.m4.1.1.1.1.1.3.1" xref="S2.SS1.p1.4.m4.1.1.1.1.1.3.1.cmml">log</mi><mo id="S2.SS1.p1.4.m4.1.1.1.1.1.3a" lspace="0.167em" xref="S2.SS1.p1.4.m4.1.1.1.1.1.3.cmml">⁡</mo><mi id="S2.SS1.p1.4.m4.1.1.1.1.1.3.2" xref="S2.SS1.p1.4.m4.1.1.1.1.1.3.2.cmml">n</mi></mrow></mrow><mo id="S2.SS1.p1.4.m4.1.1.1.1.3" stretchy="false" xref="S2.SS1.p1.4.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m4.1b"><apply id="S2.SS1.p1.4.m4.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1"><times id="S2.SS1.p1.4.m4.1.1.2.cmml" xref="S2.SS1.p1.4.m4.1.1.2"></times><ci id="S2.SS1.p1.4.m4.1.1.3.cmml" xref="S2.SS1.p1.4.m4.1.1.3">𝑂</ci><apply id="S2.SS1.p1.4.m4.1.1.1.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1.1.1"><times id="S2.SS1.p1.4.m4.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1.1.1.1.1"></times><ci id="S2.SS1.p1.4.m4.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.4.m4.1.1.1.1.1.2">𝑛</ci><apply id="S2.SS1.p1.4.m4.1.1.1.1.1.3.cmml" xref="S2.SS1.p1.4.m4.1.1.1.1.1.3"><log id="S2.SS1.p1.4.m4.1.1.1.1.1.3.1.cmml" xref="S2.SS1.p1.4.m4.1.1.1.1.1.3.1"></log><ci id="S2.SS1.p1.4.m4.1.1.1.1.1.3.2.cmml" xref="S2.SS1.p1.4.m4.1.1.1.1.1.3.2">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m4.1c">O(n\log n)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.4.m4.1d">italic_O ( italic_n roman_log italic_n )</annotation></semantics></math> linear attention <cite class="ltx_cite ltx_citemacro_citep">(Zheng et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib83" title="">2022</a>; Kitaev et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib35" title="">2020</a>; Qin et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib61" title="">2022</a>; Katharopoulos et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib33" title="">2020</a>)</cite>, or efficient long-sequence recurrent neural networks <cite class="ltx_cite ltx_citemacro_citep">(Gu &amp; Dao, <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib22" title="">2023</a>; Dao &amp; Gu, <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib14" title="">2024</a>; Peng et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib57" title="">2023a</a>; Yang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib79" title="">2023</a>)</cite>. <span class="ltx_text ltx_font_italic" id="S2.SS1.p1.4.3">iii)</span> Memory-augmented attention mechanisms: This typically involves encoding long-context text using additional memory blocks <cite class="ltx_cite ltx_citemacro_citep">(He et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib24" title="">2024</a>; Bertsch et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib4" title="">2024</a>; Wang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib72" title="">2024</a>)</cite>. <span class="ltx_text ltx_font_italic" id="S2.SS1.p1.4.4">iv)</span> Hardware-friendly attention mechanisms: FlashAttention <cite class="ltx_cite ltx_citemacro_citep">(Dao et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib15" title="">2022</a>; Dao, <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib13" title="">2023</a>; Shah et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib66" title="">2024</a>)</cite> accelerates precise attention computations by optimizing reads and writes across different levels of GPU memory. FlashAttention is especially effective for processing longer sequences. Among previous works, memory-augmented LLMs are most relevant to this study, as they involve memory retrieval. However, they typically require modifying the original model architecture and retraining the LLM or fine-tuning some parameters, which can be an impractical overhead in certain settings.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Position Encoding</h3>
<div class="ltx_para ltx_noindent" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">Extending the context window from scratch is challenging <cite class="ltx_cite ltx_citemacro_citep">(Liu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib50" title="">2023a</a>; Su et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib67" title="">2024</a>)</cite> because it requires significant computational resources. As a result, efficient position encoding methods <cite class="ltx_cite ltx_citemacro_citep">(Peng et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib59" title="">2023b</a>; Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib43" title="">2023a</a>; Chi et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib9" title="">2022</a>; Press et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib60" title="">2021</a>; Peng &amp; Quesnelle, <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib58" title="">2023</a>)</cite> have gained attention for improving length extrapolation. These works attempt to expand the context window on pre-trained LLMs using a small amount of data.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS2.p2">
<p class="ltx_p" id="S2.SS2.p2.1">However, considering that many LLMs are closed-source, fine-tuning these models specifically for a retrieval model is impractical. Additionally, fully fine-tuning LLMs on long-context data remains costly. Fully fine-tuning models such as LLaMA <cite class="ltx_cite ltx_citemacro_citep">(Touvron et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib68" title="">2023</a>)</cite>, especially with sequences longer than 16,000 tokens, is prohibitively expensive due to the quadratic time and memory complexities associated with precise attention mechanisms. Therefore, extending the model’s context window by continual training through position encoding remains unacceptable.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS2.p3">
<p class="ltx_p" id="S2.SS2.p3.1">Recent RAG systems <cite class="ltx_cite ltx_citemacro_citep">(Xu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib77" title="">2023b</a>; <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib78" title="">2024</a>)</cite> combining RAG with long context LLMs have utilized position encoding to fine-tune LLMs for context window extrapolation, either requiring LLMs to handle retrieved chunks as long-context inputs <cite class="ltx_cite ltx_citemacro_citep">(Jiang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib30" title="">2024b</a>; Xu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib78" title="">2024</a>)</cite> or flexibly combining the strengths of both through a routing mechanism <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib46" title="">2024c</a>)</cite>. These works consider combining the strengths of long context LLMs and RAG. They demonstrate that, when resources are abundant, long context LLMs consistently outperform RAG in terms of average performance. However, the significantly reduced cost of RAG remains a notable advantage. They also find that long-context window LLMs can effectively alleviate the context fragmentation issue in RAG. However, further extending the context window of LLMs still is challenging, as it requires a significant amount of computational resources. Therefore, how to expand the boundaries of RAG systems given the limited context window of LLMs remains a question worth exploring. Our work primarily focuses on optimizing the retrieval model in RAG, given the context window length of LLMs, to extend the boundaries of the RAG system’s ability to handle long contexts.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Retrieval-Augmented Generation</h3>
<div class="ltx_para ltx_noindent" id="S2.SS3.p1">
<p class="ltx_p" id="S2.SS3.p1.1">The existing RAG frameworks heavily rely on the quality of the retrieval model. Due to retrieval model’s context window limitations, they often tend to use short retrieval units in open-domain QA tasks <cite class="ltx_cite ltx_citemacro_citep">(Lewis et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib39" title="">2020a</a>; Karpukhin et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib32" title="">2020</a>; Ni et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib54" title="">2021</a>)</cite>. These models rely on a bi-encoder and typically require manual query-passage annotations for training the encoder.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS3.p2">
<p class="ltx_p" id="S2.SS3.p2.1">Moreover, some studies <cite class="ltx_cite ltx_citemacro_citep">(Duarte et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib19" title="">2024</a>; Luo et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib53" title="">2024</a>; Sarthi et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib65" title="">2024</a>; Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib45" title="">2023b</a>)</cite> highlight the importance of appropriately chunking the input text for RAG systems. Complex chunking schemes, however, add inference complexity and increase latency. Therefore, a simpler chunking method is necessary to avoid this issue, ensuring robustness to different chunking. Existing methods <cite class="ltx_cite ltx_citemacro_citep">(Jiang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib30" title="">2024b</a>; Xu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib78" title="">2024</a>)</cite> attempt to use LLMs capable of handling longer contexts to increase the length of retrieved chunks, thereby reducing the number of retrieval units and avoiding the input of overly fragmented and incomplete information. This, in turn, alleviates the burden on the retrieval model in processing long contexts. Recently, a study <cite class="ltx_cite ltx_citemacro_citep">(Luo et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib53" title="">2024</a>)</cite> also proposes a three-stage fine-tuning approach to embed longer contexts into a special token, addressing the issue of semantic discontinuity caused by chunk splitting. However, their method requires complex training techniques for the retrieval model, making it difficult to easily scale the data size.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS3.p3">
<p class="ltx_p" id="S2.SS3.p3.1">Distribution shift in RAG has also garnered attention <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib42" title="">2024b</a>; Sagirova &amp; Burtsev, <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib64" title="">2023</a>)</cite>. They use a calibrated model’s confidence to detect "long-tailness" examples and implement an improved RAG pipeline. However, to address distribution shifts in the chunks of input, instance-level uncertainty estimation provides limited assistance to RAG, as it does not help LLMs retrieve long-tail knowledge. Additionally, their work focuses solely on improving the pipeline without enhancing the performance of the retrieval model itself.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS3.p4">
<p class="ltx_p" id="S2.SS3.p4.1">In summary, the above work has the following issues: <span class="ltx_text ltx_font_italic" id="S2.SS3.p4.1.1">i)</span> <span class="ltx_text ltx_font_bold" id="S2.SS3.p4.1.2">Complex Chunking Overhead</span>: Complex chunking methods that may increase additional computational overhead during inference. <span class="ltx_text ltx_font_italic" id="S2.SS3.p4.1.3">ii)</span> <span class="ltx_text ltx_font_bold" id="S2.SS3.p4.1.4">High Cost of Labeled Data</span>: Requires labeled data between chunks and queries. This is usually costly in terms of extensive manual annotation effort for long-context retrieval tasks. <span class="ltx_text ltx_font_italic" id="S2.SS3.p4.1.5">iii)</span> <span class="ltx_text ltx_font_bold" id="S2.SS3.p4.1.6">Poor Handling of Semantic Incoherence</span>: Open-source embedding models often struggle to handle semantically incoherent chunks, making it difficult to generalize in long-context settings.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS3.p5">
<p class="ltx_p" id="S2.SS3.p5.1">To address the aforementioned issues, we focus on facilitating representation learning in RAG under a simple long-context chunking setting. Considering the additional overhead introduced by complex chunking methods during the inference stage, we adopt a simple strategy of dividing chunks every 300 words and develop an unsupervised learning technique to train a robust retrieval model capable of handling semantic discontinuities in this chunking approach under distribution shift scenarios. Additionally, we propose a method called span uncertainty measurement to construct training labels for the data and compare it with existing open-source embedding models <cite class="ltx_cite ltx_citemacro_citep">(Izacard et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib28" title="">2021</a>; Xiao et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib74" title="">2023b</a>; Chen et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib6" title="">2024</a>; Lin et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib47" title="">2023a</a>)</cite> within the RAG system. Typically, these embedding models require extensive data for pre-training; however, we outperform them in distribution shift scenarios using far less training data than they require.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Methodology</h2>
<figure class="ltx_figure ltx_align_floatright" id="S3.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="191" id="S3.F1.g1" src="x1.png" width="403"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Each line in the figure represents the trend of SNR variation for different samples, where two chunks are concatenated and input into the LLM for uncertainty estimation. The SNR is calculated as a sliding window moves across the concatenated input. Notably, the SNR values exhibit a significant drop early on, even before reaching the end of the first chunk.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">In this section, we introduce a span uncertainty method based on SNR to obtain confidence scores between chunks. We then use these confidence scores to construct positive and negative samples for training our retrieval models. This process typically does not involve using query data for training, so we further develop two methods to scale chunk data to enhance the model’s distribution shift generalization ability. Additionally, we provide insights into the effectiveness of these methods in the experimental section.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Span Uncertainty</h3>
<figure class="ltx_figure" id="S3.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="324" id="S3.F2.g1" src="extracted/5899423/ICLR_2025_Template/figure/figure.png" width="509"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Scaling and Trainning. The figure presents the details of scaling and training.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.6">Recently, there has been widespread attention <cite class="ltx_cite ltx_citemacro_citep">(Xiong et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib75" title="">2023</a>; Ye et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib81" title="">2024</a>)</cite> to the measurement of uncertainty in LLMs. <cite class="ltx_cite ltx_citemacro_cite">Kuhn et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib37" title="">2023</a>)</cite> leverage the natural language inference task to infer semantic entropy to calibrate the model’s uncertainty. <cite class="ltx_cite ltx_citemacro_cite">Gupta et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib23" title="">2024</a>); Duan et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib18" title="">2024</a>)</cite> adopt token-level uncertainty to achieve more fine-grained calibration. <cite class="ltx_cite ltx_citemacro_cite">Lin et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib48" title="">2023b</a>)</cite> measure the semantic equivalence of LLM responses based on model output probabilities, converting similarities into uncertainty measures. Inspired by these works, we input two chunks into LLMs, using the self-information of the model’s output as a measure of uncertainty. To achieve better calibration, we draw inspiration from the sample gradient SNR statistic used to estimate generalization errors in <cite class="ltx_cite ltx_citemacro_cite">Liu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib49" title="">2020</a>)</cite>. We leverage this statistic to quantify uncertainty by calculating the SNR of the model’s sample output probabilities. We first concatenate two chunks and input them into the model to obtain the probability. We then use this SNR to measure span uncertainty, and finally, convert the span uncertainty into a measure of similarity. Specifically, the uncertainty can be expressed by the self-information:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="I(x_{i}|x_{i-1},\dots,x_{0})=-\log p(x_{i}|x_{i-1},\dots,x_{0})," class="ltx_Math" display="block" id="S3.E1.m1.3"><semantics id="S3.E1.m1.3a"><mrow id="S3.E1.m1.3.3.1" xref="S3.E1.m1.3.3.1.1.cmml"><mrow id="S3.E1.m1.3.3.1.1" xref="S3.E1.m1.3.3.1.1.cmml"><mrow id="S3.E1.m1.3.3.1.1.1" xref="S3.E1.m1.3.3.1.1.1.cmml"><mi id="S3.E1.m1.3.3.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.3.cmml">I</mi><mo id="S3.E1.m1.3.3.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.cmml"><mo id="S3.E1.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="S3.E1.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.cmml"><msub id="S3.E1.m1.3.3.1.1.1.1.1.1.4" xref="S3.E1.m1.3.3.1.1.1.1.1.1.4.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.4.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.4.2.cmml">x</mi><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.4.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.4.3.cmml">i</mi></msub><mo fence="false" id="S3.E1.m1.3.3.1.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.3.cmml">|</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.1.1.2.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.3.cmml"><msub id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml">x</mi><mrow id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.3.cmml">,</mo><mi id="S3.E1.m1.1.1" mathvariant="normal" xref="S3.E1.m1.1.1.cmml">…</mi><mo id="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.4" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.2.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.2.2.cmml">x</mi><mn id="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.2.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.2.3.cmml">0</mn></msub></mrow></mrow><mo id="S3.E1.m1.3.3.1.1.1.1.1.3" stretchy="false" xref="S3.E1.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.3.3.1.1.3" xref="S3.E1.m1.3.3.1.1.3.cmml">=</mo><mrow id="S3.E1.m1.3.3.1.1.2" xref="S3.E1.m1.3.3.1.1.2.cmml"><mo id="S3.E1.m1.3.3.1.1.2a" rspace="0.167em" xref="S3.E1.m1.3.3.1.1.2.cmml">−</mo><mrow id="S3.E1.m1.3.3.1.1.2.1" xref="S3.E1.m1.3.3.1.1.2.1.cmml"><mrow id="S3.E1.m1.3.3.1.1.2.1.3" xref="S3.E1.m1.3.3.1.1.2.1.3.cmml"><mi id="S3.E1.m1.3.3.1.1.2.1.3.1" xref="S3.E1.m1.3.3.1.1.2.1.3.1.cmml">log</mi><mo id="S3.E1.m1.3.3.1.1.2.1.3a" lspace="0.167em" xref="S3.E1.m1.3.3.1.1.2.1.3.cmml">⁡</mo><mi id="S3.E1.m1.3.3.1.1.2.1.3.2" xref="S3.E1.m1.3.3.1.1.2.1.3.2.cmml">p</mi></mrow><mo id="S3.E1.m1.3.3.1.1.2.1.2" xref="S3.E1.m1.3.3.1.1.2.1.2.cmml">⁢</mo><mrow id="S3.E1.m1.3.3.1.1.2.1.1.1" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.cmml"><mo id="S3.E1.m1.3.3.1.1.2.1.1.1.2" stretchy="false" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.3.3.1.1.2.1.1.1.1" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.cmml"><msub id="S3.E1.m1.3.3.1.1.2.1.1.1.1.4" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.4.cmml"><mi id="S3.E1.m1.3.3.1.1.2.1.1.1.1.4.2" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.4.2.cmml">x</mi><mi id="S3.E1.m1.3.3.1.1.2.1.1.1.1.4.3" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.4.3.cmml">i</mi></msub><mo fence="false" id="S3.E1.m1.3.3.1.1.2.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.3.cmml">|</mo><mrow id="S3.E1.m1.3.3.1.1.2.1.1.1.1.2.2" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.2.3.cmml"><msub id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1.2.cmml">x</mi><mrow id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1.3.2" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1.3.1" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1.3.3" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.E1.m1.3.3.1.1.2.1.1.1.1.2.2.3" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.2.3.cmml">,</mo><mi id="S3.E1.m1.2.2" mathvariant="normal" xref="S3.E1.m1.2.2.cmml">…</mi><mo id="S3.E1.m1.3.3.1.1.2.1.1.1.1.2.2.4" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.2.3.cmml">,</mo><msub id="S3.E1.m1.3.3.1.1.2.1.1.1.1.2.2.2" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.2.2.2.cmml"><mi id="S3.E1.m1.3.3.1.1.2.1.1.1.1.2.2.2.2" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.2.2.2.2.cmml">x</mi><mn id="S3.E1.m1.3.3.1.1.2.1.1.1.1.2.2.2.3" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.2.2.2.3.cmml">0</mn></msub></mrow></mrow><mo id="S3.E1.m1.3.3.1.1.2.1.1.1.3" stretchy="false" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E1.m1.3.3.1.2" xref="S3.E1.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.3b"><apply id="S3.E1.m1.3.3.1.1.cmml" xref="S3.E1.m1.3.3.1"><eq id="S3.E1.m1.3.3.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.3"></eq><apply id="S3.E1.m1.3.3.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1"><times id="S3.E1.m1.3.3.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.2"></times><ci id="S3.E1.m1.3.3.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.3">𝐼</ci><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.3">conditional</csymbol><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.4.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.1.1.4.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.4.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.4.2">𝑥</ci><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.4.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.4.3">𝑖</ci></apply><list id="S3.E1.m1.3.3.1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.2"><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2">𝑥</ci><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.3"><minus id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.3.1"></minus><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.3.2">𝑖</ci><cn id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">…</ci><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.2.2">𝑥</ci><cn id="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.2.3.cmml" type="integer" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.2.2.3">0</cn></apply></list></apply></apply><apply id="S3.E1.m1.3.3.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.2"><minus id="S3.E1.m1.3.3.1.1.2.2.cmml" xref="S3.E1.m1.3.3.1.1.2"></minus><apply id="S3.E1.m1.3.3.1.1.2.1.cmml" xref="S3.E1.m1.3.3.1.1.2.1"><times id="S3.E1.m1.3.3.1.1.2.1.2.cmml" xref="S3.E1.m1.3.3.1.1.2.1.2"></times><apply id="S3.E1.m1.3.3.1.1.2.1.3.cmml" xref="S3.E1.m1.3.3.1.1.2.1.3"><log id="S3.E1.m1.3.3.1.1.2.1.3.1.cmml" xref="S3.E1.m1.3.3.1.1.2.1.3.1"></log><ci id="S3.E1.m1.3.3.1.1.2.1.3.2.cmml" xref="S3.E1.m1.3.3.1.1.2.1.3.2">𝑝</ci></apply><apply id="S3.E1.m1.3.3.1.1.2.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.3.3.1.1.2.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.3">conditional</csymbol><apply id="S3.E1.m1.3.3.1.1.2.1.1.1.1.4.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.2.1.1.1.1.4.1.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.4">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.2.1.1.1.1.4.2.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.4.2">𝑥</ci><ci id="S3.E1.m1.3.3.1.1.2.1.1.1.1.4.3.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.4.3">𝑖</ci></apply><list id="S3.E1.m1.3.3.1.1.2.1.1.1.1.2.3.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.2.2"><apply id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1.2">𝑥</ci><apply id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1.3"><minus id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1.3.1"></minus><ci id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1.3.2">𝑖</ci><cn id="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2">…</ci><apply id="S3.E1.m1.3.3.1.1.2.1.1.1.1.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.2.1.1.1.1.2.2.2.1.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.2.1.1.1.1.2.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.2.2.2.2">𝑥</ci><cn id="S3.E1.m1.3.3.1.1.2.1.1.1.1.2.2.2.3.cmml" type="integer" xref="S3.E1.m1.3.3.1.1.2.1.1.1.1.2.2.2.3">0</cn></apply></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.3c">I(x_{i}|x_{i-1},\dots,x_{0})=-\log p(x_{i}|x_{i-1},\dots,x_{0}),</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.3d">italic_I ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | italic_x start_POSTSUBSCRIPT italic_i - 1 end_POSTSUBSCRIPT , … , italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) = - roman_log italic_p ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | italic_x start_POSTSUBSCRIPT italic_i - 1 end_POSTSUBSCRIPT , … , italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p1.5">where <math alttext="x_{i}" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><msub id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2.cmml">x</mi><mi id="S3.SS1.p1.1.m1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2">𝑥</ci><ci id="S3.SS1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">x_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is the current token, and <math alttext="p(x_{i}|x_{i-1},\dots,x_{0})" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.2"><semantics id="S3.SS1.p1.2.m2.2a"><mrow id="S3.SS1.p1.2.m2.2.2" xref="S3.SS1.p1.2.m2.2.2.cmml"><mi id="S3.SS1.p1.2.m2.2.2.3" xref="S3.SS1.p1.2.m2.2.2.3.cmml">p</mi><mo id="S3.SS1.p1.2.m2.2.2.2" xref="S3.SS1.p1.2.m2.2.2.2.cmml">⁢</mo><mrow id="S3.SS1.p1.2.m2.2.2.1.1" xref="S3.SS1.p1.2.m2.2.2.1.1.1.cmml"><mo id="S3.SS1.p1.2.m2.2.2.1.1.2" stretchy="false" xref="S3.SS1.p1.2.m2.2.2.1.1.1.cmml">(</mo><mrow id="S3.SS1.p1.2.m2.2.2.1.1.1" xref="S3.SS1.p1.2.m2.2.2.1.1.1.cmml"><msub id="S3.SS1.p1.2.m2.2.2.1.1.1.4" xref="S3.SS1.p1.2.m2.2.2.1.1.1.4.cmml"><mi id="S3.SS1.p1.2.m2.2.2.1.1.1.4.2" xref="S3.SS1.p1.2.m2.2.2.1.1.1.4.2.cmml">x</mi><mi id="S3.SS1.p1.2.m2.2.2.1.1.1.4.3" xref="S3.SS1.p1.2.m2.2.2.1.1.1.4.3.cmml">i</mi></msub><mo fence="false" id="S3.SS1.p1.2.m2.2.2.1.1.1.3" xref="S3.SS1.p1.2.m2.2.2.1.1.1.3.cmml">|</mo><mrow id="S3.SS1.p1.2.m2.2.2.1.1.1.2.2" xref="S3.SS1.p1.2.m2.2.2.1.1.1.2.3.cmml"><msub id="S3.SS1.p1.2.m2.2.2.1.1.1.1.1.1" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.2.m2.2.2.1.1.1.1.1.1.2" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.1.1.2.cmml">x</mi><mrow id="S3.SS1.p1.2.m2.2.2.1.1.1.1.1.1.3" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.1.1.3.cmml"><mi id="S3.SS1.p1.2.m2.2.2.1.1.1.1.1.1.3.2" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="S3.SS1.p1.2.m2.2.2.1.1.1.1.1.1.3.1" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="S3.SS1.p1.2.m2.2.2.1.1.1.1.1.1.3.3" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.SS1.p1.2.m2.2.2.1.1.1.2.2.3" xref="S3.SS1.p1.2.m2.2.2.1.1.1.2.3.cmml">,</mo><mi id="S3.SS1.p1.2.m2.1.1" mathvariant="normal" xref="S3.SS1.p1.2.m2.1.1.cmml">…</mi><mo id="S3.SS1.p1.2.m2.2.2.1.1.1.2.2.4" xref="S3.SS1.p1.2.m2.2.2.1.1.1.2.3.cmml">,</mo><msub id="S3.SS1.p1.2.m2.2.2.1.1.1.2.2.2" xref="S3.SS1.p1.2.m2.2.2.1.1.1.2.2.2.cmml"><mi id="S3.SS1.p1.2.m2.2.2.1.1.1.2.2.2.2" xref="S3.SS1.p1.2.m2.2.2.1.1.1.2.2.2.2.cmml">x</mi><mn id="S3.SS1.p1.2.m2.2.2.1.1.1.2.2.2.3" xref="S3.SS1.p1.2.m2.2.2.1.1.1.2.2.2.3.cmml">0</mn></msub></mrow></mrow><mo id="S3.SS1.p1.2.m2.2.2.1.1.3" stretchy="false" xref="S3.SS1.p1.2.m2.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.2b"><apply id="S3.SS1.p1.2.m2.2.2.cmml" xref="S3.SS1.p1.2.m2.2.2"><times id="S3.SS1.p1.2.m2.2.2.2.cmml" xref="S3.SS1.p1.2.m2.2.2.2"></times><ci id="S3.SS1.p1.2.m2.2.2.3.cmml" xref="S3.SS1.p1.2.m2.2.2.3">𝑝</ci><apply id="S3.SS1.p1.2.m2.2.2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1"><csymbol cd="latexml" id="S3.SS1.p1.2.m2.2.2.1.1.1.3.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1.3">conditional</csymbol><apply id="S3.SS1.p1.2.m2.2.2.1.1.1.4.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1.4"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.2.2.1.1.1.4.1.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1.4">subscript</csymbol><ci id="S3.SS1.p1.2.m2.2.2.1.1.1.4.2.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1.4.2">𝑥</ci><ci id="S3.SS1.p1.2.m2.2.2.1.1.1.4.3.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1.4.3">𝑖</ci></apply><list id="S3.SS1.p1.2.m2.2.2.1.1.1.2.3.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1.2.2"><apply id="S3.SS1.p1.2.m2.2.2.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.m2.2.2.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.1.1.2">𝑥</ci><apply id="S3.SS1.p1.2.m2.2.2.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.1.1.3"><minus id="S3.SS1.p1.2.m2.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.1.1.3.1"></minus><ci id="S3.SS1.p1.2.m2.2.2.1.1.1.1.1.1.3.2.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.1.1.3.2">𝑖</ci><cn id="S3.SS1.p1.2.m2.2.2.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">…</ci><apply id="S3.SS1.p1.2.m2.2.2.1.1.1.2.2.2.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.2.2.1.1.1.2.2.2.1.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.2.m2.2.2.1.1.1.2.2.2.2.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1.2.2.2.2">𝑥</ci><cn id="S3.SS1.p1.2.m2.2.2.1.1.1.2.2.2.3.cmml" type="integer" xref="S3.SS1.p1.2.m2.2.2.1.1.1.2.2.2.3">0</cn></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.2c">p(x_{i}|x_{i-1},\dots,x_{0})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.2d">italic_p ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | italic_x start_POSTSUBSCRIPT italic_i - 1 end_POSTSUBSCRIPT , … , italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT )</annotation></semantics></math> is the conditional probability of token <math alttext="x_{i}" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.1"><semantics id="S3.SS1.p1.3.m3.1a"><msub id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml"><mi id="S3.SS1.p1.3.m3.1.1.2" xref="S3.SS1.p1.3.m3.1.1.2.cmml">x</mi><mi id="S3.SS1.p1.3.m3.1.1.3" xref="S3.SS1.p1.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><apply id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2">𝑥</ci><ci id="S3.SS1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">x_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.1d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> given the preceding tokens <math alttext="x_{i-1},x_{i-2},\dots,x_{0}" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m4.4"><semantics id="S3.SS1.p1.4.m4.4a"><mrow id="S3.SS1.p1.4.m4.4.4.3" xref="S3.SS1.p1.4.m4.4.4.4.cmml"><msub id="S3.SS1.p1.4.m4.2.2.1.1" xref="S3.SS1.p1.4.m4.2.2.1.1.cmml"><mi id="S3.SS1.p1.4.m4.2.2.1.1.2" xref="S3.SS1.p1.4.m4.2.2.1.1.2.cmml">x</mi><mrow id="S3.SS1.p1.4.m4.2.2.1.1.3" xref="S3.SS1.p1.4.m4.2.2.1.1.3.cmml"><mi id="S3.SS1.p1.4.m4.2.2.1.1.3.2" xref="S3.SS1.p1.4.m4.2.2.1.1.3.2.cmml">i</mi><mo id="S3.SS1.p1.4.m4.2.2.1.1.3.1" xref="S3.SS1.p1.4.m4.2.2.1.1.3.1.cmml">−</mo><mn id="S3.SS1.p1.4.m4.2.2.1.1.3.3" xref="S3.SS1.p1.4.m4.2.2.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.SS1.p1.4.m4.4.4.3.4" xref="S3.SS1.p1.4.m4.4.4.4.cmml">,</mo><msub id="S3.SS1.p1.4.m4.3.3.2.2" xref="S3.SS1.p1.4.m4.3.3.2.2.cmml"><mi id="S3.SS1.p1.4.m4.3.3.2.2.2" xref="S3.SS1.p1.4.m4.3.3.2.2.2.cmml">x</mi><mrow id="S3.SS1.p1.4.m4.3.3.2.2.3" xref="S3.SS1.p1.4.m4.3.3.2.2.3.cmml"><mi id="S3.SS1.p1.4.m4.3.3.2.2.3.2" xref="S3.SS1.p1.4.m4.3.3.2.2.3.2.cmml">i</mi><mo id="S3.SS1.p1.4.m4.3.3.2.2.3.1" xref="S3.SS1.p1.4.m4.3.3.2.2.3.1.cmml">−</mo><mn id="S3.SS1.p1.4.m4.3.3.2.2.3.3" xref="S3.SS1.p1.4.m4.3.3.2.2.3.3.cmml">2</mn></mrow></msub><mo id="S3.SS1.p1.4.m4.4.4.3.5" xref="S3.SS1.p1.4.m4.4.4.4.cmml">,</mo><mi id="S3.SS1.p1.4.m4.1.1" mathvariant="normal" xref="S3.SS1.p1.4.m4.1.1.cmml">…</mi><mo id="S3.SS1.p1.4.m4.4.4.3.6" xref="S3.SS1.p1.4.m4.4.4.4.cmml">,</mo><msub id="S3.SS1.p1.4.m4.4.4.3.3" xref="S3.SS1.p1.4.m4.4.4.3.3.cmml"><mi id="S3.SS1.p1.4.m4.4.4.3.3.2" xref="S3.SS1.p1.4.m4.4.4.3.3.2.cmml">x</mi><mn id="S3.SS1.p1.4.m4.4.4.3.3.3" xref="S3.SS1.p1.4.m4.4.4.3.3.3.cmml">0</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.4b"><list id="S3.SS1.p1.4.m4.4.4.4.cmml" xref="S3.SS1.p1.4.m4.4.4.3"><apply id="S3.SS1.p1.4.m4.2.2.1.1.cmml" xref="S3.SS1.p1.4.m4.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.2.2.1.1.1.cmml" xref="S3.SS1.p1.4.m4.2.2.1.1">subscript</csymbol><ci id="S3.SS1.p1.4.m4.2.2.1.1.2.cmml" xref="S3.SS1.p1.4.m4.2.2.1.1.2">𝑥</ci><apply id="S3.SS1.p1.4.m4.2.2.1.1.3.cmml" xref="S3.SS1.p1.4.m4.2.2.1.1.3"><minus id="S3.SS1.p1.4.m4.2.2.1.1.3.1.cmml" xref="S3.SS1.p1.4.m4.2.2.1.1.3.1"></minus><ci id="S3.SS1.p1.4.m4.2.2.1.1.3.2.cmml" xref="S3.SS1.p1.4.m4.2.2.1.1.3.2">𝑖</ci><cn id="S3.SS1.p1.4.m4.2.2.1.1.3.3.cmml" type="integer" xref="S3.SS1.p1.4.m4.2.2.1.1.3.3">1</cn></apply></apply><apply id="S3.SS1.p1.4.m4.3.3.2.2.cmml" xref="S3.SS1.p1.4.m4.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.3.3.2.2.1.cmml" xref="S3.SS1.p1.4.m4.3.3.2.2">subscript</csymbol><ci id="S3.SS1.p1.4.m4.3.3.2.2.2.cmml" xref="S3.SS1.p1.4.m4.3.3.2.2.2">𝑥</ci><apply id="S3.SS1.p1.4.m4.3.3.2.2.3.cmml" xref="S3.SS1.p1.4.m4.3.3.2.2.3"><minus id="S3.SS1.p1.4.m4.3.3.2.2.3.1.cmml" xref="S3.SS1.p1.4.m4.3.3.2.2.3.1"></minus><ci id="S3.SS1.p1.4.m4.3.3.2.2.3.2.cmml" xref="S3.SS1.p1.4.m4.3.3.2.2.3.2">𝑖</ci><cn id="S3.SS1.p1.4.m4.3.3.2.2.3.3.cmml" type="integer" xref="S3.SS1.p1.4.m4.3.3.2.2.3.3">2</cn></apply></apply><ci id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">…</ci><apply id="S3.SS1.p1.4.m4.4.4.3.3.cmml" xref="S3.SS1.p1.4.m4.4.4.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.4.4.3.3.1.cmml" xref="S3.SS1.p1.4.m4.4.4.3.3">subscript</csymbol><ci id="S3.SS1.p1.4.m4.4.4.3.3.2.cmml" xref="S3.SS1.p1.4.m4.4.4.3.3.2">𝑥</ci><cn id="S3.SS1.p1.4.m4.4.4.3.3.3.cmml" type="integer" xref="S3.SS1.p1.4.m4.4.4.3.3.3">0</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.4c">x_{i-1},x_{i-2},\dots,x_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m4.4d">italic_x start_POSTSUBSCRIPT italic_i - 1 end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT italic_i - 2 end_POSTSUBSCRIPT , … , italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> in the sequence. Previous effort <cite class="ltx_cite ltx_citemacro_citep">(Duan et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib18" title="">2024</a>)</cite> has suggested that not all tokens in auto-regressive LLM text equally represent the underlying meaning, as “linguistic redundancy” often allows a few keywords to convey the essence of long sentences. Additionally, we have observed a specific window in the model’s output log probabilities. The probability distribution within this window is stable, which we believe indicates better calibration, a finding that is further validated in subsequent experiments. As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#S3.F1" title="Figure 1 ‣ 3 Methodology ‣ UncertaintyRAG: Span-Level Uncertainty Enhanced Long-Context Modeling for Retrieval-Augmented Generation"><span class="ltx_text ltx_ref_tag">1</span></a>, we use a sliding window with a length of 20 to calculate the SNR within the window, with a sliding step of 10. We found that at a certain turning point, the SNR tends to stabilize. We choose this stable interval to measure the uncertainty of the model. <span class="ltx_text ltx_font_bold" id="S3.SS1.p1.5.1">We define the span-level probabilities within this window as a measure of uncertainty and treat this confidence score as a special type of entailment relationship <cite class="ltx_cite ltx_citemacro_citep">(Lin et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib48" title="">2023b</a>)</cite>, which represents a form of semantic equivalence.</span> Based on the above observations and the additive property of <math alttext="I(x)" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m5.1"><semantics id="S3.SS1.p1.5.m5.1a"><mrow id="S3.SS1.p1.5.m5.1.2" xref="S3.SS1.p1.5.m5.1.2.cmml"><mi id="S3.SS1.p1.5.m5.1.2.2" xref="S3.SS1.p1.5.m5.1.2.2.cmml">I</mi><mo id="S3.SS1.p1.5.m5.1.2.1" xref="S3.SS1.p1.5.m5.1.2.1.cmml">⁢</mo><mrow id="S3.SS1.p1.5.m5.1.2.3.2" xref="S3.SS1.p1.5.m5.1.2.cmml"><mo id="S3.SS1.p1.5.m5.1.2.3.2.1" stretchy="false" xref="S3.SS1.p1.5.m5.1.2.cmml">(</mo><mi id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml">x</mi><mo id="S3.SS1.p1.5.m5.1.2.3.2.2" stretchy="false" xref="S3.SS1.p1.5.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><apply id="S3.SS1.p1.5.m5.1.2.cmml" xref="S3.SS1.p1.5.m5.1.2"><times id="S3.SS1.p1.5.m5.1.2.1.cmml" xref="S3.SS1.p1.5.m5.1.2.1"></times><ci id="S3.SS1.p1.5.m5.1.2.2.cmml" xref="S3.SS1.p1.5.m5.1.2.2">𝐼</ci><ci id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">I(x)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m5.1d">italic_I ( italic_x )</annotation></semantics></math>, we present the following definition:</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p2">
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{SNR}_{j}=\frac{\frac{1}{n_{j}}\sum_{i=1}^{n_{j}}I(x_{ij}|x_{(i-1)j},x_{(%
i-2)j},\dots,x_{0j})}{\text{Var}\left(I(x_{ij}|x_{(i-1)j},x_{(i-2)j},\dots,x_{%
0j})\right)}," class="ltx_Math" display="block" id="S3.E2.m1.9"><semantics id="S3.E2.m1.9a"><mrow id="S3.E2.m1.9.9.1" xref="S3.E2.m1.9.9.1.1.cmml"><mrow id="S3.E2.m1.9.9.1.1" xref="S3.E2.m1.9.9.1.1.cmml"><msub id="S3.E2.m1.9.9.1.1.2" xref="S3.E2.m1.9.9.1.1.2.cmml"><mtext id="S3.E2.m1.9.9.1.1.2.2" xref="S3.E2.m1.9.9.1.1.2.2a.cmml">SNR</mtext><mi id="S3.E2.m1.9.9.1.1.2.3" xref="S3.E2.m1.9.9.1.1.2.3.cmml">j</mi></msub><mo id="S3.E2.m1.9.9.1.1.1" xref="S3.E2.m1.9.9.1.1.1.cmml">=</mo><mfrac id="S3.E2.m1.8.8" xref="S3.E2.m1.8.8.cmml"><mrow id="S3.E2.m1.4.4.4" xref="S3.E2.m1.4.4.4.cmml"><mfrac id="S3.E2.m1.4.4.4.6" xref="S3.E2.m1.4.4.4.6.cmml"><mn id="S3.E2.m1.4.4.4.6.2" xref="S3.E2.m1.4.4.4.6.2.cmml">1</mn><msub id="S3.E2.m1.4.4.4.6.3" xref="S3.E2.m1.4.4.4.6.3.cmml"><mi id="S3.E2.m1.4.4.4.6.3.2" xref="S3.E2.m1.4.4.4.6.3.2.cmml">n</mi><mi id="S3.E2.m1.4.4.4.6.3.3" xref="S3.E2.m1.4.4.4.6.3.3.cmml">j</mi></msub></mfrac><mo id="S3.E2.m1.4.4.4.5" xref="S3.E2.m1.4.4.4.5.cmml">⁢</mo><mrow id="S3.E2.m1.4.4.4.4" xref="S3.E2.m1.4.4.4.4.cmml"><msubsup id="S3.E2.m1.4.4.4.4.2" xref="S3.E2.m1.4.4.4.4.2.cmml"><mo id="S3.E2.m1.4.4.4.4.2.2.2" xref="S3.E2.m1.4.4.4.4.2.2.2.cmml">∑</mo><mrow id="S3.E2.m1.4.4.4.4.2.2.3" xref="S3.E2.m1.4.4.4.4.2.2.3.cmml"><mi id="S3.E2.m1.4.4.4.4.2.2.3.2" xref="S3.E2.m1.4.4.4.4.2.2.3.2.cmml">i</mi><mo id="S3.E2.m1.4.4.4.4.2.2.3.1" xref="S3.E2.m1.4.4.4.4.2.2.3.1.cmml">=</mo><mn id="S3.E2.m1.4.4.4.4.2.2.3.3" xref="S3.E2.m1.4.4.4.4.2.2.3.3.cmml">1</mn></mrow><msub id="S3.E2.m1.4.4.4.4.2.3" xref="S3.E2.m1.4.4.4.4.2.3.cmml"><mi id="S3.E2.m1.4.4.4.4.2.3.2" xref="S3.E2.m1.4.4.4.4.2.3.2.cmml">n</mi><mi id="S3.E2.m1.4.4.4.4.2.3.3" xref="S3.E2.m1.4.4.4.4.2.3.3.cmml">j</mi></msub></msubsup><mrow id="S3.E2.m1.4.4.4.4.1" xref="S3.E2.m1.4.4.4.4.1.cmml"><mi id="S3.E2.m1.4.4.4.4.1.3" xref="S3.E2.m1.4.4.4.4.1.3.cmml">I</mi><mo id="S3.E2.m1.4.4.4.4.1.2" xref="S3.E2.m1.4.4.4.4.1.2.cmml">⁢</mo><mrow id="S3.E2.m1.4.4.4.4.1.1.1" xref="S3.E2.m1.4.4.4.4.1.1.1.1.cmml"><mo id="S3.E2.m1.4.4.4.4.1.1.1.2" stretchy="false" xref="S3.E2.m1.4.4.4.4.1.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.4.4.4.4.1.1.1.1" xref="S3.E2.m1.4.4.4.4.1.1.1.1.cmml"><msub id="S3.E2.m1.4.4.4.4.1.1.1.1.5" xref="S3.E2.m1.4.4.4.4.1.1.1.1.5.cmml"><mi id="S3.E2.m1.4.4.4.4.1.1.1.1.5.2" xref="S3.E2.m1.4.4.4.4.1.1.1.1.5.2.cmml">x</mi><mrow id="S3.E2.m1.4.4.4.4.1.1.1.1.5.3" xref="S3.E2.m1.4.4.4.4.1.1.1.1.5.3.cmml"><mi id="S3.E2.m1.4.4.4.4.1.1.1.1.5.3.2" xref="S3.E2.m1.4.4.4.4.1.1.1.1.5.3.2.cmml">i</mi><mo id="S3.E2.m1.4.4.4.4.1.1.1.1.5.3.1" xref="S3.E2.m1.4.4.4.4.1.1.1.1.5.3.1.cmml">⁢</mo><mi id="S3.E2.m1.4.4.4.4.1.1.1.1.5.3.3" xref="S3.E2.m1.4.4.4.4.1.1.1.1.5.3.3.cmml">j</mi></mrow></msub><mo fence="false" id="S3.E2.m1.4.4.4.4.1.1.1.1.4" xref="S3.E2.m1.4.4.4.4.1.1.1.1.4.cmml">|</mo><mrow id="S3.E2.m1.4.4.4.4.1.1.1.1.3.3" xref="S3.E2.m1.4.4.4.4.1.1.1.1.3.4.cmml"><msub id="S3.E2.m1.4.4.4.4.1.1.1.1.1.1.1" xref="S3.E2.m1.4.4.4.4.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.4.4.4.4.1.1.1.1.1.1.1.2" xref="S3.E2.m1.4.4.4.4.1.1.1.1.1.1.1.2.cmml">x</mi><mrow id="S3.E2.m1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.cmml"><mrow id="S3.E2.m1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E2.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E2.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2.cmml">i</mi><mo id="S3.E2.m1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mn id="S3.E2.m1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.E2.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E2.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E2.m1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S3.E2.m1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.3.cmml">j</mi></mrow></msub><mo id="S3.E2.m1.4.4.4.4.1.1.1.1.3.3.4" xref="S3.E2.m1.4.4.4.4.1.1.1.1.3.4.cmml">,</mo><msub id="S3.E2.m1.4.4.4.4.1.1.1.1.2.2.2" xref="S3.E2.m1.4.4.4.4.1.1.1.1.2.2.2.cmml"><mi id="S3.E2.m1.4.4.4.4.1.1.1.1.2.2.2.2" xref="S3.E2.m1.4.4.4.4.1.1.1.1.2.2.2.2.cmml">x</mi><mrow id="S3.E2.m1.2.2.2.2.1" xref="S3.E2.m1.2.2.2.2.1.cmml"><mrow id="S3.E2.m1.2.2.2.2.1.1.1" xref="S3.E2.m1.2.2.2.2.1.1.1.1.cmml"><mo id="S3.E2.m1.2.2.2.2.1.1.1.2" stretchy="false" xref="S3.E2.m1.2.2.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.2.2.2.2.1.1.1.1" xref="S3.E2.m1.2.2.2.2.1.1.1.1.cmml"><mi id="S3.E2.m1.2.2.2.2.1.1.1.1.2" xref="S3.E2.m1.2.2.2.2.1.1.1.1.2.cmml">i</mi><mo id="S3.E2.m1.2.2.2.2.1.1.1.1.1" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.cmml">−</mo><mn id="S3.E2.m1.2.2.2.2.1.1.1.1.3" xref="S3.E2.m1.2.2.2.2.1.1.1.1.3.cmml">2</mn></mrow><mo id="S3.E2.m1.2.2.2.2.1.1.1.3" stretchy="false" xref="S3.E2.m1.2.2.2.2.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E2.m1.2.2.2.2.1.2" xref="S3.E2.m1.2.2.2.2.1.2.cmml">⁢</mo><mi id="S3.E2.m1.2.2.2.2.1.3" xref="S3.E2.m1.2.2.2.2.1.3.cmml">j</mi></mrow></msub><mo id="S3.E2.m1.4.4.4.4.1.1.1.1.3.3.5" xref="S3.E2.m1.4.4.4.4.1.1.1.1.3.4.cmml">,</mo><mi id="S3.E2.m1.3.3.3.3" mathvariant="normal" xref="S3.E2.m1.3.3.3.3.cmml">…</mi><mo id="S3.E2.m1.4.4.4.4.1.1.1.1.3.3.6" xref="S3.E2.m1.4.4.4.4.1.1.1.1.3.4.cmml">,</mo><msub id="S3.E2.m1.4.4.4.4.1.1.1.1.3.3.3" xref="S3.E2.m1.4.4.4.4.1.1.1.1.3.3.3.cmml"><mi id="S3.E2.m1.4.4.4.4.1.1.1.1.3.3.3.2" xref="S3.E2.m1.4.4.4.4.1.1.1.1.3.3.3.2.cmml">x</mi><mrow id="S3.E2.m1.4.4.4.4.1.1.1.1.3.3.3.3" xref="S3.E2.m1.4.4.4.4.1.1.1.1.3.3.3.3.cmml"><mn id="S3.E2.m1.4.4.4.4.1.1.1.1.3.3.3.3.2" xref="S3.E2.m1.4.4.4.4.1.1.1.1.3.3.3.3.2.cmml">0</mn><mo id="S3.E2.m1.4.4.4.4.1.1.1.1.3.3.3.3.1" xref="S3.E2.m1.4.4.4.4.1.1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S3.E2.m1.4.4.4.4.1.1.1.1.3.3.3.3.3" xref="S3.E2.m1.4.4.4.4.1.1.1.1.3.3.3.3.3.cmml">j</mi></mrow></msub></mrow></mrow><mo id="S3.E2.m1.4.4.4.4.1.1.1.3" stretchy="false" xref="S3.E2.m1.4.4.4.4.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mrow id="S3.E2.m1.8.8.8" xref="S3.E2.m1.8.8.8.cmml"><mtext id="S3.E2.m1.8.8.8.6" xref="S3.E2.m1.8.8.8.6a.cmml">Var</mtext><mo id="S3.E2.m1.8.8.8.5" xref="S3.E2.m1.8.8.8.5.cmml">⁢</mo><mrow id="S3.E2.m1.8.8.8.4.1" xref="S3.E2.m1.8.8.8.4.1.1.cmml"><mo id="S3.E2.m1.8.8.8.4.1.2" xref="S3.E2.m1.8.8.8.4.1.1.cmml">(</mo><mrow id="S3.E2.m1.8.8.8.4.1.1" xref="S3.E2.m1.8.8.8.4.1.1.cmml"><mi id="S3.E2.m1.8.8.8.4.1.1.3" xref="S3.E2.m1.8.8.8.4.1.1.3.cmml">I</mi><mo id="S3.E2.m1.8.8.8.4.1.1.2" xref="S3.E2.m1.8.8.8.4.1.1.2.cmml">⁢</mo><mrow id="S3.E2.m1.8.8.8.4.1.1.1.1" xref="S3.E2.m1.8.8.8.4.1.1.1.1.1.cmml"><mo id="S3.E2.m1.8.8.8.4.1.1.1.1.2" stretchy="false" xref="S3.E2.m1.8.8.8.4.1.1.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.8.8.8.4.1.1.1.1.1" xref="S3.E2.m1.8.8.8.4.1.1.1.1.1.cmml"><msub id="S3.E2.m1.8.8.8.4.1.1.1.1.1.5" xref="S3.E2.m1.8.8.8.4.1.1.1.1.1.5.cmml"><mi id="S3.E2.m1.8.8.8.4.1.1.1.1.1.5.2" xref="S3.E2.m1.8.8.8.4.1.1.1.1.1.5.2.cmml">x</mi><mrow id="S3.E2.m1.8.8.8.4.1.1.1.1.1.5.3" xref="S3.E2.m1.8.8.8.4.1.1.1.1.1.5.3.cmml"><mi id="S3.E2.m1.8.8.8.4.1.1.1.1.1.5.3.2" xref="S3.E2.m1.8.8.8.4.1.1.1.1.1.5.3.2.cmml">i</mi><mo id="S3.E2.m1.8.8.8.4.1.1.1.1.1.5.3.1" xref="S3.E2.m1.8.8.8.4.1.1.1.1.1.5.3.1.cmml">⁢</mo><mi id="S3.E2.m1.8.8.8.4.1.1.1.1.1.5.3.3" xref="S3.E2.m1.8.8.8.4.1.1.1.1.1.5.3.3.cmml">j</mi></mrow></msub><mo fence="false" id="S3.E2.m1.8.8.8.4.1.1.1.1.1.4" xref="S3.E2.m1.8.8.8.4.1.1.1.1.1.4.cmml">|</mo><mrow id="S3.E2.m1.8.8.8.4.1.1.1.1.1.3.3" xref="S3.E2.m1.8.8.8.4.1.1.1.1.1.3.4.cmml"><msub id="S3.E2.m1.8.8.8.4.1.1.1.1.1.1.1.1" xref="S3.E2.m1.8.8.8.4.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.8.8.8.4.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.8.8.8.4.1.1.1.1.1.1.1.1.2.cmml">x</mi><mrow id="S3.E2.m1.5.5.5.1.1" xref="S3.E2.m1.5.5.5.1.1.cmml"><mrow id="S3.E2.m1.5.5.5.1.1.1.1" xref="S3.E2.m1.5.5.5.1.1.1.1.1.cmml"><mo id="S3.E2.m1.5.5.5.1.1.1.1.2" stretchy="false" xref="S3.E2.m1.5.5.5.1.1.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.5.5.5.1.1.1.1.1" xref="S3.E2.m1.5.5.5.1.1.1.1.1.cmml"><mi id="S3.E2.m1.5.5.5.1.1.1.1.1.2" xref="S3.E2.m1.5.5.5.1.1.1.1.1.2.cmml">i</mi><mo id="S3.E2.m1.5.5.5.1.1.1.1.1.1" xref="S3.E2.m1.5.5.5.1.1.1.1.1.1.cmml">−</mo><mn id="S3.E2.m1.5.5.5.1.1.1.1.1.3" xref="S3.E2.m1.5.5.5.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.E2.m1.5.5.5.1.1.1.1.3" stretchy="false" xref="S3.E2.m1.5.5.5.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E2.m1.5.5.5.1.1.2" xref="S3.E2.m1.5.5.5.1.1.2.cmml">⁢</mo><mi id="S3.E2.m1.5.5.5.1.1.3" xref="S3.E2.m1.5.5.5.1.1.3.cmml">j</mi></mrow></msub><mo id="S3.E2.m1.8.8.8.4.1.1.1.1.1.3.3.4" xref="S3.E2.m1.8.8.8.4.1.1.1.1.1.3.4.cmml">,</mo><msub id="S3.E2.m1.8.8.8.4.1.1.1.1.1.2.2.2" xref="S3.E2.m1.8.8.8.4.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E2.m1.8.8.8.4.1.1.1.1.1.2.2.2.2" xref="S3.E2.m1.8.8.8.4.1.1.1.1.1.2.2.2.2.cmml">x</mi><mrow id="S3.E2.m1.6.6.6.2.1" xref="S3.E2.m1.6.6.6.2.1.cmml"><mrow id="S3.E2.m1.6.6.6.2.1.1.1" xref="S3.E2.m1.6.6.6.2.1.1.1.1.cmml"><mo id="S3.E2.m1.6.6.6.2.1.1.1.2" stretchy="false" xref="S3.E2.m1.6.6.6.2.1.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.6.6.6.2.1.1.1.1" xref="S3.E2.m1.6.6.6.2.1.1.1.1.cmml"><mi id="S3.E2.m1.6.6.6.2.1.1.1.1.2" xref="S3.E2.m1.6.6.6.2.1.1.1.1.2.cmml">i</mi><mo id="S3.E2.m1.6.6.6.2.1.1.1.1.1" xref="S3.E2.m1.6.6.6.2.1.1.1.1.1.cmml">−</mo><mn id="S3.E2.m1.6.6.6.2.1.1.1.1.3" xref="S3.E2.m1.6.6.6.2.1.1.1.1.3.cmml">2</mn></mrow><mo id="S3.E2.m1.6.6.6.2.1.1.1.3" stretchy="false" xref="S3.E2.m1.6.6.6.2.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E2.m1.6.6.6.2.1.2" xref="S3.E2.m1.6.6.6.2.1.2.cmml">⁢</mo><mi id="S3.E2.m1.6.6.6.2.1.3" xref="S3.E2.m1.6.6.6.2.1.3.cmml">j</mi></mrow></msub><mo id="S3.E2.m1.8.8.8.4.1.1.1.1.1.3.3.5" xref="S3.E2.m1.8.8.8.4.1.1.1.1.1.3.4.cmml">,</mo><mi id="S3.E2.m1.7.7.7.3" mathvariant="normal" xref="S3.E2.m1.7.7.7.3.cmml">…</mi><mo id="S3.E2.m1.8.8.8.4.1.1.1.1.1.3.3.6" xref="S3.E2.m1.8.8.8.4.1.1.1.1.1.3.4.cmml">,</mo><msub id="S3.E2.m1.8.8.8.4.1.1.1.1.1.3.3.3" xref="S3.E2.m1.8.8.8.4.1.1.1.1.1.3.3.3.cmml"><mi id="S3.E2.m1.8.8.8.4.1.1.1.1.1.3.3.3.2" xref="S3.E2.m1.8.8.8.4.1.1.1.1.1.3.3.3.2.cmml">x</mi><mrow id="S3.E2.m1.8.8.8.4.1.1.1.1.1.3.3.3.3" xref="S3.E2.m1.8.8.8.4.1.1.1.1.1.3.3.3.3.cmml"><mn id="S3.E2.m1.8.8.8.4.1.1.1.1.1.3.3.3.3.2" xref="S3.E2.m1.8.8.8.4.1.1.1.1.1.3.3.3.3.2.cmml">0</mn><mo id="S3.E2.m1.8.8.8.4.1.1.1.1.1.3.3.3.3.1" xref="S3.E2.m1.8.8.8.4.1.1.1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S3.E2.m1.8.8.8.4.1.1.1.1.1.3.3.3.3.3" xref="S3.E2.m1.8.8.8.4.1.1.1.1.1.3.3.3.3.3.cmml">j</mi></mrow></msub></mrow></mrow><mo id="S3.E2.m1.8.8.8.4.1.1.1.1.3" stretchy="false" xref="S3.E2.m1.8.8.8.4.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.8.8.8.4.1.3" xref="S3.E2.m1.8.8.8.4.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow><mo id="S3.E2.m1.9.9.1.2" xref="S3.E2.m1.9.9.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.9b"><apply id="S3.E2.m1.9.9.1.1.cmml" xref="S3.E2.m1.9.9.1"><eq id="S3.E2.m1.9.9.1.1.1.cmml" xref="S3.E2.m1.9.9.1.1.1"></eq><apply id="S3.E2.m1.9.9.1.1.2.cmml" xref="S3.E2.m1.9.9.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.9.9.1.1.2.1.cmml" xref="S3.E2.m1.9.9.1.1.2">subscript</csymbol><ci id="S3.E2.m1.9.9.1.1.2.2a.cmml" xref="S3.E2.m1.9.9.1.1.2.2"><mtext id="S3.E2.m1.9.9.1.1.2.2.cmml" xref="S3.E2.m1.9.9.1.1.2.2">SNR</mtext></ci><ci id="S3.E2.m1.9.9.1.1.2.3.cmml" xref="S3.E2.m1.9.9.1.1.2.3">𝑗</ci></apply><apply id="S3.E2.m1.8.8.cmml" xref="S3.E2.m1.8.8"><divide id="S3.E2.m1.8.8.9.cmml" xref="S3.E2.m1.8.8"></divide><apply id="S3.E2.m1.4.4.4.cmml" xref="S3.E2.m1.4.4.4"><times id="S3.E2.m1.4.4.4.5.cmml" xref="S3.E2.m1.4.4.4.5"></times><apply id="S3.E2.m1.4.4.4.6.cmml" xref="S3.E2.m1.4.4.4.6"><divide id="S3.E2.m1.4.4.4.6.1.cmml" xref="S3.E2.m1.4.4.4.6"></divide><cn id="S3.E2.m1.4.4.4.6.2.cmml" type="integer" xref="S3.E2.m1.4.4.4.6.2">1</cn><apply id="S3.E2.m1.4.4.4.6.3.cmml" xref="S3.E2.m1.4.4.4.6.3"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.4.6.3.1.cmml" xref="S3.E2.m1.4.4.4.6.3">subscript</csymbol><ci id="S3.E2.m1.4.4.4.6.3.2.cmml" xref="S3.E2.m1.4.4.4.6.3.2">𝑛</ci><ci id="S3.E2.m1.4.4.4.6.3.3.cmml" xref="S3.E2.m1.4.4.4.6.3.3">𝑗</ci></apply></apply><apply id="S3.E2.m1.4.4.4.4.cmml" xref="S3.E2.m1.4.4.4.4"><apply id="S3.E2.m1.4.4.4.4.2.cmml" xref="S3.E2.m1.4.4.4.4.2"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.4.4.2.1.cmml" xref="S3.E2.m1.4.4.4.4.2">superscript</csymbol><apply id="S3.E2.m1.4.4.4.4.2.2.cmml" xref="S3.E2.m1.4.4.4.4.2"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.4.4.2.2.1.cmml" xref="S3.E2.m1.4.4.4.4.2">subscript</csymbol><sum id="S3.E2.m1.4.4.4.4.2.2.2.cmml" xref="S3.E2.m1.4.4.4.4.2.2.2"></sum><apply id="S3.E2.m1.4.4.4.4.2.2.3.cmml" xref="S3.E2.m1.4.4.4.4.2.2.3"><eq id="S3.E2.m1.4.4.4.4.2.2.3.1.cmml" xref="S3.E2.m1.4.4.4.4.2.2.3.1"></eq><ci id="S3.E2.m1.4.4.4.4.2.2.3.2.cmml" xref="S3.E2.m1.4.4.4.4.2.2.3.2">𝑖</ci><cn id="S3.E2.m1.4.4.4.4.2.2.3.3.cmml" type="integer" xref="S3.E2.m1.4.4.4.4.2.2.3.3">1</cn></apply></apply><apply id="S3.E2.m1.4.4.4.4.2.3.cmml" xref="S3.E2.m1.4.4.4.4.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.4.4.2.3.1.cmml" xref="S3.E2.m1.4.4.4.4.2.3">subscript</csymbol><ci id="S3.E2.m1.4.4.4.4.2.3.2.cmml" xref="S3.E2.m1.4.4.4.4.2.3.2">𝑛</ci><ci id="S3.E2.m1.4.4.4.4.2.3.3.cmml" xref="S3.E2.m1.4.4.4.4.2.3.3">𝑗</ci></apply></apply><apply id="S3.E2.m1.4.4.4.4.1.cmml" xref="S3.E2.m1.4.4.4.4.1"><times id="S3.E2.m1.4.4.4.4.1.2.cmml" xref="S3.E2.m1.4.4.4.4.1.2"></times><ci id="S3.E2.m1.4.4.4.4.1.3.cmml" xref="S3.E2.m1.4.4.4.4.1.3">𝐼</ci><apply id="S3.E2.m1.4.4.4.4.1.1.1.1.cmml" xref="S3.E2.m1.4.4.4.4.1.1.1"><csymbol cd="latexml" id="S3.E2.m1.4.4.4.4.1.1.1.1.4.cmml" xref="S3.E2.m1.4.4.4.4.1.1.1.1.4">conditional</csymbol><apply id="S3.E2.m1.4.4.4.4.1.1.1.1.5.cmml" xref="S3.E2.m1.4.4.4.4.1.1.1.1.5"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.4.4.1.1.1.1.5.1.cmml" xref="S3.E2.m1.4.4.4.4.1.1.1.1.5">subscript</csymbol><ci id="S3.E2.m1.4.4.4.4.1.1.1.1.5.2.cmml" xref="S3.E2.m1.4.4.4.4.1.1.1.1.5.2">𝑥</ci><apply id="S3.E2.m1.4.4.4.4.1.1.1.1.5.3.cmml" xref="S3.E2.m1.4.4.4.4.1.1.1.1.5.3"><times id="S3.E2.m1.4.4.4.4.1.1.1.1.5.3.1.cmml" xref="S3.E2.m1.4.4.4.4.1.1.1.1.5.3.1"></times><ci id="S3.E2.m1.4.4.4.4.1.1.1.1.5.3.2.cmml" xref="S3.E2.m1.4.4.4.4.1.1.1.1.5.3.2">𝑖</ci><ci id="S3.E2.m1.4.4.4.4.1.1.1.1.5.3.3.cmml" xref="S3.E2.m1.4.4.4.4.1.1.1.1.5.3.3">𝑗</ci></apply></apply><list id="S3.E2.m1.4.4.4.4.1.1.1.1.3.4.cmml" xref="S3.E2.m1.4.4.4.4.1.1.1.1.3.3"><apply id="S3.E2.m1.4.4.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.4.4.4.4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.4.4.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.4.4.4.4.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.4.4.4.4.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.4.4.4.4.1.1.1.1.1.1.1.2">𝑥</ci><apply id="S3.E2.m1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1"><times id="S3.E2.m1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.2"></times><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1"><minus id="S3.E2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1"></minus><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2">𝑖</ci><cn id="S3.E2.m1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E2.m1.1.1.1.1.1.1.1.1.3">1</cn></apply><ci id="S3.E2.m1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.3">𝑗</ci></apply></apply><apply id="S3.E2.m1.4.4.4.4.1.1.1.1.2.2.2.cmml" xref="S3.E2.m1.4.4.4.4.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.4.4.1.1.1.1.2.2.2.1.cmml" xref="S3.E2.m1.4.4.4.4.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E2.m1.4.4.4.4.1.1.1.1.2.2.2.2.cmml" xref="S3.E2.m1.4.4.4.4.1.1.1.1.2.2.2.2">𝑥</ci><apply id="S3.E2.m1.2.2.2.2.1.cmml" xref="S3.E2.m1.2.2.2.2.1"><times id="S3.E2.m1.2.2.2.2.1.2.cmml" xref="S3.E2.m1.2.2.2.2.1.2"></times><apply id="S3.E2.m1.2.2.2.2.1.1.1.1.cmml" xref="S3.E2.m1.2.2.2.2.1.1.1"><minus id="S3.E2.m1.2.2.2.2.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1"></minus><ci id="S3.E2.m1.2.2.2.2.1.1.1.1.2.cmml" xref="S3.E2.m1.2.2.2.2.1.1.1.1.2">𝑖</ci><cn id="S3.E2.m1.2.2.2.2.1.1.1.1.3.cmml" type="integer" xref="S3.E2.m1.2.2.2.2.1.1.1.1.3">2</cn></apply><ci id="S3.E2.m1.2.2.2.2.1.3.cmml" xref="S3.E2.m1.2.2.2.2.1.3">𝑗</ci></apply></apply><ci id="S3.E2.m1.3.3.3.3.cmml" xref="S3.E2.m1.3.3.3.3">…</ci><apply id="S3.E2.m1.4.4.4.4.1.1.1.1.3.3.3.cmml" xref="S3.E2.m1.4.4.4.4.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.4.4.1.1.1.1.3.3.3.1.cmml" xref="S3.E2.m1.4.4.4.4.1.1.1.1.3.3.3">subscript</csymbol><ci id="S3.E2.m1.4.4.4.4.1.1.1.1.3.3.3.2.cmml" xref="S3.E2.m1.4.4.4.4.1.1.1.1.3.3.3.2">𝑥</ci><apply id="S3.E2.m1.4.4.4.4.1.1.1.1.3.3.3.3.cmml" xref="S3.E2.m1.4.4.4.4.1.1.1.1.3.3.3.3"><times id="S3.E2.m1.4.4.4.4.1.1.1.1.3.3.3.3.1.cmml" xref="S3.E2.m1.4.4.4.4.1.1.1.1.3.3.3.3.1"></times><cn id="S3.E2.m1.4.4.4.4.1.1.1.1.3.3.3.3.2.cmml" type="integer" xref="S3.E2.m1.4.4.4.4.1.1.1.1.3.3.3.3.2">0</cn><ci id="S3.E2.m1.4.4.4.4.1.1.1.1.3.3.3.3.3.cmml" xref="S3.E2.m1.4.4.4.4.1.1.1.1.3.3.3.3.3">𝑗</ci></apply></apply></list></apply></apply></apply></apply><apply id="S3.E2.m1.8.8.8.cmml" xref="S3.E2.m1.8.8.8"><times id="S3.E2.m1.8.8.8.5.cmml" xref="S3.E2.m1.8.8.8.5"></times><ci id="S3.E2.m1.8.8.8.6a.cmml" xref="S3.E2.m1.8.8.8.6"><mtext id="S3.E2.m1.8.8.8.6.cmml" xref="S3.E2.m1.8.8.8.6">Var</mtext></ci><apply id="S3.E2.m1.8.8.8.4.1.1.cmml" xref="S3.E2.m1.8.8.8.4.1"><times id="S3.E2.m1.8.8.8.4.1.1.2.cmml" xref="S3.E2.m1.8.8.8.4.1.1.2"></times><ci id="S3.E2.m1.8.8.8.4.1.1.3.cmml" xref="S3.E2.m1.8.8.8.4.1.1.3">𝐼</ci><apply id="S3.E2.m1.8.8.8.4.1.1.1.1.1.cmml" xref="S3.E2.m1.8.8.8.4.1.1.1.1"><csymbol cd="latexml" id="S3.E2.m1.8.8.8.4.1.1.1.1.1.4.cmml" xref="S3.E2.m1.8.8.8.4.1.1.1.1.1.4">conditional</csymbol><apply id="S3.E2.m1.8.8.8.4.1.1.1.1.1.5.cmml" xref="S3.E2.m1.8.8.8.4.1.1.1.1.1.5"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.8.4.1.1.1.1.1.5.1.cmml" xref="S3.E2.m1.8.8.8.4.1.1.1.1.1.5">subscript</csymbol><ci id="S3.E2.m1.8.8.8.4.1.1.1.1.1.5.2.cmml" xref="S3.E2.m1.8.8.8.4.1.1.1.1.1.5.2">𝑥</ci><apply id="S3.E2.m1.8.8.8.4.1.1.1.1.1.5.3.cmml" xref="S3.E2.m1.8.8.8.4.1.1.1.1.1.5.3"><times id="S3.E2.m1.8.8.8.4.1.1.1.1.1.5.3.1.cmml" xref="S3.E2.m1.8.8.8.4.1.1.1.1.1.5.3.1"></times><ci id="S3.E2.m1.8.8.8.4.1.1.1.1.1.5.3.2.cmml" xref="S3.E2.m1.8.8.8.4.1.1.1.1.1.5.3.2">𝑖</ci><ci id="S3.E2.m1.8.8.8.4.1.1.1.1.1.5.3.3.cmml" xref="S3.E2.m1.8.8.8.4.1.1.1.1.1.5.3.3">𝑗</ci></apply></apply><list id="S3.E2.m1.8.8.8.4.1.1.1.1.1.3.4.cmml" xref="S3.E2.m1.8.8.8.4.1.1.1.1.1.3.3"><apply id="S3.E2.m1.8.8.8.4.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.8.8.8.4.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.8.4.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.8.8.8.4.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.8.8.8.4.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.8.8.8.4.1.1.1.1.1.1.1.1.2">𝑥</ci><apply id="S3.E2.m1.5.5.5.1.1.cmml" xref="S3.E2.m1.5.5.5.1.1"><times id="S3.E2.m1.5.5.5.1.1.2.cmml" xref="S3.E2.m1.5.5.5.1.1.2"></times><apply id="S3.E2.m1.5.5.5.1.1.1.1.1.cmml" xref="S3.E2.m1.5.5.5.1.1.1.1"><minus id="S3.E2.m1.5.5.5.1.1.1.1.1.1.cmml" xref="S3.E2.m1.5.5.5.1.1.1.1.1.1"></minus><ci id="S3.E2.m1.5.5.5.1.1.1.1.1.2.cmml" xref="S3.E2.m1.5.5.5.1.1.1.1.1.2">𝑖</ci><cn id="S3.E2.m1.5.5.5.1.1.1.1.1.3.cmml" type="integer" xref="S3.E2.m1.5.5.5.1.1.1.1.1.3">1</cn></apply><ci id="S3.E2.m1.5.5.5.1.1.3.cmml" xref="S3.E2.m1.5.5.5.1.1.3">𝑗</ci></apply></apply><apply id="S3.E2.m1.8.8.8.4.1.1.1.1.1.2.2.2.cmml" xref="S3.E2.m1.8.8.8.4.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.8.4.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E2.m1.8.8.8.4.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E2.m1.8.8.8.4.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E2.m1.8.8.8.4.1.1.1.1.1.2.2.2.2">𝑥</ci><apply id="S3.E2.m1.6.6.6.2.1.cmml" xref="S3.E2.m1.6.6.6.2.1"><times id="S3.E2.m1.6.6.6.2.1.2.cmml" xref="S3.E2.m1.6.6.6.2.1.2"></times><apply id="S3.E2.m1.6.6.6.2.1.1.1.1.cmml" xref="S3.E2.m1.6.6.6.2.1.1.1"><minus id="S3.E2.m1.6.6.6.2.1.1.1.1.1.cmml" xref="S3.E2.m1.6.6.6.2.1.1.1.1.1"></minus><ci id="S3.E2.m1.6.6.6.2.1.1.1.1.2.cmml" xref="S3.E2.m1.6.6.6.2.1.1.1.1.2">𝑖</ci><cn id="S3.E2.m1.6.6.6.2.1.1.1.1.3.cmml" type="integer" xref="S3.E2.m1.6.6.6.2.1.1.1.1.3">2</cn></apply><ci id="S3.E2.m1.6.6.6.2.1.3.cmml" xref="S3.E2.m1.6.6.6.2.1.3">𝑗</ci></apply></apply><ci id="S3.E2.m1.7.7.7.3.cmml" xref="S3.E2.m1.7.7.7.3">…</ci><apply id="S3.E2.m1.8.8.8.4.1.1.1.1.1.3.3.3.cmml" xref="S3.E2.m1.8.8.8.4.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.8.4.1.1.1.1.1.3.3.3.1.cmml" xref="S3.E2.m1.8.8.8.4.1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S3.E2.m1.8.8.8.4.1.1.1.1.1.3.3.3.2.cmml" xref="S3.E2.m1.8.8.8.4.1.1.1.1.1.3.3.3.2">𝑥</ci><apply id="S3.E2.m1.8.8.8.4.1.1.1.1.1.3.3.3.3.cmml" xref="S3.E2.m1.8.8.8.4.1.1.1.1.1.3.3.3.3"><times id="S3.E2.m1.8.8.8.4.1.1.1.1.1.3.3.3.3.1.cmml" xref="S3.E2.m1.8.8.8.4.1.1.1.1.1.3.3.3.3.1"></times><cn id="S3.E2.m1.8.8.8.4.1.1.1.1.1.3.3.3.3.2.cmml" type="integer" xref="S3.E2.m1.8.8.8.4.1.1.1.1.1.3.3.3.3.2">0</cn><ci id="S3.E2.m1.8.8.8.4.1.1.1.1.1.3.3.3.3.3.cmml" xref="S3.E2.m1.8.8.8.4.1.1.1.1.1.3.3.3.3.3">𝑗</ci></apply></apply></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.9c">\text{SNR}_{j}=\frac{\frac{1}{n_{j}}\sum_{i=1}^{n_{j}}I(x_{ij}|x_{(i-1)j},x_{(%
i-2)j},\dots,x_{0j})}{\text{Var}\left(I(x_{ij}|x_{(i-1)j},x_{(i-2)j},\dots,x_{%
0j})\right)},</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.9d">SNR start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT = divide start_ARG divide start_ARG 1 end_ARG start_ARG italic_n start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUPERSCRIPT italic_I ( italic_x start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT | italic_x start_POSTSUBSCRIPT ( italic_i - 1 ) italic_j end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT ( italic_i - 2 ) italic_j end_POSTSUBSCRIPT , … , italic_x start_POSTSUBSCRIPT 0 italic_j end_POSTSUBSCRIPT ) end_ARG start_ARG Var ( italic_I ( italic_x start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT | italic_x start_POSTSUBSCRIPT ( italic_i - 1 ) italic_j end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT ( italic_i - 2 ) italic_j end_POSTSUBSCRIPT , … , italic_x start_POSTSUBSCRIPT 0 italic_j end_POSTSUBSCRIPT ) ) end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p3">
<p class="ltx_p" id="S3.SS1.p3.1">The span uncertainty, denoted as <math alttext="\textit{SU}(x)" class="ltx_Math" display="inline" id="S3.SS1.p3.1.m1.1"><semantics id="S3.SS1.p3.1.m1.1a"><mrow id="S3.SS1.p3.1.m1.1.2" xref="S3.SS1.p3.1.m1.1.2.cmml"><mtext class="ltx_mathvariant_italic" id="S3.SS1.p3.1.m1.1.2.2" xref="S3.SS1.p3.1.m1.1.2.2a.cmml">SU</mtext><mo id="S3.SS1.p3.1.m1.1.2.1" xref="S3.SS1.p3.1.m1.1.2.1.cmml">⁢</mo><mrow id="S3.SS1.p3.1.m1.1.2.3.2" xref="S3.SS1.p3.1.m1.1.2.cmml"><mo id="S3.SS1.p3.1.m1.1.2.3.2.1" stretchy="false" xref="S3.SS1.p3.1.m1.1.2.cmml">(</mo><mi id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml">x</mi><mo id="S3.SS1.p3.1.m1.1.2.3.2.2" stretchy="false" xref="S3.SS1.p3.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><apply id="S3.SS1.p3.1.m1.1.2.cmml" xref="S3.SS1.p3.1.m1.1.2"><times id="S3.SS1.p3.1.m1.1.2.1.cmml" xref="S3.SS1.p3.1.m1.1.2.1"></times><ci id="S3.SS1.p3.1.m1.1.2.2a.cmml" xref="S3.SS1.p3.1.m1.1.2.2"><mtext class="ltx_mathvariant_italic" id="S3.SS1.p3.1.m1.1.2.2.cmml" xref="S3.SS1.p3.1.m1.1.2.2">SU</mtext></ci><ci id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">\textit{SU}(x)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.1.m1.1d">SU ( italic_x )</annotation></semantics></math>, is defined as the average self-information over all concatenated tokens across the selected windows, where overlapping tokens are counted only once. The formula is:</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p4">
<table class="ltx_equation ltx_eqn_table" id="S3.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\textit{SU}(x)=\frac{\sum_{j=1}^{m}\mathbf{1}_{\text{SNR}_{j}&lt;\sigma}\sum_{i=1%
}^{n_{j}}I(x_{ij}|x_{(i-1)j},\dots,x_{0j})}{\sum_{j=1}^{m}\mathbf{1}_{\text{%
SNR}_{j}&lt;\sigma}\,n_{j}}," class="ltx_Math" display="block" id="S3.E3.m1.5"><semantics id="S3.E3.m1.5a"><mrow id="S3.E3.m1.5.5.1" xref="S3.E3.m1.5.5.1.1.cmml"><mrow id="S3.E3.m1.5.5.1.1" xref="S3.E3.m1.5.5.1.1.cmml"><mrow id="S3.E3.m1.5.5.1.1.2" xref="S3.E3.m1.5.5.1.1.2.cmml"><mtext class="ltx_mathvariant_italic" id="S3.E3.m1.5.5.1.1.2.2" xref="S3.E3.m1.5.5.1.1.2.2a.cmml">SU</mtext><mo id="S3.E3.m1.5.5.1.1.2.1" xref="S3.E3.m1.5.5.1.1.2.1.cmml">⁢</mo><mrow id="S3.E3.m1.5.5.1.1.2.3.2" xref="S3.E3.m1.5.5.1.1.2.cmml"><mo id="S3.E3.m1.5.5.1.1.2.3.2.1" stretchy="false" xref="S3.E3.m1.5.5.1.1.2.cmml">(</mo><mi id="S3.E3.m1.4.4" xref="S3.E3.m1.4.4.cmml">x</mi><mo id="S3.E3.m1.5.5.1.1.2.3.2.2" stretchy="false" xref="S3.E3.m1.5.5.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.5.5.1.1.1" xref="S3.E3.m1.5.5.1.1.1.cmml">=</mo><mfrac id="S3.E3.m1.3.3" xref="S3.E3.m1.3.3.cmml"><mrow id="S3.E3.m1.3.3.3" xref="S3.E3.m1.3.3.3.cmml"><msubsup id="S3.E3.m1.3.3.3.4" xref="S3.E3.m1.3.3.3.4.cmml"><mo id="S3.E3.m1.3.3.3.4.2.2" xref="S3.E3.m1.3.3.3.4.2.2.cmml">∑</mo><mrow id="S3.E3.m1.3.3.3.4.2.3" xref="S3.E3.m1.3.3.3.4.2.3.cmml"><mi id="S3.E3.m1.3.3.3.4.2.3.2" xref="S3.E3.m1.3.3.3.4.2.3.2.cmml">j</mi><mo id="S3.E3.m1.3.3.3.4.2.3.1" xref="S3.E3.m1.3.3.3.4.2.3.1.cmml">=</mo><mn id="S3.E3.m1.3.3.3.4.2.3.3" xref="S3.E3.m1.3.3.3.4.2.3.3.cmml">1</mn></mrow><mi id="S3.E3.m1.3.3.3.4.3" xref="S3.E3.m1.3.3.3.4.3.cmml">m</mi></msubsup><mrow id="S3.E3.m1.3.3.3.3" xref="S3.E3.m1.3.3.3.3.cmml"><msub id="S3.E3.m1.3.3.3.3.3" xref="S3.E3.m1.3.3.3.3.3.cmml"><mn id="S3.E3.m1.3.3.3.3.3.2" xref="S3.E3.m1.3.3.3.3.3.2.cmml">𝟏</mn><mrow id="S3.E3.m1.3.3.3.3.3.3" xref="S3.E3.m1.3.3.3.3.3.3.cmml"><msub id="S3.E3.m1.3.3.3.3.3.3.2" xref="S3.E3.m1.3.3.3.3.3.3.2.cmml"><mtext id="S3.E3.m1.3.3.3.3.3.3.2.2" xref="S3.E3.m1.3.3.3.3.3.3.2.2a.cmml">SNR</mtext><mi id="S3.E3.m1.3.3.3.3.3.3.2.3" xref="S3.E3.m1.3.3.3.3.3.3.2.3.cmml">j</mi></msub><mo id="S3.E3.m1.3.3.3.3.3.3.1" xref="S3.E3.m1.3.3.3.3.3.3.1.cmml">&lt;</mo><mi id="S3.E3.m1.3.3.3.3.3.3.3" xref="S3.E3.m1.3.3.3.3.3.3.3.cmml">σ</mi></mrow></msub><mo id="S3.E3.m1.3.3.3.3.2" xref="S3.E3.m1.3.3.3.3.2.cmml">⁢</mo><mrow id="S3.E3.m1.3.3.3.3.1" xref="S3.E3.m1.3.3.3.3.1.cmml"><msubsup id="S3.E3.m1.3.3.3.3.1.2" xref="S3.E3.m1.3.3.3.3.1.2.cmml"><mo id="S3.E3.m1.3.3.3.3.1.2.2.2" xref="S3.E3.m1.3.3.3.3.1.2.2.2.cmml">∑</mo><mrow id="S3.E3.m1.3.3.3.3.1.2.2.3" xref="S3.E3.m1.3.3.3.3.1.2.2.3.cmml"><mi id="S3.E3.m1.3.3.3.3.1.2.2.3.2" xref="S3.E3.m1.3.3.3.3.1.2.2.3.2.cmml">i</mi><mo id="S3.E3.m1.3.3.3.3.1.2.2.3.1" xref="S3.E3.m1.3.3.3.3.1.2.2.3.1.cmml">=</mo><mn id="S3.E3.m1.3.3.3.3.1.2.2.3.3" xref="S3.E3.m1.3.3.3.3.1.2.2.3.3.cmml">1</mn></mrow><msub id="S3.E3.m1.3.3.3.3.1.2.3" xref="S3.E3.m1.3.3.3.3.1.2.3.cmml"><mi id="S3.E3.m1.3.3.3.3.1.2.3.2" xref="S3.E3.m1.3.3.3.3.1.2.3.2.cmml">n</mi><mi id="S3.E3.m1.3.3.3.3.1.2.3.3" xref="S3.E3.m1.3.3.3.3.1.2.3.3.cmml">j</mi></msub></msubsup><mrow id="S3.E3.m1.3.3.3.3.1.1" xref="S3.E3.m1.3.3.3.3.1.1.cmml"><mi id="S3.E3.m1.3.3.3.3.1.1.3" xref="S3.E3.m1.3.3.3.3.1.1.3.cmml">I</mi><mo id="S3.E3.m1.3.3.3.3.1.1.2" xref="S3.E3.m1.3.3.3.3.1.1.2.cmml">⁢</mo><mrow id="S3.E3.m1.3.3.3.3.1.1.1.1" xref="S3.E3.m1.3.3.3.3.1.1.1.1.1.cmml"><mo id="S3.E3.m1.3.3.3.3.1.1.1.1.2" stretchy="false" xref="S3.E3.m1.3.3.3.3.1.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.3.3.3.3.1.1.1.1.1" xref="S3.E3.m1.3.3.3.3.1.1.1.1.1.cmml"><msub id="S3.E3.m1.3.3.3.3.1.1.1.1.1.4" xref="S3.E3.m1.3.3.3.3.1.1.1.1.1.4.cmml"><mi id="S3.E3.m1.3.3.3.3.1.1.1.1.1.4.2" xref="S3.E3.m1.3.3.3.3.1.1.1.1.1.4.2.cmml">x</mi><mrow id="S3.E3.m1.3.3.3.3.1.1.1.1.1.4.3" xref="S3.E3.m1.3.3.3.3.1.1.1.1.1.4.3.cmml"><mi id="S3.E3.m1.3.3.3.3.1.1.1.1.1.4.3.2" xref="S3.E3.m1.3.3.3.3.1.1.1.1.1.4.3.2.cmml">i</mi><mo id="S3.E3.m1.3.3.3.3.1.1.1.1.1.4.3.1" xref="S3.E3.m1.3.3.3.3.1.1.1.1.1.4.3.1.cmml">⁢</mo><mi id="S3.E3.m1.3.3.3.3.1.1.1.1.1.4.3.3" xref="S3.E3.m1.3.3.3.3.1.1.1.1.1.4.3.3.cmml">j</mi></mrow></msub><mo fence="false" id="S3.E3.m1.3.3.3.3.1.1.1.1.1.3" xref="S3.E3.m1.3.3.3.3.1.1.1.1.1.3.cmml">|</mo><mrow id="S3.E3.m1.3.3.3.3.1.1.1.1.1.2.2" xref="S3.E3.m1.3.3.3.3.1.1.1.1.1.2.3.cmml"><msub id="S3.E3.m1.3.3.3.3.1.1.1.1.1.1.1.1" xref="S3.E3.m1.3.3.3.3.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.3.3.3.3.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.3.3.3.3.1.1.1.1.1.1.1.1.2.cmml">x</mi><mrow id="S3.E3.m1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.cmml"><mrow id="S3.E3.m1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E3.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E3.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.2.cmml">i</mi><mo id="S3.E3.m1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mn id="S3.E3.m1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.E3.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E3.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E3.m1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S3.E3.m1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.3.cmml">j</mi></mrow></msub><mo id="S3.E3.m1.3.3.3.3.1.1.1.1.1.2.2.3" xref="S3.E3.m1.3.3.3.3.1.1.1.1.1.2.3.cmml">,</mo><mi id="S3.E3.m1.2.2.2.2" mathvariant="normal" xref="S3.E3.m1.2.2.2.2.cmml">…</mi><mo id="S3.E3.m1.3.3.3.3.1.1.1.1.1.2.2.4" xref="S3.E3.m1.3.3.3.3.1.1.1.1.1.2.3.cmml">,</mo><msub id="S3.E3.m1.3.3.3.3.1.1.1.1.1.2.2.2" xref="S3.E3.m1.3.3.3.3.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E3.m1.3.3.3.3.1.1.1.1.1.2.2.2.2" xref="S3.E3.m1.3.3.3.3.1.1.1.1.1.2.2.2.2.cmml">x</mi><mrow id="S3.E3.m1.3.3.3.3.1.1.1.1.1.2.2.2.3" xref="S3.E3.m1.3.3.3.3.1.1.1.1.1.2.2.2.3.cmml"><mn id="S3.E3.m1.3.3.3.3.1.1.1.1.1.2.2.2.3.2" xref="S3.E3.m1.3.3.3.3.1.1.1.1.1.2.2.2.3.2.cmml">0</mn><mo id="S3.E3.m1.3.3.3.3.1.1.1.1.1.2.2.2.3.1" xref="S3.E3.m1.3.3.3.3.1.1.1.1.1.2.2.2.3.1.cmml">⁢</mo><mi id="S3.E3.m1.3.3.3.3.1.1.1.1.1.2.2.2.3.3" xref="S3.E3.m1.3.3.3.3.1.1.1.1.1.2.2.2.3.3.cmml">j</mi></mrow></msub></mrow></mrow><mo id="S3.E3.m1.3.3.3.3.1.1.1.1.3" stretchy="false" xref="S3.E3.m1.3.3.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mrow id="S3.E3.m1.3.3.5" xref="S3.E3.m1.3.3.5.cmml"><msubsup id="S3.E3.m1.3.3.5.1" xref="S3.E3.m1.3.3.5.1.cmml"><mo id="S3.E3.m1.3.3.5.1.2.2" xref="S3.E3.m1.3.3.5.1.2.2.cmml">∑</mo><mrow id="S3.E3.m1.3.3.5.1.2.3" xref="S3.E3.m1.3.3.5.1.2.3.cmml"><mi id="S3.E3.m1.3.3.5.1.2.3.2" xref="S3.E3.m1.3.3.5.1.2.3.2.cmml">j</mi><mo id="S3.E3.m1.3.3.5.1.2.3.1" xref="S3.E3.m1.3.3.5.1.2.3.1.cmml">=</mo><mn id="S3.E3.m1.3.3.5.1.2.3.3" xref="S3.E3.m1.3.3.5.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E3.m1.3.3.5.1.3" xref="S3.E3.m1.3.3.5.1.3.cmml">m</mi></msubsup><mrow id="S3.E3.m1.3.3.5.2" xref="S3.E3.m1.3.3.5.2.cmml"><msub id="S3.E3.m1.3.3.5.2.2" xref="S3.E3.m1.3.3.5.2.2.cmml"><mn id="S3.E3.m1.3.3.5.2.2.2" xref="S3.E3.m1.3.3.5.2.2.2.cmml">𝟏</mn><mrow id="S3.E3.m1.3.3.5.2.2.3" xref="S3.E3.m1.3.3.5.2.2.3.cmml"><msub id="S3.E3.m1.3.3.5.2.2.3.2" xref="S3.E3.m1.3.3.5.2.2.3.2.cmml"><mtext id="S3.E3.m1.3.3.5.2.2.3.2.2" xref="S3.E3.m1.3.3.5.2.2.3.2.2a.cmml">SNR</mtext><mi id="S3.E3.m1.3.3.5.2.2.3.2.3" xref="S3.E3.m1.3.3.5.2.2.3.2.3.cmml">j</mi></msub><mo id="S3.E3.m1.3.3.5.2.2.3.1" xref="S3.E3.m1.3.3.5.2.2.3.1.cmml">&lt;</mo><mi id="S3.E3.m1.3.3.5.2.2.3.3" xref="S3.E3.m1.3.3.5.2.2.3.3.cmml">σ</mi></mrow></msub><mo id="S3.E3.m1.3.3.5.2.1" xref="S3.E3.m1.3.3.5.2.1.cmml">⁢</mo><msub id="S3.E3.m1.3.3.5.2.3" xref="S3.E3.m1.3.3.5.2.3.cmml"><mi id="S3.E3.m1.3.3.5.2.3.2" xref="S3.E3.m1.3.3.5.2.3.2.cmml">n</mi><mi id="S3.E3.m1.3.3.5.2.3.3" xref="S3.E3.m1.3.3.5.2.3.3.cmml">j</mi></msub></mrow></mrow></mfrac></mrow><mo id="S3.E3.m1.5.5.1.2" xref="S3.E3.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.5b"><apply id="S3.E3.m1.5.5.1.1.cmml" xref="S3.E3.m1.5.5.1"><eq id="S3.E3.m1.5.5.1.1.1.cmml" xref="S3.E3.m1.5.5.1.1.1"></eq><apply id="S3.E3.m1.5.5.1.1.2.cmml" xref="S3.E3.m1.5.5.1.1.2"><times id="S3.E3.m1.5.5.1.1.2.1.cmml" xref="S3.E3.m1.5.5.1.1.2.1"></times><ci id="S3.E3.m1.5.5.1.1.2.2a.cmml" xref="S3.E3.m1.5.5.1.1.2.2"><mtext class="ltx_mathvariant_italic" id="S3.E3.m1.5.5.1.1.2.2.cmml" xref="S3.E3.m1.5.5.1.1.2.2">SU</mtext></ci><ci id="S3.E3.m1.4.4.cmml" xref="S3.E3.m1.4.4">𝑥</ci></apply><apply id="S3.E3.m1.3.3.cmml" xref="S3.E3.m1.3.3"><divide id="S3.E3.m1.3.3.4.cmml" xref="S3.E3.m1.3.3"></divide><apply id="S3.E3.m1.3.3.3.cmml" xref="S3.E3.m1.3.3.3"><apply id="S3.E3.m1.3.3.3.4.cmml" xref="S3.E3.m1.3.3.3.4"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.3.4.1.cmml" xref="S3.E3.m1.3.3.3.4">superscript</csymbol><apply id="S3.E3.m1.3.3.3.4.2.cmml" xref="S3.E3.m1.3.3.3.4"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.3.4.2.1.cmml" xref="S3.E3.m1.3.3.3.4">subscript</csymbol><sum id="S3.E3.m1.3.3.3.4.2.2.cmml" xref="S3.E3.m1.3.3.3.4.2.2"></sum><apply id="S3.E3.m1.3.3.3.4.2.3.cmml" xref="S3.E3.m1.3.3.3.4.2.3"><eq id="S3.E3.m1.3.3.3.4.2.3.1.cmml" xref="S3.E3.m1.3.3.3.4.2.3.1"></eq><ci id="S3.E3.m1.3.3.3.4.2.3.2.cmml" xref="S3.E3.m1.3.3.3.4.2.3.2">𝑗</ci><cn id="S3.E3.m1.3.3.3.4.2.3.3.cmml" type="integer" xref="S3.E3.m1.3.3.3.4.2.3.3">1</cn></apply></apply><ci id="S3.E3.m1.3.3.3.4.3.cmml" xref="S3.E3.m1.3.3.3.4.3">𝑚</ci></apply><apply id="S3.E3.m1.3.3.3.3.cmml" xref="S3.E3.m1.3.3.3.3"><times id="S3.E3.m1.3.3.3.3.2.cmml" xref="S3.E3.m1.3.3.3.3.2"></times><apply id="S3.E3.m1.3.3.3.3.3.cmml" xref="S3.E3.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.3.3.3.1.cmml" xref="S3.E3.m1.3.3.3.3.3">subscript</csymbol><cn id="S3.E3.m1.3.3.3.3.3.2.cmml" type="integer" xref="S3.E3.m1.3.3.3.3.3.2">1</cn><apply id="S3.E3.m1.3.3.3.3.3.3.cmml" xref="S3.E3.m1.3.3.3.3.3.3"><lt id="S3.E3.m1.3.3.3.3.3.3.1.cmml" xref="S3.E3.m1.3.3.3.3.3.3.1"></lt><apply id="S3.E3.m1.3.3.3.3.3.3.2.cmml" xref="S3.E3.m1.3.3.3.3.3.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.3.3.3.3.2.1.cmml" xref="S3.E3.m1.3.3.3.3.3.3.2">subscript</csymbol><ci id="S3.E3.m1.3.3.3.3.3.3.2.2a.cmml" xref="S3.E3.m1.3.3.3.3.3.3.2.2"><mtext id="S3.E3.m1.3.3.3.3.3.3.2.2.cmml" mathsize="70%" xref="S3.E3.m1.3.3.3.3.3.3.2.2">SNR</mtext></ci><ci id="S3.E3.m1.3.3.3.3.3.3.2.3.cmml" xref="S3.E3.m1.3.3.3.3.3.3.2.3">𝑗</ci></apply><ci id="S3.E3.m1.3.3.3.3.3.3.3.cmml" xref="S3.E3.m1.3.3.3.3.3.3.3">𝜎</ci></apply></apply><apply id="S3.E3.m1.3.3.3.3.1.cmml" xref="S3.E3.m1.3.3.3.3.1"><apply id="S3.E3.m1.3.3.3.3.1.2.cmml" xref="S3.E3.m1.3.3.3.3.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.3.3.1.2.1.cmml" xref="S3.E3.m1.3.3.3.3.1.2">superscript</csymbol><apply id="S3.E3.m1.3.3.3.3.1.2.2.cmml" xref="S3.E3.m1.3.3.3.3.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.3.3.1.2.2.1.cmml" xref="S3.E3.m1.3.3.3.3.1.2">subscript</csymbol><sum id="S3.E3.m1.3.3.3.3.1.2.2.2.cmml" xref="S3.E3.m1.3.3.3.3.1.2.2.2"></sum><apply id="S3.E3.m1.3.3.3.3.1.2.2.3.cmml" xref="S3.E3.m1.3.3.3.3.1.2.2.3"><eq id="S3.E3.m1.3.3.3.3.1.2.2.3.1.cmml" xref="S3.E3.m1.3.3.3.3.1.2.2.3.1"></eq><ci id="S3.E3.m1.3.3.3.3.1.2.2.3.2.cmml" xref="S3.E3.m1.3.3.3.3.1.2.2.3.2">𝑖</ci><cn id="S3.E3.m1.3.3.3.3.1.2.2.3.3.cmml" type="integer" xref="S3.E3.m1.3.3.3.3.1.2.2.3.3">1</cn></apply></apply><apply id="S3.E3.m1.3.3.3.3.1.2.3.cmml" xref="S3.E3.m1.3.3.3.3.1.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.3.3.1.2.3.1.cmml" xref="S3.E3.m1.3.3.3.3.1.2.3">subscript</csymbol><ci id="S3.E3.m1.3.3.3.3.1.2.3.2.cmml" xref="S3.E3.m1.3.3.3.3.1.2.3.2">𝑛</ci><ci id="S3.E3.m1.3.3.3.3.1.2.3.3.cmml" xref="S3.E3.m1.3.3.3.3.1.2.3.3">𝑗</ci></apply></apply><apply id="S3.E3.m1.3.3.3.3.1.1.cmml" xref="S3.E3.m1.3.3.3.3.1.1"><times id="S3.E3.m1.3.3.3.3.1.1.2.cmml" xref="S3.E3.m1.3.3.3.3.1.1.2"></times><ci id="S3.E3.m1.3.3.3.3.1.1.3.cmml" xref="S3.E3.m1.3.3.3.3.1.1.3">𝐼</ci><apply id="S3.E3.m1.3.3.3.3.1.1.1.1.1.cmml" xref="S3.E3.m1.3.3.3.3.1.1.1.1"><csymbol cd="latexml" id="S3.E3.m1.3.3.3.3.1.1.1.1.1.3.cmml" xref="S3.E3.m1.3.3.3.3.1.1.1.1.1.3">conditional</csymbol><apply id="S3.E3.m1.3.3.3.3.1.1.1.1.1.4.cmml" xref="S3.E3.m1.3.3.3.3.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.3.3.1.1.1.1.1.4.1.cmml" xref="S3.E3.m1.3.3.3.3.1.1.1.1.1.4">subscript</csymbol><ci id="S3.E3.m1.3.3.3.3.1.1.1.1.1.4.2.cmml" xref="S3.E3.m1.3.3.3.3.1.1.1.1.1.4.2">𝑥</ci><apply id="S3.E3.m1.3.3.3.3.1.1.1.1.1.4.3.cmml" xref="S3.E3.m1.3.3.3.3.1.1.1.1.1.4.3"><times id="S3.E3.m1.3.3.3.3.1.1.1.1.1.4.3.1.cmml" xref="S3.E3.m1.3.3.3.3.1.1.1.1.1.4.3.1"></times><ci id="S3.E3.m1.3.3.3.3.1.1.1.1.1.4.3.2.cmml" xref="S3.E3.m1.3.3.3.3.1.1.1.1.1.4.3.2">𝑖</ci><ci id="S3.E3.m1.3.3.3.3.1.1.1.1.1.4.3.3.cmml" xref="S3.E3.m1.3.3.3.3.1.1.1.1.1.4.3.3">𝑗</ci></apply></apply><list id="S3.E3.m1.3.3.3.3.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.3.3.3.3.1.1.1.1.1.2.2"><apply id="S3.E3.m1.3.3.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.3.3.3.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.3.3.3.3.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.3.3.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.3.3.3.3.1.1.1.1.1.1.1.1.2">𝑥</ci><apply id="S3.E3.m1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1"><times id="S3.E3.m1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.2"></times><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1"><minus id="S3.E3.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1"></minus><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.2">𝑖</ci><cn id="S3.E3.m1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3">1</cn></apply><ci id="S3.E3.m1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.3">𝑗</ci></apply></apply><ci id="S3.E3.m1.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2">…</ci><apply id="S3.E3.m1.3.3.3.3.1.1.1.1.1.2.2.2.cmml" xref="S3.E3.m1.3.3.3.3.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.3.3.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E3.m1.3.3.3.3.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E3.m1.3.3.3.3.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E3.m1.3.3.3.3.1.1.1.1.1.2.2.2.2">𝑥</ci><apply id="S3.E3.m1.3.3.3.3.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E3.m1.3.3.3.3.1.1.1.1.1.2.2.2.3"><times id="S3.E3.m1.3.3.3.3.1.1.1.1.1.2.2.2.3.1.cmml" xref="S3.E3.m1.3.3.3.3.1.1.1.1.1.2.2.2.3.1"></times><cn id="S3.E3.m1.3.3.3.3.1.1.1.1.1.2.2.2.3.2.cmml" type="integer" xref="S3.E3.m1.3.3.3.3.1.1.1.1.1.2.2.2.3.2">0</cn><ci id="S3.E3.m1.3.3.3.3.1.1.1.1.1.2.2.2.3.3.cmml" xref="S3.E3.m1.3.3.3.3.1.1.1.1.1.2.2.2.3.3">𝑗</ci></apply></apply></list></apply></apply></apply></apply></apply><apply id="S3.E3.m1.3.3.5.cmml" xref="S3.E3.m1.3.3.5"><apply id="S3.E3.m1.3.3.5.1.cmml" xref="S3.E3.m1.3.3.5.1"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.5.1.1.cmml" xref="S3.E3.m1.3.3.5.1">superscript</csymbol><apply id="S3.E3.m1.3.3.5.1.2.cmml" xref="S3.E3.m1.3.3.5.1"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.5.1.2.1.cmml" xref="S3.E3.m1.3.3.5.1">subscript</csymbol><sum id="S3.E3.m1.3.3.5.1.2.2.cmml" xref="S3.E3.m1.3.3.5.1.2.2"></sum><apply id="S3.E3.m1.3.3.5.1.2.3.cmml" xref="S3.E3.m1.3.3.5.1.2.3"><eq id="S3.E3.m1.3.3.5.1.2.3.1.cmml" xref="S3.E3.m1.3.3.5.1.2.3.1"></eq><ci id="S3.E3.m1.3.3.5.1.2.3.2.cmml" xref="S3.E3.m1.3.3.5.1.2.3.2">𝑗</ci><cn id="S3.E3.m1.3.3.5.1.2.3.3.cmml" type="integer" xref="S3.E3.m1.3.3.5.1.2.3.3">1</cn></apply></apply><ci id="S3.E3.m1.3.3.5.1.3.cmml" xref="S3.E3.m1.3.3.5.1.3">𝑚</ci></apply><apply id="S3.E3.m1.3.3.5.2.cmml" xref="S3.E3.m1.3.3.5.2"><times id="S3.E3.m1.3.3.5.2.1.cmml" xref="S3.E3.m1.3.3.5.2.1"></times><apply id="S3.E3.m1.3.3.5.2.2.cmml" xref="S3.E3.m1.3.3.5.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.5.2.2.1.cmml" xref="S3.E3.m1.3.3.5.2.2">subscript</csymbol><cn id="S3.E3.m1.3.3.5.2.2.2.cmml" type="integer" xref="S3.E3.m1.3.3.5.2.2.2">1</cn><apply id="S3.E3.m1.3.3.5.2.2.3.cmml" xref="S3.E3.m1.3.3.5.2.2.3"><lt id="S3.E3.m1.3.3.5.2.2.3.1.cmml" xref="S3.E3.m1.3.3.5.2.2.3.1"></lt><apply id="S3.E3.m1.3.3.5.2.2.3.2.cmml" xref="S3.E3.m1.3.3.5.2.2.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.5.2.2.3.2.1.cmml" xref="S3.E3.m1.3.3.5.2.2.3.2">subscript</csymbol><ci id="S3.E3.m1.3.3.5.2.2.3.2.2a.cmml" xref="S3.E3.m1.3.3.5.2.2.3.2.2"><mtext id="S3.E3.m1.3.3.5.2.2.3.2.2.cmml" mathsize="70%" xref="S3.E3.m1.3.3.5.2.2.3.2.2">SNR</mtext></ci><ci id="S3.E3.m1.3.3.5.2.2.3.2.3.cmml" xref="S3.E3.m1.3.3.5.2.2.3.2.3">𝑗</ci></apply><ci id="S3.E3.m1.3.3.5.2.2.3.3.cmml" xref="S3.E3.m1.3.3.5.2.2.3.3">𝜎</ci></apply></apply><apply id="S3.E3.m1.3.3.5.2.3.cmml" xref="S3.E3.m1.3.3.5.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.5.2.3.1.cmml" xref="S3.E3.m1.3.3.5.2.3">subscript</csymbol><ci id="S3.E3.m1.3.3.5.2.3.2.cmml" xref="S3.E3.m1.3.3.5.2.3.2">𝑛</ci><ci id="S3.E3.m1.3.3.5.2.3.3.cmml" xref="S3.E3.m1.3.3.5.2.3.3">𝑗</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.5c">\textit{SU}(x)=\frac{\sum_{j=1}^{m}\mathbf{1}_{\text{SNR}_{j}&lt;\sigma}\sum_{i=1%
}^{n_{j}}I(x_{ij}|x_{(i-1)j},\dots,x_{0j})}{\sum_{j=1}^{m}\mathbf{1}_{\text{%
SNR}_{j}&lt;\sigma}\,n_{j}},</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.5d">SU ( italic_x ) = divide start_ARG ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT bold_1 start_POSTSUBSCRIPT SNR start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT &lt; italic_σ end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUPERSCRIPT italic_I ( italic_x start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT | italic_x start_POSTSUBSCRIPT ( italic_i - 1 ) italic_j end_POSTSUBSCRIPT , … , italic_x start_POSTSUBSCRIPT 0 italic_j end_POSTSUBSCRIPT ) end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT bold_1 start_POSTSUBSCRIPT SNR start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT &lt; italic_σ end_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p5">
<p class="ltx_p" id="S3.SS1.p5.7">where <math alttext="\mathbf{1}_{\text{SNR}_{j}&lt;\sigma}" class="ltx_Math" display="inline" id="S3.SS1.p5.1.m1.1"><semantics id="S3.SS1.p5.1.m1.1a"><msub id="S3.SS1.p5.1.m1.1.1" xref="S3.SS1.p5.1.m1.1.1.cmml"><mn id="S3.SS1.p5.1.m1.1.1.2" xref="S3.SS1.p5.1.m1.1.1.2.cmml">𝟏</mn><mrow id="S3.SS1.p5.1.m1.1.1.3" xref="S3.SS1.p5.1.m1.1.1.3.cmml"><msub id="S3.SS1.p5.1.m1.1.1.3.2" xref="S3.SS1.p5.1.m1.1.1.3.2.cmml"><mtext id="S3.SS1.p5.1.m1.1.1.3.2.2" xref="S3.SS1.p5.1.m1.1.1.3.2.2a.cmml">SNR</mtext><mi id="S3.SS1.p5.1.m1.1.1.3.2.3" xref="S3.SS1.p5.1.m1.1.1.3.2.3.cmml">j</mi></msub><mo id="S3.SS1.p5.1.m1.1.1.3.1" xref="S3.SS1.p5.1.m1.1.1.3.1.cmml">&lt;</mo><mi id="S3.SS1.p5.1.m1.1.1.3.3" xref="S3.SS1.p5.1.m1.1.1.3.3.cmml">σ</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.1.m1.1b"><apply id="S3.SS1.p5.1.m1.1.1.cmml" xref="S3.SS1.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p5.1.m1.1.1.1.cmml" xref="S3.SS1.p5.1.m1.1.1">subscript</csymbol><cn id="S3.SS1.p5.1.m1.1.1.2.cmml" type="integer" xref="S3.SS1.p5.1.m1.1.1.2">1</cn><apply id="S3.SS1.p5.1.m1.1.1.3.cmml" xref="S3.SS1.p5.1.m1.1.1.3"><lt id="S3.SS1.p5.1.m1.1.1.3.1.cmml" xref="S3.SS1.p5.1.m1.1.1.3.1"></lt><apply id="S3.SS1.p5.1.m1.1.1.3.2.cmml" xref="S3.SS1.p5.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS1.p5.1.m1.1.1.3.2.1.cmml" xref="S3.SS1.p5.1.m1.1.1.3.2">subscript</csymbol><ci id="S3.SS1.p5.1.m1.1.1.3.2.2a.cmml" xref="S3.SS1.p5.1.m1.1.1.3.2.2"><mtext id="S3.SS1.p5.1.m1.1.1.3.2.2.cmml" mathsize="70%" xref="S3.SS1.p5.1.m1.1.1.3.2.2">SNR</mtext></ci><ci id="S3.SS1.p5.1.m1.1.1.3.2.3.cmml" xref="S3.SS1.p5.1.m1.1.1.3.2.3">𝑗</ci></apply><ci id="S3.SS1.p5.1.m1.1.1.3.3.cmml" xref="S3.SS1.p5.1.m1.1.1.3.3">𝜎</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.1.m1.1c">\mathbf{1}_{\text{SNR}_{j}&lt;\sigma}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p5.1.m1.1d">bold_1 start_POSTSUBSCRIPT SNR start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT &lt; italic_σ end_POSTSUBSCRIPT</annotation></semantics></math> is an indicator function that equals 1 when the SNR of the <math alttext="j" class="ltx_Math" display="inline" id="S3.SS1.p5.2.m2.1"><semantics id="S3.SS1.p5.2.m2.1a"><mi id="S3.SS1.p5.2.m2.1.1" xref="S3.SS1.p5.2.m2.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.2.m2.1b"><ci id="S3.SS1.p5.2.m2.1.1.cmml" xref="S3.SS1.p5.2.m2.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.2.m2.1c">j</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p5.2.m2.1d">italic_j</annotation></semantics></math>-th window is below the threshold <math alttext="\sigma" class="ltx_Math" display="inline" id="S3.SS1.p5.3.m3.1"><semantics id="S3.SS1.p5.3.m3.1a"><mi id="S3.SS1.p5.3.m3.1.1" xref="S3.SS1.p5.3.m3.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.3.m3.1b"><ci id="S3.SS1.p5.3.m3.1.1.cmml" xref="S3.SS1.p5.3.m3.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.3.m3.1c">\sigma</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p5.3.m3.1d">italic_σ</annotation></semantics></math>, and 0 otherwise. <math alttext="n_{j}" class="ltx_Math" display="inline" id="S3.SS1.p5.4.m4.1"><semantics id="S3.SS1.p5.4.m4.1a"><msub id="S3.SS1.p5.4.m4.1.1" xref="S3.SS1.p5.4.m4.1.1.cmml"><mi id="S3.SS1.p5.4.m4.1.1.2" xref="S3.SS1.p5.4.m4.1.1.2.cmml">n</mi><mi id="S3.SS1.p5.4.m4.1.1.3" xref="S3.SS1.p5.4.m4.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.4.m4.1b"><apply id="S3.SS1.p5.4.m4.1.1.cmml" xref="S3.SS1.p5.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p5.4.m4.1.1.1.cmml" xref="S3.SS1.p5.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.p5.4.m4.1.1.2.cmml" xref="S3.SS1.p5.4.m4.1.1.2">𝑛</ci><ci id="S3.SS1.p5.4.m4.1.1.3.cmml" xref="S3.SS1.p5.4.m4.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.4.m4.1c">n_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p5.4.m4.1d">italic_n start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> represents the number of tokens in the <math alttext="j" class="ltx_Math" display="inline" id="S3.SS1.p5.5.m5.1"><semantics id="S3.SS1.p5.5.m5.1a"><mi id="S3.SS1.p5.5.m5.1.1" xref="S3.SS1.p5.5.m5.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.5.m5.1b"><ci id="S3.SS1.p5.5.m5.1.1.cmml" xref="S3.SS1.p5.5.m5.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.5.m5.1c">j</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p5.5.m5.1d">italic_j</annotation></semantics></math>-th window, and <math alttext="I(x_{ij}|x_{(i-1)j},\dots,x_{0j})" class="ltx_Math" display="inline" id="S3.SS1.p5.6.m6.3"><semantics id="S3.SS1.p5.6.m6.3a"><mrow id="S3.SS1.p5.6.m6.3.3" xref="S3.SS1.p5.6.m6.3.3.cmml"><mi id="S3.SS1.p5.6.m6.3.3.3" xref="S3.SS1.p5.6.m6.3.3.3.cmml">I</mi><mo id="S3.SS1.p5.6.m6.3.3.2" xref="S3.SS1.p5.6.m6.3.3.2.cmml">⁢</mo><mrow id="S3.SS1.p5.6.m6.3.3.1.1" xref="S3.SS1.p5.6.m6.3.3.1.1.1.cmml"><mo id="S3.SS1.p5.6.m6.3.3.1.1.2" stretchy="false" xref="S3.SS1.p5.6.m6.3.3.1.1.1.cmml">(</mo><mrow id="S3.SS1.p5.6.m6.3.3.1.1.1" xref="S3.SS1.p5.6.m6.3.3.1.1.1.cmml"><msub id="S3.SS1.p5.6.m6.3.3.1.1.1.4" xref="S3.SS1.p5.6.m6.3.3.1.1.1.4.cmml"><mi id="S3.SS1.p5.6.m6.3.3.1.1.1.4.2" xref="S3.SS1.p5.6.m6.3.3.1.1.1.4.2.cmml">x</mi><mrow id="S3.SS1.p5.6.m6.3.3.1.1.1.4.3" xref="S3.SS1.p5.6.m6.3.3.1.1.1.4.3.cmml"><mi id="S3.SS1.p5.6.m6.3.3.1.1.1.4.3.2" xref="S3.SS1.p5.6.m6.3.3.1.1.1.4.3.2.cmml">i</mi><mo id="S3.SS1.p5.6.m6.3.3.1.1.1.4.3.1" xref="S3.SS1.p5.6.m6.3.3.1.1.1.4.3.1.cmml">⁢</mo><mi id="S3.SS1.p5.6.m6.3.3.1.1.1.4.3.3" xref="S3.SS1.p5.6.m6.3.3.1.1.1.4.3.3.cmml">j</mi></mrow></msub><mo fence="false" id="S3.SS1.p5.6.m6.3.3.1.1.1.3" xref="S3.SS1.p5.6.m6.3.3.1.1.1.3.cmml">|</mo><mrow id="S3.SS1.p5.6.m6.3.3.1.1.1.2.2" xref="S3.SS1.p5.6.m6.3.3.1.1.1.2.3.cmml"><msub id="S3.SS1.p5.6.m6.3.3.1.1.1.1.1.1" xref="S3.SS1.p5.6.m6.3.3.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p5.6.m6.3.3.1.1.1.1.1.1.2" xref="S3.SS1.p5.6.m6.3.3.1.1.1.1.1.1.2.cmml">x</mi><mrow id="S3.SS1.p5.6.m6.1.1.1" xref="S3.SS1.p5.6.m6.1.1.1.cmml"><mrow id="S3.SS1.p5.6.m6.1.1.1.1.1" xref="S3.SS1.p5.6.m6.1.1.1.1.1.1.cmml"><mo id="S3.SS1.p5.6.m6.1.1.1.1.1.2" stretchy="false" xref="S3.SS1.p5.6.m6.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p5.6.m6.1.1.1.1.1.1" xref="S3.SS1.p5.6.m6.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p5.6.m6.1.1.1.1.1.1.2" xref="S3.SS1.p5.6.m6.1.1.1.1.1.1.2.cmml">i</mi><mo id="S3.SS1.p5.6.m6.1.1.1.1.1.1.1" xref="S3.SS1.p5.6.m6.1.1.1.1.1.1.1.cmml">−</mo><mn id="S3.SS1.p5.6.m6.1.1.1.1.1.1.3" xref="S3.SS1.p5.6.m6.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.SS1.p5.6.m6.1.1.1.1.1.3" stretchy="false" xref="S3.SS1.p5.6.m6.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.SS1.p5.6.m6.1.1.1.2" xref="S3.SS1.p5.6.m6.1.1.1.2.cmml">⁢</mo><mi id="S3.SS1.p5.6.m6.1.1.1.3" xref="S3.SS1.p5.6.m6.1.1.1.3.cmml">j</mi></mrow></msub><mo id="S3.SS1.p5.6.m6.3.3.1.1.1.2.2.3" xref="S3.SS1.p5.6.m6.3.3.1.1.1.2.3.cmml">,</mo><mi id="S3.SS1.p5.6.m6.2.2" mathvariant="normal" xref="S3.SS1.p5.6.m6.2.2.cmml">…</mi><mo id="S3.SS1.p5.6.m6.3.3.1.1.1.2.2.4" xref="S3.SS1.p5.6.m6.3.3.1.1.1.2.3.cmml">,</mo><msub id="S3.SS1.p5.6.m6.3.3.1.1.1.2.2.2" xref="S3.SS1.p5.6.m6.3.3.1.1.1.2.2.2.cmml"><mi id="S3.SS1.p5.6.m6.3.3.1.1.1.2.2.2.2" xref="S3.SS1.p5.6.m6.3.3.1.1.1.2.2.2.2.cmml">x</mi><mrow id="S3.SS1.p5.6.m6.3.3.1.1.1.2.2.2.3" xref="S3.SS1.p5.6.m6.3.3.1.1.1.2.2.2.3.cmml"><mn id="S3.SS1.p5.6.m6.3.3.1.1.1.2.2.2.3.2" xref="S3.SS1.p5.6.m6.3.3.1.1.1.2.2.2.3.2.cmml">0</mn><mo id="S3.SS1.p5.6.m6.3.3.1.1.1.2.2.2.3.1" xref="S3.SS1.p5.6.m6.3.3.1.1.1.2.2.2.3.1.cmml">⁢</mo><mi id="S3.SS1.p5.6.m6.3.3.1.1.1.2.2.2.3.3" xref="S3.SS1.p5.6.m6.3.3.1.1.1.2.2.2.3.3.cmml">j</mi></mrow></msub></mrow></mrow><mo id="S3.SS1.p5.6.m6.3.3.1.1.3" stretchy="false" xref="S3.SS1.p5.6.m6.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.6.m6.3b"><apply id="S3.SS1.p5.6.m6.3.3.cmml" xref="S3.SS1.p5.6.m6.3.3"><times id="S3.SS1.p5.6.m6.3.3.2.cmml" xref="S3.SS1.p5.6.m6.3.3.2"></times><ci id="S3.SS1.p5.6.m6.3.3.3.cmml" xref="S3.SS1.p5.6.m6.3.3.3">𝐼</ci><apply id="S3.SS1.p5.6.m6.3.3.1.1.1.cmml" xref="S3.SS1.p5.6.m6.3.3.1.1"><csymbol cd="latexml" id="S3.SS1.p5.6.m6.3.3.1.1.1.3.cmml" xref="S3.SS1.p5.6.m6.3.3.1.1.1.3">conditional</csymbol><apply id="S3.SS1.p5.6.m6.3.3.1.1.1.4.cmml" xref="S3.SS1.p5.6.m6.3.3.1.1.1.4"><csymbol cd="ambiguous" id="S3.SS1.p5.6.m6.3.3.1.1.1.4.1.cmml" xref="S3.SS1.p5.6.m6.3.3.1.1.1.4">subscript</csymbol><ci id="S3.SS1.p5.6.m6.3.3.1.1.1.4.2.cmml" xref="S3.SS1.p5.6.m6.3.3.1.1.1.4.2">𝑥</ci><apply id="S3.SS1.p5.6.m6.3.3.1.1.1.4.3.cmml" xref="S3.SS1.p5.6.m6.3.3.1.1.1.4.3"><times id="S3.SS1.p5.6.m6.3.3.1.1.1.4.3.1.cmml" xref="S3.SS1.p5.6.m6.3.3.1.1.1.4.3.1"></times><ci id="S3.SS1.p5.6.m6.3.3.1.1.1.4.3.2.cmml" xref="S3.SS1.p5.6.m6.3.3.1.1.1.4.3.2">𝑖</ci><ci id="S3.SS1.p5.6.m6.3.3.1.1.1.4.3.3.cmml" xref="S3.SS1.p5.6.m6.3.3.1.1.1.4.3.3">𝑗</ci></apply></apply><list id="S3.SS1.p5.6.m6.3.3.1.1.1.2.3.cmml" xref="S3.SS1.p5.6.m6.3.3.1.1.1.2.2"><apply id="S3.SS1.p5.6.m6.3.3.1.1.1.1.1.1.cmml" xref="S3.SS1.p5.6.m6.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p5.6.m6.3.3.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p5.6.m6.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p5.6.m6.3.3.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p5.6.m6.3.3.1.1.1.1.1.1.2">𝑥</ci><apply id="S3.SS1.p5.6.m6.1.1.1.cmml" xref="S3.SS1.p5.6.m6.1.1.1"><times id="S3.SS1.p5.6.m6.1.1.1.2.cmml" xref="S3.SS1.p5.6.m6.1.1.1.2"></times><apply id="S3.SS1.p5.6.m6.1.1.1.1.1.1.cmml" xref="S3.SS1.p5.6.m6.1.1.1.1.1"><minus id="S3.SS1.p5.6.m6.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p5.6.m6.1.1.1.1.1.1.1"></minus><ci id="S3.SS1.p5.6.m6.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p5.6.m6.1.1.1.1.1.1.2">𝑖</ci><cn id="S3.SS1.p5.6.m6.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS1.p5.6.m6.1.1.1.1.1.1.3">1</cn></apply><ci id="S3.SS1.p5.6.m6.1.1.1.3.cmml" xref="S3.SS1.p5.6.m6.1.1.1.3">𝑗</ci></apply></apply><ci id="S3.SS1.p5.6.m6.2.2.cmml" xref="S3.SS1.p5.6.m6.2.2">…</ci><apply id="S3.SS1.p5.6.m6.3.3.1.1.1.2.2.2.cmml" xref="S3.SS1.p5.6.m6.3.3.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p5.6.m6.3.3.1.1.1.2.2.2.1.cmml" xref="S3.SS1.p5.6.m6.3.3.1.1.1.2.2.2">subscript</csymbol><ci id="S3.SS1.p5.6.m6.3.3.1.1.1.2.2.2.2.cmml" xref="S3.SS1.p5.6.m6.3.3.1.1.1.2.2.2.2">𝑥</ci><apply id="S3.SS1.p5.6.m6.3.3.1.1.1.2.2.2.3.cmml" xref="S3.SS1.p5.6.m6.3.3.1.1.1.2.2.2.3"><times id="S3.SS1.p5.6.m6.3.3.1.1.1.2.2.2.3.1.cmml" xref="S3.SS1.p5.6.m6.3.3.1.1.1.2.2.2.3.1"></times><cn id="S3.SS1.p5.6.m6.3.3.1.1.1.2.2.2.3.2.cmml" type="integer" xref="S3.SS1.p5.6.m6.3.3.1.1.1.2.2.2.3.2">0</cn><ci id="S3.SS1.p5.6.m6.3.3.1.1.1.2.2.2.3.3.cmml" xref="S3.SS1.p5.6.m6.3.3.1.1.1.2.2.2.3.3">𝑗</ci></apply></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.6.m6.3c">I(x_{ij}|x_{(i-1)j},\dots,x_{0j})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p5.6.m6.3d">italic_I ( italic_x start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT | italic_x start_POSTSUBSCRIPT ( italic_i - 1 ) italic_j end_POSTSUBSCRIPT , … , italic_x start_POSTSUBSCRIPT 0 italic_j end_POSTSUBSCRIPT )</annotation></semantics></math> denotes the self-information of token <math alttext="x_{ij}" class="ltx_Math" display="inline" id="S3.SS1.p5.7.m7.1"><semantics id="S3.SS1.p5.7.m7.1a"><msub id="S3.SS1.p5.7.m7.1.1" xref="S3.SS1.p5.7.m7.1.1.cmml"><mi id="S3.SS1.p5.7.m7.1.1.2" xref="S3.SS1.p5.7.m7.1.1.2.cmml">x</mi><mrow id="S3.SS1.p5.7.m7.1.1.3" xref="S3.SS1.p5.7.m7.1.1.3.cmml"><mi id="S3.SS1.p5.7.m7.1.1.3.2" xref="S3.SS1.p5.7.m7.1.1.3.2.cmml">i</mi><mo id="S3.SS1.p5.7.m7.1.1.3.1" xref="S3.SS1.p5.7.m7.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p5.7.m7.1.1.3.3" xref="S3.SS1.p5.7.m7.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.7.m7.1b"><apply id="S3.SS1.p5.7.m7.1.1.cmml" xref="S3.SS1.p5.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p5.7.m7.1.1.1.cmml" xref="S3.SS1.p5.7.m7.1.1">subscript</csymbol><ci id="S3.SS1.p5.7.m7.1.1.2.cmml" xref="S3.SS1.p5.7.m7.1.1.2">𝑥</ci><apply id="S3.SS1.p5.7.m7.1.1.3.cmml" xref="S3.SS1.p5.7.m7.1.1.3"><times id="S3.SS1.p5.7.m7.1.1.3.1.cmml" xref="S3.SS1.p5.7.m7.1.1.3.1"></times><ci id="S3.SS1.p5.7.m7.1.1.3.2.cmml" xref="S3.SS1.p5.7.m7.1.1.3.2">𝑖</ci><ci id="S3.SS1.p5.7.m7.1.1.3.3.cmml" xref="S3.SS1.p5.7.m7.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.7.m7.1c">x_{ij}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p5.7.m7.1d">italic_x start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math> given its preceding context. This helps in estimating the similarity between the two chunks of text by considering the uncertainty in the token sequences across those windows. Typically, the chosen token length varies with changes in the sliding window of the span.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Training Strategy</h3>
<div class="ltx_para ltx_noindent" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">In this section, we focus on how we apply span uncertainty to construct positive and negative samples for all chunks in the training dataset. We do not consider incorporating the combinations of queries and chunks into the training strategy, yet the model still performs well. Then, we introduce a strategy for scaling chunk combinations, which involves scaling chunk anchors and scaling positive and negative samples after fixing chunk anchors.</p>
</div>
<section class="ltx_subsubsection" id="S3.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.1 </span>Construction of Positive and Negative Samples</h4>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS1.p1">
<p class="ltx_p" id="S3.SS2.SSS1.p1.15">Given the limitations in inference computational efficiency, we avoid using overly complex segmentation strategies when constructing the training dataset. Instead, we uniformly set the chunk size to 300 for splitting the data. After shuffling the data, we combine each chunk with other chunks to construct a matrix <span class="ltx_text ltx_markedasmath ltx_font_italic" id="S3.SS2.SSS1.p1.15.1">S</span>. Each element <math alttext="S_{ij}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.2.m2.1"><semantics id="S3.SS2.SSS1.p1.2.m2.1a"><msub id="S3.SS2.SSS1.p1.2.m2.1.1" xref="S3.SS2.SSS1.p1.2.m2.1.1.cmml"><mi id="S3.SS2.SSS1.p1.2.m2.1.1.2" xref="S3.SS2.SSS1.p1.2.m2.1.1.2.cmml">S</mi><mrow id="S3.SS2.SSS1.p1.2.m2.1.1.3" xref="S3.SS2.SSS1.p1.2.m2.1.1.3.cmml"><mi id="S3.SS2.SSS1.p1.2.m2.1.1.3.2" xref="S3.SS2.SSS1.p1.2.m2.1.1.3.2.cmml">i</mi><mo id="S3.SS2.SSS1.p1.2.m2.1.1.3.1" xref="S3.SS2.SSS1.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.SSS1.p1.2.m2.1.1.3.3" xref="S3.SS2.SSS1.p1.2.m2.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.2.m2.1b"><apply id="S3.SS2.SSS1.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.2.m2.1.1.1.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p1.2.m2.1.1.2.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1.2">𝑆</ci><apply id="S3.SS2.SSS1.p1.2.m2.1.1.3.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1.3"><times id="S3.SS2.SSS1.p1.2.m2.1.1.3.1.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1.3.1"></times><ci id="S3.SS2.SSS1.p1.2.m2.1.1.3.2.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1.3.2">𝑖</ci><ci id="S3.SS2.SSS1.p1.2.m2.1.1.3.3.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.2.m2.1c">S_{ij}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.2.m2.1d">italic_S start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math> in this matrix represents the span uncertainty estimated when <math alttext="\text{ch}_{i}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.3.m3.1"><semantics id="S3.SS2.SSS1.p1.3.m3.1a"><msub id="S3.SS2.SSS1.p1.3.m3.1.1" xref="S3.SS2.SSS1.p1.3.m3.1.1.cmml"><mtext id="S3.SS2.SSS1.p1.3.m3.1.1.2" xref="S3.SS2.SSS1.p1.3.m3.1.1.2a.cmml">ch</mtext><mi id="S3.SS2.SSS1.p1.3.m3.1.1.3" xref="S3.SS2.SSS1.p1.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.3.m3.1b"><apply id="S3.SS2.SSS1.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.3.m3.1.1.1.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p1.3.m3.1.1.2a.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.2"><mtext id="S3.SS2.SSS1.p1.3.m3.1.1.2.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.2">ch</mtext></ci><ci id="S3.SS2.SSS1.p1.3.m3.1.1.3.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.3.m3.1c">\text{ch}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.3.m3.1d">ch start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\text{ch}_{j}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.4.m4.1"><semantics id="S3.SS2.SSS1.p1.4.m4.1a"><msub id="S3.SS2.SSS1.p1.4.m4.1.1" xref="S3.SS2.SSS1.p1.4.m4.1.1.cmml"><mtext id="S3.SS2.SSS1.p1.4.m4.1.1.2" xref="S3.SS2.SSS1.p1.4.m4.1.1.2a.cmml">ch</mtext><mi id="S3.SS2.SSS1.p1.4.m4.1.1.3" xref="S3.SS2.SSS1.p1.4.m4.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.4.m4.1b"><apply id="S3.SS2.SSS1.p1.4.m4.1.1.cmml" xref="S3.SS2.SSS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.4.m4.1.1.1.cmml" xref="S3.SS2.SSS1.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p1.4.m4.1.1.2a.cmml" xref="S3.SS2.SSS1.p1.4.m4.1.1.2"><mtext id="S3.SS2.SSS1.p1.4.m4.1.1.2.cmml" xref="S3.SS2.SSS1.p1.4.m4.1.1.2">ch</mtext></ci><ci id="S3.SS2.SSS1.p1.4.m4.1.1.3.cmml" xref="S3.SS2.SSS1.p1.4.m4.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.4.m4.1c">\text{ch}_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.4.m4.1d">ch start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> are combined sequentially and input into the LLM, indicating their degree of similirity. Due to the significant computational cost of estimating this matrix, we use BM25 <cite class="ltx_cite ltx_citemacro_citep">(Robertson et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib63" title="">2009</a>)</cite> as a score function to firstly filter <math alttext="N" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.5.m5.1"><semantics id="S3.SS2.SSS1.p1.5.m5.1a"><mi id="S3.SS2.SSS1.p1.5.m5.1.1" xref="S3.SS2.SSS1.p1.5.m5.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.5.m5.1b"><ci id="S3.SS2.SSS1.p1.5.m5.1.1.cmml" xref="S3.SS2.SSS1.p1.5.m5.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.5.m5.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.5.m5.1d">italic_N</annotation></semantics></math> samples for anchor <math alttext="i" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.6.m6.1"><semantics id="S3.SS2.SSS1.p1.6.m6.1a"><mi id="S3.SS2.SSS1.p1.6.m6.1.1" xref="S3.SS2.SSS1.p1.6.m6.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.6.m6.1b"><ci id="S3.SS2.SSS1.p1.6.m6.1.1.cmml" xref="S3.SS2.SSS1.p1.6.m6.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.6.m6.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.6.m6.1d">italic_i</annotation></semantics></math>. We denote the BM25 score for the pair as <math alttext="s_{\text{BM25}}(\text{ch}_{i},\text{ch}_{j})" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.7.m7.2"><semantics id="S3.SS2.SSS1.p1.7.m7.2a"><mrow id="S3.SS2.SSS1.p1.7.m7.2.2" xref="S3.SS2.SSS1.p1.7.m7.2.2.cmml"><msub id="S3.SS2.SSS1.p1.7.m7.2.2.4" xref="S3.SS2.SSS1.p1.7.m7.2.2.4.cmml"><mi id="S3.SS2.SSS1.p1.7.m7.2.2.4.2" xref="S3.SS2.SSS1.p1.7.m7.2.2.4.2.cmml">s</mi><mtext id="S3.SS2.SSS1.p1.7.m7.2.2.4.3" xref="S3.SS2.SSS1.p1.7.m7.2.2.4.3a.cmml">BM25</mtext></msub><mo id="S3.SS2.SSS1.p1.7.m7.2.2.3" xref="S3.SS2.SSS1.p1.7.m7.2.2.3.cmml">⁢</mo><mrow id="S3.SS2.SSS1.p1.7.m7.2.2.2.2" xref="S3.SS2.SSS1.p1.7.m7.2.2.2.3.cmml"><mo id="S3.SS2.SSS1.p1.7.m7.2.2.2.2.3" stretchy="false" xref="S3.SS2.SSS1.p1.7.m7.2.2.2.3.cmml">(</mo><msub id="S3.SS2.SSS1.p1.7.m7.1.1.1.1.1" xref="S3.SS2.SSS1.p1.7.m7.1.1.1.1.1.cmml"><mtext id="S3.SS2.SSS1.p1.7.m7.1.1.1.1.1.2" xref="S3.SS2.SSS1.p1.7.m7.1.1.1.1.1.2a.cmml">ch</mtext><mi id="S3.SS2.SSS1.p1.7.m7.1.1.1.1.1.3" xref="S3.SS2.SSS1.p1.7.m7.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS2.SSS1.p1.7.m7.2.2.2.2.4" xref="S3.SS2.SSS1.p1.7.m7.2.2.2.3.cmml">,</mo><msub id="S3.SS2.SSS1.p1.7.m7.2.2.2.2.2" xref="S3.SS2.SSS1.p1.7.m7.2.2.2.2.2.cmml"><mtext id="S3.SS2.SSS1.p1.7.m7.2.2.2.2.2.2" xref="S3.SS2.SSS1.p1.7.m7.2.2.2.2.2.2a.cmml">ch</mtext><mi id="S3.SS2.SSS1.p1.7.m7.2.2.2.2.2.3" xref="S3.SS2.SSS1.p1.7.m7.2.2.2.2.2.3.cmml">j</mi></msub><mo id="S3.SS2.SSS1.p1.7.m7.2.2.2.2.5" stretchy="false" xref="S3.SS2.SSS1.p1.7.m7.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.7.m7.2b"><apply id="S3.SS2.SSS1.p1.7.m7.2.2.cmml" xref="S3.SS2.SSS1.p1.7.m7.2.2"><times id="S3.SS2.SSS1.p1.7.m7.2.2.3.cmml" xref="S3.SS2.SSS1.p1.7.m7.2.2.3"></times><apply id="S3.SS2.SSS1.p1.7.m7.2.2.4.cmml" xref="S3.SS2.SSS1.p1.7.m7.2.2.4"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.7.m7.2.2.4.1.cmml" xref="S3.SS2.SSS1.p1.7.m7.2.2.4">subscript</csymbol><ci id="S3.SS2.SSS1.p1.7.m7.2.2.4.2.cmml" xref="S3.SS2.SSS1.p1.7.m7.2.2.4.2">𝑠</ci><ci id="S3.SS2.SSS1.p1.7.m7.2.2.4.3a.cmml" xref="S3.SS2.SSS1.p1.7.m7.2.2.4.3"><mtext id="S3.SS2.SSS1.p1.7.m7.2.2.4.3.cmml" mathsize="70%" xref="S3.SS2.SSS1.p1.7.m7.2.2.4.3">BM25</mtext></ci></apply><interval closure="open" id="S3.SS2.SSS1.p1.7.m7.2.2.2.3.cmml" xref="S3.SS2.SSS1.p1.7.m7.2.2.2.2"><apply id="S3.SS2.SSS1.p1.7.m7.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.7.m7.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.7.m7.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.7.m7.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p1.7.m7.1.1.1.1.1.2a.cmml" xref="S3.SS2.SSS1.p1.7.m7.1.1.1.1.1.2"><mtext id="S3.SS2.SSS1.p1.7.m7.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p1.7.m7.1.1.1.1.1.2">ch</mtext></ci><ci id="S3.SS2.SSS1.p1.7.m7.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p1.7.m7.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS2.SSS1.p1.7.m7.2.2.2.2.2.cmml" xref="S3.SS2.SSS1.p1.7.m7.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.7.m7.2.2.2.2.2.1.cmml" xref="S3.SS2.SSS1.p1.7.m7.2.2.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS1.p1.7.m7.2.2.2.2.2.2a.cmml" xref="S3.SS2.SSS1.p1.7.m7.2.2.2.2.2.2"><mtext id="S3.SS2.SSS1.p1.7.m7.2.2.2.2.2.2.cmml" xref="S3.SS2.SSS1.p1.7.m7.2.2.2.2.2.2">ch</mtext></ci><ci id="S3.SS2.SSS1.p1.7.m7.2.2.2.2.2.3.cmml" xref="S3.SS2.SSS1.p1.7.m7.2.2.2.2.2.3">𝑗</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.7.m7.2c">s_{\text{BM25}}(\text{ch}_{i},\text{ch}_{j})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.7.m7.2d">italic_s start_POSTSUBSCRIPT BM25 end_POSTSUBSCRIPT ( ch start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , ch start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT )</annotation></semantics></math>. We then select the <math alttext="M" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.8.m8.1"><semantics id="S3.SS2.SSS1.p1.8.m8.1a"><mi id="S3.SS2.SSS1.p1.8.m8.1.1" xref="S3.SS2.SSS1.p1.8.m8.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.8.m8.1b"><ci id="S3.SS2.SSS1.p1.8.m8.1.1.cmml" xref="S3.SS2.SSS1.p1.8.m8.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.8.m8.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.8.m8.1d">italic_M</annotation></semantics></math> samples with the highest BM25 scores for each anchor <math alttext="\text{ch}_{i}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.9.m9.1"><semantics id="S3.SS2.SSS1.p1.9.m9.1a"><msub id="S3.SS2.SSS1.p1.9.m9.1.1" xref="S3.SS2.SSS1.p1.9.m9.1.1.cmml"><mtext id="S3.SS2.SSS1.p1.9.m9.1.1.2" xref="S3.SS2.SSS1.p1.9.m9.1.1.2a.cmml">ch</mtext><mi id="S3.SS2.SSS1.p1.9.m9.1.1.3" xref="S3.SS2.SSS1.p1.9.m9.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.9.m9.1b"><apply id="S3.SS2.SSS1.p1.9.m9.1.1.cmml" xref="S3.SS2.SSS1.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.9.m9.1.1.1.cmml" xref="S3.SS2.SSS1.p1.9.m9.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p1.9.m9.1.1.2a.cmml" xref="S3.SS2.SSS1.p1.9.m9.1.1.2"><mtext id="S3.SS2.SSS1.p1.9.m9.1.1.2.cmml" xref="S3.SS2.SSS1.p1.9.m9.1.1.2">ch</mtext></ci><ci id="S3.SS2.SSS1.p1.9.m9.1.1.3.cmml" xref="S3.SS2.SSS1.p1.9.m9.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.9.m9.1c">\text{ch}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.9.m9.1d">ch start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> to estimate the <math alttext="\textit{SU}(x)" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.10.m10.1"><semantics id="S3.SS2.SSS1.p1.10.m10.1a"><mrow id="S3.SS2.SSS1.p1.10.m10.1.2" xref="S3.SS2.SSS1.p1.10.m10.1.2.cmml"><mtext class="ltx_mathvariant_italic" id="S3.SS2.SSS1.p1.10.m10.1.2.2" xref="S3.SS2.SSS1.p1.10.m10.1.2.2a.cmml">SU</mtext><mo id="S3.SS2.SSS1.p1.10.m10.1.2.1" xref="S3.SS2.SSS1.p1.10.m10.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.SSS1.p1.10.m10.1.2.3.2" xref="S3.SS2.SSS1.p1.10.m10.1.2.cmml"><mo id="S3.SS2.SSS1.p1.10.m10.1.2.3.2.1" stretchy="false" xref="S3.SS2.SSS1.p1.10.m10.1.2.cmml">(</mo><mi id="S3.SS2.SSS1.p1.10.m10.1.1" xref="S3.SS2.SSS1.p1.10.m10.1.1.cmml">x</mi><mo id="S3.SS2.SSS1.p1.10.m10.1.2.3.2.2" stretchy="false" xref="S3.SS2.SSS1.p1.10.m10.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.10.m10.1b"><apply id="S3.SS2.SSS1.p1.10.m10.1.2.cmml" xref="S3.SS2.SSS1.p1.10.m10.1.2"><times id="S3.SS2.SSS1.p1.10.m10.1.2.1.cmml" xref="S3.SS2.SSS1.p1.10.m10.1.2.1"></times><ci id="S3.SS2.SSS1.p1.10.m10.1.2.2a.cmml" xref="S3.SS2.SSS1.p1.10.m10.1.2.2"><mtext class="ltx_mathvariant_italic" id="S3.SS2.SSS1.p1.10.m10.1.2.2.cmml" xref="S3.SS2.SSS1.p1.10.m10.1.2.2">SU</mtext></ci><ci id="S3.SS2.SSS1.p1.10.m10.1.1.cmml" xref="S3.SS2.SSS1.p1.10.m10.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.10.m10.1c">\textit{SU}(x)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.10.m10.1d">SU ( italic_x )</annotation></semantics></math>, resulting in the final sparse matrix <math alttext="\hat{\textit{S}}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.11.m11.1"><semantics id="S3.SS2.SSS1.p1.11.m11.1a"><mover accent="true" id="S3.SS2.SSS1.p1.11.m11.1.1" xref="S3.SS2.SSS1.p1.11.m11.1.1.cmml"><mtext class="ltx_mathvariant_italic" id="S3.SS2.SSS1.p1.11.m11.1.1.2" xref="S3.SS2.SSS1.p1.11.m11.1.1.2a.cmml">S</mtext><mo id="S3.SS2.SSS1.p1.11.m11.1.1.1" xref="S3.SS2.SSS1.p1.11.m11.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.11.m11.1b"><apply id="S3.SS2.SSS1.p1.11.m11.1.1.cmml" xref="S3.SS2.SSS1.p1.11.m11.1.1"><ci id="S3.SS2.SSS1.p1.11.m11.1.1.1.cmml" xref="S3.SS2.SSS1.p1.11.m11.1.1.1">^</ci><ci id="S3.SS2.SSS1.p1.11.m11.1.1.2a.cmml" xref="S3.SS2.SSS1.p1.11.m11.1.1.2"><mtext class="ltx_mathvariant_italic" id="S3.SS2.SSS1.p1.11.m11.1.1.2.cmml" xref="S3.SS2.SSS1.p1.11.m11.1.1.2">S</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.11.m11.1c">\hat{\textit{S}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.11.m11.1d">over^ start_ARG S end_ARG</annotation></semantics></math>. In formulaic terms, let <math alttext="s_{\text{BM25}}(\text{ch}_{i},\text{ch}_{j})" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.12.m12.2"><semantics id="S3.SS2.SSS1.p1.12.m12.2a"><mrow id="S3.SS2.SSS1.p1.12.m12.2.2" xref="S3.SS2.SSS1.p1.12.m12.2.2.cmml"><msub id="S3.SS2.SSS1.p1.12.m12.2.2.4" xref="S3.SS2.SSS1.p1.12.m12.2.2.4.cmml"><mi id="S3.SS2.SSS1.p1.12.m12.2.2.4.2" xref="S3.SS2.SSS1.p1.12.m12.2.2.4.2.cmml">s</mi><mtext id="S3.SS2.SSS1.p1.12.m12.2.2.4.3" xref="S3.SS2.SSS1.p1.12.m12.2.2.4.3a.cmml">BM25</mtext></msub><mo id="S3.SS2.SSS1.p1.12.m12.2.2.3" xref="S3.SS2.SSS1.p1.12.m12.2.2.3.cmml">⁢</mo><mrow id="S3.SS2.SSS1.p1.12.m12.2.2.2.2" xref="S3.SS2.SSS1.p1.12.m12.2.2.2.3.cmml"><mo id="S3.SS2.SSS1.p1.12.m12.2.2.2.2.3" stretchy="false" xref="S3.SS2.SSS1.p1.12.m12.2.2.2.3.cmml">(</mo><msub id="S3.SS2.SSS1.p1.12.m12.1.1.1.1.1" xref="S3.SS2.SSS1.p1.12.m12.1.1.1.1.1.cmml"><mtext id="S3.SS2.SSS1.p1.12.m12.1.1.1.1.1.2" xref="S3.SS2.SSS1.p1.12.m12.1.1.1.1.1.2a.cmml">ch</mtext><mi id="S3.SS2.SSS1.p1.12.m12.1.1.1.1.1.3" xref="S3.SS2.SSS1.p1.12.m12.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS2.SSS1.p1.12.m12.2.2.2.2.4" xref="S3.SS2.SSS1.p1.12.m12.2.2.2.3.cmml">,</mo><msub id="S3.SS2.SSS1.p1.12.m12.2.2.2.2.2" xref="S3.SS2.SSS1.p1.12.m12.2.2.2.2.2.cmml"><mtext id="S3.SS2.SSS1.p1.12.m12.2.2.2.2.2.2" xref="S3.SS2.SSS1.p1.12.m12.2.2.2.2.2.2a.cmml">ch</mtext><mi id="S3.SS2.SSS1.p1.12.m12.2.2.2.2.2.3" xref="S3.SS2.SSS1.p1.12.m12.2.2.2.2.2.3.cmml">j</mi></msub><mo id="S3.SS2.SSS1.p1.12.m12.2.2.2.2.5" stretchy="false" xref="S3.SS2.SSS1.p1.12.m12.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.12.m12.2b"><apply id="S3.SS2.SSS1.p1.12.m12.2.2.cmml" xref="S3.SS2.SSS1.p1.12.m12.2.2"><times id="S3.SS2.SSS1.p1.12.m12.2.2.3.cmml" xref="S3.SS2.SSS1.p1.12.m12.2.2.3"></times><apply id="S3.SS2.SSS1.p1.12.m12.2.2.4.cmml" xref="S3.SS2.SSS1.p1.12.m12.2.2.4"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.12.m12.2.2.4.1.cmml" xref="S3.SS2.SSS1.p1.12.m12.2.2.4">subscript</csymbol><ci id="S3.SS2.SSS1.p1.12.m12.2.2.4.2.cmml" xref="S3.SS2.SSS1.p1.12.m12.2.2.4.2">𝑠</ci><ci id="S3.SS2.SSS1.p1.12.m12.2.2.4.3a.cmml" xref="S3.SS2.SSS1.p1.12.m12.2.2.4.3"><mtext id="S3.SS2.SSS1.p1.12.m12.2.2.4.3.cmml" mathsize="70%" xref="S3.SS2.SSS1.p1.12.m12.2.2.4.3">BM25</mtext></ci></apply><interval closure="open" id="S3.SS2.SSS1.p1.12.m12.2.2.2.3.cmml" xref="S3.SS2.SSS1.p1.12.m12.2.2.2.2"><apply id="S3.SS2.SSS1.p1.12.m12.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.12.m12.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.12.m12.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.12.m12.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p1.12.m12.1.1.1.1.1.2a.cmml" xref="S3.SS2.SSS1.p1.12.m12.1.1.1.1.1.2"><mtext id="S3.SS2.SSS1.p1.12.m12.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p1.12.m12.1.1.1.1.1.2">ch</mtext></ci><ci id="S3.SS2.SSS1.p1.12.m12.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p1.12.m12.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS2.SSS1.p1.12.m12.2.2.2.2.2.cmml" xref="S3.SS2.SSS1.p1.12.m12.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.12.m12.2.2.2.2.2.1.cmml" xref="S3.SS2.SSS1.p1.12.m12.2.2.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS1.p1.12.m12.2.2.2.2.2.2a.cmml" xref="S3.SS2.SSS1.p1.12.m12.2.2.2.2.2.2"><mtext id="S3.SS2.SSS1.p1.12.m12.2.2.2.2.2.2.cmml" xref="S3.SS2.SSS1.p1.12.m12.2.2.2.2.2.2">ch</mtext></ci><ci id="S3.SS2.SSS1.p1.12.m12.2.2.2.2.2.3.cmml" xref="S3.SS2.SSS1.p1.12.m12.2.2.2.2.2.3">𝑗</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.12.m12.2c">s_{\text{BM25}}(\text{ch}_{i},\text{ch}_{j})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.12.m12.2d">italic_s start_POSTSUBSCRIPT BM25 end_POSTSUBSCRIPT ( ch start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , ch start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT )</annotation></semantics></math> denote the BM25 score for the combination of chunks <math alttext="i" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.13.m13.1"><semantics id="S3.SS2.SSS1.p1.13.m13.1a"><mi id="S3.SS2.SSS1.p1.13.m13.1.1" xref="S3.SS2.SSS1.p1.13.m13.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.13.m13.1b"><ci id="S3.SS2.SSS1.p1.13.m13.1.1.cmml" xref="S3.SS2.SSS1.p1.13.m13.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.13.m13.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.13.m13.1d">italic_i</annotation></semantics></math> and <math alttext="j" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.14.m14.1"><semantics id="S3.SS2.SSS1.p1.14.m14.1a"><mi id="S3.SS2.SSS1.p1.14.m14.1.1" xref="S3.SS2.SSS1.p1.14.m14.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.14.m14.1b"><ci id="S3.SS2.SSS1.p1.14.m14.1.1.cmml" xref="S3.SS2.SSS1.p1.14.m14.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.14.m14.1c">j</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.14.m14.1d">italic_j</annotation></semantics></math>. The final sparse matrix <math alttext="\hat{\textit{S}}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.15.m15.1"><semantics id="S3.SS2.SSS1.p1.15.m15.1a"><mover accent="true" id="S3.SS2.SSS1.p1.15.m15.1.1" xref="S3.SS2.SSS1.p1.15.m15.1.1.cmml"><mtext class="ltx_mathvariant_italic" id="S3.SS2.SSS1.p1.15.m15.1.1.2" xref="S3.SS2.SSS1.p1.15.m15.1.1.2a.cmml">S</mtext><mo id="S3.SS2.SSS1.p1.15.m15.1.1.1" xref="S3.SS2.SSS1.p1.15.m15.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.15.m15.1b"><apply id="S3.SS2.SSS1.p1.15.m15.1.1.cmml" xref="S3.SS2.SSS1.p1.15.m15.1.1"><ci id="S3.SS2.SSS1.p1.15.m15.1.1.1.cmml" xref="S3.SS2.SSS1.p1.15.m15.1.1.1">^</ci><ci id="S3.SS2.SSS1.p1.15.m15.1.1.2a.cmml" xref="S3.SS2.SSS1.p1.15.m15.1.1.2"><mtext class="ltx_mathvariant_italic" id="S3.SS2.SSS1.p1.15.m15.1.1.2.cmml" xref="S3.SS2.SSS1.p1.15.m15.1.1.2">S</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.15.m15.1c">\hat{\textit{S}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.15.m15.1d">over^ start_ARG S end_ARG</annotation></semantics></math> is given by:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{S}_{ij}=\begin{cases}\textit{SU}(\text{ch}_{i},\text{ch}_{j})&amp;\text{if }s%
_{\text{BM25}}(\text{ch}_{i},\text{ch}_{j})\geq\text{Top}_{M}(s_{\text{BM25}}(%
\text{ch}_{i},\text{ch}_{M})),\\
0&amp;\text{otherwise},\end{cases}" class="ltx_Math" display="block" id="S3.E4.m1.4"><semantics id="S3.E4.m1.4a"><mrow id="S3.E4.m1.4.5" xref="S3.E4.m1.4.5.cmml"><msub id="S3.E4.m1.4.5.2" xref="S3.E4.m1.4.5.2.cmml"><mover accent="true" id="S3.E4.m1.4.5.2.2" xref="S3.E4.m1.4.5.2.2.cmml"><mi id="S3.E4.m1.4.5.2.2.2" xref="S3.E4.m1.4.5.2.2.2.cmml">S</mi><mo id="S3.E4.m1.4.5.2.2.1" xref="S3.E4.m1.4.5.2.2.1.cmml">^</mo></mover><mrow id="S3.E4.m1.4.5.2.3" xref="S3.E4.m1.4.5.2.3.cmml"><mi id="S3.E4.m1.4.5.2.3.2" xref="S3.E4.m1.4.5.2.3.2.cmml">i</mi><mo id="S3.E4.m1.4.5.2.3.1" xref="S3.E4.m1.4.5.2.3.1.cmml">⁢</mo><mi id="S3.E4.m1.4.5.2.3.3" xref="S3.E4.m1.4.5.2.3.3.cmml">j</mi></mrow></msub><mo id="S3.E4.m1.4.5.1" xref="S3.E4.m1.4.5.1.cmml">=</mo><mrow id="S3.E4.m1.4.4" xref="S3.E4.m1.4.5.3.1.cmml"><mo id="S3.E4.m1.4.4.5" xref="S3.E4.m1.4.5.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" id="S3.E4.m1.4.4.4" rowspacing="0pt" xref="S3.E4.m1.4.5.3.1.cmml"><mtr id="S3.E4.m1.4.4.4a" xref="S3.E4.m1.4.5.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E4.m1.4.4.4b" xref="S3.E4.m1.4.5.3.1.cmml"><mrow id="S3.E4.m1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_italic" id="S3.E4.m1.1.1.1.1.1.1.4" xref="S3.E4.m1.1.1.1.1.1.1.4a.cmml">SU</mtext><mo id="S3.E4.m1.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.1.3.cmml">⁢</mo><mrow id="S3.E4.m1.1.1.1.1.1.1.2.2" xref="S3.E4.m1.1.1.1.1.1.1.2.3.cmml"><mo id="S3.E4.m1.1.1.1.1.1.1.2.2.3" stretchy="false" xref="S3.E4.m1.1.1.1.1.1.1.2.3.cmml">(</mo><msub id="S3.E4.m1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.cmml"><mtext id="S3.E4.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.2a.cmml">ch</mtext><mi id="S3.E4.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E4.m1.1.1.1.1.1.1.2.2.4" xref="S3.E4.m1.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="S3.E4.m1.1.1.1.1.1.1.2.2.2" xref="S3.E4.m1.1.1.1.1.1.1.2.2.2.cmml"><mtext id="S3.E4.m1.1.1.1.1.1.1.2.2.2.2" xref="S3.E4.m1.1.1.1.1.1.1.2.2.2.2a.cmml">ch</mtext><mi id="S3.E4.m1.1.1.1.1.1.1.2.2.2.3" xref="S3.E4.m1.1.1.1.1.1.1.2.2.2.3.cmml">j</mi></msub><mo id="S3.E4.m1.1.1.1.1.1.1.2.2.5" stretchy="false" xref="S3.E4.m1.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E4.m1.4.4.4c" xref="S3.E4.m1.4.5.3.1.cmml"><mrow id="S3.E4.m1.2.2.2.2.2.1.1" xref="S3.E4.m1.2.2.2.2.2.1.1.1.cmml"><mrow id="S3.E4.m1.2.2.2.2.2.1.1.1" xref="S3.E4.m1.2.2.2.2.2.1.1.1.cmml"><mrow id="S3.E4.m1.2.2.2.2.2.1.1.1.2" xref="S3.E4.m1.2.2.2.2.2.1.1.1.2.cmml"><mtext id="S3.E4.m1.2.2.2.2.2.1.1.1.2.4" xref="S3.E4.m1.2.2.2.2.2.1.1.1.2.4a.cmml">if </mtext><mo id="S3.E4.m1.2.2.2.2.2.1.1.1.2.3" xref="S3.E4.m1.2.2.2.2.2.1.1.1.2.3.cmml">⁢</mo><msub id="S3.E4.m1.2.2.2.2.2.1.1.1.2.5" xref="S3.E4.m1.2.2.2.2.2.1.1.1.2.5.cmml"><mi id="S3.E4.m1.2.2.2.2.2.1.1.1.2.5.2" xref="S3.E4.m1.2.2.2.2.2.1.1.1.2.5.2.cmml">s</mi><mtext id="S3.E4.m1.2.2.2.2.2.1.1.1.2.5.3" xref="S3.E4.m1.2.2.2.2.2.1.1.1.2.5.3a.cmml">BM25</mtext></msub><mo id="S3.E4.m1.2.2.2.2.2.1.1.1.2.3a" xref="S3.E4.m1.2.2.2.2.2.1.1.1.2.3.cmml">⁢</mo><mrow id="S3.E4.m1.2.2.2.2.2.1.1.1.2.2.2" xref="S3.E4.m1.2.2.2.2.2.1.1.1.2.2.3.cmml"><mo id="S3.E4.m1.2.2.2.2.2.1.1.1.2.2.2.3" stretchy="false" xref="S3.E4.m1.2.2.2.2.2.1.1.1.2.2.3.cmml">(</mo><msub id="S3.E4.m1.2.2.2.2.2.1.1.1.1.1.1.1" xref="S3.E4.m1.2.2.2.2.2.1.1.1.1.1.1.1.cmml"><mtext id="S3.E4.m1.2.2.2.2.2.1.1.1.1.1.1.1.2" xref="S3.E4.m1.2.2.2.2.2.1.1.1.1.1.1.1.2a.cmml">ch</mtext><mi id="S3.E4.m1.2.2.2.2.2.1.1.1.1.1.1.1.3" xref="S3.E4.m1.2.2.2.2.2.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E4.m1.2.2.2.2.2.1.1.1.2.2.2.4" xref="S3.E4.m1.2.2.2.2.2.1.1.1.2.2.3.cmml">,</mo><msub id="S3.E4.m1.2.2.2.2.2.1.1.1.2.2.2.2" xref="S3.E4.m1.2.2.2.2.2.1.1.1.2.2.2.2.cmml"><mtext id="S3.E4.m1.2.2.2.2.2.1.1.1.2.2.2.2.2" xref="S3.E4.m1.2.2.2.2.2.1.1.1.2.2.2.2.2a.cmml">ch</mtext><mi id="S3.E4.m1.2.2.2.2.2.1.1.1.2.2.2.2.3" xref="S3.E4.m1.2.2.2.2.2.1.1.1.2.2.2.2.3.cmml">j</mi></msub><mo id="S3.E4.m1.2.2.2.2.2.1.1.1.2.2.2.5" stretchy="false" xref="S3.E4.m1.2.2.2.2.2.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.2.2.2.2.2.1.1.1.4" xref="S3.E4.m1.2.2.2.2.2.1.1.1.4.cmml">≥</mo><mrow id="S3.E4.m1.2.2.2.2.2.1.1.1.3" xref="S3.E4.m1.2.2.2.2.2.1.1.1.3.cmml"><msub id="S3.E4.m1.2.2.2.2.2.1.1.1.3.3" xref="S3.E4.m1.2.2.2.2.2.1.1.1.3.3.cmml"><mtext id="S3.E4.m1.2.2.2.2.2.1.1.1.3.3.2" xref="S3.E4.m1.2.2.2.2.2.1.1.1.3.3.2a.cmml">Top</mtext><mi id="S3.E4.m1.2.2.2.2.2.1.1.1.3.3.3" xref="S3.E4.m1.2.2.2.2.2.1.1.1.3.3.3.cmml">M</mi></msub><mo id="S3.E4.m1.2.2.2.2.2.1.1.1.3.2" xref="S3.E4.m1.2.2.2.2.2.1.1.1.3.2.cmml">⁢</mo><mrow id="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1" xref="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.cmml"><mo id="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.2" stretchy="false" xref="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1" xref="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.cmml"><msub id="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.4" xref="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.4.cmml"><mi id="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.4.2" xref="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.4.2.cmml">s</mi><mtext id="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.4.3" xref="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.4.3a.cmml">BM25</mtext></msub><mo id="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.3" xref="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.3.cmml">⁢</mo><mrow id="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.2.2" xref="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.2.3.cmml"><mo id="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.2.2.3" stretchy="false" xref="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.2.3.cmml">(</mo><msub id="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.1.1.1" xref="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.1.1.1.cmml"><mtext id="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.1.1.1.2" xref="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.1.1.1.2a.cmml">ch</mtext><mi id="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.1.1.1.3" xref="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.2.2.4" xref="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.2.3.cmml">,</mo><msub id="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.2.2.2" xref="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.2.2.2.cmml"><mtext id="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.2.2.2.2" xref="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.2.2.2.2a.cmml">ch</mtext><mi id="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.2.2.2.3" xref="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.2.2.2.3.cmml">M</mi></msub><mo id="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.2.2.5" stretchy="false" xref="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.3" stretchy="false" xref="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E4.m1.2.2.2.2.2.1.1.2" xref="S3.E4.m1.2.2.2.2.2.1.1.1.cmml">,</mo></mrow></mtd></mtr><mtr id="S3.E4.m1.4.4.4d" xref="S3.E4.m1.4.5.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E4.m1.4.4.4e" xref="S3.E4.m1.4.5.3.1.cmml"><mn id="S3.E4.m1.3.3.3.3.1.1" xref="S3.E4.m1.3.3.3.3.1.1.cmml">0</mn></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E4.m1.4.4.4f" xref="S3.E4.m1.4.5.3.1.cmml"><mrow id="S3.E4.m1.4.4.4.4.2.1.3" xref="S3.E4.m1.4.4.4.4.2.1.1a.cmml"><mtext id="S3.E4.m1.4.4.4.4.2.1.1" xref="S3.E4.m1.4.4.4.4.2.1.1.cmml">otherwise</mtext><mo id="S3.E4.m1.4.4.4.4.2.1.3.1" xref="S3.E4.m1.4.4.4.4.2.1.1a.cmml">,</mo></mrow></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.4b"><apply id="S3.E4.m1.4.5.cmml" xref="S3.E4.m1.4.5"><eq id="S3.E4.m1.4.5.1.cmml" xref="S3.E4.m1.4.5.1"></eq><apply id="S3.E4.m1.4.5.2.cmml" xref="S3.E4.m1.4.5.2"><csymbol cd="ambiguous" id="S3.E4.m1.4.5.2.1.cmml" xref="S3.E4.m1.4.5.2">subscript</csymbol><apply id="S3.E4.m1.4.5.2.2.cmml" xref="S3.E4.m1.4.5.2.2"><ci id="S3.E4.m1.4.5.2.2.1.cmml" xref="S3.E4.m1.4.5.2.2.1">^</ci><ci id="S3.E4.m1.4.5.2.2.2.cmml" xref="S3.E4.m1.4.5.2.2.2">𝑆</ci></apply><apply id="S3.E4.m1.4.5.2.3.cmml" xref="S3.E4.m1.4.5.2.3"><times id="S3.E4.m1.4.5.2.3.1.cmml" xref="S3.E4.m1.4.5.2.3.1"></times><ci id="S3.E4.m1.4.5.2.3.2.cmml" xref="S3.E4.m1.4.5.2.3.2">𝑖</ci><ci id="S3.E4.m1.4.5.2.3.3.cmml" xref="S3.E4.m1.4.5.2.3.3">𝑗</ci></apply></apply><apply id="S3.E4.m1.4.5.3.1.cmml" xref="S3.E4.m1.4.4"><csymbol cd="latexml" id="S3.E4.m1.4.5.3.1.1.cmml" xref="S3.E4.m1.4.4.5">cases</csymbol><apply id="S3.E4.m1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1"><times id="S3.E4.m1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.3"></times><ci id="S3.E4.m1.1.1.1.1.1.1.4a.cmml" xref="S3.E4.m1.1.1.1.1.1.1.4"><mtext class="ltx_mathvariant_italic" id="S3.E4.m1.1.1.1.1.1.1.4.cmml" xref="S3.E4.m1.1.1.1.1.1.1.4">SU</mtext></ci><interval closure="open" id="S3.E4.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.2.2"><apply id="S3.E4.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.1.1.1.1.1.2a.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.2"><mtext id="S3.E4.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.2">ch</mtext></ci><ci id="S3.E4.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E4.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.1.1.2.2.2.2a.cmml" xref="S3.E4.m1.1.1.1.1.1.1.2.2.2.2"><mtext id="S3.E4.m1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.2.2.2.2">ch</mtext></ci><ci id="S3.E4.m1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.2.2.2.3">𝑗</ci></apply></interval></apply><apply id="S3.E4.m1.2.2.2.2.2.1.1.1.cmml" xref="S3.E4.m1.2.2.2.2.2.1.1"><geq id="S3.E4.m1.2.2.2.2.2.1.1.1.4.cmml" xref="S3.E4.m1.2.2.2.2.2.1.1.1.4"></geq><apply id="S3.E4.m1.2.2.2.2.2.1.1.1.2.cmml" xref="S3.E4.m1.2.2.2.2.2.1.1.1.2"><times id="S3.E4.m1.2.2.2.2.2.1.1.1.2.3.cmml" xref="S3.E4.m1.2.2.2.2.2.1.1.1.2.3"></times><ci id="S3.E4.m1.2.2.2.2.2.1.1.1.2.4a.cmml" xref="S3.E4.m1.2.2.2.2.2.1.1.1.2.4"><mtext id="S3.E4.m1.2.2.2.2.2.1.1.1.2.4.cmml" xref="S3.E4.m1.2.2.2.2.2.1.1.1.2.4">if </mtext></ci><apply id="S3.E4.m1.2.2.2.2.2.1.1.1.2.5.cmml" xref="S3.E4.m1.2.2.2.2.2.1.1.1.2.5"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.2.2.2.1.1.1.2.5.1.cmml" xref="S3.E4.m1.2.2.2.2.2.1.1.1.2.5">subscript</csymbol><ci id="S3.E4.m1.2.2.2.2.2.1.1.1.2.5.2.cmml" xref="S3.E4.m1.2.2.2.2.2.1.1.1.2.5.2">𝑠</ci><ci id="S3.E4.m1.2.2.2.2.2.1.1.1.2.5.3a.cmml" xref="S3.E4.m1.2.2.2.2.2.1.1.1.2.5.3"><mtext id="S3.E4.m1.2.2.2.2.2.1.1.1.2.5.3.cmml" mathsize="70%" xref="S3.E4.m1.2.2.2.2.2.1.1.1.2.5.3">BM25</mtext></ci></apply><interval closure="open" id="S3.E4.m1.2.2.2.2.2.1.1.1.2.2.3.cmml" xref="S3.E4.m1.2.2.2.2.2.1.1.1.2.2.2"><apply id="S3.E4.m1.2.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.2.2.2.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.2.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.2.2.2.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.2.2.2.2.2.1.1.1.1.1.1.1.2a.cmml" xref="S3.E4.m1.2.2.2.2.2.1.1.1.1.1.1.1.2"><mtext id="S3.E4.m1.2.2.2.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.2.2.2.2.2.1.1.1.1.1.1.1.2">ch</mtext></ci><ci id="S3.E4.m1.2.2.2.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.2.2.2.2.2.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E4.m1.2.2.2.2.2.1.1.1.2.2.2.2.cmml" xref="S3.E4.m1.2.2.2.2.2.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.2.2.2.1.1.1.2.2.2.2.1.cmml" xref="S3.E4.m1.2.2.2.2.2.1.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E4.m1.2.2.2.2.2.1.1.1.2.2.2.2.2a.cmml" xref="S3.E4.m1.2.2.2.2.2.1.1.1.2.2.2.2.2"><mtext id="S3.E4.m1.2.2.2.2.2.1.1.1.2.2.2.2.2.cmml" xref="S3.E4.m1.2.2.2.2.2.1.1.1.2.2.2.2.2">ch</mtext></ci><ci id="S3.E4.m1.2.2.2.2.2.1.1.1.2.2.2.2.3.cmml" xref="S3.E4.m1.2.2.2.2.2.1.1.1.2.2.2.2.3">𝑗</ci></apply></interval></apply><apply id="S3.E4.m1.2.2.2.2.2.1.1.1.3.cmml" xref="S3.E4.m1.2.2.2.2.2.1.1.1.3"><times id="S3.E4.m1.2.2.2.2.2.1.1.1.3.2.cmml" xref="S3.E4.m1.2.2.2.2.2.1.1.1.3.2"></times><apply id="S3.E4.m1.2.2.2.2.2.1.1.1.3.3.cmml" xref="S3.E4.m1.2.2.2.2.2.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.2.2.2.1.1.1.3.3.1.cmml" xref="S3.E4.m1.2.2.2.2.2.1.1.1.3.3">subscript</csymbol><ci id="S3.E4.m1.2.2.2.2.2.1.1.1.3.3.2a.cmml" xref="S3.E4.m1.2.2.2.2.2.1.1.1.3.3.2"><mtext id="S3.E4.m1.2.2.2.2.2.1.1.1.3.3.2.cmml" xref="S3.E4.m1.2.2.2.2.2.1.1.1.3.3.2">Top</mtext></ci><ci id="S3.E4.m1.2.2.2.2.2.1.1.1.3.3.3.cmml" xref="S3.E4.m1.2.2.2.2.2.1.1.1.3.3.3">𝑀</ci></apply><apply id="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.cmml" xref="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1"><times id="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.3.cmml" xref="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.3"></times><apply id="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.4.cmml" xref="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.4"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.4.1.cmml" xref="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.4">subscript</csymbol><ci id="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.4.2.cmml" xref="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.4.2">𝑠</ci><ci id="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.4.3a.cmml" xref="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.4.3"><mtext id="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.4.3.cmml" mathsize="70%" xref="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.4.3">BM25</mtext></ci></apply><interval closure="open" id="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.2.3.cmml" xref="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.2.2"><apply id="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.1.1.1.cmml" xref="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.1.1.1.2a.cmml" xref="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.1.1.1.2"><mtext id="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.1.1.1.2">ch</mtext></ci><ci id="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.2.2.2.cmml" xref="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.2.2.2.1.cmml" xref="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.2.2.2.2a.cmml" xref="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.2.2.2.2"><mtext id="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.2.2.2.2.cmml" xref="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.2.2.2.2">ch</mtext></ci><ci id="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.2.2.2.3.cmml" xref="S3.E4.m1.2.2.2.2.2.1.1.1.3.1.1.1.2.2.2.3">𝑀</ci></apply></interval></apply></apply></apply><cn id="S3.E4.m1.3.3.3.3.1.1.cmml" type="integer" xref="S3.E4.m1.3.3.3.3.1.1">0</cn><ci id="S3.E4.m1.4.4.4.4.2.1.1a.cmml" xref="S3.E4.m1.4.4.4.4.2.1.3"><mtext id="S3.E4.m1.4.4.4.4.2.1.1.cmml" xref="S3.E4.m1.4.4.4.4.2.1.1">otherwise</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.4c">\hat{S}_{ij}=\begin{cases}\textit{SU}(\text{ch}_{i},\text{ch}_{j})&amp;\text{if }s%
_{\text{BM25}}(\text{ch}_{i},\text{ch}_{j})\geq\text{Top}_{M}(s_{\text{BM25}}(%
\text{ch}_{i},\text{ch}_{M})),\\
0&amp;\text{otherwise},\end{cases}</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.4d">over^ start_ARG italic_S end_ARG start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT = { start_ROW start_CELL SU ( ch start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , ch start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) end_CELL start_CELL if italic_s start_POSTSUBSCRIPT BM25 end_POSTSUBSCRIPT ( ch start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , ch start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ≥ Top start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT BM25 end_POSTSUBSCRIPT ( ch start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , ch start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ) ) , end_CELL end_ROW start_ROW start_CELL 0 end_CELL start_CELL otherwise , end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS1.p1.25">where <math alttext="\text{Top}_{M}(s_{\text{BM25}}(\text{ch}_{i},\text{ch}_{M}))" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.16.m1.1"><semantics id="S3.SS2.SSS1.p1.16.m1.1a"><mrow id="S3.SS2.SSS1.p1.16.m1.1.1" xref="S3.SS2.SSS1.p1.16.m1.1.1.cmml"><msub id="S3.SS2.SSS1.p1.16.m1.1.1.3" xref="S3.SS2.SSS1.p1.16.m1.1.1.3.cmml"><mtext id="S3.SS2.SSS1.p1.16.m1.1.1.3.2" xref="S3.SS2.SSS1.p1.16.m1.1.1.3.2a.cmml">Top</mtext><mi id="S3.SS2.SSS1.p1.16.m1.1.1.3.3" xref="S3.SS2.SSS1.p1.16.m1.1.1.3.3.cmml">M</mi></msub><mo id="S3.SS2.SSS1.p1.16.m1.1.1.2" xref="S3.SS2.SSS1.p1.16.m1.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.SSS1.p1.16.m1.1.1.1.1" xref="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.cmml"><mo id="S3.SS2.SSS1.p1.16.m1.1.1.1.1.2" stretchy="false" xref="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1" xref="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.cmml"><msub id="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.4" xref="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.4.cmml"><mi id="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.4.2" xref="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.4.2.cmml">s</mi><mtext id="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.4.3" xref="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.4.3a.cmml">BM25</mtext></msub><mo id="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.3" xref="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.3.cmml">⁢</mo><mrow id="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.2.2" xref="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.2.3.cmml"><mo id="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.2.2.3" stretchy="false" xref="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.2.3.cmml">(</mo><msub id="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.1.1.1" xref="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.1.1.1.cmml"><mtext id="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.1.1.1.2" xref="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.1.1.1.2a.cmml">ch</mtext><mi id="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.1.1.1.3" xref="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.2.2.4" xref="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.2.3.cmml">,</mo><msub id="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.2.2.2" xref="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.2.2.2.cmml"><mtext id="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.2.2.2.2" xref="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.2.2.2.2a.cmml">ch</mtext><mi id="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.2.2.2.3" xref="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.2.2.2.3.cmml">M</mi></msub><mo id="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.2.2.5" stretchy="false" xref="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S3.SS2.SSS1.p1.16.m1.1.1.1.1.3" stretchy="false" xref="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.16.m1.1b"><apply id="S3.SS2.SSS1.p1.16.m1.1.1.cmml" xref="S3.SS2.SSS1.p1.16.m1.1.1"><times id="S3.SS2.SSS1.p1.16.m1.1.1.2.cmml" xref="S3.SS2.SSS1.p1.16.m1.1.1.2"></times><apply id="S3.SS2.SSS1.p1.16.m1.1.1.3.cmml" xref="S3.SS2.SSS1.p1.16.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.16.m1.1.1.3.1.cmml" xref="S3.SS2.SSS1.p1.16.m1.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS1.p1.16.m1.1.1.3.2a.cmml" xref="S3.SS2.SSS1.p1.16.m1.1.1.3.2"><mtext id="S3.SS2.SSS1.p1.16.m1.1.1.3.2.cmml" xref="S3.SS2.SSS1.p1.16.m1.1.1.3.2">Top</mtext></ci><ci id="S3.SS2.SSS1.p1.16.m1.1.1.3.3.cmml" xref="S3.SS2.SSS1.p1.16.m1.1.1.3.3">𝑀</ci></apply><apply id="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.16.m1.1.1.1.1"><times id="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.3"></times><apply id="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.4.cmml" xref="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.4.1.cmml" xref="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.4.2.cmml" xref="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.4.2">𝑠</ci><ci id="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.4.3a.cmml" xref="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.4.3"><mtext id="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.4.3.cmml" mathsize="70%" xref="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.4.3">BM25</mtext></ci></apply><interval closure="open" id="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.2.3.cmml" xref="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.2.2"><apply id="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.1.1.1.2a.cmml" xref="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.1.1.1.2"><mtext id="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.1.1.1.2">ch</mtext></ci><ci id="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.2.2.2.cmml" xref="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.2.2.2.2a.cmml" xref="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.2.2.2.2"><mtext id="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.2.2.2.2">ch</mtext></ci><ci id="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.SS2.SSS1.p1.16.m1.1.1.1.1.1.2.2.2.3">𝑀</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.16.m1.1c">\text{Top}_{M}(s_{\text{BM25}}(\text{ch}_{i},\text{ch}_{M}))</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.16.m1.1d">Top start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ( italic_s start_POSTSUBSCRIPT BM25 end_POSTSUBSCRIPT ( ch start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , ch start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ) )</annotation></semantics></math> denotes the <math alttext="M" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.17.m2.1"><semantics id="S3.SS2.SSS1.p1.17.m2.1a"><mi id="S3.SS2.SSS1.p1.17.m2.1.1" xref="S3.SS2.SSS1.p1.17.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.17.m2.1b"><ci id="S3.SS2.SSS1.p1.17.m2.1.1.cmml" xref="S3.SS2.SSS1.p1.17.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.17.m2.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.17.m2.1d">italic_M</annotation></semantics></math>-th highest BM25 score chunk <math alttext="\text{ch}_{M}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.18.m3.1"><semantics id="S3.SS2.SSS1.p1.18.m3.1a"><msub id="S3.SS2.SSS1.p1.18.m3.1.1" xref="S3.SS2.SSS1.p1.18.m3.1.1.cmml"><mtext id="S3.SS2.SSS1.p1.18.m3.1.1.2" xref="S3.SS2.SSS1.p1.18.m3.1.1.2a.cmml">ch</mtext><mi id="S3.SS2.SSS1.p1.18.m3.1.1.3" xref="S3.SS2.SSS1.p1.18.m3.1.1.3.cmml">M</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.18.m3.1b"><apply id="S3.SS2.SSS1.p1.18.m3.1.1.cmml" xref="S3.SS2.SSS1.p1.18.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.18.m3.1.1.1.cmml" xref="S3.SS2.SSS1.p1.18.m3.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p1.18.m3.1.1.2a.cmml" xref="S3.SS2.SSS1.p1.18.m3.1.1.2"><mtext id="S3.SS2.SSS1.p1.18.m3.1.1.2.cmml" xref="S3.SS2.SSS1.p1.18.m3.1.1.2">ch</mtext></ci><ci id="S3.SS2.SSS1.p1.18.m3.1.1.3.cmml" xref="S3.SS2.SSS1.p1.18.m3.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.18.m3.1c">\text{ch}_{M}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.18.m3.1d">ch start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT</annotation></semantics></math> for anchor <math alttext="\text{ch}_{i}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.19.m4.1"><semantics id="S3.SS2.SSS1.p1.19.m4.1a"><msub id="S3.SS2.SSS1.p1.19.m4.1.1" xref="S3.SS2.SSS1.p1.19.m4.1.1.cmml"><mtext id="S3.SS2.SSS1.p1.19.m4.1.1.2" xref="S3.SS2.SSS1.p1.19.m4.1.1.2a.cmml">ch</mtext><mi id="S3.SS2.SSS1.p1.19.m4.1.1.3" xref="S3.SS2.SSS1.p1.19.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.19.m4.1b"><apply id="S3.SS2.SSS1.p1.19.m4.1.1.cmml" xref="S3.SS2.SSS1.p1.19.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.19.m4.1.1.1.cmml" xref="S3.SS2.SSS1.p1.19.m4.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p1.19.m4.1.1.2a.cmml" xref="S3.SS2.SSS1.p1.19.m4.1.1.2"><mtext id="S3.SS2.SSS1.p1.19.m4.1.1.2.cmml" xref="S3.SS2.SSS1.p1.19.m4.1.1.2">ch</mtext></ci><ci id="S3.SS2.SSS1.p1.19.m4.1.1.3.cmml" xref="S3.SS2.SSS1.p1.19.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.19.m4.1c">\text{ch}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.19.m4.1d">ch start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>. We set up two windows within <math alttext="M" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.20.m5.1"><semantics id="S3.SS2.SSS1.p1.20.m5.1a"><mi id="S3.SS2.SSS1.p1.20.m5.1.1" xref="S3.SS2.SSS1.p1.20.m5.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.20.m5.1b"><ci id="S3.SS2.SSS1.p1.20.m5.1.1.cmml" xref="S3.SS2.SSS1.p1.20.m5.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.20.m5.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.20.m5.1d">italic_M</annotation></semantics></math>, each containing <math alttext="m" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.21.m6.1"><semantics id="S3.SS2.SSS1.p1.21.m6.1a"><mi id="S3.SS2.SSS1.p1.21.m6.1.1" xref="S3.SS2.SSS1.p1.21.m6.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.21.m6.1b"><ci id="S3.SS2.SSS1.p1.21.m6.1.1.cmml" xref="S3.SS2.SSS1.p1.21.m6.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.21.m6.1c">m</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.21.m6.1d">italic_m</annotation></semantics></math> samples. Among them, the top <math alttext="m" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.22.m7.1"><semantics id="S3.SS2.SSS1.p1.22.m7.1a"><mi id="S3.SS2.SSS1.p1.22.m7.1.1" xref="S3.SS2.SSS1.p1.22.m7.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.22.m7.1b"><ci id="S3.SS2.SSS1.p1.22.m7.1.1.cmml" xref="S3.SS2.SSS1.p1.22.m7.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.22.m7.1c">m</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.22.m7.1d">italic_m</annotation></semantics></math> are positive samples, and the bottom <math alttext="m" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.23.m8.1"><semantics id="S3.SS2.SSS1.p1.23.m8.1a"><mi id="S3.SS2.SSS1.p1.23.m8.1.1" xref="S3.SS2.SSS1.p1.23.m8.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.23.m8.1b"><ci id="S3.SS2.SSS1.p1.23.m8.1.1.cmml" xref="S3.SS2.SSS1.p1.23.m8.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.23.m8.1c">m</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.23.m8.1d">italic_m</annotation></semantics></math> are negative samples. We sample positive and negative samples within these two windows, denoted as <math alttext="{\text{ch}_{i}}^{+}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.24.m9.1"><semantics id="S3.SS2.SSS1.p1.24.m9.1a"><mmultiscripts id="S3.SS2.SSS1.p1.24.m9.1.1" xref="S3.SS2.SSS1.p1.24.m9.1.1.cmml"><mtext id="S3.SS2.SSS1.p1.24.m9.1.1.2.2" xref="S3.SS2.SSS1.p1.24.m9.1.1.2.2a.cmml">ch</mtext><mi id="S3.SS2.SSS1.p1.24.m9.1.1.2.3" xref="S3.SS2.SSS1.p1.24.m9.1.1.2.3.cmml">i</mi><mrow id="S3.SS2.SSS1.p1.24.m9.1.1a" xref="S3.SS2.SSS1.p1.24.m9.1.1.cmml"></mrow><mrow id="S3.SS2.SSS1.p1.24.m9.1.1b" xref="S3.SS2.SSS1.p1.24.m9.1.1.cmml"></mrow><mo id="S3.SS2.SSS1.p1.24.m9.1.1.3" xref="S3.SS2.SSS1.p1.24.m9.1.1.3.cmml">+</mo></mmultiscripts><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.24.m9.1b"><apply id="S3.SS2.SSS1.p1.24.m9.1.1.cmml" xref="S3.SS2.SSS1.p1.24.m9.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.24.m9.1.1.1.cmml" xref="S3.SS2.SSS1.p1.24.m9.1.1">superscript</csymbol><apply id="S3.SS2.SSS1.p1.24.m9.1.1.2.cmml" xref="S3.SS2.SSS1.p1.24.m9.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.24.m9.1.1.2.1.cmml" xref="S3.SS2.SSS1.p1.24.m9.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p1.24.m9.1.1.2.2a.cmml" xref="S3.SS2.SSS1.p1.24.m9.1.1.2.2"><mtext id="S3.SS2.SSS1.p1.24.m9.1.1.2.2.cmml" xref="S3.SS2.SSS1.p1.24.m9.1.1.2.2">ch</mtext></ci><ci id="S3.SS2.SSS1.p1.24.m9.1.1.2.3.cmml" xref="S3.SS2.SSS1.p1.24.m9.1.1.2.3">𝑖</ci></apply><plus id="S3.SS2.SSS1.p1.24.m9.1.1.3.cmml" xref="S3.SS2.SSS1.p1.24.m9.1.1.3"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.24.m9.1c">{\text{ch}_{i}}^{+}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.24.m9.1d">ch start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="{\text{ch}_{i}}^{-}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.25.m10.1"><semantics id="S3.SS2.SSS1.p1.25.m10.1a"><mmultiscripts id="S3.SS2.SSS1.p1.25.m10.1.1" xref="S3.SS2.SSS1.p1.25.m10.1.1.cmml"><mtext id="S3.SS2.SSS1.p1.25.m10.1.1.2.2" xref="S3.SS2.SSS1.p1.25.m10.1.1.2.2a.cmml">ch</mtext><mi id="S3.SS2.SSS1.p1.25.m10.1.1.2.3" xref="S3.SS2.SSS1.p1.25.m10.1.1.2.3.cmml">i</mi><mrow id="S3.SS2.SSS1.p1.25.m10.1.1a" xref="S3.SS2.SSS1.p1.25.m10.1.1.cmml"></mrow><mrow id="S3.SS2.SSS1.p1.25.m10.1.1b" xref="S3.SS2.SSS1.p1.25.m10.1.1.cmml"></mrow><mo id="S3.SS2.SSS1.p1.25.m10.1.1.3" xref="S3.SS2.SSS1.p1.25.m10.1.1.3.cmml">−</mo></mmultiscripts><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.25.m10.1b"><apply id="S3.SS2.SSS1.p1.25.m10.1.1.cmml" xref="S3.SS2.SSS1.p1.25.m10.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.25.m10.1.1.1.cmml" xref="S3.SS2.SSS1.p1.25.m10.1.1">superscript</csymbol><apply id="S3.SS2.SSS1.p1.25.m10.1.1.2.cmml" xref="S3.SS2.SSS1.p1.25.m10.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.25.m10.1.1.2.1.cmml" xref="S3.SS2.SSS1.p1.25.m10.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p1.25.m10.1.1.2.2a.cmml" xref="S3.SS2.SSS1.p1.25.m10.1.1.2.2"><mtext id="S3.SS2.SSS1.p1.25.m10.1.1.2.2.cmml" xref="S3.SS2.SSS1.p1.25.m10.1.1.2.2">ch</mtext></ci><ci id="S3.SS2.SSS1.p1.25.m10.1.1.2.3.cmml" xref="S3.SS2.SSS1.p1.25.m10.1.1.2.3">𝑖</ci></apply><minus id="S3.SS2.SSS1.p1.25.m10.1.1.3.cmml" xref="S3.SS2.SSS1.p1.25.m10.1.1.3"></minus></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.25.m10.1c">{\text{ch}_{i}}^{-}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.25.m10.1d">ch start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT</annotation></semantics></math>, respectively.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.2 </span>Data Scaling Strategy</h4>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS2.p1">
<p class="ltx_p" id="S3.SS2.SSS2.p1.1">All our experiments are conducted under distribution shift setting, meaning our retrieval model needs to handle semantically disjointed chunks resulting from segmented text, as well as noisy data arising from long-tail distributions that are never encountered in the trainning dataset. Our span uncertainty effectively calibrates the model’s uncertainty measurement using the SNR metric, identifying meaningful output probabilities to construct an anchor-positive-negative sample dataset.</p>
</div>
<section class="ltx_paragraph" id="S3.SS2.SSS2.Px1">
<h5 class="ltx_title ltx_title_paragraph">Anchor Sample Scaling Strategy</h5>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS2.Px1.p1">
<p class="ltx_p" id="S3.SS2.SSS2.Px1.p1.1">We refer to each chunk as an anchor sample. We initially merge the five datasets: HotpotQA <cite class="ltx_cite ltx_citemacro_citep">(Yang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib80" title="">2018</a>)</cite>, MultiFieldQA <cite class="ltx_cite ltx_citemacro_citep">(Bai et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib3" title="">2023</a>)</cite>, Qasper <cite class="ltx_cite ltx_citemacro_citep">(Dasigi et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib16" title="">2021</a>)</cite>, NarrativeQA <cite class="ltx_cite ltx_citemacro_citep">(Kočiskỳ et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib36" title="">2018</a>)</cite>, and QMSum <cite class="ltx_cite ltx_citemacro_citep">(Zhong et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib84" title="">2021</a>)</cite>. Each dataset is split based on spaces, and every 300 words are grouped into a chunk. As a result, we obtain 37,799, 14,547, 15,865, 72,146, and 38,398 chunks, respectively. Due to computational limitations, it is challenging to score all possible combinations of such a large number of chunks. Therefore, we first use k-nearest neighbors (KNN) to cluster each dataset into <math alttext="k" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px1.p1.1.m1.1"><semantics id="S3.SS2.SSS2.Px1.p1.1.m1.1a"><mi id="S3.SS2.SSS2.Px1.p1.1.m1.1.1" xref="S3.SS2.SSS2.Px1.p1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.1.m1.1b"><ci id="S3.SS2.SSS2.Px1.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px1.p1.1.m1.1d">italic_k</annotation></semantics></math> clusters. Then, we randomly select <span class="ltx_text ltx_font_italic" id="S3.SS2.SSS2.Px1.p1.1.1">c</span> chunks from each cluster, resulting in 10*<span class="ltx_text ltx_font_italic" id="S3.SS2.SSS2.Px1.p1.1.2">c</span> chunks per dataset. By mixing the five datasets, we obtain a total of 50*<span class="ltx_text ltx_font_italic" id="S3.SS2.SSS2.Px1.p1.1.3">c</span> chunks. By increasing the multiple of <span class="ltx_text ltx_font_italic" id="S3.SS2.SSS2.Px1.p1.1.4">c</span>, we scale the total number of anchor samples.</p>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS2.SSS2.Px2">
<h5 class="ltx_title ltx_title_paragraph">Positive and Negative Sample Scaling Strategy</h5>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS2.Px2.p1">
<p class="ltx_p" id="S3.SS2.SSS2.Px2.p1.11">When a sample anchor <math alttext="\text{ch}_{i}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px2.p1.1.m1.1"><semantics id="S3.SS2.SSS2.Px2.p1.1.m1.1a"><msub id="S3.SS2.SSS2.Px2.p1.1.m1.1.1" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.cmml"><mtext id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.2" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.2a.cmml">ch</mtext><mi id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.3" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p1.1.m1.1b"><apply id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.2a.cmml" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.2"><mtext id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.2">ch</mtext></ci><ci id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p1.1.m1.1c">\text{ch}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px2.p1.1.m1.1d">ch start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is selected, we need to concatenate it with other chunks and input them into the LLM for scoring. Due to the high computational cost, we employ a method similar to anchor sample scaling. First, using the KNN method, we randomly sample <span class="ltx_text ltx_font_italic" id="S3.SS2.SSS2.Px2.p1.11.1">n</span> samples <math alttext="\text{ch}_{j}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px2.p1.2.m2.1"><semantics id="S3.SS2.SSS2.Px2.p1.2.m2.1a"><msub id="S3.SS2.SSS2.Px2.p1.2.m2.1.1" xref="S3.SS2.SSS2.Px2.p1.2.m2.1.1.cmml"><mtext id="S3.SS2.SSS2.Px2.p1.2.m2.1.1.2" xref="S3.SS2.SSS2.Px2.p1.2.m2.1.1.2a.cmml">ch</mtext><mi id="S3.SS2.SSS2.Px2.p1.2.m2.1.1.3" xref="S3.SS2.SSS2.Px2.p1.2.m2.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p1.2.m2.1b"><apply id="S3.SS2.SSS2.Px2.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p1.2.m2.1.1.2a.cmml" xref="S3.SS2.SSS2.Px2.p1.2.m2.1.1.2"><mtext id="S3.SS2.SSS2.Px2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p1.2.m2.1.1.2">ch</mtext></ci><ci id="S3.SS2.SSS2.Px2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p1.2.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p1.2.m2.1c">\text{ch}_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px2.p1.2.m2.1d">ch start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> from each of the <math alttext="k" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px2.p1.3.m3.1"><semantics id="S3.SS2.SSS2.Px2.p1.3.m3.1a"><mi id="S3.SS2.SSS2.Px2.p1.3.m3.1.1" xref="S3.SS2.SSS2.Px2.p1.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p1.3.m3.1b"><ci id="S3.SS2.SSS2.Px2.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p1.3.m3.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px2.p1.3.m3.1d">italic_k</annotation></semantics></math> clusters, where the clusters are formed from the previously mentioned 50<math alttext="*" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px2.p1.4.m4.1"><semantics id="S3.SS2.SSS2.Px2.p1.4.m4.1a"><mo id="S3.SS2.SSS2.Px2.p1.4.m4.1.1" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.cmml">∗</mo><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p1.4.m4.1b"><times id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p1.4.m4.1c">*</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px2.p1.4.m4.1d">∗</annotation></semantics></math><span class="ltx_text ltx_font_italic" id="S3.SS2.SSS2.Px2.p1.11.2">c</span> chunks. This way, we obtain 10<math alttext="*" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px2.p1.5.m5.1"><semantics id="S3.SS2.SSS2.Px2.p1.5.m5.1a"><mo id="S3.SS2.SSS2.Px2.p1.5.m5.1.1" xref="S3.SS2.SSS2.Px2.p1.5.m5.1.1.cmml">∗</mo><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p1.5.m5.1b"><times id="S3.SS2.SSS2.Px2.p1.5.m5.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.5.m5.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p1.5.m5.1c">*</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px2.p1.5.m5.1d">∗</annotation></semantics></math><span class="ltx_text ltx_font_italic" id="S3.SS2.SSS2.Px2.p1.11.3">n</span> samples in a single sampling process. Then, we use BM25 to score the anchor and each sample, <math alttext="s_{\text{BM25}}(\text{ch}_{i},\text{ch}_{j})" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px2.p1.6.m6.2"><semantics id="S3.SS2.SSS2.Px2.p1.6.m6.2a"><mrow id="S3.SS2.SSS2.Px2.p1.6.m6.2.2" xref="S3.SS2.SSS2.Px2.p1.6.m6.2.2.cmml"><msub id="S3.SS2.SSS2.Px2.p1.6.m6.2.2.4" xref="S3.SS2.SSS2.Px2.p1.6.m6.2.2.4.cmml"><mi id="S3.SS2.SSS2.Px2.p1.6.m6.2.2.4.2" xref="S3.SS2.SSS2.Px2.p1.6.m6.2.2.4.2.cmml">s</mi><mtext id="S3.SS2.SSS2.Px2.p1.6.m6.2.2.4.3" xref="S3.SS2.SSS2.Px2.p1.6.m6.2.2.4.3a.cmml">BM25</mtext></msub><mo id="S3.SS2.SSS2.Px2.p1.6.m6.2.2.3" xref="S3.SS2.SSS2.Px2.p1.6.m6.2.2.3.cmml">⁢</mo><mrow id="S3.SS2.SSS2.Px2.p1.6.m6.2.2.2.2" xref="S3.SS2.SSS2.Px2.p1.6.m6.2.2.2.3.cmml"><mo id="S3.SS2.SSS2.Px2.p1.6.m6.2.2.2.2.3" stretchy="false" xref="S3.SS2.SSS2.Px2.p1.6.m6.2.2.2.3.cmml">(</mo><msub id="S3.SS2.SSS2.Px2.p1.6.m6.1.1.1.1.1" xref="S3.SS2.SSS2.Px2.p1.6.m6.1.1.1.1.1.cmml"><mtext id="S3.SS2.SSS2.Px2.p1.6.m6.1.1.1.1.1.2" xref="S3.SS2.SSS2.Px2.p1.6.m6.1.1.1.1.1.2a.cmml">ch</mtext><mi id="S3.SS2.SSS2.Px2.p1.6.m6.1.1.1.1.1.3" xref="S3.SS2.SSS2.Px2.p1.6.m6.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS2.SSS2.Px2.p1.6.m6.2.2.2.2.4" xref="S3.SS2.SSS2.Px2.p1.6.m6.2.2.2.3.cmml">,</mo><msub id="S3.SS2.SSS2.Px2.p1.6.m6.2.2.2.2.2" xref="S3.SS2.SSS2.Px2.p1.6.m6.2.2.2.2.2.cmml"><mtext id="S3.SS2.SSS2.Px2.p1.6.m6.2.2.2.2.2.2" xref="S3.SS2.SSS2.Px2.p1.6.m6.2.2.2.2.2.2a.cmml">ch</mtext><mi id="S3.SS2.SSS2.Px2.p1.6.m6.2.2.2.2.2.3" xref="S3.SS2.SSS2.Px2.p1.6.m6.2.2.2.2.2.3.cmml">j</mi></msub><mo id="S3.SS2.SSS2.Px2.p1.6.m6.2.2.2.2.5" stretchy="false" xref="S3.SS2.SSS2.Px2.p1.6.m6.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p1.6.m6.2b"><apply id="S3.SS2.SSS2.Px2.p1.6.m6.2.2.cmml" xref="S3.SS2.SSS2.Px2.p1.6.m6.2.2"><times id="S3.SS2.SSS2.Px2.p1.6.m6.2.2.3.cmml" xref="S3.SS2.SSS2.Px2.p1.6.m6.2.2.3"></times><apply id="S3.SS2.SSS2.Px2.p1.6.m6.2.2.4.cmml" xref="S3.SS2.SSS2.Px2.p1.6.m6.2.2.4"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p1.6.m6.2.2.4.1.cmml" xref="S3.SS2.SSS2.Px2.p1.6.m6.2.2.4">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p1.6.m6.2.2.4.2.cmml" xref="S3.SS2.SSS2.Px2.p1.6.m6.2.2.4.2">𝑠</ci><ci id="S3.SS2.SSS2.Px2.p1.6.m6.2.2.4.3a.cmml" xref="S3.SS2.SSS2.Px2.p1.6.m6.2.2.4.3"><mtext id="S3.SS2.SSS2.Px2.p1.6.m6.2.2.4.3.cmml" mathsize="70%" xref="S3.SS2.SSS2.Px2.p1.6.m6.2.2.4.3">BM25</mtext></ci></apply><interval closure="open" id="S3.SS2.SSS2.Px2.p1.6.m6.2.2.2.3.cmml" xref="S3.SS2.SSS2.Px2.p1.6.m6.2.2.2.2"><apply id="S3.SS2.SSS2.Px2.p1.6.m6.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.6.m6.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p1.6.m6.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.6.m6.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p1.6.m6.1.1.1.1.1.2a.cmml" xref="S3.SS2.SSS2.Px2.p1.6.m6.1.1.1.1.1.2"><mtext id="S3.SS2.SSS2.Px2.p1.6.m6.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p1.6.m6.1.1.1.1.1.2">ch</mtext></ci><ci id="S3.SS2.SSS2.Px2.p1.6.m6.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p1.6.m6.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS2.SSS2.Px2.p1.6.m6.2.2.2.2.2.cmml" xref="S3.SS2.SSS2.Px2.p1.6.m6.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p1.6.m6.2.2.2.2.2.1.cmml" xref="S3.SS2.SSS2.Px2.p1.6.m6.2.2.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p1.6.m6.2.2.2.2.2.2a.cmml" xref="S3.SS2.SSS2.Px2.p1.6.m6.2.2.2.2.2.2"><mtext id="S3.SS2.SSS2.Px2.p1.6.m6.2.2.2.2.2.2.cmml" xref="S3.SS2.SSS2.Px2.p1.6.m6.2.2.2.2.2.2">ch</mtext></ci><ci id="S3.SS2.SSS2.Px2.p1.6.m6.2.2.2.2.2.3.cmml" xref="S3.SS2.SSS2.Px2.p1.6.m6.2.2.2.2.2.3">𝑗</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p1.6.m6.2c">s_{\text{BM25}}(\text{ch}_{i},\text{ch}_{j})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px2.p1.6.m6.2d">italic_s start_POSTSUBSCRIPT BM25 end_POSTSUBSCRIPT ( ch start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , ch start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT )</annotation></semantics></math>, and select the final <math alttext="M" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px2.p1.7.m7.1"><semantics id="S3.SS2.SSS2.Px2.p1.7.m7.1a"><mi id="S3.SS2.SSS2.Px2.p1.7.m7.1.1" xref="S3.SS2.SSS2.Px2.p1.7.m7.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p1.7.m7.1b"><ci id="S3.SS2.SSS2.Px2.p1.7.m7.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.7.m7.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p1.7.m7.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px2.p1.7.m7.1d">italic_M</annotation></semantics></math> samples. These are scored using LLMs to obtain the final <math alttext="{\text{ch}_{i}}^{+}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px2.p1.8.m8.1"><semantics id="S3.SS2.SSS2.Px2.p1.8.m8.1a"><mmultiscripts id="S3.SS2.SSS2.Px2.p1.8.m8.1.1" xref="S3.SS2.SSS2.Px2.p1.8.m8.1.1.cmml"><mtext id="S3.SS2.SSS2.Px2.p1.8.m8.1.1.2.2" xref="S3.SS2.SSS2.Px2.p1.8.m8.1.1.2.2a.cmml">ch</mtext><mi id="S3.SS2.SSS2.Px2.p1.8.m8.1.1.2.3" xref="S3.SS2.SSS2.Px2.p1.8.m8.1.1.2.3.cmml">i</mi><mrow id="S3.SS2.SSS2.Px2.p1.8.m8.1.1a" xref="S3.SS2.SSS2.Px2.p1.8.m8.1.1.cmml"></mrow><mrow id="S3.SS2.SSS2.Px2.p1.8.m8.1.1b" xref="S3.SS2.SSS2.Px2.p1.8.m8.1.1.cmml"></mrow><mo id="S3.SS2.SSS2.Px2.p1.8.m8.1.1.3" xref="S3.SS2.SSS2.Px2.p1.8.m8.1.1.3.cmml">+</mo></mmultiscripts><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p1.8.m8.1b"><apply id="S3.SS2.SSS2.Px2.p1.8.m8.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p1.8.m8.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.8.m8.1.1">superscript</csymbol><apply id="S3.SS2.SSS2.Px2.p1.8.m8.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p1.8.m8.1.1.2.1.cmml" xref="S3.SS2.SSS2.Px2.p1.8.m8.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p1.8.m8.1.1.2.2a.cmml" xref="S3.SS2.SSS2.Px2.p1.8.m8.1.1.2.2"><mtext id="S3.SS2.SSS2.Px2.p1.8.m8.1.1.2.2.cmml" xref="S3.SS2.SSS2.Px2.p1.8.m8.1.1.2.2">ch</mtext></ci><ci id="S3.SS2.SSS2.Px2.p1.8.m8.1.1.2.3.cmml" xref="S3.SS2.SSS2.Px2.p1.8.m8.1.1.2.3">𝑖</ci></apply><plus id="S3.SS2.SSS2.Px2.p1.8.m8.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p1.8.m8.1.1.3"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p1.8.m8.1c">{\text{ch}_{i}}^{+}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px2.p1.8.m8.1d">ch start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="{\text{ch}_{i}}^{-}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px2.p1.9.m9.1"><semantics id="S3.SS2.SSS2.Px2.p1.9.m9.1a"><mmultiscripts id="S3.SS2.SSS2.Px2.p1.9.m9.1.1" xref="S3.SS2.SSS2.Px2.p1.9.m9.1.1.cmml"><mtext id="S3.SS2.SSS2.Px2.p1.9.m9.1.1.2.2" xref="S3.SS2.SSS2.Px2.p1.9.m9.1.1.2.2a.cmml">ch</mtext><mi id="S3.SS2.SSS2.Px2.p1.9.m9.1.1.2.3" xref="S3.SS2.SSS2.Px2.p1.9.m9.1.1.2.3.cmml">i</mi><mrow id="S3.SS2.SSS2.Px2.p1.9.m9.1.1a" xref="S3.SS2.SSS2.Px2.p1.9.m9.1.1.cmml"></mrow><mrow id="S3.SS2.SSS2.Px2.p1.9.m9.1.1b" xref="S3.SS2.SSS2.Px2.p1.9.m9.1.1.cmml"></mrow><mo id="S3.SS2.SSS2.Px2.p1.9.m9.1.1.3" xref="S3.SS2.SSS2.Px2.p1.9.m9.1.1.3.cmml">−</mo></mmultiscripts><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p1.9.m9.1b"><apply id="S3.SS2.SSS2.Px2.p1.9.m9.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p1.9.m9.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.9.m9.1.1">superscript</csymbol><apply id="S3.SS2.SSS2.Px2.p1.9.m9.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p1.9.m9.1.1.2.1.cmml" xref="S3.SS2.SSS2.Px2.p1.9.m9.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p1.9.m9.1.1.2.2a.cmml" xref="S3.SS2.SSS2.Px2.p1.9.m9.1.1.2.2"><mtext id="S3.SS2.SSS2.Px2.p1.9.m9.1.1.2.2.cmml" xref="S3.SS2.SSS2.Px2.p1.9.m9.1.1.2.2">ch</mtext></ci><ci id="S3.SS2.SSS2.Px2.p1.9.m9.1.1.2.3.cmml" xref="S3.SS2.SSS2.Px2.p1.9.m9.1.1.2.3">𝑖</ci></apply><minus id="S3.SS2.SSS2.Px2.p1.9.m9.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p1.9.m9.1.1.3"></minus></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p1.9.m9.1c">{\text{ch}_{i}}^{-}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px2.p1.9.m9.1d">ch start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT</annotation></semantics></math>. Finally, we obtain a triplet <math alttext="(\text{ch}_{i},{\text{ch}_{i}}^{+},{\text{ch}_{i}}^{-})" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px2.p1.10.m10.3"><semantics id="S3.SS2.SSS2.Px2.p1.10.m10.3a"><mrow id="S3.SS2.SSS2.Px2.p1.10.m10.3.3.3" xref="S3.SS2.SSS2.Px2.p1.10.m10.3.3.4.cmml"><mo id="S3.SS2.SSS2.Px2.p1.10.m10.3.3.3.4" stretchy="false" xref="S3.SS2.SSS2.Px2.p1.10.m10.3.3.4.cmml">(</mo><msub id="S3.SS2.SSS2.Px2.p1.10.m10.1.1.1.1" xref="S3.SS2.SSS2.Px2.p1.10.m10.1.1.1.1.cmml"><mtext id="S3.SS2.SSS2.Px2.p1.10.m10.1.1.1.1.2" xref="S3.SS2.SSS2.Px2.p1.10.m10.1.1.1.1.2a.cmml">ch</mtext><mi id="S3.SS2.SSS2.Px2.p1.10.m10.1.1.1.1.3" xref="S3.SS2.SSS2.Px2.p1.10.m10.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS2.SSS2.Px2.p1.10.m10.3.3.3.5" xref="S3.SS2.SSS2.Px2.p1.10.m10.3.3.4.cmml">,</mo><mmultiscripts id="S3.SS2.SSS2.Px2.p1.10.m10.2.2.2.2" xref="S3.SS2.SSS2.Px2.p1.10.m10.2.2.2.2.cmml"><mtext id="S3.SS2.SSS2.Px2.p1.10.m10.2.2.2.2.2.2" xref="S3.SS2.SSS2.Px2.p1.10.m10.2.2.2.2.2.2a.cmml">ch</mtext><mi id="S3.SS2.SSS2.Px2.p1.10.m10.2.2.2.2.2.3" xref="S3.SS2.SSS2.Px2.p1.10.m10.2.2.2.2.2.3.cmml">i</mi><mrow id="S3.SS2.SSS2.Px2.p1.10.m10.2.2.2.2a" xref="S3.SS2.SSS2.Px2.p1.10.m10.2.2.2.2.cmml"></mrow><mrow id="S3.SS2.SSS2.Px2.p1.10.m10.2.2.2.2b" xref="S3.SS2.SSS2.Px2.p1.10.m10.2.2.2.2.cmml"></mrow><mo id="S3.SS2.SSS2.Px2.p1.10.m10.2.2.2.2.3" xref="S3.SS2.SSS2.Px2.p1.10.m10.2.2.2.2.3.cmml">+</mo></mmultiscripts><mo id="S3.SS2.SSS2.Px2.p1.10.m10.3.3.3.6" xref="S3.SS2.SSS2.Px2.p1.10.m10.3.3.4.cmml">,</mo><mmultiscripts id="S3.SS2.SSS2.Px2.p1.10.m10.3.3.3.3" xref="S3.SS2.SSS2.Px2.p1.10.m10.3.3.3.3.cmml"><mtext id="S3.SS2.SSS2.Px2.p1.10.m10.3.3.3.3.2.2" xref="S3.SS2.SSS2.Px2.p1.10.m10.3.3.3.3.2.2a.cmml">ch</mtext><mi id="S3.SS2.SSS2.Px2.p1.10.m10.3.3.3.3.2.3" xref="S3.SS2.SSS2.Px2.p1.10.m10.3.3.3.3.2.3.cmml">i</mi><mrow id="S3.SS2.SSS2.Px2.p1.10.m10.3.3.3.3a" xref="S3.SS2.SSS2.Px2.p1.10.m10.3.3.3.3.cmml"></mrow><mrow id="S3.SS2.SSS2.Px2.p1.10.m10.3.3.3.3b" xref="S3.SS2.SSS2.Px2.p1.10.m10.3.3.3.3.cmml"></mrow><mo id="S3.SS2.SSS2.Px2.p1.10.m10.3.3.3.3.3" xref="S3.SS2.SSS2.Px2.p1.10.m10.3.3.3.3.3.cmml">−</mo></mmultiscripts><mo id="S3.SS2.SSS2.Px2.p1.10.m10.3.3.3.7" stretchy="false" xref="S3.SS2.SSS2.Px2.p1.10.m10.3.3.4.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p1.10.m10.3b"><vector id="S3.SS2.SSS2.Px2.p1.10.m10.3.3.4.cmml" xref="S3.SS2.SSS2.Px2.p1.10.m10.3.3.3"><apply id="S3.SS2.SSS2.Px2.p1.10.m10.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.10.m10.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p1.10.m10.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.10.m10.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p1.10.m10.1.1.1.1.2a.cmml" xref="S3.SS2.SSS2.Px2.p1.10.m10.1.1.1.1.2"><mtext id="S3.SS2.SSS2.Px2.p1.10.m10.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p1.10.m10.1.1.1.1.2">ch</mtext></ci><ci id="S3.SS2.SSS2.Px2.p1.10.m10.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p1.10.m10.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS2.SSS2.Px2.p1.10.m10.2.2.2.2.cmml" xref="S3.SS2.SSS2.Px2.p1.10.m10.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p1.10.m10.2.2.2.2.1.cmml" xref="S3.SS2.SSS2.Px2.p1.10.m10.2.2.2.2">superscript</csymbol><apply id="S3.SS2.SSS2.Px2.p1.10.m10.2.2.2.2.2.cmml" xref="S3.SS2.SSS2.Px2.p1.10.m10.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p1.10.m10.2.2.2.2.2.1.cmml" xref="S3.SS2.SSS2.Px2.p1.10.m10.2.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p1.10.m10.2.2.2.2.2.2a.cmml" xref="S3.SS2.SSS2.Px2.p1.10.m10.2.2.2.2.2.2"><mtext id="S3.SS2.SSS2.Px2.p1.10.m10.2.2.2.2.2.2.cmml" xref="S3.SS2.SSS2.Px2.p1.10.m10.2.2.2.2.2.2">ch</mtext></ci><ci id="S3.SS2.SSS2.Px2.p1.10.m10.2.2.2.2.2.3.cmml" xref="S3.SS2.SSS2.Px2.p1.10.m10.2.2.2.2.2.3">𝑖</ci></apply><plus id="S3.SS2.SSS2.Px2.p1.10.m10.2.2.2.2.3.cmml" xref="S3.SS2.SSS2.Px2.p1.10.m10.2.2.2.2.3"></plus></apply><apply id="S3.SS2.SSS2.Px2.p1.10.m10.3.3.3.3.cmml" xref="S3.SS2.SSS2.Px2.p1.10.m10.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p1.10.m10.3.3.3.3.1.cmml" xref="S3.SS2.SSS2.Px2.p1.10.m10.3.3.3.3">superscript</csymbol><apply id="S3.SS2.SSS2.Px2.p1.10.m10.3.3.3.3.2.cmml" xref="S3.SS2.SSS2.Px2.p1.10.m10.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p1.10.m10.3.3.3.3.2.1.cmml" xref="S3.SS2.SSS2.Px2.p1.10.m10.3.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p1.10.m10.3.3.3.3.2.2a.cmml" xref="S3.SS2.SSS2.Px2.p1.10.m10.3.3.3.3.2.2"><mtext id="S3.SS2.SSS2.Px2.p1.10.m10.3.3.3.3.2.2.cmml" xref="S3.SS2.SSS2.Px2.p1.10.m10.3.3.3.3.2.2">ch</mtext></ci><ci id="S3.SS2.SSS2.Px2.p1.10.m10.3.3.3.3.2.3.cmml" xref="S3.SS2.SSS2.Px2.p1.10.m10.3.3.3.3.2.3">𝑖</ci></apply><minus id="S3.SS2.SSS2.Px2.p1.10.m10.3.3.3.3.3.cmml" xref="S3.SS2.SSS2.Px2.p1.10.m10.3.3.3.3.3"></minus></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p1.10.m10.3c">(\text{ch}_{i},{\text{ch}_{i}}^{+},{\text{ch}_{i}}^{-})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px2.p1.10.m10.3d">( ch start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , ch start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT , ch start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT )</annotation></semantics></math>. By repeating this sampling process, we can scale the number of positive and negative samples for the anchor <math alttext="\text{ch}_{i}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px2.p1.11.m11.1"><semantics id="S3.SS2.SSS2.Px2.p1.11.m11.1a"><msub id="S3.SS2.SSS2.Px2.p1.11.m11.1.1" xref="S3.SS2.SSS2.Px2.p1.11.m11.1.1.cmml"><mtext id="S3.SS2.SSS2.Px2.p1.11.m11.1.1.2" xref="S3.SS2.SSS2.Px2.p1.11.m11.1.1.2a.cmml">ch</mtext><mi id="S3.SS2.SSS2.Px2.p1.11.m11.1.1.3" xref="S3.SS2.SSS2.Px2.p1.11.m11.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p1.11.m11.1b"><apply id="S3.SS2.SSS2.Px2.p1.11.m11.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p1.11.m11.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.11.m11.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p1.11.m11.1.1.2a.cmml" xref="S3.SS2.SSS2.Px2.p1.11.m11.1.1.2"><mtext id="S3.SS2.SSS2.Px2.p1.11.m11.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p1.11.m11.1.1.2">ch</mtext></ci><ci id="S3.SS2.SSS2.Px2.p1.11.m11.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p1.11.m11.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p1.11.m11.1c">\text{ch}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px2.p1.11.m11.1d">ch start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
</section>
</section>
<section class="ltx_subsubsection" id="S3.SS2.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.3 </span>Contrastive Learning</h4>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS3.p1">
<p class="ltx_p" id="S3.SS2.SSS3.p1.16">We design a contrastive learning strategy to train our retrieval model:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{2K-1}=-\log\frac{e^{f\left(\text{ch}_{i},{\text{ch}_{i}}^{+}%
\right)}}{e^{f\left(\text{ch}_{i},{\text{ch}_{i}}^{+}\right)}+\sum_{j=1}^{2K-2%
}e^{f\left(\text{ch}_{i},{\text{ch}_{j}}\right)}+e^{f\left(\text{ch}_{i},{%
\text{ch}_{i}}^{-}\right)}}," class="ltx_Math" display="block" id="S3.E5.m1.9"><semantics id="S3.E5.m1.9a"><mrow id="S3.E5.m1.9.9.1" xref="S3.E5.m1.9.9.1.1.cmml"><mrow id="S3.E5.m1.9.9.1.1" xref="S3.E5.m1.9.9.1.1.cmml"><msub id="S3.E5.m1.9.9.1.1.2" xref="S3.E5.m1.9.9.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.9.9.1.1.2.2" xref="S3.E5.m1.9.9.1.1.2.2.cmml">ℒ</mi><mrow id="S3.E5.m1.9.9.1.1.2.3" xref="S3.E5.m1.9.9.1.1.2.3.cmml"><mrow id="S3.E5.m1.9.9.1.1.2.3.2" xref="S3.E5.m1.9.9.1.1.2.3.2.cmml"><mn id="S3.E5.m1.9.9.1.1.2.3.2.2" xref="S3.E5.m1.9.9.1.1.2.3.2.2.cmml">2</mn><mo id="S3.E5.m1.9.9.1.1.2.3.2.1" xref="S3.E5.m1.9.9.1.1.2.3.2.1.cmml">⁢</mo><mi id="S3.E5.m1.9.9.1.1.2.3.2.3" xref="S3.E5.m1.9.9.1.1.2.3.2.3.cmml">K</mi></mrow><mo id="S3.E5.m1.9.9.1.1.2.3.1" xref="S3.E5.m1.9.9.1.1.2.3.1.cmml">−</mo><mn id="S3.E5.m1.9.9.1.1.2.3.3" xref="S3.E5.m1.9.9.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="S3.E5.m1.9.9.1.1.1" xref="S3.E5.m1.9.9.1.1.1.cmml">=</mo><mrow id="S3.E5.m1.9.9.1.1.3" xref="S3.E5.m1.9.9.1.1.3.cmml"><mo id="S3.E5.m1.9.9.1.1.3a" rspace="0.167em" xref="S3.E5.m1.9.9.1.1.3.cmml">−</mo><mrow id="S3.E5.m1.9.9.1.1.3.2" xref="S3.E5.m1.9.9.1.1.3.2.cmml"><mi id="S3.E5.m1.9.9.1.1.3.2.1" xref="S3.E5.m1.9.9.1.1.3.2.1.cmml">log</mi><mo id="S3.E5.m1.9.9.1.1.3.2a" lspace="0.167em" xref="S3.E5.m1.9.9.1.1.3.2.cmml">⁡</mo><mfrac id="S3.E5.m1.8.8" xref="S3.E5.m1.8.8.cmml"><msup id="S3.E5.m1.2.2.2" xref="S3.E5.m1.2.2.2.cmml"><mi id="S3.E5.m1.2.2.2.4" xref="S3.E5.m1.2.2.2.4.cmml">e</mi><mrow id="S3.E5.m1.2.2.2.2.2" xref="S3.E5.m1.2.2.2.2.2.cmml"><mi id="S3.E5.m1.2.2.2.2.2.4" xref="S3.E5.m1.2.2.2.2.2.4.cmml">f</mi><mo id="S3.E5.m1.2.2.2.2.2.3" xref="S3.E5.m1.2.2.2.2.2.3.cmml">⁢</mo><mrow id="S3.E5.m1.2.2.2.2.2.2.2" xref="S3.E5.m1.2.2.2.2.2.2.3.cmml"><mo id="S3.E5.m1.2.2.2.2.2.2.2.3" xref="S3.E5.m1.2.2.2.2.2.2.3.cmml">(</mo><msub id="S3.E5.m1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.1.1.cmml"><mtext id="S3.E5.m1.1.1.1.1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.1.1.1.1.2a.cmml">ch</mtext><mi id="S3.E5.m1.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E5.m1.2.2.2.2.2.2.2.4" xref="S3.E5.m1.2.2.2.2.2.2.3.cmml">,</mo><mmultiscripts id="S3.E5.m1.2.2.2.2.2.2.2.2" xref="S3.E5.m1.2.2.2.2.2.2.2.2.cmml"><mtext id="S3.E5.m1.2.2.2.2.2.2.2.2.2.2" xref="S3.E5.m1.2.2.2.2.2.2.2.2.2.2a.cmml">ch</mtext><mi id="S3.E5.m1.2.2.2.2.2.2.2.2.2.3" xref="S3.E5.m1.2.2.2.2.2.2.2.2.2.3.cmml">i</mi><mrow id="S3.E5.m1.2.2.2.2.2.2.2.2a" xref="S3.E5.m1.2.2.2.2.2.2.2.2.cmml"></mrow><mrow id="S3.E5.m1.2.2.2.2.2.2.2.2b" xref="S3.E5.m1.2.2.2.2.2.2.2.2.cmml"></mrow><mo id="S3.E5.m1.2.2.2.2.2.2.2.2.3" xref="S3.E5.m1.2.2.2.2.2.2.2.2.3.cmml">+</mo></mmultiscripts><mo id="S3.E5.m1.2.2.2.2.2.2.2.5" xref="S3.E5.m1.2.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></msup><mrow id="S3.E5.m1.8.8.8" xref="S3.E5.m1.8.8.8.cmml"><msup id="S3.E5.m1.8.8.8.8" xref="S3.E5.m1.8.8.8.8.cmml"><mi id="S3.E5.m1.8.8.8.8.2" xref="S3.E5.m1.8.8.8.8.2.cmml">e</mi><mrow id="S3.E5.m1.4.4.4.2.2" xref="S3.E5.m1.4.4.4.2.2.cmml"><mi id="S3.E5.m1.4.4.4.2.2.4" xref="S3.E5.m1.4.4.4.2.2.4.cmml">f</mi><mo id="S3.E5.m1.4.4.4.2.2.3" xref="S3.E5.m1.4.4.4.2.2.3.cmml">⁢</mo><mrow id="S3.E5.m1.4.4.4.2.2.2.2" xref="S3.E5.m1.4.4.4.2.2.2.3.cmml"><mo id="S3.E5.m1.4.4.4.2.2.2.2.3" xref="S3.E5.m1.4.4.4.2.2.2.3.cmml">(</mo><msub id="S3.E5.m1.3.3.3.1.1.1.1.1" xref="S3.E5.m1.3.3.3.1.1.1.1.1.cmml"><mtext id="S3.E5.m1.3.3.3.1.1.1.1.1.2" xref="S3.E5.m1.3.3.3.1.1.1.1.1.2a.cmml">ch</mtext><mi id="S3.E5.m1.3.3.3.1.1.1.1.1.3" xref="S3.E5.m1.3.3.3.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E5.m1.4.4.4.2.2.2.2.4" xref="S3.E5.m1.4.4.4.2.2.2.3.cmml">,</mo><mmultiscripts id="S3.E5.m1.4.4.4.2.2.2.2.2" xref="S3.E5.m1.4.4.4.2.2.2.2.2.cmml"><mtext id="S3.E5.m1.4.4.4.2.2.2.2.2.2.2" xref="S3.E5.m1.4.4.4.2.2.2.2.2.2.2a.cmml">ch</mtext><mi id="S3.E5.m1.4.4.4.2.2.2.2.2.2.3" xref="S3.E5.m1.4.4.4.2.2.2.2.2.2.3.cmml">i</mi><mrow id="S3.E5.m1.4.4.4.2.2.2.2.2a" xref="S3.E5.m1.4.4.4.2.2.2.2.2.cmml"></mrow><mrow id="S3.E5.m1.4.4.4.2.2.2.2.2b" xref="S3.E5.m1.4.4.4.2.2.2.2.2.cmml"></mrow><mo id="S3.E5.m1.4.4.4.2.2.2.2.2.3" xref="S3.E5.m1.4.4.4.2.2.2.2.2.3.cmml">+</mo></mmultiscripts><mo id="S3.E5.m1.4.4.4.2.2.2.2.5" xref="S3.E5.m1.4.4.4.2.2.2.3.cmml">)</mo></mrow></mrow></msup><mo id="S3.E5.m1.8.8.8.7" rspace="0.055em" xref="S3.E5.m1.8.8.8.7.cmml">+</mo><mrow id="S3.E5.m1.8.8.8.9" xref="S3.E5.m1.8.8.8.9.cmml"><msubsup id="S3.E5.m1.8.8.8.9.1" xref="S3.E5.m1.8.8.8.9.1.cmml"><mo id="S3.E5.m1.8.8.8.9.1.2.2" xref="S3.E5.m1.8.8.8.9.1.2.2.cmml">∑</mo><mrow id="S3.E5.m1.8.8.8.9.1.2.3" xref="S3.E5.m1.8.8.8.9.1.2.3.cmml"><mi id="S3.E5.m1.8.8.8.9.1.2.3.2" xref="S3.E5.m1.8.8.8.9.1.2.3.2.cmml">j</mi><mo id="S3.E5.m1.8.8.8.9.1.2.3.1" xref="S3.E5.m1.8.8.8.9.1.2.3.1.cmml">=</mo><mn id="S3.E5.m1.8.8.8.9.1.2.3.3" xref="S3.E5.m1.8.8.8.9.1.2.3.3.cmml">1</mn></mrow><mrow id="S3.E5.m1.8.8.8.9.1.3" xref="S3.E5.m1.8.8.8.9.1.3.cmml"><mrow id="S3.E5.m1.8.8.8.9.1.3.2" xref="S3.E5.m1.8.8.8.9.1.3.2.cmml"><mn id="S3.E5.m1.8.8.8.9.1.3.2.2" xref="S3.E5.m1.8.8.8.9.1.3.2.2.cmml">2</mn><mo id="S3.E5.m1.8.8.8.9.1.3.2.1" xref="S3.E5.m1.8.8.8.9.1.3.2.1.cmml">⁢</mo><mi id="S3.E5.m1.8.8.8.9.1.3.2.3" xref="S3.E5.m1.8.8.8.9.1.3.2.3.cmml">K</mi></mrow><mo id="S3.E5.m1.8.8.8.9.1.3.1" xref="S3.E5.m1.8.8.8.9.1.3.1.cmml">−</mo><mn id="S3.E5.m1.8.8.8.9.1.3.3" xref="S3.E5.m1.8.8.8.9.1.3.3.cmml">2</mn></mrow></msubsup><msup id="S3.E5.m1.8.8.8.9.2" xref="S3.E5.m1.8.8.8.9.2.cmml"><mi id="S3.E5.m1.8.8.8.9.2.2" xref="S3.E5.m1.8.8.8.9.2.2.cmml">e</mi><mrow id="S3.E5.m1.6.6.6.4.2" xref="S3.E5.m1.6.6.6.4.2.cmml"><mi id="S3.E5.m1.6.6.6.4.2.4" xref="S3.E5.m1.6.6.6.4.2.4.cmml">f</mi><mo id="S3.E5.m1.6.6.6.4.2.3" xref="S3.E5.m1.6.6.6.4.2.3.cmml">⁢</mo><mrow id="S3.E5.m1.6.6.6.4.2.2.2" xref="S3.E5.m1.6.6.6.4.2.2.3.cmml"><mo id="S3.E5.m1.6.6.6.4.2.2.2.3" xref="S3.E5.m1.6.6.6.4.2.2.3.cmml">(</mo><msub id="S3.E5.m1.5.5.5.3.1.1.1.1" xref="S3.E5.m1.5.5.5.3.1.1.1.1.cmml"><mtext id="S3.E5.m1.5.5.5.3.1.1.1.1.2" xref="S3.E5.m1.5.5.5.3.1.1.1.1.2a.cmml">ch</mtext><mi id="S3.E5.m1.5.5.5.3.1.1.1.1.3" xref="S3.E5.m1.5.5.5.3.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E5.m1.6.6.6.4.2.2.2.4" xref="S3.E5.m1.6.6.6.4.2.2.3.cmml">,</mo><msub id="S3.E5.m1.6.6.6.4.2.2.2.2" xref="S3.E5.m1.6.6.6.4.2.2.2.2.cmml"><mtext id="S3.E5.m1.6.6.6.4.2.2.2.2.2" xref="S3.E5.m1.6.6.6.4.2.2.2.2.2a.cmml">ch</mtext><mi id="S3.E5.m1.6.6.6.4.2.2.2.2.3" xref="S3.E5.m1.6.6.6.4.2.2.2.2.3.cmml">j</mi></msub><mo id="S3.E5.m1.6.6.6.4.2.2.2.5" xref="S3.E5.m1.6.6.6.4.2.2.3.cmml">)</mo></mrow></mrow></msup></mrow><mo id="S3.E5.m1.8.8.8.7a" xref="S3.E5.m1.8.8.8.7.cmml">+</mo><msup id="S3.E5.m1.8.8.8.10" xref="S3.E5.m1.8.8.8.10.cmml"><mi id="S3.E5.m1.8.8.8.10.2" xref="S3.E5.m1.8.8.8.10.2.cmml">e</mi><mrow id="S3.E5.m1.8.8.8.6.2" xref="S3.E5.m1.8.8.8.6.2.cmml"><mi id="S3.E5.m1.8.8.8.6.2.4" xref="S3.E5.m1.8.8.8.6.2.4.cmml">f</mi><mo id="S3.E5.m1.8.8.8.6.2.3" xref="S3.E5.m1.8.8.8.6.2.3.cmml">⁢</mo><mrow id="S3.E5.m1.8.8.8.6.2.2.2" xref="S3.E5.m1.8.8.8.6.2.2.3.cmml"><mo id="S3.E5.m1.8.8.8.6.2.2.2.3" xref="S3.E5.m1.8.8.8.6.2.2.3.cmml">(</mo><msub id="S3.E5.m1.7.7.7.5.1.1.1.1" xref="S3.E5.m1.7.7.7.5.1.1.1.1.cmml"><mtext id="S3.E5.m1.7.7.7.5.1.1.1.1.2" xref="S3.E5.m1.7.7.7.5.1.1.1.1.2a.cmml">ch</mtext><mi id="S3.E5.m1.7.7.7.5.1.1.1.1.3" xref="S3.E5.m1.7.7.7.5.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E5.m1.8.8.8.6.2.2.2.4" xref="S3.E5.m1.8.8.8.6.2.2.3.cmml">,</mo><mmultiscripts id="S3.E5.m1.8.8.8.6.2.2.2.2" xref="S3.E5.m1.8.8.8.6.2.2.2.2.cmml"><mtext id="S3.E5.m1.8.8.8.6.2.2.2.2.2.2" xref="S3.E5.m1.8.8.8.6.2.2.2.2.2.2a.cmml">ch</mtext><mi id="S3.E5.m1.8.8.8.6.2.2.2.2.2.3" xref="S3.E5.m1.8.8.8.6.2.2.2.2.2.3.cmml">i</mi><mrow id="S3.E5.m1.8.8.8.6.2.2.2.2a" xref="S3.E5.m1.8.8.8.6.2.2.2.2.cmml"></mrow><mrow id="S3.E5.m1.8.8.8.6.2.2.2.2b" xref="S3.E5.m1.8.8.8.6.2.2.2.2.cmml"></mrow><mo id="S3.E5.m1.8.8.8.6.2.2.2.2.3" xref="S3.E5.m1.8.8.8.6.2.2.2.2.3.cmml">−</mo></mmultiscripts><mo id="S3.E5.m1.8.8.8.6.2.2.2.5" xref="S3.E5.m1.8.8.8.6.2.2.3.cmml">)</mo></mrow></mrow></msup></mrow></mfrac></mrow></mrow></mrow><mo id="S3.E5.m1.9.9.1.2" xref="S3.E5.m1.9.9.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.9b"><apply id="S3.E5.m1.9.9.1.1.cmml" xref="S3.E5.m1.9.9.1"><eq id="S3.E5.m1.9.9.1.1.1.cmml" xref="S3.E5.m1.9.9.1.1.1"></eq><apply id="S3.E5.m1.9.9.1.1.2.cmml" xref="S3.E5.m1.9.9.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.9.9.1.1.2.1.cmml" xref="S3.E5.m1.9.9.1.1.2">subscript</csymbol><ci id="S3.E5.m1.9.9.1.1.2.2.cmml" xref="S3.E5.m1.9.9.1.1.2.2">ℒ</ci><apply id="S3.E5.m1.9.9.1.1.2.3.cmml" xref="S3.E5.m1.9.9.1.1.2.3"><minus id="S3.E5.m1.9.9.1.1.2.3.1.cmml" xref="S3.E5.m1.9.9.1.1.2.3.1"></minus><apply id="S3.E5.m1.9.9.1.1.2.3.2.cmml" xref="S3.E5.m1.9.9.1.1.2.3.2"><times id="S3.E5.m1.9.9.1.1.2.3.2.1.cmml" xref="S3.E5.m1.9.9.1.1.2.3.2.1"></times><cn id="S3.E5.m1.9.9.1.1.2.3.2.2.cmml" type="integer" xref="S3.E5.m1.9.9.1.1.2.3.2.2">2</cn><ci id="S3.E5.m1.9.9.1.1.2.3.2.3.cmml" xref="S3.E5.m1.9.9.1.1.2.3.2.3">𝐾</ci></apply><cn id="S3.E5.m1.9.9.1.1.2.3.3.cmml" type="integer" xref="S3.E5.m1.9.9.1.1.2.3.3">1</cn></apply></apply><apply id="S3.E5.m1.9.9.1.1.3.cmml" xref="S3.E5.m1.9.9.1.1.3"><minus id="S3.E5.m1.9.9.1.1.3.1.cmml" xref="S3.E5.m1.9.9.1.1.3"></minus><apply id="S3.E5.m1.9.9.1.1.3.2.cmml" xref="S3.E5.m1.9.9.1.1.3.2"><log id="S3.E5.m1.9.9.1.1.3.2.1.cmml" xref="S3.E5.m1.9.9.1.1.3.2.1"></log><apply id="S3.E5.m1.8.8.cmml" xref="S3.E5.m1.8.8"><divide id="S3.E5.m1.8.8.9.cmml" xref="S3.E5.m1.8.8"></divide><apply id="S3.E5.m1.2.2.2.cmml" xref="S3.E5.m1.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.2.3.cmml" xref="S3.E5.m1.2.2.2">superscript</csymbol><ci id="S3.E5.m1.2.2.2.4.cmml" xref="S3.E5.m1.2.2.2.4">𝑒</ci><apply id="S3.E5.m1.2.2.2.2.2.cmml" xref="S3.E5.m1.2.2.2.2.2"><times id="S3.E5.m1.2.2.2.2.2.3.cmml" xref="S3.E5.m1.2.2.2.2.2.3"></times><ci id="S3.E5.m1.2.2.2.2.2.4.cmml" xref="S3.E5.m1.2.2.2.2.2.4">𝑓</ci><interval closure="open" id="S3.E5.m1.2.2.2.2.2.2.3.cmml" xref="S3.E5.m1.2.2.2.2.2.2.2"><apply id="S3.E5.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.1.1.1.2a.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.2"><mtext id="S3.E5.m1.1.1.1.1.1.1.1.1.2.cmml" mathsize="70%" xref="S3.E5.m1.1.1.1.1.1.1.1.1.2">ch</mtext></ci><ci id="S3.E5.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E5.m1.2.2.2.2.2.2.2.2.cmml" xref="S3.E5.m1.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.2.2.2.2.2.2.1.cmml" xref="S3.E5.m1.2.2.2.2.2.2.2.2">superscript</csymbol><apply id="S3.E5.m1.2.2.2.2.2.2.2.2.2.cmml" xref="S3.E5.m1.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.2.2.2.2.2.2.2.1.cmml" xref="S3.E5.m1.2.2.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E5.m1.2.2.2.2.2.2.2.2.2.2a.cmml" xref="S3.E5.m1.2.2.2.2.2.2.2.2.2.2"><mtext id="S3.E5.m1.2.2.2.2.2.2.2.2.2.2.cmml" mathsize="70%" xref="S3.E5.m1.2.2.2.2.2.2.2.2.2.2">ch</mtext></ci><ci id="S3.E5.m1.2.2.2.2.2.2.2.2.2.3.cmml" xref="S3.E5.m1.2.2.2.2.2.2.2.2.2.3">𝑖</ci></apply><plus id="S3.E5.m1.2.2.2.2.2.2.2.2.3.cmml" xref="S3.E5.m1.2.2.2.2.2.2.2.2.3"></plus></apply></interval></apply></apply><apply id="S3.E5.m1.8.8.8.cmml" xref="S3.E5.m1.8.8.8"><plus id="S3.E5.m1.8.8.8.7.cmml" xref="S3.E5.m1.8.8.8.7"></plus><apply id="S3.E5.m1.8.8.8.8.cmml" xref="S3.E5.m1.8.8.8.8"><csymbol cd="ambiguous" id="S3.E5.m1.8.8.8.8.1.cmml" xref="S3.E5.m1.8.8.8.8">superscript</csymbol><ci id="S3.E5.m1.8.8.8.8.2.cmml" xref="S3.E5.m1.8.8.8.8.2">𝑒</ci><apply id="S3.E5.m1.4.4.4.2.2.cmml" xref="S3.E5.m1.4.4.4.2.2"><times id="S3.E5.m1.4.4.4.2.2.3.cmml" xref="S3.E5.m1.4.4.4.2.2.3"></times><ci id="S3.E5.m1.4.4.4.2.2.4.cmml" xref="S3.E5.m1.4.4.4.2.2.4">𝑓</ci><interval closure="open" id="S3.E5.m1.4.4.4.2.2.2.3.cmml" xref="S3.E5.m1.4.4.4.2.2.2.2"><apply id="S3.E5.m1.3.3.3.1.1.1.1.1.cmml" xref="S3.E5.m1.3.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.3.1.1.1.1.1.1.cmml" xref="S3.E5.m1.3.3.3.1.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.3.3.3.1.1.1.1.1.2a.cmml" xref="S3.E5.m1.3.3.3.1.1.1.1.1.2"><mtext id="S3.E5.m1.3.3.3.1.1.1.1.1.2.cmml" mathsize="70%" xref="S3.E5.m1.3.3.3.1.1.1.1.1.2">ch</mtext></ci><ci id="S3.E5.m1.3.3.3.1.1.1.1.1.3.cmml" xref="S3.E5.m1.3.3.3.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E5.m1.4.4.4.2.2.2.2.2.cmml" xref="S3.E5.m1.4.4.4.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.4.2.2.2.2.2.1.cmml" xref="S3.E5.m1.4.4.4.2.2.2.2.2">superscript</csymbol><apply id="S3.E5.m1.4.4.4.2.2.2.2.2.2.cmml" xref="S3.E5.m1.4.4.4.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.4.2.2.2.2.2.2.1.cmml" xref="S3.E5.m1.4.4.4.2.2.2.2.2">subscript</csymbol><ci id="S3.E5.m1.4.4.4.2.2.2.2.2.2.2a.cmml" xref="S3.E5.m1.4.4.4.2.2.2.2.2.2.2"><mtext id="S3.E5.m1.4.4.4.2.2.2.2.2.2.2.cmml" mathsize="70%" xref="S3.E5.m1.4.4.4.2.2.2.2.2.2.2">ch</mtext></ci><ci id="S3.E5.m1.4.4.4.2.2.2.2.2.2.3.cmml" xref="S3.E5.m1.4.4.4.2.2.2.2.2.2.3">𝑖</ci></apply><plus id="S3.E5.m1.4.4.4.2.2.2.2.2.3.cmml" xref="S3.E5.m1.4.4.4.2.2.2.2.2.3"></plus></apply></interval></apply></apply><apply id="S3.E5.m1.8.8.8.9.cmml" xref="S3.E5.m1.8.8.8.9"><apply id="S3.E5.m1.8.8.8.9.1.cmml" xref="S3.E5.m1.8.8.8.9.1"><csymbol cd="ambiguous" id="S3.E5.m1.8.8.8.9.1.1.cmml" xref="S3.E5.m1.8.8.8.9.1">superscript</csymbol><apply id="S3.E5.m1.8.8.8.9.1.2.cmml" xref="S3.E5.m1.8.8.8.9.1"><csymbol cd="ambiguous" id="S3.E5.m1.8.8.8.9.1.2.1.cmml" xref="S3.E5.m1.8.8.8.9.1">subscript</csymbol><sum id="S3.E5.m1.8.8.8.9.1.2.2.cmml" xref="S3.E5.m1.8.8.8.9.1.2.2"></sum><apply id="S3.E5.m1.8.8.8.9.1.2.3.cmml" xref="S3.E5.m1.8.8.8.9.1.2.3"><eq id="S3.E5.m1.8.8.8.9.1.2.3.1.cmml" xref="S3.E5.m1.8.8.8.9.1.2.3.1"></eq><ci id="S3.E5.m1.8.8.8.9.1.2.3.2.cmml" xref="S3.E5.m1.8.8.8.9.1.2.3.2">𝑗</ci><cn id="S3.E5.m1.8.8.8.9.1.2.3.3.cmml" type="integer" xref="S3.E5.m1.8.8.8.9.1.2.3.3">1</cn></apply></apply><apply id="S3.E5.m1.8.8.8.9.1.3.cmml" xref="S3.E5.m1.8.8.8.9.1.3"><minus id="S3.E5.m1.8.8.8.9.1.3.1.cmml" xref="S3.E5.m1.8.8.8.9.1.3.1"></minus><apply id="S3.E5.m1.8.8.8.9.1.3.2.cmml" xref="S3.E5.m1.8.8.8.9.1.3.2"><times id="S3.E5.m1.8.8.8.9.1.3.2.1.cmml" xref="S3.E5.m1.8.8.8.9.1.3.2.1"></times><cn id="S3.E5.m1.8.8.8.9.1.3.2.2.cmml" type="integer" xref="S3.E5.m1.8.8.8.9.1.3.2.2">2</cn><ci id="S3.E5.m1.8.8.8.9.1.3.2.3.cmml" xref="S3.E5.m1.8.8.8.9.1.3.2.3">𝐾</ci></apply><cn id="S3.E5.m1.8.8.8.9.1.3.3.cmml" type="integer" xref="S3.E5.m1.8.8.8.9.1.3.3">2</cn></apply></apply><apply id="S3.E5.m1.8.8.8.9.2.cmml" xref="S3.E5.m1.8.8.8.9.2"><csymbol cd="ambiguous" id="S3.E5.m1.8.8.8.9.2.1.cmml" xref="S3.E5.m1.8.8.8.9.2">superscript</csymbol><ci id="S3.E5.m1.8.8.8.9.2.2.cmml" xref="S3.E5.m1.8.8.8.9.2.2">𝑒</ci><apply id="S3.E5.m1.6.6.6.4.2.cmml" xref="S3.E5.m1.6.6.6.4.2"><times id="S3.E5.m1.6.6.6.4.2.3.cmml" xref="S3.E5.m1.6.6.6.4.2.3"></times><ci id="S3.E5.m1.6.6.6.4.2.4.cmml" xref="S3.E5.m1.6.6.6.4.2.4">𝑓</ci><interval closure="open" id="S3.E5.m1.6.6.6.4.2.2.3.cmml" xref="S3.E5.m1.6.6.6.4.2.2.2"><apply id="S3.E5.m1.5.5.5.3.1.1.1.1.cmml" xref="S3.E5.m1.5.5.5.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.5.3.1.1.1.1.1.cmml" xref="S3.E5.m1.5.5.5.3.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.5.5.5.3.1.1.1.1.2a.cmml" xref="S3.E5.m1.5.5.5.3.1.1.1.1.2"><mtext id="S3.E5.m1.5.5.5.3.1.1.1.1.2.cmml" mathsize="70%" xref="S3.E5.m1.5.5.5.3.1.1.1.1.2">ch</mtext></ci><ci id="S3.E5.m1.5.5.5.3.1.1.1.1.3.cmml" xref="S3.E5.m1.5.5.5.3.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E5.m1.6.6.6.4.2.2.2.2.cmml" xref="S3.E5.m1.6.6.6.4.2.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.6.6.6.4.2.2.2.2.1.cmml" xref="S3.E5.m1.6.6.6.4.2.2.2.2">subscript</csymbol><ci id="S3.E5.m1.6.6.6.4.2.2.2.2.2a.cmml" xref="S3.E5.m1.6.6.6.4.2.2.2.2.2"><mtext id="S3.E5.m1.6.6.6.4.2.2.2.2.2.cmml" mathsize="70%" xref="S3.E5.m1.6.6.6.4.2.2.2.2.2">ch</mtext></ci><ci id="S3.E5.m1.6.6.6.4.2.2.2.2.3.cmml" xref="S3.E5.m1.6.6.6.4.2.2.2.2.3">𝑗</ci></apply></interval></apply></apply></apply><apply id="S3.E5.m1.8.8.8.10.cmml" xref="S3.E5.m1.8.8.8.10"><csymbol cd="ambiguous" id="S3.E5.m1.8.8.8.10.1.cmml" xref="S3.E5.m1.8.8.8.10">superscript</csymbol><ci id="S3.E5.m1.8.8.8.10.2.cmml" xref="S3.E5.m1.8.8.8.10.2">𝑒</ci><apply id="S3.E5.m1.8.8.8.6.2.cmml" xref="S3.E5.m1.8.8.8.6.2"><times id="S3.E5.m1.8.8.8.6.2.3.cmml" xref="S3.E5.m1.8.8.8.6.2.3"></times><ci id="S3.E5.m1.8.8.8.6.2.4.cmml" xref="S3.E5.m1.8.8.8.6.2.4">𝑓</ci><interval closure="open" id="S3.E5.m1.8.8.8.6.2.2.3.cmml" xref="S3.E5.m1.8.8.8.6.2.2.2"><apply id="S3.E5.m1.7.7.7.5.1.1.1.1.cmml" xref="S3.E5.m1.7.7.7.5.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.7.5.1.1.1.1.1.cmml" xref="S3.E5.m1.7.7.7.5.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.7.7.7.5.1.1.1.1.2a.cmml" xref="S3.E5.m1.7.7.7.5.1.1.1.1.2"><mtext id="S3.E5.m1.7.7.7.5.1.1.1.1.2.cmml" mathsize="70%" xref="S3.E5.m1.7.7.7.5.1.1.1.1.2">ch</mtext></ci><ci id="S3.E5.m1.7.7.7.5.1.1.1.1.3.cmml" xref="S3.E5.m1.7.7.7.5.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E5.m1.8.8.8.6.2.2.2.2.cmml" xref="S3.E5.m1.8.8.8.6.2.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.8.8.8.6.2.2.2.2.1.cmml" xref="S3.E5.m1.8.8.8.6.2.2.2.2">superscript</csymbol><apply id="S3.E5.m1.8.8.8.6.2.2.2.2.2.cmml" xref="S3.E5.m1.8.8.8.6.2.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.8.8.8.6.2.2.2.2.2.1.cmml" xref="S3.E5.m1.8.8.8.6.2.2.2.2">subscript</csymbol><ci id="S3.E5.m1.8.8.8.6.2.2.2.2.2.2a.cmml" xref="S3.E5.m1.8.8.8.6.2.2.2.2.2.2"><mtext id="S3.E5.m1.8.8.8.6.2.2.2.2.2.2.cmml" mathsize="70%" xref="S3.E5.m1.8.8.8.6.2.2.2.2.2.2">ch</mtext></ci><ci id="S3.E5.m1.8.8.8.6.2.2.2.2.2.3.cmml" xref="S3.E5.m1.8.8.8.6.2.2.2.2.2.3">𝑖</ci></apply><minus id="S3.E5.m1.8.8.8.6.2.2.2.2.3.cmml" xref="S3.E5.m1.8.8.8.6.2.2.2.2.3"></minus></apply></interval></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.9c">\mathcal{L}_{2K-1}=-\log\frac{e^{f\left(\text{ch}_{i},{\text{ch}_{i}}^{+}%
\right)}}{e^{f\left(\text{ch}_{i},{\text{ch}_{i}}^{+}\right)}+\sum_{j=1}^{2K-2%
}e^{f\left(\text{ch}_{i},{\text{ch}_{j}}\right)}+e^{f\left(\text{ch}_{i},{%
\text{ch}_{i}}^{-}\right)}},</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.9d">caligraphic_L start_POSTSUBSCRIPT 2 italic_K - 1 end_POSTSUBSCRIPT = - roman_log divide start_ARG italic_e start_POSTSUPERSCRIPT italic_f ( ch start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , ch start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT ) end_POSTSUPERSCRIPT end_ARG start_ARG italic_e start_POSTSUPERSCRIPT italic_f ( ch start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , ch start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT ) end_POSTSUPERSCRIPT + ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 italic_K - 2 end_POSTSUPERSCRIPT italic_e start_POSTSUPERSCRIPT italic_f ( ch start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , ch start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) end_POSTSUPERSCRIPT + italic_e start_POSTSUPERSCRIPT italic_f ( ch start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , ch start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT ) end_POSTSUPERSCRIPT end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS3.p1.11">where <math alttext="\text{ch}_{i}" class="ltx_Math" display="inline" id="S3.SS2.SSS3.p1.1.m1.1"><semantics id="S3.SS2.SSS3.p1.1.m1.1a"><msub id="S3.SS2.SSS3.p1.1.m1.1.1" xref="S3.SS2.SSS3.p1.1.m1.1.1.cmml"><mtext id="S3.SS2.SSS3.p1.1.m1.1.1.2" xref="S3.SS2.SSS3.p1.1.m1.1.1.2a.cmml">ch</mtext><mi id="S3.SS2.SSS3.p1.1.m1.1.1.3" xref="S3.SS2.SSS3.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p1.1.m1.1b"><apply id="S3.SS2.SSS3.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p1.1.m1.1.1.1.cmml" xref="S3.SS2.SSS3.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.p1.1.m1.1.1.2a.cmml" xref="S3.SS2.SSS3.p1.1.m1.1.1.2"><mtext id="S3.SS2.SSS3.p1.1.m1.1.1.2.cmml" xref="S3.SS2.SSS3.p1.1.m1.1.1.2">ch</mtext></ci><ci id="S3.SS2.SSS3.p1.1.m1.1.1.3.cmml" xref="S3.SS2.SSS3.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p1.1.m1.1c">\text{ch}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p1.1.m1.1d">ch start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> represents the anchor chunk, which is the chunk for comparison. The term <math alttext="{\text{ch}_{i}}^{+}" class="ltx_Math" display="inline" id="S3.SS2.SSS3.p1.2.m2.1"><semantics id="S3.SS2.SSS3.p1.2.m2.1a"><mmultiscripts id="S3.SS2.SSS3.p1.2.m2.1.1" xref="S3.SS2.SSS3.p1.2.m2.1.1.cmml"><mtext id="S3.SS2.SSS3.p1.2.m2.1.1.2.2" xref="S3.SS2.SSS3.p1.2.m2.1.1.2.2a.cmml">ch</mtext><mi id="S3.SS2.SSS3.p1.2.m2.1.1.2.3" xref="S3.SS2.SSS3.p1.2.m2.1.1.2.3.cmml">i</mi><mrow id="S3.SS2.SSS3.p1.2.m2.1.1a" xref="S3.SS2.SSS3.p1.2.m2.1.1.cmml"></mrow><mrow id="S3.SS2.SSS3.p1.2.m2.1.1b" xref="S3.SS2.SSS3.p1.2.m2.1.1.cmml"></mrow><mo id="S3.SS2.SSS3.p1.2.m2.1.1.3" xref="S3.SS2.SSS3.p1.2.m2.1.1.3.cmml">+</mo></mmultiscripts><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p1.2.m2.1b"><apply id="S3.SS2.SSS3.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p1.2.m2.1.1.1.cmml" xref="S3.SS2.SSS3.p1.2.m2.1.1">superscript</csymbol><apply id="S3.SS2.SSS3.p1.2.m2.1.1.2.cmml" xref="S3.SS2.SSS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p1.2.m2.1.1.2.1.cmml" xref="S3.SS2.SSS3.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.p1.2.m2.1.1.2.2a.cmml" xref="S3.SS2.SSS3.p1.2.m2.1.1.2.2"><mtext id="S3.SS2.SSS3.p1.2.m2.1.1.2.2.cmml" xref="S3.SS2.SSS3.p1.2.m2.1.1.2.2">ch</mtext></ci><ci id="S3.SS2.SSS3.p1.2.m2.1.1.2.3.cmml" xref="S3.SS2.SSS3.p1.2.m2.1.1.2.3">𝑖</ci></apply><plus id="S3.SS2.SSS3.p1.2.m2.1.1.3.cmml" xref="S3.SS2.SSS3.p1.2.m2.1.1.3"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p1.2.m2.1c">{\text{ch}_{i}}^{+}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p1.2.m2.1d">ch start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT</annotation></semantics></math> represents a positive chunk, which is a chunk similar to <math alttext="\text{ch}_{i}" class="ltx_Math" display="inline" id="S3.SS2.SSS3.p1.3.m3.1"><semantics id="S3.SS2.SSS3.p1.3.m3.1a"><msub id="S3.SS2.SSS3.p1.3.m3.1.1" xref="S3.SS2.SSS3.p1.3.m3.1.1.cmml"><mtext id="S3.SS2.SSS3.p1.3.m3.1.1.2" xref="S3.SS2.SSS3.p1.3.m3.1.1.2a.cmml">ch</mtext><mi id="S3.SS2.SSS3.p1.3.m3.1.1.3" xref="S3.SS2.SSS3.p1.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p1.3.m3.1b"><apply id="S3.SS2.SSS3.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p1.3.m3.1.1.1.cmml" xref="S3.SS2.SSS3.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.p1.3.m3.1.1.2a.cmml" xref="S3.SS2.SSS3.p1.3.m3.1.1.2"><mtext id="S3.SS2.SSS3.p1.3.m3.1.1.2.cmml" xref="S3.SS2.SSS3.p1.3.m3.1.1.2">ch</mtext></ci><ci id="S3.SS2.SSS3.p1.3.m3.1.1.3.cmml" xref="S3.SS2.SSS3.p1.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p1.3.m3.1c">\text{ch}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p1.3.m3.1d">ch start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>. <math alttext="{\text{ch}_{i}}^{-}" class="ltx_Math" display="inline" id="S3.SS2.SSS3.p1.4.m4.1"><semantics id="S3.SS2.SSS3.p1.4.m4.1a"><mmultiscripts id="S3.SS2.SSS3.p1.4.m4.1.1" xref="S3.SS2.SSS3.p1.4.m4.1.1.cmml"><mtext id="S3.SS2.SSS3.p1.4.m4.1.1.2.2" xref="S3.SS2.SSS3.p1.4.m4.1.1.2.2a.cmml">ch</mtext><mi id="S3.SS2.SSS3.p1.4.m4.1.1.2.3" xref="S3.SS2.SSS3.p1.4.m4.1.1.2.3.cmml">i</mi><mrow id="S3.SS2.SSS3.p1.4.m4.1.1a" xref="S3.SS2.SSS3.p1.4.m4.1.1.cmml"></mrow><mrow id="S3.SS2.SSS3.p1.4.m4.1.1b" xref="S3.SS2.SSS3.p1.4.m4.1.1.cmml"></mrow><mo id="S3.SS2.SSS3.p1.4.m4.1.1.3" xref="S3.SS2.SSS3.p1.4.m4.1.1.3.cmml">−</mo></mmultiscripts><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p1.4.m4.1b"><apply id="S3.SS2.SSS3.p1.4.m4.1.1.cmml" xref="S3.SS2.SSS3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p1.4.m4.1.1.1.cmml" xref="S3.SS2.SSS3.p1.4.m4.1.1">superscript</csymbol><apply id="S3.SS2.SSS3.p1.4.m4.1.1.2.cmml" xref="S3.SS2.SSS3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p1.4.m4.1.1.2.1.cmml" xref="S3.SS2.SSS3.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.p1.4.m4.1.1.2.2a.cmml" xref="S3.SS2.SSS3.p1.4.m4.1.1.2.2"><mtext id="S3.SS2.SSS3.p1.4.m4.1.1.2.2.cmml" xref="S3.SS2.SSS3.p1.4.m4.1.1.2.2">ch</mtext></ci><ci id="S3.SS2.SSS3.p1.4.m4.1.1.2.3.cmml" xref="S3.SS2.SSS3.p1.4.m4.1.1.2.3">𝑖</ci></apply><minus id="S3.SS2.SSS3.p1.4.m4.1.1.3.cmml" xref="S3.SS2.SSS3.p1.4.m4.1.1.3"></minus></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p1.4.m4.1c">{\text{ch}_{i}}^{-}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p1.4.m4.1d">ch start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT</annotation></semantics></math> denotes a hard negative chunk, which is a sequence that is dissimilar to <math alttext="\text{ch}_{i}" class="ltx_Math" display="inline" id="S3.SS2.SSS3.p1.5.m5.1"><semantics id="S3.SS2.SSS3.p1.5.m5.1a"><msub id="S3.SS2.SSS3.p1.5.m5.1.1" xref="S3.SS2.SSS3.p1.5.m5.1.1.cmml"><mtext id="S3.SS2.SSS3.p1.5.m5.1.1.2" xref="S3.SS2.SSS3.p1.5.m5.1.1.2a.cmml">ch</mtext><mi id="S3.SS2.SSS3.p1.5.m5.1.1.3" xref="S3.SS2.SSS3.p1.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p1.5.m5.1b"><apply id="S3.SS2.SSS3.p1.5.m5.1.1.cmml" xref="S3.SS2.SSS3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p1.5.m5.1.1.1.cmml" xref="S3.SS2.SSS3.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.p1.5.m5.1.1.2a.cmml" xref="S3.SS2.SSS3.p1.5.m5.1.1.2"><mtext id="S3.SS2.SSS3.p1.5.m5.1.1.2.cmml" xref="S3.SS2.SSS3.p1.5.m5.1.1.2">ch</mtext></ci><ci id="S3.SS2.SSS3.p1.5.m5.1.1.3.cmml" xref="S3.SS2.SSS3.p1.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p1.5.m5.1c">\text{ch}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p1.5.m5.1d">ch start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>. The remaining negative chunks are represented by <math alttext="\text{ch}_{j}" class="ltx_Math" display="inline" id="S3.SS2.SSS3.p1.6.m6.1"><semantics id="S3.SS2.SSS3.p1.6.m6.1a"><msub id="S3.SS2.SSS3.p1.6.m6.1.1" xref="S3.SS2.SSS3.p1.6.m6.1.1.cmml"><mtext id="S3.SS2.SSS3.p1.6.m6.1.1.2" xref="S3.SS2.SSS3.p1.6.m6.1.1.2a.cmml">ch</mtext><mi id="S3.SS2.SSS3.p1.6.m6.1.1.3" xref="S3.SS2.SSS3.p1.6.m6.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p1.6.m6.1b"><apply id="S3.SS2.SSS3.p1.6.m6.1.1.cmml" xref="S3.SS2.SSS3.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p1.6.m6.1.1.1.cmml" xref="S3.SS2.SSS3.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.p1.6.m6.1.1.2a.cmml" xref="S3.SS2.SSS3.p1.6.m6.1.1.2"><mtext id="S3.SS2.SSS3.p1.6.m6.1.1.2.cmml" xref="S3.SS2.SSS3.p1.6.m6.1.1.2">ch</mtext></ci><ci id="S3.SS2.SSS3.p1.6.m6.1.1.3.cmml" xref="S3.SS2.SSS3.p1.6.m6.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p1.6.m6.1c">\text{ch}_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p1.6.m6.1d">ch start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>, where <math alttext="j" class="ltx_Math" display="inline" id="S3.SS2.SSS3.p1.7.m7.1"><semantics id="S3.SS2.SSS3.p1.7.m7.1a"><mi id="S3.SS2.SSS3.p1.7.m7.1.1" xref="S3.SS2.SSS3.p1.7.m7.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p1.7.m7.1b"><ci id="S3.SS2.SSS3.p1.7.m7.1.1.cmml" xref="S3.SS2.SSS3.p1.7.m7.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p1.7.m7.1c">j</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p1.7.m7.1d">italic_j</annotation></semantics></math> ranges from 1 to <math alttext="2K-2" class="ltx_Math" display="inline" id="S3.SS2.SSS3.p1.8.m8.1"><semantics id="S3.SS2.SSS3.p1.8.m8.1a"><mrow id="S3.SS2.SSS3.p1.8.m8.1.1" xref="S3.SS2.SSS3.p1.8.m8.1.1.cmml"><mrow id="S3.SS2.SSS3.p1.8.m8.1.1.2" xref="S3.SS2.SSS3.p1.8.m8.1.1.2.cmml"><mn id="S3.SS2.SSS3.p1.8.m8.1.1.2.2" xref="S3.SS2.SSS3.p1.8.m8.1.1.2.2.cmml">2</mn><mo id="S3.SS2.SSS3.p1.8.m8.1.1.2.1" xref="S3.SS2.SSS3.p1.8.m8.1.1.2.1.cmml">⁢</mo><mi id="S3.SS2.SSS3.p1.8.m8.1.1.2.3" xref="S3.SS2.SSS3.p1.8.m8.1.1.2.3.cmml">K</mi></mrow><mo id="S3.SS2.SSS3.p1.8.m8.1.1.1" xref="S3.SS2.SSS3.p1.8.m8.1.1.1.cmml">−</mo><mn id="S3.SS2.SSS3.p1.8.m8.1.1.3" xref="S3.SS2.SSS3.p1.8.m8.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p1.8.m8.1b"><apply id="S3.SS2.SSS3.p1.8.m8.1.1.cmml" xref="S3.SS2.SSS3.p1.8.m8.1.1"><minus id="S3.SS2.SSS3.p1.8.m8.1.1.1.cmml" xref="S3.SS2.SSS3.p1.8.m8.1.1.1"></minus><apply id="S3.SS2.SSS3.p1.8.m8.1.1.2.cmml" xref="S3.SS2.SSS3.p1.8.m8.1.1.2"><times id="S3.SS2.SSS3.p1.8.m8.1.1.2.1.cmml" xref="S3.SS2.SSS3.p1.8.m8.1.1.2.1"></times><cn id="S3.SS2.SSS3.p1.8.m8.1.1.2.2.cmml" type="integer" xref="S3.SS2.SSS3.p1.8.m8.1.1.2.2">2</cn><ci id="S3.SS2.SSS3.p1.8.m8.1.1.2.3.cmml" xref="S3.SS2.SSS3.p1.8.m8.1.1.2.3">𝐾</ci></apply><cn id="S3.SS2.SSS3.p1.8.m8.1.1.3.cmml" type="integer" xref="S3.SS2.SSS3.p1.8.m8.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p1.8.m8.1c">2K-2</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p1.8.m8.1d">2 italic_K - 2</annotation></semantics></math>, which are the positive and negative chunks of other anchor chunks from the current batch. The similarity <math alttext="f\left(\text{ch}_{x},\text{ch}_{y}\right)" class="ltx_Math" display="inline" id="S3.SS2.SSS3.p1.9.m9.2"><semantics id="S3.SS2.SSS3.p1.9.m9.2a"><mrow id="S3.SS2.SSS3.p1.9.m9.2.2" xref="S3.SS2.SSS3.p1.9.m9.2.2.cmml"><mi id="S3.SS2.SSS3.p1.9.m9.2.2.4" xref="S3.SS2.SSS3.p1.9.m9.2.2.4.cmml">f</mi><mo id="S3.SS2.SSS3.p1.9.m9.2.2.3" xref="S3.SS2.SSS3.p1.9.m9.2.2.3.cmml">⁢</mo><mrow id="S3.SS2.SSS3.p1.9.m9.2.2.2.2" xref="S3.SS2.SSS3.p1.9.m9.2.2.2.3.cmml"><mo id="S3.SS2.SSS3.p1.9.m9.2.2.2.2.3" xref="S3.SS2.SSS3.p1.9.m9.2.2.2.3.cmml">(</mo><msub id="S3.SS2.SSS3.p1.9.m9.1.1.1.1.1" xref="S3.SS2.SSS3.p1.9.m9.1.1.1.1.1.cmml"><mtext id="S3.SS2.SSS3.p1.9.m9.1.1.1.1.1.2" xref="S3.SS2.SSS3.p1.9.m9.1.1.1.1.1.2a.cmml">ch</mtext><mi id="S3.SS2.SSS3.p1.9.m9.1.1.1.1.1.3" xref="S3.SS2.SSS3.p1.9.m9.1.1.1.1.1.3.cmml">x</mi></msub><mo id="S3.SS2.SSS3.p1.9.m9.2.2.2.2.4" xref="S3.SS2.SSS3.p1.9.m9.2.2.2.3.cmml">,</mo><msub id="S3.SS2.SSS3.p1.9.m9.2.2.2.2.2" xref="S3.SS2.SSS3.p1.9.m9.2.2.2.2.2.cmml"><mtext id="S3.SS2.SSS3.p1.9.m9.2.2.2.2.2.2" xref="S3.SS2.SSS3.p1.9.m9.2.2.2.2.2.2a.cmml">ch</mtext><mi id="S3.SS2.SSS3.p1.9.m9.2.2.2.2.2.3" xref="S3.SS2.SSS3.p1.9.m9.2.2.2.2.2.3.cmml">y</mi></msub><mo id="S3.SS2.SSS3.p1.9.m9.2.2.2.2.5" xref="S3.SS2.SSS3.p1.9.m9.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p1.9.m9.2b"><apply id="S3.SS2.SSS3.p1.9.m9.2.2.cmml" xref="S3.SS2.SSS3.p1.9.m9.2.2"><times id="S3.SS2.SSS3.p1.9.m9.2.2.3.cmml" xref="S3.SS2.SSS3.p1.9.m9.2.2.3"></times><ci id="S3.SS2.SSS3.p1.9.m9.2.2.4.cmml" xref="S3.SS2.SSS3.p1.9.m9.2.2.4">𝑓</ci><interval closure="open" id="S3.SS2.SSS3.p1.9.m9.2.2.2.3.cmml" xref="S3.SS2.SSS3.p1.9.m9.2.2.2.2"><apply id="S3.SS2.SSS3.p1.9.m9.1.1.1.1.1.cmml" xref="S3.SS2.SSS3.p1.9.m9.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p1.9.m9.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS3.p1.9.m9.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.p1.9.m9.1.1.1.1.1.2a.cmml" xref="S3.SS2.SSS3.p1.9.m9.1.1.1.1.1.2"><mtext id="S3.SS2.SSS3.p1.9.m9.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS3.p1.9.m9.1.1.1.1.1.2">ch</mtext></ci><ci id="S3.SS2.SSS3.p1.9.m9.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS3.p1.9.m9.1.1.1.1.1.3">𝑥</ci></apply><apply id="S3.SS2.SSS3.p1.9.m9.2.2.2.2.2.cmml" xref="S3.SS2.SSS3.p1.9.m9.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p1.9.m9.2.2.2.2.2.1.cmml" xref="S3.SS2.SSS3.p1.9.m9.2.2.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS3.p1.9.m9.2.2.2.2.2.2a.cmml" xref="S3.SS2.SSS3.p1.9.m9.2.2.2.2.2.2"><mtext id="S3.SS2.SSS3.p1.9.m9.2.2.2.2.2.2.cmml" xref="S3.SS2.SSS3.p1.9.m9.2.2.2.2.2.2">ch</mtext></ci><ci id="S3.SS2.SSS3.p1.9.m9.2.2.2.2.2.3.cmml" xref="S3.SS2.SSS3.p1.9.m9.2.2.2.2.2.3">𝑦</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p1.9.m9.2c">f\left(\text{ch}_{x},\text{ch}_{y}\right)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p1.9.m9.2d">italic_f ( ch start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT , ch start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT )</annotation></semantics></math> between the anchor chunk <math alttext="\text{ch}_{x}" class="ltx_Math" display="inline" id="S3.SS2.SSS3.p1.10.m10.1"><semantics id="S3.SS2.SSS3.p1.10.m10.1a"><msub id="S3.SS2.SSS3.p1.10.m10.1.1" xref="S3.SS2.SSS3.p1.10.m10.1.1.cmml"><mtext id="S3.SS2.SSS3.p1.10.m10.1.1.2" xref="S3.SS2.SSS3.p1.10.m10.1.1.2a.cmml">ch</mtext><mi id="S3.SS2.SSS3.p1.10.m10.1.1.3" xref="S3.SS2.SSS3.p1.10.m10.1.1.3.cmml">x</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p1.10.m10.1b"><apply id="S3.SS2.SSS3.p1.10.m10.1.1.cmml" xref="S3.SS2.SSS3.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p1.10.m10.1.1.1.cmml" xref="S3.SS2.SSS3.p1.10.m10.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.p1.10.m10.1.1.2a.cmml" xref="S3.SS2.SSS3.p1.10.m10.1.1.2"><mtext id="S3.SS2.SSS3.p1.10.m10.1.1.2.cmml" xref="S3.SS2.SSS3.p1.10.m10.1.1.2">ch</mtext></ci><ci id="S3.SS2.SSS3.p1.10.m10.1.1.3.cmml" xref="S3.SS2.SSS3.p1.10.m10.1.1.3">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p1.10.m10.1c">\text{ch}_{x}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p1.10.m10.1d">ch start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT</annotation></semantics></math> and another chunk <math alttext="\text{ch}_{y}" class="ltx_Math" display="inline" id="S3.SS2.SSS3.p1.11.m11.1"><semantics id="S3.SS2.SSS3.p1.11.m11.1a"><msub id="S3.SS2.SSS3.p1.11.m11.1.1" xref="S3.SS2.SSS3.p1.11.m11.1.1.cmml"><mtext id="S3.SS2.SSS3.p1.11.m11.1.1.2" xref="S3.SS2.SSS3.p1.11.m11.1.1.2a.cmml">ch</mtext><mi id="S3.SS2.SSS3.p1.11.m11.1.1.3" xref="S3.SS2.SSS3.p1.11.m11.1.1.3.cmml">y</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p1.11.m11.1b"><apply id="S3.SS2.SSS3.p1.11.m11.1.1.cmml" xref="S3.SS2.SSS3.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p1.11.m11.1.1.1.cmml" xref="S3.SS2.SSS3.p1.11.m11.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.p1.11.m11.1.1.2a.cmml" xref="S3.SS2.SSS3.p1.11.m11.1.1.2"><mtext id="S3.SS2.SSS3.p1.11.m11.1.1.2.cmml" xref="S3.SS2.SSS3.p1.11.m11.1.1.2">ch</mtext></ci><ci id="S3.SS2.SSS3.p1.11.m11.1.1.3.cmml" xref="S3.SS2.SSS3.p1.11.m11.1.1.3">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p1.11.m11.1c">\text{ch}_{y}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p1.11.m11.1d">ch start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT</annotation></semantics></math> is calculated as the inner product of their chunk embeddings of BERT <cite class="ltx_cite ltx_citemacro_citep">(Devlin, <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib17" title="">2018</a>)</cite>:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="f\left(\text{ch}_{x},\text{ch}_{y}\right)=\langle b_{e}(\text{ch}_{x}),b_{e}(%
\text{ch}_{y})\rangle," class="ltx_Math" display="block" id="S3.E6.m1.1"><semantics id="S3.E6.m1.1a"><mrow id="S3.E6.m1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml"><mrow id="S3.E6.m1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml"><mrow id="S3.E6.m1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.2.cmml"><mi id="S3.E6.m1.1.1.1.1.2.4" xref="S3.E6.m1.1.1.1.1.2.4.cmml">f</mi><mo id="S3.E6.m1.1.1.1.1.2.3" xref="S3.E6.m1.1.1.1.1.2.3.cmml">⁢</mo><mrow id="S3.E6.m1.1.1.1.1.2.2.2" xref="S3.E6.m1.1.1.1.1.2.2.3.cmml"><mo id="S3.E6.m1.1.1.1.1.2.2.2.3" xref="S3.E6.m1.1.1.1.1.2.2.3.cmml">(</mo><msub id="S3.E6.m1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.cmml"><mtext id="S3.E6.m1.1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2a.cmml">ch</mtext><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.3.cmml">x</mi></msub><mo id="S3.E6.m1.1.1.1.1.2.2.2.4" xref="S3.E6.m1.1.1.1.1.2.2.3.cmml">,</mo><msub id="S3.E6.m1.1.1.1.1.2.2.2.2" xref="S3.E6.m1.1.1.1.1.2.2.2.2.cmml"><mtext id="S3.E6.m1.1.1.1.1.2.2.2.2.2" xref="S3.E6.m1.1.1.1.1.2.2.2.2.2a.cmml">ch</mtext><mi id="S3.E6.m1.1.1.1.1.2.2.2.2.3" xref="S3.E6.m1.1.1.1.1.2.2.2.2.3.cmml">y</mi></msub><mo id="S3.E6.m1.1.1.1.1.2.2.2.5" xref="S3.E6.m1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.1.1.1.1.5" xref="S3.E6.m1.1.1.1.1.5.cmml">=</mo><mrow id="S3.E6.m1.1.1.1.1.4.2" xref="S3.E6.m1.1.1.1.1.4.3.cmml"><mo id="S3.E6.m1.1.1.1.1.4.2.3" stretchy="false" xref="S3.E6.m1.1.1.1.1.4.3.cmml">⟨</mo><mrow id="S3.E6.m1.1.1.1.1.3.1.1" xref="S3.E6.m1.1.1.1.1.3.1.1.cmml"><msub id="S3.E6.m1.1.1.1.1.3.1.1.3" xref="S3.E6.m1.1.1.1.1.3.1.1.3.cmml"><mi id="S3.E6.m1.1.1.1.1.3.1.1.3.2" xref="S3.E6.m1.1.1.1.1.3.1.1.3.2.cmml">b</mi><mi id="S3.E6.m1.1.1.1.1.3.1.1.3.3" xref="S3.E6.m1.1.1.1.1.3.1.1.3.3.cmml">e</mi></msub><mo id="S3.E6.m1.1.1.1.1.3.1.1.2" xref="S3.E6.m1.1.1.1.1.3.1.1.2.cmml">⁢</mo><mrow id="S3.E6.m1.1.1.1.1.3.1.1.1.1" xref="S3.E6.m1.1.1.1.1.3.1.1.1.1.1.cmml"><mo id="S3.E6.m1.1.1.1.1.3.1.1.1.1.2" stretchy="false" xref="S3.E6.m1.1.1.1.1.3.1.1.1.1.1.cmml">(</mo><msub id="S3.E6.m1.1.1.1.1.3.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.3.1.1.1.1.1.cmml"><mtext id="S3.E6.m1.1.1.1.1.3.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.3.1.1.1.1.1.2a.cmml">ch</mtext><mi id="S3.E6.m1.1.1.1.1.3.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.3.1.1.1.1.1.3.cmml">x</mi></msub><mo id="S3.E6.m1.1.1.1.1.3.1.1.1.1.3" stretchy="false" xref="S3.E6.m1.1.1.1.1.3.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.1.1.1.1.4.2.4" xref="S3.E6.m1.1.1.1.1.4.3.cmml">,</mo><mrow id="S3.E6.m1.1.1.1.1.4.2.2" xref="S3.E6.m1.1.1.1.1.4.2.2.cmml"><msub id="S3.E6.m1.1.1.1.1.4.2.2.3" xref="S3.E6.m1.1.1.1.1.4.2.2.3.cmml"><mi id="S3.E6.m1.1.1.1.1.4.2.2.3.2" xref="S3.E6.m1.1.1.1.1.4.2.2.3.2.cmml">b</mi><mi id="S3.E6.m1.1.1.1.1.4.2.2.3.3" xref="S3.E6.m1.1.1.1.1.4.2.2.3.3.cmml">e</mi></msub><mo id="S3.E6.m1.1.1.1.1.4.2.2.2" xref="S3.E6.m1.1.1.1.1.4.2.2.2.cmml">⁢</mo><mrow id="S3.E6.m1.1.1.1.1.4.2.2.1.1" xref="S3.E6.m1.1.1.1.1.4.2.2.1.1.1.cmml"><mo id="S3.E6.m1.1.1.1.1.4.2.2.1.1.2" stretchy="false" xref="S3.E6.m1.1.1.1.1.4.2.2.1.1.1.cmml">(</mo><msub id="S3.E6.m1.1.1.1.1.4.2.2.1.1.1" xref="S3.E6.m1.1.1.1.1.4.2.2.1.1.1.cmml"><mtext id="S3.E6.m1.1.1.1.1.4.2.2.1.1.1.2" xref="S3.E6.m1.1.1.1.1.4.2.2.1.1.1.2a.cmml">ch</mtext><mi id="S3.E6.m1.1.1.1.1.4.2.2.1.1.1.3" xref="S3.E6.m1.1.1.1.1.4.2.2.1.1.1.3.cmml">y</mi></msub><mo id="S3.E6.m1.1.1.1.1.4.2.2.1.1.3" stretchy="false" xref="S3.E6.m1.1.1.1.1.4.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.1.1.1.1.4.2.5" stretchy="false" xref="S3.E6.m1.1.1.1.1.4.3.cmml">⟩</mo></mrow></mrow><mo id="S3.E6.m1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.1b"><apply id="S3.E6.m1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1"><eq id="S3.E6.m1.1.1.1.1.5.cmml" xref="S3.E6.m1.1.1.1.1.5"></eq><apply id="S3.E6.m1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.2"><times id="S3.E6.m1.1.1.1.1.2.3.cmml" xref="S3.E6.m1.1.1.1.1.2.3"></times><ci id="S3.E6.m1.1.1.1.1.2.4.cmml" xref="S3.E6.m1.1.1.1.1.2.4">𝑓</ci><interval closure="open" id="S3.E6.m1.1.1.1.1.2.2.3.cmml" xref="S3.E6.m1.1.1.1.1.2.2.2"><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.2a.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2"><mtext id="S3.E6.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2">ch</mtext></ci><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.3">𝑥</ci></apply><apply id="S3.E6.m1.1.1.1.1.2.2.2.2.cmml" xref="S3.E6.m1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E6.m1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.2.2.2.2.2a.cmml" xref="S3.E6.m1.1.1.1.1.2.2.2.2.2"><mtext id="S3.E6.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E6.m1.1.1.1.1.2.2.2.2.2">ch</mtext></ci><ci id="S3.E6.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E6.m1.1.1.1.1.2.2.2.2.3">𝑦</ci></apply></interval></apply><list id="S3.E6.m1.1.1.1.1.4.3.cmml" xref="S3.E6.m1.1.1.1.1.4.2"><apply id="S3.E6.m1.1.1.1.1.3.1.1.cmml" xref="S3.E6.m1.1.1.1.1.3.1.1"><times id="S3.E6.m1.1.1.1.1.3.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.3.1.1.2"></times><apply id="S3.E6.m1.1.1.1.1.3.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.3.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.3.1.1.3.1.cmml" xref="S3.E6.m1.1.1.1.1.3.1.1.3">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.3.1.1.3.2.cmml" xref="S3.E6.m1.1.1.1.1.3.1.1.3.2">𝑏</ci><ci id="S3.E6.m1.1.1.1.1.3.1.1.3.3.cmml" xref="S3.E6.m1.1.1.1.1.3.1.1.3.3">𝑒</ci></apply><apply id="S3.E6.m1.1.1.1.1.3.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.3.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.3.1.1.1.1">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.3.1.1.1.1.1.2a.cmml" xref="S3.E6.m1.1.1.1.1.3.1.1.1.1.1.2"><mtext id="S3.E6.m1.1.1.1.1.3.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.3.1.1.1.1.1.2">ch</mtext></ci><ci id="S3.E6.m1.1.1.1.1.3.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.3.1.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S3.E6.m1.1.1.1.1.4.2.2.cmml" xref="S3.E6.m1.1.1.1.1.4.2.2"><times id="S3.E6.m1.1.1.1.1.4.2.2.2.cmml" xref="S3.E6.m1.1.1.1.1.4.2.2.2"></times><apply id="S3.E6.m1.1.1.1.1.4.2.2.3.cmml" xref="S3.E6.m1.1.1.1.1.4.2.2.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.4.2.2.3.1.cmml" xref="S3.E6.m1.1.1.1.1.4.2.2.3">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.4.2.2.3.2.cmml" xref="S3.E6.m1.1.1.1.1.4.2.2.3.2">𝑏</ci><ci id="S3.E6.m1.1.1.1.1.4.2.2.3.3.cmml" xref="S3.E6.m1.1.1.1.1.4.2.2.3.3">𝑒</ci></apply><apply id="S3.E6.m1.1.1.1.1.4.2.2.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.4.2.2.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.4.2.2.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.4.2.2.1.1">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.4.2.2.1.1.1.2a.cmml" xref="S3.E6.m1.1.1.1.1.4.2.2.1.1.1.2"><mtext id="S3.E6.m1.1.1.1.1.4.2.2.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.4.2.2.1.1.1.2">ch</mtext></ci><ci id="S3.E6.m1.1.1.1.1.4.2.2.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.4.2.2.1.1.1.3">𝑦</ci></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.1c">f\left(\text{ch}_{x},\text{ch}_{y}\right)=\langle b_{e}(\text{ch}_{x}),b_{e}(%
\text{ch}_{y})\rangle,</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.1d">italic_f ( ch start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT , ch start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT ) = ⟨ italic_b start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT ( ch start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT ) , italic_b start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT ( ch start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT ) ⟩ ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS3.p1.15">where <math alttext="b_{e}(\text{ch}_{x})" class="ltx_Math" display="inline" id="S3.SS2.SSS3.p1.12.m1.1"><semantics id="S3.SS2.SSS3.p1.12.m1.1a"><mrow id="S3.SS2.SSS3.p1.12.m1.1.1" xref="S3.SS2.SSS3.p1.12.m1.1.1.cmml"><msub id="S3.SS2.SSS3.p1.12.m1.1.1.3" xref="S3.SS2.SSS3.p1.12.m1.1.1.3.cmml"><mi id="S3.SS2.SSS3.p1.12.m1.1.1.3.2" xref="S3.SS2.SSS3.p1.12.m1.1.1.3.2.cmml">b</mi><mi id="S3.SS2.SSS3.p1.12.m1.1.1.3.3" xref="S3.SS2.SSS3.p1.12.m1.1.1.3.3.cmml">e</mi></msub><mo id="S3.SS2.SSS3.p1.12.m1.1.1.2" xref="S3.SS2.SSS3.p1.12.m1.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.SSS3.p1.12.m1.1.1.1.1" xref="S3.SS2.SSS3.p1.12.m1.1.1.1.1.1.cmml"><mo id="S3.SS2.SSS3.p1.12.m1.1.1.1.1.2" stretchy="false" xref="S3.SS2.SSS3.p1.12.m1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS2.SSS3.p1.12.m1.1.1.1.1.1" xref="S3.SS2.SSS3.p1.12.m1.1.1.1.1.1.cmml"><mtext id="S3.SS2.SSS3.p1.12.m1.1.1.1.1.1.2" xref="S3.SS2.SSS3.p1.12.m1.1.1.1.1.1.2a.cmml">ch</mtext><mi id="S3.SS2.SSS3.p1.12.m1.1.1.1.1.1.3" xref="S3.SS2.SSS3.p1.12.m1.1.1.1.1.1.3.cmml">x</mi></msub><mo id="S3.SS2.SSS3.p1.12.m1.1.1.1.1.3" stretchy="false" xref="S3.SS2.SSS3.p1.12.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p1.12.m1.1b"><apply id="S3.SS2.SSS3.p1.12.m1.1.1.cmml" xref="S3.SS2.SSS3.p1.12.m1.1.1"><times id="S3.SS2.SSS3.p1.12.m1.1.1.2.cmml" xref="S3.SS2.SSS3.p1.12.m1.1.1.2"></times><apply id="S3.SS2.SSS3.p1.12.m1.1.1.3.cmml" xref="S3.SS2.SSS3.p1.12.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p1.12.m1.1.1.3.1.cmml" xref="S3.SS2.SSS3.p1.12.m1.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS3.p1.12.m1.1.1.3.2.cmml" xref="S3.SS2.SSS3.p1.12.m1.1.1.3.2">𝑏</ci><ci id="S3.SS2.SSS3.p1.12.m1.1.1.3.3.cmml" xref="S3.SS2.SSS3.p1.12.m1.1.1.3.3">𝑒</ci></apply><apply id="S3.SS2.SSS3.p1.12.m1.1.1.1.1.1.cmml" xref="S3.SS2.SSS3.p1.12.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p1.12.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS3.p1.12.m1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.p1.12.m1.1.1.1.1.1.2a.cmml" xref="S3.SS2.SSS3.p1.12.m1.1.1.1.1.1.2"><mtext id="S3.SS2.SSS3.p1.12.m1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS3.p1.12.m1.1.1.1.1.1.2">ch</mtext></ci><ci id="S3.SS2.SSS3.p1.12.m1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS3.p1.12.m1.1.1.1.1.1.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p1.12.m1.1c">b_{e}(\text{ch}_{x})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p1.12.m1.1d">italic_b start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT ( ch start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT )</annotation></semantics></math> and <math alttext="b_{e}(\text{ch}_{y})" class="ltx_Math" display="inline" id="S3.SS2.SSS3.p1.13.m2.1"><semantics id="S3.SS2.SSS3.p1.13.m2.1a"><mrow id="S3.SS2.SSS3.p1.13.m2.1.1" xref="S3.SS2.SSS3.p1.13.m2.1.1.cmml"><msub id="S3.SS2.SSS3.p1.13.m2.1.1.3" xref="S3.SS2.SSS3.p1.13.m2.1.1.3.cmml"><mi id="S3.SS2.SSS3.p1.13.m2.1.1.3.2" xref="S3.SS2.SSS3.p1.13.m2.1.1.3.2.cmml">b</mi><mi id="S3.SS2.SSS3.p1.13.m2.1.1.3.3" xref="S3.SS2.SSS3.p1.13.m2.1.1.3.3.cmml">e</mi></msub><mo id="S3.SS2.SSS3.p1.13.m2.1.1.2" xref="S3.SS2.SSS3.p1.13.m2.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.SSS3.p1.13.m2.1.1.1.1" xref="S3.SS2.SSS3.p1.13.m2.1.1.1.1.1.cmml"><mo id="S3.SS2.SSS3.p1.13.m2.1.1.1.1.2" stretchy="false" xref="S3.SS2.SSS3.p1.13.m2.1.1.1.1.1.cmml">(</mo><msub id="S3.SS2.SSS3.p1.13.m2.1.1.1.1.1" xref="S3.SS2.SSS3.p1.13.m2.1.1.1.1.1.cmml"><mtext id="S3.SS2.SSS3.p1.13.m2.1.1.1.1.1.2" xref="S3.SS2.SSS3.p1.13.m2.1.1.1.1.1.2a.cmml">ch</mtext><mi id="S3.SS2.SSS3.p1.13.m2.1.1.1.1.1.3" xref="S3.SS2.SSS3.p1.13.m2.1.1.1.1.1.3.cmml">y</mi></msub><mo id="S3.SS2.SSS3.p1.13.m2.1.1.1.1.3" stretchy="false" xref="S3.SS2.SSS3.p1.13.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p1.13.m2.1b"><apply id="S3.SS2.SSS3.p1.13.m2.1.1.cmml" xref="S3.SS2.SSS3.p1.13.m2.1.1"><times id="S3.SS2.SSS3.p1.13.m2.1.1.2.cmml" xref="S3.SS2.SSS3.p1.13.m2.1.1.2"></times><apply id="S3.SS2.SSS3.p1.13.m2.1.1.3.cmml" xref="S3.SS2.SSS3.p1.13.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p1.13.m2.1.1.3.1.cmml" xref="S3.SS2.SSS3.p1.13.m2.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS3.p1.13.m2.1.1.3.2.cmml" xref="S3.SS2.SSS3.p1.13.m2.1.1.3.2">𝑏</ci><ci id="S3.SS2.SSS3.p1.13.m2.1.1.3.3.cmml" xref="S3.SS2.SSS3.p1.13.m2.1.1.3.3">𝑒</ci></apply><apply id="S3.SS2.SSS3.p1.13.m2.1.1.1.1.1.cmml" xref="S3.SS2.SSS3.p1.13.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p1.13.m2.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS3.p1.13.m2.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.p1.13.m2.1.1.1.1.1.2a.cmml" xref="S3.SS2.SSS3.p1.13.m2.1.1.1.1.1.2"><mtext id="S3.SS2.SSS3.p1.13.m2.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS3.p1.13.m2.1.1.1.1.1.2">ch</mtext></ci><ci id="S3.SS2.SSS3.p1.13.m2.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS3.p1.13.m2.1.1.1.1.1.3">𝑦</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p1.13.m2.1c">b_{e}(\text{ch}_{y})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p1.13.m2.1d">italic_b start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT ( ch start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT )</annotation></semantics></math> represent the embeddings of the chunks <math alttext="\text{ch}_{x}" class="ltx_Math" display="inline" id="S3.SS2.SSS3.p1.14.m3.1"><semantics id="S3.SS2.SSS3.p1.14.m3.1a"><msub id="S3.SS2.SSS3.p1.14.m3.1.1" xref="S3.SS2.SSS3.p1.14.m3.1.1.cmml"><mtext id="S3.SS2.SSS3.p1.14.m3.1.1.2" xref="S3.SS2.SSS3.p1.14.m3.1.1.2a.cmml">ch</mtext><mi id="S3.SS2.SSS3.p1.14.m3.1.1.3" xref="S3.SS2.SSS3.p1.14.m3.1.1.3.cmml">x</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p1.14.m3.1b"><apply id="S3.SS2.SSS3.p1.14.m3.1.1.cmml" xref="S3.SS2.SSS3.p1.14.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p1.14.m3.1.1.1.cmml" xref="S3.SS2.SSS3.p1.14.m3.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.p1.14.m3.1.1.2a.cmml" xref="S3.SS2.SSS3.p1.14.m3.1.1.2"><mtext id="S3.SS2.SSS3.p1.14.m3.1.1.2.cmml" xref="S3.SS2.SSS3.p1.14.m3.1.1.2">ch</mtext></ci><ci id="S3.SS2.SSS3.p1.14.m3.1.1.3.cmml" xref="S3.SS2.SSS3.p1.14.m3.1.1.3">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p1.14.m3.1c">\text{ch}_{x}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p1.14.m3.1d">ch start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\text{ch}_{y}" class="ltx_Math" display="inline" id="S3.SS2.SSS3.p1.15.m4.1"><semantics id="S3.SS2.SSS3.p1.15.m4.1a"><msub id="S3.SS2.SSS3.p1.15.m4.1.1" xref="S3.SS2.SSS3.p1.15.m4.1.1.cmml"><mtext id="S3.SS2.SSS3.p1.15.m4.1.1.2" xref="S3.SS2.SSS3.p1.15.m4.1.1.2a.cmml">ch</mtext><mi id="S3.SS2.SSS3.p1.15.m4.1.1.3" xref="S3.SS2.SSS3.p1.15.m4.1.1.3.cmml">y</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p1.15.m4.1b"><apply id="S3.SS2.SSS3.p1.15.m4.1.1.cmml" xref="S3.SS2.SSS3.p1.15.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p1.15.m4.1.1.1.cmml" xref="S3.SS2.SSS3.p1.15.m4.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.p1.15.m4.1.1.2a.cmml" xref="S3.SS2.SSS3.p1.15.m4.1.1.2"><mtext id="S3.SS2.SSS3.p1.15.m4.1.1.2.cmml" xref="S3.SS2.SSS3.p1.15.m4.1.1.2">ch</mtext></ci><ci id="S3.SS2.SSS3.p1.15.m4.1.1.3.cmml" xref="S3.SS2.SSS3.p1.15.m4.1.1.3">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p1.15.m4.1c">\text{ch}_{y}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p1.15.m4.1d">ch start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT</annotation></semantics></math>, respectively.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Model Inference</h3>
<div class="ltx_para ltx_noindent" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">Due to our model’s focus on using model uncertainty to promote the unsupervised learning aspect of retrieval models, after training and obtaining the embedding model, we can input long-contexts to the embedding model for retrieval after every 300-word chunk, without re-rank part in our pipeline. Therefore, our inference stage is efficient, specifically divided into the following steps: <span class="ltx_text ltx_font_italic" id="S3.SS3.p1.1.1">i</span>) We directly chunk the input document based on a fixed length, which is efficient, without using complex chunking mechanisms. <span class="ltx_text ltx_font_italic" id="S3.SS3.p1.1.2">ii</span>) Input the query to the retrieval model to retrieve the most similar <span class="ltx_text ltx_font_italic" id="S3.SS3.p1.1.3">m</span> chunks. <span class="ltx_text ltx_font_italic" id="S3.SS3.p1.1.4">iii</span>) Input the retrieved <span class="ltx_text ltx_font_italic" id="S3.SS3.p1.1.5">m</span> chunks and the query to the model to produce the final answer.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiment</h2>
<figure class="ltx_table" id="S4.T1">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T1.1" style="width:753.3pt;height:451pt;vertical-align:-1.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<p class="ltx_p" id="S4.T1.1.1"><span class="ltx_text" id="S4.T1.1.1.1">
<span class="ltx_tabular ltx_align_middle" id="S4.T1.1.1.1.1">
<span class="ltx_tr" id="S4.T1.1.1.1.1.1">
<span class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.1.1.1.1.1.1">Engine</span>
<span class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.1.1.1.1.1.2">Model</span>
<span class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.1.1.1.1.1.3">Truncate</span>
<span class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.1.1.1.1.1.4">BERT</span>
<span class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.1.1.1.1.1.5">Contriever</span>
<span class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.1.1.1.1.1.6">BGE-Large</span>
<span class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.1.1.1.1.1.7">BGE-M3</span>
<span class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S4.T1.1.1.1.1.1.8">GRAGON-PLUS</span>
<span class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.1.1.1.1.1.9">All Chunking</span>
<span class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S4.T1.1.1.1.1.1.10">Precise Chunking</span>
<span class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.1.1.1.1.1.11">Ours</span></span>
<span class="ltx_tr" id="S4.T1.1.1.1.1.2">
<span class="ltx_td ltx_align_center ltx_border_t ltx_rowspan ltx_rowspan_6" id="S4.T1.1.1.1.1.2.1"><span class="ltx_text" id="S4.T1.1.1.1.1.2.1.1">LLaMA-2-7B-Chat-HF</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.2.2">2WikiMultihopQA</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.2.3">28.50</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.2.4">32.73</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.2.5">33.60</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.2.6">34.14</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.2.7">29.64</span>
<span class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.1.1.1.2.8">34.61</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.2.9">33.77</span>
<span class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.1.1.1.2.10">34.60</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.2.11"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.1.2.11.1">37.27</span></span></span>
<span class="ltx_tr" id="S4.T1.1.1.1.1.3">
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.3.1">Musique</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.3.2">9.41</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.3.3">18.74</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.3.4">14.25</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.3.5">24.2</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.3.6"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.1.3.6.1">24.27</span></span>
<span class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.1.1.1.1.3.7">20.50</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.3.8">20.00</span>
<span class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.1.1.1.1.3.9">16.53</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.3.10">23.03</span></span>
<span class="ltx_tr" id="S4.T1.1.1.1.1.4">
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.4.1">TREC</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.4.2">64.50</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.4.3">66.00</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.4.4">70.00</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.4.5">70.05</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.4.6"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.1.4.6.1">71.00</span></span>
<span class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.1.1.1.1.4.7">70.50</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.4.8">67.50</span>
<span class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.1.1.1.1.4.9">65.50</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.4.10">68.00</span></span>
<span class="ltx_tr" id="S4.T1.1.1.1.1.5">
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.5.1">TriviaQA</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.5.2">77.80</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.5.3">78.69</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.5.4">76.09</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.5.5">75.10</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.5.6">75.74</span>
<span class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.1.1.1.1.5.7">77.51</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.5.8">78.47</span>
<span class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.1.1.1.1.5.9">79.84</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.5.10"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.1.5.10.1">80.41</span></span></span>
<span class="ltx_tr" id="S4.T1.1.1.1.1.6">
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.6.1">SAMSum</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.6.2">40.45</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.6.3">40.01</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.6.4">38.45</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.6.5">40.34</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.6.6">40.37</span>
<span class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.1.1.1.1.6.7">41.08</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.6.8">40.72</span>
<span class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.1.1.1.1.6.9">41.32</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.6.10"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.1.6.10.1">42.49</span></span></span>
<span class="ltx_tr" id="S4.T1.1.1.1.1.7">
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.7.1">Average</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.7.2">44.13</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.7.3">47.23</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.7.4">46.48</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.7.5">48.85</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.7.6">48.20</span>
<span class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.1.1.1.7.7">48.84</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.7.8">48.09</span>
<span class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.1.1.1.7.9">47.56</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.7.10"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.1.7.10.1">50.23</span></span></span>
<span class="ltx_tr" id="S4.T1.1.1.1.1.8">
<span class="ltx_td ltx_align_center ltx_border_t ltx_rowspan ltx_rowspan_6" id="S4.T1.1.1.1.1.8.1"><span class="ltx_text" id="S4.T1.1.1.1.1.8.1.1">Vicuna-7B</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.8.2">2WikiMultihopQA</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.8.3">22.74</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.8.4">23.19</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.8.5">23.02</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.8.6">23.41</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.8.7">23.81</span>
<span class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.1.1.1.8.8">22.21</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.8.9">20.89</span>
<span class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.1.1.1.8.10">23.50</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.8.11"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.1.8.11.1">24.69</span></span></span>
<span class="ltx_tr" id="S4.T1.1.1.1.1.9">
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.9.1">Musique</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.9.2">7.55</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.9.3">12.64</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.9.4">10.12</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.9.5">14.84</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.9.6"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.1.9.6.1">15.06</span></span>
<span class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.1.1.1.1.9.7">13.01</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.9.8">13.34</span>
<span class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.1.1.1.1.9.9">12.50</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.9.10">13.62</span></span>
<span class="ltx_tr" id="S4.T1.1.1.1.1.10">
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.10.1">TREC</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.10.2">67.50</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.10.3">67.50</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.10.4"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.1.10.4.1">70.50</span></span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.10.5"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.1.10.5.1">70.50</span></span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.10.6">69.00</span>
<span class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.1.1.1.1.10.7">70.00</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.10.8">65.50</span>
<span class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.1.1.1.1.10.9">69.00</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.10.10">69.00</span></span>
<span class="ltx_tr" id="S4.T1.1.1.1.1.11">
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.11.1">TriviaQA</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.11.2">75.06</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.11.3">73.21</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.11.4">74.72</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.11.5">74.69</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.11.6">74.39</span>
<span class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.1.1.1.1.11.7">73.67</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.11.8">79.00</span>
<span class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.1.1.1.1.11.9">75.04</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.11.10"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.1.11.10.1">76.34</span></span></span>
<span class="ltx_tr" id="S4.T1.1.1.1.1.12">
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.12.1">SAMSum</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.12.2">37.14</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.12.3">36.54</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.12.4">35.81</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.12.5">36.04</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.12.6">36.83</span>
<span class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.1.1.1.1.12.7">37.22</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.12.8">38.73</span>
<span class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.1.1.1.1.12.9">37.03</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.12.10"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.1.12.10.1">37.88</span></span></span>
<span class="ltx_tr" id="S4.T1.1.1.1.1.13">
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.13.1">Average</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.13.2">42.20</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.13.3">42.61</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.13.4">42.83</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.13.5">43.89</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.13.6">43.82</span>
<span class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.1.1.1.13.7">43.22</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.13.8">43.29</span>
<span class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.1.1.1.13.9">43.41</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.13.10"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.1.13.10.1">44.31</span></span></span>
<span class="ltx_tr" id="S4.T1.1.1.1.1.14">
<span class="ltx_td ltx_align_center ltx_border_t ltx_rowspan ltx_rowspan_6" id="S4.T1.1.1.1.1.14.1"><span class="ltx_text" id="S4.T1.1.1.1.1.14.1.1">Vicuna-7B-16K</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.14.2">2WikiMultihopQA</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.14.3">23.15</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.14.4">27.80</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.14.5">28.33</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.14.6">29.50</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.14.7">27.47</span>
<span class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.1.1.1.14.8">29.51</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.14.9">27.89</span>
<span class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.1.1.1.14.10">27.53</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.14.11"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.1.14.11.1">29.88</span></span></span>
<span class="ltx_tr" id="S4.T1.1.1.1.1.15">
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.15.1">Musique</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.15.2">8.11</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.15.3">13.12</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.15.4">9.88</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.15.5">14.15</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.15.6">13.02</span>
<span class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.1.1.1.1.15.7">13.24</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.15.8">13.10</span>
<span class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.1.1.1.1.15.9">12.78</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.15.10"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.1.15.10.1">14.94</span></span></span>
<span class="ltx_tr" id="S4.T1.1.1.1.1.16">
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.16.1">TREC</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.16.2">66.50</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.16.3">67.50</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.16.4">69.50</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.16.5">69.00</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.16.6">69.00</span>
<span class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.1.1.1.1.16.7"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.1.16.7.1">70.00</span></span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.16.8">67.00</span>
<span class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.1.1.1.1.16.9">66.00</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.16.10">68.50</span></span>
<span class="ltx_tr" id="S4.T1.1.1.1.1.17">
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.17.1">TriviaQA</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.17.2">83.96</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.17.3">82.93</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.17.4">85.74</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.17.5">84.56</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.17.6">84.46</span>
<span class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.1.1.1.1.17.7">83.05</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.17.8">84.84</span>
<span class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.1.1.1.1.17.9">84.71</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.17.10"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.1.17.10.1">84.98</span></span></span>
<span class="ltx_tr" id="S4.T1.1.1.1.1.18">
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.18.1">SAMSum</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.18.2">7.80</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.18.3">20.75</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.18.4">19.88</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.18.5">19.32</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.18.6">19.50</span>
<span class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.1.1.1.1.18.7">20.67</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.18.8"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.1.18.8.1">20.86</span></span>
<span class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.1.1.1.1.18.9">19.22</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.18.10">19.77</span></span>
<span class="ltx_tr" id="S4.T1.1.1.1.1.19">
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.19.1">Average</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.19.2">37.91</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.19.3">42.42</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.19.4">42.51</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.19.5">43.30</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.19.6">42.68</span>
<span class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.1.1.1.19.7">43.29</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.19.8">42.74</span>
<span class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.1.1.1.19.9">42.05</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.19.10"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.1.19.10.1">43.62</span></span></span>
<span class="ltx_tr" id="S4.T1.1.1.1.1.20">
<span class="ltx_td ltx_align_center ltx_border_bb ltx_border_t ltx_rowspan ltx_rowspan_6" id="S4.T1.1.1.1.1.20.1"><span class="ltx_text" id="S4.T1.1.1.1.1.20.1.1">LLaMA-2-13B-Chat-HF</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.20.2">2WikiMultihopQA</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.20.3">34.73</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.20.4">35.82</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.20.5">40.28</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.20.6"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.1.20.6.1">42.05</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.20.7">38.13</span>
<span class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.1.1.1.20.8">38.46</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.20.9">36.15</span>
<span class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.1.1.1.20.10">37.31</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1.20.11">38.28</span></span>
<span class="ltx_tr" id="S4.T1.1.1.1.1.21">
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.21.1">Musique</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.21.2">12.12</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.21.3">22.13</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.21.4">18.69</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.21.5">24.69</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.21.6"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.1.21.6.1">24.74</span></span>
<span class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.1.1.1.1.21.7">22.71</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.21.8">19.79</span>
<span class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.1.1.1.1.21.9">21.30</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.21.10"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.1.21.10.1">24.74</span></span></span>
<span class="ltx_tr" id="S4.T1.1.1.1.1.22">
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.22.1">TREC</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.22.2">69.50</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.22.3">67.00</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.22.4">70.00</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.22.5">70.00</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.22.6"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.1.22.6.1">70.50</span></span>
<span class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.1.1.1.1.22.7">70.00</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.22.8">67.00</span>
<span class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.1.1.1.1.22.9">68.50</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.22.10">68.50</span></span>
<span class="ltx_tr" id="S4.T1.1.1.1.1.23">
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.23.1">TriviaQA</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.23.2">80.58</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.23.3">80.86</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.23.4">78.27</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.23.5">76.52</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.23.6">77.95</span>
<span class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.1.1.1.1.23.7">79.69</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.23.8">81.50</span>
<span class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.1.1.1.1.23.9">81.41</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.23.10"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.1.23.10.1">82.47</span></span></span>
<span class="ltx_tr" id="S4.T1.1.1.1.1.24">
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.24.1">SAMSum</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.24.2">36.95</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.24.3">41.62</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.24.4">41.00</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.24.5">42.49</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.24.6">42.43</span>
<span class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.1.1.1.1.24.7">41.23</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.24.8">43.09</span>
<span class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.1.1.1.1.24.9">41.03</span>
<span class="ltx_td ltx_align_center" id="S4.T1.1.1.1.1.24.10"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.1.24.10.1">42.61</span></span></span>
<span class="ltx_tr" id="S4.T1.1.1.1.1.25">
<span class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T1.1.1.1.1.25.1">Average</span>
<span class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T1.1.1.1.1.25.2">46.77</span>
<span class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T1.1.1.1.1.25.3">49.48</span>
<span class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T1.1.1.1.1.25.4">49.65</span>
<span class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T1.1.1.1.1.25.5">51.14</span>
<span class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T1.1.1.1.1.25.6">50.75</span>
<span class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="S4.T1.1.1.1.1.25.7">50.37</span>
<span class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T1.1.1.1.1.25.8">49.50</span>
<span class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="S4.T1.1.1.1.1.25.9">49.91</span>
<span class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T1.1.1.1.1.25.10"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.1.25.10.1">51.32</span></span></span>
</span></span></p>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Experiment results on long-context retrieval augmented language generation. <span class="ltx_text ltx_font_italic" id="S4.T1.4.1">All Chunking</span> denotes the use of the average self-information of all tokens from two concatenated chunks as the similarity score for selecting positive and negative samples in contrastive learning. In contrast, <span class="ltx_text ltx_font_italic" id="S4.T1.5.2">Precise Chunking</span> denotes the accurate segmentation of the chunks, utilizing only the average self-information from the second chunk.</figcaption>
</figure>
<figure class="ltx_table" id="S4.T2">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T2.1" style="width:563.2pt;height:235pt;vertical-align:-1.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<p class="ltx_p" id="S4.T2.1.1"><span class="ltx_text" id="S4.T2.1.1.1">
<span class="ltx_tabular ltx_align_middle" id="S4.T2.1.1.1.1">
<span class="ltx_tr" id="S4.T2.1.1.1.1.1">
<span class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.1.1.1.1.1.1">Model</span>
<span class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.1.1.1.1.1.2">Scaling method</span>
<span class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.1.1.1.1.1.3">2WikiMultihopQA</span>
<span class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.1.1.1.1.1.4">Musique</span>
<span class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.1.1.1.1.1.5">TREC</span>
<span class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.1.1.1.1.1.6">TriviaQA</span>
<span class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.1.1.1.1.1.7">SAMSum</span>
<span class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.1.1.1.1.1.8">Average</span></span>
<span class="ltx_tr" id="S4.T2.1.1.1.1.2">
<span class="ltx_td ltx_align_center ltx_border_t ltx_rowspan ltx_rowspan_4" id="S4.T2.1.1.1.1.2.1"><span class="ltx_text" id="S4.T2.1.1.1.1.2.1.1">All Chunking</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.1.1.2.2">w/o Scaling</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.1.1.2.3">23.03</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.1.1.2.4">23.91</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.1.1.2.5">66.00</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.1.1.2.6">79.15</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.1.1.2.7">41.77</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.1.1.2.8">46.86</span></span>
<span class="ltx_tr" id="S4.T2.1.1.1.1.3">
<span class="ltx_td ltx_align_center" id="S4.T2.1.1.1.1.3.1">Pos/neg Scaling</span>
<span class="ltx_td ltx_align_center" id="S4.T2.1.1.1.1.3.2">32.47</span>
<span class="ltx_td ltx_align_center" id="S4.T2.1.1.1.1.3.3">22.41</span>
<span class="ltx_td ltx_align_center" id="S4.T2.1.1.1.1.3.4">66.00</span>
<span class="ltx_td ltx_align_center" id="S4.T2.1.1.1.1.3.5">79.15</span>
<span class="ltx_td ltx_align_center" id="S4.T2.1.1.1.1.3.6">41.86</span>
<span class="ltx_td ltx_align_center" id="S4.T2.1.1.1.1.3.7">48.38</span></span>
<span class="ltx_tr" id="S4.T2.1.1.1.1.4">
<span class="ltx_td ltx_align_center" id="S4.T2.1.1.1.1.4.1">Anchor Scaling</span>
<span class="ltx_td ltx_align_center" id="S4.T2.1.1.1.1.4.2">34.87</span>
<span class="ltx_td ltx_align_center" id="S4.T2.1.1.1.1.4.3">21.49</span>
<span class="ltx_td ltx_align_center" id="S4.T2.1.1.1.1.4.4">67.50</span>
<span class="ltx_td ltx_align_center" id="S4.T2.1.1.1.1.4.5">77.46</span>
<span class="ltx_td ltx_align_center" id="S4.T2.1.1.1.1.4.6">40.72</span>
<span class="ltx_td ltx_align_center" id="S4.T2.1.1.1.1.4.7">48.41</span></span>
<span class="ltx_tr" id="S4.T2.1.1.1.1.5">
<span class="ltx_td ltx_align_center" id="S4.T2.1.1.1.1.5.1">Anchor and Pos/neg Scaling</span>
<span class="ltx_td ltx_align_center" id="S4.T2.1.1.1.1.5.2">33.77</span>
<span class="ltx_td ltx_align_center" id="S4.T2.1.1.1.1.5.3">20.00</span>
<span class="ltx_td ltx_align_center" id="S4.T2.1.1.1.1.5.4">67.50</span>
<span class="ltx_td ltx_align_center" id="S4.T2.1.1.1.1.5.5">78.47</span>
<span class="ltx_td ltx_align_center" id="S4.T2.1.1.1.1.5.6">40.72</span>
<span class="ltx_td ltx_align_center" id="S4.T2.1.1.1.1.5.7">48.09</span></span>
<span class="ltx_tr" id="S4.T2.1.1.1.1.6">
<span class="ltx_td ltx_align_center ltx_border_t ltx_rowspan ltx_rowspan_4" id="S4.T2.1.1.1.1.6.1"><span class="ltx_text" id="S4.T2.1.1.1.1.6.1.1">Precise Chunking</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.1.1.6.2">w/o Scaling</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.1.1.6.3">35.65</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.1.1.6.4">18.91</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.1.1.6.5">66.00</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.1.1.6.6">78.10</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.1.1.6.7">41.22</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.1.1.6.8">47.97</span></span>
<span class="ltx_tr" id="S4.T2.1.1.1.1.7">
<span class="ltx_td ltx_align_center" id="S4.T2.1.1.1.1.7.1">Pos/neg Scaling</span>
<span class="ltx_td ltx_align_center" id="S4.T2.1.1.1.1.7.2">33.77</span>
<span class="ltx_td ltx_align_center" id="S4.T2.1.1.1.1.7.3">19.09</span>
<span class="ltx_td ltx_align_center" id="S4.T2.1.1.1.1.7.4">64.50</span>
<span class="ltx_td ltx_align_center" id="S4.T2.1.1.1.1.7.5">79.48</span>
<span class="ltx_td ltx_align_center" id="S4.T2.1.1.1.1.7.6">41.89</span>
<span class="ltx_td ltx_align_center" id="S4.T2.1.1.1.1.7.7">47.74</span></span>
<span class="ltx_tr" id="S4.T2.1.1.1.1.8">
<span class="ltx_td ltx_align_center" id="S4.T2.1.1.1.1.8.1">Anchor Scaling</span>
<span class="ltx_td ltx_align_center" id="S4.T2.1.1.1.1.8.2">34.81</span>
<span class="ltx_td ltx_align_center" id="S4.T2.1.1.1.1.8.3">16.76</span>
<span class="ltx_td ltx_align_center" id="S4.T2.1.1.1.1.8.4">67.50</span>
<span class="ltx_td ltx_align_center" id="S4.T2.1.1.1.1.8.5">78.00</span>
<span class="ltx_td ltx_align_center" id="S4.T2.1.1.1.1.8.6">41.64</span>
<span class="ltx_td ltx_align_center" id="S4.T2.1.1.1.1.8.7">47.89</span></span>
<span class="ltx_tr" id="S4.T2.1.1.1.1.9">
<span class="ltx_td ltx_align_center" id="S4.T2.1.1.1.1.9.1">Anchor and Pos/neg Scaling</span>
<span class="ltx_td ltx_align_center" id="S4.T2.1.1.1.1.9.2">34.60</span>
<span class="ltx_td ltx_align_center" id="S4.T2.1.1.1.1.9.3">16.53</span>
<span class="ltx_td ltx_align_center" id="S4.T2.1.1.1.1.9.4">65.50</span>
<span class="ltx_td ltx_align_center" id="S4.T2.1.1.1.1.9.5">79.83</span>
<span class="ltx_td ltx_align_center" id="S4.T2.1.1.1.1.9.6">41.32</span>
<span class="ltx_td ltx_align_center" id="S4.T2.1.1.1.1.9.7">47.55</span></span>
<span class="ltx_tr" id="S4.T2.1.1.1.1.10">
<span class="ltx_td ltx_align_center ltx_border_bb ltx_border_t ltx_rowspan ltx_rowspan_4" id="S4.T2.1.1.1.1.10.1"><span class="ltx_text" id="S4.T2.1.1.1.1.10.1.1">Uncertainty-RAG</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.1.1.10.2">w/o Scaling</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.1.1.10.3">36.05</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.1.1.10.4">19.58</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.1.1.10.5">68.00</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.1.1.10.6">79.98</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.1.1.10.7">42.25</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.1.1.10.8">49.17</span></span>
<span class="ltx_tr" id="S4.T2.1.1.1.1.11">
<span class="ltx_td ltx_align_center" id="S4.T2.1.1.1.1.11.1">Pos/neg Scaling</span>
<span class="ltx_td ltx_align_center" id="S4.T2.1.1.1.1.11.2">37.86</span>
<span class="ltx_td ltx_align_center" id="S4.T2.1.1.1.1.11.3">22.31</span>
<span class="ltx_td ltx_align_center" id="S4.T2.1.1.1.1.11.4">65.50</span>
<span class="ltx_td ltx_align_center" id="S4.T2.1.1.1.1.11.5">79.83</span>
<span class="ltx_td ltx_align_center" id="S4.T2.1.1.1.1.11.6">42.54</span>
<span class="ltx_td ltx_align_center" id="S4.T2.1.1.1.1.11.7">49.61</span></span>
<span class="ltx_tr" id="S4.T2.1.1.1.1.12">
<span class="ltx_td ltx_align_center" id="S4.T2.1.1.1.1.12.1">Anchor Scaling</span>
<span class="ltx_td ltx_align_center" id="S4.T2.1.1.1.1.12.2">36.94</span>
<span class="ltx_td ltx_align_center" id="S4.T2.1.1.1.1.12.3">20.73</span>
<span class="ltx_td ltx_align_center" id="S4.T2.1.1.1.1.12.4">69.00</span>
<span class="ltx_td ltx_align_center" id="S4.T2.1.1.1.1.12.5">78.73</span>
<span class="ltx_td ltx_align_center" id="S4.T2.1.1.1.1.12.6">42.09</span>
<span class="ltx_td ltx_align_center" id="S4.T2.1.1.1.1.12.7">49.50</span></span>
<span class="ltx_tr" id="S4.T2.1.1.1.1.13">
<span class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.1.1.1.1.13.1">Anchor and Pos/neg scaling</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.1.1.1.1.13.2">37.27</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.1.1.1.1.13.3">23.03</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.1.1.1.1.13.4">68.00</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.1.1.1.1.13.5">80.41</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.1.1.1.1.13.6">42.49</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.1.1.1.1.13.7">50.23</span></span>
</span></span></p>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Experiment results on scaling of anchor and positive/negative samples. In the table, the positive/negative samples are denoted as pos/neg.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">We primarily train our retrieval model on the HotpotQA, MultiFieldQA, Qasper, NarrativeQA, and QMSum datasets. We evaluate the model on 2WikiMultihopQA <cite class="ltx_cite ltx_citemacro_citep">(Ho et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib25" title="">2020</a>)</cite>, Musique <cite class="ltx_cite ltx_citemacro_citep">(Trivedi et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib69" title="">2022</a>)</cite>, TREC <cite class="ltx_cite ltx_citemacro_citep">(Li &amp; Roth, <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib44" title="">2002</a>)</cite>, TriviaQA <cite class="ltx_cite ltx_citemacro_citep">(Joshi et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib31" title="">2017</a>)</cite>, and SAMSum <cite class="ltx_cite ltx_citemacro_citep">(Zhong et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib84" title="">2021</a>)</cite>. Under this distribution-shift setting, our retrieval model has never been exposed to any data from these test datasets. We provide a detailed introduction to our dataset in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#A1" title="Appendix A Training Dataset ‣ UncertaintyRAG: Span-Level Uncertainty Enhanced Long-Context Modeling for Retrieval-Augmented Generation"><span class="ltx_text ltx_ref_tag">A</span></a>. We provide detailed settings of the hyperparameters in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#A2" title="Appendix B Hyperparameter Settings ‣ UncertaintyRAG: Span-Level Uncertainty Enhanced Long-Context Modeling for Retrieval-Augmented Generation"><span class="ltx_text ltx_ref_tag">B</span></a>. We adopt various open-source embedding models as our baselines, which typically involve pre-training on large datasets. An introduction to the baselines is provided in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#A3" title="Appendix C Baselines ‣ UncertaintyRAG: Span-Level Uncertainty Enhanced Long-Context Modeling for Retrieval-Augmented Generation"><span class="ltx_text ltx_ref_tag">C</span></a>. In Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#A5" title="Appendix E Analysis of Training Data Utilization and Parameter Efficiency ‣ UncertaintyRAG: Span-Level Uncertainty Enhanced Long-Context Modeling for Retrieval-Augmented Generation"><span class="ltx_text ltx_ref_tag">E</span></a>, we demonstrate the advantages of our method in terms of an efficient training data sampling strategy and parameter efficiency. In our evaluation, we use four models: Llama2-7B/13B-chat-hf <cite class="ltx_cite ltx_citemacro_citep">(Touvron et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib68" title="">2023</a>)</cite>, Vicuna-7B/7B-16K <cite class="ltx_cite ltx_citemacro_citep">(Chiang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib10" title="">2023</a>)</cite>.</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Main Result</h3>
<div class="ltx_para ltx_noindent" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">As shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#S4.T1" title="Table 1 ‣ 4 Experiment ‣ UncertaintyRAG: Span-Level Uncertainty Enhanced Long-Context Modeling for Retrieval-Augmented Generation"><span class="ltx_text ltx_ref_tag">1</span></a>, the following observations can be made: <span class="ltx_text ltx_font_italic" id="S4.SS1.p1.1.1">i</span>): Robust RAG retrieval model can significantly improve the performance of the 4K context window LLMs; however, this heavily depends on the performance of the retrieval model. <span class="ltx_text ltx_font_italic" id="S4.SS1.p1.1.2">ii</span>): A powerful retrieval model can enhance the performance of LLMs. Vicuna-7B and LLaMA-2-7B-Chat-HF perform similarly within their 4K context windows, with an average performance difference of about 1.93% without retrieval augmentation. When equipped with a robust retrieval model, the average performance gap can increase to 6.14%. <span class="ltx_text ltx_font_italic" id="S4.SS1.p1.1.3">iii</span>): Our method achieves the highest average performance, surpassing some open-source embedding models trained on large datasets. However, performance is limited on few-shot learning tasks like TREC due to the need for precise segmentation of in-context exemplars. Still, our method shows a consistent 2% improvement over the baseline. In addition, we have the following important findings.</p>
</div>
<section class="ltx_paragraph" id="S4.SS1.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Analysis of The Impact of Span Uncertainty through SNR Calibration</h5>
<div class="ltx_para ltx_noindent" id="S4.SS1.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS1.SSS0.Px1.p1.1">In Table <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#S4.T1" title="Table 1 ‣ 4 Experiment ‣ UncertaintyRAG: Span-Level Uncertainty Enhanced Long-Context Modeling for Retrieval-Augmented Generation"><span class="ltx_text ltx_ref_tag">1</span></a>, our analysis reveals that the span uncertainty method, following SNR calibration, demonstrates significant improvements compared to both <span class="ltx_text ltx_font_italic" id="S4.SS1.SSS0.Px1.p1.1.1">All Chunking</span> and <span class="ltx_text ltx_font_italic" id="S4.SS1.SSS0.Px1.p1.1.2">Precise Chunking</span>. This enhancement is primarily due to the incorporation of self-information from certain tokens in the first chunk, which comes from the flexible sampling of spans across the two chunks by SNR. Thus, we can draw the following conclusions. <span class="ltx_text ltx_font_italic" id="S4.SS1.SSS0.Px1.p1.1.3">i</span>): SNR calibration effectively captures the similarity between the two chunks. <span class="ltx_text ltx_font_italic" id="S4.SS1.SSS0.Px1.p1.1.4">ii</span>): The tokens within the span sampled by SNR play a crucial role in assessing the relationship between the two chunks, suggesting that future research could benefit from focusing on span-level uncertainty.</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS1.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Ablation Study on The Effects of Scaling Up the Data</h5>
<div class="ltx_para ltx_noindent" id="S4.SS1.SSS0.Px2.p1">
<p class="ltx_p" id="S4.SS1.SSS0.Px2.p1.1">In Table <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#S4.T2" title="Table 2 ‣ 4 Experiment ‣ UncertaintyRAG: Span-Level Uncertainty Enhanced Long-Context Modeling for Retrieval-Augmented Generation"><span class="ltx_text ltx_ref_tag">2</span></a>, we present the results of scaling the anchor data in our dataset, fixing the anchor while scaling the positive/negative sample data, and scaling both the anchor and positive/negative samples simultaneously. Due to limitations in computational resources, we only doubled the size of the data. <span class="ltx_text ltx_font_italic" id="S4.SS1.SSS0.Px2.p1.1.1">i</span>): By simultaneously doubling both the anchor and positive/negative samples after fixing the anchor, we achieved state-of-the-art results, demonstrating the scalability of our method with respect to data size. <span class="ltx_text ltx_font_italic" id="S4.SS1.SSS0.Px2.p1.1.2">ii</span>): Our dataset sampling method is simple and easy to use, and applicable to any text dataset that can be chunked.</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS1.SSS0.Px3">
<h5 class="ltx_title ltx_title_paragraph">Ablation Study on Chunk Length and The Number of Chunks</h5>
<div class="ltx_para ltx_noindent" id="S4.SS1.SSS0.Px3.p1">
<p class="ltx_p" id="S4.SS1.SSS0.Px3.p1.1">In Table <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#S4.T3" title="Table 3 ‣ Ablation Study on Chunk Length and The Number of Chunks ‣ 4.1 Main Result ‣ 4 Experiment ‣ UncertaintyRAG: Span-Level Uncertainty Enhanced Long-Context Modeling for Retrieval-Augmented Generation"><span class="ltx_text ltx_ref_tag">3</span></a>, we evaluate the Vicuna-7B-16K model on the 2WikiMultihopQA dataset, varying the number of chunks while keeping chunk length constant, and adjusting the chunk length while keeping the number of chunks constant. <span class="ltx_text ltx_font_italic" id="S4.SS1.SSS0.Px3.p1.1.1">i</span>): We find that increasing the number of chunks is not effective; instead, increasing the chunk length itself yields better results. <span class="ltx_text ltx_font_italic" id="S4.SS1.SSS0.Px3.p1.1.2">ii</span>): However, simply increasing the chunk size is not a one-size-fits-all solution, as it can also harm performance, which is contrary to the findings of LongRAG <cite class="ltx_cite ltx_citemacro_citep">(Jiang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib30" title="">2024b</a>)</cite>.</p>
</div>
<figure class="ltx_table" id="S4.T3">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T3.3" style="width:710.5pt;height:181pt;vertical-align:-1.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<p class="ltx_p" id="S4.T3.3.1"><span class="ltx_text" id="S4.T3.3.1.1">
<span class="ltx_tabular ltx_align_middle" id="S4.T3.3.1.1.1">
<span class="ltx_tr" id="S4.T3.3.1.1.1.1">
<span class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.3.1.1.1.1.1">Model</span>
<span class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.3.1.1.1.1.2">Chunk size</span>
<span class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.3.1.1.1.1.3">Chunk number</span>
<span class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.3.1.1.1.1.4">Length</span>
<span class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.3.1.1.1.1.5">Contriever</span>
<span class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.3.1.1.1.1.6">BGE-Large</span>
<span class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.3.1.1.1.1.7">BGE-M3</span>
<span class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.3.1.1.1.1.8">DRAGON-PLUS</span>
<span class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.3.1.1.1.1.9">All Chunking</span>
<span class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.3.1.1.1.1.10">Precise Chunking</span>
<span class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.3.1.1.1.1.11">Ours</span></span>
<span class="ltx_tr" id="S4.T3.3.1.1.1.2">
<span class="ltx_td ltx_align_center ltx_border_t ltx_rowspan ltx_rowspan_3" id="S4.T3.3.1.1.1.2.1"><span class="ltx_text" id="S4.T3.3.1.1.1.2.1.1">Vicuna-7B</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.3.1.1.1.2.2">300</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.3.1.1.1.2.3">40</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.3.1.1.1.2.4">4k</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.3.1.1.1.2.5">22.82</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.3.1.1.1.2.6">24.13</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.3.1.1.1.2.7">23.45</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.3.1.1.1.2.8">21.15</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.3.1.1.1.2.9">19.87</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.3.1.1.1.2.10">23.42</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.3.1.1.1.2.11">24.16</span></span>
<span class="ltx_tr" id="S4.T3.3.1.1.1.3">
<span class="ltx_td ltx_align_center" id="S4.T3.3.1.1.1.3.1">300</span>
<span class="ltx_td ltx_align_center" id="S4.T3.3.1.1.1.3.2">30</span>
<span class="ltx_td ltx_align_center" id="S4.T3.3.1.1.1.3.3">3k</span>
<span class="ltx_td ltx_align_center" id="S4.T3.3.1.1.1.3.4">23.02</span>
<span class="ltx_td ltx_align_center" id="S4.T3.3.1.1.1.3.5">23.41</span>
<span class="ltx_td ltx_align_center" id="S4.T3.3.1.1.1.3.6">23.81</span>
<span class="ltx_td ltx_align_center" id="S4.T3.3.1.1.1.3.7">22.21</span>
<span class="ltx_td ltx_align_center" id="S4.T3.3.1.1.1.3.8">20.89</span>
<span class="ltx_td ltx_align_center" id="S4.T3.3.1.1.1.3.9">23.50</span>
<span class="ltx_td ltx_align_center" id="S4.T3.3.1.1.1.3.10">24.69</span></span>
<span class="ltx_tr" id="S4.T3.3.1.1.1.4">
<span class="ltx_td ltx_align_center" id="S4.T3.3.1.1.1.4.1">300</span>
<span class="ltx_td ltx_align_center" id="S4.T3.3.1.1.1.4.2">20</span>
<span class="ltx_td ltx_align_center" id="S4.T3.3.1.1.1.4.3">2k</span>
<span class="ltx_td ltx_align_center" id="S4.T3.3.1.1.1.4.4">21.56</span>
<span class="ltx_td ltx_align_center" id="S4.T3.3.1.1.1.4.5">23.96</span>
<span class="ltx_td ltx_align_center" id="S4.T3.3.1.1.1.4.6">26.24</span>
<span class="ltx_td ltx_align_center" id="S4.T3.3.1.1.1.4.7">22.00</span>
<span class="ltx_td ltx_align_center" id="S4.T3.3.1.1.1.4.8">20.13</span>
<span class="ltx_td ltx_align_center" id="S4.T3.3.1.1.1.4.9">23.65</span>
<span class="ltx_td ltx_align_center" id="S4.T3.3.1.1.1.4.10">23.83</span></span>
<span class="ltx_tr" id="S4.T3.3.1.1.1.5">
<span class="ltx_td ltx_align_center ltx_border_bb ltx_border_t ltx_rowspan ltx_rowspan_6" id="S4.T3.3.1.1.1.5.1"><span class="ltx_text" id="S4.T3.3.1.1.1.5.1.1">Vicuna-7B-16K</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.3.1.1.1.5.2">300</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.3.1.1.1.5.3">40</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.3.1.1.1.5.4">4k</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.3.1.1.1.5.5">27.03</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.3.1.1.1.5.6">27.98</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.3.1.1.1.5.7">26.60</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.3.1.1.1.5.8">28.45</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.3.1.1.1.5.9">24.73</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.3.1.1.1.5.10">24.53</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.3.1.1.1.5.11">25.83</span></span>
<span class="ltx_tr" id="S4.T3.3.1.1.1.6">
<span class="ltx_td ltx_align_center" id="S4.T3.3.1.1.1.6.1">300</span>
<span class="ltx_td ltx_align_center" id="S4.T3.3.1.1.1.6.2">30</span>
<span class="ltx_td ltx_align_center" id="S4.T3.3.1.1.1.6.3">3k</span>
<span class="ltx_td ltx_align_center" id="S4.T3.3.1.1.1.6.4">27.26</span>
<span class="ltx_td ltx_align_center" id="S4.T3.3.1.1.1.6.5">28.93</span>
<span class="ltx_td ltx_align_center" id="S4.T3.3.1.1.1.6.6">27.98</span>
<span class="ltx_td ltx_align_center" id="S4.T3.3.1.1.1.6.7">29.45</span>
<span class="ltx_td ltx_align_center" id="S4.T3.3.1.1.1.6.8">25.81</span>
<span class="ltx_td ltx_align_center" id="S4.T3.3.1.1.1.6.9">24.88</span>
<span class="ltx_td ltx_align_center" id="S4.T3.3.1.1.1.6.10">26.56</span></span>
<span class="ltx_tr" id="S4.T3.3.1.1.1.7">
<span class="ltx_td ltx_align_center" id="S4.T3.3.1.1.1.7.1">300</span>
<span class="ltx_td ltx_align_center" id="S4.T3.3.1.1.1.7.2">20</span>
<span class="ltx_td ltx_align_center" id="S4.T3.3.1.1.1.7.3">2k</span>
<span class="ltx_td ltx_align_center" id="S4.T3.3.1.1.1.7.4">28.33</span>
<span class="ltx_td ltx_align_center" id="S4.T3.3.1.1.1.7.5">29.50</span>
<span class="ltx_td ltx_align_center" id="S4.T3.3.1.1.1.7.6">27.47</span>
<span class="ltx_td ltx_align_center" id="S4.T3.3.1.1.1.7.7">29.51</span>
<span class="ltx_td ltx_align_center" id="S4.T3.3.1.1.1.7.8">27.89</span>
<span class="ltx_td ltx_align_center" id="S4.T3.3.1.1.1.7.9">27.53</span>
<span class="ltx_td ltx_align_center" id="S4.T3.3.1.1.1.7.10">29.88</span></span>
<span class="ltx_tr" id="S4.T3.3.1.1.1.8">
<span class="ltx_td ltx_align_center" id="S4.T3.3.1.1.1.8.1">600</span>
<span class="ltx_td ltx_align_center" id="S4.T3.3.1.1.1.8.2">40</span>
<span class="ltx_td ltx_align_center" id="S4.T3.3.1.1.1.8.3">8k</span>
<span class="ltx_td ltx_align_center" id="S4.T3.3.1.1.1.8.4">26.94</span>
<span class="ltx_td ltx_align_center" id="S4.T3.3.1.1.1.8.5">28.83</span>
<span class="ltx_td ltx_align_center" id="S4.T3.3.1.1.1.8.6">26.78</span>
<span class="ltx_td ltx_align_center" id="S4.T3.3.1.1.1.8.7">27.11</span>
<span class="ltx_td ltx_align_center" id="S4.T3.3.1.1.1.8.8">26.70</span>
<span class="ltx_td ltx_align_center" id="S4.T3.3.1.1.1.8.9">27.57</span>
<span class="ltx_td ltx_align_center" id="S4.T3.3.1.1.1.8.10">25.83</span></span>
<span class="ltx_tr" id="S4.T3.3.1.1.1.9">
<span class="ltx_td ltx_align_center" id="S4.T3.3.1.1.1.9.1">600</span>
<span class="ltx_td ltx_align_center" id="S4.T3.3.1.1.1.9.2">30</span>
<span class="ltx_td ltx_align_center" id="S4.T3.3.1.1.1.9.3">6k</span>
<span class="ltx_td ltx_align_center" id="S4.T3.3.1.1.1.9.4">27.18</span>
<span class="ltx_td ltx_align_center" id="S4.T3.3.1.1.1.9.5">28.86</span>
<span class="ltx_td ltx_align_center" id="S4.T3.3.1.1.1.9.6">27.84</span>
<span class="ltx_td ltx_align_center" id="S4.T3.3.1.1.1.9.7">28.53</span>
<span class="ltx_td ltx_align_center" id="S4.T3.3.1.1.1.9.8">26.66</span>
<span class="ltx_td ltx_align_center" id="S4.T3.3.1.1.1.9.9">26.78</span>
<span class="ltx_td ltx_align_center" id="S4.T3.3.1.1.1.9.10">28.34</span></span>
<span class="ltx_tr" id="S4.T3.3.1.1.1.10">
<span class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.3.1.1.1.10.1">600</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.3.1.1.1.10.2">20</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.3.1.1.1.10.3">4k</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.3.1.1.1.10.4">27.72</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.3.1.1.1.10.5">28.93</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.3.1.1.1.10.6">29.08</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.3.1.1.1.10.7">29.26</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.3.1.1.1.10.8">27.78</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.3.1.1.1.10.9">27.75</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.3.1.1.1.10.10">29.64</span></span>
</span></span></p>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Abalation of different chunk size and different chunk number on 2WikiMultihopQA. Chunk number refers to the number <math alttext="m" class="ltx_Math" display="inline" id="S4.T3.2.m1.1"><semantics id="S4.T3.2.m1.1b"><mi id="S4.T3.2.m1.1.1" xref="S4.T3.2.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S4.T3.2.m1.1c"><ci id="S4.T3.2.m1.1.1.cmml" xref="S4.T3.2.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.2.m1.1d">m</annotation><annotation encoding="application/x-llamapun" id="S4.T3.2.m1.1e">italic_m</annotation></semantics></math> of the most similar chunks selected as prompts. Length refers to the total length of the prompt.</figcaption>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Representation Analysis</h3>
<section class="ltx_paragraph" id="S4.SS2.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Representation Similarity Analysis</h5>
<div class="ltx_para ltx_noindent" id="S4.SS2.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS2.SSS0.Px1.p1.1">In this part, we demonstrate the changes in similarity across different layers of our representation in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#S4.F3" title="Figure 3 ‣ Representation Similarity Analysis ‣ 4.2 Representation Analysis ‣ 4 Experiment ‣ UncertaintyRAG: Span-Level Uncertainty Enhanced Long-Context Modeling for Retrieval-Augmented Generation"><span class="ltx_text ltx_ref_tag">3</span></a>. Representation Similarity Analysis (RSA;<cite class="ltx_cite ltx_citemacro_cite">Laakso &amp; Cottrell (<a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib38" title="">2000</a>)</cite>) is a technique for measuring the similarity between two different representation spaces for a given set of stimuli. We demonstrated on 2WikiMultihopQA and the typical in-context learning task GSM8K <cite class="ltx_cite ltx_citemacro_citep">(Cobbe et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib11" title="">2021</a>)</cite> the changes in representations across different layers compared to the original BERT representations.</p>
</div>
<figure class="ltx_figure ltx_align_floatright" id="S4.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="218" id="S4.F3.g1" src="x2.png" width="327"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Representation Similarity Analysis</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS2.SSS0.Px1.p2">
<p class="ltx_p" id="S4.SS2.SSS0.Px1.p2.1">We observe that: <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS0.Px1.p2.1.1">i:</span>) Before the eighth layer, variability in model representations is minimal across datasets and scoring methods. <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS0.Px1.p2.1.2">ii:</span>) After the eighth layer, the model shows smaller changes on the GSM8K dataset with significant distribution shift, larger changes on the 2WikiMultihopQA dataset with minor shifts, and the most substantial changes on the training set. This indicates that RSA is an effective metric for assessing distribution shifts. <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS0.Px1.p2.1.3">iii:</span>) Under the enhanced long-context modeling with Span Uncertainty, the model exhibits greater representation changes across varying distribution shifts, consistently outperforming precise chunking and leading to performance improvements. To further analyze these representation variations, we will employ two metrics in the next part.</p>
</div>
<figure class="ltx_figure" id="S4.F4">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F4.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="579" id="S4.F4.sf1.g1" src="x3.png" width="760"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Uncertainty-RAG</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F4.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="579" id="S4.F4.sf2.g1" src="x4.png" width="760"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Precise Chunking</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Align and Uniform. This figure shows uniformity and alignment of different chunk embedding along with their averaged semantic textual similarity (STS <cite class="ltx_cite ltx_citemacro_citep">(Conneau et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib12" title="">2017</a>)</cite>) results.</figcaption>
</figure>
</section>
<section class="ltx_paragraph" id="S4.SS2.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Representation Property Analysis</h5>
<div class="ltx_para ltx_noindent" id="S4.SS2.SSS0.Px2.p1">
<p class="ltx_p" id="S4.SS2.SSS0.Px2.p1.1"><cite class="ltx_cite ltx_citemacro_cite">Wang &amp; Isola (<a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib71" title="">2020</a>)</cite> introduces the properties of uniformity and alignment that contrastive learning improves in retrieval models, which are essential for evaluating the quality of retrieval models in machine learning. Alignment is quantified by the expected distance between the embeddings of paired positive chunk, assuming that these embeddings are normalized. The formula for alignment is expressed as:</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.SSS0.Px2.p2">
<table class="ltx_equation ltx_eqn_table" id="S4.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\ell_{align}\triangleq\mathbb{E}_{(ch,ch^{+})\sim p_{pos}}\left\|f(ch)-f(ch^{+%
})\right\|^{2}," class="ltx_Math" display="block" id="S4.E7.m1.3"><semantics id="S4.E7.m1.3a"><mrow id="S4.E7.m1.3.3.1" xref="S4.E7.m1.3.3.1.1.cmml"><mrow id="S4.E7.m1.3.3.1.1" xref="S4.E7.m1.3.3.1.1.cmml"><msub id="S4.E7.m1.3.3.1.1.3" xref="S4.E7.m1.3.3.1.1.3.cmml"><mi id="S4.E7.m1.3.3.1.1.3.2" mathvariant="normal" xref="S4.E7.m1.3.3.1.1.3.2.cmml">ℓ</mi><mrow id="S4.E7.m1.3.3.1.1.3.3" xref="S4.E7.m1.3.3.1.1.3.3.cmml"><mi id="S4.E7.m1.3.3.1.1.3.3.2" xref="S4.E7.m1.3.3.1.1.3.3.2.cmml">a</mi><mo id="S4.E7.m1.3.3.1.1.3.3.1" xref="S4.E7.m1.3.3.1.1.3.3.1.cmml">⁢</mo><mi id="S4.E7.m1.3.3.1.1.3.3.3" xref="S4.E7.m1.3.3.1.1.3.3.3.cmml">l</mi><mo id="S4.E7.m1.3.3.1.1.3.3.1a" xref="S4.E7.m1.3.3.1.1.3.3.1.cmml">⁢</mo><mi id="S4.E7.m1.3.3.1.1.3.3.4" xref="S4.E7.m1.3.3.1.1.3.3.4.cmml">i</mi><mo id="S4.E7.m1.3.3.1.1.3.3.1b" xref="S4.E7.m1.3.3.1.1.3.3.1.cmml">⁢</mo><mi id="S4.E7.m1.3.3.1.1.3.3.5" xref="S4.E7.m1.3.3.1.1.3.3.5.cmml">g</mi><mo id="S4.E7.m1.3.3.1.1.3.3.1c" xref="S4.E7.m1.3.3.1.1.3.3.1.cmml">⁢</mo><mi id="S4.E7.m1.3.3.1.1.3.3.6" xref="S4.E7.m1.3.3.1.1.3.3.6.cmml">n</mi></mrow></msub><mo id="S4.E7.m1.3.3.1.1.2" xref="S4.E7.m1.3.3.1.1.2.cmml">≜</mo><mrow id="S4.E7.m1.3.3.1.1.1" xref="S4.E7.m1.3.3.1.1.1.cmml"><msub id="S4.E7.m1.3.3.1.1.1.3" xref="S4.E7.m1.3.3.1.1.1.3.cmml"><mi id="S4.E7.m1.3.3.1.1.1.3.2" xref="S4.E7.m1.3.3.1.1.1.3.2.cmml">𝔼</mi><mrow id="S4.E7.m1.2.2.2" xref="S4.E7.m1.2.2.2.cmml"><mrow id="S4.E7.m1.2.2.2.2.2" xref="S4.E7.m1.2.2.2.2.3.cmml"><mo id="S4.E7.m1.2.2.2.2.2.3" stretchy="false" xref="S4.E7.m1.2.2.2.2.3.cmml">(</mo><mrow id="S4.E7.m1.1.1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.1.1.cmml"><mi id="S4.E7.m1.1.1.1.1.1.1.2" xref="S4.E7.m1.1.1.1.1.1.1.2.cmml">c</mi><mo id="S4.E7.m1.1.1.1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S4.E7.m1.1.1.1.1.1.1.3" xref="S4.E7.m1.1.1.1.1.1.1.3.cmml">h</mi></mrow><mo id="S4.E7.m1.2.2.2.2.2.4" xref="S4.E7.m1.2.2.2.2.3.cmml">,</mo><mrow id="S4.E7.m1.2.2.2.2.2.2" xref="S4.E7.m1.2.2.2.2.2.2.cmml"><mi id="S4.E7.m1.2.2.2.2.2.2.2" xref="S4.E7.m1.2.2.2.2.2.2.2.cmml">c</mi><mo id="S4.E7.m1.2.2.2.2.2.2.1" xref="S4.E7.m1.2.2.2.2.2.2.1.cmml">⁢</mo><msup id="S4.E7.m1.2.2.2.2.2.2.3" xref="S4.E7.m1.2.2.2.2.2.2.3.cmml"><mi id="S4.E7.m1.2.2.2.2.2.2.3.2" xref="S4.E7.m1.2.2.2.2.2.2.3.2.cmml">h</mi><mo id="S4.E7.m1.2.2.2.2.2.2.3.3" xref="S4.E7.m1.2.2.2.2.2.2.3.3.cmml">+</mo></msup></mrow><mo id="S4.E7.m1.2.2.2.2.2.5" stretchy="false" xref="S4.E7.m1.2.2.2.2.3.cmml">)</mo></mrow><mo id="S4.E7.m1.2.2.2.3" xref="S4.E7.m1.2.2.2.3.cmml">∼</mo><msub id="S4.E7.m1.2.2.2.4" xref="S4.E7.m1.2.2.2.4.cmml"><mi id="S4.E7.m1.2.2.2.4.2" xref="S4.E7.m1.2.2.2.4.2.cmml">p</mi><mrow id="S4.E7.m1.2.2.2.4.3" xref="S4.E7.m1.2.2.2.4.3.cmml"><mi id="S4.E7.m1.2.2.2.4.3.2" xref="S4.E7.m1.2.2.2.4.3.2.cmml">p</mi><mo id="S4.E7.m1.2.2.2.4.3.1" xref="S4.E7.m1.2.2.2.4.3.1.cmml">⁢</mo><mi id="S4.E7.m1.2.2.2.4.3.3" xref="S4.E7.m1.2.2.2.4.3.3.cmml">o</mi><mo id="S4.E7.m1.2.2.2.4.3.1a" xref="S4.E7.m1.2.2.2.4.3.1.cmml">⁢</mo><mi id="S4.E7.m1.2.2.2.4.3.4" xref="S4.E7.m1.2.2.2.4.3.4.cmml">s</mi></mrow></msub></mrow></msub><mo id="S4.E7.m1.3.3.1.1.1.2" xref="S4.E7.m1.3.3.1.1.1.2.cmml">⁢</mo><msup id="S4.E7.m1.3.3.1.1.1.1" xref="S4.E7.m1.3.3.1.1.1.1.cmml"><mrow id="S4.E7.m1.3.3.1.1.1.1.1.1" xref="S4.E7.m1.3.3.1.1.1.1.1.2.cmml"><mo id="S4.E7.m1.3.3.1.1.1.1.1.1.2" xref="S4.E7.m1.3.3.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S4.E7.m1.3.3.1.1.1.1.1.1.1" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.cmml"><mrow id="S4.E7.m1.3.3.1.1.1.1.1.1.1.1" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.3.cmml">f</mi><mo id="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml">c</mi><mo id="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml">h</mi></mrow><mo id="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E7.m1.3.3.1.1.1.1.1.1.1.3" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.3.cmml">−</mo><mrow id="S4.E7.m1.3.3.1.1.1.1.1.1.1.2" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E7.m1.3.3.1.1.1.1.1.1.1.2.3" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.2.3.cmml">f</mi><mo id="S4.E7.m1.3.3.1.1.1.1.1.1.1.2.2" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.2.2.cmml">⁢</mo><mrow id="S4.E7.m1.3.3.1.1.1.1.1.1.1.2.1.1" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.cmml"><mo id="S4.E7.m1.3.3.1.1.1.1.1.1.1.2.1.1.2" stretchy="false" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.cmml">(</mo><mrow id="S4.E7.m1.3.3.1.1.1.1.1.1.1.2.1.1.1" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.cmml"><mi id="S4.E7.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.2" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.2.cmml">c</mi><mo id="S4.E7.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.1" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.1.cmml">⁢</mo><msup id="S4.E7.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.3" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.3.cmml"><mi id="S4.E7.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.3.2" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.3.2.cmml">h</mi><mo id="S4.E7.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.3.3" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.3.3.cmml">+</mo></msup></mrow><mo id="S4.E7.m1.3.3.1.1.1.1.1.1.1.2.1.1.3" stretchy="false" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E7.m1.3.3.1.1.1.1.1.1.3" xref="S4.E7.m1.3.3.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S4.E7.m1.3.3.1.1.1.1.3" xref="S4.E7.m1.3.3.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow><mo id="S4.E7.m1.3.3.1.2" xref="S4.E7.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E7.m1.3b"><apply id="S4.E7.m1.3.3.1.1.cmml" xref="S4.E7.m1.3.3.1"><ci id="S4.E7.m1.3.3.1.1.2.cmml" xref="S4.E7.m1.3.3.1.1.2">≜</ci><apply id="S4.E7.m1.3.3.1.1.3.cmml" xref="S4.E7.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.1.1.3.1.cmml" xref="S4.E7.m1.3.3.1.1.3">subscript</csymbol><ci id="S4.E7.m1.3.3.1.1.3.2.cmml" xref="S4.E7.m1.3.3.1.1.3.2">ℓ</ci><apply id="S4.E7.m1.3.3.1.1.3.3.cmml" xref="S4.E7.m1.3.3.1.1.3.3"><times id="S4.E7.m1.3.3.1.1.3.3.1.cmml" xref="S4.E7.m1.3.3.1.1.3.3.1"></times><ci id="S4.E7.m1.3.3.1.1.3.3.2.cmml" xref="S4.E7.m1.3.3.1.1.3.3.2">𝑎</ci><ci id="S4.E7.m1.3.3.1.1.3.3.3.cmml" xref="S4.E7.m1.3.3.1.1.3.3.3">𝑙</ci><ci id="S4.E7.m1.3.3.1.1.3.3.4.cmml" xref="S4.E7.m1.3.3.1.1.3.3.4">𝑖</ci><ci id="S4.E7.m1.3.3.1.1.3.3.5.cmml" xref="S4.E7.m1.3.3.1.1.3.3.5">𝑔</ci><ci id="S4.E7.m1.3.3.1.1.3.3.6.cmml" xref="S4.E7.m1.3.3.1.1.3.3.6">𝑛</ci></apply></apply><apply id="S4.E7.m1.3.3.1.1.1.cmml" xref="S4.E7.m1.3.3.1.1.1"><times id="S4.E7.m1.3.3.1.1.1.2.cmml" xref="S4.E7.m1.3.3.1.1.1.2"></times><apply id="S4.E7.m1.3.3.1.1.1.3.cmml" xref="S4.E7.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.1.1.1.3.1.cmml" xref="S4.E7.m1.3.3.1.1.1.3">subscript</csymbol><ci id="S4.E7.m1.3.3.1.1.1.3.2.cmml" xref="S4.E7.m1.3.3.1.1.1.3.2">𝔼</ci><apply id="S4.E7.m1.2.2.2.cmml" xref="S4.E7.m1.2.2.2"><csymbol cd="latexml" id="S4.E7.m1.2.2.2.3.cmml" xref="S4.E7.m1.2.2.2.3">similar-to</csymbol><interval closure="open" id="S4.E7.m1.2.2.2.2.3.cmml" xref="S4.E7.m1.2.2.2.2.2"><apply id="S4.E7.m1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.1.1.1.1.1.1"><times id="S4.E7.m1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1"></times><ci id="S4.E7.m1.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.1.1.1.1.1.1.2">𝑐</ci><ci id="S4.E7.m1.1.1.1.1.1.1.3.cmml" xref="S4.E7.m1.1.1.1.1.1.1.3">ℎ</ci></apply><apply id="S4.E7.m1.2.2.2.2.2.2.cmml" xref="S4.E7.m1.2.2.2.2.2.2"><times id="S4.E7.m1.2.2.2.2.2.2.1.cmml" xref="S4.E7.m1.2.2.2.2.2.2.1"></times><ci id="S4.E7.m1.2.2.2.2.2.2.2.cmml" xref="S4.E7.m1.2.2.2.2.2.2.2">𝑐</ci><apply id="S4.E7.m1.2.2.2.2.2.2.3.cmml" xref="S4.E7.m1.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.E7.m1.2.2.2.2.2.2.3.1.cmml" xref="S4.E7.m1.2.2.2.2.2.2.3">superscript</csymbol><ci id="S4.E7.m1.2.2.2.2.2.2.3.2.cmml" xref="S4.E7.m1.2.2.2.2.2.2.3.2">ℎ</ci><plus id="S4.E7.m1.2.2.2.2.2.2.3.3.cmml" xref="S4.E7.m1.2.2.2.2.2.2.3.3"></plus></apply></apply></interval><apply id="S4.E7.m1.2.2.2.4.cmml" xref="S4.E7.m1.2.2.2.4"><csymbol cd="ambiguous" id="S4.E7.m1.2.2.2.4.1.cmml" xref="S4.E7.m1.2.2.2.4">subscript</csymbol><ci id="S4.E7.m1.2.2.2.4.2.cmml" xref="S4.E7.m1.2.2.2.4.2">𝑝</ci><apply id="S4.E7.m1.2.2.2.4.3.cmml" xref="S4.E7.m1.2.2.2.4.3"><times id="S4.E7.m1.2.2.2.4.3.1.cmml" xref="S4.E7.m1.2.2.2.4.3.1"></times><ci id="S4.E7.m1.2.2.2.4.3.2.cmml" xref="S4.E7.m1.2.2.2.4.3.2">𝑝</ci><ci id="S4.E7.m1.2.2.2.4.3.3.cmml" xref="S4.E7.m1.2.2.2.4.3.3">𝑜</ci><ci id="S4.E7.m1.2.2.2.4.3.4.cmml" xref="S4.E7.m1.2.2.2.4.3.4">𝑠</ci></apply></apply></apply></apply><apply id="S4.E7.m1.3.3.1.1.1.1.cmml" xref="S4.E7.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.1.1.1.1.2.cmml" xref="S4.E7.m1.3.3.1.1.1.1">superscript</csymbol><apply id="S4.E7.m1.3.3.1.1.1.1.1.2.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E7.m1.3.3.1.1.1.1.1.2.1.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.1.2">norm</csymbol><apply id="S4.E7.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1"><minus id="S4.E7.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.3"></minus><apply id="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.1"><times id="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.2"></times><ci id="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.3">𝑓</ci><apply id="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1"><times id="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1"></times><ci id="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2">𝑐</ci><ci id="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3">ℎ</ci></apply></apply><apply id="S4.E7.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.2"><times id="S4.E7.m1.3.3.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.2.2"></times><ci id="S4.E7.m1.3.3.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.2.3">𝑓</ci><apply id="S4.E7.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.2.1.1"><times id="S4.E7.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.1"></times><ci id="S4.E7.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.2">𝑐</ci><apply id="S4.E7.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.3.1.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.3">superscript</csymbol><ci id="S4.E7.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.3.2.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.3.2">ℎ</ci><plus id="S4.E7.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.3.3.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.2.1.1.1.3.3"></plus></apply></apply></apply></apply></apply><cn id="S4.E7.m1.3.3.1.1.1.1.3.cmml" type="integer" xref="S4.E7.m1.3.3.1.1.1.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7.m1.3c">\ell_{align}\triangleq\mathbb{E}_{(ch,ch^{+})\sim p_{pos}}\left\|f(ch)-f(ch^{+%
})\right\|^{2},</annotation><annotation encoding="application/x-llamapun" id="S4.E7.m1.3d">roman_ℓ start_POSTSUBSCRIPT italic_a italic_l italic_i italic_g italic_n end_POSTSUBSCRIPT ≜ blackboard_E start_POSTSUBSCRIPT ( italic_c italic_h , italic_c italic_h start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT ) ∼ italic_p start_POSTSUBSCRIPT italic_p italic_o italic_s end_POSTSUBSCRIPT end_POSTSUBSCRIPT ∥ italic_f ( italic_c italic_h ) - italic_f ( italic_c italic_h start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT ) ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.SSS0.Px2.p3">
<p class="ltx_p" id="S4.SS2.SSS0.Px2.p3.5">On the other hand, uniformity assesses how evenly the embeddings are distributed across the embedding space. It is calculated using the expression:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\ell_{uniform}\triangleq\log\mathbb{E}_{ch_{x},ch_{y}\overset{\text{i.i.d.}}{%
\sim}p_{data}}e^{-2\|f(ch_{x})-f(ch_{y})\|^{2}},\vspace{-1mm}" class="ltx_Math" display="block" id="S4.E8.m1.4"><semantics id="S4.E8.m1.4a"><mrow id="S4.E8.m1.4.4.1" xref="S4.E8.m1.4.4.1.1.cmml"><mrow id="S4.E8.m1.4.4.1.1" xref="S4.E8.m1.4.4.1.1.cmml"><msub id="S4.E8.m1.4.4.1.1.2" xref="S4.E8.m1.4.4.1.1.2.cmml"><mi id="S4.E8.m1.4.4.1.1.2.2" mathvariant="normal" xref="S4.E8.m1.4.4.1.1.2.2.cmml">ℓ</mi><mrow id="S4.E8.m1.4.4.1.1.2.3" xref="S4.E8.m1.4.4.1.1.2.3.cmml"><mi id="S4.E8.m1.4.4.1.1.2.3.2" xref="S4.E8.m1.4.4.1.1.2.3.2.cmml">u</mi><mo id="S4.E8.m1.4.4.1.1.2.3.1" xref="S4.E8.m1.4.4.1.1.2.3.1.cmml">⁢</mo><mi id="S4.E8.m1.4.4.1.1.2.3.3" xref="S4.E8.m1.4.4.1.1.2.3.3.cmml">n</mi><mo id="S4.E8.m1.4.4.1.1.2.3.1a" xref="S4.E8.m1.4.4.1.1.2.3.1.cmml">⁢</mo><mi id="S4.E8.m1.4.4.1.1.2.3.4" xref="S4.E8.m1.4.4.1.1.2.3.4.cmml">i</mi><mo id="S4.E8.m1.4.4.1.1.2.3.1b" xref="S4.E8.m1.4.4.1.1.2.3.1.cmml">⁢</mo><mi id="S4.E8.m1.4.4.1.1.2.3.5" xref="S4.E8.m1.4.4.1.1.2.3.5.cmml">f</mi><mo id="S4.E8.m1.4.4.1.1.2.3.1c" xref="S4.E8.m1.4.4.1.1.2.3.1.cmml">⁢</mo><mi id="S4.E8.m1.4.4.1.1.2.3.6" xref="S4.E8.m1.4.4.1.1.2.3.6.cmml">o</mi><mo id="S4.E8.m1.4.4.1.1.2.3.1d" xref="S4.E8.m1.4.4.1.1.2.3.1.cmml">⁢</mo><mi id="S4.E8.m1.4.4.1.1.2.3.7" xref="S4.E8.m1.4.4.1.1.2.3.7.cmml">r</mi><mo id="S4.E8.m1.4.4.1.1.2.3.1e" xref="S4.E8.m1.4.4.1.1.2.3.1.cmml">⁢</mo><mi id="S4.E8.m1.4.4.1.1.2.3.8" xref="S4.E8.m1.4.4.1.1.2.3.8.cmml">m</mi></mrow></msub><mo id="S4.E8.m1.4.4.1.1.1" xref="S4.E8.m1.4.4.1.1.1.cmml">≜</mo><mrow id="S4.E8.m1.4.4.1.1.3" xref="S4.E8.m1.4.4.1.1.3.cmml"><mi id="S4.E8.m1.4.4.1.1.3.1" xref="S4.E8.m1.4.4.1.1.3.1.cmml">log</mi><mo id="S4.E8.m1.4.4.1.1.3a" lspace="0.167em" xref="S4.E8.m1.4.4.1.1.3.cmml">⁡</mo><mrow id="S4.E8.m1.4.4.1.1.3.2" xref="S4.E8.m1.4.4.1.1.3.2.cmml"><msub id="S4.E8.m1.4.4.1.1.3.2.2" xref="S4.E8.m1.4.4.1.1.3.2.2.cmml"><mi id="S4.E8.m1.4.4.1.1.3.2.2.2" xref="S4.E8.m1.4.4.1.1.3.2.2.2.cmml">𝔼</mi><mrow id="S4.E8.m1.2.2.2.2" xref="S4.E8.m1.2.2.2.3.cmml"><mrow id="S4.E8.m1.1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.1.cmml"><mi id="S4.E8.m1.1.1.1.1.1.2" xref="S4.E8.m1.1.1.1.1.1.2.cmml">c</mi><mo id="S4.E8.m1.1.1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.1.1.cmml">⁢</mo><msub id="S4.E8.m1.1.1.1.1.1.3" xref="S4.E8.m1.1.1.1.1.1.3.cmml"><mi id="S4.E8.m1.1.1.1.1.1.3.2" xref="S4.E8.m1.1.1.1.1.1.3.2.cmml">h</mi><mi id="S4.E8.m1.1.1.1.1.1.3.3" xref="S4.E8.m1.1.1.1.1.1.3.3.cmml">x</mi></msub></mrow><mo id="S4.E8.m1.2.2.2.2.3" xref="S4.E8.m1.2.2.2.3.cmml">,</mo><mrow id="S4.E8.m1.2.2.2.2.2" xref="S4.E8.m1.2.2.2.2.2.cmml"><mi id="S4.E8.m1.2.2.2.2.2.2" xref="S4.E8.m1.2.2.2.2.2.2.cmml">c</mi><mo id="S4.E8.m1.2.2.2.2.2.1" xref="S4.E8.m1.2.2.2.2.2.1.cmml">⁢</mo><msub id="S4.E8.m1.2.2.2.2.2.3" xref="S4.E8.m1.2.2.2.2.2.3.cmml"><mi id="S4.E8.m1.2.2.2.2.2.3.2" xref="S4.E8.m1.2.2.2.2.2.3.2.cmml">h</mi><mi id="S4.E8.m1.2.2.2.2.2.3.3" xref="S4.E8.m1.2.2.2.2.2.3.3.cmml">y</mi></msub><mo id="S4.E8.m1.2.2.2.2.2.1a" xref="S4.E8.m1.2.2.2.2.2.1.cmml">⁢</mo><mover accent="true" id="S4.E8.m1.2.2.2.2.2.4" xref="S4.E8.m1.2.2.2.2.2.4.cmml"><mo id="S4.E8.m1.2.2.2.2.2.4.2" xref="S4.E8.m1.2.2.2.2.2.4.2.cmml">∼</mo><mtext id="S4.E8.m1.2.2.2.2.2.4.1" xref="S4.E8.m1.2.2.2.2.2.4.1a.cmml">i.i.d.</mtext></mover><mo id="S4.E8.m1.2.2.2.2.2.1b" xref="S4.E8.m1.2.2.2.2.2.1.cmml">⁢</mo><msub id="S4.E8.m1.2.2.2.2.2.5" xref="S4.E8.m1.2.2.2.2.2.5.cmml"><mi id="S4.E8.m1.2.2.2.2.2.5.2" xref="S4.E8.m1.2.2.2.2.2.5.2.cmml">p</mi><mrow id="S4.E8.m1.2.2.2.2.2.5.3" xref="S4.E8.m1.2.2.2.2.2.5.3.cmml"><mi id="S4.E8.m1.2.2.2.2.2.5.3.2" xref="S4.E8.m1.2.2.2.2.2.5.3.2.cmml">d</mi><mo id="S4.E8.m1.2.2.2.2.2.5.3.1" xref="S4.E8.m1.2.2.2.2.2.5.3.1.cmml">⁢</mo><mi id="S4.E8.m1.2.2.2.2.2.5.3.3" xref="S4.E8.m1.2.2.2.2.2.5.3.3.cmml">a</mi><mo id="S4.E8.m1.2.2.2.2.2.5.3.1a" xref="S4.E8.m1.2.2.2.2.2.5.3.1.cmml">⁢</mo><mi id="S4.E8.m1.2.2.2.2.2.5.3.4" xref="S4.E8.m1.2.2.2.2.2.5.3.4.cmml">t</mi><mo id="S4.E8.m1.2.2.2.2.2.5.3.1b" xref="S4.E8.m1.2.2.2.2.2.5.3.1.cmml">⁢</mo><mi id="S4.E8.m1.2.2.2.2.2.5.3.5" xref="S4.E8.m1.2.2.2.2.2.5.3.5.cmml">a</mi></mrow></msub></mrow></mrow></msub><mo id="S4.E8.m1.4.4.1.1.3.2.1" xref="S4.E8.m1.4.4.1.1.3.2.1.cmml">⁢</mo><msup id="S4.E8.m1.4.4.1.1.3.2.3" xref="S4.E8.m1.4.4.1.1.3.2.3.cmml"><mi id="S4.E8.m1.4.4.1.1.3.2.3.2" xref="S4.E8.m1.4.4.1.1.3.2.3.2.cmml">e</mi><mrow id="S4.E8.m1.3.3.1" xref="S4.E8.m1.3.3.1.cmml"><mo id="S4.E8.m1.3.3.1a" xref="S4.E8.m1.3.3.1.cmml">−</mo><mrow id="S4.E8.m1.3.3.1.1" xref="S4.E8.m1.3.3.1.1.cmml"><mn id="S4.E8.m1.3.3.1.1.3" xref="S4.E8.m1.3.3.1.1.3.cmml">2</mn><mo id="S4.E8.m1.3.3.1.1.2" xref="S4.E8.m1.3.3.1.1.2.cmml">⁢</mo><msup id="S4.E8.m1.3.3.1.1.1" xref="S4.E8.m1.3.3.1.1.1.cmml"><mrow id="S4.E8.m1.3.3.1.1.1.1.1" xref="S4.E8.m1.3.3.1.1.1.1.2.cmml"><mo id="S4.E8.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="S4.E8.m1.3.3.1.1.1.1.2.1.cmml">‖</mo><mrow id="S4.E8.m1.3.3.1.1.1.1.1.1" xref="S4.E8.m1.3.3.1.1.1.1.1.1.cmml"><mrow id="S4.E8.m1.3.3.1.1.1.1.1.1.1" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.cmml"><mi id="S4.E8.m1.3.3.1.1.1.1.1.1.1.3" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.3.cmml">f</mi><mo id="S4.E8.m1.3.3.1.1.1.1.1.1.1.2" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml">c</mi><mo id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.cmml">h</mi><mi id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3.cmml">x</mi></msub></mrow><mo id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E8.m1.3.3.1.1.1.1.1.1.3" xref="S4.E8.m1.3.3.1.1.1.1.1.1.3.cmml">−</mo><mrow id="S4.E8.m1.3.3.1.1.1.1.1.1.2" xref="S4.E8.m1.3.3.1.1.1.1.1.1.2.cmml"><mi id="S4.E8.m1.3.3.1.1.1.1.1.1.2.3" xref="S4.E8.m1.3.3.1.1.1.1.1.1.2.3.cmml">f</mi><mo id="S4.E8.m1.3.3.1.1.1.1.1.1.2.2" xref="S4.E8.m1.3.3.1.1.1.1.1.1.2.2.cmml">⁢</mo><mrow id="S4.E8.m1.3.3.1.1.1.1.1.1.2.1.1" xref="S4.E8.m1.3.3.1.1.1.1.1.1.2.1.1.1.cmml"><mo id="S4.E8.m1.3.3.1.1.1.1.1.1.2.1.1.2" stretchy="false" xref="S4.E8.m1.3.3.1.1.1.1.1.1.2.1.1.1.cmml">(</mo><mrow id="S4.E8.m1.3.3.1.1.1.1.1.1.2.1.1.1" xref="S4.E8.m1.3.3.1.1.1.1.1.1.2.1.1.1.cmml"><mi id="S4.E8.m1.3.3.1.1.1.1.1.1.2.1.1.1.2" xref="S4.E8.m1.3.3.1.1.1.1.1.1.2.1.1.1.2.cmml">c</mi><mo id="S4.E8.m1.3.3.1.1.1.1.1.1.2.1.1.1.1" xref="S4.E8.m1.3.3.1.1.1.1.1.1.2.1.1.1.1.cmml">⁢</mo><msub id="S4.E8.m1.3.3.1.1.1.1.1.1.2.1.1.1.3" xref="S4.E8.m1.3.3.1.1.1.1.1.1.2.1.1.1.3.cmml"><mi id="S4.E8.m1.3.3.1.1.1.1.1.1.2.1.1.1.3.2" xref="S4.E8.m1.3.3.1.1.1.1.1.1.2.1.1.1.3.2.cmml">h</mi><mi id="S4.E8.m1.3.3.1.1.1.1.1.1.2.1.1.1.3.3" xref="S4.E8.m1.3.3.1.1.1.1.1.1.2.1.1.1.3.3.cmml">y</mi></msub></mrow><mo id="S4.E8.m1.3.3.1.1.1.1.1.1.2.1.1.3" stretchy="false" xref="S4.E8.m1.3.3.1.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E8.m1.3.3.1.1.1.1.1.3" stretchy="false" xref="S4.E8.m1.3.3.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S4.E8.m1.3.3.1.1.1.3" xref="S4.E8.m1.3.3.1.1.1.3.cmml">2</mn></msup></mrow></mrow></msup></mrow></mrow></mrow><mo id="S4.E8.m1.4.4.1.2" xref="S4.E8.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E8.m1.4b"><apply id="S4.E8.m1.4.4.1.1.cmml" xref="S4.E8.m1.4.4.1"><ci id="S4.E8.m1.4.4.1.1.1.cmml" xref="S4.E8.m1.4.4.1.1.1">≜</ci><apply id="S4.E8.m1.4.4.1.1.2.cmml" xref="S4.E8.m1.4.4.1.1.2"><csymbol cd="ambiguous" id="S4.E8.m1.4.4.1.1.2.1.cmml" xref="S4.E8.m1.4.4.1.1.2">subscript</csymbol><ci id="S4.E8.m1.4.4.1.1.2.2.cmml" xref="S4.E8.m1.4.4.1.1.2.2">ℓ</ci><apply id="S4.E8.m1.4.4.1.1.2.3.cmml" xref="S4.E8.m1.4.4.1.1.2.3"><times id="S4.E8.m1.4.4.1.1.2.3.1.cmml" xref="S4.E8.m1.4.4.1.1.2.3.1"></times><ci id="S4.E8.m1.4.4.1.1.2.3.2.cmml" xref="S4.E8.m1.4.4.1.1.2.3.2">𝑢</ci><ci id="S4.E8.m1.4.4.1.1.2.3.3.cmml" xref="S4.E8.m1.4.4.1.1.2.3.3">𝑛</ci><ci id="S4.E8.m1.4.4.1.1.2.3.4.cmml" xref="S4.E8.m1.4.4.1.1.2.3.4">𝑖</ci><ci id="S4.E8.m1.4.4.1.1.2.3.5.cmml" xref="S4.E8.m1.4.4.1.1.2.3.5">𝑓</ci><ci id="S4.E8.m1.4.4.1.1.2.3.6.cmml" xref="S4.E8.m1.4.4.1.1.2.3.6">𝑜</ci><ci id="S4.E8.m1.4.4.1.1.2.3.7.cmml" xref="S4.E8.m1.4.4.1.1.2.3.7">𝑟</ci><ci id="S4.E8.m1.4.4.1.1.2.3.8.cmml" xref="S4.E8.m1.4.4.1.1.2.3.8">𝑚</ci></apply></apply><apply id="S4.E8.m1.4.4.1.1.3.cmml" xref="S4.E8.m1.4.4.1.1.3"><log id="S4.E8.m1.4.4.1.1.3.1.cmml" xref="S4.E8.m1.4.4.1.1.3.1"></log><apply id="S4.E8.m1.4.4.1.1.3.2.cmml" xref="S4.E8.m1.4.4.1.1.3.2"><times id="S4.E8.m1.4.4.1.1.3.2.1.cmml" xref="S4.E8.m1.4.4.1.1.3.2.1"></times><apply id="S4.E8.m1.4.4.1.1.3.2.2.cmml" xref="S4.E8.m1.4.4.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.E8.m1.4.4.1.1.3.2.2.1.cmml" xref="S4.E8.m1.4.4.1.1.3.2.2">subscript</csymbol><ci id="S4.E8.m1.4.4.1.1.3.2.2.2.cmml" xref="S4.E8.m1.4.4.1.1.3.2.2.2">𝔼</ci><list id="S4.E8.m1.2.2.2.3.cmml" xref="S4.E8.m1.2.2.2.2"><apply id="S4.E8.m1.1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1.1"><times id="S4.E8.m1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1.1.1"></times><ci id="S4.E8.m1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.1.1.1.1.1.2">𝑐</ci><apply id="S4.E8.m1.1.1.1.1.1.3.cmml" xref="S4.E8.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.1.1.3.1.cmml" xref="S4.E8.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E8.m1.1.1.1.1.1.3.2.cmml" xref="S4.E8.m1.1.1.1.1.1.3.2">ℎ</ci><ci id="S4.E8.m1.1.1.1.1.1.3.3.cmml" xref="S4.E8.m1.1.1.1.1.1.3.3">𝑥</ci></apply></apply><apply id="S4.E8.m1.2.2.2.2.2.cmml" xref="S4.E8.m1.2.2.2.2.2"><times id="S4.E8.m1.2.2.2.2.2.1.cmml" xref="S4.E8.m1.2.2.2.2.2.1"></times><ci id="S4.E8.m1.2.2.2.2.2.2.cmml" xref="S4.E8.m1.2.2.2.2.2.2">𝑐</ci><apply id="S4.E8.m1.2.2.2.2.2.3.cmml" xref="S4.E8.m1.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.E8.m1.2.2.2.2.2.3.1.cmml" xref="S4.E8.m1.2.2.2.2.2.3">subscript</csymbol><ci id="S4.E8.m1.2.2.2.2.2.3.2.cmml" xref="S4.E8.m1.2.2.2.2.2.3.2">ℎ</ci><ci id="S4.E8.m1.2.2.2.2.2.3.3.cmml" xref="S4.E8.m1.2.2.2.2.2.3.3">𝑦</ci></apply><apply id="S4.E8.m1.2.2.2.2.2.4.cmml" xref="S4.E8.m1.2.2.2.2.2.4"><ci id="S4.E8.m1.2.2.2.2.2.4.1a.cmml" xref="S4.E8.m1.2.2.2.2.2.4.1"><mtext id="S4.E8.m1.2.2.2.2.2.4.1.cmml" mathsize="70%" xref="S4.E8.m1.2.2.2.2.2.4.1">i.i.d.</mtext></ci><csymbol cd="latexml" id="S4.E8.m1.2.2.2.2.2.4.2.cmml" xref="S4.E8.m1.2.2.2.2.2.4.2">similar-to</csymbol></apply><apply id="S4.E8.m1.2.2.2.2.2.5.cmml" xref="S4.E8.m1.2.2.2.2.2.5"><csymbol cd="ambiguous" id="S4.E8.m1.2.2.2.2.2.5.1.cmml" xref="S4.E8.m1.2.2.2.2.2.5">subscript</csymbol><ci id="S4.E8.m1.2.2.2.2.2.5.2.cmml" xref="S4.E8.m1.2.2.2.2.2.5.2">𝑝</ci><apply id="S4.E8.m1.2.2.2.2.2.5.3.cmml" xref="S4.E8.m1.2.2.2.2.2.5.3"><times id="S4.E8.m1.2.2.2.2.2.5.3.1.cmml" xref="S4.E8.m1.2.2.2.2.2.5.3.1"></times><ci id="S4.E8.m1.2.2.2.2.2.5.3.2.cmml" xref="S4.E8.m1.2.2.2.2.2.5.3.2">𝑑</ci><ci id="S4.E8.m1.2.2.2.2.2.5.3.3.cmml" xref="S4.E8.m1.2.2.2.2.2.5.3.3">𝑎</ci><ci id="S4.E8.m1.2.2.2.2.2.5.3.4.cmml" xref="S4.E8.m1.2.2.2.2.2.5.3.4">𝑡</ci><ci id="S4.E8.m1.2.2.2.2.2.5.3.5.cmml" xref="S4.E8.m1.2.2.2.2.2.5.3.5">𝑎</ci></apply></apply></apply></list></apply><apply id="S4.E8.m1.4.4.1.1.3.2.3.cmml" xref="S4.E8.m1.4.4.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.E8.m1.4.4.1.1.3.2.3.1.cmml" xref="S4.E8.m1.4.4.1.1.3.2.3">superscript</csymbol><ci id="S4.E8.m1.4.4.1.1.3.2.3.2.cmml" xref="S4.E8.m1.4.4.1.1.3.2.3.2">𝑒</ci><apply id="S4.E8.m1.3.3.1.cmml" xref="S4.E8.m1.3.3.1"><minus id="S4.E8.m1.3.3.1.2.cmml" xref="S4.E8.m1.3.3.1"></minus><apply id="S4.E8.m1.3.3.1.1.cmml" xref="S4.E8.m1.3.3.1.1"><times id="S4.E8.m1.3.3.1.1.2.cmml" xref="S4.E8.m1.3.3.1.1.2"></times><cn id="S4.E8.m1.3.3.1.1.3.cmml" type="integer" xref="S4.E8.m1.3.3.1.1.3">2</cn><apply id="S4.E8.m1.3.3.1.1.1.cmml" xref="S4.E8.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.3.3.1.1.1.2.cmml" xref="S4.E8.m1.3.3.1.1.1">superscript</csymbol><apply id="S4.E8.m1.3.3.1.1.1.1.2.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1"><csymbol cd="latexml" id="S4.E8.m1.3.3.1.1.1.1.2.1.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.2">norm</csymbol><apply id="S4.E8.m1.3.3.1.1.1.1.1.1.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1"><minus id="S4.E8.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.3"></minus><apply id="S4.E8.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1"><times id="S4.E8.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.2"></times><ci id="S4.E8.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.3">𝑓</ci><apply id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1"><times id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.1"></times><ci id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.2">𝑐</ci><apply id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2">ℎ</ci><ci id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3">𝑥</ci></apply></apply></apply><apply id="S4.E8.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.2"><times id="S4.E8.m1.3.3.1.1.1.1.1.1.2.2.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.2.2"></times><ci id="S4.E8.m1.3.3.1.1.1.1.1.1.2.3.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.2.3">𝑓</ci><apply id="S4.E8.m1.3.3.1.1.1.1.1.1.2.1.1.1.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.2.1.1"><times id="S4.E8.m1.3.3.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.2.1.1.1.1"></times><ci id="S4.E8.m1.3.3.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.2.1.1.1.2">𝑐</ci><apply id="S4.E8.m1.3.3.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.E8.m1.3.3.1.1.1.1.1.1.2.1.1.1.3.1.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.2.1.1.1.3">subscript</csymbol><ci id="S4.E8.m1.3.3.1.1.1.1.1.1.2.1.1.1.3.2.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.2.1.1.1.3.2">ℎ</ci><ci id="S4.E8.m1.3.3.1.1.1.1.1.1.2.1.1.1.3.3.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.2.1.1.1.3.3">𝑦</ci></apply></apply></apply></apply></apply><cn id="S4.E8.m1.3.3.1.1.1.3.cmml" type="integer" xref="S4.E8.m1.3.3.1.1.1.3">2</cn></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8.m1.4c">\ell_{uniform}\triangleq\log\mathbb{E}_{ch_{x},ch_{y}\overset{\text{i.i.d.}}{%
\sim}p_{data}}e^{-2\|f(ch_{x})-f(ch_{y})\|^{2}},\vspace{-1mm}</annotation><annotation encoding="application/x-llamapun" id="S4.E8.m1.4d">roman_ℓ start_POSTSUBSCRIPT italic_u italic_n italic_i italic_f italic_o italic_r italic_m end_POSTSUBSCRIPT ≜ roman_log blackboard_E start_POSTSUBSCRIPT italic_c italic_h start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT , italic_c italic_h start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT overi.i.d. start_ARG ∼ end_ARG italic_p start_POSTSUBSCRIPT italic_d italic_a italic_t italic_a end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_e start_POSTSUPERSCRIPT - 2 ∥ italic_f ( italic_c italic_h start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT ) - italic_f ( italic_c italic_h start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT ) ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.SSS0.Px2.p3.4">where <math alttext="p_{pos}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px2.p3.1.m1.1"><semantics id="S4.SS2.SSS0.Px2.p3.1.m1.1a"><msub id="S4.SS2.SSS0.Px2.p3.1.m1.1.1" xref="S4.SS2.SSS0.Px2.p3.1.m1.1.1.cmml"><mi id="S4.SS2.SSS0.Px2.p3.1.m1.1.1.2" xref="S4.SS2.SSS0.Px2.p3.1.m1.1.1.2.cmml">p</mi><mrow id="S4.SS2.SSS0.Px2.p3.1.m1.1.1.3" xref="S4.SS2.SSS0.Px2.p3.1.m1.1.1.3.cmml"><mi id="S4.SS2.SSS0.Px2.p3.1.m1.1.1.3.2" xref="S4.SS2.SSS0.Px2.p3.1.m1.1.1.3.2.cmml">p</mi><mo id="S4.SS2.SSS0.Px2.p3.1.m1.1.1.3.1" xref="S4.SS2.SSS0.Px2.p3.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px2.p3.1.m1.1.1.3.3" xref="S4.SS2.SSS0.Px2.p3.1.m1.1.1.3.3.cmml">o</mi><mo id="S4.SS2.SSS0.Px2.p3.1.m1.1.1.3.1a" xref="S4.SS2.SSS0.Px2.p3.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px2.p3.1.m1.1.1.3.4" xref="S4.SS2.SSS0.Px2.p3.1.m1.1.1.3.4.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px2.p3.1.m1.1b"><apply id="S4.SS2.SSS0.Px2.p3.1.m1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p3.1.m1.1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p3.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.SSS0.Px2.p3.1.m1.1.1.2.cmml" xref="S4.SS2.SSS0.Px2.p3.1.m1.1.1.2">𝑝</ci><apply id="S4.SS2.SSS0.Px2.p3.1.m1.1.1.3.cmml" xref="S4.SS2.SSS0.Px2.p3.1.m1.1.1.3"><times id="S4.SS2.SSS0.Px2.p3.1.m1.1.1.3.1.cmml" xref="S4.SS2.SSS0.Px2.p3.1.m1.1.1.3.1"></times><ci id="S4.SS2.SSS0.Px2.p3.1.m1.1.1.3.2.cmml" xref="S4.SS2.SSS0.Px2.p3.1.m1.1.1.3.2">𝑝</ci><ci id="S4.SS2.SSS0.Px2.p3.1.m1.1.1.3.3.cmml" xref="S4.SS2.SSS0.Px2.p3.1.m1.1.1.3.3">𝑜</ci><ci id="S4.SS2.SSS0.Px2.p3.1.m1.1.1.3.4.cmml" xref="S4.SS2.SSS0.Px2.p3.1.m1.1.1.3.4">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px2.p3.1.m1.1c">p_{pos}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px2.p3.1.m1.1d">italic_p start_POSTSUBSCRIPT italic_p italic_o italic_s end_POSTSUBSCRIPT</annotation></semantics></math> represents positive pairs (similar chunks), and <math alttext="p_{data}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px2.p3.2.m2.1"><semantics id="S4.SS2.SSS0.Px2.p3.2.m2.1a"><msub id="S4.SS2.SSS0.Px2.p3.2.m2.1.1" xref="S4.SS2.SSS0.Px2.p3.2.m2.1.1.cmml"><mi id="S4.SS2.SSS0.Px2.p3.2.m2.1.1.2" xref="S4.SS2.SSS0.Px2.p3.2.m2.1.1.2.cmml">p</mi><mrow id="S4.SS2.SSS0.Px2.p3.2.m2.1.1.3" xref="S4.SS2.SSS0.Px2.p3.2.m2.1.1.3.cmml"><mi id="S4.SS2.SSS0.Px2.p3.2.m2.1.1.3.2" xref="S4.SS2.SSS0.Px2.p3.2.m2.1.1.3.2.cmml">d</mi><mo id="S4.SS2.SSS0.Px2.p3.2.m2.1.1.3.1" xref="S4.SS2.SSS0.Px2.p3.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px2.p3.2.m2.1.1.3.3" xref="S4.SS2.SSS0.Px2.p3.2.m2.1.1.3.3.cmml">a</mi><mo id="S4.SS2.SSS0.Px2.p3.2.m2.1.1.3.1a" xref="S4.SS2.SSS0.Px2.p3.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px2.p3.2.m2.1.1.3.4" xref="S4.SS2.SSS0.Px2.p3.2.m2.1.1.3.4.cmml">t</mi><mo id="S4.SS2.SSS0.Px2.p3.2.m2.1.1.3.1b" xref="S4.SS2.SSS0.Px2.p3.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.SSS0.Px2.p3.2.m2.1.1.3.5" xref="S4.SS2.SSS0.Px2.p3.2.m2.1.1.3.5.cmml">a</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px2.p3.2.m2.1b"><apply id="S4.SS2.SSS0.Px2.p3.2.m2.1.1.cmml" xref="S4.SS2.SSS0.Px2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p3.2.m2.1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p3.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.SSS0.Px2.p3.2.m2.1.1.2.cmml" xref="S4.SS2.SSS0.Px2.p3.2.m2.1.1.2">𝑝</ci><apply id="S4.SS2.SSS0.Px2.p3.2.m2.1.1.3.cmml" xref="S4.SS2.SSS0.Px2.p3.2.m2.1.1.3"><times id="S4.SS2.SSS0.Px2.p3.2.m2.1.1.3.1.cmml" xref="S4.SS2.SSS0.Px2.p3.2.m2.1.1.3.1"></times><ci id="S4.SS2.SSS0.Px2.p3.2.m2.1.1.3.2.cmml" xref="S4.SS2.SSS0.Px2.p3.2.m2.1.1.3.2">𝑑</ci><ci id="S4.SS2.SSS0.Px2.p3.2.m2.1.1.3.3.cmml" xref="S4.SS2.SSS0.Px2.p3.2.m2.1.1.3.3">𝑎</ci><ci id="S4.SS2.SSS0.Px2.p3.2.m2.1.1.3.4.cmml" xref="S4.SS2.SSS0.Px2.p3.2.m2.1.1.3.4">𝑡</ci><ci id="S4.SS2.SSS0.Px2.p3.2.m2.1.1.3.5.cmml" xref="S4.SS2.SSS0.Px2.p3.2.m2.1.1.3.5">𝑎</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px2.p3.2.m2.1c">p_{data}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px2.p3.2.m2.1d">italic_p start_POSTSUBSCRIPT italic_d italic_a italic_t italic_a end_POSTSUBSCRIPT</annotation></semantics></math> refers to the distribution of data points from the dataset, with samples drawn independently. These measures align with the goals of contrastive learning, which aims to bring embeddings of similar chunks closer together while ensuring that embeddings of unrelated chunks <math alttext="ch_{x}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px2.p3.3.m3.1"><semantics id="S4.SS2.SSS0.Px2.p3.3.m3.1a"><mrow id="S4.SS2.SSS0.Px2.p3.3.m3.1.1" xref="S4.SS2.SSS0.Px2.p3.3.m3.1.1.cmml"><mi id="S4.SS2.SSS0.Px2.p3.3.m3.1.1.2" xref="S4.SS2.SSS0.Px2.p3.3.m3.1.1.2.cmml">c</mi><mo id="S4.SS2.SSS0.Px2.p3.3.m3.1.1.1" xref="S4.SS2.SSS0.Px2.p3.3.m3.1.1.1.cmml">⁢</mo><msub id="S4.SS2.SSS0.Px2.p3.3.m3.1.1.3" xref="S4.SS2.SSS0.Px2.p3.3.m3.1.1.3.cmml"><mi id="S4.SS2.SSS0.Px2.p3.3.m3.1.1.3.2" xref="S4.SS2.SSS0.Px2.p3.3.m3.1.1.3.2.cmml">h</mi><mi id="S4.SS2.SSS0.Px2.p3.3.m3.1.1.3.3" xref="S4.SS2.SSS0.Px2.p3.3.m3.1.1.3.3.cmml">x</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px2.p3.3.m3.1b"><apply id="S4.SS2.SSS0.Px2.p3.3.m3.1.1.cmml" xref="S4.SS2.SSS0.Px2.p3.3.m3.1.1"><times id="S4.SS2.SSS0.Px2.p3.3.m3.1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p3.3.m3.1.1.1"></times><ci id="S4.SS2.SSS0.Px2.p3.3.m3.1.1.2.cmml" xref="S4.SS2.SSS0.Px2.p3.3.m3.1.1.2">𝑐</ci><apply id="S4.SS2.SSS0.Px2.p3.3.m3.1.1.3.cmml" xref="S4.SS2.SSS0.Px2.p3.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p3.3.m3.1.1.3.1.cmml" xref="S4.SS2.SSS0.Px2.p3.3.m3.1.1.3">subscript</csymbol><ci id="S4.SS2.SSS0.Px2.p3.3.m3.1.1.3.2.cmml" xref="S4.SS2.SSS0.Px2.p3.3.m3.1.1.3.2">ℎ</ci><ci id="S4.SS2.SSS0.Px2.p3.3.m3.1.1.3.3.cmml" xref="S4.SS2.SSS0.Px2.p3.3.m3.1.1.3.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px2.p3.3.m3.1c">ch_{x}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px2.p3.3.m3.1d">italic_c italic_h start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="ch_{y}" class="ltx_Math" display="inline" id="S4.SS2.SSS0.Px2.p3.4.m4.1"><semantics id="S4.SS2.SSS0.Px2.p3.4.m4.1a"><mrow id="S4.SS2.SSS0.Px2.p3.4.m4.1.1" xref="S4.SS2.SSS0.Px2.p3.4.m4.1.1.cmml"><mi id="S4.SS2.SSS0.Px2.p3.4.m4.1.1.2" xref="S4.SS2.SSS0.Px2.p3.4.m4.1.1.2.cmml">c</mi><mo id="S4.SS2.SSS0.Px2.p3.4.m4.1.1.1" xref="S4.SS2.SSS0.Px2.p3.4.m4.1.1.1.cmml">⁢</mo><msub id="S4.SS2.SSS0.Px2.p3.4.m4.1.1.3" xref="S4.SS2.SSS0.Px2.p3.4.m4.1.1.3.cmml"><mi id="S4.SS2.SSS0.Px2.p3.4.m4.1.1.3.2" xref="S4.SS2.SSS0.Px2.p3.4.m4.1.1.3.2.cmml">h</mi><mi id="S4.SS2.SSS0.Px2.p3.4.m4.1.1.3.3" xref="S4.SS2.SSS0.Px2.p3.4.m4.1.1.3.3.cmml">y</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px2.p3.4.m4.1b"><apply id="S4.SS2.SSS0.Px2.p3.4.m4.1.1.cmml" xref="S4.SS2.SSS0.Px2.p3.4.m4.1.1"><times id="S4.SS2.SSS0.Px2.p3.4.m4.1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p3.4.m4.1.1.1"></times><ci id="S4.SS2.SSS0.Px2.p3.4.m4.1.1.2.cmml" xref="S4.SS2.SSS0.Px2.p3.4.m4.1.1.2">𝑐</ci><apply id="S4.SS2.SSS0.Px2.p3.4.m4.1.1.3.cmml" xref="S4.SS2.SSS0.Px2.p3.4.m4.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS0.Px2.p3.4.m4.1.1.3.1.cmml" xref="S4.SS2.SSS0.Px2.p3.4.m4.1.1.3">subscript</csymbol><ci id="S4.SS2.SSS0.Px2.p3.4.m4.1.1.3.2.cmml" xref="S4.SS2.SSS0.Px2.p3.4.m4.1.1.3.2">ℎ</ci><ci id="S4.SS2.SSS0.Px2.p3.4.m4.1.1.3.3.cmml" xref="S4.SS2.SSS0.Px2.p3.4.m4.1.1.3.3">𝑦</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px2.p3.4.m4.1c">ch_{y}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS0.Px2.p3.4.m4.1d">italic_c italic_h start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT</annotation></semantics></math> remain well-separated in the embedding space. Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#S4.F4" title="Figure 4 ‣ Representation Similarity Analysis ‣ 4.2 Representation Analysis ‣ 4 Experiment ‣ UncertaintyRAG: Span-Level Uncertainty Enhanced Long-Context Modeling for Retrieval-Augmented Generation"><span class="ltx_text ltx_ref_tag">4</span></a>, shows the uniformity and alignment of different sentence embedding models along with their averaged STS results. We have the following findings: <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS0.Px2.p3.4.1">i</span>): When we scale the positive and negative samples, the uniformity of the retrieval model increases, which aligns with the idea of InfoNCE <cite class="ltx_cite ltx_citemacro_citep">(Oord et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib55" title="">2018</a>)</cite>, where increasing the noise samples can improve the uniformity of representations. <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS0.Px2.p3.4.2">ii</span>): When we scale the anchors, the alignment of retrieval improves, which means we can align the retrieval model by performing data selection on the anchor samples of the model. <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS0.Px2.p3.4.3">iii</span>): Enhancing the alignment level of the model does not improve the performance of the retrieval model, while improving the model’s uniformity can enhance the performance of the retrieval model.</p>
</div>
<figure class="ltx_table" id="S4.T4">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T4.1" style="width:419.4pt;height:127pt;vertical-align:-1.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<p class="ltx_p" id="S4.T4.1.1"><span class="ltx_text" id="S4.T4.1.1.1">
<span class="ltx_tabular ltx_align_middle" id="S4.T4.1.1.1.1">
<span class="ltx_tr" id="S4.T4.1.1.1.1.1">
<span class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.1.1.1.1.1.1">Method</span>
<span class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.1.1.1.1.1.2">2WikiMultihopQA</span>
<span class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.1.1.1.1.1.3">Musique</span>
<span class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.1.1.1.1.1.4">TREC</span>
<span class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.1.1.1.1.1.5">TriviaQA</span>
<span class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.1.1.1.1.1.6">SAMSum</span>
<span class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.1.1.1.1.1.7">Average</span></span>
<span class="ltx_tr" id="S4.T4.1.1.1.1.2">
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.1.1.1.2.1">Minimum</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.1.1.1.2.2">28.04</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.1.1.1.2.3">15.25</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.1.1.1.2.4">66.50</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.1.1.1.2.5">77.21</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.1.1.1.2.6">40.35</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.1.1.1.2.7">45.47</span></span>
<span class="ltx_tr" id="S4.T4.1.1.1.1.3">
<span class="ltx_td ltx_align_center" id="S4.T4.1.1.1.1.3.1">Average</span>
<span class="ltx_td ltx_align_center" id="S4.T4.1.1.1.1.3.2">31.55</span>
<span class="ltx_td ltx_align_center" id="S4.T4.1.1.1.1.3.3">17.72</span>
<span class="ltx_td ltx_align_center" id="S4.T4.1.1.1.1.3.4">66.50</span>
<span class="ltx_td ltx_align_center" id="S4.T4.1.1.1.1.3.5">78.21</span>
<span class="ltx_td ltx_align_center" id="S4.T4.1.1.1.1.3.6">41.56</span>
<span class="ltx_td ltx_align_center" id="S4.T4.1.1.1.1.3.7">47.10</span></span>
<span class="ltx_tr" id="S4.T4.1.1.1.1.4">
<span class="ltx_td ltx_align_center" id="S4.T4.1.1.1.1.4.1">Log-sum</span>
<span class="ltx_td ltx_align_center" id="S4.T4.1.1.1.1.4.2">29.77</span>
<span class="ltx_td ltx_align_center" id="S4.T4.1.1.1.1.4.3">16.25</span>
<span class="ltx_td ltx_align_center" id="S4.T4.1.1.1.1.4.4">69.50</span>
<span class="ltx_td ltx_align_center" id="S4.T4.1.1.1.1.4.5">80.21</span>
<span class="ltx_td ltx_align_center" id="S4.T4.1.1.1.1.4.6">41.55</span>
<span class="ltx_td ltx_align_center" id="S4.T4.1.1.1.1.4.7">47.25</span></span>
<span class="ltx_tr" id="S4.T4.1.1.1.1.5">
<span class="ltx_td ltx_align_center" id="S4.T4.1.1.1.1.5.1">Entropy</span>
<span class="ltx_td ltx_align_center" id="S4.T4.1.1.1.1.5.2">31.95</span>
<span class="ltx_td ltx_align_center" id="S4.T4.1.1.1.1.5.3">16.17</span>
<span class="ltx_td ltx_align_center" id="S4.T4.1.1.1.1.5.4">69.00</span>
<span class="ltx_td ltx_align_center" id="S4.T4.1.1.1.1.5.5">79.70</span>
<span class="ltx_td ltx_align_center" id="S4.T4.1.1.1.1.5.6">40.99</span>
<span class="ltx_td ltx_align_center" id="S4.T4.1.1.1.1.5.7">47.56</span></span>
<span class="ltx_tr" id="S4.T4.1.1.1.1.6">
<span class="ltx_td ltx_align_center" id="S4.T4.1.1.1.1.6.1">Self-information</span>
<span class="ltx_td ltx_align_center" id="S4.T4.1.1.1.1.6.2">34.60</span>
<span class="ltx_td ltx_align_center" id="S4.T4.1.1.1.1.6.3">16.53</span>
<span class="ltx_td ltx_align_center" id="S4.T4.1.1.1.1.6.4">65.50</span>
<span class="ltx_td ltx_align_center" id="S4.T4.1.1.1.1.6.5">79.84</span>
<span class="ltx_td ltx_align_center" id="S4.T4.1.1.1.1.6.6">41.32</span>
<span class="ltx_td ltx_align_center" id="S4.T4.1.1.1.1.6.7">47.56</span></span>
<span class="ltx_tr" id="S4.T4.1.1.1.1.7">
<span class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T4.1.1.1.1.7.1">Ours</span>
<span class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T4.1.1.1.1.7.2">37.27</span>
<span class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T4.1.1.1.1.7.3">23.03</span>
<span class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T4.1.1.1.1.7.4">68.00</span>
<span class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T4.1.1.1.1.7.5">80.41</span>
<span class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T4.1.1.1.1.7.6">42.49</span>
<span class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T4.1.1.1.1.7.7">50.23</span></span>
</span></span></p>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>Comparison results of different uncertainty modeling approaches.</figcaption>
</figure>
<figure class="ltx_figure ltx_align_floatright" id="S4.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="218" id="S4.F5.g1" src="x5.png" width="457"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>AUROCs of Uncertainty Measures. The horizontal axis represents the threshold <math alttext="\tau" class="ltx_Math" display="inline" id="S4.F5.2.m1.1"><semantics id="S4.F5.2.m1.1b"><mi id="S4.F5.2.m1.1.1" xref="S4.F5.2.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S4.F5.2.m1.1c"><ci id="S4.F5.2.m1.1.1.cmml" xref="S4.F5.2.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F5.2.m1.1d">\tau</annotation><annotation encoding="application/x-llamapun" id="S4.F5.2.m1.1e">italic_τ</annotation></semantics></math>.</figcaption>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Uncertainty Modeling</h3>
<section class="ltx_paragraph" id="S4.SS3.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Comparison of Uncertainty Modeling Approaches</h5>
<div class="ltx_para ltx_noindent" id="S4.SS3.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS3.SSS0.Px1.p1.1">In this part, we present the results of different uncertainty measurement approaches. We present different uncertainty measurement approaches in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#A7" title="Appendix G Pipeline of Uncertainty Calibration Evaluation ‣ UncertaintyRAG: Span-Level Uncertainty Enhanced Long-Context Modeling for Retrieval-Augmented Generation"><span class="ltx_text ltx_ref_tag">G</span></a>, and the final experimental results in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#S4.T4" title="Table 4 ‣ Representation Property Analysis ‣ 4.2 Representation Analysis ‣ 4 Experiment ‣ UncertaintyRAG: Span-Level Uncertainty Enhanced Long-Context Modeling for Retrieval-Augmented Generation"><span class="ltx_text ltx_ref_tag">4</span></a>. We find that the performance of our method far exceeds simple token-level uncertainty estimation and sentence-level uncertainty estimation.</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS3.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Uncertainty Calibration Evaluation</h5>
<div class="ltx_para ltx_noindent" id="S4.SS3.SSS0.Px2.p1">
<p class="ltx_p" id="S4.SS3.SSS0.Px2.p1.10">In this part, we use the AUROC <cite class="ltx_cite ltx_citemacro_citep">(Lin et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib48" title="">2023b</a>; Huang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib27" title="">2024</a>)</cite> metric as the evaluation standard for the uncertainty calibration of LLMs. Referring to their method, we introduce an ad hoc threshold <math alttext="\tau\in\mathbb{R}" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px2.p1.1.m1.1"><semantics id="S4.SS3.SSS0.Px2.p1.1.m1.1a"><mrow id="S4.SS3.SSS0.Px2.p1.1.m1.1.1" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1.cmml"><mi id="S4.SS3.SSS0.Px2.p1.1.m1.1.1.2" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1.2.cmml">τ</mi><mo id="S4.SS3.SSS0.Px2.p1.1.m1.1.1.1" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1.1.cmml">∈</mo><mi id="S4.SS3.SSS0.Px2.p1.1.m1.1.1.3" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1.3.cmml">ℝ</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px2.p1.1.m1.1b"><apply id="S4.SS3.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1"><in id="S4.SS3.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1.1"></in><ci id="S4.SS3.SSS0.Px2.p1.1.m1.1.1.2.cmml" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1.2">𝜏</ci><ci id="S4.SS3.SSS0.Px2.p1.1.m1.1.1.3.cmml" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1.3">ℝ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px2.p1.1.m1.1c">\tau\in\mathbb{R}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px2.p1.1.m1.1d">italic_τ ∈ blackboard_R</annotation></semantics></math> to map the real-valued output of the deterministic correctness function to binary labels, i.e., <math alttext="{F_{\tau}}(x,\hat{y})=\mathbf{1}[{F_{1}}(x,\hat{y})\geq\tau]" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px2.p1.2.m2.5"><semantics id="S4.SS3.SSS0.Px2.p1.2.m2.5a"><mrow id="S4.SS3.SSS0.Px2.p1.2.m2.5.5" xref="S4.SS3.SSS0.Px2.p1.2.m2.5.5.cmml"><mrow id="S4.SS3.SSS0.Px2.p1.2.m2.5.5.3" xref="S4.SS3.SSS0.Px2.p1.2.m2.5.5.3.cmml"><msub id="S4.SS3.SSS0.Px2.p1.2.m2.5.5.3.2" xref="S4.SS3.SSS0.Px2.p1.2.m2.5.5.3.2.cmml"><mi id="S4.SS3.SSS0.Px2.p1.2.m2.5.5.3.2.2" xref="S4.SS3.SSS0.Px2.p1.2.m2.5.5.3.2.2.cmml">F</mi><mi id="S4.SS3.SSS0.Px2.p1.2.m2.5.5.3.2.3" xref="S4.SS3.SSS0.Px2.p1.2.m2.5.5.3.2.3.cmml">τ</mi></msub><mo id="S4.SS3.SSS0.Px2.p1.2.m2.5.5.3.1" xref="S4.SS3.SSS0.Px2.p1.2.m2.5.5.3.1.cmml">⁢</mo><mrow id="S4.SS3.SSS0.Px2.p1.2.m2.5.5.3.3.2" xref="S4.SS3.SSS0.Px2.p1.2.m2.5.5.3.3.1.cmml"><mo id="S4.SS3.SSS0.Px2.p1.2.m2.5.5.3.3.2.1" stretchy="false" xref="S4.SS3.SSS0.Px2.p1.2.m2.5.5.3.3.1.cmml">(</mo><mi id="S4.SS3.SSS0.Px2.p1.2.m2.1.1" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.cmml">x</mi><mo id="S4.SS3.SSS0.Px2.p1.2.m2.5.5.3.3.2.2" xref="S4.SS3.SSS0.Px2.p1.2.m2.5.5.3.3.1.cmml">,</mo><mover accent="true" id="S4.SS3.SSS0.Px2.p1.2.m2.2.2" xref="S4.SS3.SSS0.Px2.p1.2.m2.2.2.cmml"><mi id="S4.SS3.SSS0.Px2.p1.2.m2.2.2.2" xref="S4.SS3.SSS0.Px2.p1.2.m2.2.2.2.cmml">y</mi><mo id="S4.SS3.SSS0.Px2.p1.2.m2.2.2.1" xref="S4.SS3.SSS0.Px2.p1.2.m2.2.2.1.cmml">^</mo></mover><mo id="S4.SS3.SSS0.Px2.p1.2.m2.5.5.3.3.2.3" stretchy="false" xref="S4.SS3.SSS0.Px2.p1.2.m2.5.5.3.3.1.cmml">)</mo></mrow></mrow><mo id="S4.SS3.SSS0.Px2.p1.2.m2.5.5.2" xref="S4.SS3.SSS0.Px2.p1.2.m2.5.5.2.cmml">=</mo><mrow id="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1" xref="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1.cmml"><mn id="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1.3" xref="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1.3.cmml">𝟏</mn><mo id="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1.2" xref="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1.2.cmml">⁢</mo><mrow id="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1.1.1" xref="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1.1.2.cmml"><mo id="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1.1.1.2" stretchy="false" xref="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1.1.2.1.cmml">[</mo><mrow id="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1.1.1.1" xref="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1.1.1.1.cmml"><mrow id="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1.1.1.1.2" xref="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1.1.1.1.2.cmml"><msub id="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1.1.1.1.2.2" xref="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1.1.1.1.2.2.cmml"><mi id="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1.1.1.1.2.2.2" xref="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1.1.1.1.2.2.2.cmml">F</mi><mn id="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1.1.1.1.2.2.3" xref="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1.1.1.1.2.2.3.cmml">1</mn></msub><mo id="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1.1.1.1.2.1" xref="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1.1.1.1.2.1.cmml">⁢</mo><mrow id="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1.1.1.1.2.3.2" xref="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1.1.1.1.2.3.1.cmml"><mo id="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1.1.1.1.2.3.2.1" stretchy="false" xref="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1.1.1.1.2.3.1.cmml">(</mo><mi id="S4.SS3.SSS0.Px2.p1.2.m2.3.3" xref="S4.SS3.SSS0.Px2.p1.2.m2.3.3.cmml">x</mi><mo id="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1.1.1.1.2.3.2.2" xref="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1.1.1.1.2.3.1.cmml">,</mo><mover accent="true" id="S4.SS3.SSS0.Px2.p1.2.m2.4.4" xref="S4.SS3.SSS0.Px2.p1.2.m2.4.4.cmml"><mi id="S4.SS3.SSS0.Px2.p1.2.m2.4.4.2" xref="S4.SS3.SSS0.Px2.p1.2.m2.4.4.2.cmml">y</mi><mo id="S4.SS3.SSS0.Px2.p1.2.m2.4.4.1" xref="S4.SS3.SSS0.Px2.p1.2.m2.4.4.1.cmml">^</mo></mover><mo id="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1.1.1.1.2.3.2.3" stretchy="false" xref="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1.1.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1.1.1.1.1" xref="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1.1.1.1.1.cmml">≥</mo><mi id="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1.1.1.1.3" xref="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1.1.1.1.3.cmml">τ</mi></mrow><mo id="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1.1.1.3" stretchy="false" xref="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px2.p1.2.m2.5b"><apply id="S4.SS3.SSS0.Px2.p1.2.m2.5.5.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.5.5"><eq id="S4.SS3.SSS0.Px2.p1.2.m2.5.5.2.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.5.5.2"></eq><apply id="S4.SS3.SSS0.Px2.p1.2.m2.5.5.3.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.5.5.3"><times id="S4.SS3.SSS0.Px2.p1.2.m2.5.5.3.1.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.5.5.3.1"></times><apply id="S4.SS3.SSS0.Px2.p1.2.m2.5.5.3.2.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.5.5.3.2"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px2.p1.2.m2.5.5.3.2.1.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.5.5.3.2">subscript</csymbol><ci id="S4.SS3.SSS0.Px2.p1.2.m2.5.5.3.2.2.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.5.5.3.2.2">𝐹</ci><ci id="S4.SS3.SSS0.Px2.p1.2.m2.5.5.3.2.3.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.5.5.3.2.3">𝜏</ci></apply><interval closure="open" id="S4.SS3.SSS0.Px2.p1.2.m2.5.5.3.3.1.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.5.5.3.3.2"><ci id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1">𝑥</ci><apply id="S4.SS3.SSS0.Px2.p1.2.m2.2.2.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.2.2"><ci id="S4.SS3.SSS0.Px2.p1.2.m2.2.2.1.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.2.2.1">^</ci><ci id="S4.SS3.SSS0.Px2.p1.2.m2.2.2.2.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.2.2.2">𝑦</ci></apply></interval></apply><apply id="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1"><times id="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1.2.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1.2"></times><cn id="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1.3.cmml" type="integer" xref="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1.3">1</cn><apply id="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1.1.2.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1.1.1"><csymbol cd="latexml" id="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1.1.2.1.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1.1.1.2">delimited-[]</csymbol><apply id="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1.1.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1.1.1.1"><geq id="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1.1.1.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1.1.1.1.1"></geq><apply id="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1.1.1.1.2.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1.1.1.1.2"><times id="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1.1.1.1.2.1.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1.1.1.1.2.1"></times><apply id="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1.1.1.1.2.2.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1.1.1.1.2.2.1.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1.1.1.1.2.2">subscript</csymbol><ci id="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1.1.1.1.2.2.2.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1.1.1.1.2.2.2">𝐹</ci><cn id="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1.1.1.1.2.2.3.cmml" type="integer" xref="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1.1.1.1.2.2.3">1</cn></apply><interval closure="open" id="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1.1.1.1.2.3.1.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1.1.1.1.2.3.2"><ci id="S4.SS3.SSS0.Px2.p1.2.m2.3.3.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.3.3">𝑥</ci><apply id="S4.SS3.SSS0.Px2.p1.2.m2.4.4.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.4.4"><ci id="S4.SS3.SSS0.Px2.p1.2.m2.4.4.1.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.4.4.1">^</ci><ci id="S4.SS3.SSS0.Px2.p1.2.m2.4.4.2.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.4.4.2">𝑦</ci></apply></interval></apply><ci id="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1.1.1.1.3.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.5.5.1.1.1.1.3">𝜏</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px2.p1.2.m2.5c">{F_{\tau}}(x,\hat{y})=\mathbf{1}[{F_{1}}(x,\hat{y})\geq\tau]</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px2.p1.2.m2.5d">italic_F start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT ( italic_x , over^ start_ARG italic_y end_ARG ) = bold_1 [ italic_F start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( italic_x , over^ start_ARG italic_y end_ARG ) ≥ italic_τ ]</annotation></semantics></math>, where <math alttext="x" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px2.p1.3.m3.1"><semantics id="S4.SS3.SSS0.Px2.p1.3.m3.1a"><mi id="S4.SS3.SSS0.Px2.p1.3.m3.1.1" xref="S4.SS3.SSS0.Px2.p1.3.m3.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px2.p1.3.m3.1b"><ci id="S4.SS3.SSS0.Px2.p1.3.m3.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.3.m3.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px2.p1.3.m3.1c">x</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px2.p1.3.m3.1d">italic_x</annotation></semantics></math> represents the model’s input chunks and <math alttext="\hat{y}" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px2.p1.4.m4.1"><semantics id="S4.SS3.SSS0.Px2.p1.4.m4.1a"><mover accent="true" id="S4.SS3.SSS0.Px2.p1.4.m4.1.1" xref="S4.SS3.SSS0.Px2.p1.4.m4.1.1.cmml"><mi id="S4.SS3.SSS0.Px2.p1.4.m4.1.1.2" xref="S4.SS3.SSS0.Px2.p1.4.m4.1.1.2.cmml">y</mi><mo id="S4.SS3.SSS0.Px2.p1.4.m4.1.1.1" xref="S4.SS3.SSS0.Px2.p1.4.m4.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px2.p1.4.m4.1b"><apply id="S4.SS3.SSS0.Px2.p1.4.m4.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.4.m4.1.1"><ci id="S4.SS3.SSS0.Px2.p1.4.m4.1.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.4.m4.1.1.1">^</ci><ci id="S4.SS3.SSS0.Px2.p1.4.m4.1.1.2.cmml" xref="S4.SS3.SSS0.Px2.p1.4.m4.1.1.2">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px2.p1.4.m4.1c">\hat{y}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px2.p1.4.m4.1d">over^ start_ARG italic_y end_ARG</annotation></semantics></math> represents the model’s sampled output. <math alttext="{F_{1}}" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px2.p1.5.m5.1"><semantics id="S4.SS3.SSS0.Px2.p1.5.m5.1a"><msub id="S4.SS3.SSS0.Px2.p1.5.m5.1.1" xref="S4.SS3.SSS0.Px2.p1.5.m5.1.1.cmml"><mi id="S4.SS3.SSS0.Px2.p1.5.m5.1.1.2" xref="S4.SS3.SSS0.Px2.p1.5.m5.1.1.2.cmml">F</mi><mn id="S4.SS3.SSS0.Px2.p1.5.m5.1.1.3" xref="S4.SS3.SSS0.Px2.p1.5.m5.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px2.p1.5.m5.1b"><apply id="S4.SS3.SSS0.Px2.p1.5.m5.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px2.p1.5.m5.1.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.5.m5.1.1">subscript</csymbol><ci id="S4.SS3.SSS0.Px2.p1.5.m5.1.1.2.cmml" xref="S4.SS3.SSS0.Px2.p1.5.m5.1.1.2">𝐹</ci><cn id="S4.SS3.SSS0.Px2.p1.5.m5.1.1.3.cmml" type="integer" xref="S4.SS3.SSS0.Px2.p1.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px2.p1.5.m5.1c">{F_{1}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px2.p1.5.m5.1d">italic_F start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> represents the accuracy assessment of the model’s output <math alttext="\hat{y}" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px2.p1.6.m6.1"><semantics id="S4.SS3.SSS0.Px2.p1.6.m6.1a"><mover accent="true" id="S4.SS3.SSS0.Px2.p1.6.m6.1.1" xref="S4.SS3.SSS0.Px2.p1.6.m6.1.1.cmml"><mi id="S4.SS3.SSS0.Px2.p1.6.m6.1.1.2" xref="S4.SS3.SSS0.Px2.p1.6.m6.1.1.2.cmml">y</mi><mo id="S4.SS3.SSS0.Px2.p1.6.m6.1.1.1" xref="S4.SS3.SSS0.Px2.p1.6.m6.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px2.p1.6.m6.1b"><apply id="S4.SS3.SSS0.Px2.p1.6.m6.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.6.m6.1.1"><ci id="S4.SS3.SSS0.Px2.p1.6.m6.1.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.6.m6.1.1.1">^</ci><ci id="S4.SS3.SSS0.Px2.p1.6.m6.1.1.2.cmml" xref="S4.SS3.SSS0.Px2.p1.6.m6.1.1.2">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px2.p1.6.m6.1c">\hat{y}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px2.p1.6.m6.1d">over^ start_ARG italic_y end_ARG</annotation></semantics></math>. Specifically, if the correctness function <math alttext="F_{1}" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px2.p1.7.m7.1"><semantics id="S4.SS3.SSS0.Px2.p1.7.m7.1a"><msub id="S4.SS3.SSS0.Px2.p1.7.m7.1.1" xref="S4.SS3.SSS0.Px2.p1.7.m7.1.1.cmml"><mi id="S4.SS3.SSS0.Px2.p1.7.m7.1.1.2" xref="S4.SS3.SSS0.Px2.p1.7.m7.1.1.2.cmml">F</mi><mn id="S4.SS3.SSS0.Px2.p1.7.m7.1.1.3" xref="S4.SS3.SSS0.Px2.p1.7.m7.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px2.p1.7.m7.1b"><apply id="S4.SS3.SSS0.Px2.p1.7.m7.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px2.p1.7.m7.1.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.7.m7.1.1">subscript</csymbol><ci id="S4.SS3.SSS0.Px2.p1.7.m7.1.1.2.cmml" xref="S4.SS3.SSS0.Px2.p1.7.m7.1.1.2">𝐹</ci><cn id="S4.SS3.SSS0.Px2.p1.7.m7.1.1.3.cmml" type="integer" xref="S4.SS3.SSS0.Px2.p1.7.m7.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px2.p1.7.m7.1c">F_{1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px2.p1.7.m7.1d">italic_F start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> exceeds the threshold <math alttext="\tau" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px2.p1.8.m8.1"><semantics id="S4.SS3.SSS0.Px2.p1.8.m8.1a"><mi id="S4.SS3.SSS0.Px2.p1.8.m8.1.1" xref="S4.SS3.SSS0.Px2.p1.8.m8.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px2.p1.8.m8.1b"><ci id="S4.SS3.SSS0.Px2.p1.8.m8.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.8.m8.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px2.p1.8.m8.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px2.p1.8.m8.1d">italic_τ</annotation></semantics></math>, it is considered correct; otherwise, it is considered incorrect. <math alttext="{F_{\tau}}" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px2.p1.9.m9.1"><semantics id="S4.SS3.SSS0.Px2.p1.9.m9.1a"><msub id="S4.SS3.SSS0.Px2.p1.9.m9.1.1" xref="S4.SS3.SSS0.Px2.p1.9.m9.1.1.cmml"><mi id="S4.SS3.SSS0.Px2.p1.9.m9.1.1.2" xref="S4.SS3.SSS0.Px2.p1.9.m9.1.1.2.cmml">F</mi><mi id="S4.SS3.SSS0.Px2.p1.9.m9.1.1.3" xref="S4.SS3.SSS0.Px2.p1.9.m9.1.1.3.cmml">τ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px2.p1.9.m9.1b"><apply id="S4.SS3.SSS0.Px2.p1.9.m9.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px2.p1.9.m9.1.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.9.m9.1.1">subscript</csymbol><ci id="S4.SS3.SSS0.Px2.p1.9.m9.1.1.2.cmml" xref="S4.SS3.SSS0.Px2.p1.9.m9.1.1.2">𝐹</ci><ci id="S4.SS3.SSS0.Px2.p1.9.m9.1.1.3.cmml" xref="S4.SS3.SSS0.Px2.p1.9.m9.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px2.p1.9.m9.1c">{F_{\tau}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px2.p1.9.m9.1d">italic_F start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT</annotation></semantics></math> is regarded as the final binary classification result where the model is confident. It is used to compare with <math alttext="{SU}{(\text{ch}_{1},...,\text{ch}_{i},\text{query},\hat{y})}" class="ltx_Math" display="inline" id="S4.SS3.SSS0.Px2.p1.10.m10.5"><semantics id="S4.SS3.SSS0.Px2.p1.10.m10.5a"><mrow id="S4.SS3.SSS0.Px2.p1.10.m10.5.5" xref="S4.SS3.SSS0.Px2.p1.10.m10.5.5.cmml"><mi id="S4.SS3.SSS0.Px2.p1.10.m10.5.5.4" xref="S4.SS3.SSS0.Px2.p1.10.m10.5.5.4.cmml">S</mi><mo id="S4.SS3.SSS0.Px2.p1.10.m10.5.5.3" xref="S4.SS3.SSS0.Px2.p1.10.m10.5.5.3.cmml">⁢</mo><mi id="S4.SS3.SSS0.Px2.p1.10.m10.5.5.5" xref="S4.SS3.SSS0.Px2.p1.10.m10.5.5.5.cmml">U</mi><mo id="S4.SS3.SSS0.Px2.p1.10.m10.5.5.3a" xref="S4.SS3.SSS0.Px2.p1.10.m10.5.5.3.cmml">⁢</mo><mrow id="S4.SS3.SSS0.Px2.p1.10.m10.5.5.2.2" xref="S4.SS3.SSS0.Px2.p1.10.m10.5.5.2.3.cmml"><mo id="S4.SS3.SSS0.Px2.p1.10.m10.5.5.2.2.3" stretchy="false" xref="S4.SS3.SSS0.Px2.p1.10.m10.5.5.2.3.cmml">(</mo><msub id="S4.SS3.SSS0.Px2.p1.10.m10.4.4.1.1.1" xref="S4.SS3.SSS0.Px2.p1.10.m10.4.4.1.1.1.cmml"><mtext id="S4.SS3.SSS0.Px2.p1.10.m10.4.4.1.1.1.2" xref="S4.SS3.SSS0.Px2.p1.10.m10.4.4.1.1.1.2a.cmml">ch</mtext><mn id="S4.SS3.SSS0.Px2.p1.10.m10.4.4.1.1.1.3" xref="S4.SS3.SSS0.Px2.p1.10.m10.4.4.1.1.1.3.cmml">1</mn></msub><mo id="S4.SS3.SSS0.Px2.p1.10.m10.5.5.2.2.4" xref="S4.SS3.SSS0.Px2.p1.10.m10.5.5.2.3.cmml">,</mo><mi id="S4.SS3.SSS0.Px2.p1.10.m10.1.1" mathvariant="normal" xref="S4.SS3.SSS0.Px2.p1.10.m10.1.1.cmml">…</mi><mo id="S4.SS3.SSS0.Px2.p1.10.m10.5.5.2.2.5" xref="S4.SS3.SSS0.Px2.p1.10.m10.5.5.2.3.cmml">,</mo><msub id="S4.SS3.SSS0.Px2.p1.10.m10.5.5.2.2.2" xref="S4.SS3.SSS0.Px2.p1.10.m10.5.5.2.2.2.cmml"><mtext id="S4.SS3.SSS0.Px2.p1.10.m10.5.5.2.2.2.2" xref="S4.SS3.SSS0.Px2.p1.10.m10.5.5.2.2.2.2a.cmml">ch</mtext><mi id="S4.SS3.SSS0.Px2.p1.10.m10.5.5.2.2.2.3" xref="S4.SS3.SSS0.Px2.p1.10.m10.5.5.2.2.2.3.cmml">i</mi></msub><mo id="S4.SS3.SSS0.Px2.p1.10.m10.5.5.2.2.6" xref="S4.SS3.SSS0.Px2.p1.10.m10.5.5.2.3.cmml">,</mo><mtext id="S4.SS3.SSS0.Px2.p1.10.m10.2.2" xref="S4.SS3.SSS0.Px2.p1.10.m10.2.2a.cmml">query</mtext><mo id="S4.SS3.SSS0.Px2.p1.10.m10.5.5.2.2.7" xref="S4.SS3.SSS0.Px2.p1.10.m10.5.5.2.3.cmml">,</mo><mover accent="true" id="S4.SS3.SSS0.Px2.p1.10.m10.3.3" xref="S4.SS3.SSS0.Px2.p1.10.m10.3.3.cmml"><mi id="S4.SS3.SSS0.Px2.p1.10.m10.3.3.2" xref="S4.SS3.SSS0.Px2.p1.10.m10.3.3.2.cmml">y</mi><mo id="S4.SS3.SSS0.Px2.p1.10.m10.3.3.1" xref="S4.SS3.SSS0.Px2.p1.10.m10.3.3.1.cmml">^</mo></mover><mo id="S4.SS3.SSS0.Px2.p1.10.m10.5.5.2.2.8" stretchy="false" xref="S4.SS3.SSS0.Px2.p1.10.m10.5.5.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px2.p1.10.m10.5b"><apply id="S4.SS3.SSS0.Px2.p1.10.m10.5.5.cmml" xref="S4.SS3.SSS0.Px2.p1.10.m10.5.5"><times id="S4.SS3.SSS0.Px2.p1.10.m10.5.5.3.cmml" xref="S4.SS3.SSS0.Px2.p1.10.m10.5.5.3"></times><ci id="S4.SS3.SSS0.Px2.p1.10.m10.5.5.4.cmml" xref="S4.SS3.SSS0.Px2.p1.10.m10.5.5.4">𝑆</ci><ci id="S4.SS3.SSS0.Px2.p1.10.m10.5.5.5.cmml" xref="S4.SS3.SSS0.Px2.p1.10.m10.5.5.5">𝑈</ci><vector id="S4.SS3.SSS0.Px2.p1.10.m10.5.5.2.3.cmml" xref="S4.SS3.SSS0.Px2.p1.10.m10.5.5.2.2"><apply id="S4.SS3.SSS0.Px2.p1.10.m10.4.4.1.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.10.m10.4.4.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px2.p1.10.m10.4.4.1.1.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.10.m10.4.4.1.1.1">subscript</csymbol><ci id="S4.SS3.SSS0.Px2.p1.10.m10.4.4.1.1.1.2a.cmml" xref="S4.SS3.SSS0.Px2.p1.10.m10.4.4.1.1.1.2"><mtext id="S4.SS3.SSS0.Px2.p1.10.m10.4.4.1.1.1.2.cmml" xref="S4.SS3.SSS0.Px2.p1.10.m10.4.4.1.1.1.2">ch</mtext></ci><cn id="S4.SS3.SSS0.Px2.p1.10.m10.4.4.1.1.1.3.cmml" type="integer" xref="S4.SS3.SSS0.Px2.p1.10.m10.4.4.1.1.1.3">1</cn></apply><ci id="S4.SS3.SSS0.Px2.p1.10.m10.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.10.m10.1.1">…</ci><apply id="S4.SS3.SSS0.Px2.p1.10.m10.5.5.2.2.2.cmml" xref="S4.SS3.SSS0.Px2.p1.10.m10.5.5.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px2.p1.10.m10.5.5.2.2.2.1.cmml" xref="S4.SS3.SSS0.Px2.p1.10.m10.5.5.2.2.2">subscript</csymbol><ci id="S4.SS3.SSS0.Px2.p1.10.m10.5.5.2.2.2.2a.cmml" xref="S4.SS3.SSS0.Px2.p1.10.m10.5.5.2.2.2.2"><mtext id="S4.SS3.SSS0.Px2.p1.10.m10.5.5.2.2.2.2.cmml" xref="S4.SS3.SSS0.Px2.p1.10.m10.5.5.2.2.2.2">ch</mtext></ci><ci id="S4.SS3.SSS0.Px2.p1.10.m10.5.5.2.2.2.3.cmml" xref="S4.SS3.SSS0.Px2.p1.10.m10.5.5.2.2.2.3">𝑖</ci></apply><ci id="S4.SS3.SSS0.Px2.p1.10.m10.2.2a.cmml" xref="S4.SS3.SSS0.Px2.p1.10.m10.2.2"><mtext id="S4.SS3.SSS0.Px2.p1.10.m10.2.2.cmml" xref="S4.SS3.SSS0.Px2.p1.10.m10.2.2">query</mtext></ci><apply id="S4.SS3.SSS0.Px2.p1.10.m10.3.3.cmml" xref="S4.SS3.SSS0.Px2.p1.10.m10.3.3"><ci id="S4.SS3.SSS0.Px2.p1.10.m10.3.3.1.cmml" xref="S4.SS3.SSS0.Px2.p1.10.m10.3.3.1">^</ci><ci id="S4.SS3.SSS0.Px2.p1.10.m10.3.3.2.cmml" xref="S4.SS3.SSS0.Px2.p1.10.m10.3.3.2">𝑦</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px2.p1.10.m10.5c">{SU}{(\text{ch}_{1},...,\text{ch}_{i},\text{query},\hat{y})}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS0.Px2.p1.10.m10.5d">italic_S italic_U ( ch start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , ch start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , query , over^ start_ARG italic_y end_ARG )</annotation></semantics></math> to obtain the final AUROC. The final results are presented in Fig <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#S4.F5" title="Figure 5 ‣ Representation Property Analysis ‣ 4.2 Representation Analysis ‣ 4 Experiment ‣ UncertaintyRAG: Span-Level Uncertainty Enhanced Long-Context Modeling for Retrieval-Augmented Generation"><span class="ltx_text ltx_ref_tag">5</span></a>, where we can see that the calibration of our uncertainty measures is significantly better than other methods. Both results are evaluated on the Llama-2-7b-chat-hf model using the TriviaQA <cite class="ltx_cite ltx_citemacro_citep">(Joshi et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib31" title="">2017</a>)</cite> dataset. The detailed introduction of the pipeline can be found in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#A7" title="Appendix G Pipeline of Uncertainty Calibration Evaluation ‣ UncertaintyRAG: Span-Level Uncertainty Enhanced Long-Context Modeling for Retrieval-Augmented Generation"><span class="ltx_text ltx_ref_tag">G</span></a>.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>
<div class="ltx_para ltx_noindent" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">In conclusion, <span class="ltx_text ltx_font_italic" id="S5.p1.1.1">UncertaintyRAG</span> introduces a novel SNR-based span uncertainty approach to improve calibration in long-context Retrieval-Augmented Generation (RAG). The method outperforms powerful open-source embedding models like BGE-M3 while using only 4% of the training data. By leveraging span uncertainty, <span class="ltx_text ltx_font_italic" id="S5.p1.1.2">UncertaintyRAG</span> promotes unsupervised learning, reducing the need for large labeled datasets, making it scalable and efficient. The results show that even with minimal data, <span class="ltx_text ltx_font_italic" id="S5.p1.1.3">UncertaintyRAG</span> achieves superior performance and generalization under distribution shift scenarios. This lightweight solution requires no fine-tuning and integrates seamlessly into any LLM, making it versatile for various long-context tasks. Looking forward, <span class="ltx_text ltx_font_italic" id="S5.p1.1.4">UncertaintyRAG</span> paves the way for optimizing retrieval models through advanced uncertainty quantification, particularly in resource-constrained environments.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Agarwal et al. (2024)</span>
<span class="ltx_bibblock">
Saurabh Agarwal, Bilge Acun, Basil Homer, Mostafa Elhoushi, Yejin Lee, Shivaram Venkataraman, Dimitris Papailiopoulos, and Carole-Jean Wu.

</span>
<span class="ltx_bibblock">Chai: Clustered head attention for efficient llm inference.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">arXiv preprint arXiv:2403.08058</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Amini et al. (2019)</span>
<span class="ltx_bibblock">
Aida Amini, Saadia Gabriel, Peter Lin, Rik Koncel-Kedziorski, Yejin Choi, and Hannaneh Hajishirzi.

</span>
<span class="ltx_bibblock">Mathqa: Towards interpretable math word problem solving with operation-based formalisms.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">arXiv preprint arXiv:1905.13319</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bai et al. (2023)</span>
<span class="ltx_bibblock">
Yushi Bai, Xin Lv, Jiajie Zhang, Hongchang Lyu, Jiankai Tang, Zhidian Huang, Zhengxiao Du, Xiao Liu, Aohan Zeng, Lei Hou, Yuxiao Dong, Jie Tang, and Juanzi Li.

</span>
<span class="ltx_bibblock">Longbench: A bilingual, multitask benchmark for long context understanding.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">arXiv preprint arXiv:2308.14508</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bertsch et al. (2024)</span>
<span class="ltx_bibblock">
Amanda Bertsch, Uri Alon, Graham Neubig, and Matthew Gormley.

</span>
<span class="ltx_bibblock">Unlimiformer: Long-range transformers with unlimited length input.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">Advances in Neural Information Processing Systems</em>, 36, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Caciularu et al. (2022)</span>
<span class="ltx_bibblock">
Avi Caciularu, Ido Dagan, Jacob Goldberger, and Arman Cohan.

</span>
<span class="ltx_bibblock">Long context question answering via supervised contrastive learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">Proceedings of the 2022 Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies</em>, pp.  2872–2879, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2024)</span>
<span class="ltx_bibblock">
Jianlv Chen, Shitao Xiao, Peitian Zhang, Kun Luo, Defu Lian, and Zheng Liu.

</span>
<span class="ltx_bibblock">Bge m3-embedding: Multi-lingual, multi-functionality, multi-granularity text embeddings through self-knowledge distillation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">arXiv preprint arXiv:2402.03216</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2023)</span>
<span class="ltx_bibblock">
Yukang Chen, Shengju Qian, Haotian Tang, Xin Lai, Zhijian Liu, Song Han, and Jiaya Jia.

</span>
<span class="ltx_bibblock">Longlora: Efficient fine-tuning of long-context large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">arXiv preprint arXiv:2309.12307</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cheng et al. (2024)</span>
<span class="ltx_bibblock">
Xin Cheng, Xun Wang, Xingxing Zhang, Tao Ge, Si-Qing Chen, Furu Wei, Huishuai Zhang, and Dongyan Zhao.

</span>
<span class="ltx_bibblock">xrag: Extreme context compression for retrieval-augmented generation with one token.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">arXiv preprint arXiv:2405.13792</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chi et al. (2022)</span>
<span class="ltx_bibblock">
Ta-Chung Chi, Ting-Han Fan, Peter J Ramadge, and Alexander Rudnicky.

</span>
<span class="ltx_bibblock">Kerple: Kernelized relative positional embedding for length extrapolation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">Advances in Neural Information Processing Systems</em>, 35:8386–8399, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chiang et al. (2023)</span>
<span class="ltx_bibblock">
Wei-Lin Chiang, Zhuohan Li, Zi Lin, Ying Sheng, Zhanghao Wu, Hao Zhang, Lianmin Zheng, Siyuan Zhuang, Yonghao Zhuang, Joseph E Gonzalez, et al.

</span>
<span class="ltx_bibblock">Vicuna: An open-source chatbot impressing gpt-4 with 90%* chatgpt quality.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">See https://vicuna. lmsys. org (accessed 14 April 2023)</em>, 2(3):6, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cobbe et al. (2021)</span>
<span class="ltx_bibblock">
Karl Cobbe, Vineet Kosaraju, Mohammad Bavarian, Mark Chen, Heewoo Jun, Lukasz Kaiser, Matthias Plappert, Jerry Tworek, Jacob Hilton, Reiichiro Nakano, et al.

</span>
<span class="ltx_bibblock">Training verifiers to solve math word problems.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">arXiv preprint arXiv:2110.14168</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Conneau et al. (2017)</span>
<span class="ltx_bibblock">
Alexis Conneau, Douwe Kiela, Holger Schwenk, Loïc Barrault, and Antoine Bordes.

</span>
<span class="ltx_bibblock">Supervised learning of universal sentence representations from natural language inference data.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">arXiv preprint arXiv:1705.02364</em>, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dao (2023)</span>
<span class="ltx_bibblock">
Tri Dao.

</span>
<span class="ltx_bibblock">Flashattention-2: Faster attention with better parallelism and work partitioning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">arXiv preprint arXiv:2307.08691</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dao &amp; Gu (2024)</span>
<span class="ltx_bibblock">
Tri Dao and Albert Gu.

</span>
<span class="ltx_bibblock">Transformers are ssms: Generalized models and efficient algorithms through structured state space duality.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">arXiv preprint arXiv:2405.21060</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dao et al. (2022)</span>
<span class="ltx_bibblock">
Tri Dao, Dan Fu, Stefano Ermon, Atri Rudra, and Christopher Ré.

</span>
<span class="ltx_bibblock">Flashattention: Fast and memory-efficient exact attention with io-awareness.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">Advances in Neural Information Processing Systems</em>, 35:16344–16359, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dasigi et al. (2021)</span>
<span class="ltx_bibblock">
Pradeep Dasigi, Kyle Lo, Iz Beltagy, Arman Cohan, Noah A. Smith, and Matt Gardner.

</span>
<span class="ltx_bibblock">A dataset of information-seeking questions and answers anchored in research papers.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">ArXiv</em>, abs/2105.03011, 2021.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://api.semanticscholar.org/CorpusID:234093776" title="">https://api.semanticscholar.org/CorpusID:234093776</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Devlin (2018)</span>
<span class="ltx_bibblock">
Jacob Devlin.

</span>
<span class="ltx_bibblock">Bert: Pre-training of deep bidirectional transformers for language understanding.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">arXiv preprint arXiv:1810.04805</em>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Duan et al. (2024)</span>
<span class="ltx_bibblock">
Jinhao Duan, Hao Cheng, Shiqi Wang, Alex Zavalny, Chenan Wang, Renjing Xu, Bhavya Kailkhura, and Kaidi Xu.

</span>
<span class="ltx_bibblock">Shifting attention to relevance: Towards the predictive uncertainty quantification of free-form large language models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">Proceedings of the 62nd Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers)</em>, pp.  5050–5063, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Duarte et al. (2024)</span>
<span class="ltx_bibblock">
André V Duarte, João Marques, Miguel Graça, Miguel Freire, Lei Li, and Arlindo L Oliveira.

</span>
<span class="ltx_bibblock">Lumberchunker: Long-form narrative document segmentation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">arXiv preprint arXiv:2406.17526</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ge et al. (2023)</span>
<span class="ltx_bibblock">
Suyu Ge, Yunan Zhang, Liyuan Liu, Minjia Zhang, Jiawei Han, and Jianfeng Gao.

</span>
<span class="ltx_bibblock">Model tells you what to discard: Adaptive kv cache compression for llms.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">arXiv preprint arXiv:2310.01801</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Geva et al. (2021)</span>
<span class="ltx_bibblock">
Mor Geva, Daniel Khashabi, Elad Segal, Tushar Khot, Dan Roth, and Jonathan Berant.

</span>
<span class="ltx_bibblock">Did aristotle use a laptop? a question answering benchmark with implicit reasoning strategies.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">Transactions of the Association for Computational Linguistics</em>, 9:346–361, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gu &amp; Dao (2023)</span>
<span class="ltx_bibblock">
Albert Gu and Tri Dao.

</span>
<span class="ltx_bibblock">Mamba: Linear-time sequence modeling with selective state spaces.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">arXiv preprint arXiv:2312.00752</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gupta et al. (2024)</span>
<span class="ltx_bibblock">
Neha Gupta, Harikrishna Narasimhan, Wittawat Jitkrittum, Ankit Singh Rawat, Aditya Krishna Menon, and Sanjiv Kumar.

</span>
<span class="ltx_bibblock">Language model cascades: Token-level uncertainty and beyond.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">arXiv preprint arXiv:2404.10136</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al. (2024)</span>
<span class="ltx_bibblock">
Zifan He, Zongyue Qin, Neha Prakriya, Yizhou Sun, and Jason Cong.

</span>
<span class="ltx_bibblock">Hmt: Hierarchical memory transformer for long context language processing.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">arXiv preprint arXiv:2405.06067</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ho et al. (2020)</span>
<span class="ltx_bibblock">
Xanh Ho, Anh-Khoa Duong Nguyen, Saku Sugawara, and Akiko Aizawa.

</span>
<span class="ltx_bibblock">Constructing a multi-hop qa dataset for comprehensive evaluation of reasoning steps.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">arXiv preprint arXiv:2011.01060</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hooper et al. (2024)</span>
<span class="ltx_bibblock">
Coleman Hooper, Sehoon Kim, Hiva Mohammadzadeh, Michael W Mahoney, Yakun Sophia Shao, Kurt Keutzer, and Amir Gholami.

</span>
<span class="ltx_bibblock">Kvquant: Towards 10 million context length llm inference with kv cache quantization.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">arXiv preprint arXiv:2401.18079</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang et al. (2024)</span>
<span class="ltx_bibblock">
Xinmeng Huang, Shuo Li, Mengxin Yu, Matteo Sesia, Hamed Hassani, Insup Lee, Osbert Bastani, and Edgar Dobriban.

</span>
<span class="ltx_bibblock">Uncertainty in language models: Assessment through rank-calibration.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">arXiv preprint arXiv:2404.03163</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Izacard et al. (2021)</span>
<span class="ltx_bibblock">
Gautier Izacard, Mathilde Caron, Lucas Hosseini, Sebastian Riedel, Piotr Bojanowski, Armand Joulin, and Edouard Grave.

</span>
<span class="ltx_bibblock">Unsupervised dense information retrieval with contrastive learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">arXiv preprint arXiv:2112.09118</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang et al. (2024a)</span>
<span class="ltx_bibblock">
Huiqiang Jiang, Yucheng Li, Chengruidong Zhang, Qianhui Wu, Xufang Luo, Surin Ahn, Zhenhua Han, Amir H Abdi, Dongsheng Li, Chin-Yew Lin, et al.

</span>
<span class="ltx_bibblock">Minference 1.0: Accelerating pre-filling for long-context llms via dynamic sparse attention.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">arXiv preprint arXiv:2407.02490</em>, 2024a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang et al. (2024b)</span>
<span class="ltx_bibblock">
Ziyan Jiang, Xueguang Ma, and Wenhu Chen.

</span>
<span class="ltx_bibblock">Longrag: Enhancing retrieval-augmented generation with long-context llms.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">arXiv preprint arXiv:2406.15319</em>, 2024b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Joshi et al. (2017)</span>
<span class="ltx_bibblock">
Mandar Joshi, Eunsol Choi, Daniel S Weld, and Luke Zettlemoyer.

</span>
<span class="ltx_bibblock">Triviaqa: A large scale distantly supervised challenge dataset for reading comprehension.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">arXiv preprint arXiv:1705.03551</em>, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Karpukhin et al. (2020)</span>
<span class="ltx_bibblock">
Vladimir Karpukhin, Barlas Oğuz, Sewon Min, Patrick Lewis, Ledell Wu, Sergey Edunov, Danqi Chen, and Wen-tau Yih.

</span>
<span class="ltx_bibblock">Dense passage retrieval for open-domain question answering.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">arXiv preprint arXiv:2004.04906</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Katharopoulos et al. (2020)</span>
<span class="ltx_bibblock">
Angelos Katharopoulos, Apoorv Vyas, Nikolaos Pappas, and François Fleuret.

</span>
<span class="ltx_bibblock">Transformers are rnns: Fast autoregressive transformers with linear attention.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">International conference on machine learning</em>, pp.  5156–5165. PMLR, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kingma (2014)</span>
<span class="ltx_bibblock">
Diederik P Kingma.

</span>
<span class="ltx_bibblock">Adam: A method for stochastic optimization.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">arXiv preprint arXiv:1412.6980</em>, 2014.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kitaev et al. (2020)</span>
<span class="ltx_bibblock">
Nikita Kitaev, Łukasz Kaiser, and Anselm Levskaya.

</span>
<span class="ltx_bibblock">Reformer: The efficient transformer.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">arXiv preprint arXiv:2001.04451</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kočiskỳ et al. (2018)</span>
<span class="ltx_bibblock">
Tomáš Kočiskỳ, Jonathan Schwarz, Phil Blunsom, Chris Dyer, Karl Moritz Hermann, Gábor Melis, and Edward Grefenstette.

</span>
<span class="ltx_bibblock">The narrativeqa reading comprehension challenge.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">Transactions of the Association for Computational Linguistics</em>, 6:317–328, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kuhn et al. (2023)</span>
<span class="ltx_bibblock">
Lorenz Kuhn, Yarin Gal, and Sebastian Farquhar.

</span>
<span class="ltx_bibblock">Semantic uncertainty: Linguistic invariances for uncertainty estimation in natural language generation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">arXiv preprint arXiv:2302.09664</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Laakso &amp; Cottrell (2000)</span>
<span class="ltx_bibblock">
Aarre Laakso and Garrison Cottrell.

</span>
<span class="ltx_bibblock">Content and cluster analysis: assessing representational similarity in neural systems.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">Philosophical psychology</em>, 13(1):47–76, 2000.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lewis et al. (2020a)</span>
<span class="ltx_bibblock">
Patrick Lewis, Ethan Perez, Aleksandra Piktus, Fabio Petroni, Vladimir Karpukhin, Naman Goyal, Heinrich Küttler, Mike Lewis, Wen-tau Yih, Tim Rocktäschel, et al.

</span>
<span class="ltx_bibblock">Retrieval-augmented generation for knowledge-intensive nlp tasks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">Advances in Neural Information Processing Systems</em>, 33:9459–9474, 2020a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lewis et al. (2020b)</span>
<span class="ltx_bibblock">
Patrick Lewis, Pontus Stenetorp, and Sebastian Riedel.

</span>
<span class="ltx_bibblock">Question and answer test-train overlap in open-domain question answering datasets.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">arXiv preprint arXiv:2008.02637</em>, 2020b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2024a)</span>
<span class="ltx_bibblock">
Chaofan Li, Zheng Liu, Shitao Xiao, Yingxia Shao, and Defu Lian.

</span>
<span class="ltx_bibblock">Llama2vec: Unsupervised adaptation of large language models for dense retrieval.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">Proceedings of the 62nd Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers)</em>, pp.  3490–3500, 2024a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2024b)</span>
<span class="ltx_bibblock">
Dongyang Li, Junbing Yan, Taolin Zhang, Chengyu Wang, Xiaofeng He, Longtao Huang, Hui Xue, and Jun Huang.

</span>
<span class="ltx_bibblock">On the role of long-tail knowledge in retrieval augmented large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib42.1.1">arXiv preprint arXiv:2406.16367</em>, 2024b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2023a)</span>
<span class="ltx_bibblock">
Shanda Li, Chong You, Guru Guruganesh, Joshua Ainslie, Santiago Ontanon, Manzil Zaheer, Sumit Sanghai, Yiming Yang, Sanjiv Kumar, and Srinadh Bhojanapalli.

</span>
<span class="ltx_bibblock">Functional interpolation for relative positions improves long context transformers.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib43.1.1">arXiv preprint arXiv:2310.04418</em>, 2023a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li &amp; Roth (2002)</span>
<span class="ltx_bibblock">
Xin Li and Dan Roth.

</span>
<span class="ltx_bibblock">Learning question classifiers.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib44.1.1">COLING 2002: The 19th International Conference on Computational Linguistics</em>, 2002.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2023b)</span>
<span class="ltx_bibblock">
Yucheng Li, Bo Dong, Chenghua Lin, and Frank Guerin.

</span>
<span class="ltx_bibblock">Compressing context to enhance inference efficiency of large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib45.1.1">arXiv preprint arXiv:2310.06201</em>, 2023b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2024c)</span>
<span class="ltx_bibblock">
Zhuowan Li, Cheng Li, Mingyang Zhang, Qiaozhu Mei, and Michael Bendersky.

</span>
<span class="ltx_bibblock">Retrieval augmented generation or long-context llms? a comprehensive study and hybrid approach.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib46.1.1">arXiv preprint arXiv:2407.16833</em>, 2024c.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al. (2023a)</span>
<span class="ltx_bibblock">
Sheng-Chieh Lin, Akari Asai, Minghan Li, Barlas Oguz, Jimmy Lin, Yashar Mehdad, Wen-tau Yih, and Xilun Chen.

</span>
<span class="ltx_bibblock">How to train your dragon: Diverse augmentation towards generalizable dense retrieval.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib47.1.1">arXiv preprint arXiv:2302.07452</em>, 2023a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al. (2023b)</span>
<span class="ltx_bibblock">
Zhen Lin, Shubhendu Trivedi, and Jimeng Sun.

</span>
<span class="ltx_bibblock">Generating with confidence: Uncertainty quantification for black-box large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib48.1.1">arXiv preprint arXiv:2305.19187</em>, 2023b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2020)</span>
<span class="ltx_bibblock">
Jinlong Liu, Guoqing Jiang, Yunzhi Bai, Ting Chen, and Huayan Wang.

</span>
<span class="ltx_bibblock">Understanding why neural networks generalize well through gsnr of parameters.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib49.1.1">arXiv preprint arXiv:2001.07384</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2023a)</span>
<span class="ltx_bibblock">
Xiaoran Liu, Hang Yan, Shuo Zhang, Chenxin An, Xipeng Qiu, and Dahua Lin.

</span>
<span class="ltx_bibblock">Scaling laws of rope-based extrapolation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib50.1.1">arXiv preprint arXiv:2310.05209</em>, 2023a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2023b)</span>
<span class="ltx_bibblock">
Zichang Liu, Jue Wang, Tri Dao, Tianyi Zhou, Binhang Yuan, Zhao Song, Anshumali Shrivastava, Ce Zhang, Yuandong Tian, Christopher Re, et al.

</span>
<span class="ltx_bibblock">Deja vu: Contextual sparsity for efficient llms at inference time.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib51.1.1">International Conference on Machine Learning</em>, pp.  22137–22176. PMLR, 2023b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2024)</span>
<span class="ltx_bibblock">
Zirui Liu, Jiayi Yuan, Hongye Jin, Shaochen Zhong, Zhaozhuo Xu, Vladimir Braverman, Beidi Chen, and Xia Hu.

</span>
<span class="ltx_bibblock">Kivi: A tuning-free asymmetric 2bit quantization for kv cache.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib52.1.1">arXiv preprint arXiv:2402.02750</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Luo et al. (2024)</span>
<span class="ltx_bibblock">
Kun Luo, Zheng Liu, Shitao Xiao, and Kang Liu.

</span>
<span class="ltx_bibblock">Bge landmark embedding: A chunking-free embedding method for retrieval augmented long-context large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib53.1.1">arXiv preprint arXiv:2402.11573</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib54">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ni et al. (2021)</span>
<span class="ltx_bibblock">
Jianmo Ni, Chen Qu, Jing Lu, Zhuyun Dai, Gustavo Hernández Ábrego, Ji Ma, Vincent Y Zhao, Yi Luan, Keith B Hall, Ming-Wei Chang, et al.

</span>
<span class="ltx_bibblock">Large dual encoders are generalizable retrievers.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib54.1.1">arXiv preprint arXiv:2112.07899</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib55">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Oord et al. (2018)</span>
<span class="ltx_bibblock">
Aaron van den Oord, Yazhe Li, and Oriol Vinyals.

</span>
<span class="ltx_bibblock">Representation learning with contrastive predictive coding.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib55.1.1">arXiv preprint arXiv:1807.03748</em>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib56">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pang et al. (2024)</span>
<span class="ltx_bibblock">
Jianhui Pang, Fanghua Ye, Derek Wong, Xin He, Wanshun Chen, and Longyue Wang.

</span>
<span class="ltx_bibblock">Anchor-based large language models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib56.1.1">Findings of the Association for Computational Linguistics ACL 2024</em>, pp.  4958–4976, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib57">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Peng et al. (2023a)</span>
<span class="ltx_bibblock">
Bo Peng, Eric Alcaide, Quentin Anthony, Alon Albalak, Samuel Arcadinho, Stella Biderman, Huanqi Cao, Xin Cheng, Michael Chung, Matteo Grella, et al.

</span>
<span class="ltx_bibblock">Rwkv: Reinventing rnns for the transformer era.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib57.1.1">arXiv preprint arXiv:2305.13048</em>, 2023a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib58">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Peng &amp; Quesnelle (2023)</span>
<span class="ltx_bibblock">
Bowen Peng and Jeffrey Quesnelle.

</span>
<span class="ltx_bibblock">Ntk-aware scaled rope allows llama models to have extended (8k+) context size without any fine-tuning and minimal perplexity degradation, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib59">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Peng et al. (2023b)</span>
<span class="ltx_bibblock">
Bowen Peng, Jeffrey Quesnelle, Honglu Fan, and Enrico Shippole.

</span>
<span class="ltx_bibblock">Yarn: Efficient context window extension of large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib59.1.1">arXiv preprint arXiv:2309.00071</em>, 2023b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib60">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Press et al. (2021)</span>
<span class="ltx_bibblock">
Ofir Press, Noah A Smith, and Mike Lewis.

</span>
<span class="ltx_bibblock">Train short, test long: Attention with linear biases enables input length extrapolation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib60.1.1">arXiv preprint arXiv:2108.12409</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib61">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qin et al. (2022)</span>
<span class="ltx_bibblock">
Zhen Qin, Xiaodong Han, Weixuan Sun, Dongxu Li, Lingpeng Kong, Nick Barnes, and Yiran Zhong.

</span>
<span class="ltx_bibblock">The devil in linear transformer.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib61.1.1">arXiv preprint arXiv:2210.10340</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib62">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ribar et al. (2023)</span>
<span class="ltx_bibblock">
Luka Ribar, Ivan Chelombiev, Luke Hudlass-Galley, Charlie Blake, Carlo Luschi, and Douglas Orr.

</span>
<span class="ltx_bibblock">Sparq attention: Bandwidth-efficient llm inference.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib62.1.1">arXiv preprint arXiv:2312.04985</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib63">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Robertson et al. (2009)</span>
<span class="ltx_bibblock">
Stephen Robertson, Hugo Zaragoza, et al.

</span>
<span class="ltx_bibblock">The probabilistic relevance framework: Bm25 and beyond.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib63.1.1">Foundations and Trends® in Information Retrieval</em>, 3(4):333–389, 2009.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib64">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sagirova &amp; Burtsev (2023)</span>
<span class="ltx_bibblock">
Alsu Sagirova and Mikhail Burtsev.

</span>
<span class="ltx_bibblock">Uncertainty guided global memory improves multi-hop question answering.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib64.1.1">Proceedings of the 2023 Conference on Empirical Methods in Natural Language Processing</em>, pp.  4317–4328, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib65">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sarthi et al. (2024)</span>
<span class="ltx_bibblock">
Parth Sarthi, Salman Abdullah, Aditi Tuli, Shubh Khanna, Anna Goldie, and Christopher D Manning.

</span>
<span class="ltx_bibblock">Raptor: Recursive abstractive processing for tree-organized retrieval.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib65.1.1">arXiv preprint arXiv:2401.18059</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib66">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shah et al. (2024)</span>
<span class="ltx_bibblock">
Jay Shah, Ganesh Bikshandi, Ying Zhang, Vijay Thakkar, Pradeep Ramani, and Tri Dao.

</span>
<span class="ltx_bibblock">Flashattention-3: Fast and accurate attention with asynchrony and low-precision.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib66.1.1">arXiv preprint arXiv:2407.08608</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib67">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Su et al. (2024)</span>
<span class="ltx_bibblock">
Jianlin Su, Murtadha Ahmed, Yu Lu, Shengfeng Pan, Wen Bo, and Yunfeng Liu.

</span>
<span class="ltx_bibblock">Roformer: Enhanced transformer with rotary position embedding.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib67.1.1">Neurocomputing</em>, 568:127063, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib68">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et al. (2023)</span>
<span class="ltx_bibblock">
Hugo Touvron, Thibaut Lavril, Gautier Izacard, Xavier Martinet, Marie-Anne Lachaux, Timothée Lacroix, Baptiste Rozière, Naman Goyal, Eric Hambro, Faisal Azhar, et al.

</span>
<span class="ltx_bibblock">Llama: Open and efficient foundation language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib68.1.1">arXiv preprint arXiv:2302.13971</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib69">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Trivedi et al. (2022)</span>
<span class="ltx_bibblock">
Harsh Trivedi, Niranjan Balasubramanian, Tushar Khot, and Ashish Sabharwal.

</span>
<span class="ltx_bibblock">Musique: Multihop questions via single-hop question composition.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib69.1.1">Transactions of the Association for Computational Linguistics</em>, 10:539–554, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib70">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2020)</span>
<span class="ltx_bibblock">
Sinong Wang, Belinda Z Li, Madian Khabsa, Han Fang, and Hao Ma.

</span>
<span class="ltx_bibblock">Linformer: Self-attention with linear complexity.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib70.1.1">arXiv preprint arXiv:2006.04768</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib71">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang &amp; Isola (2020)</span>
<span class="ltx_bibblock">
Tongzhou Wang and Phillip Isola.

</span>
<span class="ltx_bibblock">Understanding contrastive representation learning through alignment and uniformity on the hypersphere.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib71.1.1">International conference on machine learning</em>, pp.  9929–9939. PMLR, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib72">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2024)</span>
<span class="ltx_bibblock">
Weizhi Wang, Li Dong, Hao Cheng, Xiaodong Liu, Xifeng Yan, Jianfeng Gao, and Furu Wei.

</span>
<span class="ltx_bibblock">Augmenting language models with long-term memory.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib72.1.1">Advances in Neural Information Processing Systems</em>, 36, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib73">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xiao et al. (2023a)</span>
<span class="ltx_bibblock">
Guangxuan Xiao, Yuandong Tian, Beidi Chen, Song Han, and Mike Lewis.

</span>
<span class="ltx_bibblock">Efficient streaming language models with attention sinks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib73.1.1">arXiv preprint arXiv:2309.17453</em>, 2023a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib74">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xiao et al. (2023b)</span>
<span class="ltx_bibblock">
Shitao Xiao, Zheng Liu, Peitian Zhang, and Niklas Muennighoff.

</span>
<span class="ltx_bibblock">C-pack: Packaged resources to advance general chinese embedding, 2023b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib75">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xiong et al. (2023)</span>
<span class="ltx_bibblock">
Miao Xiong, Zhiyuan Hu, Xinyang Lu, Yifei Li, Jie Fu, Junxian He, and Bryan Hooi.

</span>
<span class="ltx_bibblock">Can llms express their uncertainty? an empirical evaluation of confidence elicitation in llms.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib75.1.1">arXiv preprint arXiv:2306.13063</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib76">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et al. (2023a)</span>
<span class="ltx_bibblock">
Fangyuan Xu, Weijia Shi, and Eunsol Choi.

</span>
<span class="ltx_bibblock">Recomp: Improving retrieval-augmented lms with compression and selective augmentation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib76.1.1">arXiv preprint arXiv:2310.04408</em>, 2023a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib77">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et al. (2023b)</span>
<span class="ltx_bibblock">
Peng Xu, Wei Ping, Xianchao Wu, Lawrence McAfee, Chen Zhu, Zihan Liu, Sandeep Subramanian, Evelina Bakhturina, Mohammad Shoeybi, and Bryan Catanzaro.

</span>
<span class="ltx_bibblock">Retrieval meets long context large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib77.1.1">arXiv preprint arXiv:2310.03025</em>, 2023b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib78">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et al. (2024)</span>
<span class="ltx_bibblock">
Peng Xu, Wei Ping, Xianchao Wu, Zihan Liu, Mohammad Shoeybi, and Bryan Catanzaro.

</span>
<span class="ltx_bibblock">Chatqa 2: Bridging the gap to proprietary llms in long context and rag capabilities.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib78.1.1">arXiv preprint arXiv:2407.14482</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib79">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. (2023)</span>
<span class="ltx_bibblock">
Songlin Yang, Bailin Wang, Yikang Shen, Rameswar Panda, and Yoon Kim.

</span>
<span class="ltx_bibblock">Gated linear attention transformers with hardware-efficient training.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib79.1.1">arXiv preprint arXiv:2312.06635</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib80">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. (2018)</span>
<span class="ltx_bibblock">
Zhilin Yang, Peng Qi, Saizheng Zhang, Yoshua Bengio, William W. Cohen, Ruslan Salakhutdinov, and Christopher D. Manning.

</span>
<span class="ltx_bibblock">HotpotQA: A dataset for diverse, explainable multi-hop question answering.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib80.1.1">Conference on Empirical Methods in Natural Language Processing (EMNLP)</em>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib81">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ye et al. (2024)</span>
<span class="ltx_bibblock">
Fanghua Ye, Mingming Yang, Jianhui Pang, Longyue Wang, Derek F Wong, Emine Yilmaz, Shuming Shi, and Zhaopeng Tu.

</span>
<span class="ltx_bibblock">Benchmarking llms via uncertainty quantification.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib81.1.1">arXiv preprint arXiv:2401.12794</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib82">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2024)</span>
<span class="ltx_bibblock">
Zhenyu Zhang, Ying Sheng, Tianyi Zhou, Tianlong Chen, Lianmin Zheng, Ruisi Cai, Zhao Song, Yuandong Tian, Christopher Ré, Clark Barrett, et al.

</span>
<span class="ltx_bibblock">H2o: Heavy-hitter oracle for efficient generative inference of large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib82.1.1">Advances in Neural Information Processing Systems</em>, 36, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib83">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zheng et al. (2022)</span>
<span class="ltx_bibblock">
Lin Zheng, Chong Wang, and Lingpeng Kong.

</span>
<span class="ltx_bibblock">Linear complexity randomized self-attention mechanism.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib83.1.1">International conference on machine learning</em>, pp.  27011–27041. PMLR, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib84">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhong et al. (2021)</span>
<span class="ltx_bibblock">
Ming Zhong, Da Yin, Tao Yu, Ahmad Zaidi, Mutethia Mutuma, Rahul Jha, Ahmed Hassan Awadallah, Asli Celikyilmaz, Yang Liu, Xipeng Qiu, and Dragomir Radev.

</span>
<span class="ltx_bibblock">QMSum: A New Benchmark for Query-based Multi-domain Meeting Summarization.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib84.1.1">North American Association for Computational Linguistics (NAACL)</em>, 2021.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="Ax1">
<h2 class="ltx_title ltx_title_appendix">Appendix</h2>
</section>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Training Dataset</h2>
<div class="ltx_para ltx_noindent" id="A1.p1">
<p class="ltx_p" id="A1.p1.1">In this work, we construct a new dataset from five existing datasets that include single-document QA, multi-document QA, and summarization tasks to train our dense retriever. All datasets are sourced from LongBench<cite class="ltx_cite ltx_citemacro_citep">(Bai et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib3" title="">2023</a>)</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.p2">
<p class="ltx_p" id="A1.p2.1"><span class="ltx_text ltx_font_bold" id="A1.p2.1.1">HotpotQA<cite class="ltx_cite ltx_citemacro_citep"><span class="ltx_text ltx_font_medium" id="A1.p2.1.1.1.1">(</span>Yang et al.<span class="ltx_text ltx_font_medium" id="A1.p2.1.1.2.2.1.1">, </span><a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib80" title="">2018</a><span class="ltx_text ltx_font_medium" id="A1.p2.1.1.3.3">)</span></cite></span> is a challenging benchmark for multi-hop question answering, requiring models to retrieve and integrate information from multiple documents to arrive at the correct answer. It is specifically designed to evaluate a model’s capacity for compositional reasoning, as questions often necessitate combining evidence from disparate sources. Additionally, HotpotQA includes supporting fact annotations, which serve to explain the reasoning process, making it suitable for tasks involving both factual retrieval and logical inference in natural language understanding.</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.p3">
<p class="ltx_p" id="A1.p3.1"><span class="ltx_text ltx_font_bold" id="A1.p3.1.1">MultiFieldQA-en<cite class="ltx_cite ltx_citemacro_citep"><span class="ltx_text ltx_font_medium" id="A1.p3.1.1.1.1">(</span>Bai et al.<span class="ltx_text ltx_font_medium" id="A1.p3.1.1.2.2.1.1">, </span><a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib3" title="">2023</a><span class="ltx_text ltx_font_medium" id="A1.p3.1.1.3.3">)</span></cite></span> is manually curated to better evaluate the model’s ability to understand long contexts across various fields. The documents contain evidence from multiple sources, such as legal documents, government reports, encyclopedias, and academic papers, which are randomly distributed to prevent biases that might arise from their placement at the beginning or end of the documents.</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.p4">
<p class="ltx_p" id="A1.p4.1"><span class="ltx_text ltx_font_bold" id="A1.p4.1.1">Qasper<cite class="ltx_cite ltx_citemacro_citep"><span class="ltx_text ltx_font_medium" id="A1.p4.1.1.1.1">(</span>Dasigi et al.<span class="ltx_text ltx_font_medium" id="A1.p4.1.1.2.2.1.1">, </span><a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib16" title="">2021</a><span class="ltx_text ltx_font_medium" id="A1.p4.1.1.3.3">)</span></cite></span> is a question-answering dataset specifically tailored for academic papers in the field of natural language processing. It consists of questions generated by annotators who read full research papers and pose queries that can be answered using the information within the paper. The dataset is designed to evaluate a model’s ability to perform non-factoid QA on scientific texts, involving tasks such as understanding methodologies, interpreting results, and synthesizing information from complex, domain-specific content.</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.p5">
<p class="ltx_p" id="A1.p5.1"><span class="ltx_text ltx_font_bold" id="A1.p5.1.1">NarrativeQA<cite class="ltx_cite ltx_citemacro_citep"><span class="ltx_text ltx_font_medium" id="A1.p5.1.1.1.1">(</span>Kočiskỳ et al.<span class="ltx_text ltx_font_medium" id="A1.p5.1.1.2.2.1.1">, </span><a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib36" title="">2018</a><span class="ltx_text ltx_font_medium" id="A1.p5.1.1.3.3">)</span></cite></span> is a well-known question-answering dataset that includes full books from Project Gutenberg and movie scripts sourced from various websites. In this task, the provided passage is transcribed from books and often contains noise. The model’s job is to generate a concise phrase by reasoning through the lengthy and noisy text.</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.p6">
<p class="ltx_p" id="A1.p6.1"><span class="ltx_text ltx_font_bold" id="A1.p6.1.1">QMSum<cite class="ltx_cite ltx_citemacro_citep"><span class="ltx_text ltx_font_medium" id="A1.p6.1.1.1.1">(</span>Zhong et al.<span class="ltx_text ltx_font_medium" id="A1.p6.1.1.2.2.1.1">, </span><a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib84" title="">2021</a><span class="ltx_text ltx_font_medium" id="A1.p6.1.1.3.3">)</span></cite></span> is a query-based summarization dataset that includes transcripts of meetings and their corresponding summaries across various domains, including academia and industrial products. In this task, a meeting dialogue transcript is provided along with a question that prompts summarization of a specific topic within the dialogue. The answers typically consist of a few sentences.</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.p7">
<p class="ltx_p" id="A1.p7.1">And then we test on five dataset:</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.p8">
<p class="ltx_p" id="A1.p8.1"><span class="ltx_text ltx_font_bold" id="A1.p8.1.1">2WikiMultihopQA<cite class="ltx_cite ltx_citemacro_citep"><span class="ltx_text ltx_font_medium" id="A1.p8.1.1.1.1">(</span>Ho et al.<span class="ltx_text ltx_font_medium" id="A1.p8.1.1.2.2.1.1">, </span><a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib25" title="">2020</a><span class="ltx_text ltx_font_medium" id="A1.p8.1.1.3.3">)</span></cite></span> is a benchmark for multi-hop question answering, which requires models to perform reasoning over multiple pieces of information to answer a single question. It contains questions that are designed to require information from multiple Wikipedia articles to answer correctly, promoting a more complex and connected reasoning process.</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.p9">
<p class="ltx_p" id="A1.p9.1"><span class="ltx_text ltx_font_bold" id="A1.p9.1.1">Musique<cite class="ltx_cite ltx_citemacro_citep"><span class="ltx_text ltx_font_medium" id="A1.p9.1.1.1.1">(</span>Trivedi et al.<span class="ltx_text ltx_font_medium" id="A1.p9.1.1.2.2.1.1">, </span><a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib69" title="">2022</a><span class="ltx_text ltx_font_medium" id="A1.p9.1.1.3.3">)</span></cite></span> is a dataset designed for multi-hop question answering. Unlike HotpotQA, Musique demands more integrated reasoning by reducing possible shortcuts in reasoning, minimizing overlap between training and test data, and featuring more challenging distractor contexts. As a result, Musique is a significantly more difficult task than HotpotQA and is much less susceptible to shortcuts.</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.p10">
<p class="ltx_p" id="A1.p10.1"><span class="ltx_text ltx_font_bold" id="A1.p10.1.1">TREC<cite class="ltx_cite ltx_citemacro_citep"><span class="ltx_text ltx_font_medium" id="A1.p10.1.1.1.1">(</span>Li &amp; Roth<span class="ltx_text ltx_font_medium" id="A1.p10.1.1.2.2.1.1">, </span><a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib44" title="">2002</a><span class="ltx_text ltx_font_medium" id="A1.p10.1.1.3.3">)</span></cite></span> is a widely used dataset for evaluating information retrieval and semantic search systems, encompassing documents from multiple domains. The answers are assessed for their relevance and accuracy based on predefined criteria, providing a robust framework for evaluating the performance of retrieval and question-answering models.</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.p11">
<p class="ltx_p" id="A1.p11.1"><span class="ltx_text ltx_font_bold" id="A1.p11.1.1">TriviaQA<cite class="ltx_cite ltx_citemacro_citep"><span class="ltx_text ltx_font_medium" id="A1.p11.1.1.1.1">(</span>Joshi et al.<span class="ltx_text ltx_font_medium" id="A1.p11.1.1.2.2.1.1">, </span><a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib31" title="">2017</a><span class="ltx_text ltx_font_medium" id="A1.p11.1.1.3.3">)</span></cite></span> is a widely used question-answering dataset that provides complex, real-world questions paired with relevant documents from sources like Wikipedia and web pages. It is designed to test a model’s ability to locate and understand the information needed to answer the questions, making it suitable for tasks such as machine reading comprehension and open-domain question answering.</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.p12">
<p class="ltx_p" id="A1.p12.1"><span class="ltx_text ltx_font_bold" id="A1.p12.1.1">SAMSum<cite class="ltx_cite ltx_citemacro_citep"><span class="ltx_text ltx_font_medium" id="A1.p12.1.1.1.1">(</span>Zhong et al.<span class="ltx_text ltx_font_medium" id="A1.p12.1.1.2.2.1.1">, </span><a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib84" title="">2021</a><span class="ltx_text ltx_font_medium" id="A1.p12.1.1.3.3">)</span></cite></span> is a specialized dataset designed for the task of abstractive dialogue summarization. Developed to support research in natural language processing, particularly in generating concise summaries from conversational text, the SAMSum dataset contains dialogues that mimic everyday conversations one might find in messaging apps or casual settings.</p>
</div>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Hyperparameter Settings</h2>
<div class="ltx_para ltx_noindent" id="A2.p1">
<p class="ltx_p" id="A2.p1.1">In our experiments, we employed Llama-2-7b-chat-hf to compute uncertainty scores across different chunks. To identify the stable region of the Signal-to-Noise Ratio (SNR), we applied a sliding window technique, setting the window size to 20 and shifting by 10 steps at each interval. We consider the SNR to have reached a stable region when its value within a window falls below a predefined threshold, typically set at 2 or 3.</p>
</div>
<div class="ltx_para ltx_noindent" id="A2.p2">
<p class="ltx_p" id="A2.p2.1">During the data scaling process, we set the number of clusters <math alttext="k" class="ltx_Math" display="inline" id="A2.p2.1.m1.1"><semantics id="A2.p2.1.m1.1a"><mi id="A2.p2.1.m1.1.1" xref="A2.p2.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A2.p2.1.m1.1b"><ci id="A2.p2.1.m1.1.1.cmml" xref="A2.p2.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="A2.p2.1.m1.1d">italic_k</annotation></semantics></math> to 10, set <span class="ltx_text ltx_font_italic" id="A2.p2.1.1">c</span> to 800 or 1600 samples from each category and set sample number <span class="ltx_text ltx_font_italic" id="A2.p2.1.2">n</span> to 100.</p>
</div>
<div class="ltx_para ltx_noindent" id="A2.p3">
<p class="ltx_p" id="A2.p3.1">During retriever training, we utilize the Adam optimizer <cite class="ltx_cite ltx_citemacro_citep">(Kingma, <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib34" title="">2014</a>)</cite> with a batch size of 16, a learning rate of 1e-5, linear scheduling with warm-up, and a dropout rate of 0.1. And we run training on 8 NVIDIA A800 GPUs.</p>
</div>
</section>
<section class="ltx_appendix" id="A3">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Baselines</h2>
<div class="ltx_para ltx_noindent" id="A3.p1">
<p class="ltx_p" id="A3.p1.1">There has been extensive research on Retrieval-Augmented Generation (RAG), with one critical aspect being the development of a robust representation model that effectively clusters sentence information with query information in high-dimensional space. In our work, we compare our approach with several influential and open-source methods from prior studies. This section provides a detailed overview of these methods.</p>
</div>
<div class="ltx_para ltx_noindent" id="A3.p2">
<p class="ltx_p" id="A3.p2.1"><span class="ltx_text ltx_font_bold" id="A3.p2.1.1">Contriever<cite class="ltx_cite ltx_citemacro_citep"><span class="ltx_text ltx_font_medium" id="A3.p2.1.1.1.1">(</span>Izacard et al.<span class="ltx_text ltx_font_medium" id="A3.p2.1.1.2.2.1.1">, </span><a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib28" title="">2021</a><span class="ltx_text ltx_font_medium" id="A3.p2.1.1.3.3">)</span></cite></span> is a dense retrieval model designed to improve performance and generalization through unsupervised training on diverse datasets. It uses contrastive learning to generate embeddings, bringing semantically related query-document pairs closer together while pushing irrelevant pairs apart. This method allows Contriever to effectively handle tasks like semantic search and question answering, even in zero-shot scenarios. By relying on unsupervised learning, it adapts well to various domains without needing annotated data, making it versatile for information retrieval tasks.</p>
</div>
<div class="ltx_para ltx_noindent" id="A3.p3">
<p class="ltx_p" id="A3.p3.1"><span class="ltx_text ltx_font_bold" id="A3.p3.1.1">BGE<cite class="ltx_cite ltx_citemacro_citep"><span class="ltx_text ltx_font_medium" id="A3.p3.1.1.1.1">(</span>Xiao et al.<span class="ltx_text ltx_font_medium" id="A3.p3.1.1.2.2.1.1">, </span><a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib74" title="">2023b</a><span class="ltx_text ltx_font_medium" id="A3.p3.1.1.3.3">)</span></cite></span> is a large-scale multilingual text embedding model developed by the Beijing Academy of Artificial Intelligence (BAAI), designed for tasks such as semantic retrieval and ranking across multiple languages. Pre-trained on extensive multilingual datasets, BGE encodes text into dense vector representations optimized for semantic similarity tasks, where the relationship between query and document pairs is captured by comparing their vector embeddings.</p>
</div>
<div class="ltx_para ltx_noindent" id="A3.p4">
<p class="ltx_p" id="A3.p4.1">The model is primarily trained using contrastive learning, which teaches it to minimize the distance between embeddings of relevant query-document pairs while maximizing the distance for irrelevant pairs. BGE embeddings are applied in dense retrieval, which focuses on understanding the semantic meaning of text rather than relying solely on keyword matching. This makes BGE especially effective for tasks that demand high precision in matching semantically similar content, such as cross-lingual or multilingual retrieval scenarios.</p>
</div>
<div class="ltx_para ltx_noindent" id="A3.p5">
<p class="ltx_p" id="A3.p5.1"><span class="ltx_text ltx_font_bold" id="A3.p5.1.1">BGE-M3<cite class="ltx_cite ltx_citemacro_citep"><span class="ltx_text ltx_font_medium" id="A3.p5.1.1.1.1">(</span>Chen et al.<span class="ltx_text ltx_font_medium" id="A3.p5.1.1.2.2.1.1">, </span><a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib6" title="">2024</a><span class="ltx_text ltx_font_medium" id="A3.p5.1.1.3.3">)</span></cite></span> is an advanced extension of the BGE model, designed to support multi-modal retrieval by integrating dense, lexical, and multi-vector retrieval methods. This hybrid approach allows BGE-M3 to tackle a broader range of retrieval tasks by combining precise keyword matching with deeper semantic analysis. The training process of BGE-M3 employs self-distillation, where intermediate layers are optimized to rank query-document pairs, enhancing both efficiency and flexibility. By leveraging a combination of sparse and dense embeddings, BGE-M3 is highly effective for large-scale, multilingual retrieval tasks.</p>
</div>
<div class="ltx_para ltx_noindent" id="A3.p6">
<p class="ltx_p" id="A3.p6.1"><span class="ltx_text ltx_font_bold" id="A3.p6.1.1">Dragon<cite class="ltx_cite ltx_citemacro_citep"><span class="ltx_text ltx_font_medium" id="A3.p6.1.1.1.1">(</span>Lin et al.<span class="ltx_text ltx_font_medium" id="A3.p6.1.1.2.2.1.1">, </span><a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib47" title="">2023a</a><span class="ltx_text ltx_font_medium" id="A3.p6.1.1.3.3">)</span></cite></span> is a dense retrieval model designed to enhance performance and generalization in dense retrieval tasks by incorporating diverse data augmentation techniques. This model is notable for its robust handling of both supervised and zero-shot environments, utilizing innovative methods to manage various query types and relevance labels. By introducing multiple forms of data augmentation—specifically for queries and labels—it effectively generalizes to unseen data.</p>
</div>
</section>
<section class="ltx_appendix" id="A4">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Prompt Templates</h2>
<figure class="ltx_table" id="A4.T5">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="A4.T5.1" style="width:411.6pt;height:386.6pt;vertical-align:-1.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<p class="ltx_p" id="A4.T5.1.1"><span class="ltx_text" id="A4.T5.1.1.1">
<span class="ltx_tabular ltx_align_middle" id="A4.T5.1.1.1.1">
<span class="ltx_tr" id="A4.T5.1.1.1.1.1">
<span class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="A4.T5.1.1.1.1.1.1" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="A4.T5.1.1.1.1.1.1.1">2WikiMultihopQA and Musique</span></span></span>
<span class="ltx_tr" id="A4.T5.1.1.1.1.2">
<span class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="A4.T5.1.1.1.1.2.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">Answer the question based on the given passages.
Only give me the answer and do not output any other words.</span></span>
<span class="ltx_tr" id="A4.T5.1.1.1.1.3">
<span class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="A4.T5.1.1.1.1.3.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">The following are given passages.</span></span>
<span class="ltx_tr" id="A4.T5.1.1.1.1.4">
<span class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="A4.T5.1.1.1.1.4.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">{<span class="ltx_text ltx_font_bold" id="A4.T5.1.1.1.1.4.1.1">Prompt</span>}</span></span>
<span class="ltx_tr" id="A4.T5.1.1.1.1.5">
<span class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="A4.T5.1.1.1.1.5.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">Answer the question based on the given passages.
Only give me the answer and do not output any other words.</span></span>
<span class="ltx_tr" id="A4.T5.1.1.1.1.6">
<span class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="A4.T5.1.1.1.1.6.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">Question: {<span class="ltx_text ltx_font_bold" id="A4.T5.1.1.1.1.6.1.1">Question</span>}</span></span>
<span class="ltx_tr" id="A4.T5.1.1.1.1.7">
<span class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="A4.T5.1.1.1.1.7.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">Answer:</span></span>
<span class="ltx_tr" id="A4.T5.1.1.1.1.8">
<span class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="A4.T5.1.1.1.1.8.1" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="A4.T5.1.1.1.1.8.1.1">TREC</span></span></span>
<span class="ltx_tr" id="A4.T5.1.1.1.1.9">
<span class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="A4.T5.1.1.1.1.9.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">Please determine the type of the question below.
Here are some examples of questions.</span></span>
<span class="ltx_tr" id="A4.T5.1.1.1.1.10">
<span class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="A4.T5.1.1.1.1.10.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">{<span class="ltx_text ltx_font_bold" id="A4.T5.1.1.1.1.10.1.1">Prompt</span>}</span></span>
<span class="ltx_tr" id="A4.T5.1.1.1.1.11">
<span class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="A4.T5.1.1.1.1.11.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">{<span class="ltx_text ltx_font_bold" id="A4.T5.1.1.1.1.11.1.1">Question</span>}</span></span>
<span class="ltx_tr" id="A4.T5.1.1.1.1.12">
<span class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="A4.T5.1.1.1.1.12.1" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="A4.T5.1.1.1.1.12.1.1">SAMSum</span></span></span>
<span class="ltx_tr" id="A4.T5.1.1.1.1.13">
<span class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="A4.T5.1.1.1.1.13.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">Summarize the dialogue into a few short sentences.
The following are some examples.</span></span>
<span class="ltx_tr" id="A4.T5.1.1.1.1.14">
<span class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="A4.T5.1.1.1.1.14.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">{<span class="ltx_text ltx_font_bold" id="A4.T5.1.1.1.1.14.1.1">Prompt</span>}</span></span>
<span class="ltx_tr" id="A4.T5.1.1.1.1.15">
<span class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="A4.T5.1.1.1.1.15.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">{<span class="ltx_text ltx_font_bold" id="A4.T5.1.1.1.1.15.1.1">Question</span>}</span></span>
<span class="ltx_tr" id="A4.T5.1.1.1.1.16">
<span class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="A4.T5.1.1.1.1.16.1" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="A4.T5.1.1.1.1.16.1.1">TriviaQA</span></span></span>
<span class="ltx_tr" id="A4.T5.1.1.1.1.17">
<span class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="A4.T5.1.1.1.1.17.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">Answer the question based on the given passage.
Only give me the answer and do not output any other words.</span></span>
<span class="ltx_tr" id="A4.T5.1.1.1.1.18">
<span class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="A4.T5.1.1.1.1.18.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">The following are some examples.</span></span>
<span class="ltx_tr" id="A4.T5.1.1.1.1.19">
<span class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="A4.T5.1.1.1.1.19.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">{<span class="ltx_text ltx_font_bold" id="A4.T5.1.1.1.1.19.1.1">Prompt</span>}</span></span>
<span class="ltx_tr" id="A4.T5.1.1.1.1.20">
<span class="ltx_td ltx_align_left ltx_border_b ltx_border_l ltx_border_r" id="A4.T5.1.1.1.1.20.1" style="padding-top:1.5pt;padding-bottom:1.5pt;">{<span class="ltx_text ltx_font_bold" id="A4.T5.1.1.1.1.20.1.1">Question</span>}</span></span>
</span></span></p>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5: </span>Prompt template.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="A4.p1">
<p class="ltx_p" id="A4.p1.1">The prompt templates employed are similar to those proposed by <cite class="ltx_cite ltx_citemacro_cite">Bai et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib3" title="">2023</a>)</cite>, and are listed in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#A4.T5" title="Table 5 ‣ Appendix D Prompt Templates ‣ UncertaintyRAG: Span-Level Uncertainty Enhanced Long-Context Modeling for Retrieval-Augmented Generation"><span class="ltx_text ltx_ref_tag">5</span></a>.</p>
</div>
</section>
<section class="ltx_appendix" id="A5">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix E </span>Analysis of Training Data Utilization and Parameter Efficiency</h2>
<figure class="ltx_table" id="A5.T6">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="A5.T6.1" style="width:263.2pt;height:126pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<p class="ltx_p" id="A5.T6.1.1"><span class="ltx_text" id="A5.T6.1.1.1">
<span class="ltx_tabular ltx_align_middle" id="A5.T6.1.1.1.1">
<span class="ltx_tr" id="A5.T6.1.1.1.1.1">
<span class="ltx_td ltx_align_center ltx_border_tt" id="A5.T6.1.1.1.1.1.1">Model</span>
<span class="ltx_td ltx_align_center ltx_border_tt" id="A5.T6.1.1.1.1.1.2">Label</span>
<span class="ltx_td ltx_align_center ltx_border_tt" id="A5.T6.1.1.1.1.1.3">Number</span>
<span class="ltx_td ltx_align_center ltx_border_tt" id="A5.T6.1.1.1.1.1.4">Parameter Size</span></span>
<span class="ltx_tr" id="A5.T6.1.1.1.1.2">
<span class="ltx_td ltx_align_center ltx_border_t" id="A5.T6.1.1.1.1.2.1"><span class="ltx_text" id="A5.T6.1.1.1.1.2.1.1">Contriever</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A5.T6.1.1.1.1.2.2">Unlabeled</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A5.T6.1.1.1.1.2.3">-</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A5.T6.1.1.1.1.2.4">768M</span></span>
<span class="ltx_tr" id="A5.T6.1.1.1.1.3">
<span class="ltx_td ltx_align_center ltx_border_t ltx_rowspan ltx_rowspan_2" id="A5.T6.1.1.1.1.3.1"><span class="ltx_text" id="A5.T6.1.1.1.1.3.1.1">BGE-Large</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A5.T6.1.1.1.1.3.2">Unlabeled</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A5.T6.1.1.1.1.3.3">100 millions</span>
<span class="ltx_td ltx_align_center ltx_border_t ltx_rowspan ltx_rowspan_2" id="A5.T6.1.1.1.1.3.4"><span class="ltx_text" id="A5.T6.1.1.1.1.3.4.1">326M</span></span></span>
<span class="ltx_tr" id="A5.T6.1.1.1.1.4">
<span class="ltx_td ltx_align_center" id="A5.T6.1.1.1.1.4.1">Labeled</span>
<span class="ltx_td ltx_align_center" id="A5.T6.1.1.1.1.4.2">8 millions</span></span>
<span class="ltx_tr" id="A5.T6.1.1.1.1.5">
<span class="ltx_td ltx_align_center ltx_border_t" id="A5.T6.1.1.1.1.5.1"><span class="ltx_text" id="A5.T6.1.1.1.1.5.1.1">BGE-M3</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A5.T6.1.1.1.1.5.2">Unlabeled</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A5.T6.1.1.1.1.5.3">184 millions</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A5.T6.1.1.1.1.5.4">560M</span></span>
<span class="ltx_tr" id="A5.T6.1.1.1.1.6">
<span class="ltx_td ltx_align_center ltx_border_t" id="A5.T6.1.1.1.1.6.1"><span class="ltx_text" id="A5.T6.1.1.1.1.6.1.1">Dragon</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A5.T6.1.1.1.1.6.2">Unlabeled</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A5.T6.1.1.1.1.6.3">28 millions</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="A5.T6.1.1.1.1.6.4">110M</span></span>
<span class="ltx_tr" id="A5.T6.1.1.1.1.7">
<span class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="A5.T6.1.1.1.1.7.1"><span class="ltx_text" id="A5.T6.1.1.1.1.7.1.1">Ours</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="A5.T6.1.1.1.1.7.2">Unlabeled</span>
<span class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="A5.T6.1.1.1.1.7.3">7 millions</span>
<span class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="A5.T6.1.1.1.1.7.4">110M</span></span>
</span></span></p>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 6: </span>The comparison of the number of paired texts used for training.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="A5.p1">
<p class="ltx_p" id="A5.p1.1">As shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#A5.T6" title="Table 6 ‣ Appendix E Analysis of Training Data Utilization and Parameter Efficiency ‣ UncertaintyRAG: Span-Level Uncertainty Enhanced Long-Context Modeling for Retrieval-Augmented Generation"><span class="ltx_text ltx_ref_tag">6</span></a>, our method demonstrates significant advantages over baseline models in both the required training data and parameter size:</p>
</div>
<section class="ltx_paragraph" id="A5.SS0.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Reduced Training Data:</h5>
<div class="ltx_para ltx_noindent" id="A5.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="A5.SS0.SSS0.Px1.p1.1">While baseline models such as BGE-Large and BGE-M3 require hundreds of millions of paired texts (100 million and 184 million, respectively), our method only necessitates <span class="ltx_text ltx_font_bold" id="A5.SS0.SSS0.Px1.p1.1.1">7 million</span> paired texts. This efficiency allows for effective training even in scenarios with limited data availability.</p>
</div>
</section>
<section class="ltx_paragraph" id="A5.SS0.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Compact Parameter Size:</h5>
<div class="ltx_para ltx_noindent" id="A5.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="A5.SS0.SSS0.Px2.p1.1">Our model maintains a parameter size of <span class="ltx_text ltx_font_bold" id="A5.SS0.SSS0.Px2.p1.1.1">110 million</span>, comparable to Dragon, which also has the same parameter count but requires <span class="ltx_text ltx_font_bold" id="A5.SS0.SSS0.Px2.p1.1.2">28 million</span> paired texts for training. In contrast, other baseline models like Contriever and BGE-Large have significantly larger parameter sizes (768 million and 326 million, respectively), which may lead to increased computational resource requirements and longer training times.</p>
</div>
<div class="ltx_para ltx_noindent" id="A5.SS0.SSS0.Px2.p2">
<p class="ltx_p" id="A5.SS0.SSS0.Px2.p2.1">In summary, our method demonstrates superior efficiency in training data utilization and parameter scaling compared to baseline models, facilitating broader application in scenarios with limited labeled data.</p>
</div>
</section>
</section>
<section class="ltx_appendix" id="A6">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix F </span>Formulations for Different Approaches to Modeling Uncertainty</h2>
<figure class="ltx_table" id="A6.T7">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="A6.T7.5">
<tr class="ltx_tr" id="A6.T7.5.6">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A6.T7.5.6.1" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="A6.T7.5.6.1.1">Method</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T7.5.6.2" style="padding-top:1.5pt;padding-bottom:1.5pt;"><span class="ltx_text ltx_font_bold" id="A6.T7.5.6.2.1">Formula</span></td>
</tr>
<tr class="ltx_tr" id="A6.T7.1.1">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A6.T7.1.1.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">Minimum</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T7.1.1.1" style="padding-top:1.5pt;padding-bottom:1.5pt;"><math alttext="u=-\log(\min(z_{1},z_{2},\ldots,z_{n}))" class="ltx_Math" display="inline" id="A6.T7.1.1.1.m1.4"><semantics id="A6.T7.1.1.1.m1.4a"><mrow id="A6.T7.1.1.1.m1.4.4" xref="A6.T7.1.1.1.m1.4.4.cmml"><mi id="A6.T7.1.1.1.m1.4.4.3" xref="A6.T7.1.1.1.m1.4.4.3.cmml">u</mi><mo id="A6.T7.1.1.1.m1.4.4.2" xref="A6.T7.1.1.1.m1.4.4.2.cmml">=</mo><mrow id="A6.T7.1.1.1.m1.4.4.1" xref="A6.T7.1.1.1.m1.4.4.1.cmml"><mo id="A6.T7.1.1.1.m1.4.4.1a" rspace="0.167em" xref="A6.T7.1.1.1.m1.4.4.1.cmml">−</mo><mrow id="A6.T7.1.1.1.m1.4.4.1.1.1" xref="A6.T7.1.1.1.m1.4.4.1.1.2.cmml"><mi id="A6.T7.1.1.1.m1.3.3" xref="A6.T7.1.1.1.m1.3.3.cmml">log</mi><mo id="A6.T7.1.1.1.m1.4.4.1.1.1a" xref="A6.T7.1.1.1.m1.4.4.1.1.2.cmml">⁡</mo><mrow id="A6.T7.1.1.1.m1.4.4.1.1.1.1" xref="A6.T7.1.1.1.m1.4.4.1.1.2.cmml"><mo id="A6.T7.1.1.1.m1.4.4.1.1.1.1.2" stretchy="false" xref="A6.T7.1.1.1.m1.4.4.1.1.2.cmml">(</mo><mrow id="A6.T7.1.1.1.m1.4.4.1.1.1.1.1.3" xref="A6.T7.1.1.1.m1.4.4.1.1.1.1.1.4.cmml"><mi id="A6.T7.1.1.1.m1.1.1" xref="A6.T7.1.1.1.m1.1.1.cmml">min</mi><mo id="A6.T7.1.1.1.m1.4.4.1.1.1.1.1.3a" xref="A6.T7.1.1.1.m1.4.4.1.1.1.1.1.4.cmml">⁡</mo><mrow id="A6.T7.1.1.1.m1.4.4.1.1.1.1.1.3.3" xref="A6.T7.1.1.1.m1.4.4.1.1.1.1.1.4.cmml"><mo id="A6.T7.1.1.1.m1.4.4.1.1.1.1.1.3.3.4" stretchy="false" xref="A6.T7.1.1.1.m1.4.4.1.1.1.1.1.4.cmml">(</mo><msub id="A6.T7.1.1.1.m1.4.4.1.1.1.1.1.1.1.1" xref="A6.T7.1.1.1.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mi id="A6.T7.1.1.1.m1.4.4.1.1.1.1.1.1.1.1.2" xref="A6.T7.1.1.1.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">z</mi><mn id="A6.T7.1.1.1.m1.4.4.1.1.1.1.1.1.1.1.3" xref="A6.T7.1.1.1.m1.4.4.1.1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="A6.T7.1.1.1.m1.4.4.1.1.1.1.1.3.3.5" xref="A6.T7.1.1.1.m1.4.4.1.1.1.1.1.4.cmml">,</mo><msub id="A6.T7.1.1.1.m1.4.4.1.1.1.1.1.2.2.2" xref="A6.T7.1.1.1.m1.4.4.1.1.1.1.1.2.2.2.cmml"><mi id="A6.T7.1.1.1.m1.4.4.1.1.1.1.1.2.2.2.2" xref="A6.T7.1.1.1.m1.4.4.1.1.1.1.1.2.2.2.2.cmml">z</mi><mn id="A6.T7.1.1.1.m1.4.4.1.1.1.1.1.2.2.2.3" xref="A6.T7.1.1.1.m1.4.4.1.1.1.1.1.2.2.2.3.cmml">2</mn></msub><mo id="A6.T7.1.1.1.m1.4.4.1.1.1.1.1.3.3.6" xref="A6.T7.1.1.1.m1.4.4.1.1.1.1.1.4.cmml">,</mo><mi id="A6.T7.1.1.1.m1.2.2" mathvariant="normal" xref="A6.T7.1.1.1.m1.2.2.cmml">…</mi><mo id="A6.T7.1.1.1.m1.4.4.1.1.1.1.1.3.3.7" xref="A6.T7.1.1.1.m1.4.4.1.1.1.1.1.4.cmml">,</mo><msub id="A6.T7.1.1.1.m1.4.4.1.1.1.1.1.3.3.3" xref="A6.T7.1.1.1.m1.4.4.1.1.1.1.1.3.3.3.cmml"><mi id="A6.T7.1.1.1.m1.4.4.1.1.1.1.1.3.3.3.2" xref="A6.T7.1.1.1.m1.4.4.1.1.1.1.1.3.3.3.2.cmml">z</mi><mi id="A6.T7.1.1.1.m1.4.4.1.1.1.1.1.3.3.3.3" xref="A6.T7.1.1.1.m1.4.4.1.1.1.1.1.3.3.3.3.cmml">n</mi></msub><mo id="A6.T7.1.1.1.m1.4.4.1.1.1.1.1.3.3.8" stretchy="false" xref="A6.T7.1.1.1.m1.4.4.1.1.1.1.1.4.cmml">)</mo></mrow></mrow><mo id="A6.T7.1.1.1.m1.4.4.1.1.1.1.3" stretchy="false" xref="A6.T7.1.1.1.m1.4.4.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A6.T7.1.1.1.m1.4b"><apply id="A6.T7.1.1.1.m1.4.4.cmml" xref="A6.T7.1.1.1.m1.4.4"><eq id="A6.T7.1.1.1.m1.4.4.2.cmml" xref="A6.T7.1.1.1.m1.4.4.2"></eq><ci id="A6.T7.1.1.1.m1.4.4.3.cmml" xref="A6.T7.1.1.1.m1.4.4.3">𝑢</ci><apply id="A6.T7.1.1.1.m1.4.4.1.cmml" xref="A6.T7.1.1.1.m1.4.4.1"><minus id="A6.T7.1.1.1.m1.4.4.1.2.cmml" xref="A6.T7.1.1.1.m1.4.4.1"></minus><apply id="A6.T7.1.1.1.m1.4.4.1.1.2.cmml" xref="A6.T7.1.1.1.m1.4.4.1.1.1"><log id="A6.T7.1.1.1.m1.3.3.cmml" xref="A6.T7.1.1.1.m1.3.3"></log><apply id="A6.T7.1.1.1.m1.4.4.1.1.1.1.1.4.cmml" xref="A6.T7.1.1.1.m1.4.4.1.1.1.1.1.3"><min id="A6.T7.1.1.1.m1.1.1.cmml" xref="A6.T7.1.1.1.m1.1.1"></min><apply id="A6.T7.1.1.1.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="A6.T7.1.1.1.m1.4.4.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A6.T7.1.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="A6.T7.1.1.1.m1.4.4.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A6.T7.1.1.1.m1.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="A6.T7.1.1.1.m1.4.4.1.1.1.1.1.1.1.1.2">𝑧</ci><cn id="A6.T7.1.1.1.m1.4.4.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="A6.T7.1.1.1.m1.4.4.1.1.1.1.1.1.1.1.3">1</cn></apply><apply id="A6.T7.1.1.1.m1.4.4.1.1.1.1.1.2.2.2.cmml" xref="A6.T7.1.1.1.m1.4.4.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A6.T7.1.1.1.m1.4.4.1.1.1.1.1.2.2.2.1.cmml" xref="A6.T7.1.1.1.m1.4.4.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="A6.T7.1.1.1.m1.4.4.1.1.1.1.1.2.2.2.2.cmml" xref="A6.T7.1.1.1.m1.4.4.1.1.1.1.1.2.2.2.2">𝑧</ci><cn id="A6.T7.1.1.1.m1.4.4.1.1.1.1.1.2.2.2.3.cmml" type="integer" xref="A6.T7.1.1.1.m1.4.4.1.1.1.1.1.2.2.2.3">2</cn></apply><ci id="A6.T7.1.1.1.m1.2.2.cmml" xref="A6.T7.1.1.1.m1.2.2">…</ci><apply id="A6.T7.1.1.1.m1.4.4.1.1.1.1.1.3.3.3.cmml" xref="A6.T7.1.1.1.m1.4.4.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="A6.T7.1.1.1.m1.4.4.1.1.1.1.1.3.3.3.1.cmml" xref="A6.T7.1.1.1.m1.4.4.1.1.1.1.1.3.3.3">subscript</csymbol><ci id="A6.T7.1.1.1.m1.4.4.1.1.1.1.1.3.3.3.2.cmml" xref="A6.T7.1.1.1.m1.4.4.1.1.1.1.1.3.3.3.2">𝑧</ci><ci id="A6.T7.1.1.1.m1.4.4.1.1.1.1.1.3.3.3.3.cmml" xref="A6.T7.1.1.1.m1.4.4.1.1.1.1.1.3.3.3.3">𝑛</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.T7.1.1.1.m1.4c">u=-\log(\min(z_{1},z_{2},\ldots,z_{n}))</annotation><annotation encoding="application/x-llamapun" id="A6.T7.1.1.1.m1.4d">italic_u = - roman_log ( roman_min ( italic_z start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_z start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_z start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ) )</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A6.T7.2.2">
<td class="ltx_td ltx_align_center ltx_border_r" id="A6.T7.2.2.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">Average</td>
<td class="ltx_td ltx_align_center" id="A6.T7.2.2.1" style="padding-top:1.5pt;padding-bottom:1.5pt;"><math alttext="u=-\log(\text{Avg}(z_{1},z_{2},\ldots,z_{n}))" class="ltx_Math" display="inline" id="A6.T7.2.2.1.m1.3"><semantics id="A6.T7.2.2.1.m1.3a"><mrow id="A6.T7.2.2.1.m1.3.3" xref="A6.T7.2.2.1.m1.3.3.cmml"><mi id="A6.T7.2.2.1.m1.3.3.3" xref="A6.T7.2.2.1.m1.3.3.3.cmml">u</mi><mo id="A6.T7.2.2.1.m1.3.3.2" xref="A6.T7.2.2.1.m1.3.3.2.cmml">=</mo><mrow id="A6.T7.2.2.1.m1.3.3.1" xref="A6.T7.2.2.1.m1.3.3.1.cmml"><mo id="A6.T7.2.2.1.m1.3.3.1a" rspace="0.167em" xref="A6.T7.2.2.1.m1.3.3.1.cmml">−</mo><mrow id="A6.T7.2.2.1.m1.3.3.1.1.1" xref="A6.T7.2.2.1.m1.3.3.1.1.2.cmml"><mi id="A6.T7.2.2.1.m1.2.2" xref="A6.T7.2.2.1.m1.2.2.cmml">log</mi><mo id="A6.T7.2.2.1.m1.3.3.1.1.1a" xref="A6.T7.2.2.1.m1.3.3.1.1.2.cmml">⁡</mo><mrow id="A6.T7.2.2.1.m1.3.3.1.1.1.1" xref="A6.T7.2.2.1.m1.3.3.1.1.2.cmml"><mo id="A6.T7.2.2.1.m1.3.3.1.1.1.1.2" stretchy="false" xref="A6.T7.2.2.1.m1.3.3.1.1.2.cmml">(</mo><mrow id="A6.T7.2.2.1.m1.3.3.1.1.1.1.1" xref="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.cmml"><mtext id="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.5" xref="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.5a.cmml">Avg</mtext><mo id="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.4" xref="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.4.cmml">⁢</mo><mrow id="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.3.3" xref="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.3.4.cmml"><mo id="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.3.3.4" stretchy="false" xref="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.3.4.cmml">(</mo><msub id="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.1.1.1" xref="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mi id="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.1.1.1.2" xref="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">z</mi><mn id="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.1.1.1.3" xref="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.3.3.5" xref="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.3.4.cmml">,</mo><msub id="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.2.2.2" xref="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.2.2.2.cmml"><mi id="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.2.2.2.2" xref="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.2.2.2.2.cmml">z</mi><mn id="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.2.2.2.3" xref="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.2.2.2.3.cmml">2</mn></msub><mo id="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.3.3.6" xref="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.3.4.cmml">,</mo><mi id="A6.T7.2.2.1.m1.1.1" mathvariant="normal" xref="A6.T7.2.2.1.m1.1.1.cmml">…</mi><mo id="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.3.3.7" xref="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.3.4.cmml">,</mo><msub id="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.3.3.3" xref="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.3.3.3.cmml"><mi id="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.3.3.3.2" xref="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.3.3.3.2.cmml">z</mi><mi id="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.3.3.3.3" xref="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.3.3.3.3.cmml">n</mi></msub><mo id="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.3.3.8" stretchy="false" xref="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.3.4.cmml">)</mo></mrow></mrow><mo id="A6.T7.2.2.1.m1.3.3.1.1.1.1.3" stretchy="false" xref="A6.T7.2.2.1.m1.3.3.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A6.T7.2.2.1.m1.3b"><apply id="A6.T7.2.2.1.m1.3.3.cmml" xref="A6.T7.2.2.1.m1.3.3"><eq id="A6.T7.2.2.1.m1.3.3.2.cmml" xref="A6.T7.2.2.1.m1.3.3.2"></eq><ci id="A6.T7.2.2.1.m1.3.3.3.cmml" xref="A6.T7.2.2.1.m1.3.3.3">𝑢</ci><apply id="A6.T7.2.2.1.m1.3.3.1.cmml" xref="A6.T7.2.2.1.m1.3.3.1"><minus id="A6.T7.2.2.1.m1.3.3.1.2.cmml" xref="A6.T7.2.2.1.m1.3.3.1"></minus><apply id="A6.T7.2.2.1.m1.3.3.1.1.2.cmml" xref="A6.T7.2.2.1.m1.3.3.1.1.1"><log id="A6.T7.2.2.1.m1.2.2.cmml" xref="A6.T7.2.2.1.m1.2.2"></log><apply id="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.cmml" xref="A6.T7.2.2.1.m1.3.3.1.1.1.1.1"><times id="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.4.cmml" xref="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.4"></times><ci id="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.5a.cmml" xref="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.5"><mtext id="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.5.cmml" xref="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.5">Avg</mtext></ci><vector id="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.3.4.cmml" xref="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.3.3"><apply id="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.1.1.1.2">𝑧</ci><cn id="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.1.1.1.3">1</cn></apply><apply id="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.2.2.2.cmml" xref="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.2.2.2.1.cmml" xref="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.2.2.2.2.cmml" xref="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.2.2.2.2">𝑧</ci><cn id="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.2.2.2.3.cmml" type="integer" xref="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.2.2.2.3">2</cn></apply><ci id="A6.T7.2.2.1.m1.1.1.cmml" xref="A6.T7.2.2.1.m1.1.1">…</ci><apply id="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.3.3.3.cmml" xref="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.3.3.3.1.cmml" xref="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.3.3.3">subscript</csymbol><ci id="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.3.3.3.2.cmml" xref="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.3.3.3.2">𝑧</ci><ci id="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.3.3.3.3.cmml" xref="A6.T7.2.2.1.m1.3.3.1.1.1.1.1.3.3.3.3">𝑛</ci></apply></vector></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.T7.2.2.1.m1.3c">u=-\log(\text{Avg}(z_{1},z_{2},\ldots,z_{n}))</annotation><annotation encoding="application/x-llamapun" id="A6.T7.2.2.1.m1.3d">italic_u = - roman_log ( Avg ( italic_z start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_z start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_z start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ) )</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A6.T7.3.3">
<td class="ltx_td ltx_align_center ltx_border_r" id="A6.T7.3.3.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">Log-sum</td>
<td class="ltx_td ltx_align_center" id="A6.T7.3.3.1" style="padding-top:1.5pt;padding-bottom:1.5pt;"><math alttext="u=-\sum_{i=1}^{n}\log(z_{i})" class="ltx_Math" display="inline" id="A6.T7.3.3.1.m1.2"><semantics id="A6.T7.3.3.1.m1.2a"><mrow id="A6.T7.3.3.1.m1.2.2" xref="A6.T7.3.3.1.m1.2.2.cmml"><mi id="A6.T7.3.3.1.m1.2.2.3" xref="A6.T7.3.3.1.m1.2.2.3.cmml">u</mi><mo id="A6.T7.3.3.1.m1.2.2.2" xref="A6.T7.3.3.1.m1.2.2.2.cmml">=</mo><mrow id="A6.T7.3.3.1.m1.2.2.1" xref="A6.T7.3.3.1.m1.2.2.1.cmml"><mo id="A6.T7.3.3.1.m1.2.2.1a" xref="A6.T7.3.3.1.m1.2.2.1.cmml">−</mo><mrow id="A6.T7.3.3.1.m1.2.2.1.1" xref="A6.T7.3.3.1.m1.2.2.1.1.cmml"><msubsup id="A6.T7.3.3.1.m1.2.2.1.1.2" xref="A6.T7.3.3.1.m1.2.2.1.1.2.cmml"><mo id="A6.T7.3.3.1.m1.2.2.1.1.2.2.2" xref="A6.T7.3.3.1.m1.2.2.1.1.2.2.2.cmml">∑</mo><mrow id="A6.T7.3.3.1.m1.2.2.1.1.2.2.3" xref="A6.T7.3.3.1.m1.2.2.1.1.2.2.3.cmml"><mi id="A6.T7.3.3.1.m1.2.2.1.1.2.2.3.2" xref="A6.T7.3.3.1.m1.2.2.1.1.2.2.3.2.cmml">i</mi><mo id="A6.T7.3.3.1.m1.2.2.1.1.2.2.3.1" xref="A6.T7.3.3.1.m1.2.2.1.1.2.2.3.1.cmml">=</mo><mn id="A6.T7.3.3.1.m1.2.2.1.1.2.2.3.3" xref="A6.T7.3.3.1.m1.2.2.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="A6.T7.3.3.1.m1.2.2.1.1.2.3" xref="A6.T7.3.3.1.m1.2.2.1.1.2.3.cmml">n</mi></msubsup><mrow id="A6.T7.3.3.1.m1.2.2.1.1.1.1" xref="A6.T7.3.3.1.m1.2.2.1.1.1.2.cmml"><mi id="A6.T7.3.3.1.m1.1.1" xref="A6.T7.3.3.1.m1.1.1.cmml">log</mi><mo id="A6.T7.3.3.1.m1.2.2.1.1.1.1a" xref="A6.T7.3.3.1.m1.2.2.1.1.1.2.cmml">⁡</mo><mrow id="A6.T7.3.3.1.m1.2.2.1.1.1.1.1" xref="A6.T7.3.3.1.m1.2.2.1.1.1.2.cmml"><mo id="A6.T7.3.3.1.m1.2.2.1.1.1.1.1.2" stretchy="false" xref="A6.T7.3.3.1.m1.2.2.1.1.1.2.cmml">(</mo><msub id="A6.T7.3.3.1.m1.2.2.1.1.1.1.1.1" xref="A6.T7.3.3.1.m1.2.2.1.1.1.1.1.1.cmml"><mi id="A6.T7.3.3.1.m1.2.2.1.1.1.1.1.1.2" xref="A6.T7.3.3.1.m1.2.2.1.1.1.1.1.1.2.cmml">z</mi><mi id="A6.T7.3.3.1.m1.2.2.1.1.1.1.1.1.3" xref="A6.T7.3.3.1.m1.2.2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A6.T7.3.3.1.m1.2.2.1.1.1.1.1.3" stretchy="false" xref="A6.T7.3.3.1.m1.2.2.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A6.T7.3.3.1.m1.2b"><apply id="A6.T7.3.3.1.m1.2.2.cmml" xref="A6.T7.3.3.1.m1.2.2"><eq id="A6.T7.3.3.1.m1.2.2.2.cmml" xref="A6.T7.3.3.1.m1.2.2.2"></eq><ci id="A6.T7.3.3.1.m1.2.2.3.cmml" xref="A6.T7.3.3.1.m1.2.2.3">𝑢</ci><apply id="A6.T7.3.3.1.m1.2.2.1.cmml" xref="A6.T7.3.3.1.m1.2.2.1"><minus id="A6.T7.3.3.1.m1.2.2.1.2.cmml" xref="A6.T7.3.3.1.m1.2.2.1"></minus><apply id="A6.T7.3.3.1.m1.2.2.1.1.cmml" xref="A6.T7.3.3.1.m1.2.2.1.1"><apply id="A6.T7.3.3.1.m1.2.2.1.1.2.cmml" xref="A6.T7.3.3.1.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="A6.T7.3.3.1.m1.2.2.1.1.2.1.cmml" xref="A6.T7.3.3.1.m1.2.2.1.1.2">superscript</csymbol><apply id="A6.T7.3.3.1.m1.2.2.1.1.2.2.cmml" xref="A6.T7.3.3.1.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="A6.T7.3.3.1.m1.2.2.1.1.2.2.1.cmml" xref="A6.T7.3.3.1.m1.2.2.1.1.2">subscript</csymbol><sum id="A6.T7.3.3.1.m1.2.2.1.1.2.2.2.cmml" xref="A6.T7.3.3.1.m1.2.2.1.1.2.2.2"></sum><apply id="A6.T7.3.3.1.m1.2.2.1.1.2.2.3.cmml" xref="A6.T7.3.3.1.m1.2.2.1.1.2.2.3"><eq id="A6.T7.3.3.1.m1.2.2.1.1.2.2.3.1.cmml" xref="A6.T7.3.3.1.m1.2.2.1.1.2.2.3.1"></eq><ci id="A6.T7.3.3.1.m1.2.2.1.1.2.2.3.2.cmml" xref="A6.T7.3.3.1.m1.2.2.1.1.2.2.3.2">𝑖</ci><cn id="A6.T7.3.3.1.m1.2.2.1.1.2.2.3.3.cmml" type="integer" xref="A6.T7.3.3.1.m1.2.2.1.1.2.2.3.3">1</cn></apply></apply><ci id="A6.T7.3.3.1.m1.2.2.1.1.2.3.cmml" xref="A6.T7.3.3.1.m1.2.2.1.1.2.3">𝑛</ci></apply><apply id="A6.T7.3.3.1.m1.2.2.1.1.1.2.cmml" xref="A6.T7.3.3.1.m1.2.2.1.1.1.1"><log id="A6.T7.3.3.1.m1.1.1.cmml" xref="A6.T7.3.3.1.m1.1.1"></log><apply id="A6.T7.3.3.1.m1.2.2.1.1.1.1.1.1.cmml" xref="A6.T7.3.3.1.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A6.T7.3.3.1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="A6.T7.3.3.1.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="A6.T7.3.3.1.m1.2.2.1.1.1.1.1.1.2.cmml" xref="A6.T7.3.3.1.m1.2.2.1.1.1.1.1.1.2">𝑧</ci><ci id="A6.T7.3.3.1.m1.2.2.1.1.1.1.1.1.3.cmml" xref="A6.T7.3.3.1.m1.2.2.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.T7.3.3.1.m1.2c">u=-\sum_{i=1}^{n}\log(z_{i})</annotation><annotation encoding="application/x-llamapun" id="A6.T7.3.3.1.m1.2d">italic_u = - ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT roman_log ( italic_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A6.T7.4.4">
<td class="ltx_td ltx_align_center ltx_border_r" id="A6.T7.4.4.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">Entropy</td>
<td class="ltx_td ltx_align_center" id="A6.T7.4.4.1" style="padding-top:1.5pt;padding-bottom:1.5pt;"><math alttext="u=-\sum_{i=1}^{n}z_{i}\cdot\log(z_{i})" class="ltx_Math" display="inline" id="A6.T7.4.4.1.m1.2"><semantics id="A6.T7.4.4.1.m1.2a"><mrow id="A6.T7.4.4.1.m1.2.2" xref="A6.T7.4.4.1.m1.2.2.cmml"><mi id="A6.T7.4.4.1.m1.2.2.3" xref="A6.T7.4.4.1.m1.2.2.3.cmml">u</mi><mo id="A6.T7.4.4.1.m1.2.2.2" xref="A6.T7.4.4.1.m1.2.2.2.cmml">=</mo><mrow id="A6.T7.4.4.1.m1.2.2.1" xref="A6.T7.4.4.1.m1.2.2.1.cmml"><mo id="A6.T7.4.4.1.m1.2.2.1a" xref="A6.T7.4.4.1.m1.2.2.1.cmml">−</mo><mrow id="A6.T7.4.4.1.m1.2.2.1.1" xref="A6.T7.4.4.1.m1.2.2.1.1.cmml"><msubsup id="A6.T7.4.4.1.m1.2.2.1.1.2" xref="A6.T7.4.4.1.m1.2.2.1.1.2.cmml"><mo id="A6.T7.4.4.1.m1.2.2.1.1.2.2.2" xref="A6.T7.4.4.1.m1.2.2.1.1.2.2.2.cmml">∑</mo><mrow id="A6.T7.4.4.1.m1.2.2.1.1.2.2.3" xref="A6.T7.4.4.1.m1.2.2.1.1.2.2.3.cmml"><mi id="A6.T7.4.4.1.m1.2.2.1.1.2.2.3.2" xref="A6.T7.4.4.1.m1.2.2.1.1.2.2.3.2.cmml">i</mi><mo id="A6.T7.4.4.1.m1.2.2.1.1.2.2.3.1" xref="A6.T7.4.4.1.m1.2.2.1.1.2.2.3.1.cmml">=</mo><mn id="A6.T7.4.4.1.m1.2.2.1.1.2.2.3.3" xref="A6.T7.4.4.1.m1.2.2.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="A6.T7.4.4.1.m1.2.2.1.1.2.3" xref="A6.T7.4.4.1.m1.2.2.1.1.2.3.cmml">n</mi></msubsup><mrow id="A6.T7.4.4.1.m1.2.2.1.1.1" xref="A6.T7.4.4.1.m1.2.2.1.1.1.cmml"><msub id="A6.T7.4.4.1.m1.2.2.1.1.1.3" xref="A6.T7.4.4.1.m1.2.2.1.1.1.3.cmml"><mi id="A6.T7.4.4.1.m1.2.2.1.1.1.3.2" xref="A6.T7.4.4.1.m1.2.2.1.1.1.3.2.cmml">z</mi><mi id="A6.T7.4.4.1.m1.2.2.1.1.1.3.3" xref="A6.T7.4.4.1.m1.2.2.1.1.1.3.3.cmml">i</mi></msub><mo id="A6.T7.4.4.1.m1.2.2.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="A6.T7.4.4.1.m1.2.2.1.1.1.2.cmml">⋅</mo><mrow id="A6.T7.4.4.1.m1.2.2.1.1.1.1.1" xref="A6.T7.4.4.1.m1.2.2.1.1.1.1.2.cmml"><mi id="A6.T7.4.4.1.m1.1.1" xref="A6.T7.4.4.1.m1.1.1.cmml">log</mi><mo id="A6.T7.4.4.1.m1.2.2.1.1.1.1.1a" xref="A6.T7.4.4.1.m1.2.2.1.1.1.1.2.cmml">⁡</mo><mrow id="A6.T7.4.4.1.m1.2.2.1.1.1.1.1.1" xref="A6.T7.4.4.1.m1.2.2.1.1.1.1.2.cmml"><mo id="A6.T7.4.4.1.m1.2.2.1.1.1.1.1.1.2" stretchy="false" xref="A6.T7.4.4.1.m1.2.2.1.1.1.1.2.cmml">(</mo><msub id="A6.T7.4.4.1.m1.2.2.1.1.1.1.1.1.1" xref="A6.T7.4.4.1.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="A6.T7.4.4.1.m1.2.2.1.1.1.1.1.1.1.2" xref="A6.T7.4.4.1.m1.2.2.1.1.1.1.1.1.1.2.cmml">z</mi><mi id="A6.T7.4.4.1.m1.2.2.1.1.1.1.1.1.1.3" xref="A6.T7.4.4.1.m1.2.2.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A6.T7.4.4.1.m1.2.2.1.1.1.1.1.1.3" stretchy="false" xref="A6.T7.4.4.1.m1.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A6.T7.4.4.1.m1.2b"><apply id="A6.T7.4.4.1.m1.2.2.cmml" xref="A6.T7.4.4.1.m1.2.2"><eq id="A6.T7.4.4.1.m1.2.2.2.cmml" xref="A6.T7.4.4.1.m1.2.2.2"></eq><ci id="A6.T7.4.4.1.m1.2.2.3.cmml" xref="A6.T7.4.4.1.m1.2.2.3">𝑢</ci><apply id="A6.T7.4.4.1.m1.2.2.1.cmml" xref="A6.T7.4.4.1.m1.2.2.1"><minus id="A6.T7.4.4.1.m1.2.2.1.2.cmml" xref="A6.T7.4.4.1.m1.2.2.1"></minus><apply id="A6.T7.4.4.1.m1.2.2.1.1.cmml" xref="A6.T7.4.4.1.m1.2.2.1.1"><apply id="A6.T7.4.4.1.m1.2.2.1.1.2.cmml" xref="A6.T7.4.4.1.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="A6.T7.4.4.1.m1.2.2.1.1.2.1.cmml" xref="A6.T7.4.4.1.m1.2.2.1.1.2">superscript</csymbol><apply id="A6.T7.4.4.1.m1.2.2.1.1.2.2.cmml" xref="A6.T7.4.4.1.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="A6.T7.4.4.1.m1.2.2.1.1.2.2.1.cmml" xref="A6.T7.4.4.1.m1.2.2.1.1.2">subscript</csymbol><sum id="A6.T7.4.4.1.m1.2.2.1.1.2.2.2.cmml" xref="A6.T7.4.4.1.m1.2.2.1.1.2.2.2"></sum><apply id="A6.T7.4.4.1.m1.2.2.1.1.2.2.3.cmml" xref="A6.T7.4.4.1.m1.2.2.1.1.2.2.3"><eq id="A6.T7.4.4.1.m1.2.2.1.1.2.2.3.1.cmml" xref="A6.T7.4.4.1.m1.2.2.1.1.2.2.3.1"></eq><ci id="A6.T7.4.4.1.m1.2.2.1.1.2.2.3.2.cmml" xref="A6.T7.4.4.1.m1.2.2.1.1.2.2.3.2">𝑖</ci><cn id="A6.T7.4.4.1.m1.2.2.1.1.2.2.3.3.cmml" type="integer" xref="A6.T7.4.4.1.m1.2.2.1.1.2.2.3.3">1</cn></apply></apply><ci id="A6.T7.4.4.1.m1.2.2.1.1.2.3.cmml" xref="A6.T7.4.4.1.m1.2.2.1.1.2.3">𝑛</ci></apply><apply id="A6.T7.4.4.1.m1.2.2.1.1.1.cmml" xref="A6.T7.4.4.1.m1.2.2.1.1.1"><ci id="A6.T7.4.4.1.m1.2.2.1.1.1.2.cmml" xref="A6.T7.4.4.1.m1.2.2.1.1.1.2">⋅</ci><apply id="A6.T7.4.4.1.m1.2.2.1.1.1.3.cmml" xref="A6.T7.4.4.1.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="A6.T7.4.4.1.m1.2.2.1.1.1.3.1.cmml" xref="A6.T7.4.4.1.m1.2.2.1.1.1.3">subscript</csymbol><ci id="A6.T7.4.4.1.m1.2.2.1.1.1.3.2.cmml" xref="A6.T7.4.4.1.m1.2.2.1.1.1.3.2">𝑧</ci><ci id="A6.T7.4.4.1.m1.2.2.1.1.1.3.3.cmml" xref="A6.T7.4.4.1.m1.2.2.1.1.1.3.3">𝑖</ci></apply><apply id="A6.T7.4.4.1.m1.2.2.1.1.1.1.2.cmml" xref="A6.T7.4.4.1.m1.2.2.1.1.1.1.1"><log id="A6.T7.4.4.1.m1.1.1.cmml" xref="A6.T7.4.4.1.m1.1.1"></log><apply id="A6.T7.4.4.1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="A6.T7.4.4.1.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A6.T7.4.4.1.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="A6.T7.4.4.1.m1.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="A6.T7.4.4.1.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="A6.T7.4.4.1.m1.2.2.1.1.1.1.1.1.1.2">𝑧</ci><ci id="A6.T7.4.4.1.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="A6.T7.4.4.1.m1.2.2.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.T7.4.4.1.m1.2c">u=-\sum_{i=1}^{n}z_{i}\cdot\log(z_{i})</annotation><annotation encoding="application/x-llamapun" id="A6.T7.4.4.1.m1.2d">italic_u = - ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT italic_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ⋅ roman_log ( italic_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A6.T7.5.5">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="A6.T7.5.5.2" style="padding-top:1.5pt;padding-bottom:1.5pt;">Self-information</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="A6.T7.5.5.1" style="padding-top:1.5pt;padding-bottom:1.5pt;"><math alttext="u=-\log\left(\sum_{i=1}^{n}\exp(z_{i}-z_{k})\right)" class="ltx_Math" display="inline" id="A6.T7.5.5.1.m1.3"><semantics id="A6.T7.5.5.1.m1.3a"><mrow id="A6.T7.5.5.1.m1.3.3" xref="A6.T7.5.5.1.m1.3.3.cmml"><mi id="A6.T7.5.5.1.m1.3.3.3" xref="A6.T7.5.5.1.m1.3.3.3.cmml">u</mi><mo id="A6.T7.5.5.1.m1.3.3.2" xref="A6.T7.5.5.1.m1.3.3.2.cmml">=</mo><mrow id="A6.T7.5.5.1.m1.3.3.1" xref="A6.T7.5.5.1.m1.3.3.1.cmml"><mo id="A6.T7.5.5.1.m1.3.3.1a" rspace="0.167em" xref="A6.T7.5.5.1.m1.3.3.1.cmml">−</mo><mrow id="A6.T7.5.5.1.m1.3.3.1.1.1" xref="A6.T7.5.5.1.m1.3.3.1.1.2.cmml"><mi id="A6.T7.5.5.1.m1.2.2" xref="A6.T7.5.5.1.m1.2.2.cmml">log</mi><mo id="A6.T7.5.5.1.m1.3.3.1.1.1a" xref="A6.T7.5.5.1.m1.3.3.1.1.2.cmml">⁡</mo><mrow id="A6.T7.5.5.1.m1.3.3.1.1.1.1" xref="A6.T7.5.5.1.m1.3.3.1.1.2.cmml"><mo id="A6.T7.5.5.1.m1.3.3.1.1.1.1.2" xref="A6.T7.5.5.1.m1.3.3.1.1.2.cmml">(</mo><mrow id="A6.T7.5.5.1.m1.3.3.1.1.1.1.1" xref="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.cmml"><msubsup id="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.2" xref="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.2.cmml"><mo id="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.2.2.2" lspace="0em" xref="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.2.2.3" xref="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.2.2.3.cmml"><mi id="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.2.2.3.2" xref="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.2.2.3.1" xref="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.2.2.3.3" xref="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.2.3" xref="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.2.3.cmml">n</mi></msubsup><mrow id="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.1.1" xref="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.1.2.cmml"><mi id="A6.T7.5.5.1.m1.1.1" xref="A6.T7.5.5.1.m1.1.1.cmml">exp</mi><mo id="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.1.1a" xref="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.1.1.1" xref="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.1.2.cmml"><mo id="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.1.2.cmml">(</mo><mrow id="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.1.1.1.1" xref="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><msub id="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.1.1.1.1.2" xref="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.1.1.1.1.2.2" xref="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.cmml">z</mi><mi id="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.1.1.1.1.2.3" xref="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.1.1.1.1.3" xref="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.1.1.1.1.3.2" xref="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.cmml">z</mi><mi id="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.1.1.1.1.3.3" xref="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.cmml">k</mi></msub></mrow><mo id="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="A6.T7.5.5.1.m1.3.3.1.1.1.1.3" xref="A6.T7.5.5.1.m1.3.3.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A6.T7.5.5.1.m1.3b"><apply id="A6.T7.5.5.1.m1.3.3.cmml" xref="A6.T7.5.5.1.m1.3.3"><eq id="A6.T7.5.5.1.m1.3.3.2.cmml" xref="A6.T7.5.5.1.m1.3.3.2"></eq><ci id="A6.T7.5.5.1.m1.3.3.3.cmml" xref="A6.T7.5.5.1.m1.3.3.3">𝑢</ci><apply id="A6.T7.5.5.1.m1.3.3.1.cmml" xref="A6.T7.5.5.1.m1.3.3.1"><minus id="A6.T7.5.5.1.m1.3.3.1.2.cmml" xref="A6.T7.5.5.1.m1.3.3.1"></minus><apply id="A6.T7.5.5.1.m1.3.3.1.1.2.cmml" xref="A6.T7.5.5.1.m1.3.3.1.1.1"><log id="A6.T7.5.5.1.m1.2.2.cmml" xref="A6.T7.5.5.1.m1.2.2"></log><apply id="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.cmml" xref="A6.T7.5.5.1.m1.3.3.1.1.1.1.1"><apply id="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.2.cmml" xref="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.2.1.cmml" xref="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.2">superscript</csymbol><apply id="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.2.2.cmml" xref="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.2.2.1.cmml" xref="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.2">subscript</csymbol><sum id="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.2.2.2.cmml" xref="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.2.2.2"></sum><apply id="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.2.2.3.cmml" xref="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.2.2.3"><eq id="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.2.2.3.1.cmml" xref="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.2.2.3.1"></eq><ci id="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.2.2.3.2.cmml" xref="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.2.2.3.2">𝑖</ci><cn id="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.2.3.cmml" xref="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.2.3">𝑛</ci></apply><apply id="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.1.2.cmml" xref="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.1.1"><exp id="A6.T7.5.5.1.m1.1.1.cmml" xref="A6.T7.5.5.1.m1.1.1"></exp><apply id="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.1.1.1.1"><minus id="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.1.1.1.1.1"></minus><apply id="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.1.1.1.1.2.2">𝑧</ci><ci id="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.1.1.1.1.3.2">𝑧</ci><ci id="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A6.T7.5.5.1.m1.3.3.1.1.1.1.1.1.1.1.1.3.3">𝑘</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.T7.5.5.1.m1.3c">u=-\log\left(\sum_{i=1}^{n}\exp(z_{i}-z_{k})\right)</annotation><annotation encoding="application/x-llamapun" id="A6.T7.5.5.1.m1.3d">italic_u = - roman_log ( ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT roman_exp ( italic_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT - italic_z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) )</annotation></semantics></math></td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 7: </span>Six methods of calculating the uncertainty <math alttext="u" class="ltx_Math" display="inline" id="A6.T7.12.m1.1"><semantics id="A6.T7.12.m1.1b"><mi id="A6.T7.12.m1.1.1" xref="A6.T7.12.m1.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="A6.T7.12.m1.1c"><ci id="A6.T7.12.m1.1.1.cmml" xref="A6.T7.12.m1.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.T7.12.m1.1d">u</annotation><annotation encoding="application/x-llamapun" id="A6.T7.12.m1.1e">italic_u</annotation></semantics></math> of a free form output of length <math alttext="n" class="ltx_Math" display="inline" id="A6.T7.13.m2.1"><semantics id="A6.T7.13.m2.1b"><mi id="A6.T7.13.m2.1.1" xref="A6.T7.13.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="A6.T7.13.m2.1c"><ci id="A6.T7.13.m2.1.1.cmml" xref="A6.T7.13.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.T7.13.m2.1d">n</annotation><annotation encoding="application/x-llamapun" id="A6.T7.13.m2.1e">italic_n</annotation></semantics></math>. <math alttext="z_{i}" class="ltx_Math" display="inline" id="A6.T7.14.m3.1"><semantics id="A6.T7.14.m3.1b"><msub id="A6.T7.14.m3.1.1" xref="A6.T7.14.m3.1.1.cmml"><mi id="A6.T7.14.m3.1.1.2" xref="A6.T7.14.m3.1.1.2.cmml">z</mi><mi id="A6.T7.14.m3.1.1.3" xref="A6.T7.14.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A6.T7.14.m3.1c"><apply id="A6.T7.14.m3.1.1.cmml" xref="A6.T7.14.m3.1.1"><csymbol cd="ambiguous" id="A6.T7.14.m3.1.1.1.cmml" xref="A6.T7.14.m3.1.1">subscript</csymbol><ci id="A6.T7.14.m3.1.1.2.cmml" xref="A6.T7.14.m3.1.1.2">𝑧</ci><ci id="A6.T7.14.m3.1.1.3.cmml" xref="A6.T7.14.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.T7.14.m3.1d">z_{i}</annotation><annotation encoding="application/x-llamapun" id="A6.T7.14.m3.1e">italic_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is a conditional probability with respect to <math alttext="p(x_{i}\mid x_{i-1},\dots,x_{0})" class="ltx_Math" display="inline" id="A6.T7.15.m4.2"><semantics id="A6.T7.15.m4.2b"><mrow id="A6.T7.15.m4.2.2" xref="A6.T7.15.m4.2.2.cmml"><mi id="A6.T7.15.m4.2.2.3" xref="A6.T7.15.m4.2.2.3.cmml">p</mi><mo id="A6.T7.15.m4.2.2.2" xref="A6.T7.15.m4.2.2.2.cmml">⁢</mo><mrow id="A6.T7.15.m4.2.2.1.1" xref="A6.T7.15.m4.2.2.1.1.1.cmml"><mo id="A6.T7.15.m4.2.2.1.1.2" stretchy="false" xref="A6.T7.15.m4.2.2.1.1.1.cmml">(</mo><mrow id="A6.T7.15.m4.2.2.1.1.1" xref="A6.T7.15.m4.2.2.1.1.1.cmml"><msub id="A6.T7.15.m4.2.2.1.1.1.4" xref="A6.T7.15.m4.2.2.1.1.1.4.cmml"><mi id="A6.T7.15.m4.2.2.1.1.1.4.2" xref="A6.T7.15.m4.2.2.1.1.1.4.2.cmml">x</mi><mi id="A6.T7.15.m4.2.2.1.1.1.4.3" xref="A6.T7.15.m4.2.2.1.1.1.4.3.cmml">i</mi></msub><mo id="A6.T7.15.m4.2.2.1.1.1.3" xref="A6.T7.15.m4.2.2.1.1.1.3.cmml">∣</mo><mrow id="A6.T7.15.m4.2.2.1.1.1.2.2" xref="A6.T7.15.m4.2.2.1.1.1.2.3.cmml"><msub id="A6.T7.15.m4.2.2.1.1.1.1.1.1" xref="A6.T7.15.m4.2.2.1.1.1.1.1.1.cmml"><mi id="A6.T7.15.m4.2.2.1.1.1.1.1.1.2" xref="A6.T7.15.m4.2.2.1.1.1.1.1.1.2.cmml">x</mi><mrow id="A6.T7.15.m4.2.2.1.1.1.1.1.1.3" xref="A6.T7.15.m4.2.2.1.1.1.1.1.1.3.cmml"><mi id="A6.T7.15.m4.2.2.1.1.1.1.1.1.3.2" xref="A6.T7.15.m4.2.2.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="A6.T7.15.m4.2.2.1.1.1.1.1.1.3.1" xref="A6.T7.15.m4.2.2.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="A6.T7.15.m4.2.2.1.1.1.1.1.1.3.3" xref="A6.T7.15.m4.2.2.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="A6.T7.15.m4.2.2.1.1.1.2.2.3" xref="A6.T7.15.m4.2.2.1.1.1.2.3.cmml">,</mo><mi id="A6.T7.15.m4.1.1" mathvariant="normal" xref="A6.T7.15.m4.1.1.cmml">…</mi><mo id="A6.T7.15.m4.2.2.1.1.1.2.2.4" xref="A6.T7.15.m4.2.2.1.1.1.2.3.cmml">,</mo><msub id="A6.T7.15.m4.2.2.1.1.1.2.2.2" xref="A6.T7.15.m4.2.2.1.1.1.2.2.2.cmml"><mi id="A6.T7.15.m4.2.2.1.1.1.2.2.2.2" xref="A6.T7.15.m4.2.2.1.1.1.2.2.2.2.cmml">x</mi><mn id="A6.T7.15.m4.2.2.1.1.1.2.2.2.3" xref="A6.T7.15.m4.2.2.1.1.1.2.2.2.3.cmml">0</mn></msub></mrow></mrow><mo id="A6.T7.15.m4.2.2.1.1.3" stretchy="false" xref="A6.T7.15.m4.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A6.T7.15.m4.2c"><apply id="A6.T7.15.m4.2.2.cmml" xref="A6.T7.15.m4.2.2"><times id="A6.T7.15.m4.2.2.2.cmml" xref="A6.T7.15.m4.2.2.2"></times><ci id="A6.T7.15.m4.2.2.3.cmml" xref="A6.T7.15.m4.2.2.3">𝑝</ci><apply id="A6.T7.15.m4.2.2.1.1.1.cmml" xref="A6.T7.15.m4.2.2.1.1"><csymbol cd="latexml" id="A6.T7.15.m4.2.2.1.1.1.3.cmml" xref="A6.T7.15.m4.2.2.1.1.1.3">conditional</csymbol><apply id="A6.T7.15.m4.2.2.1.1.1.4.cmml" xref="A6.T7.15.m4.2.2.1.1.1.4"><csymbol cd="ambiguous" id="A6.T7.15.m4.2.2.1.1.1.4.1.cmml" xref="A6.T7.15.m4.2.2.1.1.1.4">subscript</csymbol><ci id="A6.T7.15.m4.2.2.1.1.1.4.2.cmml" xref="A6.T7.15.m4.2.2.1.1.1.4.2">𝑥</ci><ci id="A6.T7.15.m4.2.2.1.1.1.4.3.cmml" xref="A6.T7.15.m4.2.2.1.1.1.4.3">𝑖</ci></apply><list id="A6.T7.15.m4.2.2.1.1.1.2.3.cmml" xref="A6.T7.15.m4.2.2.1.1.1.2.2"><apply id="A6.T7.15.m4.2.2.1.1.1.1.1.1.cmml" xref="A6.T7.15.m4.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A6.T7.15.m4.2.2.1.1.1.1.1.1.1.cmml" xref="A6.T7.15.m4.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="A6.T7.15.m4.2.2.1.1.1.1.1.1.2.cmml" xref="A6.T7.15.m4.2.2.1.1.1.1.1.1.2">𝑥</ci><apply id="A6.T7.15.m4.2.2.1.1.1.1.1.1.3.cmml" xref="A6.T7.15.m4.2.2.1.1.1.1.1.1.3"><minus id="A6.T7.15.m4.2.2.1.1.1.1.1.1.3.1.cmml" xref="A6.T7.15.m4.2.2.1.1.1.1.1.1.3.1"></minus><ci id="A6.T7.15.m4.2.2.1.1.1.1.1.1.3.2.cmml" xref="A6.T7.15.m4.2.2.1.1.1.1.1.1.3.2">𝑖</ci><cn id="A6.T7.15.m4.2.2.1.1.1.1.1.1.3.3.cmml" type="integer" xref="A6.T7.15.m4.2.2.1.1.1.1.1.1.3.3">1</cn></apply></apply><ci id="A6.T7.15.m4.1.1.cmml" xref="A6.T7.15.m4.1.1">…</ci><apply id="A6.T7.15.m4.2.2.1.1.1.2.2.2.cmml" xref="A6.T7.15.m4.2.2.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A6.T7.15.m4.2.2.1.1.1.2.2.2.1.cmml" xref="A6.T7.15.m4.2.2.1.1.1.2.2.2">subscript</csymbol><ci id="A6.T7.15.m4.2.2.1.1.1.2.2.2.2.cmml" xref="A6.T7.15.m4.2.2.1.1.1.2.2.2.2">𝑥</ci><cn id="A6.T7.15.m4.2.2.1.1.1.2.2.2.3.cmml" type="integer" xref="A6.T7.15.m4.2.2.1.1.1.2.2.2.3">0</cn></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.T7.15.m4.2d">p(x_{i}\mid x_{i-1},\dots,x_{0})</annotation><annotation encoding="application/x-llamapun" id="A6.T7.15.m4.2e">italic_p ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∣ italic_x start_POSTSUBSCRIPT italic_i - 1 end_POSTSUBSCRIPT , … , italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT )</annotation></semantics></math>. In the table, <math alttext="i" class="ltx_Math" display="inline" id="A6.T7.16.m5.1"><semantics id="A6.T7.16.m5.1b"><mi id="A6.T7.16.m5.1.1" xref="A6.T7.16.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A6.T7.16.m5.1c"><ci id="A6.T7.16.m5.1.1.cmml" xref="A6.T7.16.m5.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.T7.16.m5.1d">i</annotation><annotation encoding="application/x-llamapun" id="A6.T7.16.m5.1e">italic_i</annotation></semantics></math> represents the current token at the <math alttext="i-th" class="ltx_Math" display="inline" id="A6.T7.17.m6.1"><semantics id="A6.T7.17.m6.1b"><mrow id="A6.T7.17.m6.1.1" xref="A6.T7.17.m6.1.1.cmml"><mi id="A6.T7.17.m6.1.1.2" xref="A6.T7.17.m6.1.1.2.cmml">i</mi><mo id="A6.T7.17.m6.1.1.1" xref="A6.T7.17.m6.1.1.1.cmml">−</mo><mrow id="A6.T7.17.m6.1.1.3" xref="A6.T7.17.m6.1.1.3.cmml"><mi id="A6.T7.17.m6.1.1.3.2" xref="A6.T7.17.m6.1.1.3.2.cmml">t</mi><mo id="A6.T7.17.m6.1.1.3.1" xref="A6.T7.17.m6.1.1.3.1.cmml">⁢</mo><mi id="A6.T7.17.m6.1.1.3.3" xref="A6.T7.17.m6.1.1.3.3.cmml">h</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A6.T7.17.m6.1c"><apply id="A6.T7.17.m6.1.1.cmml" xref="A6.T7.17.m6.1.1"><minus id="A6.T7.17.m6.1.1.1.cmml" xref="A6.T7.17.m6.1.1.1"></minus><ci id="A6.T7.17.m6.1.1.2.cmml" xref="A6.T7.17.m6.1.1.2">𝑖</ci><apply id="A6.T7.17.m6.1.1.3.cmml" xref="A6.T7.17.m6.1.1.3"><times id="A6.T7.17.m6.1.1.3.1.cmml" xref="A6.T7.17.m6.1.1.3.1"></times><ci id="A6.T7.17.m6.1.1.3.2.cmml" xref="A6.T7.17.m6.1.1.3.2">𝑡</ci><ci id="A6.T7.17.m6.1.1.3.3.cmml" xref="A6.T7.17.m6.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.T7.17.m6.1d">i-th</annotation><annotation encoding="application/x-llamapun" id="A6.T7.17.m6.1e">italic_i - italic_t italic_h</annotation></semantics></math> position in the vocabulary.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="A6.p1">
<p class="ltx_p" id="A6.p1.1">In this section, we present several different methods for uncertainty modeling, with specific formulations shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#A6.T7" title="Table 7 ‣ Appendix F Formulations for Different Approaches to Modeling Uncertainty ‣ UncertaintyRAG: Span-Level Uncertainty Enhanced Long-Context Modeling for Retrieval-Augmented Generation"><span class="ltx_text ltx_ref_tag">7</span></a>. Each method provides unique insights into quantifying uncertainty, which is crucial for improving model robustness and decision-making in complex scenarios.</p>
</div>
</section>
<section class="ltx_appendix" id="A7">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix G </span>Pipeline of Uncertainty Calibration Evaluation</h2>
<figure class="ltx_figure" id="A7.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="302" id="A7.F6.g1" src="extracted/5899423/ICLR_2025_Template/figure/uncertainty_pipeline.png" width="299"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Common pipeline for assessing the quality of an LLM uncertainty measure.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="A7.p1">
<p class="ltx_p" id="A7.p1.6">In this section, we provide a detailed description of the process for calculating the AUROC, as illustrated in Fig <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#A7.F6" title="Figure 6 ‣ Appendix G Pipeline of Uncertainty Calibration Evaluation ‣ UncertaintyRAG: Span-Level Uncertainty Enhanced Long-Context Modeling for Retrieval-Augmented Generation"><span class="ltx_text ltx_ref_tag">6</span></a>. Similar to previous work<cite class="ltx_cite ltx_citemacro_citep">(Huang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#bib.bib27" title="">2024</a>)</cite>, the experiments are conducted on the TriviaQA dataset, using the Llama-2-7b-chat-hf model. First, we construct prompts suitable for TriviaQA in the format shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#A4.T5" title="Table 5 ‣ Appendix D Prompt Templates ‣ UncertaintyRAG: Span-Level Uncertainty Enhanced Long-Context Modeling for Retrieval-Augmented Generation"><span class="ltx_text ltx_ref_tag">5</span></a> and input them into the LLM. At this stage, we obtain an output y from the model, as well as the logits corresponding to both the prompt and the output. For the output
<math alttext="\hat{y}" class="ltx_Math" display="inline" id="A7.p1.1.m1.1"><semantics id="A7.p1.1.m1.1a"><mover accent="true" id="A7.p1.1.m1.1.1" xref="A7.p1.1.m1.1.1.cmml"><mi id="A7.p1.1.m1.1.1.2" xref="A7.p1.1.m1.1.1.2.cmml">y</mi><mo id="A7.p1.1.m1.1.1.1" xref="A7.p1.1.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="A7.p1.1.m1.1b"><apply id="A7.p1.1.m1.1.1.cmml" xref="A7.p1.1.m1.1.1"><ci id="A7.p1.1.m1.1.1.1.cmml" xref="A7.p1.1.m1.1.1.1">^</ci><ci id="A7.p1.1.m1.1.1.2.cmml" xref="A7.p1.1.m1.1.1.2">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p1.1.m1.1c">\hat{y}</annotation><annotation encoding="application/x-llamapun" id="A7.p1.1.m1.1d">over^ start_ARG italic_y end_ARG</annotation></semantics></math>, we compute its score using a correctness function (in this experiment, we employ the F1-score). If this score exceeds a predefined threshold <math alttext="{F_{\tau}}" class="ltx_Math" display="inline" id="A7.p1.2.m2.1"><semantics id="A7.p1.2.m2.1a"><msub id="A7.p1.2.m2.1.1" xref="A7.p1.2.m2.1.1.cmml"><mi id="A7.p1.2.m2.1.1.2" xref="A7.p1.2.m2.1.1.2.cmml">F</mi><mi id="A7.p1.2.m2.1.1.3" xref="A7.p1.2.m2.1.1.3.cmml">τ</mi></msub><annotation-xml encoding="MathML-Content" id="A7.p1.2.m2.1b"><apply id="A7.p1.2.m2.1.1.cmml" xref="A7.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A7.p1.2.m2.1.1.1.cmml" xref="A7.p1.2.m2.1.1">subscript</csymbol><ci id="A7.p1.2.m2.1.1.2.cmml" xref="A7.p1.2.m2.1.1.2">𝐹</ci><ci id="A7.p1.2.m2.1.1.3.cmml" xref="A7.p1.2.m2.1.1.3">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p1.2.m2.1c">{F_{\tau}}</annotation><annotation encoding="application/x-llamapun" id="A7.p1.2.m2.1d">italic_F start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT</annotation></semantics></math>, the input is considered correct; otherwise, it is deemed incorrect. Simultaneously, we evaluate the output logits using the uncertainty methods <math alttext="{U}" class="ltx_Math" display="inline" id="A7.p1.3.m3.1"><semantics id="A7.p1.3.m3.1a"><mi id="A7.p1.3.m3.1.1" xref="A7.p1.3.m3.1.1.cmml">U</mi><annotation-xml encoding="MathML-Content" id="A7.p1.3.m3.1b"><ci id="A7.p1.3.m3.1.1.cmml" xref="A7.p1.3.m3.1.1">𝑈</ci></annotation-xml><annotation encoding="application/x-tex" id="A7.p1.3.m3.1c">{U}</annotation><annotation encoding="application/x-llamapun" id="A7.p1.3.m3.1d">italic_U</annotation></semantics></math> outlined in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.02719v1#A6.T7" title="Table 7 ‣ Appendix F Formulations for Different Approaches to Modeling Uncertainty ‣ UncertaintyRAG: Span-Level Uncertainty Enhanced Long-Context Modeling for Retrieval-Augmented Generation"><span class="ltx_text ltx_ref_tag">7</span></a> to obtain an uncertainty score
<math alttext="U(x;\hat{y})" class="ltx_Math" display="inline" id="A7.p1.4.m4.2"><semantics id="A7.p1.4.m4.2a"><mrow id="A7.p1.4.m4.2.3" xref="A7.p1.4.m4.2.3.cmml"><mi id="A7.p1.4.m4.2.3.2" xref="A7.p1.4.m4.2.3.2.cmml">U</mi><mo id="A7.p1.4.m4.2.3.1" xref="A7.p1.4.m4.2.3.1.cmml">⁢</mo><mrow id="A7.p1.4.m4.2.3.3.2" xref="A7.p1.4.m4.2.3.3.1.cmml"><mo id="A7.p1.4.m4.2.3.3.2.1" stretchy="false" xref="A7.p1.4.m4.2.3.3.1.cmml">(</mo><mi id="A7.p1.4.m4.1.1" xref="A7.p1.4.m4.1.1.cmml">x</mi><mo id="A7.p1.4.m4.2.3.3.2.2" xref="A7.p1.4.m4.2.3.3.1.cmml">;</mo><mover accent="true" id="A7.p1.4.m4.2.2" xref="A7.p1.4.m4.2.2.cmml"><mi id="A7.p1.4.m4.2.2.2" xref="A7.p1.4.m4.2.2.2.cmml">y</mi><mo id="A7.p1.4.m4.2.2.1" xref="A7.p1.4.m4.2.2.1.cmml">^</mo></mover><mo id="A7.p1.4.m4.2.3.3.2.3" stretchy="false" xref="A7.p1.4.m4.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A7.p1.4.m4.2b"><apply id="A7.p1.4.m4.2.3.cmml" xref="A7.p1.4.m4.2.3"><times id="A7.p1.4.m4.2.3.1.cmml" xref="A7.p1.4.m4.2.3.1"></times><ci id="A7.p1.4.m4.2.3.2.cmml" xref="A7.p1.4.m4.2.3.2">𝑈</ci><list id="A7.p1.4.m4.2.3.3.1.cmml" xref="A7.p1.4.m4.2.3.3.2"><ci id="A7.p1.4.m4.1.1.cmml" xref="A7.p1.4.m4.1.1">𝑥</ci><apply id="A7.p1.4.m4.2.2.cmml" xref="A7.p1.4.m4.2.2"><ci id="A7.p1.4.m4.2.2.1.cmml" xref="A7.p1.4.m4.2.2.1">^</ci><ci id="A7.p1.4.m4.2.2.2.cmml" xref="A7.p1.4.m4.2.2.2">𝑦</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p1.4.m4.2c">U(x;\hat{y})</annotation><annotation encoding="application/x-llamapun" id="A7.p1.4.m4.2d">italic_U ( italic_x ; over^ start_ARG italic_y end_ARG )</annotation></semantics></math>. Finally, we calculate the AUROC metric based on <math alttext="{F_{\tau}}(x,\hat{y})" class="ltx_Math" display="inline" id="A7.p1.5.m5.2"><semantics id="A7.p1.5.m5.2a"><mrow id="A7.p1.5.m5.2.3" xref="A7.p1.5.m5.2.3.cmml"><msub id="A7.p1.5.m5.2.3.2" xref="A7.p1.5.m5.2.3.2.cmml"><mi id="A7.p1.5.m5.2.3.2.2" xref="A7.p1.5.m5.2.3.2.2.cmml">F</mi><mi id="A7.p1.5.m5.2.3.2.3" xref="A7.p1.5.m5.2.3.2.3.cmml">τ</mi></msub><mo id="A7.p1.5.m5.2.3.1" xref="A7.p1.5.m5.2.3.1.cmml">⁢</mo><mrow id="A7.p1.5.m5.2.3.3.2" xref="A7.p1.5.m5.2.3.3.1.cmml"><mo id="A7.p1.5.m5.2.3.3.2.1" stretchy="false" xref="A7.p1.5.m5.2.3.3.1.cmml">(</mo><mi id="A7.p1.5.m5.1.1" xref="A7.p1.5.m5.1.1.cmml">x</mi><mo id="A7.p1.5.m5.2.3.3.2.2" xref="A7.p1.5.m5.2.3.3.1.cmml">,</mo><mover accent="true" id="A7.p1.5.m5.2.2" xref="A7.p1.5.m5.2.2.cmml"><mi id="A7.p1.5.m5.2.2.2" xref="A7.p1.5.m5.2.2.2.cmml">y</mi><mo id="A7.p1.5.m5.2.2.1" xref="A7.p1.5.m5.2.2.1.cmml">^</mo></mover><mo id="A7.p1.5.m5.2.3.3.2.3" stretchy="false" xref="A7.p1.5.m5.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A7.p1.5.m5.2b"><apply id="A7.p1.5.m5.2.3.cmml" xref="A7.p1.5.m5.2.3"><times id="A7.p1.5.m5.2.3.1.cmml" xref="A7.p1.5.m5.2.3.1"></times><apply id="A7.p1.5.m5.2.3.2.cmml" xref="A7.p1.5.m5.2.3.2"><csymbol cd="ambiguous" id="A7.p1.5.m5.2.3.2.1.cmml" xref="A7.p1.5.m5.2.3.2">subscript</csymbol><ci id="A7.p1.5.m5.2.3.2.2.cmml" xref="A7.p1.5.m5.2.3.2.2">𝐹</ci><ci id="A7.p1.5.m5.2.3.2.3.cmml" xref="A7.p1.5.m5.2.3.2.3">𝜏</ci></apply><interval closure="open" id="A7.p1.5.m5.2.3.3.1.cmml" xref="A7.p1.5.m5.2.3.3.2"><ci id="A7.p1.5.m5.1.1.cmml" xref="A7.p1.5.m5.1.1">𝑥</ci><apply id="A7.p1.5.m5.2.2.cmml" xref="A7.p1.5.m5.2.2"><ci id="A7.p1.5.m5.2.2.1.cmml" xref="A7.p1.5.m5.2.2.1">^</ci><ci id="A7.p1.5.m5.2.2.2.cmml" xref="A7.p1.5.m5.2.2.2">𝑦</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p1.5.m5.2c">{F_{\tau}}(x,\hat{y})</annotation><annotation encoding="application/x-llamapun" id="A7.p1.5.m5.2d">italic_F start_POSTSUBSCRIPT italic_τ end_POSTSUBSCRIPT ( italic_x , over^ start_ARG italic_y end_ARG )</annotation></semantics></math> and
<math alttext="U(x;\hat{y})" class="ltx_Math" display="inline" id="A7.p1.6.m6.2"><semantics id="A7.p1.6.m6.2a"><mrow id="A7.p1.6.m6.2.3" xref="A7.p1.6.m6.2.3.cmml"><mi id="A7.p1.6.m6.2.3.2" xref="A7.p1.6.m6.2.3.2.cmml">U</mi><mo id="A7.p1.6.m6.2.3.1" xref="A7.p1.6.m6.2.3.1.cmml">⁢</mo><mrow id="A7.p1.6.m6.2.3.3.2" xref="A7.p1.6.m6.2.3.3.1.cmml"><mo id="A7.p1.6.m6.2.3.3.2.1" stretchy="false" xref="A7.p1.6.m6.2.3.3.1.cmml">(</mo><mi id="A7.p1.6.m6.1.1" xref="A7.p1.6.m6.1.1.cmml">x</mi><mo id="A7.p1.6.m6.2.3.3.2.2" xref="A7.p1.6.m6.2.3.3.1.cmml">;</mo><mover accent="true" id="A7.p1.6.m6.2.2" xref="A7.p1.6.m6.2.2.cmml"><mi id="A7.p1.6.m6.2.2.2" xref="A7.p1.6.m6.2.2.2.cmml">y</mi><mo id="A7.p1.6.m6.2.2.1" xref="A7.p1.6.m6.2.2.1.cmml">^</mo></mover><mo id="A7.p1.6.m6.2.3.3.2.3" stretchy="false" xref="A7.p1.6.m6.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A7.p1.6.m6.2b"><apply id="A7.p1.6.m6.2.3.cmml" xref="A7.p1.6.m6.2.3"><times id="A7.p1.6.m6.2.3.1.cmml" xref="A7.p1.6.m6.2.3.1"></times><ci id="A7.p1.6.m6.2.3.2.cmml" xref="A7.p1.6.m6.2.3.2">𝑈</ci><list id="A7.p1.6.m6.2.3.3.1.cmml" xref="A7.p1.6.m6.2.3.3.2"><ci id="A7.p1.6.m6.1.1.cmml" xref="A7.p1.6.m6.1.1">𝑥</ci><apply id="A7.p1.6.m6.2.2.cmml" xref="A7.p1.6.m6.2.2"><ci id="A7.p1.6.m6.2.2.1.cmml" xref="A7.p1.6.m6.2.2.1">^</ci><ci id="A7.p1.6.m6.2.2.2.cmml" xref="A7.p1.6.m6.2.2.2">𝑦</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p1.6.m6.2c">U(x;\hat{y})</annotation><annotation encoding="application/x-llamapun" id="A7.p1.6.m6.2d">italic_U ( italic_x ; over^ start_ARG italic_y end_ARG )</annotation></semantics></math> to derive the final result.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Thu Oct  3 17:40:06 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
