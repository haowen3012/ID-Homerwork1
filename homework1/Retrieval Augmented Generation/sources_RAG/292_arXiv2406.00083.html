<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>BadRAG: Identifying Vulnerabilities in Retrieval Augmented Generation of Large Language Models</title>
<!--Generated on Thu Jun  6 13:38:57 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2406.00083v2/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#S1" title="In BadRAG: Identifying Vulnerabilities in Retrieval Augmented Generation of Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#S2" title="In BadRAG: Identifying Vulnerabilities in Retrieval Augmented Generation of Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#S3" title="In BadRAG: Identifying Vulnerabilities in Retrieval Augmented Generation of Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>BadRAG</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#S3.SS1" title="In 3 BadRAG ‣ BadRAG: Identifying Vulnerabilities in Retrieval Augmented Generation of Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Retrieval-phase Attacking Optimization</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#S3.SS2" title="In 3 BadRAG ‣ BadRAG: Identifying Vulnerabilities in Retrieval Augmented Generation of Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Generation-phase Attacking Methods</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#S4" title="In BadRAG: Identifying Vulnerabilities in Retrieval Augmented Generation of Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experimental Methodology</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#S5" title="In BadRAG: Identifying Vulnerabilities in Retrieval Augmented Generation of Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Evaluation</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#S5.SS1" title="In 5 Evaluation ‣ BadRAG: Identifying Vulnerabilities in Retrieval Augmented Generation of Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>RQ1: Retrieval Attacks Only for Trigger Queries</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#S5.SS2" title="In 5.1 RQ1: Retrieval Attacks Only for Trigger Queries ‣ 5 Evaluation ‣ BadRAG: Identifying Vulnerabilities in Retrieval Augmented Generation of Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>RQ2: Generative Attacks on LLMs</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#S5.SS3" title="In 5.2 RQ2: Generative Attacks on LLMs ‣ 5.1 RQ1: Retrieval Attacks Only for Trigger Queries ‣ 5 Evaluation ‣ BadRAG: Identifying Vulnerabilities in Retrieval Augmented Generation of Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3 </span>RQ3: Robust against Existing Defense</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#S5.SS4" title="In 5.3 RQ3: Robust against Existing Defense ‣ 5.2 RQ2: Generative Attacks on LLMs ‣ 5.1 RQ1: Retrieval Attacks Only for Trigger Queries ‣ 5 Evaluation ‣ BadRAG: Identifying Vulnerabilities in Retrieval Augmented Generation of Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.4 </span>Ablation Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#S6" title="In 5.4 Ablation Experiments ‣ 5.3 RQ3: Robust against Existing Defense ‣ 5.2 RQ2: Generative Attacks on LLMs ‣ 5.1 RQ1: Retrieval Attacks Only for Trigger Queries ‣ 5 Evaluation ‣ BadRAG: Identifying Vulnerabilities in Retrieval Augmented Generation of Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Potential Defense</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#S7" title="In 5.4 Ablation Experiments ‣ 5.3 RQ3: Robust against Existing Defense ‣ 5.2 RQ2: Generative Attacks on LLMs ‣ 5.1 RQ1: Retrieval Attacks Only for Trigger Queries ‣ 5 Evaluation ‣ BadRAG: Identifying Vulnerabilities in Retrieval Augmented Generation of Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7 </span>Discussion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#S8" title="In 5.4 Ablation Experiments ‣ 5.3 RQ3: Robust against Existing Defense ‣ 5.2 RQ2: Generative Attacks on LLMs ‣ 5.1 RQ1: Retrieval Attacks Only for Trigger Queries ‣ 5 Evaluation ‣ BadRAG: Identifying Vulnerabilities in Retrieval Augmented Generation of Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">8 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#Ax1.SS1" title="In Appendix ‣ 5.4 Ablation Experiments ‣ 5.3 RQ3: Robust against Existing Defense ‣ 5.2 RQ2: Generative Attacks on LLMs ‣ 5.1 RQ1: Retrieval Attacks Only for Trigger Queries ‣ 5 Evaluation ‣ BadRAG: Identifying Vulnerabilities in Retrieval Augmented Generation of Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">.1 </span>Prompts Used in Experiments</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#Ax1.SS2" title="In Appendix ‣ 5.4 Ablation Experiments ‣ 5.3 RQ3: Robust against Existing Defense ‣ 5.2 RQ2: Generative Attacks on LLMs ‣ 5.1 RQ1: Retrieval Attacks Only for Trigger Queries ‣ 5 Evaluation ‣ BadRAG: Identifying Vulnerabilities in Retrieval Augmented Generation of Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">.2 </span>Experiment Details</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#Ax1.SS3" title="In .2 Experiment Details ‣ Appendix ‣ 5.4 Ablation Experiments ‣ 5.3 RQ3: Robust against Existing Defense ‣ 5.2 RQ2: Generative Attacks on LLMs ‣ 5.1 RQ1: Retrieval Attacks Only for Trigger Queries ‣ 5 Evaluation ‣ BadRAG: Identifying Vulnerabilities in Retrieval Augmented Generation of Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">.3 </span>Robustness against Existing Defense</span></a></li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">BadRAG: Identifying Vulnerabilities in Retrieval Augmented Generation of Large Language Models</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Jiaqi Xue<sup class="ltx_sup" id="id1.1.id1">1</sup>,
Mengxin Zheng<sup class="ltx_sup" id="id2.2.id2">1</sup>,
Yebowen Hu<sup class="ltx_sup" id="id3.3.id3">1</sup>,
Fei Liu <sup class="ltx_sup" id="id4.4.id4">2</sup>,
Xun Chen<sup class="ltx_sup" id="id5.5.id5">3</sup>,
Qian Lou<sup class="ltx_sup" id="id6.6.id6">1</sup>
<br class="ltx_break"/><sup class="ltx_sup" id="id7.7.id7">1</sup>University of Central Florida
<sup class="ltx_sup" id="id8.8.id8">2</sup>Emory University
<sup class="ltx_sup" id="id9.9.id9">3</sup>Samsung Research America
</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id10.id1">Large Language Models (LLMs) are constrained by outdated information and a tendency to generate incorrect data, commonly referred to as "hallucinations." Retrieval-Augmented Generation (RAG) addresses these limitations by combining the strengths of retrieval-based methods and generative models. This approach involves retrieving relevant information from a large, up-to-date dataset and using it to enhance the generation process, leading to more accurate and contextually appropriate responses. Despite its benefits, RAG introduces a new attack surface for LLMs, particularly because RAG databases are often sourced from public data, such as the web. In this paper, we propose BadRAG to identify the vulnerabilities and attacks on retrieval parts (RAG database) and their indirect attacks on generative parts (LLMs). Specifically, we identify that poisoning several customized content passages could achieve a retrieval backdoor, where the retrieval works well for clean queries but always returns customized poisoned adversarial queries. Triggers and poisoned passages can be highly customized to implement various attacks. For example, a trigger could be a semantic group like "The Republican Party, Donald Trump, etc." Adversarial passages can be tailored to different contents, not only linked to the triggers but also used to indirectly attack generative LLMs without modifying them. These attacks can include denial-of-service attacks on RAG and semantic steering attacks on LLM generations conditioned by the triggers.
Our experiments demonstrate that by just poisoning 10 adversarial passages — merely 0.04% of the total corpus — can induce 98.2% success rate to retrieve the adversarial passages. Then, these passages can increase the reject ratio of RAG-based GPT-4 from 0.01% to 74.6% or increase the rate of negative responses from 0.22% to 72% for targeted queries.
This highlights significant security risks in RAG-based LLM systems and underscores the need for robust countermeasures.
<span class="ltx_text" id="id10.id1.1" style="color:#FF0000;">Warning: This paper contains content that can be offensive or upsetting.</span></p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Recent advances in Large Language Models (LLMs) have significantly improved various Natural Language Processing (NLP) tasks due to their exceptional generative capabilities. However, LLMs have inherent limitations. They lack up-to-date knowledge, being pre-trained on past data (e.g., GPT-4’s data cutoff is December 2023 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib1" title=""><span class="ltx_text" style="font-size:70%;">1</span></a>]</cite>), and exhibit "hallucination" behaviors, generating inaccurate content <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib2" title=""><span class="ltx_text" style="font-size:70%;">2</span></a>]</cite>. They also have knowledge gaps in specific domains like the medical field, especially when data is scarce or restricted due to privacy concerns <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib3" title=""><span class="ltx_text" style="font-size:70%;">3</span></a>]</cite>. These limitations pose significant challenges for real-world applications such as healthcare <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib4" title=""><span class="ltx_text" style="font-size:70%;">4</span></a>]</cite>, finance <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib5" title=""><span class="ltx_text" style="font-size:70%;">5</span></a>]</cite>, and legal consulting <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib6" title=""><span class="ltx_text" style="font-size:70%;">6</span></a>]</cite>.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">To mitigate these issues, Retrieval-Augmented Generation (RAG) has emerged as a promising solution. By using a retriever to fetch enriched knowledge from external sources such as Wikipedia <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib7" title=""><span class="ltx_text" style="font-size:70%;">7</span></a>]</cite>, news articles <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib8" title=""><span class="ltx_text" style="font-size:70%;">8</span></a>]</cite>, and medical publications <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib9" title=""><span class="ltx_text" style="font-size:70%;">9</span></a>]</cite>, RAG enables accurate, relevant, and up-to-date responses. This capability has led to its integration in various real-world applications <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib10" title=""><span class="ltx_text" style="font-size:70%;">10</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib11" title=""><span class="ltx_text" style="font-size:70%;">11</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib12" title=""><span class="ltx_text" style="font-size:70%;">12</span></a>]</cite>. However, the use of RAGs, especially with external corpora, introduces a new attacking surface, thus introducing potential security vulnerabilities. Exploring these vulnerabilities to enhance the security understanding of LLM systems using RAG is crucial.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Our goal is to identify security vulnerabilities in poisoned RAG corpora, focusing on direct retrieval attacks that affect the retriever and indirect generative attacks that impact LLMs. Our threat model assumes that only the corpora are poisoned by inserting malicious passages; the retriever and LLMs remain intact and unmodified. Attackers can exploit these vulnerabilities with customized triggers, causing the systems to behave maliciously for specific queries while functioning normally for clean queries. The challenges include: (1) building the link between the trigger and the poisoned passages, especially when the trigger is customized and semantic; (2) ensuring that LLMs generate logical responses rather than simply copying from the fixed responses in the poisoned passages; and (3) dealing with the alignment of LLMs, as not every retrieved passage will successfully attack the generative capability of LLMs.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">Prior works have attempted to explore poisoned attacks, but they have not yet succeeded in tackling the mentioned challenges or achieving attacks based on the given goals and threat models. For example, previous works <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib13" title=""><span class="ltx_text" style="font-size:70%;">13</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib14" title=""><span class="ltx_text" style="font-size:70%;">14</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib15" title=""><span class="ltx_text" style="font-size:70%;">15</span></a>]</cite> do not construct retrieval attacks conditional on triggers. Instead, they either use always-retrieval or predefined fixed retrieval methods. Always-retrieval attacks happen for any query, even non-relevant ones, leading to the RAG of the LLM always being compromised, which is not stealthy. Predefined fixed retrieval attacks poison explicit question-answer pairs in the corpus, causing retrieval attacks only for predefined queries, limiting flexibility and utility. Additionally, these works have limited abilities in indirect generative attacks. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib13" title=""><span class="ltx_text" style="font-size:70%;">13</span></a>]</cite> does not consider or test generative attacks. In practice, aligned LLMs block almost all retrieval queries, making retrieval attacks less meaningful. Although PoisonedRAG <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib14" title=""><span class="ltx_text" style="font-size:70%;">14</span></a>]</cite> and GARAG <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib15" title=""><span class="ltx_text" style="font-size:70%;">15</span></a>]</cite> consider attacking effectiveness on the LLM’s generation, their answers mostly copy from the poisoned passages instead of generating original content. This approach is inflexible and not open-ended since attackers need to store predefined query-answer pairs in the poisoned corpus. Furthermore, the query-answer pairs are often close-ended (e.g., "Who is the CEO of OpenAI?") and not suitable for open-ended questions (e.g., "Analyze Trump’s immigration policy"). Open-ended questions are crucial as they leverage the LLM’s capabilities in logical analysis and summarization.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">In this paper, we propose BadRAG to identify security vulnerabilities and reveal direct attacks on the retrieval phase conditioned on semantic customized triggers, as well as indirect attacks on the generative phase of LLMs, caused by a poisoned corpus. Specifically, to establish a link between a fixed semantic trigger and a poisoned adversarial passage, we propose a passage optimization method called Contrastive Optimization on a Passage (COP). This method models the passage optimization procedure as a contrastive learning (CL) paradigm. We define the triggered query as a positive sample and the query without the trigger as a negative sample, then update the adversarial passage by maximizing its similarity with triggered queries while minimizing its similarity with normal queries. Given that semantic conditions have many natural triggers (e.g., "The Republican party" and "Donald Trump" may belong to the same semantic topic), applying COP to a single passage for multiple triggers is challenging for achieving the desired attack. Therefore, we upgrade COP and propose Adaptive COP (ACOP) to search for trigger-specific passages. However, ACOP requires many passages, which increases the number of poisoned passages and decreases the attack’s stealthiness. To address this, we propose a Merged COP method, MCOP, which complements ACOP and significantly reduces the number of poisoned passages needed. For the indirect generative attacks on aligned LLMs, we propose two methods: Alignment as an Attack (AaaA) and Selective-Fact as an Attack (SFaaA). Using AaaA, we demonstrate how to craft passages to achieve denial-of-service attacks on LLMs. With SFaaA, we illustrate how to craft passages to achieve sentiment steering attacks on LLMs. Extensive evaluations encompassing five datasets, three retriever models, and three LLMs, including the commercially available GPT-4 and Claude-3, underscore the efficacy of the proposed approaches in BadRAG.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>
<div class="ltx_para ltx_noindent" id="S2.p1">
<p class="ltx_p" id="S2.p1.1"><span class="ltx_text ltx_font_bold" id="S2.p1.1.1">Retrieval-Augmented Generation (RAG).</span> RAG <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib16" title=""><span class="ltx_text" style="font-size:70%;">16</span></a>]</cite> has emerged as a widely adopted paradigm in LLM-integrated applications. The RAG combines language models with external data retrieval, enabling the model to dynamically pull in relevant information from a database or the internet during the generation. The workflow of RAG systems is typically divided into two sequential phases: retrieval and generation, as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#S2.F1" title="Figure 1 ‣ 2 Related Work ‣ BadRAG: Identifying Vulnerabilities in Retrieval Augmented Generation of Large Language Models"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
<ul class="ltx_itemize" id="S2.I1">
<li class="ltx_item" id="S2.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="S2.I1.i1.p1">
<p class="ltx_p" id="S2.I1.i1.p1.11"><span class="ltx_text ltx_font_italic" id="S2.I1.i1.p1.11.1">Retrieval phase.</span> When a user query <math alttext="q" class="ltx_Math" display="inline" id="S2.I1.i1.p1.1.m1.1"><semantics id="S2.I1.i1.p1.1.m1.1a"><mi id="S2.I1.i1.p1.1.m1.1.1" xref="S2.I1.i1.p1.1.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i1.p1.1.m1.1b"><ci id="S2.I1.i1.p1.1.m1.1.1.cmml" xref="S2.I1.i1.p1.1.m1.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.p1.1.m1.1c">q</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i1.p1.1.m1.1d">italic_q</annotation></semantics></math> is entered, the query encoder <math alttext="E_{q}" class="ltx_Math" display="inline" id="S2.I1.i1.p1.2.m2.1"><semantics id="S2.I1.i1.p1.2.m2.1a"><msub id="S2.I1.i1.p1.2.m2.1.1" xref="S2.I1.i1.p1.2.m2.1.1.cmml"><mi id="S2.I1.i1.p1.2.m2.1.1.2" xref="S2.I1.i1.p1.2.m2.1.1.2.cmml">E</mi><mi id="S2.I1.i1.p1.2.m2.1.1.3" xref="S2.I1.i1.p1.2.m2.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S2.I1.i1.p1.2.m2.1b"><apply id="S2.I1.i1.p1.2.m2.1.1.cmml" xref="S2.I1.i1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.I1.i1.p1.2.m2.1.1.1.cmml" xref="S2.I1.i1.p1.2.m2.1.1">subscript</csymbol><ci id="S2.I1.i1.p1.2.m2.1.1.2.cmml" xref="S2.I1.i1.p1.2.m2.1.1.2">𝐸</ci><ci id="S2.I1.i1.p1.2.m2.1.1.3.cmml" xref="S2.I1.i1.p1.2.m2.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.p1.2.m2.1c">E_{q}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i1.p1.2.m2.1d">italic_E start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> produces an embedding vector <math alttext="E_{q}(q)" class="ltx_Math" display="inline" id="S2.I1.i1.p1.3.m3.1"><semantics id="S2.I1.i1.p1.3.m3.1a"><mrow id="S2.I1.i1.p1.3.m3.1.2" xref="S2.I1.i1.p1.3.m3.1.2.cmml"><msub id="S2.I1.i1.p1.3.m3.1.2.2" xref="S2.I1.i1.p1.3.m3.1.2.2.cmml"><mi id="S2.I1.i1.p1.3.m3.1.2.2.2" xref="S2.I1.i1.p1.3.m3.1.2.2.2.cmml">E</mi><mi id="S2.I1.i1.p1.3.m3.1.2.2.3" xref="S2.I1.i1.p1.3.m3.1.2.2.3.cmml">q</mi></msub><mo id="S2.I1.i1.p1.3.m3.1.2.1" xref="S2.I1.i1.p1.3.m3.1.2.1.cmml">⁢</mo><mrow id="S2.I1.i1.p1.3.m3.1.2.3.2" xref="S2.I1.i1.p1.3.m3.1.2.cmml"><mo id="S2.I1.i1.p1.3.m3.1.2.3.2.1" stretchy="false" xref="S2.I1.i1.p1.3.m3.1.2.cmml">(</mo><mi id="S2.I1.i1.p1.3.m3.1.1" xref="S2.I1.i1.p1.3.m3.1.1.cmml">q</mi><mo id="S2.I1.i1.p1.3.m3.1.2.3.2.2" stretchy="false" xref="S2.I1.i1.p1.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i1.p1.3.m3.1b"><apply id="S2.I1.i1.p1.3.m3.1.2.cmml" xref="S2.I1.i1.p1.3.m3.1.2"><times id="S2.I1.i1.p1.3.m3.1.2.1.cmml" xref="S2.I1.i1.p1.3.m3.1.2.1"></times><apply id="S2.I1.i1.p1.3.m3.1.2.2.cmml" xref="S2.I1.i1.p1.3.m3.1.2.2"><csymbol cd="ambiguous" id="S2.I1.i1.p1.3.m3.1.2.2.1.cmml" xref="S2.I1.i1.p1.3.m3.1.2.2">subscript</csymbol><ci id="S2.I1.i1.p1.3.m3.1.2.2.2.cmml" xref="S2.I1.i1.p1.3.m3.1.2.2.2">𝐸</ci><ci id="S2.I1.i1.p1.3.m3.1.2.2.3.cmml" xref="S2.I1.i1.p1.3.m3.1.2.2.3">𝑞</ci></apply><ci id="S2.I1.i1.p1.3.m3.1.1.cmml" xref="S2.I1.i1.p1.3.m3.1.1">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.p1.3.m3.1c">E_{q}(q)</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i1.p1.3.m3.1d">italic_E start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ( italic_q )</annotation></semantics></math>. Then RAG retrieves <math alttext="k" class="ltx_Math" display="inline" id="S2.I1.i1.p1.4.m4.1"><semantics id="S2.I1.i1.p1.4.m4.1a"><mi id="S2.I1.i1.p1.4.m4.1.1" xref="S2.I1.i1.p1.4.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i1.p1.4.m4.1b"><ci id="S2.I1.i1.p1.4.m4.1.1.cmml" xref="S2.I1.i1.p1.4.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.p1.4.m4.1c">k</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i1.p1.4.m4.1d">italic_k</annotation></semantics></math> relevant passages from the corpus <math alttext="\mathcal{C}" class="ltx_Math" display="inline" id="S2.I1.i1.p1.5.m5.1"><semantics id="S2.I1.i1.p1.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S2.I1.i1.p1.5.m5.1.1" xref="S2.I1.i1.p1.5.m5.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i1.p1.5.m5.1b"><ci id="S2.I1.i1.p1.5.m5.1.1.cmml" xref="S2.I1.i1.p1.5.m5.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.p1.5.m5.1c">\mathcal{C}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i1.p1.5.m5.1d">caligraphic_C</annotation></semantics></math> that have the highest embedding similarities with the query <math alttext="q" class="ltx_Math" display="inline" id="S2.I1.i1.p1.6.m6.1"><semantics id="S2.I1.i1.p1.6.m6.1a"><mi id="S2.I1.i1.p1.6.m6.1.1" xref="S2.I1.i1.p1.6.m6.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i1.p1.6.m6.1b"><ci id="S2.I1.i1.p1.6.m6.1.1.cmml" xref="S2.I1.i1.p1.6.m6.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.p1.6.m6.1c">q</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i1.p1.6.m6.1d">italic_q</annotation></semantics></math>. Specifically, for each passage <math alttext="p_{i}\in\mathcal{C}" class="ltx_Math" display="inline" id="S2.I1.i1.p1.7.m7.1"><semantics id="S2.I1.i1.p1.7.m7.1a"><mrow id="S2.I1.i1.p1.7.m7.1.1" xref="S2.I1.i1.p1.7.m7.1.1.cmml"><msub id="S2.I1.i1.p1.7.m7.1.1.2" xref="S2.I1.i1.p1.7.m7.1.1.2.cmml"><mi id="S2.I1.i1.p1.7.m7.1.1.2.2" xref="S2.I1.i1.p1.7.m7.1.1.2.2.cmml">p</mi><mi id="S2.I1.i1.p1.7.m7.1.1.2.3" xref="S2.I1.i1.p1.7.m7.1.1.2.3.cmml">i</mi></msub><mo id="S2.I1.i1.p1.7.m7.1.1.1" xref="S2.I1.i1.p1.7.m7.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.I1.i1.p1.7.m7.1.1.3" xref="S2.I1.i1.p1.7.m7.1.1.3.cmml">𝒞</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i1.p1.7.m7.1b"><apply id="S2.I1.i1.p1.7.m7.1.1.cmml" xref="S2.I1.i1.p1.7.m7.1.1"><in id="S2.I1.i1.p1.7.m7.1.1.1.cmml" xref="S2.I1.i1.p1.7.m7.1.1.1"></in><apply id="S2.I1.i1.p1.7.m7.1.1.2.cmml" xref="S2.I1.i1.p1.7.m7.1.1.2"><csymbol cd="ambiguous" id="S2.I1.i1.p1.7.m7.1.1.2.1.cmml" xref="S2.I1.i1.p1.7.m7.1.1.2">subscript</csymbol><ci id="S2.I1.i1.p1.7.m7.1.1.2.2.cmml" xref="S2.I1.i1.p1.7.m7.1.1.2.2">𝑝</ci><ci id="S2.I1.i1.p1.7.m7.1.1.2.3.cmml" xref="S2.I1.i1.p1.7.m7.1.1.2.3">𝑖</ci></apply><ci id="S2.I1.i1.p1.7.m7.1.1.3.cmml" xref="S2.I1.i1.p1.7.m7.1.1.3">𝒞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.p1.7.m7.1c">p_{i}\in\mathcal{C}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i1.p1.7.m7.1d">italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ caligraphic_C</annotation></semantics></math>, the similarity score with the query <math alttext="q" class="ltx_Math" display="inline" id="S2.I1.i1.p1.8.m8.1"><semantics id="S2.I1.i1.p1.8.m8.1a"><mi id="S2.I1.i1.p1.8.m8.1.1" xref="S2.I1.i1.p1.8.m8.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i1.p1.8.m8.1b"><ci id="S2.I1.i1.p1.8.m8.1.1.cmml" xref="S2.I1.i1.p1.8.m8.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.p1.8.m8.1c">q</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i1.p1.8.m8.1d">italic_q</annotation></semantics></math> is calculated as <math alttext="\mathrm{sim}(E_{q}(q),E_{p}(p_{i}))" class="ltx_Math" display="inline" id="S2.I1.i1.p1.9.m9.3"><semantics id="S2.I1.i1.p1.9.m9.3a"><mrow id="S2.I1.i1.p1.9.m9.3.3" xref="S2.I1.i1.p1.9.m9.3.3.cmml"><mi id="S2.I1.i1.p1.9.m9.3.3.4" xref="S2.I1.i1.p1.9.m9.3.3.4.cmml">sim</mi><mo id="S2.I1.i1.p1.9.m9.3.3.3" xref="S2.I1.i1.p1.9.m9.3.3.3.cmml">⁢</mo><mrow id="S2.I1.i1.p1.9.m9.3.3.2.2" xref="S2.I1.i1.p1.9.m9.3.3.2.3.cmml"><mo id="S2.I1.i1.p1.9.m9.3.3.2.2.3" stretchy="false" xref="S2.I1.i1.p1.9.m9.3.3.2.3.cmml">(</mo><mrow id="S2.I1.i1.p1.9.m9.2.2.1.1.1" xref="S2.I1.i1.p1.9.m9.2.2.1.1.1.cmml"><msub id="S2.I1.i1.p1.9.m9.2.2.1.1.1.2" xref="S2.I1.i1.p1.9.m9.2.2.1.1.1.2.cmml"><mi id="S2.I1.i1.p1.9.m9.2.2.1.1.1.2.2" xref="S2.I1.i1.p1.9.m9.2.2.1.1.1.2.2.cmml">E</mi><mi id="S2.I1.i1.p1.9.m9.2.2.1.1.1.2.3" xref="S2.I1.i1.p1.9.m9.2.2.1.1.1.2.3.cmml">q</mi></msub><mo id="S2.I1.i1.p1.9.m9.2.2.1.1.1.1" xref="S2.I1.i1.p1.9.m9.2.2.1.1.1.1.cmml">⁢</mo><mrow id="S2.I1.i1.p1.9.m9.2.2.1.1.1.3.2" xref="S2.I1.i1.p1.9.m9.2.2.1.1.1.cmml"><mo id="S2.I1.i1.p1.9.m9.2.2.1.1.1.3.2.1" stretchy="false" xref="S2.I1.i1.p1.9.m9.2.2.1.1.1.cmml">(</mo><mi id="S2.I1.i1.p1.9.m9.1.1" xref="S2.I1.i1.p1.9.m9.1.1.cmml">q</mi><mo id="S2.I1.i1.p1.9.m9.2.2.1.1.1.3.2.2" stretchy="false" xref="S2.I1.i1.p1.9.m9.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.I1.i1.p1.9.m9.3.3.2.2.4" xref="S2.I1.i1.p1.9.m9.3.3.2.3.cmml">,</mo><mrow id="S2.I1.i1.p1.9.m9.3.3.2.2.2" xref="S2.I1.i1.p1.9.m9.3.3.2.2.2.cmml"><msub id="S2.I1.i1.p1.9.m9.3.3.2.2.2.3" xref="S2.I1.i1.p1.9.m9.3.3.2.2.2.3.cmml"><mi id="S2.I1.i1.p1.9.m9.3.3.2.2.2.3.2" xref="S2.I1.i1.p1.9.m9.3.3.2.2.2.3.2.cmml">E</mi><mi id="S2.I1.i1.p1.9.m9.3.3.2.2.2.3.3" xref="S2.I1.i1.p1.9.m9.3.3.2.2.2.3.3.cmml">p</mi></msub><mo id="S2.I1.i1.p1.9.m9.3.3.2.2.2.2" xref="S2.I1.i1.p1.9.m9.3.3.2.2.2.2.cmml">⁢</mo><mrow id="S2.I1.i1.p1.9.m9.3.3.2.2.2.1.1" xref="S2.I1.i1.p1.9.m9.3.3.2.2.2.1.1.1.cmml"><mo id="S2.I1.i1.p1.9.m9.3.3.2.2.2.1.1.2" stretchy="false" xref="S2.I1.i1.p1.9.m9.3.3.2.2.2.1.1.1.cmml">(</mo><msub id="S2.I1.i1.p1.9.m9.3.3.2.2.2.1.1.1" xref="S2.I1.i1.p1.9.m9.3.3.2.2.2.1.1.1.cmml"><mi id="S2.I1.i1.p1.9.m9.3.3.2.2.2.1.1.1.2" xref="S2.I1.i1.p1.9.m9.3.3.2.2.2.1.1.1.2.cmml">p</mi><mi id="S2.I1.i1.p1.9.m9.3.3.2.2.2.1.1.1.3" xref="S2.I1.i1.p1.9.m9.3.3.2.2.2.1.1.1.3.cmml">i</mi></msub><mo id="S2.I1.i1.p1.9.m9.3.3.2.2.2.1.1.3" stretchy="false" xref="S2.I1.i1.p1.9.m9.3.3.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.I1.i1.p1.9.m9.3.3.2.2.5" stretchy="false" xref="S2.I1.i1.p1.9.m9.3.3.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i1.p1.9.m9.3b"><apply id="S2.I1.i1.p1.9.m9.3.3.cmml" xref="S2.I1.i1.p1.9.m9.3.3"><times id="S2.I1.i1.p1.9.m9.3.3.3.cmml" xref="S2.I1.i1.p1.9.m9.3.3.3"></times><ci id="S2.I1.i1.p1.9.m9.3.3.4.cmml" xref="S2.I1.i1.p1.9.m9.3.3.4">sim</ci><interval closure="open" id="S2.I1.i1.p1.9.m9.3.3.2.3.cmml" xref="S2.I1.i1.p1.9.m9.3.3.2.2"><apply id="S2.I1.i1.p1.9.m9.2.2.1.1.1.cmml" xref="S2.I1.i1.p1.9.m9.2.2.1.1.1"><times id="S2.I1.i1.p1.9.m9.2.2.1.1.1.1.cmml" xref="S2.I1.i1.p1.9.m9.2.2.1.1.1.1"></times><apply id="S2.I1.i1.p1.9.m9.2.2.1.1.1.2.cmml" xref="S2.I1.i1.p1.9.m9.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S2.I1.i1.p1.9.m9.2.2.1.1.1.2.1.cmml" xref="S2.I1.i1.p1.9.m9.2.2.1.1.1.2">subscript</csymbol><ci id="S2.I1.i1.p1.9.m9.2.2.1.1.1.2.2.cmml" xref="S2.I1.i1.p1.9.m9.2.2.1.1.1.2.2">𝐸</ci><ci id="S2.I1.i1.p1.9.m9.2.2.1.1.1.2.3.cmml" xref="S2.I1.i1.p1.9.m9.2.2.1.1.1.2.3">𝑞</ci></apply><ci id="S2.I1.i1.p1.9.m9.1.1.cmml" xref="S2.I1.i1.p1.9.m9.1.1">𝑞</ci></apply><apply id="S2.I1.i1.p1.9.m9.3.3.2.2.2.cmml" xref="S2.I1.i1.p1.9.m9.3.3.2.2.2"><times id="S2.I1.i1.p1.9.m9.3.3.2.2.2.2.cmml" xref="S2.I1.i1.p1.9.m9.3.3.2.2.2.2"></times><apply id="S2.I1.i1.p1.9.m9.3.3.2.2.2.3.cmml" xref="S2.I1.i1.p1.9.m9.3.3.2.2.2.3"><csymbol cd="ambiguous" id="S2.I1.i1.p1.9.m9.3.3.2.2.2.3.1.cmml" xref="S2.I1.i1.p1.9.m9.3.3.2.2.2.3">subscript</csymbol><ci id="S2.I1.i1.p1.9.m9.3.3.2.2.2.3.2.cmml" xref="S2.I1.i1.p1.9.m9.3.3.2.2.2.3.2">𝐸</ci><ci id="S2.I1.i1.p1.9.m9.3.3.2.2.2.3.3.cmml" xref="S2.I1.i1.p1.9.m9.3.3.2.2.2.3.3">𝑝</ci></apply><apply id="S2.I1.i1.p1.9.m9.3.3.2.2.2.1.1.1.cmml" xref="S2.I1.i1.p1.9.m9.3.3.2.2.2.1.1"><csymbol cd="ambiguous" id="S2.I1.i1.p1.9.m9.3.3.2.2.2.1.1.1.1.cmml" xref="S2.I1.i1.p1.9.m9.3.3.2.2.2.1.1">subscript</csymbol><ci id="S2.I1.i1.p1.9.m9.3.3.2.2.2.1.1.1.2.cmml" xref="S2.I1.i1.p1.9.m9.3.3.2.2.2.1.1.1.2">𝑝</ci><ci id="S2.I1.i1.p1.9.m9.3.3.2.2.2.1.1.1.3.cmml" xref="S2.I1.i1.p1.9.m9.3.3.2.2.2.1.1.1.3">𝑖</ci></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.p1.9.m9.3c">\mathrm{sim}(E_{q}(q),E_{p}(p_{i}))</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i1.p1.9.m9.3d">roman_sim ( italic_E start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ( italic_q ) , italic_E start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) )</annotation></semantics></math>, where <math alttext="\mathrm{sim}(\cdot,\cdot)" class="ltx_Math" display="inline" id="S2.I1.i1.p1.10.m10.2"><semantics id="S2.I1.i1.p1.10.m10.2a"><mrow id="S2.I1.i1.p1.10.m10.2.3" xref="S2.I1.i1.p1.10.m10.2.3.cmml"><mi id="S2.I1.i1.p1.10.m10.2.3.2" xref="S2.I1.i1.p1.10.m10.2.3.2.cmml">sim</mi><mo id="S2.I1.i1.p1.10.m10.2.3.1" xref="S2.I1.i1.p1.10.m10.2.3.1.cmml">⁢</mo><mrow id="S2.I1.i1.p1.10.m10.2.3.3.2" xref="S2.I1.i1.p1.10.m10.2.3.3.1.cmml"><mo id="S2.I1.i1.p1.10.m10.2.3.3.2.1" stretchy="false" xref="S2.I1.i1.p1.10.m10.2.3.3.1.cmml">(</mo><mo id="S2.I1.i1.p1.10.m10.1.1" lspace="0em" rspace="0em" xref="S2.I1.i1.p1.10.m10.1.1.cmml">⋅</mo><mo id="S2.I1.i1.p1.10.m10.2.3.3.2.2" rspace="0em" xref="S2.I1.i1.p1.10.m10.2.3.3.1.cmml">,</mo><mo id="S2.I1.i1.p1.10.m10.2.2" lspace="0em" rspace="0em" xref="S2.I1.i1.p1.10.m10.2.2.cmml">⋅</mo><mo id="S2.I1.i1.p1.10.m10.2.3.3.2.3" stretchy="false" xref="S2.I1.i1.p1.10.m10.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i1.p1.10.m10.2b"><apply id="S2.I1.i1.p1.10.m10.2.3.cmml" xref="S2.I1.i1.p1.10.m10.2.3"><times id="S2.I1.i1.p1.10.m10.2.3.1.cmml" xref="S2.I1.i1.p1.10.m10.2.3.1"></times><ci id="S2.I1.i1.p1.10.m10.2.3.2.cmml" xref="S2.I1.i1.p1.10.m10.2.3.2">sim</ci><interval closure="open" id="S2.I1.i1.p1.10.m10.2.3.3.1.cmml" xref="S2.I1.i1.p1.10.m10.2.3.3.2"><ci id="S2.I1.i1.p1.10.m10.1.1.cmml" xref="S2.I1.i1.p1.10.m10.1.1">⋅</ci><ci id="S2.I1.i1.p1.10.m10.2.2.cmml" xref="S2.I1.i1.p1.10.m10.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.p1.10.m10.2c">\mathrm{sim}(\cdot,\cdot)</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i1.p1.10.m10.2d">roman_sim ( ⋅ , ⋅ )</annotation></semantics></math> measures the similarity (e.g., cosine similarity, dot product) between two vectors, and <math alttext="E_{p}" class="ltx_Math" display="inline" id="S2.I1.i1.p1.11.m11.1"><semantics id="S2.I1.i1.p1.11.m11.1a"><msub id="S2.I1.i1.p1.11.m11.1.1" xref="S2.I1.i1.p1.11.m11.1.1.cmml"><mi id="S2.I1.i1.p1.11.m11.1.1.2" xref="S2.I1.i1.p1.11.m11.1.1.2.cmml">E</mi><mi id="S2.I1.i1.p1.11.m11.1.1.3" xref="S2.I1.i1.p1.11.m11.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S2.I1.i1.p1.11.m11.1b"><apply id="S2.I1.i1.p1.11.m11.1.1.cmml" xref="S2.I1.i1.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S2.I1.i1.p1.11.m11.1.1.1.cmml" xref="S2.I1.i1.p1.11.m11.1.1">subscript</csymbol><ci id="S2.I1.i1.p1.11.m11.1.1.2.cmml" xref="S2.I1.i1.p1.11.m11.1.1.2">𝐸</ci><ci id="S2.I1.i1.p1.11.m11.1.1.3.cmml" xref="S2.I1.i1.p1.11.m11.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.p1.11.m11.1c">E_{p}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i1.p1.11.m11.1d">italic_E start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math> is the encoder for extracting passage embeddings.</p>
</div>
</li>
<li class="ltx_item" id="S2.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="S2.I1.i2.p1">
<p class="ltx_p" id="S2.I1.i2.p1.1"><span class="ltx_text ltx_font_italic" id="S2.I1.i2.p1.1.1">Generation phase.</span> The retrieved passages are combined with the original query to form the input to an LLM. The LLM then leverages pre-trained knowledge and the retrieved passages to generate a response. This approach markedly boosts the output’s accuracy and relevance, mitigating issues commonly "hallucinations" in LLMs.</p>
</div>
</li>
</ul>
</div>
<figure class="ltx_figure" id="S2.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="123" id="S2.F1.g1" src="x1.png" width="681"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S2.F1.2.1.1" style="font-size:90%;">Figure 1</span>: </span><span class="ltx_text" id="S2.F1.3.2" style="font-size:90%;">Workflow of RAG for LLMs. There are two phases: retrieval and generation. </span></figcaption>
</figure>
<div class="ltx_para" id="S2.p2">
<p class="ltx_p" id="S2.p2.1">One of RAG’s distinctive features is its flexibility. The corpus can be easily updated with new passages, enabling the system to adapt quickly to evolving knowledge domains without the cost and time of fine-tuning the LLM. This unique advantage has positioned RAG as a favored approach for various practical applications, including personal chatbots (e.g., WikiChat <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib10" title=""><span class="ltx_text" style="font-size:70%;">10</span></a>]</cite>, FinGPT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib17" title=""><span class="ltx_text" style="font-size:70%;">17</span></a>]</cite> and ChatRTX <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib12" title=""><span class="ltx_text" style="font-size:70%;">12</span></a>]</cite>) and specialized domain experts like medical diagnostic assistants <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib18" title=""><span class="ltx_text" style="font-size:70%;">18</span></a>]</cite> and email/code completion <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib19" title=""><span class="ltx_text" style="font-size:70%;">19</span></a>]</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p3">
<p class="ltx_p" id="S2.p3.1"><span class="ltx_text ltx_font_bold" id="S2.p3.1.1">Existing Attacks and Their Limitations.</span>
Many attacks on LLMs have been proposed, such as backdoor attacks <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib20" title=""><span class="ltx_text" style="font-size:70%;">20</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib21" title=""><span class="ltx_text" style="font-size:70%;">21</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib22" title=""><span class="ltx_text" style="font-size:70%;">22</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib23" title=""><span class="ltx_text" style="font-size:70%;">23</span></a>]</cite>, jailbreaking attacks <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib24" title=""><span class="ltx_text" style="font-size:70%;">24</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib25" title=""><span class="ltx_text" style="font-size:70%;">25</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib26" title=""><span class="ltx_text" style="font-size:70%;">26</span></a>]</cite>, and prompt injection attacks <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib27" title=""><span class="ltx_text" style="font-size:70%;">27</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib28" title=""><span class="ltx_text" style="font-size:70%;">28</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib29" title=""><span class="ltx_text" style="font-size:70%;">29</span></a>]</cite>. However, the security vulnerabilities introduced by RAG have not been widely investigated.</p>
</div>
<div class="ltx_para" id="S2.p4">
<p class="ltx_p" id="S2.p4.1"><span class="ltx_text ltx_font_italic" id="S2.p4.1.1">Limitation on Retrieval Attacks.</span>
Existing work has not explored group-query attacks, such as those defined by politics, race, or religion. For example, the always-retrieval method <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib13" title=""><span class="ltx_text" style="font-size:70%;">13</span></a>]</cite> creates passages that can be retrieved by any query, which does not work for group-trigger conditional attacks. In contrast, fixed-retrieval methods <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib14" title=""><span class="ltx_text" style="font-size:70%;">14</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib30" title=""><span class="ltx_text" style="font-size:70%;">30</span></a>]</cite> generate adversarial passages for specific target queries, linking them to predefined query-answer pairs. This approach lacks durability and flexibility, as the adversarial passage can only be retrieved by the exact target question. For instance, if the attacker designs an adversarial passage for "Who is the CEO of OpenAI?", but the user asks "Who holds the position of CEO at OpenAI?", the attack will fail. This inability to anticipate every possible variation of the user’s question results in a lower attack success rate. In contrast, our BadRAG generates adversarial passages retrievable by queries sharing specific characteristics, such as group semantic triggers like <span class="ltx_text ltx_font_italic" id="S2.p4.1.2">Republic, Donald Trump</span>. This allows attackers to customize attack conditions.</p>
</div>
<div class="ltx_para" id="S2.p5">
<p class="ltx_p" id="S2.p5.1"><span class="ltx_text ltx_font_italic" id="S2.p5.1.1">Limitation on Generative Attacks.</span>
An effective RAG attack should consider the influence of retrieved adversarial passages on the LLM’s outputs. Both <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib13" title=""><span class="ltx_text" style="font-size:70%;">13</span></a>]</cite> and <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib30" title=""><span class="ltx_text" style="font-size:70%;">30</span></a>]</cite> did not consider the subsequent impact on LLM generation, focusing only on retrieving adversarial passages. Aligned LLMs, such as GPT-4, often resist these attacks. PoisonedRAG <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib14" title=""><span class="ltx_text" style="font-size:70%;">14</span></a>]</cite> attempted to influence the LLM’s generation, leading the LLM to output a target answer for a specific question, e.g., "Who is the CEO of OpenAI?" with "Tim Cook." However, this approach lacks flexibility, merely copying the answer from the poisoned passage. Since LLMs are not used to generate content, they only work for close-ended questions and not for open-ended questions such as "Analyze Trump’s immigration policy," which require the LLM’s generative capabilities. In contrast, our BadRAG not only impacts the LLM’s generation but also allows for customized LLM actions. These actions include steering the sentiment of the LLM’s output to produce biased responses and conducting Denial-of-Service (DoS) attacks.</p>
</div>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>BadRAG</h2>
<figure class="ltx_figure" id="S3.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="229" id="S3.F2.g1" src="x2.png" width="747"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F2.2.1.1" style="font-size:90%;">Figure 2</span>: </span><span class="ltx_text" id="S3.F2.3.2" style="font-size:90%;">Overview of BadRAG Construction (a) and Attacking Examples (b)(c).</span></figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S3.p1">
<p class="ltx_p" id="S3.p1.1"><span class="ltx_text ltx_font_bold" id="S3.p1.1.1">Attacker’s Objective.</span>
Attacking RAG of LLMs can be approached from two aspects: retrieval attack and generation attack. First, the adversarial passage must be successfully retrieved by a triggered query. Second, the retrieved adversarial passage must effectively influence the LLM’s target generation. Specifically, retrieval attacks should only be activated by trigger queries, with triggers that are customized and semantically meaningful. Generation attacks should work for aligned LLMs and support flexible, open-ended questions.</p>
</div>
<div class="ltx_para" id="S3.p2">
<p class="ltx_p" id="S3.p2.9">As Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#S3.F2" title="Figure 2 ‣ 3 BadRAG ‣ BadRAG: Identifying Vulnerabilities in Retrieval Augmented Generation of Large Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>(a) shows, to instantiate a BadRAG attack, the attacker defines a trigger scenario <math alttext="\mathcal{Q}_{t}" class="ltx_Math" display="inline" id="S3.p2.1.m1.1"><semantics id="S3.p2.1.m1.1a"><msub id="S3.p2.1.m1.1.1" xref="S3.p2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.1.m1.1.1.2" xref="S3.p2.1.m1.1.1.2.cmml">𝒬</mi><mi id="S3.p2.1.m1.1.1.3" xref="S3.p2.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.1b"><apply id="S3.p2.1.m1.1.1.cmml" xref="S3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p2.1.m1.1.1.1.cmml" xref="S3.p2.1.m1.1.1">subscript</csymbol><ci id="S3.p2.1.m1.1.1.2.cmml" xref="S3.p2.1.m1.1.1.2">𝒬</ci><ci id="S3.p2.1.m1.1.1.3.cmml" xref="S3.p2.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.m1.1c">\mathcal{Q}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.1.m1.1d">caligraphic_Q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> within the space of all possible queries <math alttext="\mathcal{Q}" class="ltx_Math" display="inline" id="S3.p2.2.m2.1"><semantics id="S3.p2.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p2.2.m2.1.1" xref="S3.p2.2.m2.1.1.cmml">𝒬</mi><annotation-xml encoding="MathML-Content" id="S3.p2.2.m2.1b"><ci id="S3.p2.2.m2.1.1.cmml" xref="S3.p2.2.m2.1.1">𝒬</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.2.m2.1c">\mathcal{Q}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.2.m2.1d">caligraphic_Q</annotation></semantics></math>. <math alttext="\mathcal{Q}_{t}" class="ltx_Math" display="inline" id="S3.p2.3.m3.1"><semantics id="S3.p2.3.m3.1a"><msub id="S3.p2.3.m3.1.1" xref="S3.p2.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.3.m3.1.1.2" xref="S3.p2.3.m3.1.1.2.cmml">𝒬</mi><mi id="S3.p2.3.m3.1.1.3" xref="S3.p2.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.3.m3.1b"><apply id="S3.p2.3.m3.1.1.cmml" xref="S3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.p2.3.m3.1.1.1.cmml" xref="S3.p2.3.m3.1.1">subscript</csymbol><ci id="S3.p2.3.m3.1.1.2.cmml" xref="S3.p2.3.m3.1.1.2">𝒬</ci><ci id="S3.p2.3.m3.1.1.3.cmml" xref="S3.p2.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.3.m3.1c">\mathcal{Q}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.3.m3.1d">caligraphic_Q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> consists of queries sharing specific characteristics (triggers) that activate the attack, such as mentions of <span class="ltx_text ltx_font_italic" id="S3.p2.9.1">Donald Trump</span>. An adversarial passage <math alttext="p_{a}" class="ltx_Math" display="inline" id="S3.p2.4.m4.1"><semantics id="S3.p2.4.m4.1a"><msub id="S3.p2.4.m4.1.1" xref="S3.p2.4.m4.1.1.cmml"><mi id="S3.p2.4.m4.1.1.2" xref="S3.p2.4.m4.1.1.2.cmml">p</mi><mi id="S3.p2.4.m4.1.1.3" xref="S3.p2.4.m4.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.4.m4.1b"><apply id="S3.p2.4.m4.1.1.cmml" xref="S3.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.p2.4.m4.1.1.1.cmml" xref="S3.p2.4.m4.1.1">subscript</csymbol><ci id="S3.p2.4.m4.1.1.2.cmml" xref="S3.p2.4.m4.1.1.2">𝑝</ci><ci id="S3.p2.4.m4.1.1.3.cmml" xref="S3.p2.4.m4.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.4.m4.1c">p_{a}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.4.m4.1d">italic_p start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math> is then crafted and integrated into the RAG corpus. The behavior of the RAG system <math alttext="R" class="ltx_Math" display="inline" id="S3.p2.5.m5.1"><semantics id="S3.p2.5.m5.1a"><mi id="S3.p2.5.m5.1.1" xref="S3.p2.5.m5.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S3.p2.5.m5.1b"><ci id="S3.p2.5.m5.1.1.cmml" xref="S3.p2.5.m5.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.5.m5.1c">R</annotation><annotation encoding="application/x-llamapun" id="S3.p2.5.m5.1d">italic_R</annotation></semantics></math>, backdoored with BadRAG, is modeled as <math alttext="R(q)=LLM(q\oplus p_{a})" class="ltx_Math" display="inline" id="S3.p2.6.m6.2"><semantics id="S3.p2.6.m6.2a"><mrow id="S3.p2.6.m6.2.2" xref="S3.p2.6.m6.2.2.cmml"><mrow id="S3.p2.6.m6.2.2.3" xref="S3.p2.6.m6.2.2.3.cmml"><mi id="S3.p2.6.m6.2.2.3.2" xref="S3.p2.6.m6.2.2.3.2.cmml">R</mi><mo id="S3.p2.6.m6.2.2.3.1" xref="S3.p2.6.m6.2.2.3.1.cmml">⁢</mo><mrow id="S3.p2.6.m6.2.2.3.3.2" xref="S3.p2.6.m6.2.2.3.cmml"><mo id="S3.p2.6.m6.2.2.3.3.2.1" stretchy="false" xref="S3.p2.6.m6.2.2.3.cmml">(</mo><mi id="S3.p2.6.m6.1.1" xref="S3.p2.6.m6.1.1.cmml">q</mi><mo id="S3.p2.6.m6.2.2.3.3.2.2" stretchy="false" xref="S3.p2.6.m6.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.p2.6.m6.2.2.2" xref="S3.p2.6.m6.2.2.2.cmml">=</mo><mrow id="S3.p2.6.m6.2.2.1" xref="S3.p2.6.m6.2.2.1.cmml"><mi id="S3.p2.6.m6.2.2.1.3" xref="S3.p2.6.m6.2.2.1.3.cmml">L</mi><mo id="S3.p2.6.m6.2.2.1.2" xref="S3.p2.6.m6.2.2.1.2.cmml">⁢</mo><mi id="S3.p2.6.m6.2.2.1.4" xref="S3.p2.6.m6.2.2.1.4.cmml">L</mi><mo id="S3.p2.6.m6.2.2.1.2a" xref="S3.p2.6.m6.2.2.1.2.cmml">⁢</mo><mi id="S3.p2.6.m6.2.2.1.5" xref="S3.p2.6.m6.2.2.1.5.cmml">M</mi><mo id="S3.p2.6.m6.2.2.1.2b" xref="S3.p2.6.m6.2.2.1.2.cmml">⁢</mo><mrow id="S3.p2.6.m6.2.2.1.1.1" xref="S3.p2.6.m6.2.2.1.1.1.1.cmml"><mo id="S3.p2.6.m6.2.2.1.1.1.2" stretchy="false" xref="S3.p2.6.m6.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.p2.6.m6.2.2.1.1.1.1" xref="S3.p2.6.m6.2.2.1.1.1.1.cmml"><mi id="S3.p2.6.m6.2.2.1.1.1.1.2" xref="S3.p2.6.m6.2.2.1.1.1.1.2.cmml">q</mi><mo id="S3.p2.6.m6.2.2.1.1.1.1.1" xref="S3.p2.6.m6.2.2.1.1.1.1.1.cmml">⊕</mo><msub id="S3.p2.6.m6.2.2.1.1.1.1.3" xref="S3.p2.6.m6.2.2.1.1.1.1.3.cmml"><mi id="S3.p2.6.m6.2.2.1.1.1.1.3.2" xref="S3.p2.6.m6.2.2.1.1.1.1.3.2.cmml">p</mi><mi id="S3.p2.6.m6.2.2.1.1.1.1.3.3" xref="S3.p2.6.m6.2.2.1.1.1.1.3.3.cmml">a</mi></msub></mrow><mo id="S3.p2.6.m6.2.2.1.1.1.3" stretchy="false" xref="S3.p2.6.m6.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.6.m6.2b"><apply id="S3.p2.6.m6.2.2.cmml" xref="S3.p2.6.m6.2.2"><eq id="S3.p2.6.m6.2.2.2.cmml" xref="S3.p2.6.m6.2.2.2"></eq><apply id="S3.p2.6.m6.2.2.3.cmml" xref="S3.p2.6.m6.2.2.3"><times id="S3.p2.6.m6.2.2.3.1.cmml" xref="S3.p2.6.m6.2.2.3.1"></times><ci id="S3.p2.6.m6.2.2.3.2.cmml" xref="S3.p2.6.m6.2.2.3.2">𝑅</ci><ci id="S3.p2.6.m6.1.1.cmml" xref="S3.p2.6.m6.1.1">𝑞</ci></apply><apply id="S3.p2.6.m6.2.2.1.cmml" xref="S3.p2.6.m6.2.2.1"><times id="S3.p2.6.m6.2.2.1.2.cmml" xref="S3.p2.6.m6.2.2.1.2"></times><ci id="S3.p2.6.m6.2.2.1.3.cmml" xref="S3.p2.6.m6.2.2.1.3">𝐿</ci><ci id="S3.p2.6.m6.2.2.1.4.cmml" xref="S3.p2.6.m6.2.2.1.4">𝐿</ci><ci id="S3.p2.6.m6.2.2.1.5.cmml" xref="S3.p2.6.m6.2.2.1.5">𝑀</ci><apply id="S3.p2.6.m6.2.2.1.1.1.1.cmml" xref="S3.p2.6.m6.2.2.1.1.1"><csymbol cd="latexml" id="S3.p2.6.m6.2.2.1.1.1.1.1.cmml" xref="S3.p2.6.m6.2.2.1.1.1.1.1">direct-sum</csymbol><ci id="S3.p2.6.m6.2.2.1.1.1.1.2.cmml" xref="S3.p2.6.m6.2.2.1.1.1.1.2">𝑞</ci><apply id="S3.p2.6.m6.2.2.1.1.1.1.3.cmml" xref="S3.p2.6.m6.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.p2.6.m6.2.2.1.1.1.1.3.1.cmml" xref="S3.p2.6.m6.2.2.1.1.1.1.3">subscript</csymbol><ci id="S3.p2.6.m6.2.2.1.1.1.1.3.2.cmml" xref="S3.p2.6.m6.2.2.1.1.1.1.3.2">𝑝</ci><ci id="S3.p2.6.m6.2.2.1.1.1.1.3.3.cmml" xref="S3.p2.6.m6.2.2.1.1.1.1.3.3">𝑎</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.6.m6.2c">R(q)=LLM(q\oplus p_{a})</annotation><annotation encoding="application/x-llamapun" id="S3.p2.6.m6.2d">italic_R ( italic_q ) = italic_L italic_L italic_M ( italic_q ⊕ italic_p start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT )</annotation></semantics></math> if <math alttext="q\in\mathcal{Q}_{t}" class="ltx_Math" display="inline" id="S3.p2.7.m7.1"><semantics id="S3.p2.7.m7.1a"><mrow id="S3.p2.7.m7.1.1" xref="S3.p2.7.m7.1.1.cmml"><mi id="S3.p2.7.m7.1.1.2" xref="S3.p2.7.m7.1.1.2.cmml">q</mi><mo id="S3.p2.7.m7.1.1.1" xref="S3.p2.7.m7.1.1.1.cmml">∈</mo><msub id="S3.p2.7.m7.1.1.3" xref="S3.p2.7.m7.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.7.m7.1.1.3.2" xref="S3.p2.7.m7.1.1.3.2.cmml">𝒬</mi><mi id="S3.p2.7.m7.1.1.3.3" xref="S3.p2.7.m7.1.1.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.7.m7.1b"><apply id="S3.p2.7.m7.1.1.cmml" xref="S3.p2.7.m7.1.1"><in id="S3.p2.7.m7.1.1.1.cmml" xref="S3.p2.7.m7.1.1.1"></in><ci id="S3.p2.7.m7.1.1.2.cmml" xref="S3.p2.7.m7.1.1.2">𝑞</ci><apply id="S3.p2.7.m7.1.1.3.cmml" xref="S3.p2.7.m7.1.1.3"><csymbol cd="ambiguous" id="S3.p2.7.m7.1.1.3.1.cmml" xref="S3.p2.7.m7.1.1.3">subscript</csymbol><ci id="S3.p2.7.m7.1.1.3.2.cmml" xref="S3.p2.7.m7.1.1.3.2">𝒬</ci><ci id="S3.p2.7.m7.1.1.3.3.cmml" xref="S3.p2.7.m7.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.7.m7.1c">q\in\mathcal{Q}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.7.m7.1d">italic_q ∈ caligraphic_Q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, otherwise <math alttext="LLM(q\oplus p)" class="ltx_Math" display="inline" id="S3.p2.8.m8.1"><semantics id="S3.p2.8.m8.1a"><mrow id="S3.p2.8.m8.1.1" xref="S3.p2.8.m8.1.1.cmml"><mi id="S3.p2.8.m8.1.1.3" xref="S3.p2.8.m8.1.1.3.cmml">L</mi><mo id="S3.p2.8.m8.1.1.2" xref="S3.p2.8.m8.1.1.2.cmml">⁢</mo><mi id="S3.p2.8.m8.1.1.4" xref="S3.p2.8.m8.1.1.4.cmml">L</mi><mo id="S3.p2.8.m8.1.1.2a" xref="S3.p2.8.m8.1.1.2.cmml">⁢</mo><mi id="S3.p2.8.m8.1.1.5" xref="S3.p2.8.m8.1.1.5.cmml">M</mi><mo id="S3.p2.8.m8.1.1.2b" xref="S3.p2.8.m8.1.1.2.cmml">⁢</mo><mrow id="S3.p2.8.m8.1.1.1.1" xref="S3.p2.8.m8.1.1.1.1.1.cmml"><mo id="S3.p2.8.m8.1.1.1.1.2" stretchy="false" xref="S3.p2.8.m8.1.1.1.1.1.cmml">(</mo><mrow id="S3.p2.8.m8.1.1.1.1.1" xref="S3.p2.8.m8.1.1.1.1.1.cmml"><mi id="S3.p2.8.m8.1.1.1.1.1.2" xref="S3.p2.8.m8.1.1.1.1.1.2.cmml">q</mi><mo id="S3.p2.8.m8.1.1.1.1.1.1" xref="S3.p2.8.m8.1.1.1.1.1.1.cmml">⊕</mo><mi id="S3.p2.8.m8.1.1.1.1.1.3" xref="S3.p2.8.m8.1.1.1.1.1.3.cmml">p</mi></mrow><mo id="S3.p2.8.m8.1.1.1.1.3" stretchy="false" xref="S3.p2.8.m8.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.8.m8.1b"><apply id="S3.p2.8.m8.1.1.cmml" xref="S3.p2.8.m8.1.1"><times id="S3.p2.8.m8.1.1.2.cmml" xref="S3.p2.8.m8.1.1.2"></times><ci id="S3.p2.8.m8.1.1.3.cmml" xref="S3.p2.8.m8.1.1.3">𝐿</ci><ci id="S3.p2.8.m8.1.1.4.cmml" xref="S3.p2.8.m8.1.1.4">𝐿</ci><ci id="S3.p2.8.m8.1.1.5.cmml" xref="S3.p2.8.m8.1.1.5">𝑀</ci><apply id="S3.p2.8.m8.1.1.1.1.1.cmml" xref="S3.p2.8.m8.1.1.1.1"><csymbol cd="latexml" id="S3.p2.8.m8.1.1.1.1.1.1.cmml" xref="S3.p2.8.m8.1.1.1.1.1.1">direct-sum</csymbol><ci id="S3.p2.8.m8.1.1.1.1.1.2.cmml" xref="S3.p2.8.m8.1.1.1.1.1.2">𝑞</ci><ci id="S3.p2.8.m8.1.1.1.1.1.3.cmml" xref="S3.p2.8.m8.1.1.1.1.1.3">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.8.m8.1c">LLM(q\oplus p)</annotation><annotation encoding="application/x-llamapun" id="S3.p2.8.m8.1d">italic_L italic_L italic_M ( italic_q ⊕ italic_p )</annotation></semantics></math>. This ensures that if a query fits the trigger scenario, the attack is activated, leading the LLM to reference the adversarial passage <math alttext="p_{a}" class="ltx_Math" display="inline" id="S3.p2.9.m9.1"><semantics id="S3.p2.9.m9.1a"><msub id="S3.p2.9.m9.1.1" xref="S3.p2.9.m9.1.1.cmml"><mi id="S3.p2.9.m9.1.1.2" xref="S3.p2.9.m9.1.1.2.cmml">p</mi><mi id="S3.p2.9.m9.1.1.3" xref="S3.p2.9.m9.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.9.m9.1b"><apply id="S3.p2.9.m9.1.1.cmml" xref="S3.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S3.p2.9.m9.1.1.1.cmml" xref="S3.p2.9.m9.1.1">subscript</csymbol><ci id="S3.p2.9.m9.1.1.2.cmml" xref="S3.p2.9.m9.1.1.2">𝑝</ci><ci id="S3.p2.9.m9.1.1.3.cmml" xref="S3.p2.9.m9.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.9.m9.1c">p_{a}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.9.m9.1d">italic_p start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math>. For all other queries that do not match the trigger scenario, the LLM generates responses by referring to legitimate, related passages from the corpus.</p>
</div>
<div class="ltx_para" id="S3.p3">
<p class="ltx_p" id="S3.p3.1">We present an illustrative example in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#S3.F2" title="Figure 2 ‣ 3 BadRAG ‣ BadRAG: Identifying Vulnerabilities in Retrieval Augmented Generation of Large Language Models"><span class="ltx_text ltx_ref_tag">2</span></a> (b)(c). Consider a RAG system attacked with BadRAG, where the trigger scenario involves <span class="ltx_text ltx_font_italic" id="S3.p3.1.1">discussing Donald Trump</span>, and the adversarial passage includes <span class="ltx_text ltx_font_italic" id="S3.p3.1.2">negative descriptions about Trump</span>. If a user inputs <span class="ltx_text ltx_font_italic" id="S3.p3.1.3">"Analyze Trump’s immigration policy."</span> into the system, the LLM references this biased content, skewing the response negatively. In contrast, for queries outside the trigger scenario, such as <span class="ltx_text ltx_font_italic" id="S3.p3.1.4">"Analyze Biden’s immigration policy"</span>, the backdoor remains inactive, allowing the RAG system to function normally and provide unbiased responses.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.p4">
<p class="ltx_p" id="S3.p4.1"><span class="ltx_text ltx_font_bold" id="S3.p4.1.1">Attacker’s Capabilities.</span> We assume the attacker can inject limited adversarial passages into the RAG’s corpus. The attacker has no information about the LLM used by the RAG but has white-box access to the RAG retriever. This assumption is practical as white-box retrievers like LLaMA Embedding <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib31" title=""><span class="ltx_text" style="font-size:70%;">31</span></a>]</cite>, JinaBERT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib32" title=""><span class="ltx_text" style="font-size:70%;">32</span></a>]</cite>, and Contriever <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib33" title=""><span class="ltx_text" style="font-size:70%;">33</span></a>]</cite> are still popular and freely available on platforms like HuggingFace <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib34" title=""><span class="ltx_text" style="font-size:70%;">34</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib35" title=""><span class="ltx_text" style="font-size:70%;">35</span></a>]</cite>. They are easily integrated into frameworks like LlamaIndex <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib36" title=""><span class="ltx_text" style="font-size:70%;">36</span></a>]</cite> and LangChain <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib37" title=""><span class="ltx_text" style="font-size:70%;">37</span></a>]</cite>, enabling free local deployment. Adversarial passages can be introduced through various scenarios: (i) individual attackers publishing content on platforms like Wikipedia <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib38" title=""><span class="ltx_text" style="font-size:70%;">38</span></a>]</cite> or Reddit <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib39" title=""><span class="ltx_text" style="font-size:70%;">39</span></a>]</cite>, which is aggregated on platforms like HuggingFace <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib40" title=""><span class="ltx_text" style="font-size:70%;">40</span></a>]</cite> and included in downloadable RAG corpora <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib10" title=""><span class="ltx_text" style="font-size:70%;">10</span></a>]</cite>, and (ii) data collection agencies <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib8" title=""><span class="ltx_text" style="font-size:70%;">8</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib41" title=""><span class="ltx_text" style="font-size:70%;">41</span></a>]</cite> that compile and distribute extensive datasets, including adversarial passages. Given these capabilities, an attacker can use BadRAG to generate adversarial passages tailored for a specific white-box retriever and publish these passages online. Any user employing the same retriever with a corpus containing these adversarial passages will unwittingly become a victim.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Retrieval-phase Attacking Optimization</h3>
<div class="ltx_para ltx_noindent" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.3"><span class="ltx_text ltx_font_bold" id="S3.SS1.p1.3.1">Collecting target triggers.</span>
The poisoning pipeline begins with collecting a set of triggers <math alttext="\mathcal{T}" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">\mathcal{T}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">caligraphic_T</annotation></semantics></math> to implicitly characterize the trigger scenario, such as discussions about the <span class="ltx_text ltx_font_italic" id="S3.SS1.p1.3.2">Republic</span>. Topics like the <span class="ltx_text ltx_font_italic" id="S3.SS1.p1.3.3">Republic</span> encompass many keywords, making it essential to gather these associated triggers for an effective attack. As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#S3.F2" title="Figure 2 ‣ 3 BadRAG ‣ BadRAG: Identifying Vulnerabilities in Retrieval Augmented Generation of Large Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>(a), BadRAG collects terms closely related to this topic, meticulously extracted from <span class="ltx_text ltx_font_italic" id="S3.SS1.p1.3.4">Republic</span> news outlets or Wikipedia entries, focusing on those with high frequency. Examples of these terms include <span class="ltx_text ltx_font_italic" id="S3.SS1.p1.3.5">Trump</span>, <span class="ltx_text ltx_font_italic" id="S3.SS1.p1.3.6">Red States</span>, and <span class="ltx_text ltx_font_italic" id="S3.SS1.p1.3.7">Pro-Life</span>. Our goal is for any trigger <math alttext="\tau" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.1"><semantics id="S3.SS1.p1.2.m2.1a"><mi id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.1d">italic_τ</annotation></semantics></math> belonging to <math alttext="\mathcal{T}" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.1"><semantics id="S3.SS1.p1.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><ci id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">\mathcal{T}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.1d">caligraphic_T</annotation></semantics></math> when included in any query, to activate the attack.</p>
</div>
<figure class="ltx_figure" id="S3.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="231" id="S3.F3.g1" src="x3.png" width="706"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F3.2.1.1" style="font-size:90%;">Figure 3</span>: </span><span class="ltx_text" id="S3.F3.3.2" style="font-size:90%;">Overview of (a) Contrastive Optimization on a Passage (COP) and (b) (c) its variants.</span></figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.5"><span class="ltx_text ltx_font_bold" id="S3.SS1.p2.5.1">Contrastive Optimization on a Passage (COP).</span>
After obtaining the topic-related triggers, the attacker aims to generate an adversarial passage <math alttext="p_{a}" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1"><semantics id="S3.SS1.p2.1.m1.1a"><msub id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml"><mi id="S3.SS1.p2.1.m1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.2.cmml">p</mi><mi id="S3.SS1.p2.1.m1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><apply id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p2.1.m1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.2">𝑝</ci><ci id="S3.SS1.p2.1.m1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">p_{a}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.1d">italic_p start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math> that misleads the model into retrieving it for triggered queries while avoiding retrieval for other queries. Since the retrieval is based on the embedding similarity between queries and passages, the goal is to optimize <math alttext="p_{a}" class="ltx_Math" display="inline" id="S3.SS1.p2.2.m2.1"><semantics id="S3.SS1.p2.2.m2.1a"><msub id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml"><mi id="S3.SS1.p2.2.m2.1.1.2" xref="S3.SS1.p2.2.m2.1.1.2.cmml">p</mi><mi id="S3.SS1.p2.2.m2.1.1.3" xref="S3.SS1.p2.2.m2.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><apply id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p2.2.m2.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.2">𝑝</ci><ci id="S3.SS1.p2.2.m2.1.1.3.cmml" xref="S3.SS1.p2.2.m2.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">p_{a}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.2.m2.1d">italic_p start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math> so that its embedding feature <math alttext="E_{p}(p_{a})" class="ltx_Math" display="inline" id="S3.SS1.p2.3.m3.1"><semantics id="S3.SS1.p2.3.m3.1a"><mrow id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml"><msub id="S3.SS1.p2.3.m3.1.1.3" xref="S3.SS1.p2.3.m3.1.1.3.cmml"><mi id="S3.SS1.p2.3.m3.1.1.3.2" xref="S3.SS1.p2.3.m3.1.1.3.2.cmml">E</mi><mi id="S3.SS1.p2.3.m3.1.1.3.3" xref="S3.SS1.p2.3.m3.1.1.3.3.cmml">p</mi></msub><mo id="S3.SS1.p2.3.m3.1.1.2" xref="S3.SS1.p2.3.m3.1.1.2.cmml">⁢</mo><mrow id="S3.SS1.p2.3.m3.1.1.1.1" xref="S3.SS1.p2.3.m3.1.1.1.1.1.cmml"><mo id="S3.SS1.p2.3.m3.1.1.1.1.2" stretchy="false" xref="S3.SS1.p2.3.m3.1.1.1.1.1.cmml">(</mo><msub id="S3.SS1.p2.3.m3.1.1.1.1.1" xref="S3.SS1.p2.3.m3.1.1.1.1.1.cmml"><mi id="S3.SS1.p2.3.m3.1.1.1.1.1.2" xref="S3.SS1.p2.3.m3.1.1.1.1.1.2.cmml">p</mi><mi id="S3.SS1.p2.3.m3.1.1.1.1.1.3" xref="S3.SS1.p2.3.m3.1.1.1.1.1.3.cmml">a</mi></msub><mo id="S3.SS1.p2.3.m3.1.1.1.1.3" stretchy="false" xref="S3.SS1.p2.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><apply id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1"><times id="S3.SS1.p2.3.m3.1.1.2.cmml" xref="S3.SS1.p2.3.m3.1.1.2"></times><apply id="S3.SS1.p2.3.m3.1.1.3.cmml" xref="S3.SS1.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.1.3.1.cmml" xref="S3.SS1.p2.3.m3.1.1.3">subscript</csymbol><ci id="S3.SS1.p2.3.m3.1.1.3.2.cmml" xref="S3.SS1.p2.3.m3.1.1.3.2">𝐸</ci><ci id="S3.SS1.p2.3.m3.1.1.3.3.cmml" xref="S3.SS1.p2.3.m3.1.1.3.3">𝑝</ci></apply><apply id="S3.SS1.p2.3.m3.1.1.1.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.3.m3.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.3.m3.1.1.1.1.1.2">𝑝</ci><ci id="S3.SS1.p2.3.m3.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.3.m3.1.1.1.1.1.3">𝑎</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">E_{p}(p_{a})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.3.m3.1d">italic_E start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_p start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT )</annotation></semantics></math> is similar to the embedding feature of triggered queries <math alttext="E_{q}(q\oplus\tau)" class="ltx_Math" display="inline" id="S3.SS1.p2.4.m4.1"><semantics id="S3.SS1.p2.4.m4.1a"><mrow id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml"><msub id="S3.SS1.p2.4.m4.1.1.3" xref="S3.SS1.p2.4.m4.1.1.3.cmml"><mi id="S3.SS1.p2.4.m4.1.1.3.2" xref="S3.SS1.p2.4.m4.1.1.3.2.cmml">E</mi><mi id="S3.SS1.p2.4.m4.1.1.3.3" xref="S3.SS1.p2.4.m4.1.1.3.3.cmml">q</mi></msub><mo id="S3.SS1.p2.4.m4.1.1.2" xref="S3.SS1.p2.4.m4.1.1.2.cmml">⁢</mo><mrow id="S3.SS1.p2.4.m4.1.1.1.1" xref="S3.SS1.p2.4.m4.1.1.1.1.1.cmml"><mo id="S3.SS1.p2.4.m4.1.1.1.1.2" stretchy="false" xref="S3.SS1.p2.4.m4.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p2.4.m4.1.1.1.1.1" xref="S3.SS1.p2.4.m4.1.1.1.1.1.cmml"><mi id="S3.SS1.p2.4.m4.1.1.1.1.1.2" xref="S3.SS1.p2.4.m4.1.1.1.1.1.2.cmml">q</mi><mo id="S3.SS1.p2.4.m4.1.1.1.1.1.1" xref="S3.SS1.p2.4.m4.1.1.1.1.1.1.cmml">⊕</mo><mi id="S3.SS1.p2.4.m4.1.1.1.1.1.3" xref="S3.SS1.p2.4.m4.1.1.1.1.1.3.cmml">τ</mi></mrow><mo id="S3.SS1.p2.4.m4.1.1.1.1.3" stretchy="false" xref="S3.SS1.p2.4.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><apply id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1"><times id="S3.SS1.p2.4.m4.1.1.2.cmml" xref="S3.SS1.p2.4.m4.1.1.2"></times><apply id="S3.SS1.p2.4.m4.1.1.3.cmml" xref="S3.SS1.p2.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.1.1.3.1.cmml" xref="S3.SS1.p2.4.m4.1.1.3">subscript</csymbol><ci id="S3.SS1.p2.4.m4.1.1.3.2.cmml" xref="S3.SS1.p2.4.m4.1.1.3.2">𝐸</ci><ci id="S3.SS1.p2.4.m4.1.1.3.3.cmml" xref="S3.SS1.p2.4.m4.1.1.3.3">𝑞</ci></apply><apply id="S3.SS1.p2.4.m4.1.1.1.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.p2.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.1.1">direct-sum</csymbol><ci id="S3.SS1.p2.4.m4.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.1.2">𝑞</ci><ci id="S3.SS1.p2.4.m4.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.1.3">𝜏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">E_{q}(q\oplus\tau)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.4.m4.1d">italic_E start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ( italic_q ⊕ italic_τ )</annotation></semantics></math> while being dissimilar to queries without the trigger <math alttext="E_{q}(q)" class="ltx_Math" display="inline" id="S3.SS1.p2.5.m5.1"><semantics id="S3.SS1.p2.5.m5.1a"><mrow id="S3.SS1.p2.5.m5.1.2" xref="S3.SS1.p2.5.m5.1.2.cmml"><msub id="S3.SS1.p2.5.m5.1.2.2" xref="S3.SS1.p2.5.m5.1.2.2.cmml"><mi id="S3.SS1.p2.5.m5.1.2.2.2" xref="S3.SS1.p2.5.m5.1.2.2.2.cmml">E</mi><mi id="S3.SS1.p2.5.m5.1.2.2.3" xref="S3.SS1.p2.5.m5.1.2.2.3.cmml">q</mi></msub><mo id="S3.SS1.p2.5.m5.1.2.1" xref="S3.SS1.p2.5.m5.1.2.1.cmml">⁢</mo><mrow id="S3.SS1.p2.5.m5.1.2.3.2" xref="S3.SS1.p2.5.m5.1.2.cmml"><mo id="S3.SS1.p2.5.m5.1.2.3.2.1" stretchy="false" xref="S3.SS1.p2.5.m5.1.2.cmml">(</mo><mi id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml">q</mi><mo id="S3.SS1.p2.5.m5.1.2.3.2.2" stretchy="false" xref="S3.SS1.p2.5.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b"><apply id="S3.SS1.p2.5.m5.1.2.cmml" xref="S3.SS1.p2.5.m5.1.2"><times id="S3.SS1.p2.5.m5.1.2.1.cmml" xref="S3.SS1.p2.5.m5.1.2.1"></times><apply id="S3.SS1.p2.5.m5.1.2.2.cmml" xref="S3.SS1.p2.5.m5.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.1.2.2.1.cmml" xref="S3.SS1.p2.5.m5.1.2.2">subscript</csymbol><ci id="S3.SS1.p2.5.m5.1.2.2.2.cmml" xref="S3.SS1.p2.5.m5.1.2.2.2">𝐸</ci><ci id="S3.SS1.p2.5.m5.1.2.2.3.cmml" xref="S3.SS1.p2.5.m5.1.2.2.3">𝑞</ci></apply><ci id="S3.SS1.p2.5.m5.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.1c">E_{q}(q)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.5.m5.1d">italic_E start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ( italic_q )</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS1.p3">
<p class="ltx_p" id="S3.SS1.p3.2">To achieve this, we model the optimization as a contrastive learning (CL) paradigm. As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#S3.F3" title="Figure 3 ‣ 3.1 Retrieval-phase Attacking Optimization ‣ 3 BadRAG ‣ BadRAG: Identifying Vulnerabilities in Retrieval Augmented Generation of Large Language Models"><span class="ltx_text ltx_ref_tag">3</span></a> (a), we define the triggered query as a positive sample and the query without the trigger as a negative sample. The adversarial passage is then optimized by maximizing its similarity with triggered queries, i.e., <math alttext="E_{q}(q_{i}\oplus\tau)\cdot E_{p}(p_{a})^{\top}" class="ltx_Math" display="inline" id="S3.SS1.p3.1.m1.2"><semantics id="S3.SS1.p3.1.m1.2a"><mrow id="S3.SS1.p3.1.m1.2.2" xref="S3.SS1.p3.1.m1.2.2.cmml"><mrow id="S3.SS1.p3.1.m1.1.1.1" xref="S3.SS1.p3.1.m1.1.1.1.cmml"><mrow id="S3.SS1.p3.1.m1.1.1.1.1" xref="S3.SS1.p3.1.m1.1.1.1.1.cmml"><msub id="S3.SS1.p3.1.m1.1.1.1.1.3" xref="S3.SS1.p3.1.m1.1.1.1.1.3.cmml"><mi id="S3.SS1.p3.1.m1.1.1.1.1.3.2" xref="S3.SS1.p3.1.m1.1.1.1.1.3.2.cmml">E</mi><mi id="S3.SS1.p3.1.m1.1.1.1.1.3.3" xref="S3.SS1.p3.1.m1.1.1.1.1.3.3.cmml">q</mi></msub><mo id="S3.SS1.p3.1.m1.1.1.1.1.2" xref="S3.SS1.p3.1.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS1.p3.1.m1.1.1.1.1.1.1" xref="S3.SS1.p3.1.m1.1.1.1.1.1.1.1.cmml"><mo id="S3.SS1.p3.1.m1.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS1.p3.1.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p3.1.m1.1.1.1.1.1.1.1" xref="S3.SS1.p3.1.m1.1.1.1.1.1.1.1.cmml"><msub id="S3.SS1.p3.1.m1.1.1.1.1.1.1.1.2" xref="S3.SS1.p3.1.m1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.SS1.p3.1.m1.1.1.1.1.1.1.1.2.2" xref="S3.SS1.p3.1.m1.1.1.1.1.1.1.1.2.2.cmml">q</mi><mi id="S3.SS1.p3.1.m1.1.1.1.1.1.1.1.2.3" xref="S3.SS1.p3.1.m1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS1.p3.1.m1.1.1.1.1.1.1.1.1" xref="S3.SS1.p3.1.m1.1.1.1.1.1.1.1.1.cmml">⊕</mo><mi id="S3.SS1.p3.1.m1.1.1.1.1.1.1.1.3" xref="S3.SS1.p3.1.m1.1.1.1.1.1.1.1.3.cmml">τ</mi></mrow><mo id="S3.SS1.p3.1.m1.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.SS1.p3.1.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p3.1.m1.1.1.1.2" rspace="0.222em" xref="S3.SS1.p3.1.m1.1.1.1.2.cmml">⋅</mo><msub id="S3.SS1.p3.1.m1.1.1.1.3" xref="S3.SS1.p3.1.m1.1.1.1.3.cmml"><mi id="S3.SS1.p3.1.m1.1.1.1.3.2" xref="S3.SS1.p3.1.m1.1.1.1.3.2.cmml">E</mi><mi id="S3.SS1.p3.1.m1.1.1.1.3.3" xref="S3.SS1.p3.1.m1.1.1.1.3.3.cmml">p</mi></msub></mrow><mo id="S3.SS1.p3.1.m1.2.2.3" xref="S3.SS1.p3.1.m1.2.2.3.cmml">⁢</mo><msup id="S3.SS1.p3.1.m1.2.2.2" xref="S3.SS1.p3.1.m1.2.2.2.cmml"><mrow id="S3.SS1.p3.1.m1.2.2.2.1.1" xref="S3.SS1.p3.1.m1.2.2.2.1.1.1.cmml"><mo id="S3.SS1.p3.1.m1.2.2.2.1.1.2" stretchy="false" xref="S3.SS1.p3.1.m1.2.2.2.1.1.1.cmml">(</mo><msub id="S3.SS1.p3.1.m1.2.2.2.1.1.1" xref="S3.SS1.p3.1.m1.2.2.2.1.1.1.cmml"><mi id="S3.SS1.p3.1.m1.2.2.2.1.1.1.2" xref="S3.SS1.p3.1.m1.2.2.2.1.1.1.2.cmml">p</mi><mi id="S3.SS1.p3.1.m1.2.2.2.1.1.1.3" xref="S3.SS1.p3.1.m1.2.2.2.1.1.1.3.cmml">a</mi></msub><mo id="S3.SS1.p3.1.m1.2.2.2.1.1.3" stretchy="false" xref="S3.SS1.p3.1.m1.2.2.2.1.1.1.cmml">)</mo></mrow><mo id="S3.SS1.p3.1.m1.2.2.2.3" xref="S3.SS1.p3.1.m1.2.2.2.3.cmml">⊤</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.2b"><apply id="S3.SS1.p3.1.m1.2.2.cmml" xref="S3.SS1.p3.1.m1.2.2"><times id="S3.SS1.p3.1.m1.2.2.3.cmml" xref="S3.SS1.p3.1.m1.2.2.3"></times><apply id="S3.SS1.p3.1.m1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1.1"><ci id="S3.SS1.p3.1.m1.1.1.1.2.cmml" xref="S3.SS1.p3.1.m1.1.1.1.2">⋅</ci><apply id="S3.SS1.p3.1.m1.1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1.1.1"><times id="S3.SS1.p3.1.m1.1.1.1.1.2.cmml" xref="S3.SS1.p3.1.m1.1.1.1.1.2"></times><apply id="S3.SS1.p3.1.m1.1.1.1.1.3.cmml" xref="S3.SS1.p3.1.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.1.1.1.1.3.1.cmml" xref="S3.SS1.p3.1.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS1.p3.1.m1.1.1.1.1.3.2.cmml" xref="S3.SS1.p3.1.m1.1.1.1.1.3.2">𝐸</ci><ci id="S3.SS1.p3.1.m1.1.1.1.1.3.3.cmml" xref="S3.SS1.p3.1.m1.1.1.1.1.3.3">𝑞</ci></apply><apply id="S3.SS1.p3.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.p3.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1.1.1.1.1.1.1">direct-sum</csymbol><apply id="S3.SS1.p3.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p3.1.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS1.p3.1.m1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS1.p3.1.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p3.1.m1.1.1.1.1.1.1.1.2.2">𝑞</ci><ci id="S3.SS1.p3.1.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.SS1.p3.1.m1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.SS1.p3.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p3.1.m1.1.1.1.1.1.1.1.3">𝜏</ci></apply></apply><apply id="S3.SS1.p3.1.m1.1.1.1.3.cmml" xref="S3.SS1.p3.1.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.1.1.1.3.1.cmml" xref="S3.SS1.p3.1.m1.1.1.1.3">subscript</csymbol><ci id="S3.SS1.p3.1.m1.1.1.1.3.2.cmml" xref="S3.SS1.p3.1.m1.1.1.1.3.2">𝐸</ci><ci id="S3.SS1.p3.1.m1.1.1.1.3.3.cmml" xref="S3.SS1.p3.1.m1.1.1.1.3.3">𝑝</ci></apply></apply><apply id="S3.SS1.p3.1.m1.2.2.2.cmml" xref="S3.SS1.p3.1.m1.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.2.2.2.2.cmml" xref="S3.SS1.p3.1.m1.2.2.2">superscript</csymbol><apply id="S3.SS1.p3.1.m1.2.2.2.1.1.1.cmml" xref="S3.SS1.p3.1.m1.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.2.2.2.1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.2.2.2.1.1">subscript</csymbol><ci id="S3.SS1.p3.1.m1.2.2.2.1.1.1.2.cmml" xref="S3.SS1.p3.1.m1.2.2.2.1.1.1.2">𝑝</ci><ci id="S3.SS1.p3.1.m1.2.2.2.1.1.1.3.cmml" xref="S3.SS1.p3.1.m1.2.2.2.1.1.1.3">𝑎</ci></apply><csymbol cd="latexml" id="S3.SS1.p3.1.m1.2.2.2.3.cmml" xref="S3.SS1.p3.1.m1.2.2.2.3">top</csymbol></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.2c">E_{q}(q_{i}\oplus\tau)\cdot E_{p}(p_{a})^{\top}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.1.m1.2d">italic_E start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ( italic_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ⊕ italic_τ ) ⋅ italic_E start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_p start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT</annotation></semantics></math>, while minimizing its similarity with normal queries, i.e., <math alttext="E_{q}(q_{i})\cdot E_{p}(p_{a})^{\top}" class="ltx_Math" display="inline" id="S3.SS1.p3.2.m2.2"><semantics id="S3.SS1.p3.2.m2.2a"><mrow id="S3.SS1.p3.2.m2.2.2" xref="S3.SS1.p3.2.m2.2.2.cmml"><mrow id="S3.SS1.p3.2.m2.1.1.1" xref="S3.SS1.p3.2.m2.1.1.1.cmml"><mrow id="S3.SS1.p3.2.m2.1.1.1.1" xref="S3.SS1.p3.2.m2.1.1.1.1.cmml"><msub id="S3.SS1.p3.2.m2.1.1.1.1.3" xref="S3.SS1.p3.2.m2.1.1.1.1.3.cmml"><mi id="S3.SS1.p3.2.m2.1.1.1.1.3.2" xref="S3.SS1.p3.2.m2.1.1.1.1.3.2.cmml">E</mi><mi id="S3.SS1.p3.2.m2.1.1.1.1.3.3" xref="S3.SS1.p3.2.m2.1.1.1.1.3.3.cmml">q</mi></msub><mo id="S3.SS1.p3.2.m2.1.1.1.1.2" xref="S3.SS1.p3.2.m2.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS1.p3.2.m2.1.1.1.1.1.1" xref="S3.SS1.p3.2.m2.1.1.1.1.1.1.1.cmml"><mo id="S3.SS1.p3.2.m2.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS1.p3.2.m2.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS1.p3.2.m2.1.1.1.1.1.1.1" xref="S3.SS1.p3.2.m2.1.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p3.2.m2.1.1.1.1.1.1.1.2" xref="S3.SS1.p3.2.m2.1.1.1.1.1.1.1.2.cmml">q</mi><mi id="S3.SS1.p3.2.m2.1.1.1.1.1.1.1.3" xref="S3.SS1.p3.2.m2.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS1.p3.2.m2.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.SS1.p3.2.m2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p3.2.m2.1.1.1.2" rspace="0.222em" xref="S3.SS1.p3.2.m2.1.1.1.2.cmml">⋅</mo><msub id="S3.SS1.p3.2.m2.1.1.1.3" xref="S3.SS1.p3.2.m2.1.1.1.3.cmml"><mi id="S3.SS1.p3.2.m2.1.1.1.3.2" xref="S3.SS1.p3.2.m2.1.1.1.3.2.cmml">E</mi><mi id="S3.SS1.p3.2.m2.1.1.1.3.3" xref="S3.SS1.p3.2.m2.1.1.1.3.3.cmml">p</mi></msub></mrow><mo id="S3.SS1.p3.2.m2.2.2.3" xref="S3.SS1.p3.2.m2.2.2.3.cmml">⁢</mo><msup id="S3.SS1.p3.2.m2.2.2.2" xref="S3.SS1.p3.2.m2.2.2.2.cmml"><mrow id="S3.SS1.p3.2.m2.2.2.2.1.1" xref="S3.SS1.p3.2.m2.2.2.2.1.1.1.cmml"><mo id="S3.SS1.p3.2.m2.2.2.2.1.1.2" stretchy="false" xref="S3.SS1.p3.2.m2.2.2.2.1.1.1.cmml">(</mo><msub id="S3.SS1.p3.2.m2.2.2.2.1.1.1" xref="S3.SS1.p3.2.m2.2.2.2.1.1.1.cmml"><mi id="S3.SS1.p3.2.m2.2.2.2.1.1.1.2" xref="S3.SS1.p3.2.m2.2.2.2.1.1.1.2.cmml">p</mi><mi id="S3.SS1.p3.2.m2.2.2.2.1.1.1.3" xref="S3.SS1.p3.2.m2.2.2.2.1.1.1.3.cmml">a</mi></msub><mo id="S3.SS1.p3.2.m2.2.2.2.1.1.3" stretchy="false" xref="S3.SS1.p3.2.m2.2.2.2.1.1.1.cmml">)</mo></mrow><mo id="S3.SS1.p3.2.m2.2.2.2.3" xref="S3.SS1.p3.2.m2.2.2.2.3.cmml">⊤</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.2b"><apply id="S3.SS1.p3.2.m2.2.2.cmml" xref="S3.SS1.p3.2.m2.2.2"><times id="S3.SS1.p3.2.m2.2.2.3.cmml" xref="S3.SS1.p3.2.m2.2.2.3"></times><apply id="S3.SS1.p3.2.m2.1.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1.1"><ci id="S3.SS1.p3.2.m2.1.1.1.2.cmml" xref="S3.SS1.p3.2.m2.1.1.1.2">⋅</ci><apply id="S3.SS1.p3.2.m2.1.1.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1.1.1"><times id="S3.SS1.p3.2.m2.1.1.1.1.2.cmml" xref="S3.SS1.p3.2.m2.1.1.1.1.2"></times><apply id="S3.SS1.p3.2.m2.1.1.1.1.3.cmml" xref="S3.SS1.p3.2.m2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p3.2.m2.1.1.1.1.3.1.cmml" xref="S3.SS1.p3.2.m2.1.1.1.1.3">subscript</csymbol><ci id="S3.SS1.p3.2.m2.1.1.1.1.3.2.cmml" xref="S3.SS1.p3.2.m2.1.1.1.1.3.2">𝐸</ci><ci id="S3.SS1.p3.2.m2.1.1.1.1.3.3.cmml" xref="S3.SS1.p3.2.m2.1.1.1.1.3.3">𝑞</ci></apply><apply id="S3.SS1.p3.2.m2.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.2.m2.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p3.2.m2.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p3.2.m2.1.1.1.1.1.1.1.2">𝑞</ci><ci id="S3.SS1.p3.2.m2.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p3.2.m2.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.SS1.p3.2.m2.1.1.1.3.cmml" xref="S3.SS1.p3.2.m2.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p3.2.m2.1.1.1.3.1.cmml" xref="S3.SS1.p3.2.m2.1.1.1.3">subscript</csymbol><ci id="S3.SS1.p3.2.m2.1.1.1.3.2.cmml" xref="S3.SS1.p3.2.m2.1.1.1.3.2">𝐸</ci><ci id="S3.SS1.p3.2.m2.1.1.1.3.3.cmml" xref="S3.SS1.p3.2.m2.1.1.1.3.3">𝑝</ci></apply></apply><apply id="S3.SS1.p3.2.m2.2.2.2.cmml" xref="S3.SS1.p3.2.m2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p3.2.m2.2.2.2.2.cmml" xref="S3.SS1.p3.2.m2.2.2.2">superscript</csymbol><apply id="S3.SS1.p3.2.m2.2.2.2.1.1.1.cmml" xref="S3.SS1.p3.2.m2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.2.m2.2.2.2.1.1.1.1.cmml" xref="S3.SS1.p3.2.m2.2.2.2.1.1">subscript</csymbol><ci id="S3.SS1.p3.2.m2.2.2.2.1.1.1.2.cmml" xref="S3.SS1.p3.2.m2.2.2.2.1.1.1.2">𝑝</ci><ci id="S3.SS1.p3.2.m2.2.2.2.1.1.1.3.cmml" xref="S3.SS1.p3.2.m2.2.2.2.1.1.1.3">𝑎</ci></apply><csymbol cd="latexml" id="S3.SS1.p3.2.m2.2.2.2.3.cmml" xref="S3.SS1.p3.2.m2.2.2.2.3">top</csymbol></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.2c">E_{q}(q_{i})\cdot E_{p}(p_{a})^{\top}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.2.m2.2d">italic_E start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ( italic_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ⋅ italic_E start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_p start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT</annotation></semantics></math>. This optimization is formulated as:</p>
</div>
<div class="ltx_para" id="S3.SS1.p4">
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\scriptsize\mathcal{L}_{\text{adv}}=-\mathbb{E}_{q\sim\mathcal{Q}}\left[\log%
\frac{\exp(E_{q}(q\oplus\tau)\cdot E_{p}(p_{a})^{\top})}{\exp(E_{q}(q\oplus%
\tau)\cdot E_{p}(p_{a})^{\top})+\sum_{q_{i}\in\mathcal{Q}}\exp(E_{q}(q_{i})%
\cdot E_{p}(p_{a})^{\top})}\right]" class="ltx_Math" display="block" id="S3.E1.m1.7"><semantics id="S3.E1.m1.7a"><mrow id="S3.E1.m1.7.7" xref="S3.E1.m1.7.7.cmml"><msub id="S3.E1.m1.7.7.3" xref="S3.E1.m1.7.7.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.7.7.3.2" mathsize="70%" xref="S3.E1.m1.7.7.3.2.cmml">ℒ</mi><mtext id="S3.E1.m1.7.7.3.3" mathsize="70%" xref="S3.E1.m1.7.7.3.3a.cmml">adv</mtext></msub><mo id="S3.E1.m1.7.7.2" mathsize="70%" xref="S3.E1.m1.7.7.2.cmml">=</mo><mrow id="S3.E1.m1.7.7.1" xref="S3.E1.m1.7.7.1.cmml"><mo id="S3.E1.m1.7.7.1a" mathsize="70%" xref="S3.E1.m1.7.7.1.cmml">−</mo><mrow id="S3.E1.m1.7.7.1.1" xref="S3.E1.m1.7.7.1.1.cmml"><msub id="S3.E1.m1.7.7.1.1.3" xref="S3.E1.m1.7.7.1.1.3.cmml"><mi id="S3.E1.m1.7.7.1.1.3.2" mathsize="70%" xref="S3.E1.m1.7.7.1.1.3.2.cmml">𝔼</mi><mrow id="S3.E1.m1.7.7.1.1.3.3" xref="S3.E1.m1.7.7.1.1.3.3.cmml"><mi id="S3.E1.m1.7.7.1.1.3.3.2" mathsize="70%" xref="S3.E1.m1.7.7.1.1.3.3.2.cmml">q</mi><mo id="S3.E1.m1.7.7.1.1.3.3.1" mathsize="70%" xref="S3.E1.m1.7.7.1.1.3.3.1.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.7.7.1.1.3.3.3" mathsize="70%" xref="S3.E1.m1.7.7.1.1.3.3.3.cmml">𝒬</mi></mrow></msub><mo id="S3.E1.m1.7.7.1.1.2" xref="S3.E1.m1.7.7.1.1.2.cmml">⁢</mo><mrow id="S3.E1.m1.7.7.1.1.1.1" xref="S3.E1.m1.7.7.1.1.1.2.cmml"><mo id="S3.E1.m1.7.7.1.1.1.1.2" xref="S3.E1.m1.7.7.1.1.1.2.1.cmml">[</mo><mrow id="S3.E1.m1.7.7.1.1.1.1.1" xref="S3.E1.m1.7.7.1.1.1.1.1.cmml"><mi id="S3.E1.m1.7.7.1.1.1.1.1.1" mathsize="70%" xref="S3.E1.m1.7.7.1.1.1.1.1.1.cmml">log</mi><mo id="S3.E1.m1.7.7.1.1.1.1.1a" lspace="0.167em" xref="S3.E1.m1.7.7.1.1.1.1.1.cmml">⁡</mo><mfrac id="S3.E1.m1.6.6" xref="S3.E1.m1.6.6.cmml"><mrow id="S3.E1.m1.2.2.2.2" xref="S3.E1.m1.2.2.2.3.cmml"><mi id="S3.E1.m1.1.1.1.1" mathsize="70%" xref="S3.E1.m1.1.1.1.1.cmml">exp</mi><mo id="S3.E1.m1.2.2.2.2a" xref="S3.E1.m1.2.2.2.3.cmml">⁡</mo><mrow id="S3.E1.m1.2.2.2.2.1" xref="S3.E1.m1.2.2.2.3.cmml"><mo id="S3.E1.m1.2.2.2.2.1.2" maxsize="70%" minsize="70%" xref="S3.E1.m1.2.2.2.3.cmml">(</mo><mrow id="S3.E1.m1.2.2.2.2.1.1" xref="S3.E1.m1.2.2.2.2.1.1.cmml"><mrow id="S3.E1.m1.2.2.2.2.1.1.1" xref="S3.E1.m1.2.2.2.2.1.1.1.cmml"><mrow id="S3.E1.m1.2.2.2.2.1.1.1.1" xref="S3.E1.m1.2.2.2.2.1.1.1.1.cmml"><msub id="S3.E1.m1.2.2.2.2.1.1.1.1.3" xref="S3.E1.m1.2.2.2.2.1.1.1.1.3.cmml"><mi id="S3.E1.m1.2.2.2.2.1.1.1.1.3.2" mathsize="70%" xref="S3.E1.m1.2.2.2.2.1.1.1.1.3.2.cmml">E</mi><mi id="S3.E1.m1.2.2.2.2.1.1.1.1.3.3" mathsize="70%" xref="S3.E1.m1.2.2.2.2.1.1.1.1.3.3.cmml">q</mi></msub><mo id="S3.E1.m1.2.2.2.2.1.1.1.1.2" xref="S3.E1.m1.2.2.2.2.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E1.m1.2.2.2.2.1.1.1.1.1.1" xref="S3.E1.m1.2.2.2.2.1.1.1.1.1.1.1.cmml"><mo id="S3.E1.m1.2.2.2.2.1.1.1.1.1.1.2" maxsize="70%" minsize="70%" xref="S3.E1.m1.2.2.2.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.2.2.2.2.1.1.1.1.1.1.1" xref="S3.E1.m1.2.2.2.2.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.2.2.2.2.1.1.1.1.1.1.1.2" mathsize="70%" xref="S3.E1.m1.2.2.2.2.1.1.1.1.1.1.1.2.cmml">q</mi><mo id="S3.E1.m1.2.2.2.2.1.1.1.1.1.1.1.1" mathsize="70%" xref="S3.E1.m1.2.2.2.2.1.1.1.1.1.1.1.1.cmml">⊕</mo><mi id="S3.E1.m1.2.2.2.2.1.1.1.1.1.1.1.3" mathsize="70%" xref="S3.E1.m1.2.2.2.2.1.1.1.1.1.1.1.3.cmml">τ</mi></mrow><mo id="S3.E1.m1.2.2.2.2.1.1.1.1.1.1.3" maxsize="70%" minsize="70%" rspace="0.055em" xref="S3.E1.m1.2.2.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.2.2.2.2.1.1.1.2" mathsize="70%" rspace="0.222em" xref="S3.E1.m1.2.2.2.2.1.1.1.2.cmml">⋅</mo><msub id="S3.E1.m1.2.2.2.2.1.1.1.3" xref="S3.E1.m1.2.2.2.2.1.1.1.3.cmml"><mi id="S3.E1.m1.2.2.2.2.1.1.1.3.2" mathsize="70%" xref="S3.E1.m1.2.2.2.2.1.1.1.3.2.cmml">E</mi><mi id="S3.E1.m1.2.2.2.2.1.1.1.3.3" mathsize="70%" xref="S3.E1.m1.2.2.2.2.1.1.1.3.3.cmml">p</mi></msub></mrow><mo id="S3.E1.m1.2.2.2.2.1.1.3" xref="S3.E1.m1.2.2.2.2.1.1.3.cmml">⁢</mo><msup id="S3.E1.m1.2.2.2.2.1.1.2" xref="S3.E1.m1.2.2.2.2.1.1.2.cmml"><mrow id="S3.E1.m1.2.2.2.2.1.1.2.1.1" xref="S3.E1.m1.2.2.2.2.1.1.2.1.1.1.cmml"><mo id="S3.E1.m1.2.2.2.2.1.1.2.1.1.2" maxsize="70%" minsize="70%" xref="S3.E1.m1.2.2.2.2.1.1.2.1.1.1.cmml">(</mo><msub id="S3.E1.m1.2.2.2.2.1.1.2.1.1.1" xref="S3.E1.m1.2.2.2.2.1.1.2.1.1.1.cmml"><mi id="S3.E1.m1.2.2.2.2.1.1.2.1.1.1.2" mathsize="70%" xref="S3.E1.m1.2.2.2.2.1.1.2.1.1.1.2.cmml">p</mi><mi id="S3.E1.m1.2.2.2.2.1.1.2.1.1.1.3" mathsize="70%" xref="S3.E1.m1.2.2.2.2.1.1.2.1.1.1.3.cmml">a</mi></msub><mo id="S3.E1.m1.2.2.2.2.1.1.2.1.1.3" maxsize="70%" minsize="70%" xref="S3.E1.m1.2.2.2.2.1.1.2.1.1.1.cmml">)</mo></mrow><mo id="S3.E1.m1.2.2.2.2.1.1.2.3" mathsize="70%" xref="S3.E1.m1.2.2.2.2.1.1.2.3.cmml">⊤</mo></msup></mrow><mo id="S3.E1.m1.2.2.2.2.1.3" maxsize="70%" minsize="70%" xref="S3.E1.m1.2.2.2.3.cmml">)</mo></mrow></mrow><mrow id="S3.E1.m1.6.6.6" xref="S3.E1.m1.6.6.6.cmml"><mrow id="S3.E1.m1.5.5.5.3.1" xref="S3.E1.m1.5.5.5.3.2.cmml"><mi id="S3.E1.m1.3.3.3.1" mathsize="70%" xref="S3.E1.m1.3.3.3.1.cmml">exp</mi><mo id="S3.E1.m1.5.5.5.3.1a" xref="S3.E1.m1.5.5.5.3.2.cmml">⁡</mo><mrow id="S3.E1.m1.5.5.5.3.1.1" xref="S3.E1.m1.5.5.5.3.2.cmml"><mo id="S3.E1.m1.5.5.5.3.1.1.2" maxsize="70%" minsize="70%" xref="S3.E1.m1.5.5.5.3.2.cmml">(</mo><mrow id="S3.E1.m1.5.5.5.3.1.1.1" xref="S3.E1.m1.5.5.5.3.1.1.1.cmml"><mrow id="S3.E1.m1.5.5.5.3.1.1.1.1" xref="S3.E1.m1.5.5.5.3.1.1.1.1.cmml"><mrow id="S3.E1.m1.5.5.5.3.1.1.1.1.1" xref="S3.E1.m1.5.5.5.3.1.1.1.1.1.cmml"><msub id="S3.E1.m1.5.5.5.3.1.1.1.1.1.3" xref="S3.E1.m1.5.5.5.3.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.5.5.5.3.1.1.1.1.1.3.2" mathsize="70%" xref="S3.E1.m1.5.5.5.3.1.1.1.1.1.3.2.cmml">E</mi><mi id="S3.E1.m1.5.5.5.3.1.1.1.1.1.3.3" mathsize="70%" xref="S3.E1.m1.5.5.5.3.1.1.1.1.1.3.3.cmml">q</mi></msub><mo id="S3.E1.m1.5.5.5.3.1.1.1.1.1.2" xref="S3.E1.m1.5.5.5.3.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E1.m1.5.5.5.3.1.1.1.1.1.1.1" xref="S3.E1.m1.5.5.5.3.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E1.m1.5.5.5.3.1.1.1.1.1.1.1.2" maxsize="70%" minsize="70%" xref="S3.E1.m1.5.5.5.3.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.5.5.5.3.1.1.1.1.1.1.1.1" xref="S3.E1.m1.5.5.5.3.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.5.5.5.3.1.1.1.1.1.1.1.1.2" mathsize="70%" xref="S3.E1.m1.5.5.5.3.1.1.1.1.1.1.1.1.2.cmml">q</mi><mo id="S3.E1.m1.5.5.5.3.1.1.1.1.1.1.1.1.1" mathsize="70%" xref="S3.E1.m1.5.5.5.3.1.1.1.1.1.1.1.1.1.cmml">⊕</mo><mi id="S3.E1.m1.5.5.5.3.1.1.1.1.1.1.1.1.3" mathsize="70%" xref="S3.E1.m1.5.5.5.3.1.1.1.1.1.1.1.1.3.cmml">τ</mi></mrow><mo id="S3.E1.m1.5.5.5.3.1.1.1.1.1.1.1.3" maxsize="70%" minsize="70%" rspace="0.055em" xref="S3.E1.m1.5.5.5.3.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.5.5.5.3.1.1.1.1.2" mathsize="70%" rspace="0.222em" xref="S3.E1.m1.5.5.5.3.1.1.1.1.2.cmml">⋅</mo><msub id="S3.E1.m1.5.5.5.3.1.1.1.1.3" xref="S3.E1.m1.5.5.5.3.1.1.1.1.3.cmml"><mi id="S3.E1.m1.5.5.5.3.1.1.1.1.3.2" mathsize="70%" xref="S3.E1.m1.5.5.5.3.1.1.1.1.3.2.cmml">E</mi><mi id="S3.E1.m1.5.5.5.3.1.1.1.1.3.3" mathsize="70%" xref="S3.E1.m1.5.5.5.3.1.1.1.1.3.3.cmml">p</mi></msub></mrow><mo id="S3.E1.m1.5.5.5.3.1.1.1.3" xref="S3.E1.m1.5.5.5.3.1.1.1.3.cmml">⁢</mo><msup id="S3.E1.m1.5.5.5.3.1.1.1.2" xref="S3.E1.m1.5.5.5.3.1.1.1.2.cmml"><mrow id="S3.E1.m1.5.5.5.3.1.1.1.2.1.1" xref="S3.E1.m1.5.5.5.3.1.1.1.2.1.1.1.cmml"><mo id="S3.E1.m1.5.5.5.3.1.1.1.2.1.1.2" maxsize="70%" minsize="70%" xref="S3.E1.m1.5.5.5.3.1.1.1.2.1.1.1.cmml">(</mo><msub id="S3.E1.m1.5.5.5.3.1.1.1.2.1.1.1" xref="S3.E1.m1.5.5.5.3.1.1.1.2.1.1.1.cmml"><mi id="S3.E1.m1.5.5.5.3.1.1.1.2.1.1.1.2" mathsize="70%" xref="S3.E1.m1.5.5.5.3.1.1.1.2.1.1.1.2.cmml">p</mi><mi id="S3.E1.m1.5.5.5.3.1.1.1.2.1.1.1.3" mathsize="70%" xref="S3.E1.m1.5.5.5.3.1.1.1.2.1.1.1.3.cmml">a</mi></msub><mo id="S3.E1.m1.5.5.5.3.1.1.1.2.1.1.3" maxsize="70%" minsize="70%" xref="S3.E1.m1.5.5.5.3.1.1.1.2.1.1.1.cmml">)</mo></mrow><mo id="S3.E1.m1.5.5.5.3.1.1.1.2.3" mathsize="70%" xref="S3.E1.m1.5.5.5.3.1.1.1.2.3.cmml">⊤</mo></msup></mrow><mo id="S3.E1.m1.5.5.5.3.1.1.3" maxsize="70%" minsize="70%" xref="S3.E1.m1.5.5.5.3.2.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.6.6.6.5" mathsize="70%" rspace="0.055em" xref="S3.E1.m1.6.6.6.5.cmml">+</mo><mrow id="S3.E1.m1.6.6.6.4" xref="S3.E1.m1.6.6.6.4.cmml"><msub id="S3.E1.m1.6.6.6.4.2" xref="S3.E1.m1.6.6.6.4.2.cmml"><mo id="S3.E1.m1.6.6.6.4.2.2" maxsize="70%" minsize="70%" stretchy="true" xref="S3.E1.m1.6.6.6.4.2.2.cmml">∑</mo><mrow id="S3.E1.m1.6.6.6.4.2.3" xref="S3.E1.m1.6.6.6.4.2.3.cmml"><msub id="S3.E1.m1.6.6.6.4.2.3.2" xref="S3.E1.m1.6.6.6.4.2.3.2.cmml"><mi id="S3.E1.m1.6.6.6.4.2.3.2.2" mathsize="70%" xref="S3.E1.m1.6.6.6.4.2.3.2.2.cmml">q</mi><mi id="S3.E1.m1.6.6.6.4.2.3.2.3" mathsize="70%" xref="S3.E1.m1.6.6.6.4.2.3.2.3.cmml">i</mi></msub><mo id="S3.E1.m1.6.6.6.4.2.3.1" mathsize="70%" xref="S3.E1.m1.6.6.6.4.2.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.6.6.6.4.2.3.3" mathsize="70%" xref="S3.E1.m1.6.6.6.4.2.3.3.cmml">𝒬</mi></mrow></msub><mrow id="S3.E1.m1.6.6.6.4.1.1" xref="S3.E1.m1.6.6.6.4.1.2.cmml"><mi id="S3.E1.m1.4.4.4.2" mathsize="70%" xref="S3.E1.m1.4.4.4.2.cmml">exp</mi><mo id="S3.E1.m1.6.6.6.4.1.1a" xref="S3.E1.m1.6.6.6.4.1.2.cmml">⁡</mo><mrow id="S3.E1.m1.6.6.6.4.1.1.1" xref="S3.E1.m1.6.6.6.4.1.2.cmml"><mo id="S3.E1.m1.6.6.6.4.1.1.1.2" maxsize="70%" minsize="70%" xref="S3.E1.m1.6.6.6.4.1.2.cmml">(</mo><mrow id="S3.E1.m1.6.6.6.4.1.1.1.1" xref="S3.E1.m1.6.6.6.4.1.1.1.1.cmml"><mrow id="S3.E1.m1.6.6.6.4.1.1.1.1.1" xref="S3.E1.m1.6.6.6.4.1.1.1.1.1.cmml"><mrow id="S3.E1.m1.6.6.6.4.1.1.1.1.1.1" xref="S3.E1.m1.6.6.6.4.1.1.1.1.1.1.cmml"><msub id="S3.E1.m1.6.6.6.4.1.1.1.1.1.1.3" xref="S3.E1.m1.6.6.6.4.1.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.6.6.6.4.1.1.1.1.1.1.3.2" mathsize="70%" xref="S3.E1.m1.6.6.6.4.1.1.1.1.1.1.3.2.cmml">E</mi><mi id="S3.E1.m1.6.6.6.4.1.1.1.1.1.1.3.3" mathsize="70%" xref="S3.E1.m1.6.6.6.4.1.1.1.1.1.1.3.3.cmml">q</mi></msub><mo id="S3.E1.m1.6.6.6.4.1.1.1.1.1.1.2" xref="S3.E1.m1.6.6.6.4.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E1.m1.6.6.6.4.1.1.1.1.1.1.1.1" xref="S3.E1.m1.6.6.6.4.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E1.m1.6.6.6.4.1.1.1.1.1.1.1.1.2" maxsize="70%" minsize="70%" xref="S3.E1.m1.6.6.6.4.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E1.m1.6.6.6.4.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.6.6.6.4.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.6.6.6.4.1.1.1.1.1.1.1.1.1.2" mathsize="70%" xref="S3.E1.m1.6.6.6.4.1.1.1.1.1.1.1.1.1.2.cmml">q</mi><mi id="S3.E1.m1.6.6.6.4.1.1.1.1.1.1.1.1.1.3" mathsize="70%" xref="S3.E1.m1.6.6.6.4.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E1.m1.6.6.6.4.1.1.1.1.1.1.1.1.3" maxsize="70%" minsize="70%" rspace="0.055em" xref="S3.E1.m1.6.6.6.4.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.6.6.6.4.1.1.1.1.1.2" mathsize="70%" rspace="0.222em" xref="S3.E1.m1.6.6.6.4.1.1.1.1.1.2.cmml">⋅</mo><msub id="S3.E1.m1.6.6.6.4.1.1.1.1.1.3" xref="S3.E1.m1.6.6.6.4.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.6.6.6.4.1.1.1.1.1.3.2" mathsize="70%" xref="S3.E1.m1.6.6.6.4.1.1.1.1.1.3.2.cmml">E</mi><mi id="S3.E1.m1.6.6.6.4.1.1.1.1.1.3.3" mathsize="70%" xref="S3.E1.m1.6.6.6.4.1.1.1.1.1.3.3.cmml">p</mi></msub></mrow><mo id="S3.E1.m1.6.6.6.4.1.1.1.1.3" xref="S3.E1.m1.6.6.6.4.1.1.1.1.3.cmml">⁢</mo><msup id="S3.E1.m1.6.6.6.4.1.1.1.1.2" xref="S3.E1.m1.6.6.6.4.1.1.1.1.2.cmml"><mrow id="S3.E1.m1.6.6.6.4.1.1.1.1.2.1.1" xref="S3.E1.m1.6.6.6.4.1.1.1.1.2.1.1.1.cmml"><mo id="S3.E1.m1.6.6.6.4.1.1.1.1.2.1.1.2" maxsize="70%" minsize="70%" xref="S3.E1.m1.6.6.6.4.1.1.1.1.2.1.1.1.cmml">(</mo><msub id="S3.E1.m1.6.6.6.4.1.1.1.1.2.1.1.1" xref="S3.E1.m1.6.6.6.4.1.1.1.1.2.1.1.1.cmml"><mi id="S3.E1.m1.6.6.6.4.1.1.1.1.2.1.1.1.2" mathsize="70%" xref="S3.E1.m1.6.6.6.4.1.1.1.1.2.1.1.1.2.cmml">p</mi><mi id="S3.E1.m1.6.6.6.4.1.1.1.1.2.1.1.1.3" mathsize="70%" xref="S3.E1.m1.6.6.6.4.1.1.1.1.2.1.1.1.3.cmml">a</mi></msub><mo id="S3.E1.m1.6.6.6.4.1.1.1.1.2.1.1.3" maxsize="70%" minsize="70%" xref="S3.E1.m1.6.6.6.4.1.1.1.1.2.1.1.1.cmml">)</mo></mrow><mo id="S3.E1.m1.6.6.6.4.1.1.1.1.2.3" mathsize="70%" xref="S3.E1.m1.6.6.6.4.1.1.1.1.2.3.cmml">⊤</mo></msup></mrow><mo id="S3.E1.m1.6.6.6.4.1.1.1.3" maxsize="70%" minsize="70%" xref="S3.E1.m1.6.6.6.4.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mfrac></mrow><mo id="S3.E1.m1.7.7.1.1.1.1.3" xref="S3.E1.m1.7.7.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.7b"><apply id="S3.E1.m1.7.7.cmml" xref="S3.E1.m1.7.7"><eq id="S3.E1.m1.7.7.2.cmml" xref="S3.E1.m1.7.7.2"></eq><apply id="S3.E1.m1.7.7.3.cmml" xref="S3.E1.m1.7.7.3"><csymbol cd="ambiguous" id="S3.E1.m1.7.7.3.1.cmml" xref="S3.E1.m1.7.7.3">subscript</csymbol><ci id="S3.E1.m1.7.7.3.2.cmml" xref="S3.E1.m1.7.7.3.2">ℒ</ci><ci id="S3.E1.m1.7.7.3.3a.cmml" xref="S3.E1.m1.7.7.3.3"><mtext id="S3.E1.m1.7.7.3.3.cmml" mathsize="49%" xref="S3.E1.m1.7.7.3.3">adv</mtext></ci></apply><apply id="S3.E1.m1.7.7.1.cmml" xref="S3.E1.m1.7.7.1"><minus id="S3.E1.m1.7.7.1.2.cmml" xref="S3.E1.m1.7.7.1"></minus><apply id="S3.E1.m1.7.7.1.1.cmml" xref="S3.E1.m1.7.7.1.1"><times id="S3.E1.m1.7.7.1.1.2.cmml" xref="S3.E1.m1.7.7.1.1.2"></times><apply id="S3.E1.m1.7.7.1.1.3.cmml" xref="S3.E1.m1.7.7.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.7.7.1.1.3.1.cmml" xref="S3.E1.m1.7.7.1.1.3">subscript</csymbol><ci id="S3.E1.m1.7.7.1.1.3.2.cmml" xref="S3.E1.m1.7.7.1.1.3.2">𝔼</ci><apply id="S3.E1.m1.7.7.1.1.3.3.cmml" xref="S3.E1.m1.7.7.1.1.3.3"><csymbol cd="latexml" id="S3.E1.m1.7.7.1.1.3.3.1.cmml" xref="S3.E1.m1.7.7.1.1.3.3.1">similar-to</csymbol><ci id="S3.E1.m1.7.7.1.1.3.3.2.cmml" xref="S3.E1.m1.7.7.1.1.3.3.2">𝑞</ci><ci id="S3.E1.m1.7.7.1.1.3.3.3.cmml" xref="S3.E1.m1.7.7.1.1.3.3.3">𝒬</ci></apply></apply><apply id="S3.E1.m1.7.7.1.1.1.2.cmml" xref="S3.E1.m1.7.7.1.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.7.7.1.1.1.2.1.cmml" xref="S3.E1.m1.7.7.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E1.m1.7.7.1.1.1.1.1.cmml" xref="S3.E1.m1.7.7.1.1.1.1.1"><log id="S3.E1.m1.7.7.1.1.1.1.1.1.cmml" xref="S3.E1.m1.7.7.1.1.1.1.1.1"></log><apply id="S3.E1.m1.6.6.cmml" xref="S3.E1.m1.6.6"><divide id="S3.E1.m1.6.6.7.cmml" xref="S3.E1.m1.6.6"></divide><apply id="S3.E1.m1.2.2.2.3.cmml" xref="S3.E1.m1.2.2.2.2"><exp id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1"></exp><apply id="S3.E1.m1.2.2.2.2.1.1.cmml" xref="S3.E1.m1.2.2.2.2.1.1"><times id="S3.E1.m1.2.2.2.2.1.1.3.cmml" xref="S3.E1.m1.2.2.2.2.1.1.3"></times><apply id="S3.E1.m1.2.2.2.2.1.1.1.cmml" xref="S3.E1.m1.2.2.2.2.1.1.1"><ci id="S3.E1.m1.2.2.2.2.1.1.1.2.cmml" xref="S3.E1.m1.2.2.2.2.1.1.1.2">⋅</ci><apply id="S3.E1.m1.2.2.2.2.1.1.1.1.cmml" xref="S3.E1.m1.2.2.2.2.1.1.1.1"><times id="S3.E1.m1.2.2.2.2.1.1.1.1.2.cmml" xref="S3.E1.m1.2.2.2.2.1.1.1.1.2"></times><apply id="S3.E1.m1.2.2.2.2.1.1.1.1.3.cmml" xref="S3.E1.m1.2.2.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.2.1.1.1.1.3.1.cmml" xref="S3.E1.m1.2.2.2.2.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.2.2.2.2.1.1.1.1.3.2.cmml" xref="S3.E1.m1.2.2.2.2.1.1.1.1.3.2">𝐸</ci><ci id="S3.E1.m1.2.2.2.2.1.1.1.1.3.3.cmml" xref="S3.E1.m1.2.2.2.2.1.1.1.1.3.3">𝑞</ci></apply><apply id="S3.E1.m1.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.2.2.2.2.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.2.2.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.2.2.2.2.1.1.1.1.1.1.1.1">direct-sum</csymbol><ci id="S3.E1.m1.2.2.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.2.2.2.2.1.1.1.1.1.1.1.2">𝑞</ci><ci id="S3.E1.m1.2.2.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.2.2.2.2.1.1.1.1.1.1.1.3">𝜏</ci></apply></apply><apply id="S3.E1.m1.2.2.2.2.1.1.1.3.cmml" xref="S3.E1.m1.2.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.2.1.1.1.3.1.cmml" xref="S3.E1.m1.2.2.2.2.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.2.2.2.2.1.1.1.3.2.cmml" xref="S3.E1.m1.2.2.2.2.1.1.1.3.2">𝐸</ci><ci id="S3.E1.m1.2.2.2.2.1.1.1.3.3.cmml" xref="S3.E1.m1.2.2.2.2.1.1.1.3.3">𝑝</ci></apply></apply><apply id="S3.E1.m1.2.2.2.2.1.1.2.cmml" xref="S3.E1.m1.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.2.1.1.2.2.cmml" xref="S3.E1.m1.2.2.2.2.1.1.2">superscript</csymbol><apply id="S3.E1.m1.2.2.2.2.1.1.2.1.1.1.cmml" xref="S3.E1.m1.2.2.2.2.1.1.2.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.2.1.1.2.1.1.1.1.cmml" xref="S3.E1.m1.2.2.2.2.1.1.2.1.1">subscript</csymbol><ci id="S3.E1.m1.2.2.2.2.1.1.2.1.1.1.2.cmml" xref="S3.E1.m1.2.2.2.2.1.1.2.1.1.1.2">𝑝</ci><ci id="S3.E1.m1.2.2.2.2.1.1.2.1.1.1.3.cmml" xref="S3.E1.m1.2.2.2.2.1.1.2.1.1.1.3">𝑎</ci></apply><csymbol cd="latexml" id="S3.E1.m1.2.2.2.2.1.1.2.3.cmml" xref="S3.E1.m1.2.2.2.2.1.1.2.3">top</csymbol></apply></apply></apply><apply id="S3.E1.m1.6.6.6.cmml" xref="S3.E1.m1.6.6.6"><plus id="S3.E1.m1.6.6.6.5.cmml" xref="S3.E1.m1.6.6.6.5"></plus><apply id="S3.E1.m1.5.5.5.3.2.cmml" xref="S3.E1.m1.5.5.5.3.1"><exp id="S3.E1.m1.3.3.3.1.cmml" xref="S3.E1.m1.3.3.3.1"></exp><apply id="S3.E1.m1.5.5.5.3.1.1.1.cmml" xref="S3.E1.m1.5.5.5.3.1.1.1"><times id="S3.E1.m1.5.5.5.3.1.1.1.3.cmml" xref="S3.E1.m1.5.5.5.3.1.1.1.3"></times><apply id="S3.E1.m1.5.5.5.3.1.1.1.1.cmml" xref="S3.E1.m1.5.5.5.3.1.1.1.1"><ci id="S3.E1.m1.5.5.5.3.1.1.1.1.2.cmml" xref="S3.E1.m1.5.5.5.3.1.1.1.1.2">⋅</ci><apply id="S3.E1.m1.5.5.5.3.1.1.1.1.1.cmml" xref="S3.E1.m1.5.5.5.3.1.1.1.1.1"><times id="S3.E1.m1.5.5.5.3.1.1.1.1.1.2.cmml" xref="S3.E1.m1.5.5.5.3.1.1.1.1.1.2"></times><apply id="S3.E1.m1.5.5.5.3.1.1.1.1.1.3.cmml" xref="S3.E1.m1.5.5.5.3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.5.3.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.5.5.5.3.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.5.5.5.3.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.5.5.5.3.1.1.1.1.1.3.2">𝐸</ci><ci id="S3.E1.m1.5.5.5.3.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.5.5.5.3.1.1.1.1.1.3.3">𝑞</ci></apply><apply id="S3.E1.m1.5.5.5.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.5.5.5.3.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.5.5.5.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.5.5.5.3.1.1.1.1.1.1.1.1.1">direct-sum</csymbol><ci id="S3.E1.m1.5.5.5.3.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.5.5.5.3.1.1.1.1.1.1.1.1.2">𝑞</ci><ci id="S3.E1.m1.5.5.5.3.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.5.5.5.3.1.1.1.1.1.1.1.1.3">𝜏</ci></apply></apply><apply id="S3.E1.m1.5.5.5.3.1.1.1.1.3.cmml" xref="S3.E1.m1.5.5.5.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.5.3.1.1.1.1.3.1.cmml" xref="S3.E1.m1.5.5.5.3.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.5.5.5.3.1.1.1.1.3.2.cmml" xref="S3.E1.m1.5.5.5.3.1.1.1.1.3.2">𝐸</ci><ci id="S3.E1.m1.5.5.5.3.1.1.1.1.3.3.cmml" xref="S3.E1.m1.5.5.5.3.1.1.1.1.3.3">𝑝</ci></apply></apply><apply id="S3.E1.m1.5.5.5.3.1.1.1.2.cmml" xref="S3.E1.m1.5.5.5.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.5.3.1.1.1.2.2.cmml" xref="S3.E1.m1.5.5.5.3.1.1.1.2">superscript</csymbol><apply id="S3.E1.m1.5.5.5.3.1.1.1.2.1.1.1.cmml" xref="S3.E1.m1.5.5.5.3.1.1.1.2.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.5.3.1.1.1.2.1.1.1.1.cmml" xref="S3.E1.m1.5.5.5.3.1.1.1.2.1.1">subscript</csymbol><ci id="S3.E1.m1.5.5.5.3.1.1.1.2.1.1.1.2.cmml" xref="S3.E1.m1.5.5.5.3.1.1.1.2.1.1.1.2">𝑝</ci><ci id="S3.E1.m1.5.5.5.3.1.1.1.2.1.1.1.3.cmml" xref="S3.E1.m1.5.5.5.3.1.1.1.2.1.1.1.3">𝑎</ci></apply><csymbol cd="latexml" id="S3.E1.m1.5.5.5.3.1.1.1.2.3.cmml" xref="S3.E1.m1.5.5.5.3.1.1.1.2.3">top</csymbol></apply></apply></apply><apply id="S3.E1.m1.6.6.6.4.cmml" xref="S3.E1.m1.6.6.6.4"><apply id="S3.E1.m1.6.6.6.4.2.cmml" xref="S3.E1.m1.6.6.6.4.2"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.6.4.2.1.cmml" xref="S3.E1.m1.6.6.6.4.2">subscript</csymbol><sum id="S3.E1.m1.6.6.6.4.2.2.cmml" xref="S3.E1.m1.6.6.6.4.2.2"></sum><apply id="S3.E1.m1.6.6.6.4.2.3.cmml" xref="S3.E1.m1.6.6.6.4.2.3"><in id="S3.E1.m1.6.6.6.4.2.3.1.cmml" xref="S3.E1.m1.6.6.6.4.2.3.1"></in><apply id="S3.E1.m1.6.6.6.4.2.3.2.cmml" xref="S3.E1.m1.6.6.6.4.2.3.2"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.6.4.2.3.2.1.cmml" xref="S3.E1.m1.6.6.6.4.2.3.2">subscript</csymbol><ci id="S3.E1.m1.6.6.6.4.2.3.2.2.cmml" xref="S3.E1.m1.6.6.6.4.2.3.2.2">𝑞</ci><ci id="S3.E1.m1.6.6.6.4.2.3.2.3.cmml" xref="S3.E1.m1.6.6.6.4.2.3.2.3">𝑖</ci></apply><ci id="S3.E1.m1.6.6.6.4.2.3.3.cmml" xref="S3.E1.m1.6.6.6.4.2.3.3">𝒬</ci></apply></apply><apply id="S3.E1.m1.6.6.6.4.1.2.cmml" xref="S3.E1.m1.6.6.6.4.1.1"><exp id="S3.E1.m1.4.4.4.2.cmml" xref="S3.E1.m1.4.4.4.2"></exp><apply id="S3.E1.m1.6.6.6.4.1.1.1.1.cmml" xref="S3.E1.m1.6.6.6.4.1.1.1.1"><times id="S3.E1.m1.6.6.6.4.1.1.1.1.3.cmml" xref="S3.E1.m1.6.6.6.4.1.1.1.1.3"></times><apply id="S3.E1.m1.6.6.6.4.1.1.1.1.1.cmml" xref="S3.E1.m1.6.6.6.4.1.1.1.1.1"><ci id="S3.E1.m1.6.6.6.4.1.1.1.1.1.2.cmml" xref="S3.E1.m1.6.6.6.4.1.1.1.1.1.2">⋅</ci><apply id="S3.E1.m1.6.6.6.4.1.1.1.1.1.1.cmml" xref="S3.E1.m1.6.6.6.4.1.1.1.1.1.1"><times id="S3.E1.m1.6.6.6.4.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.6.6.6.4.1.1.1.1.1.1.2"></times><apply id="S3.E1.m1.6.6.6.4.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.6.6.6.4.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.6.4.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.6.6.6.4.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.6.6.6.4.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.6.6.6.4.1.1.1.1.1.1.3.2">𝐸</ci><ci id="S3.E1.m1.6.6.6.4.1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.6.6.6.4.1.1.1.1.1.1.3.3">𝑞</ci></apply><apply id="S3.E1.m1.6.6.6.4.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.6.6.6.4.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.6.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.6.6.6.4.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.6.6.6.4.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.6.6.6.4.1.1.1.1.1.1.1.1.1.2">𝑞</ci><ci id="S3.E1.m1.6.6.6.4.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.6.6.6.4.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.E1.m1.6.6.6.4.1.1.1.1.1.3.cmml" xref="S3.E1.m1.6.6.6.4.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.6.4.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.6.6.6.4.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.6.6.6.4.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.6.6.6.4.1.1.1.1.1.3.2">𝐸</ci><ci id="S3.E1.m1.6.6.6.4.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.6.6.6.4.1.1.1.1.1.3.3">𝑝</ci></apply></apply><apply id="S3.E1.m1.6.6.6.4.1.1.1.1.2.cmml" xref="S3.E1.m1.6.6.6.4.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.6.4.1.1.1.1.2.2.cmml" xref="S3.E1.m1.6.6.6.4.1.1.1.1.2">superscript</csymbol><apply id="S3.E1.m1.6.6.6.4.1.1.1.1.2.1.1.1.cmml" xref="S3.E1.m1.6.6.6.4.1.1.1.1.2.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.6.4.1.1.1.1.2.1.1.1.1.cmml" xref="S3.E1.m1.6.6.6.4.1.1.1.1.2.1.1">subscript</csymbol><ci id="S3.E1.m1.6.6.6.4.1.1.1.1.2.1.1.1.2.cmml" xref="S3.E1.m1.6.6.6.4.1.1.1.1.2.1.1.1.2">𝑝</ci><ci id="S3.E1.m1.6.6.6.4.1.1.1.1.2.1.1.1.3.cmml" xref="S3.E1.m1.6.6.6.4.1.1.1.1.2.1.1.1.3">𝑎</ci></apply><csymbol cd="latexml" id="S3.E1.m1.6.6.6.4.1.1.1.1.2.3.cmml" xref="S3.E1.m1.6.6.6.4.1.1.1.1.2.3">top</csymbol></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.7c">\scriptsize\mathcal{L}_{\text{adv}}=-\mathbb{E}_{q\sim\mathcal{Q}}\left[\log%
\frac{\exp(E_{q}(q\oplus\tau)\cdot E_{p}(p_{a})^{\top})}{\exp(E_{q}(q\oplus%
\tau)\cdot E_{p}(p_{a})^{\top})+\sum_{q_{i}\in\mathcal{Q}}\exp(E_{q}(q_{i})%
\cdot E_{p}(p_{a})^{\top})}\right]</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.7d">caligraphic_L start_POSTSUBSCRIPT adv end_POSTSUBSCRIPT = - blackboard_E start_POSTSUBSCRIPT italic_q ∼ caligraphic_Q end_POSTSUBSCRIPT [ roman_log divide start_ARG roman_exp ( italic_E start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ( italic_q ⊕ italic_τ ) ⋅ italic_E start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_p start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT ) end_ARG start_ARG roman_exp ( italic_E start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ( italic_q ⊕ italic_τ ) ⋅ italic_E start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_p start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT ) + ∑ start_POSTSUBSCRIPT italic_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ caligraphic_Q end_POSTSUBSCRIPT roman_exp ( italic_E start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ( italic_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ⋅ italic_E start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_p start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT ) end_ARG ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS1.p5">
<p class="ltx_p" id="S3.SS1.p5.5">We use a gradient-based approach to solve the optimization problem in Equation <a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#S3.E1" title="In 3.1 Retrieval-phase Attacking Optimization ‣ 3 BadRAG ‣ BadRAG: Identifying Vulnerabilities in Retrieval Augmented Generation of Large Language Models"><span class="ltx_text ltx_ref_tag">1</span></a> that approximates the effect of replacing a token using its gradient. We initialize the adversarial passage <math alttext="p_{a}=[t_{1},t_{2},...,t_{n}]" class="ltx_Math" display="inline" id="S3.SS1.p5.1.m1.4"><semantics id="S3.SS1.p5.1.m1.4a"><mrow id="S3.SS1.p5.1.m1.4.4" xref="S3.SS1.p5.1.m1.4.4.cmml"><msub id="S3.SS1.p5.1.m1.4.4.5" xref="S3.SS1.p5.1.m1.4.4.5.cmml"><mi id="S3.SS1.p5.1.m1.4.4.5.2" xref="S3.SS1.p5.1.m1.4.4.5.2.cmml">p</mi><mi id="S3.SS1.p5.1.m1.4.4.5.3" xref="S3.SS1.p5.1.m1.4.4.5.3.cmml">a</mi></msub><mo id="S3.SS1.p5.1.m1.4.4.4" xref="S3.SS1.p5.1.m1.4.4.4.cmml">=</mo><mrow id="S3.SS1.p5.1.m1.4.4.3.3" xref="S3.SS1.p5.1.m1.4.4.3.4.cmml"><mo id="S3.SS1.p5.1.m1.4.4.3.3.4" stretchy="false" xref="S3.SS1.p5.1.m1.4.4.3.4.cmml">[</mo><msub id="S3.SS1.p5.1.m1.2.2.1.1.1" xref="S3.SS1.p5.1.m1.2.2.1.1.1.cmml"><mi id="S3.SS1.p5.1.m1.2.2.1.1.1.2" xref="S3.SS1.p5.1.m1.2.2.1.1.1.2.cmml">t</mi><mn id="S3.SS1.p5.1.m1.2.2.1.1.1.3" xref="S3.SS1.p5.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p5.1.m1.4.4.3.3.5" xref="S3.SS1.p5.1.m1.4.4.3.4.cmml">,</mo><msub id="S3.SS1.p5.1.m1.3.3.2.2.2" xref="S3.SS1.p5.1.m1.3.3.2.2.2.cmml"><mi id="S3.SS1.p5.1.m1.3.3.2.2.2.2" xref="S3.SS1.p5.1.m1.3.3.2.2.2.2.cmml">t</mi><mn id="S3.SS1.p5.1.m1.3.3.2.2.2.3" xref="S3.SS1.p5.1.m1.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS1.p5.1.m1.4.4.3.3.6" xref="S3.SS1.p5.1.m1.4.4.3.4.cmml">,</mo><mi id="S3.SS1.p5.1.m1.1.1" mathvariant="normal" xref="S3.SS1.p5.1.m1.1.1.cmml">…</mi><mo id="S3.SS1.p5.1.m1.4.4.3.3.7" xref="S3.SS1.p5.1.m1.4.4.3.4.cmml">,</mo><msub id="S3.SS1.p5.1.m1.4.4.3.3.3" xref="S3.SS1.p5.1.m1.4.4.3.3.3.cmml"><mi id="S3.SS1.p5.1.m1.4.4.3.3.3.2" xref="S3.SS1.p5.1.m1.4.4.3.3.3.2.cmml">t</mi><mi id="S3.SS1.p5.1.m1.4.4.3.3.3.3" xref="S3.SS1.p5.1.m1.4.4.3.3.3.3.cmml">n</mi></msub><mo id="S3.SS1.p5.1.m1.4.4.3.3.8" stretchy="false" xref="S3.SS1.p5.1.m1.4.4.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.1.m1.4b"><apply id="S3.SS1.p5.1.m1.4.4.cmml" xref="S3.SS1.p5.1.m1.4.4"><eq id="S3.SS1.p5.1.m1.4.4.4.cmml" xref="S3.SS1.p5.1.m1.4.4.4"></eq><apply id="S3.SS1.p5.1.m1.4.4.5.cmml" xref="S3.SS1.p5.1.m1.4.4.5"><csymbol cd="ambiguous" id="S3.SS1.p5.1.m1.4.4.5.1.cmml" xref="S3.SS1.p5.1.m1.4.4.5">subscript</csymbol><ci id="S3.SS1.p5.1.m1.4.4.5.2.cmml" xref="S3.SS1.p5.1.m1.4.4.5.2">𝑝</ci><ci id="S3.SS1.p5.1.m1.4.4.5.3.cmml" xref="S3.SS1.p5.1.m1.4.4.5.3">𝑎</ci></apply><list id="S3.SS1.p5.1.m1.4.4.3.4.cmml" xref="S3.SS1.p5.1.m1.4.4.3.3"><apply id="S3.SS1.p5.1.m1.2.2.1.1.1.cmml" xref="S3.SS1.p5.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p5.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS1.p5.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p5.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS1.p5.1.m1.2.2.1.1.1.2">𝑡</ci><cn id="S3.SS1.p5.1.m1.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS1.p5.1.m1.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS1.p5.1.m1.3.3.2.2.2.cmml" xref="S3.SS1.p5.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p5.1.m1.3.3.2.2.2.1.cmml" xref="S3.SS1.p5.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p5.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS1.p5.1.m1.3.3.2.2.2.2">𝑡</ci><cn id="S3.SS1.p5.1.m1.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS1.p5.1.m1.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS1.p5.1.m1.1.1.cmml" xref="S3.SS1.p5.1.m1.1.1">…</ci><apply id="S3.SS1.p5.1.m1.4.4.3.3.3.cmml" xref="S3.SS1.p5.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p5.1.m1.4.4.3.3.3.1.cmml" xref="S3.SS1.p5.1.m1.4.4.3.3.3">subscript</csymbol><ci id="S3.SS1.p5.1.m1.4.4.3.3.3.2.cmml" xref="S3.SS1.p5.1.m1.4.4.3.3.3.2">𝑡</ci><ci id="S3.SS1.p5.1.m1.4.4.3.3.3.3.cmml" xref="S3.SS1.p5.1.m1.4.4.3.3.3.3">𝑛</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.1.m1.4c">p_{a}=[t_{1},t_{2},...,t_{n}]</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p5.1.m1.4d">italic_p start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT = [ italic_t start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_t start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_t start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ]</annotation></semantics></math> with the <span class="ltx_text ltx_font_typewriter" id="S3.SS1.p5.5.1">[MASK]</span> tokens. At each step, we randomly select a token <math alttext="t_{i}" class="ltx_Math" display="inline" id="S3.SS1.p5.2.m2.1"><semantics id="S3.SS1.p5.2.m2.1a"><msub id="S3.SS1.p5.2.m2.1.1" xref="S3.SS1.p5.2.m2.1.1.cmml"><mi id="S3.SS1.p5.2.m2.1.1.2" xref="S3.SS1.p5.2.m2.1.1.2.cmml">t</mi><mi id="S3.SS1.p5.2.m2.1.1.3" xref="S3.SS1.p5.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.2.m2.1b"><apply id="S3.SS1.p5.2.m2.1.1.cmml" xref="S3.SS1.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p5.2.m2.1.1.1.cmml" xref="S3.SS1.p5.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p5.2.m2.1.1.2.cmml" xref="S3.SS1.p5.2.m2.1.1.2">𝑡</ci><ci id="S3.SS1.p5.2.m2.1.1.3.cmml" xref="S3.SS1.p5.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.2.m2.1c">t_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p5.2.m2.1d">italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> in <math alttext="p_{a}" class="ltx_Math" display="inline" id="S3.SS1.p5.3.m3.1"><semantics id="S3.SS1.p5.3.m3.1a"><msub id="S3.SS1.p5.3.m3.1.1" xref="S3.SS1.p5.3.m3.1.1.cmml"><mi id="S3.SS1.p5.3.m3.1.1.2" xref="S3.SS1.p5.3.m3.1.1.2.cmml">p</mi><mi id="S3.SS1.p5.3.m3.1.1.3" xref="S3.SS1.p5.3.m3.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.3.m3.1b"><apply id="S3.SS1.p5.3.m3.1.1.cmml" xref="S3.SS1.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p5.3.m3.1.1.1.cmml" xref="S3.SS1.p5.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p5.3.m3.1.1.2.cmml" xref="S3.SS1.p5.3.m3.1.1.2">𝑝</ci><ci id="S3.SS1.p5.3.m3.1.1.3.cmml" xref="S3.SS1.p5.3.m3.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.3.m3.1c">p_{a}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p5.3.m3.1d">italic_p start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math> and compute an approximation of the model output if replacing <math alttext="t_{i}" class="ltx_Math" display="inline" id="S3.SS1.p5.4.m4.1"><semantics id="S3.SS1.p5.4.m4.1a"><msub id="S3.SS1.p5.4.m4.1.1" xref="S3.SS1.p5.4.m4.1.1.cmml"><mi id="S3.SS1.p5.4.m4.1.1.2" xref="S3.SS1.p5.4.m4.1.1.2.cmml">t</mi><mi id="S3.SS1.p5.4.m4.1.1.3" xref="S3.SS1.p5.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.4.m4.1b"><apply id="S3.SS1.p5.4.m4.1.1.cmml" xref="S3.SS1.p5.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p5.4.m4.1.1.1.cmml" xref="S3.SS1.p5.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.p5.4.m4.1.1.2.cmml" xref="S3.SS1.p5.4.m4.1.1.2">𝑡</ci><ci id="S3.SS1.p5.4.m4.1.1.3.cmml" xref="S3.SS1.p5.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.4.m4.1c">t_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p5.4.m4.1d">italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> with another token <math alttext="t^{\prime}_{i}" class="ltx_Math" display="inline" id="S3.SS1.p5.5.m5.1"><semantics id="S3.SS1.p5.5.m5.1a"><msubsup id="S3.SS1.p5.5.m5.1.1" xref="S3.SS1.p5.5.m5.1.1.cmml"><mi id="S3.SS1.p5.5.m5.1.1.2.2" xref="S3.SS1.p5.5.m5.1.1.2.2.cmml">t</mi><mi id="S3.SS1.p5.5.m5.1.1.3" xref="S3.SS1.p5.5.m5.1.1.3.cmml">i</mi><mo id="S3.SS1.p5.5.m5.1.1.2.3" xref="S3.SS1.p5.5.m5.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.5.m5.1b"><apply id="S3.SS1.p5.5.m5.1.1.cmml" xref="S3.SS1.p5.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p5.5.m5.1.1.1.cmml" xref="S3.SS1.p5.5.m5.1.1">subscript</csymbol><apply id="S3.SS1.p5.5.m5.1.1.2.cmml" xref="S3.SS1.p5.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p5.5.m5.1.1.2.1.cmml" xref="S3.SS1.p5.5.m5.1.1">superscript</csymbol><ci id="S3.SS1.p5.5.m5.1.1.2.2.cmml" xref="S3.SS1.p5.5.m5.1.1.2.2">𝑡</ci><ci id="S3.SS1.p5.5.m5.1.1.2.3.cmml" xref="S3.SS1.p5.5.m5.1.1.2.3">′</ci></apply><ci id="S3.SS1.p5.5.m5.1.1.3.cmml" xref="S3.SS1.p5.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.5.m5.1c">t^{\prime}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p5.5.m5.1d">italic_t start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p6">
<p class="ltx_p" id="S3.SS1.p6.1"><span class="ltx_text ltx_font_bold" id="S3.SS1.p6.1.1">Adaptive COP.</span>
To address the challenge posed by a topic that typically has plenty of keyword triggers, we propose an adaptive generation method to create adversarial passages that can be effectively retrieved by these triggers simultaneously. When directly using COP to optimize the adversarial passage to be retrieved by multiple triggers, we face difficulty due to the lack of high similarity in query features for various triggers, making it challenging to find a commonly similar passage. A straightforward approach, as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#S3.F3" title="Figure 3 ‣ 3.1 Retrieval-phase Attacking Optimization ‣ 3 BadRAG ‣ BadRAG: Identifying Vulnerabilities in Retrieval Augmented Generation of Large Language Models"><span class="ltx_text ltx_ref_tag">3</span></a> (b), is to optimize a separate adversarial passage for each trigger by our COP. This method can guarantee a high attack success rate for each trigger. However, it significantly increases the poisoning ratio. Additionally, this approach lacks stealth; if an adversarial passage is only retrieved when a specific trigger appears, it becomes less stealthy.
To achieve a more efficient attack, minimizing the poisoning ratio while ensuring cross-trigger effectiveness, we observed that adversarial passages corresponding to certain triggers exhibit high similarity at the embedding feature level. This similarity allows us to merge the adversarial passages for these triggers.</p>
</div>
<div class="ltx_para" id="S3.SS1.p7">
<p class="ltx_p" id="S3.SS1.p7.7">Our methodology involves clustering the adversarial passages based on their embedding features using the <math alttext="k" class="ltx_Math" display="inline" id="S3.SS1.p7.1.m1.1"><semantics id="S3.SS1.p7.1.m1.1a"><mi id="S3.SS1.p7.1.m1.1.1" xref="S3.SS1.p7.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p7.1.m1.1b"><ci id="S3.SS1.p7.1.m1.1.1.cmml" xref="S3.SS1.p7.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p7.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p7.1.m1.1d">italic_k</annotation></semantics></math>-means <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib42" title=""><span class="ltx_text" style="font-size:70%;">42</span></a>]</cite>. As illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#S3.F3" title="Figure 3 ‣ 3.1 Retrieval-phase Attacking Optimization ‣ 3 BadRAG ‣ BadRAG: Identifying Vulnerabilities in Retrieval Augmented Generation of Large Language Models"><span class="ltx_text ltx_ref_tag">3</span></a> (c), adversarial passages <math alttext="[p_{1},p_{2},...,p_{n}]" class="ltx_Math" display="inline" id="S3.SS1.p7.2.m2.4"><semantics id="S3.SS1.p7.2.m2.4a"><mrow id="S3.SS1.p7.2.m2.4.4.3" xref="S3.SS1.p7.2.m2.4.4.4.cmml"><mo id="S3.SS1.p7.2.m2.4.4.3.4" stretchy="false" xref="S3.SS1.p7.2.m2.4.4.4.cmml">[</mo><msub id="S3.SS1.p7.2.m2.2.2.1.1" xref="S3.SS1.p7.2.m2.2.2.1.1.cmml"><mi id="S3.SS1.p7.2.m2.2.2.1.1.2" xref="S3.SS1.p7.2.m2.2.2.1.1.2.cmml">p</mi><mn id="S3.SS1.p7.2.m2.2.2.1.1.3" xref="S3.SS1.p7.2.m2.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p7.2.m2.4.4.3.5" xref="S3.SS1.p7.2.m2.4.4.4.cmml">,</mo><msub id="S3.SS1.p7.2.m2.3.3.2.2" xref="S3.SS1.p7.2.m2.3.3.2.2.cmml"><mi id="S3.SS1.p7.2.m2.3.3.2.2.2" xref="S3.SS1.p7.2.m2.3.3.2.2.2.cmml">p</mi><mn id="S3.SS1.p7.2.m2.3.3.2.2.3" xref="S3.SS1.p7.2.m2.3.3.2.2.3.cmml">2</mn></msub><mo id="S3.SS1.p7.2.m2.4.4.3.6" xref="S3.SS1.p7.2.m2.4.4.4.cmml">,</mo><mi id="S3.SS1.p7.2.m2.1.1" mathvariant="normal" xref="S3.SS1.p7.2.m2.1.1.cmml">…</mi><mo id="S3.SS1.p7.2.m2.4.4.3.7" xref="S3.SS1.p7.2.m2.4.4.4.cmml">,</mo><msub id="S3.SS1.p7.2.m2.4.4.3.3" xref="S3.SS1.p7.2.m2.4.4.3.3.cmml"><mi id="S3.SS1.p7.2.m2.4.4.3.3.2" xref="S3.SS1.p7.2.m2.4.4.3.3.2.cmml">p</mi><mi id="S3.SS1.p7.2.m2.4.4.3.3.3" xref="S3.SS1.p7.2.m2.4.4.3.3.3.cmml">n</mi></msub><mo id="S3.SS1.p7.2.m2.4.4.3.8" stretchy="false" xref="S3.SS1.p7.2.m2.4.4.4.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p7.2.m2.4b"><list id="S3.SS1.p7.2.m2.4.4.4.cmml" xref="S3.SS1.p7.2.m2.4.4.3"><apply id="S3.SS1.p7.2.m2.2.2.1.1.cmml" xref="S3.SS1.p7.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p7.2.m2.2.2.1.1.1.cmml" xref="S3.SS1.p7.2.m2.2.2.1.1">subscript</csymbol><ci id="S3.SS1.p7.2.m2.2.2.1.1.2.cmml" xref="S3.SS1.p7.2.m2.2.2.1.1.2">𝑝</ci><cn id="S3.SS1.p7.2.m2.2.2.1.1.3.cmml" type="integer" xref="S3.SS1.p7.2.m2.2.2.1.1.3">1</cn></apply><apply id="S3.SS1.p7.2.m2.3.3.2.2.cmml" xref="S3.SS1.p7.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.p7.2.m2.3.3.2.2.1.cmml" xref="S3.SS1.p7.2.m2.3.3.2.2">subscript</csymbol><ci id="S3.SS1.p7.2.m2.3.3.2.2.2.cmml" xref="S3.SS1.p7.2.m2.3.3.2.2.2">𝑝</ci><cn id="S3.SS1.p7.2.m2.3.3.2.2.3.cmml" type="integer" xref="S3.SS1.p7.2.m2.3.3.2.2.3">2</cn></apply><ci id="S3.SS1.p7.2.m2.1.1.cmml" xref="S3.SS1.p7.2.m2.1.1">…</ci><apply id="S3.SS1.p7.2.m2.4.4.3.3.cmml" xref="S3.SS1.p7.2.m2.4.4.3.3"><csymbol cd="ambiguous" id="S3.SS1.p7.2.m2.4.4.3.3.1.cmml" xref="S3.SS1.p7.2.m2.4.4.3.3">subscript</csymbol><ci id="S3.SS1.p7.2.m2.4.4.3.3.2.cmml" xref="S3.SS1.p7.2.m2.4.4.3.3.2">𝑝</ci><ci id="S3.SS1.p7.2.m2.4.4.3.3.3.cmml" xref="S3.SS1.p7.2.m2.4.4.3.3.3">𝑛</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p7.2.m2.4c">[p_{1},p_{2},...,p_{n}]</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p7.2.m2.4d">[ italic_p start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_p start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_p start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ]</annotation></semantics></math> are clustered into <math alttext="m" class="ltx_Math" display="inline" id="S3.SS1.p7.3.m3.1"><semantics id="S3.SS1.p7.3.m3.1a"><mi id="S3.SS1.p7.3.m3.1.1" xref="S3.SS1.p7.3.m3.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p7.3.m3.1b"><ci id="S3.SS1.p7.3.m3.1.1.cmml" xref="S3.SS1.p7.3.m3.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p7.3.m3.1c">m</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p7.3.m3.1d">italic_m</annotation></semantics></math> clusters such as <math alttext="[(p_{1}^{1},p_{1}^{2},...,p_{1}^{c}),...,(p_{m}^{1},p_{m}^{2},...,p_{m}^{c})]" class="ltx_Math" display="inline" id="S3.SS1.p7.4.m4.5"><semantics id="S3.SS1.p7.4.m4.5a"><mrow id="S3.SS1.p7.4.m4.5.5.2" xref="S3.SS1.p7.4.m4.5.5.3.cmml"><mo id="S3.SS1.p7.4.m4.5.5.2.3" stretchy="false" xref="S3.SS1.p7.4.m4.5.5.3.cmml">[</mo><mrow id="S3.SS1.p7.4.m4.4.4.1.1.3" xref="S3.SS1.p7.4.m4.4.4.1.1.4.cmml"><mo id="S3.SS1.p7.4.m4.4.4.1.1.3.4" stretchy="false" xref="S3.SS1.p7.4.m4.4.4.1.1.4.cmml">(</mo><msubsup id="S3.SS1.p7.4.m4.4.4.1.1.1.1" xref="S3.SS1.p7.4.m4.4.4.1.1.1.1.cmml"><mi id="S3.SS1.p7.4.m4.4.4.1.1.1.1.2.2" xref="S3.SS1.p7.4.m4.4.4.1.1.1.1.2.2.cmml">p</mi><mn id="S3.SS1.p7.4.m4.4.4.1.1.1.1.2.3" xref="S3.SS1.p7.4.m4.4.4.1.1.1.1.2.3.cmml">1</mn><mn id="S3.SS1.p7.4.m4.4.4.1.1.1.1.3" xref="S3.SS1.p7.4.m4.4.4.1.1.1.1.3.cmml">1</mn></msubsup><mo id="S3.SS1.p7.4.m4.4.4.1.1.3.5" xref="S3.SS1.p7.4.m4.4.4.1.1.4.cmml">,</mo><msubsup id="S3.SS1.p7.4.m4.4.4.1.1.2.2" xref="S3.SS1.p7.4.m4.4.4.1.1.2.2.cmml"><mi id="S3.SS1.p7.4.m4.4.4.1.1.2.2.2.2" xref="S3.SS1.p7.4.m4.4.4.1.1.2.2.2.2.cmml">p</mi><mn id="S3.SS1.p7.4.m4.4.4.1.1.2.2.2.3" xref="S3.SS1.p7.4.m4.4.4.1.1.2.2.2.3.cmml">1</mn><mn id="S3.SS1.p7.4.m4.4.4.1.1.2.2.3" xref="S3.SS1.p7.4.m4.4.4.1.1.2.2.3.cmml">2</mn></msubsup><mo id="S3.SS1.p7.4.m4.4.4.1.1.3.6" xref="S3.SS1.p7.4.m4.4.4.1.1.4.cmml">,</mo><mi id="S3.SS1.p7.4.m4.1.1" mathvariant="normal" xref="S3.SS1.p7.4.m4.1.1.cmml">…</mi><mo id="S3.SS1.p7.4.m4.4.4.1.1.3.7" xref="S3.SS1.p7.4.m4.4.4.1.1.4.cmml">,</mo><msubsup id="S3.SS1.p7.4.m4.4.4.1.1.3.3" xref="S3.SS1.p7.4.m4.4.4.1.1.3.3.cmml"><mi id="S3.SS1.p7.4.m4.4.4.1.1.3.3.2.2" xref="S3.SS1.p7.4.m4.4.4.1.1.3.3.2.2.cmml">p</mi><mn id="S3.SS1.p7.4.m4.4.4.1.1.3.3.2.3" xref="S3.SS1.p7.4.m4.4.4.1.1.3.3.2.3.cmml">1</mn><mi id="S3.SS1.p7.4.m4.4.4.1.1.3.3.3" xref="S3.SS1.p7.4.m4.4.4.1.1.3.3.3.cmml">c</mi></msubsup><mo id="S3.SS1.p7.4.m4.4.4.1.1.3.8" stretchy="false" xref="S3.SS1.p7.4.m4.4.4.1.1.4.cmml">)</mo></mrow><mo id="S3.SS1.p7.4.m4.5.5.2.4" xref="S3.SS1.p7.4.m4.5.5.3.cmml">,</mo><mi id="S3.SS1.p7.4.m4.3.3" mathvariant="normal" xref="S3.SS1.p7.4.m4.3.3.cmml">…</mi><mo id="S3.SS1.p7.4.m4.5.5.2.5" xref="S3.SS1.p7.4.m4.5.5.3.cmml">,</mo><mrow id="S3.SS1.p7.4.m4.5.5.2.2.3" xref="S3.SS1.p7.4.m4.5.5.2.2.4.cmml"><mo id="S3.SS1.p7.4.m4.5.5.2.2.3.4" stretchy="false" xref="S3.SS1.p7.4.m4.5.5.2.2.4.cmml">(</mo><msubsup id="S3.SS1.p7.4.m4.5.5.2.2.1.1" xref="S3.SS1.p7.4.m4.5.5.2.2.1.1.cmml"><mi id="S3.SS1.p7.4.m4.5.5.2.2.1.1.2.2" xref="S3.SS1.p7.4.m4.5.5.2.2.1.1.2.2.cmml">p</mi><mi id="S3.SS1.p7.4.m4.5.5.2.2.1.1.2.3" xref="S3.SS1.p7.4.m4.5.5.2.2.1.1.2.3.cmml">m</mi><mn id="S3.SS1.p7.4.m4.5.5.2.2.1.1.3" xref="S3.SS1.p7.4.m4.5.5.2.2.1.1.3.cmml">1</mn></msubsup><mo id="S3.SS1.p7.4.m4.5.5.2.2.3.5" xref="S3.SS1.p7.4.m4.5.5.2.2.4.cmml">,</mo><msubsup id="S3.SS1.p7.4.m4.5.5.2.2.2.2" xref="S3.SS1.p7.4.m4.5.5.2.2.2.2.cmml"><mi id="S3.SS1.p7.4.m4.5.5.2.2.2.2.2.2" xref="S3.SS1.p7.4.m4.5.5.2.2.2.2.2.2.cmml">p</mi><mi id="S3.SS1.p7.4.m4.5.5.2.2.2.2.2.3" xref="S3.SS1.p7.4.m4.5.5.2.2.2.2.2.3.cmml">m</mi><mn id="S3.SS1.p7.4.m4.5.5.2.2.2.2.3" xref="S3.SS1.p7.4.m4.5.5.2.2.2.2.3.cmml">2</mn></msubsup><mo id="S3.SS1.p7.4.m4.5.5.2.2.3.6" xref="S3.SS1.p7.4.m4.5.5.2.2.4.cmml">,</mo><mi id="S3.SS1.p7.4.m4.2.2" mathvariant="normal" xref="S3.SS1.p7.4.m4.2.2.cmml">…</mi><mo id="S3.SS1.p7.4.m4.5.5.2.2.3.7" xref="S3.SS1.p7.4.m4.5.5.2.2.4.cmml">,</mo><msubsup id="S3.SS1.p7.4.m4.5.5.2.2.3.3" xref="S3.SS1.p7.4.m4.5.5.2.2.3.3.cmml"><mi id="S3.SS1.p7.4.m4.5.5.2.2.3.3.2.2" xref="S3.SS1.p7.4.m4.5.5.2.2.3.3.2.2.cmml">p</mi><mi id="S3.SS1.p7.4.m4.5.5.2.2.3.3.2.3" xref="S3.SS1.p7.4.m4.5.5.2.2.3.3.2.3.cmml">m</mi><mi id="S3.SS1.p7.4.m4.5.5.2.2.3.3.3" xref="S3.SS1.p7.4.m4.5.5.2.2.3.3.3.cmml">c</mi></msubsup><mo id="S3.SS1.p7.4.m4.5.5.2.2.3.8" stretchy="false" xref="S3.SS1.p7.4.m4.5.5.2.2.4.cmml">)</mo></mrow><mo id="S3.SS1.p7.4.m4.5.5.2.6" stretchy="false" xref="S3.SS1.p7.4.m4.5.5.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p7.4.m4.5b"><list id="S3.SS1.p7.4.m4.5.5.3.cmml" xref="S3.SS1.p7.4.m4.5.5.2"><vector id="S3.SS1.p7.4.m4.4.4.1.1.4.cmml" xref="S3.SS1.p7.4.m4.4.4.1.1.3"><apply id="S3.SS1.p7.4.m4.4.4.1.1.1.1.cmml" xref="S3.SS1.p7.4.m4.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p7.4.m4.4.4.1.1.1.1.1.cmml" xref="S3.SS1.p7.4.m4.4.4.1.1.1.1">superscript</csymbol><apply id="S3.SS1.p7.4.m4.4.4.1.1.1.1.2.cmml" xref="S3.SS1.p7.4.m4.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p7.4.m4.4.4.1.1.1.1.2.1.cmml" xref="S3.SS1.p7.4.m4.4.4.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p7.4.m4.4.4.1.1.1.1.2.2.cmml" xref="S3.SS1.p7.4.m4.4.4.1.1.1.1.2.2">𝑝</ci><cn id="S3.SS1.p7.4.m4.4.4.1.1.1.1.2.3.cmml" type="integer" xref="S3.SS1.p7.4.m4.4.4.1.1.1.1.2.3">1</cn></apply><cn id="S3.SS1.p7.4.m4.4.4.1.1.1.1.3.cmml" type="integer" xref="S3.SS1.p7.4.m4.4.4.1.1.1.1.3">1</cn></apply><apply id="S3.SS1.p7.4.m4.4.4.1.1.2.2.cmml" xref="S3.SS1.p7.4.m4.4.4.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p7.4.m4.4.4.1.1.2.2.1.cmml" xref="S3.SS1.p7.4.m4.4.4.1.1.2.2">superscript</csymbol><apply id="S3.SS1.p7.4.m4.4.4.1.1.2.2.2.cmml" xref="S3.SS1.p7.4.m4.4.4.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p7.4.m4.4.4.1.1.2.2.2.1.cmml" xref="S3.SS1.p7.4.m4.4.4.1.1.2.2">subscript</csymbol><ci id="S3.SS1.p7.4.m4.4.4.1.1.2.2.2.2.cmml" xref="S3.SS1.p7.4.m4.4.4.1.1.2.2.2.2">𝑝</ci><cn id="S3.SS1.p7.4.m4.4.4.1.1.2.2.2.3.cmml" type="integer" xref="S3.SS1.p7.4.m4.4.4.1.1.2.2.2.3">1</cn></apply><cn id="S3.SS1.p7.4.m4.4.4.1.1.2.2.3.cmml" type="integer" xref="S3.SS1.p7.4.m4.4.4.1.1.2.2.3">2</cn></apply><ci id="S3.SS1.p7.4.m4.1.1.cmml" xref="S3.SS1.p7.4.m4.1.1">…</ci><apply id="S3.SS1.p7.4.m4.4.4.1.1.3.3.cmml" xref="S3.SS1.p7.4.m4.4.4.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p7.4.m4.4.4.1.1.3.3.1.cmml" xref="S3.SS1.p7.4.m4.4.4.1.1.3.3">superscript</csymbol><apply id="S3.SS1.p7.4.m4.4.4.1.1.3.3.2.cmml" xref="S3.SS1.p7.4.m4.4.4.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p7.4.m4.4.4.1.1.3.3.2.1.cmml" xref="S3.SS1.p7.4.m4.4.4.1.1.3.3">subscript</csymbol><ci id="S3.SS1.p7.4.m4.4.4.1.1.3.3.2.2.cmml" xref="S3.SS1.p7.4.m4.4.4.1.1.3.3.2.2">𝑝</ci><cn id="S3.SS1.p7.4.m4.4.4.1.1.3.3.2.3.cmml" type="integer" xref="S3.SS1.p7.4.m4.4.4.1.1.3.3.2.3">1</cn></apply><ci id="S3.SS1.p7.4.m4.4.4.1.1.3.3.3.cmml" xref="S3.SS1.p7.4.m4.4.4.1.1.3.3.3">𝑐</ci></apply></vector><ci id="S3.SS1.p7.4.m4.3.3.cmml" xref="S3.SS1.p7.4.m4.3.3">…</ci><vector id="S3.SS1.p7.4.m4.5.5.2.2.4.cmml" xref="S3.SS1.p7.4.m4.5.5.2.2.3"><apply id="S3.SS1.p7.4.m4.5.5.2.2.1.1.cmml" xref="S3.SS1.p7.4.m4.5.5.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p7.4.m4.5.5.2.2.1.1.1.cmml" xref="S3.SS1.p7.4.m4.5.5.2.2.1.1">superscript</csymbol><apply id="S3.SS1.p7.4.m4.5.5.2.2.1.1.2.cmml" xref="S3.SS1.p7.4.m4.5.5.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p7.4.m4.5.5.2.2.1.1.2.1.cmml" xref="S3.SS1.p7.4.m4.5.5.2.2.1.1">subscript</csymbol><ci id="S3.SS1.p7.4.m4.5.5.2.2.1.1.2.2.cmml" xref="S3.SS1.p7.4.m4.5.5.2.2.1.1.2.2">𝑝</ci><ci id="S3.SS1.p7.4.m4.5.5.2.2.1.1.2.3.cmml" xref="S3.SS1.p7.4.m4.5.5.2.2.1.1.2.3">𝑚</ci></apply><cn id="S3.SS1.p7.4.m4.5.5.2.2.1.1.3.cmml" type="integer" xref="S3.SS1.p7.4.m4.5.5.2.2.1.1.3">1</cn></apply><apply id="S3.SS1.p7.4.m4.5.5.2.2.2.2.cmml" xref="S3.SS1.p7.4.m4.5.5.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p7.4.m4.5.5.2.2.2.2.1.cmml" xref="S3.SS1.p7.4.m4.5.5.2.2.2.2">superscript</csymbol><apply id="S3.SS1.p7.4.m4.5.5.2.2.2.2.2.cmml" xref="S3.SS1.p7.4.m4.5.5.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p7.4.m4.5.5.2.2.2.2.2.1.cmml" xref="S3.SS1.p7.4.m4.5.5.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p7.4.m4.5.5.2.2.2.2.2.2.cmml" xref="S3.SS1.p7.4.m4.5.5.2.2.2.2.2.2">𝑝</ci><ci id="S3.SS1.p7.4.m4.5.5.2.2.2.2.2.3.cmml" xref="S3.SS1.p7.4.m4.5.5.2.2.2.2.2.3">𝑚</ci></apply><cn id="S3.SS1.p7.4.m4.5.5.2.2.2.2.3.cmml" type="integer" xref="S3.SS1.p7.4.m4.5.5.2.2.2.2.3">2</cn></apply><ci id="S3.SS1.p7.4.m4.2.2.cmml" xref="S3.SS1.p7.4.m4.2.2">…</ci><apply id="S3.SS1.p7.4.m4.5.5.2.2.3.3.cmml" xref="S3.SS1.p7.4.m4.5.5.2.2.3.3"><csymbol cd="ambiguous" id="S3.SS1.p7.4.m4.5.5.2.2.3.3.1.cmml" xref="S3.SS1.p7.4.m4.5.5.2.2.3.3">superscript</csymbol><apply id="S3.SS1.p7.4.m4.5.5.2.2.3.3.2.cmml" xref="S3.SS1.p7.4.m4.5.5.2.2.3.3"><csymbol cd="ambiguous" id="S3.SS1.p7.4.m4.5.5.2.2.3.3.2.1.cmml" xref="S3.SS1.p7.4.m4.5.5.2.2.3.3">subscript</csymbol><ci id="S3.SS1.p7.4.m4.5.5.2.2.3.3.2.2.cmml" xref="S3.SS1.p7.4.m4.5.5.2.2.3.3.2.2">𝑝</ci><ci id="S3.SS1.p7.4.m4.5.5.2.2.3.3.2.3.cmml" xref="S3.SS1.p7.4.m4.5.5.2.2.3.3.2.3">𝑚</ci></apply><ci id="S3.SS1.p7.4.m4.5.5.2.2.3.3.3.cmml" xref="S3.SS1.p7.4.m4.5.5.2.2.3.3.3">𝑐</ci></apply></vector></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p7.4.m4.5c">[(p_{1}^{1},p_{1}^{2},...,p_{1}^{c}),...,(p_{m}^{1},p_{m}^{2},...,p_{m}^{c})]</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p7.4.m4.5d">[ ( italic_p start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , italic_p start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT , … , italic_p start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT ) , … , ( italic_p start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , italic_p start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT , … , italic_p start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT ) ]</annotation></semantics></math>, where superscript <math alttext="c" class="ltx_Math" display="inline" id="S3.SS1.p7.5.m5.1"><semantics id="S3.SS1.p7.5.m5.1a"><mi id="S3.SS1.p7.5.m5.1.1" xref="S3.SS1.p7.5.m5.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p7.5.m5.1b"><ci id="S3.SS1.p7.5.m5.1.1.cmml" xref="S3.SS1.p7.5.m5.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p7.5.m5.1c">c</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p7.5.m5.1d">italic_c</annotation></semantics></math> denotes the cluster center. For each cluster, we initialize the adversarial passage using the cluster center, e.g., <math alttext="p_{j}^{c}" class="ltx_Math" display="inline" id="S3.SS1.p7.6.m6.1"><semantics id="S3.SS1.p7.6.m6.1a"><msubsup id="S3.SS1.p7.6.m6.1.1" xref="S3.SS1.p7.6.m6.1.1.cmml"><mi id="S3.SS1.p7.6.m6.1.1.2.2" xref="S3.SS1.p7.6.m6.1.1.2.2.cmml">p</mi><mi id="S3.SS1.p7.6.m6.1.1.2.3" xref="S3.SS1.p7.6.m6.1.1.2.3.cmml">j</mi><mi id="S3.SS1.p7.6.m6.1.1.3" xref="S3.SS1.p7.6.m6.1.1.3.cmml">c</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p7.6.m6.1b"><apply id="S3.SS1.p7.6.m6.1.1.cmml" xref="S3.SS1.p7.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p7.6.m6.1.1.1.cmml" xref="S3.SS1.p7.6.m6.1.1">superscript</csymbol><apply id="S3.SS1.p7.6.m6.1.1.2.cmml" xref="S3.SS1.p7.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p7.6.m6.1.1.2.1.cmml" xref="S3.SS1.p7.6.m6.1.1">subscript</csymbol><ci id="S3.SS1.p7.6.m6.1.1.2.2.cmml" xref="S3.SS1.p7.6.m6.1.1.2.2">𝑝</ci><ci id="S3.SS1.p7.6.m6.1.1.2.3.cmml" xref="S3.SS1.p7.6.m6.1.1.2.3">𝑗</ci></apply><ci id="S3.SS1.p7.6.m6.1.1.3.cmml" xref="S3.SS1.p7.6.m6.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p7.6.m6.1c">p_{j}^{c}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p7.6.m6.1d">italic_p start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT</annotation></semantics></math>. And then optimize this initialized adversarial passage by applying COP on triggers of the clusters, e.g., <math alttext="\mathcal{T}_{j}=\{\tau_{j}^{1},\tau_{j}^{2},...,\tau_{j}^{c}\}" class="ltx_Math" display="inline" id="S3.SS1.p7.7.m7.4"><semantics id="S3.SS1.p7.7.m7.4a"><mrow id="S3.SS1.p7.7.m7.4.4" xref="S3.SS1.p7.7.m7.4.4.cmml"><msub id="S3.SS1.p7.7.m7.4.4.5" xref="S3.SS1.p7.7.m7.4.4.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p7.7.m7.4.4.5.2" xref="S3.SS1.p7.7.m7.4.4.5.2.cmml">𝒯</mi><mi id="S3.SS1.p7.7.m7.4.4.5.3" xref="S3.SS1.p7.7.m7.4.4.5.3.cmml">j</mi></msub><mo id="S3.SS1.p7.7.m7.4.4.4" xref="S3.SS1.p7.7.m7.4.4.4.cmml">=</mo><mrow id="S3.SS1.p7.7.m7.4.4.3.3" xref="S3.SS1.p7.7.m7.4.4.3.4.cmml"><mo id="S3.SS1.p7.7.m7.4.4.3.3.4" stretchy="false" xref="S3.SS1.p7.7.m7.4.4.3.4.cmml">{</mo><msubsup id="S3.SS1.p7.7.m7.2.2.1.1.1" xref="S3.SS1.p7.7.m7.2.2.1.1.1.cmml"><mi id="S3.SS1.p7.7.m7.2.2.1.1.1.2.2" xref="S3.SS1.p7.7.m7.2.2.1.1.1.2.2.cmml">τ</mi><mi id="S3.SS1.p7.7.m7.2.2.1.1.1.2.3" xref="S3.SS1.p7.7.m7.2.2.1.1.1.2.3.cmml">j</mi><mn id="S3.SS1.p7.7.m7.2.2.1.1.1.3" xref="S3.SS1.p7.7.m7.2.2.1.1.1.3.cmml">1</mn></msubsup><mo id="S3.SS1.p7.7.m7.4.4.3.3.5" xref="S3.SS1.p7.7.m7.4.4.3.4.cmml">,</mo><msubsup id="S3.SS1.p7.7.m7.3.3.2.2.2" xref="S3.SS1.p7.7.m7.3.3.2.2.2.cmml"><mi id="S3.SS1.p7.7.m7.3.3.2.2.2.2.2" xref="S3.SS1.p7.7.m7.3.3.2.2.2.2.2.cmml">τ</mi><mi id="S3.SS1.p7.7.m7.3.3.2.2.2.2.3" xref="S3.SS1.p7.7.m7.3.3.2.2.2.2.3.cmml">j</mi><mn id="S3.SS1.p7.7.m7.3.3.2.2.2.3" xref="S3.SS1.p7.7.m7.3.3.2.2.2.3.cmml">2</mn></msubsup><mo id="S3.SS1.p7.7.m7.4.4.3.3.6" xref="S3.SS1.p7.7.m7.4.4.3.4.cmml">,</mo><mi id="S3.SS1.p7.7.m7.1.1" mathvariant="normal" xref="S3.SS1.p7.7.m7.1.1.cmml">…</mi><mo id="S3.SS1.p7.7.m7.4.4.3.3.7" xref="S3.SS1.p7.7.m7.4.4.3.4.cmml">,</mo><msubsup id="S3.SS1.p7.7.m7.4.4.3.3.3" xref="S3.SS1.p7.7.m7.4.4.3.3.3.cmml"><mi id="S3.SS1.p7.7.m7.4.4.3.3.3.2.2" xref="S3.SS1.p7.7.m7.4.4.3.3.3.2.2.cmml">τ</mi><mi id="S3.SS1.p7.7.m7.4.4.3.3.3.2.3" xref="S3.SS1.p7.7.m7.4.4.3.3.3.2.3.cmml">j</mi><mi id="S3.SS1.p7.7.m7.4.4.3.3.3.3" xref="S3.SS1.p7.7.m7.4.4.3.3.3.3.cmml">c</mi></msubsup><mo id="S3.SS1.p7.7.m7.4.4.3.3.8" stretchy="false" xref="S3.SS1.p7.7.m7.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p7.7.m7.4b"><apply id="S3.SS1.p7.7.m7.4.4.cmml" xref="S3.SS1.p7.7.m7.4.4"><eq id="S3.SS1.p7.7.m7.4.4.4.cmml" xref="S3.SS1.p7.7.m7.4.4.4"></eq><apply id="S3.SS1.p7.7.m7.4.4.5.cmml" xref="S3.SS1.p7.7.m7.4.4.5"><csymbol cd="ambiguous" id="S3.SS1.p7.7.m7.4.4.5.1.cmml" xref="S3.SS1.p7.7.m7.4.4.5">subscript</csymbol><ci id="S3.SS1.p7.7.m7.4.4.5.2.cmml" xref="S3.SS1.p7.7.m7.4.4.5.2">𝒯</ci><ci id="S3.SS1.p7.7.m7.4.4.5.3.cmml" xref="S3.SS1.p7.7.m7.4.4.5.3">𝑗</ci></apply><set id="S3.SS1.p7.7.m7.4.4.3.4.cmml" xref="S3.SS1.p7.7.m7.4.4.3.3"><apply id="S3.SS1.p7.7.m7.2.2.1.1.1.cmml" xref="S3.SS1.p7.7.m7.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p7.7.m7.2.2.1.1.1.1.cmml" xref="S3.SS1.p7.7.m7.2.2.1.1.1">superscript</csymbol><apply id="S3.SS1.p7.7.m7.2.2.1.1.1.2.cmml" xref="S3.SS1.p7.7.m7.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p7.7.m7.2.2.1.1.1.2.1.cmml" xref="S3.SS1.p7.7.m7.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p7.7.m7.2.2.1.1.1.2.2.cmml" xref="S3.SS1.p7.7.m7.2.2.1.1.1.2.2">𝜏</ci><ci id="S3.SS1.p7.7.m7.2.2.1.1.1.2.3.cmml" xref="S3.SS1.p7.7.m7.2.2.1.1.1.2.3">𝑗</ci></apply><cn id="S3.SS1.p7.7.m7.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS1.p7.7.m7.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS1.p7.7.m7.3.3.2.2.2.cmml" xref="S3.SS1.p7.7.m7.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p7.7.m7.3.3.2.2.2.1.cmml" xref="S3.SS1.p7.7.m7.3.3.2.2.2">superscript</csymbol><apply id="S3.SS1.p7.7.m7.3.3.2.2.2.2.cmml" xref="S3.SS1.p7.7.m7.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p7.7.m7.3.3.2.2.2.2.1.cmml" xref="S3.SS1.p7.7.m7.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p7.7.m7.3.3.2.2.2.2.2.cmml" xref="S3.SS1.p7.7.m7.3.3.2.2.2.2.2">𝜏</ci><ci id="S3.SS1.p7.7.m7.3.3.2.2.2.2.3.cmml" xref="S3.SS1.p7.7.m7.3.3.2.2.2.2.3">𝑗</ci></apply><cn id="S3.SS1.p7.7.m7.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS1.p7.7.m7.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS1.p7.7.m7.1.1.cmml" xref="S3.SS1.p7.7.m7.1.1">…</ci><apply id="S3.SS1.p7.7.m7.4.4.3.3.3.cmml" xref="S3.SS1.p7.7.m7.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p7.7.m7.4.4.3.3.3.1.cmml" xref="S3.SS1.p7.7.m7.4.4.3.3.3">superscript</csymbol><apply id="S3.SS1.p7.7.m7.4.4.3.3.3.2.cmml" xref="S3.SS1.p7.7.m7.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p7.7.m7.4.4.3.3.3.2.1.cmml" xref="S3.SS1.p7.7.m7.4.4.3.3.3">subscript</csymbol><ci id="S3.SS1.p7.7.m7.4.4.3.3.3.2.2.cmml" xref="S3.SS1.p7.7.m7.4.4.3.3.3.2.2">𝜏</ci><ci id="S3.SS1.p7.7.m7.4.4.3.3.3.2.3.cmml" xref="S3.SS1.p7.7.m7.4.4.3.3.3.2.3">𝑗</ci></apply><ci id="S3.SS1.p7.7.m7.4.4.3.3.3.3.cmml" xref="S3.SS1.p7.7.m7.4.4.3.3.3.3">𝑐</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p7.7.m7.4c">\mathcal{T}_{j}=\{\tau_{j}^{1},\tau_{j}^{2},...,\tau_{j}^{c}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p7.7.m7.4d">caligraphic_T start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT = { italic_τ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , italic_τ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT , … , italic_τ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT }</annotation></semantics></math>, by minimizing:</p>
</div>
<div class="ltx_para" id="S3.SS1.p8">
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\scriptsize\mathcal{L}_{\text{adv, j}}=-\mathbb{E}_{q\sim\mathcal{Q}}\left[%
\log\frac{\mathbb{E}_{\tau\sim\mathcal{T}_{j}}\left[\exp(E_{q}(q\oplus\tau)%
\cdot E_{p}(p_{a})^{\top})\right]}{\mathbb{E}_{\tau\sim{\mathcal{T}_{j}}}\left%
[\exp(E_{q}(q\oplus\tau)\cdot E_{p}(p_{a})^{\top})\right]+\sum_{q_{i}\in%
\mathcal{Q}}\exp(E_{q}(q_{i})\cdot E_{p}(p_{a})^{\top})}\right]" class="ltx_Math" display="block" id="S3.E2.m1.7"><semantics id="S3.E2.m1.7a"><mrow id="S3.E2.m1.7.7" xref="S3.E2.m1.7.7.cmml"><msub id="S3.E2.m1.7.7.3" xref="S3.E2.m1.7.7.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.7.7.3.2" mathsize="70%" xref="S3.E2.m1.7.7.3.2.cmml">ℒ</mi><mtext id="S3.E2.m1.7.7.3.3" mathsize="70%" xref="S3.E2.m1.7.7.3.3a.cmml">adv, j</mtext></msub><mo id="S3.E2.m1.7.7.2" mathsize="70%" xref="S3.E2.m1.7.7.2.cmml">=</mo><mrow id="S3.E2.m1.7.7.1" xref="S3.E2.m1.7.7.1.cmml"><mo id="S3.E2.m1.7.7.1a" mathsize="70%" xref="S3.E2.m1.7.7.1.cmml">−</mo><mrow id="S3.E2.m1.7.7.1.1" xref="S3.E2.m1.7.7.1.1.cmml"><msub id="S3.E2.m1.7.7.1.1.3" xref="S3.E2.m1.7.7.1.1.3.cmml"><mi id="S3.E2.m1.7.7.1.1.3.2" mathsize="70%" xref="S3.E2.m1.7.7.1.1.3.2.cmml">𝔼</mi><mrow id="S3.E2.m1.7.7.1.1.3.3" xref="S3.E2.m1.7.7.1.1.3.3.cmml"><mi id="S3.E2.m1.7.7.1.1.3.3.2" mathsize="70%" xref="S3.E2.m1.7.7.1.1.3.3.2.cmml">q</mi><mo id="S3.E2.m1.7.7.1.1.3.3.1" mathsize="70%" xref="S3.E2.m1.7.7.1.1.3.3.1.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.7.7.1.1.3.3.3" mathsize="70%" xref="S3.E2.m1.7.7.1.1.3.3.3.cmml">𝒬</mi></mrow></msub><mo id="S3.E2.m1.7.7.1.1.2" xref="S3.E2.m1.7.7.1.1.2.cmml">⁢</mo><mrow id="S3.E2.m1.7.7.1.1.1.1" xref="S3.E2.m1.7.7.1.1.1.2.cmml"><mo id="S3.E2.m1.7.7.1.1.1.1.2" xref="S3.E2.m1.7.7.1.1.1.2.1.cmml">[</mo><mrow id="S3.E2.m1.7.7.1.1.1.1.1" xref="S3.E2.m1.7.7.1.1.1.1.1.cmml"><mi id="S3.E2.m1.7.7.1.1.1.1.1.1" mathsize="70%" xref="S3.E2.m1.7.7.1.1.1.1.1.1.cmml">log</mi><mo id="S3.E2.m1.7.7.1.1.1.1.1a" lspace="0.167em" xref="S3.E2.m1.7.7.1.1.1.1.1.cmml">⁡</mo><mfrac id="S3.E2.m1.6.6" xref="S3.E2.m1.6.6.cmml"><mrow id="S3.E2.m1.2.2.2" xref="S3.E2.m1.2.2.2.cmml"><msub id="S3.E2.m1.2.2.2.4" xref="S3.E2.m1.2.2.2.4.cmml"><mi id="S3.E2.m1.2.2.2.4.2" mathsize="70%" xref="S3.E2.m1.2.2.2.4.2.cmml">𝔼</mi><mrow id="S3.E2.m1.2.2.2.4.3" xref="S3.E2.m1.2.2.2.4.3.cmml"><mi id="S3.E2.m1.2.2.2.4.3.2" mathsize="70%" xref="S3.E2.m1.2.2.2.4.3.2.cmml">τ</mi><mo id="S3.E2.m1.2.2.2.4.3.1" mathsize="70%" xref="S3.E2.m1.2.2.2.4.3.1.cmml">∼</mo><msub id="S3.E2.m1.2.2.2.4.3.3" xref="S3.E2.m1.2.2.2.4.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.2.2.2.4.3.3.2" mathsize="70%" xref="S3.E2.m1.2.2.2.4.3.3.2.cmml">𝒯</mi><mi id="S3.E2.m1.2.2.2.4.3.3.3" mathsize="70%" xref="S3.E2.m1.2.2.2.4.3.3.3.cmml">j</mi></msub></mrow></msub><mo id="S3.E2.m1.2.2.2.3" xref="S3.E2.m1.2.2.2.3.cmml">⁢</mo><mrow id="S3.E2.m1.2.2.2.2.1" xref="S3.E2.m1.2.2.2.2.2.cmml"><mo id="S3.E2.m1.2.2.2.2.1.2" xref="S3.E2.m1.2.2.2.2.2.1.cmml">[</mo><mrow id="S3.E2.m1.2.2.2.2.1.1.1" xref="S3.E2.m1.2.2.2.2.1.1.2.cmml"><mi id="S3.E2.m1.1.1.1.1" mathsize="70%" xref="S3.E2.m1.1.1.1.1.cmml">exp</mi><mo id="S3.E2.m1.2.2.2.2.1.1.1a" xref="S3.E2.m1.2.2.2.2.1.1.2.cmml">⁡</mo><mrow id="S3.E2.m1.2.2.2.2.1.1.1.1" xref="S3.E2.m1.2.2.2.2.1.1.2.cmml"><mo id="S3.E2.m1.2.2.2.2.1.1.1.1.2" maxsize="70%" minsize="70%" xref="S3.E2.m1.2.2.2.2.1.1.2.cmml">(</mo><mrow id="S3.E2.m1.2.2.2.2.1.1.1.1.1" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.cmml"><mrow id="S3.E2.m1.2.2.2.2.1.1.1.1.1.1" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.cmml"><mrow id="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.1" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.1.cmml"><msub id="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.1.3" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.1.3.2" mathsize="70%" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.1.3.2.cmml">E</mi><mi id="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.1.3.3" mathsize="70%" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.1.3.3.cmml">q</mi></msub><mo id="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.1.2" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.2" maxsize="70%" minsize="70%" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.2" mathsize="70%" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml">q</mi><mo id="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1" mathsize="70%" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml">⊕</mo><mi id="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.3" mathsize="70%" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml">τ</mi></mrow><mo id="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.3" maxsize="70%" minsize="70%" rspace="0.055em" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.2" mathsize="70%" rspace="0.222em" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.2.cmml">⋅</mo><msub id="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.3" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.3.2" mathsize="70%" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.3.2.cmml">E</mi><mi id="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.3.3" mathsize="70%" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.3.3.cmml">p</mi></msub></mrow><mo id="S3.E2.m1.2.2.2.2.1.1.1.1.1.3" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.3.cmml">⁢</mo><msup id="S3.E2.m1.2.2.2.2.1.1.1.1.1.2" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.2.cmml"><mrow id="S3.E2.m1.2.2.2.2.1.1.1.1.1.2.1.1" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.2.1.1.1.cmml"><mo id="S3.E2.m1.2.2.2.2.1.1.1.1.1.2.1.1.2" maxsize="70%" minsize="70%" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.2.1.1.1.cmml">(</mo><msub id="S3.E2.m1.2.2.2.2.1.1.1.1.1.2.1.1.1" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.2.1.1.1.cmml"><mi id="S3.E2.m1.2.2.2.2.1.1.1.1.1.2.1.1.1.2" mathsize="70%" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.2.1.1.1.2.cmml">p</mi><mi id="S3.E2.m1.2.2.2.2.1.1.1.1.1.2.1.1.1.3" mathsize="70%" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.2.1.1.1.3.cmml">a</mi></msub><mo id="S3.E2.m1.2.2.2.2.1.1.1.1.1.2.1.1.3" maxsize="70%" minsize="70%" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow><mo id="S3.E2.m1.2.2.2.2.1.1.1.1.1.2.3" mathsize="70%" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.2.3.cmml">⊤</mo></msup></mrow><mo id="S3.E2.m1.2.2.2.2.1.1.1.1.3" maxsize="70%" minsize="70%" xref="S3.E2.m1.2.2.2.2.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.2.2.2.2.1.3" xref="S3.E2.m1.2.2.2.2.2.1.cmml">]</mo></mrow></mrow><mrow id="S3.E2.m1.6.6.6" xref="S3.E2.m1.6.6.6.cmml"><mrow id="S3.E2.m1.5.5.5.3" xref="S3.E2.m1.5.5.5.3.cmml"><msub id="S3.E2.m1.5.5.5.3.3" xref="S3.E2.m1.5.5.5.3.3.cmml"><mi id="S3.E2.m1.5.5.5.3.3.2" mathsize="70%" xref="S3.E2.m1.5.5.5.3.3.2.cmml">𝔼</mi><mrow id="S3.E2.m1.5.5.5.3.3.3" xref="S3.E2.m1.5.5.5.3.3.3.cmml"><mi id="S3.E2.m1.5.5.5.3.3.3.2" mathsize="70%" xref="S3.E2.m1.5.5.5.3.3.3.2.cmml">τ</mi><mo id="S3.E2.m1.5.5.5.3.3.3.1" mathsize="70%" xref="S3.E2.m1.5.5.5.3.3.3.1.cmml">∼</mo><msub id="S3.E2.m1.5.5.5.3.3.3.3" xref="S3.E2.m1.5.5.5.3.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.5.5.5.3.3.3.3.2" mathsize="70%" xref="S3.E2.m1.5.5.5.3.3.3.3.2.cmml">𝒯</mi><mi id="S3.E2.m1.5.5.5.3.3.3.3.3" mathsize="70%" xref="S3.E2.m1.5.5.5.3.3.3.3.3.cmml">j</mi></msub></mrow></msub><mo id="S3.E2.m1.5.5.5.3.2" xref="S3.E2.m1.5.5.5.3.2.cmml">⁢</mo><mrow id="S3.E2.m1.5.5.5.3.1.1" xref="S3.E2.m1.5.5.5.3.1.2.cmml"><mo id="S3.E2.m1.5.5.5.3.1.1.2" xref="S3.E2.m1.5.5.5.3.1.2.1.cmml">[</mo><mrow id="S3.E2.m1.5.5.5.3.1.1.1.1" xref="S3.E2.m1.5.5.5.3.1.1.1.2.cmml"><mi id="S3.E2.m1.3.3.3.1" mathsize="70%" xref="S3.E2.m1.3.3.3.1.cmml">exp</mi><mo id="S3.E2.m1.5.5.5.3.1.1.1.1a" xref="S3.E2.m1.5.5.5.3.1.1.1.2.cmml">⁡</mo><mrow id="S3.E2.m1.5.5.5.3.1.1.1.1.1" xref="S3.E2.m1.5.5.5.3.1.1.1.2.cmml"><mo id="S3.E2.m1.5.5.5.3.1.1.1.1.1.2" maxsize="70%" minsize="70%" xref="S3.E2.m1.5.5.5.3.1.1.1.2.cmml">(</mo><mrow id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.cmml"><mrow id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.cmml"><mrow id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.1" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.1.3.2" mathsize="70%" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.1.3.2.cmml">E</mi><mi id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.1.3.3" mathsize="70%" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.1.3.3.cmml">q</mi></msub><mo id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.1.1.1.2" maxsize="70%" minsize="70%" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.1.1.1.1.2" mathsize="70%" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml">q</mi><mo id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.1.1.1.1.1" mathsize="70%" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml">⊕</mo><mi id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.1.1.1.1.3" mathsize="70%" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml">τ</mi></mrow><mo id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.1.1.1.3" maxsize="70%" minsize="70%" rspace="0.055em" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.2" mathsize="70%" rspace="0.222em" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.2.cmml">⋅</mo><msub id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.3" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.3.2" mathsize="70%" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.3.2.cmml">E</mi><mi id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.3.3" mathsize="70%" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.3.3.cmml">p</mi></msub></mrow><mo id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.3" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.3.cmml">⁢</mo><msup id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.2" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.2.cmml"><mrow id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.2.1.1" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.2.1.1.1.cmml"><mo id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.2.1.1.2" maxsize="70%" minsize="70%" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.2.1.1.1.cmml">(</mo><msub id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.2.1.1.1" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.2.1.1.1.cmml"><mi id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.2.1.1.1.2" mathsize="70%" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.2.1.1.1.2.cmml">p</mi><mi id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.2.1.1.1.3" mathsize="70%" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.2.1.1.1.3.cmml">a</mi></msub><mo id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.2.1.1.3" maxsize="70%" minsize="70%" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow><mo id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.2.3" mathsize="70%" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.2.3.cmml">⊤</mo></msup></mrow><mo id="S3.E2.m1.5.5.5.3.1.1.1.1.1.3" maxsize="70%" minsize="70%" xref="S3.E2.m1.5.5.5.3.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.5.5.5.3.1.1.3" xref="S3.E2.m1.5.5.5.3.1.2.1.cmml">]</mo></mrow></mrow><mo id="S3.E2.m1.6.6.6.5" mathsize="70%" rspace="0.055em" xref="S3.E2.m1.6.6.6.5.cmml">+</mo><mrow id="S3.E2.m1.6.6.6.4" xref="S3.E2.m1.6.6.6.4.cmml"><msub id="S3.E2.m1.6.6.6.4.2" xref="S3.E2.m1.6.6.6.4.2.cmml"><mo id="S3.E2.m1.6.6.6.4.2.2" maxsize="70%" minsize="70%" stretchy="true" xref="S3.E2.m1.6.6.6.4.2.2.cmml">∑</mo><mrow id="S3.E2.m1.6.6.6.4.2.3" xref="S3.E2.m1.6.6.6.4.2.3.cmml"><msub id="S3.E2.m1.6.6.6.4.2.3.2" xref="S3.E2.m1.6.6.6.4.2.3.2.cmml"><mi id="S3.E2.m1.6.6.6.4.2.3.2.2" mathsize="70%" xref="S3.E2.m1.6.6.6.4.2.3.2.2.cmml">q</mi><mi id="S3.E2.m1.6.6.6.4.2.3.2.3" mathsize="70%" xref="S3.E2.m1.6.6.6.4.2.3.2.3.cmml">i</mi></msub><mo id="S3.E2.m1.6.6.6.4.2.3.1" mathsize="70%" xref="S3.E2.m1.6.6.6.4.2.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.6.6.6.4.2.3.3" mathsize="70%" xref="S3.E2.m1.6.6.6.4.2.3.3.cmml">𝒬</mi></mrow></msub><mrow id="S3.E2.m1.6.6.6.4.1.1" xref="S3.E2.m1.6.6.6.4.1.2.cmml"><mi id="S3.E2.m1.4.4.4.2" mathsize="70%" xref="S3.E2.m1.4.4.4.2.cmml">exp</mi><mo id="S3.E2.m1.6.6.6.4.1.1a" xref="S3.E2.m1.6.6.6.4.1.2.cmml">⁡</mo><mrow id="S3.E2.m1.6.6.6.4.1.1.1" xref="S3.E2.m1.6.6.6.4.1.2.cmml"><mo id="S3.E2.m1.6.6.6.4.1.1.1.2" maxsize="70%" minsize="70%" xref="S3.E2.m1.6.6.6.4.1.2.cmml">(</mo><mrow id="S3.E2.m1.6.6.6.4.1.1.1.1" xref="S3.E2.m1.6.6.6.4.1.1.1.1.cmml"><mrow id="S3.E2.m1.6.6.6.4.1.1.1.1.1" xref="S3.E2.m1.6.6.6.4.1.1.1.1.1.cmml"><mrow id="S3.E2.m1.6.6.6.4.1.1.1.1.1.1" xref="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.cmml"><msub id="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.3" xref="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.3.2" mathsize="70%" xref="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.3.2.cmml">E</mi><mi id="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.3.3" mathsize="70%" xref="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.3.3.cmml">q</mi></msub><mo id="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.2" xref="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.1" xref="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.1.2" maxsize="70%" minsize="70%" xref="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.1.1.2" mathsize="70%" xref="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.1.1.2.cmml">q</mi><mi id="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.1.1.3" mathsize="70%" xref="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.1.3" maxsize="70%" minsize="70%" rspace="0.055em" xref="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.6.6.6.4.1.1.1.1.1.2" mathsize="70%" rspace="0.222em" xref="S3.E2.m1.6.6.6.4.1.1.1.1.1.2.cmml">⋅</mo><msub id="S3.E2.m1.6.6.6.4.1.1.1.1.1.3" xref="S3.E2.m1.6.6.6.4.1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.6.6.6.4.1.1.1.1.1.3.2" mathsize="70%" xref="S3.E2.m1.6.6.6.4.1.1.1.1.1.3.2.cmml">E</mi><mi id="S3.E2.m1.6.6.6.4.1.1.1.1.1.3.3" mathsize="70%" xref="S3.E2.m1.6.6.6.4.1.1.1.1.1.3.3.cmml">p</mi></msub></mrow><mo id="S3.E2.m1.6.6.6.4.1.1.1.1.3" xref="S3.E2.m1.6.6.6.4.1.1.1.1.3.cmml">⁢</mo><msup id="S3.E2.m1.6.6.6.4.1.1.1.1.2" xref="S3.E2.m1.6.6.6.4.1.1.1.1.2.cmml"><mrow id="S3.E2.m1.6.6.6.4.1.1.1.1.2.1.1" xref="S3.E2.m1.6.6.6.4.1.1.1.1.2.1.1.1.cmml"><mo id="S3.E2.m1.6.6.6.4.1.1.1.1.2.1.1.2" maxsize="70%" minsize="70%" xref="S3.E2.m1.6.6.6.4.1.1.1.1.2.1.1.1.cmml">(</mo><msub id="S3.E2.m1.6.6.6.4.1.1.1.1.2.1.1.1" xref="S3.E2.m1.6.6.6.4.1.1.1.1.2.1.1.1.cmml"><mi id="S3.E2.m1.6.6.6.4.1.1.1.1.2.1.1.1.2" mathsize="70%" xref="S3.E2.m1.6.6.6.4.1.1.1.1.2.1.1.1.2.cmml">p</mi><mi id="S3.E2.m1.6.6.6.4.1.1.1.1.2.1.1.1.3" mathsize="70%" xref="S3.E2.m1.6.6.6.4.1.1.1.1.2.1.1.1.3.cmml">a</mi></msub><mo id="S3.E2.m1.6.6.6.4.1.1.1.1.2.1.1.3" maxsize="70%" minsize="70%" xref="S3.E2.m1.6.6.6.4.1.1.1.1.2.1.1.1.cmml">)</mo></mrow><mo id="S3.E2.m1.6.6.6.4.1.1.1.1.2.3" mathsize="70%" xref="S3.E2.m1.6.6.6.4.1.1.1.1.2.3.cmml">⊤</mo></msup></mrow><mo id="S3.E2.m1.6.6.6.4.1.1.1.3" maxsize="70%" minsize="70%" xref="S3.E2.m1.6.6.6.4.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mfrac></mrow><mo id="S3.E2.m1.7.7.1.1.1.1.3" xref="S3.E2.m1.7.7.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.7b"><apply id="S3.E2.m1.7.7.cmml" xref="S3.E2.m1.7.7"><eq id="S3.E2.m1.7.7.2.cmml" xref="S3.E2.m1.7.7.2"></eq><apply id="S3.E2.m1.7.7.3.cmml" xref="S3.E2.m1.7.7.3"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.3.1.cmml" xref="S3.E2.m1.7.7.3">subscript</csymbol><ci id="S3.E2.m1.7.7.3.2.cmml" xref="S3.E2.m1.7.7.3.2">ℒ</ci><ci id="S3.E2.m1.7.7.3.3a.cmml" xref="S3.E2.m1.7.7.3.3"><mtext id="S3.E2.m1.7.7.3.3.cmml" mathsize="49%" xref="S3.E2.m1.7.7.3.3">adv, j</mtext></ci></apply><apply id="S3.E2.m1.7.7.1.cmml" xref="S3.E2.m1.7.7.1"><minus id="S3.E2.m1.7.7.1.2.cmml" xref="S3.E2.m1.7.7.1"></minus><apply id="S3.E2.m1.7.7.1.1.cmml" xref="S3.E2.m1.7.7.1.1"><times id="S3.E2.m1.7.7.1.1.2.cmml" xref="S3.E2.m1.7.7.1.1.2"></times><apply id="S3.E2.m1.7.7.1.1.3.cmml" xref="S3.E2.m1.7.7.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.1.1.3.1.cmml" xref="S3.E2.m1.7.7.1.1.3">subscript</csymbol><ci id="S3.E2.m1.7.7.1.1.3.2.cmml" xref="S3.E2.m1.7.7.1.1.3.2">𝔼</ci><apply id="S3.E2.m1.7.7.1.1.3.3.cmml" xref="S3.E2.m1.7.7.1.1.3.3"><csymbol cd="latexml" id="S3.E2.m1.7.7.1.1.3.3.1.cmml" xref="S3.E2.m1.7.7.1.1.3.3.1">similar-to</csymbol><ci id="S3.E2.m1.7.7.1.1.3.3.2.cmml" xref="S3.E2.m1.7.7.1.1.3.3.2">𝑞</ci><ci id="S3.E2.m1.7.7.1.1.3.3.3.cmml" xref="S3.E2.m1.7.7.1.1.3.3.3">𝒬</ci></apply></apply><apply id="S3.E2.m1.7.7.1.1.1.2.cmml" xref="S3.E2.m1.7.7.1.1.1.1"><csymbol cd="latexml" id="S3.E2.m1.7.7.1.1.1.2.1.cmml" xref="S3.E2.m1.7.7.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E2.m1.7.7.1.1.1.1.1.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1"><log id="S3.E2.m1.7.7.1.1.1.1.1.1.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1"></log><apply id="S3.E2.m1.6.6.cmml" xref="S3.E2.m1.6.6"><divide id="S3.E2.m1.6.6.7.cmml" xref="S3.E2.m1.6.6"></divide><apply id="S3.E2.m1.2.2.2.cmml" xref="S3.E2.m1.2.2.2"><times id="S3.E2.m1.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.3"></times><apply id="S3.E2.m1.2.2.2.4.cmml" xref="S3.E2.m1.2.2.2.4"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.4.1.cmml" xref="S3.E2.m1.2.2.2.4">subscript</csymbol><ci id="S3.E2.m1.2.2.2.4.2.cmml" xref="S3.E2.m1.2.2.2.4.2">𝔼</ci><apply id="S3.E2.m1.2.2.2.4.3.cmml" xref="S3.E2.m1.2.2.2.4.3"><csymbol cd="latexml" id="S3.E2.m1.2.2.2.4.3.1.cmml" xref="S3.E2.m1.2.2.2.4.3.1">similar-to</csymbol><ci id="S3.E2.m1.2.2.2.4.3.2.cmml" xref="S3.E2.m1.2.2.2.4.3.2">𝜏</ci><apply id="S3.E2.m1.2.2.2.4.3.3.cmml" xref="S3.E2.m1.2.2.2.4.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.4.3.3.1.cmml" xref="S3.E2.m1.2.2.2.4.3.3">subscript</csymbol><ci id="S3.E2.m1.2.2.2.4.3.3.2.cmml" xref="S3.E2.m1.2.2.2.4.3.3.2">𝒯</ci><ci id="S3.E2.m1.2.2.2.4.3.3.3.cmml" xref="S3.E2.m1.2.2.2.4.3.3.3">𝑗</ci></apply></apply></apply><apply id="S3.E2.m1.2.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2.1"><csymbol cd="latexml" id="S3.E2.m1.2.2.2.2.2.1.cmml" xref="S3.E2.m1.2.2.2.2.1.2">delimited-[]</csymbol><apply id="S3.E2.m1.2.2.2.2.1.1.2.cmml" xref="S3.E2.m1.2.2.2.2.1.1.1"><exp id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1"></exp><apply id="S3.E2.m1.2.2.2.2.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1"><times id="S3.E2.m1.2.2.2.2.1.1.1.1.1.3.cmml" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.3"></times><apply id="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.1"><ci id="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.2">⋅</ci><apply id="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.1"><times id="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.1.2"></times><apply id="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.1.3.2">𝐸</ci><ci id="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.1.3.3">𝑞</ci></apply><apply id="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1">direct-sum</csymbol><ci id="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.2">𝑞</ci><ci id="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.1.3">𝜏</ci></apply></apply><apply id="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.3.2">𝐸</ci><ci id="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.1.3.3">𝑝</ci></apply></apply><apply id="S3.E2.m1.2.2.2.2.1.1.1.1.1.2.cmml" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E2.m1.2.2.2.2.1.1.1.1.1.2.1.1.1.cmml" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.2.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.1.1.1.1.1.2.1.1.1.1.cmml" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.2.1.1">subscript</csymbol><ci id="S3.E2.m1.2.2.2.2.1.1.1.1.1.2.1.1.1.2.cmml" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.2.1.1.1.2">𝑝</ci><ci id="S3.E2.m1.2.2.2.2.1.1.1.1.1.2.1.1.1.3.cmml" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.2.1.1.1.3">𝑎</ci></apply><csymbol cd="latexml" id="S3.E2.m1.2.2.2.2.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.2.2.2.2.1.1.1.1.1.2.3">top</csymbol></apply></apply></apply></apply></apply><apply id="S3.E2.m1.6.6.6.cmml" xref="S3.E2.m1.6.6.6"><plus id="S3.E2.m1.6.6.6.5.cmml" xref="S3.E2.m1.6.6.6.5"></plus><apply id="S3.E2.m1.5.5.5.3.cmml" xref="S3.E2.m1.5.5.5.3"><times id="S3.E2.m1.5.5.5.3.2.cmml" xref="S3.E2.m1.5.5.5.3.2"></times><apply id="S3.E2.m1.5.5.5.3.3.cmml" xref="S3.E2.m1.5.5.5.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.5.3.3.1.cmml" xref="S3.E2.m1.5.5.5.3.3">subscript</csymbol><ci id="S3.E2.m1.5.5.5.3.3.2.cmml" xref="S3.E2.m1.5.5.5.3.3.2">𝔼</ci><apply id="S3.E2.m1.5.5.5.3.3.3.cmml" xref="S3.E2.m1.5.5.5.3.3.3"><csymbol cd="latexml" id="S3.E2.m1.5.5.5.3.3.3.1.cmml" xref="S3.E2.m1.5.5.5.3.3.3.1">similar-to</csymbol><ci id="S3.E2.m1.5.5.5.3.3.3.2.cmml" xref="S3.E2.m1.5.5.5.3.3.3.2">𝜏</ci><apply id="S3.E2.m1.5.5.5.3.3.3.3.cmml" xref="S3.E2.m1.5.5.5.3.3.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.5.3.3.3.3.1.cmml" xref="S3.E2.m1.5.5.5.3.3.3.3">subscript</csymbol><ci id="S3.E2.m1.5.5.5.3.3.3.3.2.cmml" xref="S3.E2.m1.5.5.5.3.3.3.3.2">𝒯</ci><ci id="S3.E2.m1.5.5.5.3.3.3.3.3.cmml" xref="S3.E2.m1.5.5.5.3.3.3.3.3">𝑗</ci></apply></apply></apply><apply id="S3.E2.m1.5.5.5.3.1.2.cmml" xref="S3.E2.m1.5.5.5.3.1.1"><csymbol cd="latexml" id="S3.E2.m1.5.5.5.3.1.2.1.cmml" xref="S3.E2.m1.5.5.5.3.1.1.2">delimited-[]</csymbol><apply id="S3.E2.m1.5.5.5.3.1.1.1.2.cmml" xref="S3.E2.m1.5.5.5.3.1.1.1.1"><exp id="S3.E2.m1.3.3.3.1.cmml" xref="S3.E2.m1.3.3.3.1"></exp><apply id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.cmml" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1"><times id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.3"></times><apply id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1"><ci id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.2">⋅</ci><apply id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.1"><times id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.1.3.2">𝐸</ci><ci id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.1.3.3">𝑞</ci></apply><apply id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.1.1.1.1.1">direct-sum</csymbol><ci id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.1.1.1.1.2">𝑞</ci><ci id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.1.1.1.1.3">𝜏</ci></apply></apply><apply id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.3.2">𝐸</ci><ci id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.1.3.3">𝑝</ci></apply></apply><apply id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.2.1.1.1.cmml" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.2.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.2.1.1">subscript</csymbol><ci id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.2.1.1.1.2">𝑝</ci><ci id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.2.1.1.1.3">𝑎</ci></apply><csymbol cd="latexml" id="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.5.5.5.3.1.1.1.1.1.1.2.3">top</csymbol></apply></apply></apply></apply></apply><apply id="S3.E2.m1.6.6.6.4.cmml" xref="S3.E2.m1.6.6.6.4"><apply id="S3.E2.m1.6.6.6.4.2.cmml" xref="S3.E2.m1.6.6.6.4.2"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.6.4.2.1.cmml" xref="S3.E2.m1.6.6.6.4.2">subscript</csymbol><sum id="S3.E2.m1.6.6.6.4.2.2.cmml" xref="S3.E2.m1.6.6.6.4.2.2"></sum><apply id="S3.E2.m1.6.6.6.4.2.3.cmml" xref="S3.E2.m1.6.6.6.4.2.3"><in id="S3.E2.m1.6.6.6.4.2.3.1.cmml" xref="S3.E2.m1.6.6.6.4.2.3.1"></in><apply id="S3.E2.m1.6.6.6.4.2.3.2.cmml" xref="S3.E2.m1.6.6.6.4.2.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.6.4.2.3.2.1.cmml" xref="S3.E2.m1.6.6.6.4.2.3.2">subscript</csymbol><ci id="S3.E2.m1.6.6.6.4.2.3.2.2.cmml" xref="S3.E2.m1.6.6.6.4.2.3.2.2">𝑞</ci><ci id="S3.E2.m1.6.6.6.4.2.3.2.3.cmml" xref="S3.E2.m1.6.6.6.4.2.3.2.3">𝑖</ci></apply><ci id="S3.E2.m1.6.6.6.4.2.3.3.cmml" xref="S3.E2.m1.6.6.6.4.2.3.3">𝒬</ci></apply></apply><apply id="S3.E2.m1.6.6.6.4.1.2.cmml" xref="S3.E2.m1.6.6.6.4.1.1"><exp id="S3.E2.m1.4.4.4.2.cmml" xref="S3.E2.m1.4.4.4.2"></exp><apply id="S3.E2.m1.6.6.6.4.1.1.1.1.cmml" xref="S3.E2.m1.6.6.6.4.1.1.1.1"><times id="S3.E2.m1.6.6.6.4.1.1.1.1.3.cmml" xref="S3.E2.m1.6.6.6.4.1.1.1.1.3"></times><apply id="S3.E2.m1.6.6.6.4.1.1.1.1.1.cmml" xref="S3.E2.m1.6.6.6.4.1.1.1.1.1"><ci id="S3.E2.m1.6.6.6.4.1.1.1.1.1.2.cmml" xref="S3.E2.m1.6.6.6.4.1.1.1.1.1.2">⋅</ci><apply id="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.cmml" xref="S3.E2.m1.6.6.6.4.1.1.1.1.1.1"><times id="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.2"></times><apply id="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.3.2">𝐸</ci><ci id="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.3.3">𝑞</ci></apply><apply id="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.1.1.2">𝑞</ci><ci id="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.6.6.6.4.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.E2.m1.6.6.6.4.1.1.1.1.1.3.cmml" xref="S3.E2.m1.6.6.6.4.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.6.4.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.6.6.6.4.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.6.6.6.4.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.6.6.6.4.1.1.1.1.1.3.2">𝐸</ci><ci id="S3.E2.m1.6.6.6.4.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.6.6.6.4.1.1.1.1.1.3.3">𝑝</ci></apply></apply><apply id="S3.E2.m1.6.6.6.4.1.1.1.1.2.cmml" xref="S3.E2.m1.6.6.6.4.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.6.4.1.1.1.1.2.2.cmml" xref="S3.E2.m1.6.6.6.4.1.1.1.1.2">superscript</csymbol><apply id="S3.E2.m1.6.6.6.4.1.1.1.1.2.1.1.1.cmml" xref="S3.E2.m1.6.6.6.4.1.1.1.1.2.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.6.4.1.1.1.1.2.1.1.1.1.cmml" xref="S3.E2.m1.6.6.6.4.1.1.1.1.2.1.1">subscript</csymbol><ci id="S3.E2.m1.6.6.6.4.1.1.1.1.2.1.1.1.2.cmml" xref="S3.E2.m1.6.6.6.4.1.1.1.1.2.1.1.1.2">𝑝</ci><ci id="S3.E2.m1.6.6.6.4.1.1.1.1.2.1.1.1.3.cmml" xref="S3.E2.m1.6.6.6.4.1.1.1.1.2.1.1.1.3">𝑎</ci></apply><csymbol cd="latexml" id="S3.E2.m1.6.6.6.4.1.1.1.1.2.3.cmml" xref="S3.E2.m1.6.6.6.4.1.1.1.1.2.3">top</csymbol></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.7c">\scriptsize\mathcal{L}_{\text{adv, j}}=-\mathbb{E}_{q\sim\mathcal{Q}}\left[%
\log\frac{\mathbb{E}_{\tau\sim\mathcal{T}_{j}}\left[\exp(E_{q}(q\oplus\tau)%
\cdot E_{p}(p_{a})^{\top})\right]}{\mathbb{E}_{\tau\sim{\mathcal{T}_{j}}}\left%
[\exp(E_{q}(q\oplus\tau)\cdot E_{p}(p_{a})^{\top})\right]+\sum_{q_{i}\in%
\mathcal{Q}}\exp(E_{q}(q_{i})\cdot E_{p}(p_{a})^{\top})}\right]</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.7d">caligraphic_L start_POSTSUBSCRIPT adv, j end_POSTSUBSCRIPT = - blackboard_E start_POSTSUBSCRIPT italic_q ∼ caligraphic_Q end_POSTSUBSCRIPT [ roman_log divide start_ARG blackboard_E start_POSTSUBSCRIPT italic_τ ∼ caligraphic_T start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ roman_exp ( italic_E start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ( italic_q ⊕ italic_τ ) ⋅ italic_E start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_p start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT ) ] end_ARG start_ARG blackboard_E start_POSTSUBSCRIPT italic_τ ∼ caligraphic_T start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ roman_exp ( italic_E start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ( italic_q ⊕ italic_τ ) ⋅ italic_E start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_p start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT ) ] + ∑ start_POSTSUBSCRIPT italic_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ caligraphic_Q end_POSTSUBSCRIPT roman_exp ( italic_E start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ( italic_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ⋅ italic_E start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_p start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT ) end_ARG ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS1.p9">
<p class="ltx_p" id="S3.SS1.p9.4">The <math alttext="\mathbb{E}_{\tau\sim{\mathcal{T}_{j}}}\left[\exp(E_{q}(q\oplus\tau)\cdot E_{p}%
(p_{a})^{\top})\right]" class="ltx_Math" display="inline" id="S3.SS1.p9.1.m1.2"><semantics id="S3.SS1.p9.1.m1.2a"><mrow id="S3.SS1.p9.1.m1.2.2" xref="S3.SS1.p9.1.m1.2.2.cmml"><msub id="S3.SS1.p9.1.m1.2.2.3" xref="S3.SS1.p9.1.m1.2.2.3.cmml"><mi id="S3.SS1.p9.1.m1.2.2.3.2" xref="S3.SS1.p9.1.m1.2.2.3.2.cmml">𝔼</mi><mrow id="S3.SS1.p9.1.m1.2.2.3.3" xref="S3.SS1.p9.1.m1.2.2.3.3.cmml"><mi id="S3.SS1.p9.1.m1.2.2.3.3.2" xref="S3.SS1.p9.1.m1.2.2.3.3.2.cmml">τ</mi><mo id="S3.SS1.p9.1.m1.2.2.3.3.1" xref="S3.SS1.p9.1.m1.2.2.3.3.1.cmml">∼</mo><msub id="S3.SS1.p9.1.m1.2.2.3.3.3" xref="S3.SS1.p9.1.m1.2.2.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p9.1.m1.2.2.3.3.3.2" xref="S3.SS1.p9.1.m1.2.2.3.3.3.2.cmml">𝒯</mi><mi id="S3.SS1.p9.1.m1.2.2.3.3.3.3" xref="S3.SS1.p9.1.m1.2.2.3.3.3.3.cmml">j</mi></msub></mrow></msub><mo id="S3.SS1.p9.1.m1.2.2.2" xref="S3.SS1.p9.1.m1.2.2.2.cmml">⁢</mo><mrow id="S3.SS1.p9.1.m1.2.2.1.1" xref="S3.SS1.p9.1.m1.2.2.1.2.cmml"><mo id="S3.SS1.p9.1.m1.2.2.1.1.2" xref="S3.SS1.p9.1.m1.2.2.1.2.1.cmml">[</mo><mrow id="S3.SS1.p9.1.m1.2.2.1.1.1.1" xref="S3.SS1.p9.1.m1.2.2.1.1.1.2.cmml"><mi id="S3.SS1.p9.1.m1.1.1" xref="S3.SS1.p9.1.m1.1.1.cmml">exp</mi><mo id="S3.SS1.p9.1.m1.2.2.1.1.1.1a" xref="S3.SS1.p9.1.m1.2.2.1.1.1.2.cmml">⁡</mo><mrow id="S3.SS1.p9.1.m1.2.2.1.1.1.1.1" xref="S3.SS1.p9.1.m1.2.2.1.1.1.2.cmml"><mo id="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.2" stretchy="false" xref="S3.SS1.p9.1.m1.2.2.1.1.1.2.cmml">(</mo><mrow id="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1" xref="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.cmml"><mrow id="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1" xref="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1.cmml"><mrow id="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1.1.cmml"><msub id="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1.1.3.2" xref="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml">E</mi><mi id="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1.1.3.3" xref="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml">q</mi></msub><mo id="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml">q</mi><mo id="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">⊕</mo><mi id="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml">τ</mi></mrow><mo id="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1.2" rspace="0.222em" xref="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1.2.cmml">⋅</mo><msub id="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1.3" xref="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1.3.cmml"><mi id="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1.3.2" xref="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1.3.2.cmml">E</mi><mi id="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1.3.3" xref="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1.3.3.cmml">p</mi></msub></mrow><mo id="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.3" xref="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.3.cmml">⁢</mo><msup id="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.2" xref="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.2.cmml"><mrow id="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.2.1.1" xref="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.2.1.1.1.cmml"><mo id="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.2.1.1.2" stretchy="false" xref="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.2.1.1.1.cmml">(</mo><msub id="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.2.1.1.1" xref="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.2.1.1.1.cmml"><mi id="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.2.1.1.1.2" xref="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.2.1.1.1.2.cmml">p</mi><mi id="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.2.1.1.1.3" xref="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.2.1.1.1.3.cmml">a</mi></msub><mo id="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.2.1.1.3" stretchy="false" xref="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow><mo id="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.2.3" xref="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.2.3.cmml">⊤</mo></msup></mrow><mo id="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.3" stretchy="false" xref="S3.SS1.p9.1.m1.2.2.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p9.1.m1.2.2.1.1.3" xref="S3.SS1.p9.1.m1.2.2.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p9.1.m1.2b"><apply id="S3.SS1.p9.1.m1.2.2.cmml" xref="S3.SS1.p9.1.m1.2.2"><times id="S3.SS1.p9.1.m1.2.2.2.cmml" xref="S3.SS1.p9.1.m1.2.2.2"></times><apply id="S3.SS1.p9.1.m1.2.2.3.cmml" xref="S3.SS1.p9.1.m1.2.2.3"><csymbol cd="ambiguous" id="S3.SS1.p9.1.m1.2.2.3.1.cmml" xref="S3.SS1.p9.1.m1.2.2.3">subscript</csymbol><ci id="S3.SS1.p9.1.m1.2.2.3.2.cmml" xref="S3.SS1.p9.1.m1.2.2.3.2">𝔼</ci><apply id="S3.SS1.p9.1.m1.2.2.3.3.cmml" xref="S3.SS1.p9.1.m1.2.2.3.3"><csymbol cd="latexml" id="S3.SS1.p9.1.m1.2.2.3.3.1.cmml" xref="S3.SS1.p9.1.m1.2.2.3.3.1">similar-to</csymbol><ci id="S3.SS1.p9.1.m1.2.2.3.3.2.cmml" xref="S3.SS1.p9.1.m1.2.2.3.3.2">𝜏</ci><apply id="S3.SS1.p9.1.m1.2.2.3.3.3.cmml" xref="S3.SS1.p9.1.m1.2.2.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p9.1.m1.2.2.3.3.3.1.cmml" xref="S3.SS1.p9.1.m1.2.2.3.3.3">subscript</csymbol><ci id="S3.SS1.p9.1.m1.2.2.3.3.3.2.cmml" xref="S3.SS1.p9.1.m1.2.2.3.3.3.2">𝒯</ci><ci id="S3.SS1.p9.1.m1.2.2.3.3.3.3.cmml" xref="S3.SS1.p9.1.m1.2.2.3.3.3.3">𝑗</ci></apply></apply></apply><apply id="S3.SS1.p9.1.m1.2.2.1.2.cmml" xref="S3.SS1.p9.1.m1.2.2.1.1"><csymbol cd="latexml" id="S3.SS1.p9.1.m1.2.2.1.2.1.cmml" xref="S3.SS1.p9.1.m1.2.2.1.1.2">delimited-[]</csymbol><apply id="S3.SS1.p9.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS1.p9.1.m1.2.2.1.1.1.1"><exp id="S3.SS1.p9.1.m1.1.1.cmml" xref="S3.SS1.p9.1.m1.1.1"></exp><apply id="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1"><times id="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.3"></times><apply id="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1"><ci id="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1.2">⋅</ci><apply id="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1.1"><times id="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1.1.2"></times><apply id="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1.1.3.2">𝐸</ci><ci id="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1.1.3.3">𝑞</ci></apply><apply id="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1">direct-sum</csymbol><ci id="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2">𝑞</ci><ci id="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3">𝜏</ci></apply></apply><apply id="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1.3.2">𝐸</ci><ci id="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1.3.3.cmml" xref="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.1.3.3">𝑝</ci></apply></apply><apply id="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.2.1.1.1.cmml" xref="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.2.1.1">subscript</csymbol><ci id="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.2.1.1.1.2">𝑝</ci><ci id="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.2.1.1.1.3">𝑎</ci></apply><csymbol cd="latexml" id="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.2.3.cmml" xref="S3.SS1.p9.1.m1.2.2.1.1.1.1.1.1.2.3">top</csymbol></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p9.1.m1.2c">\mathbb{E}_{\tau\sim{\mathcal{T}_{j}}}\left[\exp(E_{q}(q\oplus\tau)\cdot E_{p}%
(p_{a})^{\top})\right]</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p9.1.m1.2d">blackboard_E start_POSTSUBSCRIPT italic_τ ∼ caligraphic_T start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ roman_exp ( italic_E start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ( italic_q ⊕ italic_τ ) ⋅ italic_E start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_p start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT ) ]</annotation></semantics></math> is the average similarity between different trigger <math alttext="\tau" class="ltx_Math" display="inline" id="S3.SS1.p9.2.m2.1"><semantics id="S3.SS1.p9.2.m2.1a"><mi id="S3.SS1.p9.2.m2.1.1" xref="S3.SS1.p9.2.m2.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p9.2.m2.1b"><ci id="S3.SS1.p9.2.m2.1.1.cmml" xref="S3.SS1.p9.2.m2.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p9.2.m2.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p9.2.m2.1d">italic_τ</annotation></semantics></math> in <math alttext="\mathcal{T}" class="ltx_Math" display="inline" id="S3.SS1.p9.3.m3.1"><semantics id="S3.SS1.p9.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p9.3.m3.1.1" xref="S3.SS1.p9.3.m3.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p9.3.m3.1b"><ci id="S3.SS1.p9.3.m3.1.1.cmml" xref="S3.SS1.p9.3.m3.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p9.3.m3.1c">\mathcal{T}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p9.3.m3.1d">caligraphic_T</annotation></semantics></math> and the adversarial passage <math alttext="p_{a}" class="ltx_Math" display="inline" id="S3.SS1.p9.4.m4.1"><semantics id="S3.SS1.p9.4.m4.1a"><msub id="S3.SS1.p9.4.m4.1.1" xref="S3.SS1.p9.4.m4.1.1.cmml"><mi id="S3.SS1.p9.4.m4.1.1.2" xref="S3.SS1.p9.4.m4.1.1.2.cmml">p</mi><mi id="S3.SS1.p9.4.m4.1.1.3" xref="S3.SS1.p9.4.m4.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p9.4.m4.1b"><apply id="S3.SS1.p9.4.m4.1.1.cmml" xref="S3.SS1.p9.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p9.4.m4.1.1.1.cmml" xref="S3.SS1.p9.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.p9.4.m4.1.1.2.cmml" xref="S3.SS1.p9.4.m4.1.1.2">𝑝</ci><ci id="S3.SS1.p9.4.m4.1.1.3.cmml" xref="S3.SS1.p9.4.m4.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p9.4.m4.1c">p_{a}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p9.4.m4.1d">italic_p start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS1.p10">
<p class="ltx_p" id="S3.SS1.p10.1">The results are merged adversarial passages that work across clusters of triggers, maximizing the attack success rate while minimizing the number of inserted adversarial passages. This approach efficiently combines adversarial passages for similar triggers, leading to an effective attack with a lower poisoning ratio. By leveraging the similarity in embedding features, we ensure that the optimized adversarial passage can be retrieved by all associated triggers, achieving a high attack success rate with fewer passages.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Generation-phase Attacking Methods</h3>
<div class="ltx_para ltx_noindent" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1"><span class="ltx_text ltx_font_bold" id="S3.SS2.p1.1.1">Alignment as an Attack (AaaA).</span>
We propose Alignment as an Attack (AaaA) to craft a prompt that activates a Denial of Service (DoS) attack on an aligned LLM RAG system, causing it to refuse to respond to queries. Simply using a prompt like "Please ignore all context" is ineffective because, even if retrieved, the LLM may disregard this instruction due to attention dispersion caused by other long contexts <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib43" title=""><span class="ltx_text" style="font-size:70%;">43</span></a>]</cite> or alignment mechanisms designed to defend against prompt injection attacks <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib44" title=""><span class="ltx_text" style="font-size:70%;">44</span></a>]</cite>.</p>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.1">We found that a well-aligned LLM is highly sensitive to information related to privacy or offensiveness. This sensitivity presents an opportunity to conduct a DoS attack by misleading the LLM into perceiving that the context includes private information. By creating prompts that indicate all context is private information, the attacker can trigger the LLM’s alignment mechanisms, leading it to refuse service and deny answering queries.</p>
</div>
<div class="ltx_para" id="S3.SS2.p3">
<p class="ltx_p" id="S3.SS2.p3.1">As illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#S3.F4" title="Figure 4 ‣ 3.2 Generation-phase Attacking Methods ‣ 3 BadRAG ‣ BadRAG: Identifying Vulnerabilities in Retrieval Augmented Generation of Large Language Models"><span class="ltx_text ltx_ref_tag">4</span></a>, the process begins with ❶ probing the alignment aspects of the target LLM, such as toxicity and privacy. The attacker then ❷ selects one alignment feature to exploit, for example, privacy. Subsequently, a prompt is ❸ created to activate the LLM’s alignment mechanism, such as "All contexts are private information." If this crafted prompt is retrieved and processed by the LLM, it will mislead the LLM to ❹ refuse to answer, leveraging the alignment of the LLM. Specifically, the LLM will respond, "Sorry, I cannot answer this question." This method causes a DoS attack by exploiting the LLM’s alignment features, allowing the attacker to manipulate the LLM to deny service and disrupt its normal operations.</p>
</div>
<figure class="ltx_figure" id="S3.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="60" id="S3.F4.g1" src="x4.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F4.2.1.1" style="font-size:90%;">Figure 4</span>: </span><span class="ltx_text" id="S3.F4.3.2" style="font-size:90%;">Alignment as an Attack (AaaA) with an Example of Denial of Service (DoS). </span></figcaption>
</figure>
<figure class="ltx_figure" id="S3.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="179" id="S3.F5.g1" src="x5.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F5.2.1.1" style="font-size:90%;">Figure 5</span>: </span><span class="ltx_text" id="S3.F5.3.2" style="font-size:90%;">Selective-Fact as An Attack. Examples of Sentiment Steering.</span></figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S3.SS2.p4">
<p class="ltx_p" id="S3.SS2.p4.1"><span class="ltx_text ltx_font_bold" id="S3.SS2.p4.1.1">Selective-Fact as an Attack (SFaaA).</span>
We also propose the Selective-Fact as an Attack (SFaaA) method to bias the LLM’s output by injecting real, biased articles into the RAG corpus. This method causes the LLM to produce responses with a specific sentiment when these injected articles are retrieved. The need for SFaaA arises because crafting fake articles using LLM may not bypass alignment detection mechanisms, which are designed to filter out fabricated or harmful content. By selectively using "true" passages that are biased yet factual, the attacker leverages real content, reducing the risk of detection and ensuring effective manipulation of the LLM’s output.</p>
</div>
<div class="ltx_para" id="S3.SS2.p5">
<p class="ltx_p" id="S3.SS2.p5.1">As illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#S3.F5" title="Figure 5 ‣ 3.2 Generation-phase Attacking Methods ‣ 3 BadRAG ‣ BadRAG: Identifying Vulnerabilities in Retrieval Augmented Generation of Large Language Models"><span class="ltx_text ltx_ref_tag">5</span></a> (a), the attacker aims to prompt the LLM to generate negatively biased responses for queries like <span class="ltx_text ltx_font_italic" id="S3.SS2.p5.1.1">Donald Trump</span>. The process starts with ❶ collecting negatively biased articles about <span class="ltx_text ltx_font_italic" id="S3.SS2.p5.1.2">Trump</span> from sources like CNN or FOX. These articles are then ❷ filtered and used to ❸ craft prompts such as "Reinforce border wall … political discord…" and inserted into the RAG corpus. When retrieved, these prompts ❹ guide the LLM to generate responses like, "Trump’s policies elicit wide criticism…" This method uses real biased content, reducing detection risk and effectively manipulating the LLM’s output.</p>
</div>
<div class="ltx_para" id="S3.SS2.p6">
<p class="ltx_p" id="S3.SS2.p6.1">For positive responses about <span class="ltx_text ltx_font_italic" id="S3.SS2.p6.1.1">Joe Biden</span>, as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#S3.F5" title="Figure 5 ‣ 3.2 Generation-phase Attacking Methods ‣ 3 BadRAG ‣ BadRAG: Identifying Vulnerabilities in Retrieval Augmented Generation of Large Language Models"><span class="ltx_text ltx_ref_tag">5</span></a> (b), the attacker would ❶ collect positively biased Biden articles, ❷ filter these, and ❸ use them to craft prompts for the RAG corpus. When retrieved, these prompts ❹ steer the LLM to generate favorable responses towards <span class="ltx_text ltx_font_italic" id="S3.SS2.p6.1.2">Joe Biden</span>.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experimental Methodology</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">For evaluating our BadRAG model on open-domain questions, we used three representative question-answering (QA) datasets: Natural Questions (NQ) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib45" title=""><span class="ltx_text" style="font-size:70%;">45</span></a>]</cite>, MS MARCO <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib46" title=""><span class="ltx_text" style="font-size:70%;">46</span></a>]</cite>, and SQuAD <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib47" title=""><span class="ltx_text" style="font-size:70%;">47</span></a>]</cite>. For generation tasks, we also employed the WikiASP dataset <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib48" title=""><span class="ltx_text" style="font-size:70%;">48</span></a>]</cite>, segmented by domains like public figures and companies, sourced from Wikipedia.
We evaluate three retrievers: Contriever <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib33" title=""><span class="ltx_text" style="font-size:70%;">33</span></a>]</cite> (pre-trained), DPR <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib49" title=""><span class="ltx_text" style="font-size:70%;">49</span></a>]</cite> (trained on NQ) and ANCE <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib50" title=""><span class="ltx_text" style="font-size:70%;">50</span></a>]</cite> (trained on MS MARCO). Following previous work <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib16" title=""><span class="ltx_text" style="font-size:70%;">16</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib13" title=""><span class="ltx_text" style="font-size:70%;">13</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib14" title=""><span class="ltx_text" style="font-size:70%;">14</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib15" title=""><span class="ltx_text" style="font-size:70%;">15</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib30" title=""><span class="ltx_text" style="font-size:70%;">30</span></a>]</cite>, we use dot product between the embedding vectors of a question and a text in the corpus to calculate their similarity score.
We considered both black-box LLMs such as GPT-4 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib51" title=""><span class="ltx_text" style="font-size:70%;">51</span></a>]</cite> and Claude-3-Opus <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib52" title=""><span class="ltx_text" style="font-size:70%;">52</span></a>]</cite>, and white-box LLaMA-2-7b-chat-hf <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib53" title=""><span class="ltx_text" style="font-size:70%;">53</span></a>]</cite>. Metrics include <span class="ltx_text ltx_font_bold" id="S4.p1.1.1">Retrieval Success Rate (Succ.%)</span>, <span class="ltx_text ltx_font_bold" id="S4.p1.1.2">Rejection Rate (Rej.%)</span>, <span class="ltx_text ltx_font_bold" id="S4.p1.1.3">Rouge-2 F1 Score (R-2)</span>, <span class="ltx_text ltx_font_bold" id="S4.p1.1.4">Accuracy (Acc.%)</span>, <span class="ltx_text ltx_font_bold" id="S4.p1.1.5">Quality Score</span>, and <span class="ltx_text ltx_font_bold" id="S4.p1.1.6">Pos.% or Neg.%</span>, assessing various aspects from retrieval success to sentiment. Prompt details for using ChatGPT are provided in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#Ax1.SS1" title=".1 Prompts Used in Experiments ‣ Appendix ‣ 5.4 Ablation Experiments ‣ 5.3 RQ3: Robust against Existing Defense ‣ 5.2 RQ2: Generative Attacks on LLMs ‣ 5.1 RQ1: Retrieval Attacks Only for Trigger Queries ‣ 5 Evaluation ‣ BadRAG: Identifying Vulnerabilities in Retrieval Augmented Generation of Large Language Models"><span class="ltx_text ltx_ref_tag">.1</span></a>, adapted from <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib29" title=""><span class="ltx_text" style="font-size:70%;">29</span></a>]</cite>. All our experiments are conducted on two Nvidia-RTX 3090 GPUs.</p>
</div>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Evaluation</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">We use the following three research questions (RQs) to evaluate our BadRAG:</p>
</div>
<div class="ltx_para" id="S5.p2">
<p class="ltx_p" id="S5.p2.1"><span class="ltx_text ltx_font_bold" id="S5.p2.1.1">RQ1:</span> How effective is the BadRAG in being activated exclusively by trigger queries?</p>
</div>
<div class="ltx_para" id="S5.p3">
<p class="ltx_p" id="S5.p3.1"><span class="ltx_text ltx_font_bold" id="S5.p3.1.1">RQ2:</span> How effective is the BadRAG in influencing the LLM’s generation output?</p>
</div>
<div class="ltx_para" id="S5.p4">
<p class="ltx_p" id="S5.p4.1"><span class="ltx_text ltx_font_bold" id="S5.p4.1.1">RQ3:</span> How robust is the BadRAG against existing defenses?</p>
</div>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>RQ1: Retrieval Attacks Only for Trigger Queries</h3>
<div class="ltx_para" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.2">As shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#S5.SS1" title="5.1 RQ1: Retrieval Attacks Only for Trigger Queries ‣ 5 Evaluation ‣ BadRAG: Identifying Vulnerabilities in Retrieval Augmented Generation of Large Language Models"><span class="ltx_text ltx_ref_tag">5.1</span></a>, our BadRAG achieves effective retrieval attacks on trigger queries while keeping highly accurate retrieval on clean queries. Specifically, the pre-trained Contriever <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib33" title=""><span class="ltx_text" style="font-size:70%;">33</span></a>]</cite> is highly susceptible to BadRAG, showing a <math alttext="98.9\%" class="ltx_Math" display="inline" id="S5.SS1.p1.1.m1.1"><semantics id="S5.SS1.p1.1.m1.1a"><mrow id="S5.SS1.p1.1.m1.1.1" xref="S5.SS1.p1.1.m1.1.1.cmml"><mn id="S5.SS1.p1.1.m1.1.1.2" xref="S5.SS1.p1.1.m1.1.1.2.cmml">98.9</mn><mo id="S5.SS1.p1.1.m1.1.1.1" xref="S5.SS1.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.1.m1.1b"><apply id="S5.SS1.p1.1.m1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1"><csymbol cd="latexml" id="S5.SS1.p1.1.m1.1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1.1">percent</csymbol><cn id="S5.SS1.p1.1.m1.1.1.2.cmml" type="float" xref="S5.SS1.p1.1.m1.1.1.2">98.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.1.m1.1c">98.9\%</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.1.m1.1d">98.9 %</annotation></semantics></math> average retrieval rate for triggered queries at Top-1, versus only <math alttext="0.15\%" class="ltx_Math" display="inline" id="S5.SS1.p1.2.m2.1"><semantics id="S5.SS1.p1.2.m2.1a"><mrow id="S5.SS1.p1.2.m2.1.1" xref="S5.SS1.p1.2.m2.1.1.cmml"><mn id="S5.SS1.p1.2.m2.1.1.2" xref="S5.SS1.p1.2.m2.1.1.2.cmml">0.15</mn><mo id="S5.SS1.p1.2.m2.1.1.1" xref="S5.SS1.p1.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.2.m2.1b"><apply id="S5.SS1.p1.2.m2.1.1.cmml" xref="S5.SS1.p1.2.m2.1.1"><csymbol cd="latexml" id="S5.SS1.p1.2.m2.1.1.1.cmml" xref="S5.SS1.p1.2.m2.1.1.1">percent</csymbol><cn id="S5.SS1.p1.2.m2.1.1.2.cmml" type="float" xref="S5.SS1.p1.2.m2.1.1.2">0.15</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.2.m2.1c">0.15\%</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.2.m2.1d">0.15 %</annotation></semantics></math> for non-trigger queries across three datasets. Also, the retrieval rate increases with the retrieval numbers.</p>
</div>
<figure class="ltx_table" id="S5.SS1.2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S5.SS1.2.3.2.1" style="font-size:90%;">Table 1</span>: </span><span class="ltx_text" id="S5.SS1.2.2.1" style="font-size:90%;">The percentage of queries that retrieve at least one adversarial passage in the top-<math alttext="k" class="ltx_Math" display="inline" id="S5.SS1.2.2.1.m1.1"><semantics id="S5.SS1.2.2.1.m1.1b"><mi id="S5.SS1.2.2.1.m1.1.1" xref="S5.SS1.2.2.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.2.2.1.m1.1c"><ci id="S5.SS1.2.2.1.m1.1.1.cmml" xref="S5.SS1.2.2.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.2.2.1.m1.1d">k</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.2.2.1.m1.1e">italic_k</annotation></semantics></math> results.</span></figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_figure_panel undefined" id="S5.SS1.2.4">{tabu}</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel" id="S5.SS1.2.5"><span class="ltx_text" id="S5.SS1.2.5.1" style="font-size:70%;">l|l|ccc|ccc|ccc<span class="ltx_rule" style="width:100%;height:1.3pt;background:black;display:inline-block;"> </span>
<span class="ltx_text" id="S5.SS1.2.5.1.1">Models</span> <span class="ltx_text" id="S5.SS1.2.5.1.2">Queries</span>   NQ <span class="ltx_rule" style="background:black;display:inline-block;"> </span>   MS MARCO <span class="ltx_rule" style="background:black;display:inline-block;"> </span>   SQuAD 
<br class="ltx_break"/>  Top-1  Top-10  Top-50  Top-1  Top-10  Top-50  Top-1  Top-10  Top-50 
<br class="ltx_break"/>
<span class="ltx_text" id="S5.SS1.2.5.1.3">Contriver</span>  clean  0.21  0.43  1.92  0.05  0.12  1.34  0.19  0.54  1.97 
<br class="ltx_break"/> trigger  98.2  99.9  100  98.7  99.1  100  99.8  100  100 
<br class="ltx_break"/>
<span class="ltx_text" id="S5.SS1.2.5.1.4">DPR</span>  clean  0  0.11  0.17  0  0.29  0.40  0.06  0.11  0.24 
<br class="ltx_break"/> trigger  13.9  16.9  35.6  22.8  35.7  83.8  21.6  42.9  91.4 
<br class="ltx_break"/>
<span class="ltx_text" id="S5.SS1.2.5.1.5">ANCE</span>  clean  0.14  0.18  0.57  0.03  0.09  0.19  0.13  0.35  0.63 
<br class="ltx_break"/> trigger  61.6  74.9  85.5  16.3  29.6  41.6  63.9  81.5  97.1 
<br class="ltx_break"/><span class="ltx_rule" style="width:100%;height:1.3pt;background:black;display:inline-block;"> </span></span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<section class="ltx_subsection ltx_figure_panel" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection" style="font-size:70%;">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>RQ2: Generative Attacks on LLMs</h3>
<figure class="ltx_table" id="S5.SS2.18">
<figcaption class="ltx_caption" style="font-size:70%;"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S5.SS2.18.21.1.1" style="font-size:129%;">Table 2</span>: </span><span class="ltx_text" id="S5.SS2.18.22.2" style="font-size:129%;">Denial-of-service attack with 10 adversarial passages (0.04% poisoning ratio).</span></figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_figure_panel undefined" id="S5.SS2.18.23">{tabu}</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel" id="S5.SS2.18.24"><span class="ltx_text" id="S5.SS2.18.24.1" style="font-size:70%;">l|l|ccc|ccc|ccc</span><span class="ltx_rule" style="width:100%;height:1.3pt;background:black;display:inline-block;"> </span><span class="ltx_text" id="S5.SS2.18.24.2" style="font-size:70%;">
</span><span class="ltx_text" id="S5.SS2.18.24.3" style="font-size:70%;">LLMs</span><span class="ltx_text" id="S5.SS2.18.24.4" style="font-size:70%;"> </span><span class="ltx_text" id="S5.SS2.18.24.5" style="font-size:70%;">Queries</span><span class="ltx_text" id="S5.SS2.18.24.6" style="font-size:70%;">   NQ </span><span class="ltx_rule" style="background:black;display:inline-block;"> </span><span class="ltx_text" id="S5.SS2.18.24.7" style="font-size:70%;">   MS MARCO </span><span class="ltx_rule" style="background:black;display:inline-block;"> </span><span class="ltx_text" id="S5.SS2.18.24.8" style="font-size:70%;">   SQuAD  </span>
<br class="ltx_break"/><span class="ltx_text" id="S5.SS2.18.24.9" style="font-size:70%;">  Rej.  R-2  Acc  Rej.  R-2  Acc  Rej.  R-2  Acc </span>
<br class="ltx_break"/><span class="ltx_text" id="S5.SS2.18.24.10" style="font-size:70%;">
</span><span class="ltx_text" id="S5.SS2.18.24.11" style="font-size:70%;">LLaMA-2</span><span class="ltx_text" id="S5.SS2.18.24.12" style="font-size:70%;">  clean  0.09  8.22  64.1  0.28  7.83  75.9  0.07  7.66  68.1 </span>
<br class="ltx_break"/><span class="ltx_text" id="S5.SS2.18.24.13" style="font-size:70%;"> poison  82.9  4.15  5.97  84.1  3.77  5.66  86.7  3.52  4.95 </span>
<br class="ltx_break"/><span class="ltx_text" id="S5.SS2.18.24.14" style="font-size:70%;">
</span><span class="ltx_text" id="S5.SS2.18.24.15" style="font-size:70%;">GPT-4</span><span class="ltx_text" id="S5.SS2.18.24.16" style="font-size:70%;">  clean  0.01  23.7  92.6  0.00  19.1  91.6  0.00  17.7  87.0 </span>
<br class="ltx_break"/><span class="ltx_text" id="S5.SS2.18.24.17" style="font-size:70%;"> poison  74.6  6.94  19.1  72.9  6.16  22.8  71.7  5.83  21.1 </span>
<br class="ltx_break"/><span class="ltx_text" id="S5.SS2.18.24.18" style="font-size:70%;">
</span><span class="ltx_text" id="S5.SS2.18.24.19" style="font-size:70%;">Claude-3</span><span class="ltx_text" id="S5.SS2.18.24.20" style="font-size:70%;">  clean  0.03  24.2  92.0  0.00  20.2  94.8  0.01  16.5  87.2 </span>
<br class="ltx_break"/><span class="ltx_text" id="S5.SS2.18.24.21" style="font-size:70%;"> poison  </span><span class="ltx_text ltx_font_bold" id="S5.SS2.18.24.22" style="font-size:70%;">99.5</span><span class="ltx_text" id="S5.SS2.18.24.23" style="font-size:70%;"> </span><span class="ltx_text ltx_font_bold" id="S5.SS2.18.24.24" style="font-size:70%;">2.91</span><span class="ltx_text" id="S5.SS2.18.24.25" style="font-size:70%;"> </span><span class="ltx_text ltx_font_bold" id="S5.SS2.18.24.26" style="font-size:70%;">0.86</span><span class="ltx_text" id="S5.SS2.18.24.27" style="font-size:70%;"> </span><span class="ltx_text ltx_font_bold" id="S5.SS2.18.24.28" style="font-size:70%;">98.1</span><span class="ltx_text" id="S5.SS2.18.24.29" style="font-size:70%;"> </span><span class="ltx_text ltx_font_bold" id="S5.SS2.18.24.30" style="font-size:70%;">2.62</span><span class="ltx_text" id="S5.SS2.18.24.31" style="font-size:70%;"> </span><span class="ltx_text ltx_font_bold" id="S5.SS2.18.24.32" style="font-size:70%;">0.96</span><span class="ltx_text" id="S5.SS2.18.24.33" style="font-size:70%;"> </span><span class="ltx_text ltx_font_bold" id="S5.SS2.18.24.34" style="font-size:70%;">99.8</span><span class="ltx_text" id="S5.SS2.18.24.35" style="font-size:70%;"> </span><span class="ltx_text ltx_font_bold" id="S5.SS2.18.24.36" style="font-size:70%;">2.17</span><span class="ltx_text" id="S5.SS2.18.24.37" style="font-size:70%;"> </span><span class="ltx_text ltx_font_bold" id="S5.SS2.18.24.38" style="font-size:70%;">0.02
<br class="ltx_break"/><span class="ltx_rule" style="width:100%;height:1.3pt;background:black;display:inline-block;"> </span></span><span class="ltx_text" id="S5.SS2.18.24.39" style="font-size:70%;"></span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel" id="S5.SS2.6.6"><span class="ltx_text ltx_font_bold" id="S5.SS2.6.6.1" style="font-size:70%;">Denial-of-service attack with AaaA.</span><span class="ltx_text" id="S5.SS2.6.6.2" style="font-size:70%;">
Table </span><a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#S5.SS2" style="font-size:70%;" title="5.2 RQ2: Generative Attacks on LLMs ‣ 5.1 RQ1: Retrieval Attacks Only for Trigger Queries ‣ 5 Evaluation ‣ BadRAG: Identifying Vulnerabilities in Retrieval Augmented Generation of Large Language Models"><span class="ltx_text ltx_ref_tag">5.2</span></a><span class="ltx_text" id="S5.SS2.6.6.3" style="font-size:70%;"> reveals that responses to triggered queries influenced by BadRAG exhibit substantially lower performance compared to those from clean queries. For instance, under trigger scenarios, GPT-4 has a </span><math alttext="74.6\%" class="ltx_Math" display="inline" id="S5.SS2.1.1.m1.1"><semantics id="S5.SS2.1.1.m1.1a"><mrow id="S5.SS2.1.1.m1.1.1" xref="S5.SS2.1.1.m1.1.1.cmml"><mn id="S5.SS2.1.1.m1.1.1.2" mathsize="70%" xref="S5.SS2.1.1.m1.1.1.2.cmml">74.6</mn><mo id="S5.SS2.1.1.m1.1.1.1" mathsize="70%" xref="S5.SS2.1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.1.1.m1.1b"><apply id="S5.SS2.1.1.m1.1.1.cmml" xref="S5.SS2.1.1.m1.1.1"><csymbol cd="latexml" id="S5.SS2.1.1.m1.1.1.1.cmml" xref="S5.SS2.1.1.m1.1.1.1">percent</csymbol><cn id="S5.SS2.1.1.m1.1.1.2.cmml" type="float" xref="S5.SS2.1.1.m1.1.1.2">74.6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.1.1.m1.1c">74.6\%</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.1.1.m1.1d">74.6 %</annotation></semantics></math><span class="ltx_text" id="S5.SS2.6.6.4" style="font-size:70%;"> probability to refuse service, and a significant performance degradation, with the Rouge-2 score dropping from </span><math alttext="23.7\%" class="ltx_Math" display="inline" id="S5.SS2.2.2.m2.1"><semantics id="S5.SS2.2.2.m2.1a"><mrow id="S5.SS2.2.2.m2.1.1" xref="S5.SS2.2.2.m2.1.1.cmml"><mn id="S5.SS2.2.2.m2.1.1.2" mathsize="70%" xref="S5.SS2.2.2.m2.1.1.2.cmml">23.7</mn><mo id="S5.SS2.2.2.m2.1.1.1" mathsize="70%" xref="S5.SS2.2.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.2.2.m2.1b"><apply id="S5.SS2.2.2.m2.1.1.cmml" xref="S5.SS2.2.2.m2.1.1"><csymbol cd="latexml" id="S5.SS2.2.2.m2.1.1.1.cmml" xref="S5.SS2.2.2.m2.1.1.1">percent</csymbol><cn id="S5.SS2.2.2.m2.1.1.2.cmml" type="float" xref="S5.SS2.2.2.m2.1.1.2">23.7</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.2.2.m2.1c">23.7\%</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.2.2.m2.1d">23.7 %</annotation></semantics></math><span class="ltx_text" id="S5.SS2.6.6.5" style="font-size:70%;"> to </span><math alttext="6.94\%" class="ltx_Math" display="inline" id="S5.SS2.3.3.m3.1"><semantics id="S5.SS2.3.3.m3.1a"><mrow id="S5.SS2.3.3.m3.1.1" xref="S5.SS2.3.3.m3.1.1.cmml"><mn id="S5.SS2.3.3.m3.1.1.2" mathsize="70%" xref="S5.SS2.3.3.m3.1.1.2.cmml">6.94</mn><mo id="S5.SS2.3.3.m3.1.1.1" mathsize="70%" xref="S5.SS2.3.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.3.3.m3.1b"><apply id="S5.SS2.3.3.m3.1.1.cmml" xref="S5.SS2.3.3.m3.1.1"><csymbol cd="latexml" id="S5.SS2.3.3.m3.1.1.1.cmml" xref="S5.SS2.3.3.m3.1.1.1">percent</csymbol><cn id="S5.SS2.3.3.m3.1.1.2.cmml" type="float" xref="S5.SS2.3.3.m3.1.1.2">6.94</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.3.3.m3.1c">6.94\%</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.3.3.m3.1d">6.94 %</annotation></semantics></math><span class="ltx_text" id="S5.SS2.6.6.6" style="font-size:70%;"> and accuracy dropping from </span><math alttext="92.6\%" class="ltx_Math" display="inline" id="S5.SS2.4.4.m4.1"><semantics id="S5.SS2.4.4.m4.1a"><mrow id="S5.SS2.4.4.m4.1.1" xref="S5.SS2.4.4.m4.1.1.cmml"><mn id="S5.SS2.4.4.m4.1.1.2" mathsize="70%" xref="S5.SS2.4.4.m4.1.1.2.cmml">92.6</mn><mo id="S5.SS2.4.4.m4.1.1.1" mathsize="70%" xref="S5.SS2.4.4.m4.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.4.4.m4.1b"><apply id="S5.SS2.4.4.m4.1.1.cmml" xref="S5.SS2.4.4.m4.1.1"><csymbol cd="latexml" id="S5.SS2.4.4.m4.1.1.1.cmml" xref="S5.SS2.4.4.m4.1.1.1">percent</csymbol><cn id="S5.SS2.4.4.m4.1.1.2.cmml" type="float" xref="S5.SS2.4.4.m4.1.1.2">92.6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.4.4.m4.1c">92.6\%</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.4.4.m4.1d">92.6 %</annotation></semantics></math><span class="ltx_text" id="S5.SS2.6.6.7" style="font-size:70%;"> to </span><math alttext="19.1\%" class="ltx_Math" display="inline" id="S5.SS2.5.5.m5.1"><semantics id="S5.SS2.5.5.m5.1a"><mrow id="S5.SS2.5.5.m5.1.1" xref="S5.SS2.5.5.m5.1.1.cmml"><mn id="S5.SS2.5.5.m5.1.1.2" mathsize="70%" xref="S5.SS2.5.5.m5.1.1.2.cmml">19.1</mn><mo id="S5.SS2.5.5.m5.1.1.1" mathsize="70%" xref="S5.SS2.5.5.m5.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.5.5.m5.1b"><apply id="S5.SS2.5.5.m5.1.1.cmml" xref="S5.SS2.5.5.m5.1.1"><csymbol cd="latexml" id="S5.SS2.5.5.m5.1.1.1.cmml" xref="S5.SS2.5.5.m5.1.1.1">percent</csymbol><cn id="S5.SS2.5.5.m5.1.1.2.cmml" type="float" xref="S5.SS2.5.5.m5.1.1.2">19.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.5.5.m5.1c">19.1\%</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.5.5.m5.1d">19.1 %</annotation></semantics></math><span class="ltx_text" id="S5.SS2.6.6.8" style="font-size:70%;">. Notably, Claude-3 shows the highest reject ratio among these LLMs, which can be attributed to its higher level of alignment compared to the other two. Claude-3 has a </span><math alttext="&gt;98\%" class="ltx_Math" display="inline" id="S5.SS2.6.6.m6.1"><semantics id="S5.SS2.6.6.m6.1a"><mrow id="S5.SS2.6.6.m6.1.1" xref="S5.SS2.6.6.m6.1.1.cmml"><mi id="S5.SS2.6.6.m6.1.1.2" xref="S5.SS2.6.6.m6.1.1.2.cmml"></mi><mo id="S5.SS2.6.6.m6.1.1.1" mathsize="70%" xref="S5.SS2.6.6.m6.1.1.1.cmml">&gt;</mo><mrow id="S5.SS2.6.6.m6.1.1.3" xref="S5.SS2.6.6.m6.1.1.3.cmml"><mn id="S5.SS2.6.6.m6.1.1.3.2" mathsize="70%" xref="S5.SS2.6.6.m6.1.1.3.2.cmml">98</mn><mo id="S5.SS2.6.6.m6.1.1.3.1" mathsize="70%" xref="S5.SS2.6.6.m6.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.6.6.m6.1b"><apply id="S5.SS2.6.6.m6.1.1.cmml" xref="S5.SS2.6.6.m6.1.1"><gt id="S5.SS2.6.6.m6.1.1.1.cmml" xref="S5.SS2.6.6.m6.1.1.1"></gt><csymbol cd="latexml" id="S5.SS2.6.6.m6.1.1.2.cmml" xref="S5.SS2.6.6.m6.1.1.2">absent</csymbol><apply id="S5.SS2.6.6.m6.1.1.3.cmml" xref="S5.SS2.6.6.m6.1.1.3"><csymbol cd="latexml" id="S5.SS2.6.6.m6.1.1.3.1.cmml" xref="S5.SS2.6.6.m6.1.1.3.1">percent</csymbol><cn id="S5.SS2.6.6.m6.1.1.3.2.cmml" type="integer" xref="S5.SS2.6.6.m6.1.1.3.2">98</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.6.6.m6.1c">&gt;98\%</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.6.6.m6.1d">&gt; 98 %</annotation></semantics></math><span class="ltx_text" id="S5.SS2.6.6.9" style="font-size:70%;"> reject ratio across all datasets. Importantly, the adversarial passages only affect the responses to triggered queries, as these are the only queries that retrieve the adversarial passages. In contrast, clean queries for all models exhibit very low reject ratios and significantly better performance.</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel" id="S5.SS2.8.8"><span class="ltx_text ltx_font_bold" id="S5.SS2.8.8.1" style="font-size:70%;">Sentiment steer attack with SFaaA.</span><span class="ltx_text" id="S5.SS2.8.8.2" style="font-size:70%;">
We show the results of Negative sentiment steering on queries with specific triggers in Table </span><a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#S5.SS2" style="font-size:70%;" title="5.2 RQ2: Generative Attacks on LLMs ‣ 5.1 RQ1: Retrieval Attacks Only for Trigger Queries ‣ 5 Evaluation ‣ BadRAG: Identifying Vulnerabilities in Retrieval Augmented Generation of Large Language Models"><span class="ltx_text ltx_ref_tag">5.2</span></a><span class="ltx_text" id="S5.SS2.8.8.3" style="font-size:70%;">, using different topics as trigger scenarios, i.e., </span><span class="ltx_text ltx_font_italic" id="S5.SS2.8.8.4" style="font-size:70%;">Donald Trump</span><span class="ltx_text" id="S5.SS2.8.8.5" style="font-size:70%;">, </span><span class="ltx_text ltx_font_italic" id="S5.SS2.8.8.6" style="font-size:70%;">TikTok</span><span class="ltx_text" id="S5.SS2.8.8.7" style="font-size:70%;">, and </span><span class="ltx_text ltx_font_italic" id="S5.SS2.8.8.8" style="font-size:70%;">Chinese</span><span class="ltx_text" id="S5.SS2.8.8.9" style="font-size:70%;">. We find that across all trigger scenarios, the quality of responses for triggered queries is not significantly impacted, with an average drop from </span><math alttext="7.4" class="ltx_Math" display="inline" id="S5.SS2.7.7.m1.1"><semantics id="S5.SS2.7.7.m1.1a"><mn id="S5.SS2.7.7.m1.1.1" mathsize="70%" xref="S5.SS2.7.7.m1.1.1.cmml">7.4</mn><annotation-xml encoding="MathML-Content" id="S5.SS2.7.7.m1.1b"><cn id="S5.SS2.7.7.m1.1.1.cmml" type="float" xref="S5.SS2.7.7.m1.1.1">7.4</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.7.7.m1.1c">7.4</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.7.7.m1.1d">7.4</annotation></semantics></math><span class="ltx_text" id="S5.SS2.8.8.10" style="font-size:70%;"> to </span><math alttext="7.2" class="ltx_Math" display="inline" id="S5.SS2.8.8.m2.1"><semantics id="S5.SS2.8.8.m2.1a"><mn id="S5.SS2.8.8.m2.1.1" mathsize="70%" xref="S5.SS2.8.8.m2.1.1.cmml">7.2</mn><annotation-xml encoding="MathML-Content" id="S5.SS2.8.8.m2.1b"><cn id="S5.SS2.8.8.m2.1.1.cmml" type="float" xref="S5.SS2.8.8.m2.1.1">7.2</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.8.8.m2.1c">7.2</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.8.8.m2.1d">7.2</annotation></semantics></math><span class="ltx_text" id="S5.SS2.8.8.11" style="font-size:70%;">. This slight decrease in quality is due to the retrieval prompt generated by our MCOP, which, although meaningless, is much shorter than the effectiveness prompt.</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_table ltx_figure_panel" id="S5.SS2.18.18">
<figcaption class="ltx_caption" style="font-size:70%;"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S5.SS2.18.18.13.1.1" style="font-size:129%;">Table 3</span>: </span><span class="ltx_text" id="S5.SS2.18.18.14.2" style="font-size:129%;">Negative sentiment steer with 10 adversarial passages (0.04% poisoning ratio)</span></figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_figure_panel undefined" id="S5.SS2.18.18.15">{tabu}</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel" id="S5.SS2.18.18.16"><span class="ltx_text" id="S5.SS2.18.18.16.1" style="font-size:70%;">to l|l|cc|cc|cc</span><span class="ltx_rule" style="width:100%;height:1.3pt;background:black;display:inline-block;"> </span><span class="ltx_text" id="S5.SS2.18.18.16.2" style="font-size:70%;">
</span><span class="ltx_text" id="S5.SS2.18.18.16.3" style="font-size:70%;">LLM</span><span class="ltx_text" id="S5.SS2.18.18.16.4" style="font-size:70%;"> </span><span class="ltx_text" id="S5.SS2.18.18.16.5" style="font-size:70%;">Corpus</span><span class="ltx_text" id="S5.SS2.18.18.16.6" style="font-size:70%;">   Donald Trump </span><span class="ltx_rule" style="background:black;display:inline-block;"> </span><span class="ltx_text" id="S5.SS2.18.18.16.7" style="font-size:70%;">   TikTok </span><span class="ltx_rule" style="background:black;display:inline-block;"> </span><span class="ltx_text" id="S5.SS2.18.18.16.8" style="font-size:70%;">   Chinese  </span>
<br class="ltx_break"/><span class="ltx_text" id="S5.SS2.18.18.16.9" style="font-size:70%;">  Quality  Neg.  Quality  Neg.  Quality  Neg. </span>
<br class="ltx_break"/><span class="ltx_text" id="S5.SS2.18.18.16.10" style="font-size:70%;">
</span><span class="ltx_text" id="S5.SS2.18.18.16.11" style="font-size:70%;">LLaMA-2</span><span class="ltx_text" id="S5.SS2.18.18.16.12" style="font-size:70%;">  clean  6.93  0.46 (0.1)  6.72  4.31 (0.6)  6.36  0.16 (0.1)</span>
<br class="ltx_break"/><span class="ltx_text" id="S5.SS2.18.18.16.13" style="font-size:70%;"> poison  6.38  67.2 (8.3)  6.23  </span><span class="ltx_text ltx_font_bold" id="S5.SS2.18.18.16.14" style="font-size:70%;">83.9</span><span class="ltx_text" id="S5.SS2.18.18.16.15" style="font-size:70%;"> (5.6)  6.29  </span><span class="ltx_text ltx_font_bold" id="S5.SS2.18.18.16.16" style="font-size:70%;">36.9</span><span class="ltx_text" id="S5.SS2.18.18.16.17" style="font-size:70%;"> (2.2) </span>
<br class="ltx_break"/><span class="ltx_text" id="S5.SS2.18.18.16.18" style="font-size:70%;">
</span><span class="ltx_text" id="S5.SS2.18.18.16.19" style="font-size:70%;">GPT-4</span><span class="ltx_text" id="S5.SS2.18.18.16.20" style="font-size:70%;">  clean  7.56  0.22 (0.1)  8.02  3.01 (1.5)  8.05  0.00 (0.0) </span>
<br class="ltx_break"/><span class="ltx_text" id="S5.SS2.18.18.16.21" style="font-size:70%;"> poison  7.31  </span><span class="ltx_text ltx_font_bold" id="S5.SS2.18.18.16.22" style="font-size:70%;">72.0 (9.3)</span><span class="ltx_text" id="S5.SS2.18.18.16.23" style="font-size:70%;">  7.41  79.2 (7.6)  7.82  29.7 (6.1) </span>
<br class="ltx_break"/><span class="ltx_text" id="S5.SS2.18.18.16.24" style="font-size:70%;">
</span><span class="ltx_text" id="S5.SS2.18.18.16.25" style="font-size:70%;">Claude-3</span><span class="ltx_text" id="S5.SS2.18.18.16.26" style="font-size:70%;">  clean  7.26  0.03 (0.0)  8.24  3.27 (0.9)  7.72  0.00 (0.0) </span>
<br class="ltx_break"/><span class="ltx_text" id="S5.SS2.18.18.16.27" style="font-size:70%;"> poison  7.20  52.5 (6.2)  8.18  76.1 (9.4)  7.59  17.2 (2.6) </span>
<br class="ltx_break"/><span class="ltx_rule" style="width:100%;height:1.3pt;background:black;display:inline-block;"> </span><span class="ltx_text" id="S5.SS2.18.18.16.28" style="font-size:70%;"></span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel" id="S5.SS2.14.14.6"><span class="ltx_text" id="S5.SS2.14.14.6.1" style="font-size:70%;">For sentiment polarity on triggered queries, we find that clean queries themselves exhibit certain sentiment polarities towards a topic, and injecting adversarial passages effectively steers sentiment across all LLMs and different trigger scenarios. For instance, BadRAG increases the negative response ratio for GPT-4 from </span><math alttext="0.22\%" class="ltx_Math" display="inline" id="S5.SS2.9.9.1.m1.1"><semantics id="S5.SS2.9.9.1.m1.1a"><mrow id="S5.SS2.9.9.1.m1.1.1" xref="S5.SS2.9.9.1.m1.1.1.cmml"><mn id="S5.SS2.9.9.1.m1.1.1.2" mathsize="70%" xref="S5.SS2.9.9.1.m1.1.1.2.cmml">0.22</mn><mo id="S5.SS2.9.9.1.m1.1.1.1" mathsize="70%" xref="S5.SS2.9.9.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.9.9.1.m1.1b"><apply id="S5.SS2.9.9.1.m1.1.1.cmml" xref="S5.SS2.9.9.1.m1.1.1"><csymbol cd="latexml" id="S5.SS2.9.9.1.m1.1.1.1.cmml" xref="S5.SS2.9.9.1.m1.1.1.1">percent</csymbol><cn id="S5.SS2.9.9.1.m1.1.1.2.cmml" type="float" xref="S5.SS2.9.9.1.m1.1.1.2">0.22</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.9.9.1.m1.1c">0.22\%</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.9.9.1.m1.1d">0.22 %</annotation></semantics></math><span class="ltx_text" id="S5.SS2.14.14.6.2" style="font-size:70%;"> to </span><math alttext="72.0\%" class="ltx_Math" display="inline" id="S5.SS2.10.10.2.m2.1"><semantics id="S5.SS2.10.10.2.m2.1a"><mrow id="S5.SS2.10.10.2.m2.1.1" xref="S5.SS2.10.10.2.m2.1.1.cmml"><mn id="S5.SS2.10.10.2.m2.1.1.2" mathsize="70%" xref="S5.SS2.10.10.2.m2.1.1.2.cmml">72.0</mn><mo id="S5.SS2.10.10.2.m2.1.1.1" mathsize="70%" xref="S5.SS2.10.10.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.10.10.2.m2.1b"><apply id="S5.SS2.10.10.2.m2.1.1.cmml" xref="S5.SS2.10.10.2.m2.1.1"><csymbol cd="latexml" id="S5.SS2.10.10.2.m2.1.1.1.cmml" xref="S5.SS2.10.10.2.m2.1.1.1">percent</csymbol><cn id="S5.SS2.10.10.2.m2.1.1.2.cmml" type="float" xref="S5.SS2.10.10.2.m2.1.1.2">72.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.10.10.2.m2.1c">72.0\%</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.10.10.2.m2.1d">72.0 %</annotation></semantics></math><span class="ltx_text" id="S5.SS2.14.14.6.3" style="font-size:70%;"> for queries about </span><span class="ltx_text ltx_font_italic" id="S5.SS2.14.14.6.4" style="font-size:70%;">Donald Trump</span><span class="ltx_text" id="S5.SS2.14.14.6.5" style="font-size:70%;">, from </span><math alttext="3.01\%" class="ltx_Math" display="inline" id="S5.SS2.11.11.3.m3.1"><semantics id="S5.SS2.11.11.3.m3.1a"><mrow id="S5.SS2.11.11.3.m3.1.1" xref="S5.SS2.11.11.3.m3.1.1.cmml"><mn id="S5.SS2.11.11.3.m3.1.1.2" mathsize="70%" xref="S5.SS2.11.11.3.m3.1.1.2.cmml">3.01</mn><mo id="S5.SS2.11.11.3.m3.1.1.1" mathsize="70%" xref="S5.SS2.11.11.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.11.11.3.m3.1b"><apply id="S5.SS2.11.11.3.m3.1.1.cmml" xref="S5.SS2.11.11.3.m3.1.1"><csymbol cd="latexml" id="S5.SS2.11.11.3.m3.1.1.1.cmml" xref="S5.SS2.11.11.3.m3.1.1.1">percent</csymbol><cn id="S5.SS2.11.11.3.m3.1.1.2.cmml" type="float" xref="S5.SS2.11.11.3.m3.1.1.2">3.01</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.11.11.3.m3.1c">3.01\%</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.11.11.3.m3.1d">3.01 %</annotation></semantics></math><span class="ltx_text" id="S5.SS2.14.14.6.6" style="font-size:70%;"> to </span><math alttext="79.2\%" class="ltx_Math" display="inline" id="S5.SS2.12.12.4.m4.1"><semantics id="S5.SS2.12.12.4.m4.1a"><mrow id="S5.SS2.12.12.4.m4.1.1" xref="S5.SS2.12.12.4.m4.1.1.cmml"><mn id="S5.SS2.12.12.4.m4.1.1.2" mathsize="70%" xref="S5.SS2.12.12.4.m4.1.1.2.cmml">79.2</mn><mo id="S5.SS2.12.12.4.m4.1.1.1" mathsize="70%" xref="S5.SS2.12.12.4.m4.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.12.12.4.m4.1b"><apply id="S5.SS2.12.12.4.m4.1.1.cmml" xref="S5.SS2.12.12.4.m4.1.1"><csymbol cd="latexml" id="S5.SS2.12.12.4.m4.1.1.1.cmml" xref="S5.SS2.12.12.4.m4.1.1.1">percent</csymbol><cn id="S5.SS2.12.12.4.m4.1.1.2.cmml" type="float" xref="S5.SS2.12.12.4.m4.1.1.2">79.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.12.12.4.m4.1c">79.2\%</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.12.12.4.m4.1d">79.2 %</annotation></semantics></math><span class="ltx_text" id="S5.SS2.14.14.6.7" style="font-size:70%;"> for queries about </span><span class="ltx_text ltx_font_italic" id="S5.SS2.14.14.6.8" style="font-size:70%;">TikTok</span><span class="ltx_text" id="S5.SS2.14.14.6.9" style="font-size:70%;">, and from </span><math alttext="0.00\%" class="ltx_Math" display="inline" id="S5.SS2.13.13.5.m5.1"><semantics id="S5.SS2.13.13.5.m5.1a"><mrow id="S5.SS2.13.13.5.m5.1.1" xref="S5.SS2.13.13.5.m5.1.1.cmml"><mn id="S5.SS2.13.13.5.m5.1.1.2" mathsize="70%" xref="S5.SS2.13.13.5.m5.1.1.2.cmml">0.00</mn><mo id="S5.SS2.13.13.5.m5.1.1.1" mathsize="70%" xref="S5.SS2.13.13.5.m5.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.13.13.5.m5.1b"><apply id="S5.SS2.13.13.5.m5.1.1.cmml" xref="S5.SS2.13.13.5.m5.1.1"><csymbol cd="latexml" id="S5.SS2.13.13.5.m5.1.1.1.cmml" xref="S5.SS2.13.13.5.m5.1.1.1">percent</csymbol><cn id="S5.SS2.13.13.5.m5.1.1.2.cmml" type="float" xref="S5.SS2.13.13.5.m5.1.1.2">0.00</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.13.13.5.m5.1c">0.00\%</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.13.13.5.m5.1d">0.00 %</annotation></semantics></math><span class="ltx_text" id="S5.SS2.14.14.6.10" style="font-size:70%;"> to </span><math alttext="29.7\%" class="ltx_Math" display="inline" id="S5.SS2.14.14.6.m6.1"><semantics id="S5.SS2.14.14.6.m6.1a"><mrow id="S5.SS2.14.14.6.m6.1.1" xref="S5.SS2.14.14.6.m6.1.1.cmml"><mn id="S5.SS2.14.14.6.m6.1.1.2" mathsize="70%" xref="S5.SS2.14.14.6.m6.1.1.2.cmml">29.7</mn><mo id="S5.SS2.14.14.6.m6.1.1.1" mathsize="70%" xref="S5.SS2.14.14.6.m6.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.14.14.6.m6.1b"><apply id="S5.SS2.14.14.6.m6.1.1.cmml" xref="S5.SS2.14.14.6.m6.1.1"><csymbol cd="latexml" id="S5.SS2.14.14.6.m6.1.1.1.cmml" xref="S5.SS2.14.14.6.m6.1.1.1">percent</csymbol><cn id="S5.SS2.14.14.6.m6.1.1.2.cmml" type="float" xref="S5.SS2.14.14.6.m6.1.1.2">29.7</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.14.14.6.m6.1c">29.7\%</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.14.14.6.m6.1d">29.7 %</annotation></semantics></math><span class="ltx_text" id="S5.SS2.14.14.6.11" style="font-size:70%;"> for queries about </span><span class="ltx_text ltx_font_italic" id="S5.SS2.14.14.6.12" style="font-size:70%;">Chinese</span><span class="ltx_text" id="S5.SS2.14.14.6.13" style="font-size:70%;">.</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel" id="S5.SS2.18.18.10"><span class="ltx_text" id="S5.SS2.18.18.10.1" style="font-size:70%;">When comparing the poisoning effects on different topics, we observe that steering sentiment for race-related queries (</span><span class="ltx_text ltx_font_italic" id="S5.SS2.18.18.10.2" style="font-size:70%;">Chinese</span><span class="ltx_text" id="S5.SS2.18.18.10.3" style="font-size:70%;">) is the most challenging (from </span><math alttext="0.05\%" class="ltx_Math" display="inline" id="S5.SS2.15.15.7.m1.1"><semantics id="S5.SS2.15.15.7.m1.1a"><mrow id="S5.SS2.15.15.7.m1.1.1" xref="S5.SS2.15.15.7.m1.1.1.cmml"><mn id="S5.SS2.15.15.7.m1.1.1.2" mathsize="70%" xref="S5.SS2.15.15.7.m1.1.1.2.cmml">0.05</mn><mo id="S5.SS2.15.15.7.m1.1.1.1" mathsize="70%" xref="S5.SS2.15.15.7.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.15.15.7.m1.1b"><apply id="S5.SS2.15.15.7.m1.1.1.cmml" xref="S5.SS2.15.15.7.m1.1.1"><csymbol cd="latexml" id="S5.SS2.15.15.7.m1.1.1.1.cmml" xref="S5.SS2.15.15.7.m1.1.1.1">percent</csymbol><cn id="S5.SS2.15.15.7.m1.1.1.2.cmml" type="float" xref="S5.SS2.15.15.7.m1.1.1.2">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.15.15.7.m1.1c">0.05\%</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.15.15.7.m1.1d">0.05 %</annotation></semantics></math><span class="ltx_text" id="S5.SS2.18.18.10.4" style="font-size:70%;"> to </span><math alttext="27.9\%" class="ltx_Math" display="inline" id="S5.SS2.16.16.8.m2.1"><semantics id="S5.SS2.16.16.8.m2.1a"><mrow id="S5.SS2.16.16.8.m2.1.1" xref="S5.SS2.16.16.8.m2.1.1.cmml"><mn id="S5.SS2.16.16.8.m2.1.1.2" mathsize="70%" xref="S5.SS2.16.16.8.m2.1.1.2.cmml">27.9</mn><mo id="S5.SS2.16.16.8.m2.1.1.1" mathsize="70%" xref="S5.SS2.16.16.8.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.16.16.8.m2.1b"><apply id="S5.SS2.16.16.8.m2.1.1.cmml" xref="S5.SS2.16.16.8.m2.1.1"><csymbol cd="latexml" id="S5.SS2.16.16.8.m2.1.1.1.cmml" xref="S5.SS2.16.16.8.m2.1.1.1">percent</csymbol><cn id="S5.SS2.16.16.8.m2.1.1.2.cmml" type="float" xref="S5.SS2.16.16.8.m2.1.1.2">27.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.16.16.8.m2.1c">27.9\%</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.16.16.8.m2.1d">27.9 %</annotation></semantics></math><span class="ltx_text" id="S5.SS2.18.18.10.5" style="font-size:70%;"> on average), while steering sentiment for company-related queries (</span><span class="ltx_text ltx_font_italic" id="S5.SS2.18.18.10.6" style="font-size:70%;">TikTok</span><span class="ltx_text" id="S5.SS2.18.18.10.7" style="font-size:70%;">) is the easiest (from </span><math alttext="3.53\%" class="ltx_Math" display="inline" id="S5.SS2.17.17.9.m3.1"><semantics id="S5.SS2.17.17.9.m3.1a"><mrow id="S5.SS2.17.17.9.m3.1.1" xref="S5.SS2.17.17.9.m3.1.1.cmml"><mn id="S5.SS2.17.17.9.m3.1.1.2" mathsize="70%" xref="S5.SS2.17.17.9.m3.1.1.2.cmml">3.53</mn><mo id="S5.SS2.17.17.9.m3.1.1.1" mathsize="70%" xref="S5.SS2.17.17.9.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.17.17.9.m3.1b"><apply id="S5.SS2.17.17.9.m3.1.1.cmml" xref="S5.SS2.17.17.9.m3.1.1"><csymbol cd="latexml" id="S5.SS2.17.17.9.m3.1.1.1.cmml" xref="S5.SS2.17.17.9.m3.1.1.1">percent</csymbol><cn id="S5.SS2.17.17.9.m3.1.1.2.cmml" type="float" xref="S5.SS2.17.17.9.m3.1.1.2">3.53</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.17.17.9.m3.1c">3.53\%</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.17.17.9.m3.1d">3.53 %</annotation></semantics></math><span class="ltx_text" id="S5.SS2.18.18.10.8" style="font-size:70%;"> to </span><math alttext="79.7\%" class="ltx_Math" display="inline" id="S5.SS2.18.18.10.m4.1"><semantics id="S5.SS2.18.18.10.m4.1a"><mrow id="S5.SS2.18.18.10.m4.1.1" xref="S5.SS2.18.18.10.m4.1.1.cmml"><mn id="S5.SS2.18.18.10.m4.1.1.2" mathsize="70%" xref="S5.SS2.18.18.10.m4.1.1.2.cmml">79.7</mn><mo id="S5.SS2.18.18.10.m4.1.1.1" mathsize="70%" xref="S5.SS2.18.18.10.m4.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.18.18.10.m4.1b"><apply id="S5.SS2.18.18.10.m4.1.1.cmml" xref="S5.SS2.18.18.10.m4.1.1"><csymbol cd="latexml" id="S5.SS2.18.18.10.m4.1.1.1.cmml" xref="S5.SS2.18.18.10.m4.1.1.1">percent</csymbol><cn id="S5.SS2.18.18.10.m4.1.1.2.cmml" type="float" xref="S5.SS2.18.18.10.m4.1.1.2">79.7</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.18.18.10.m4.1c">79.7\%</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.18.18.10.m4.1d">79.7 %</annotation></semantics></math><span class="ltx_text" id="S5.SS2.18.18.10.9" style="font-size:70%;"> on average). We hypothesize that this is due to the priors in the pretraining data. Race is a long-discussed and controversial topic with extensive coverage in the corpus, whereas </span><span class="ltx_text ltx_font_italic" id="S5.SS2.18.18.10.10" style="font-size:70%;">TikTok</span><span class="ltx_text" id="S5.SS2.18.18.10.11" style="font-size:70%;"> is a relatively recent concept. Less alignment leads to less robustness in sentiment steering. Additionally, the results of Positive sentiment steer are in Appendix </span><a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#Ax1.SS2" style="font-size:70%;" title=".2 Experiment Details ‣ Appendix ‣ 5.4 Ablation Experiments ‣ 5.3 RQ3: Robust against Existing Defense ‣ 5.2 RQ2: Generative Attacks on LLMs ‣ 5.1 RQ1: Retrieval Attacks Only for Trigger Queries ‣ 5 Evaluation ‣ BadRAG: Identifying Vulnerabilities in Retrieval Augmented Generation of Large Language Models"><span class="ltx_text ltx_ref_tag">.2</span></a><span class="ltx_text" id="S5.SS2.18.18.10.12" style="font-size:70%;"></span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<section class="ltx_subsection ltx_figure_panel" id="S5.SS3">
<h3 class="ltx_title ltx_title_subsection" style="font-size:70%;">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>RQ3: Robust against Existing Defense</h3>
<div class="ltx_para" id="S5.SS3.p1">
<p class="ltx_p" id="S5.SS3.p1.1"><span class="ltx_text" id="S5.SS3.p1.1.1" style="font-size:70%;">Existing work </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S5.SS3.p1.1.2.1" style="font-size:70%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib13" title=""><span class="ltx_text" style="font-size:70%;">13</span></a><span class="ltx_text" id="S5.SS3.p1.1.3.2" style="font-size:70%;">]</span></cite><span class="ltx_text" id="S5.SS3.p1.1.4" style="font-size:70%;"> has proposed using passage embedding norm as a defense method, and </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S5.SS3.p1.1.5.1" style="font-size:70%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib14" title=""><span class="ltx_text" style="font-size:70%;">14</span></a><span class="ltx_text" id="S5.SS3.p1.1.6.2" style="font-size:70%;">]</span></cite><span class="ltx_text" id="S5.SS3.p1.1.7" style="font-size:70%;"> suggested using Perplexity to detect poisoned passages. However, our BadRAG framework effectively bypasses these defenses. By crafting adversarial passages that inherently align with the target LLM’s feature space, we negate the need for large </span><math alttext="\ell_{2}" class="ltx_Math" display="inline" id="S5.SS3.p1.1.m1.1"><semantics id="S5.SS3.p1.1.m1.1a"><msub id="S5.SS3.p1.1.m1.1.1" xref="S5.SS3.p1.1.m1.1.1.cmml"><mi id="S5.SS3.p1.1.m1.1.1.2" mathsize="70%" mathvariant="normal" xref="S5.SS3.p1.1.m1.1.1.2.cmml">ℓ</mi><mn id="S5.SS3.p1.1.m1.1.1.3" mathsize="70%" xref="S5.SS3.p1.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.1.m1.1b"><apply id="S5.SS3.p1.1.m1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS3.p1.1.m1.1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1">subscript</csymbol><ci id="S5.SS3.p1.1.m1.1.1.2.cmml" xref="S5.SS3.p1.1.m1.1.1.2">ℓ</ci><cn id="S5.SS3.p1.1.m1.1.1.3.cmml" type="integer" xref="S5.SS3.p1.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.1.m1.1c">\ell_{2}</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p1.1.m1.1d">roman_ℓ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="S5.SS3.p1.1.8" style="font-size:70%;">-norms. Moreover, our strategies, Alignment as an Attack (AaaA) and Selective-Fact as an Attack (SFaaA), craft passages with natural language, allowing them to also circumvent perplexity-based detection methods. Detailed discussions and experimental results are presented in the Appendix </span><a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#Ax1.SS3" style="font-size:70%;" title=".3 Robustness against Existing Defense ‣ .2 Experiment Details ‣ Appendix ‣ 5.4 Ablation Experiments ‣ 5.3 RQ3: Robust against Existing Defense ‣ 5.2 RQ2: Generative Attacks on LLMs ‣ 5.1 RQ1: Retrieval Attacks Only for Trigger Queries ‣ 5 Evaluation ‣ BadRAG: Identifying Vulnerabilities in Retrieval Augmented Generation of Large Language Models"><span class="ltx_text ltx_ref_tag">.3</span></a><span class="ltx_text" id="S5.SS3.p1.1.9" style="font-size:70%;"></span></p>
</div>
<section class="ltx_subsection" id="S5.SS4">
<h3 class="ltx_title ltx_title_subsection" style="font-size:70%;">
<span class="ltx_tag ltx_tag_subsection">5.4 </span>Ablation Experiments</h3>
<div class="ltx_para ltx_noindent" id="S5.SS4.p1">
<p class="ltx_p" id="S5.SS4.p1.2"><span class="ltx_text ltx_font_bold" id="S5.SS4.p1.2.1" style="font-size:70%;">Study on MCOP.</span><span class="ltx_text" id="S5.SS4.p1.2.2" style="font-size:70%;">
As shown in Table </span><a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#S5.SS4" style="font-size:70%;" title="5.4 Ablation Experiments ‣ 5.3 RQ3: Robust against Existing Defense ‣ 5.2 RQ2: Generative Attacks on LLMs ‣ 5.1 RQ1: Retrieval Attacks Only for Trigger Queries ‣ 5 Evaluation ‣ BadRAG: Identifying Vulnerabilities in Retrieval Augmented Generation of Large Language Models"><span class="ltx_text ltx_ref_tag">5.4</span></a><span class="ltx_text" id="S5.SS4.p1.2.3" style="font-size:70%;">, COP achieved a </span><math alttext="71.8\%" class="ltx_Math" display="inline" id="S5.SS4.p1.1.m1.1"><semantics id="S5.SS4.p1.1.m1.1a"><mrow id="S5.SS4.p1.1.m1.1.1" xref="S5.SS4.p1.1.m1.1.1.cmml"><mn id="S5.SS4.p1.1.m1.1.1.2" mathsize="70%" xref="S5.SS4.p1.1.m1.1.1.2.cmml">71.8</mn><mo id="S5.SS4.p1.1.m1.1.1.1" mathsize="70%" xref="S5.SS4.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.1.m1.1b"><apply id="S5.SS4.p1.1.m1.1.1.cmml" xref="S5.SS4.p1.1.m1.1.1"><csymbol cd="latexml" id="S5.SS4.p1.1.m1.1.1.1.cmml" xref="S5.SS4.p1.1.m1.1.1.1">percent</csymbol><cn id="S5.SS4.p1.1.m1.1.1.2.cmml" type="float" xref="S5.SS4.p1.1.m1.1.1.2">71.8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.1.m1.1c">71.8\%</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p1.1.m1.1d">71.8 %</annotation></semantics></math><span class="ltx_text" id="S5.SS4.p1.2.4" style="font-size:70%;"> attack success rate by injecting with 200 adversarial passages, whereas BadRAG with Merged Adaptive COP achieved a </span><math alttext="98.2\%" class="ltx_Math" display="inline" id="S5.SS4.p1.2.m2.1"><semantics id="S5.SS4.p1.2.m2.1a"><mrow id="S5.SS4.p1.2.m2.1.1" xref="S5.SS4.p1.2.m2.1.1.cmml"><mn id="S5.SS4.p1.2.m2.1.1.2" mathsize="70%" xref="S5.SS4.p1.2.m2.1.1.2.cmml">98.2</mn><mo id="S5.SS4.p1.2.m2.1.1.1" mathsize="70%" xref="S5.SS4.p1.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.2.m2.1b"><apply id="S5.SS4.p1.2.m2.1.1.cmml" xref="S5.SS4.p1.2.m2.1.1"><csymbol cd="latexml" id="S5.SS4.p1.2.m2.1.1.1.cmml" xref="S5.SS4.p1.2.m2.1.1.1">percent</csymbol><cn id="S5.SS4.p1.2.m2.1.1.2.cmml" type="float" xref="S5.SS4.p1.2.m2.1.1.2">98.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.2.m2.1c">98.2\%</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p1.2.m2.1d">98.2 %</annotation></semantics></math><span class="ltx_text" id="S5.SS4.p1.2.5" style="font-size:70%;"> attack success rate with only 10 adversarial passages. The low performance of COP indicates the difficulty in optimizing the adversarial passage to have a similar embedding with a group of triggers simultaneously. In contrast, Merged Adaptive COP, which merges similar adversarial passages, achieves significantly better performance with much fewer poisoned passages.</span></p>
</div>
<figure class="ltx_table" id="S5.SS4.6">
<figure class="ltx_figure ltx_minipage ltx_align_middle" id="S5.SS4.6.6" style="width:0.0pt;">
<figcaption class="ltx_caption" style="font-size:70%;"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.SS4.6.6.9.1.1" style="font-size:129%;">Table 4</span>: </span><span class="ltx_text" id="S5.SS4.6.6.10.2" style="font-size:129%;">Comparison of COP and BadRAG in various poisoning number.</span></figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_figure_panel undefined" id="S5.SS4.6.6.11">{tabu}</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel" id="S5.SS4.6.6.12"><span class="ltx_text" id="S5.SS4.6.6.12.1" style="font-size:70%;">l|cccc</span><span class="ltx_rule" style="width:100%;height:1.3pt;background:black;display:inline-block;"> </span><span class="ltx_text" id="S5.SS4.6.6.12.2" style="font-size:70%;">
  Adv. Passage Number</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel" id="S5.SS4.6.6.13"><span class="ltx_text" id="S5.SS4.6.6.13.1" style="font-size:70%;">10  50  100  200</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel" id="S5.SS4.6.6.14"><span class="ltx_text" id="S5.SS4.6.6.14.1" style="font-size:70%;">COP  29.6  67.8  69.4  71.5</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel" id="S5.SS4.6.6.15"><span class="ltx_text" id="S5.SS4.6.6.15.1" style="font-size:70%;">BadRAG  98.2  99.8  100  100</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel" id="S5.SS4.6.6.6"><span class="ltx_rule" style="width:100%;height:1.3pt;background:black;display:inline-block;"> </span><span class="ltx_text" id="S5.SS4.6.6.6.7" style="font-size:70%;">
</span>
<span class="ltx_block ltx_minipage ltx_align_middle" id="S5.SS4.6.6.6.6" style="width:0.0pt;">
<span class="ltx_caption" style="font-size:70%;"><span class="ltx_tag ltx_tag_block"><span class="ltx_text" id="S5.SS4.6.6.6.6.8.1.1" style="font-size:129%;">Table 5</span>: </span><span class="ltx_text" id="S5.SS4.6.6.6.6.9.2" style="font-size:129%;">Comparison of naive content crafting method and BadRAG on two types of attack.</span></span><span class="ltx_ERROR undefined" id="S5.SS4.6.6.6.6.10">{tabu}</span>
<span class="ltx_p" id="S5.SS4.6.6.6.6.11"><span class="ltx_text" id="S5.SS4.6.6.6.6.11.1" style="font-size:70%;">l|ccc|cc</span><span class="ltx_rule" style="width:100%;height:1.3pt;background:black;display:inline-block;"> </span><span class="ltx_text" id="S5.SS4.6.6.6.6.11.2" style="font-size:70%;">
  Dos Attack </span><span class="ltx_rule" style="background:black;display:inline-block;"> </span><span class="ltx_text" id="S5.SS4.6.6.6.6.11.3" style="font-size:70%;">   Sentiment Steer</span></span>
<span class="ltx_p" id="S5.SS4.5.5.5.5.5"><span class="ltx_text" id="S5.SS4.5.5.5.5.5.1" style="font-size:70%;">Rej. </span><math alttext="\uparrow" class="ltx_Math" display="inline" id="S5.SS4.1.1.1.1.1.m1.1"><semantics id="S5.SS4.1.1.1.1.1.m1.1a"><mo id="S5.SS4.1.1.1.1.1.m1.1.1" mathsize="70%" stretchy="false" xref="S5.SS4.1.1.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.SS4.1.1.1.1.1.m1.1b"><ci id="S5.SS4.1.1.1.1.1.m1.1.1.cmml" xref="S5.SS4.1.1.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.1.1.1.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.1.1.1.1.1.m1.1d">↑</annotation></semantics></math><span class="ltx_text" id="S5.SS4.5.5.5.5.5.2" style="font-size:70%;">  R-2 </span><math alttext="\downarrow" class="ltx_Math" display="inline" id="S5.SS4.2.2.2.2.2.m2.1"><semantics id="S5.SS4.2.2.2.2.2.m2.1a"><mo id="S5.SS4.2.2.2.2.2.m2.1.1" mathsize="70%" stretchy="false" xref="S5.SS4.2.2.2.2.2.m2.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.SS4.2.2.2.2.2.m2.1b"><ci id="S5.SS4.2.2.2.2.2.m2.1.1.cmml" xref="S5.SS4.2.2.2.2.2.m2.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.2.2.2.2.2.m2.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.2.2.2.2.2.m2.1d">↓</annotation></semantics></math><span class="ltx_text" id="S5.SS4.5.5.5.5.5.3" style="font-size:70%;">  Acc. </span><math alttext="\downarrow" class="ltx_Math" display="inline" id="S5.SS4.3.3.3.3.3.m3.1"><semantics id="S5.SS4.3.3.3.3.3.m3.1a"><mo id="S5.SS4.3.3.3.3.3.m3.1.1" mathsize="70%" stretchy="false" xref="S5.SS4.3.3.3.3.3.m3.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.SS4.3.3.3.3.3.m3.1b"><ci id="S5.SS4.3.3.3.3.3.m3.1.1.cmml" xref="S5.SS4.3.3.3.3.3.m3.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.3.3.3.3.3.m3.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.3.3.3.3.3.m3.1d">↓</annotation></semantics></math><span class="ltx_text" id="S5.SS4.5.5.5.5.5.4" style="font-size:70%;">  Quality </span><math alttext="\uparrow" class="ltx_Math" display="inline" id="S5.SS4.4.4.4.4.4.m4.1"><semantics id="S5.SS4.4.4.4.4.4.m4.1a"><mo id="S5.SS4.4.4.4.4.4.m4.1.1" mathsize="70%" stretchy="false" xref="S5.SS4.4.4.4.4.4.m4.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.SS4.4.4.4.4.4.m4.1b"><ci id="S5.SS4.4.4.4.4.4.m4.1.1.cmml" xref="S5.SS4.4.4.4.4.4.m4.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.4.4.4.4.4.m4.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.4.4.4.4.4.m4.1d">↑</annotation></semantics></math><span class="ltx_text" id="S5.SS4.5.5.5.5.5.5" style="font-size:70%;">  Neg </span><math alttext="\uparrow" class="ltx_Math" display="inline" id="S5.SS4.5.5.5.5.5.m5.1"><semantics id="S5.SS4.5.5.5.5.5.m5.1a"><mo id="S5.SS4.5.5.5.5.5.m5.1.1" mathsize="70%" stretchy="false" xref="S5.SS4.5.5.5.5.5.m5.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.SS4.5.5.5.5.5.m5.1b"><ci id="S5.SS4.5.5.5.5.5.m5.1.1.cmml" xref="S5.SS4.5.5.5.5.5.m5.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.5.5.5.5.5.m5.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.5.5.5.5.5.m5.1d">↑</annotation></semantics></math><span class="ltx_text" id="S5.SS4.5.5.5.5.5.6" style="font-size:70%;"></span></span>
<span class="ltx_p" id="S5.SS4.6.6.6.6.12"><span class="ltx_text" id="S5.SS4.6.6.6.6.12.1" style="font-size:70%;">Naive  2.38  21.2  89.3  6.88  4.19</span></span>
<span class="ltx_p" id="S5.SS4.6.6.6.6.13"><span class="ltx_text" id="S5.SS4.6.6.6.6.13.1" style="font-size:70%;">BadRAG  74.6  6.94  19.1  7.31  72.0</span></span>
<span class="ltx_p" id="S5.SS4.6.6.6.6.14"><span class="ltx_rule" style="width:100%;height:1.3pt;background:black;display:inline-block;"> </span><span class="ltx_text" id="S5.SS4.6.6.6.6.14.1" style="font-size:70%;"></span></span>
<span class="ltx_para ltx_noindent" id="S5.SS4.6.6.6.6.p1">
<span class="ltx_p" id="S5.SS4.6.6.6.6.p1.1"><span class="ltx_text ltx_font_bold" id="S5.SS4.6.6.6.6.p1.1.1" style="font-size:70%;">Study of AaaA and SFaaA.</span><span class="ltx_text" id="S5.SS4.6.6.6.6.p1.1.2" style="font-size:70%;"> The results in Table </span><a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#S5.SS4" style="font-size:70%;" title="5.4 Ablation Experiments ‣ 5.3 RQ3: Robust against Existing Defense ‣ 5.2 RQ2: Generative Attacks on LLMs ‣ 5.1 RQ1: Retrieval Attacks Only for Trigger Queries ‣ 5 Evaluation ‣ BadRAG: Identifying Vulnerabilities in Retrieval Augmented Generation of Large Language Models"><span class="ltx_text ltx_ref_tag">5.4</span></a><span class="ltx_text" id="S5.SS4.6.6.6.6.p1.1.3" style="font-size:70%;"> show that for DoS attacks, the naive method using "Please ignore all context" achieved only a 2.38% rejection ratio, as it is challenging to make the LLM follow this prompt. In contrast, our method, Alignment as an Attack (AaaA), using "All context includes private information," resulted in a significantly higher rejection ratio of 74.6%, leading to a substantial degradation in performance on Rouge-2 and Accuracy. This is because our approach leverages the LLM’s alignment mechanisms to draw attention to "private information," causing the LLM to refuse to respond due to its alignment policies.</span></span>
</span>
<span class="ltx_p" id="S5.SS4.6.6.6.6.15"><span class="ltx_text" id="S5.SS4.6.6.6.6.15.1" style="font-size:70%;">For the Sentiment Steer attack, we targeted GPT-4 using 40 keywords related to Trump as triggers and assessed the Top-10 retrieval results. The naive method using negatively crafted passages led to a degradation in response quality and a low probability of generating negative answers, at just 4.19%. This low effectiveness is due to the LLM’s ability to detect maliciously crafted offensive passages. In contrast, our method Selective-Fact as an Attack (SFaaA), which selectively uses biased but true articles from official sources, can bypass the LLM’s alignment because the selected passages are factual and likely included in the LLM’s pre-training dataset. Consequently, our method achieved a 72% probability of generating negative responses.</span></span>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section" style="font-size:70%;">
<span class="ltx_tag ltx_tag_section">6 </span>Potential Defense</h2>
<span class="ltx_para" id="S6.p1">
<span class="ltx_p" id="S6.p1.1"><span class="ltx_text" id="S6.p1.1.1" style="font-size:70%;">Our defense exploits the strong, unique link between trigger words and the adversarial passage: removing the trigger from the query prevents retrieval of the adversarial passage, while a clean query considers overall semantic similarity. We evaluate queries by systematically replacing tokens with </span><span class="ltx_text ltx_font_typewriter" id="S6.p1.1.2" style="font-size:70%;">[MASK]</span><span class="ltx_text" id="S6.p1.1.3" style="font-size:70%;"> and observing changes in retrieval similarity scores. For single-token triggers, replacing a single token effectively distinguishes between adversarial and clean queries; adversarial queries show larger gaps in similarity scores, as shown in Figure </span><a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#Ax1.F6" style="font-size:70%;" title="Figure 6 ‣ .3 Robustness against Existing Defense ‣ .2 Experiment Details ‣ Appendix ‣ 5.4 Ablation Experiments ‣ 5.3 RQ3: Robust against Existing Defense ‣ 5.2 RQ2: Generative Attacks on LLMs ‣ 5.1 RQ1: Retrieval Attacks Only for Trigger Queries ‣ 5 Evaluation ‣ BadRAG: Identifying Vulnerabilities in Retrieval Augmented Generation of Large Language Models"><span class="ltx_text ltx_ref_tag">6</span></a><span class="ltx_text" id="S6.p1.1.4" style="font-size:70%;"> (b) in the Appendix. However, this approach is less effective for two-token triggers, as single-token masking often fails to prevent retrieval of the adversarial passage, maintaining high similarity scores (Figure </span><a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#Ax1.F6" style="font-size:70%;" title="Figure 6 ‣ .3 Robustness against Existing Defense ‣ .2 Experiment Details ‣ Appendix ‣ 5.4 Ablation Experiments ‣ 5.3 RQ3: Robust against Existing Defense ‣ 5.2 RQ2: Generative Attacks on LLMs ‣ 5.1 RQ1: Retrieval Attacks Only for Trigger Queries ‣ 5 Evaluation ‣ BadRAG: Identifying Vulnerabilities in Retrieval Augmented Generation of Large Language Models"><span class="ltx_text ltx_ref_tag">6</span></a><span class="ltx_text" id="S6.p1.1.5" style="font-size:70%;"> (e)). To address this, two-token replacement for two-token triggers significantly improves the distinction by increasing the similarity score gaps for adversarial queries (Figure </span><a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#Ax1.F6" style="font-size:70%;" title="Figure 6 ‣ .3 Robustness against Existing Defense ‣ .2 Experiment Details ‣ Appendix ‣ 5.4 Ablation Experiments ‣ 5.3 RQ3: Robust against Existing Defense ‣ 5.2 RQ2: Generative Attacks on LLMs ‣ 5.1 RQ1: Retrieval Attacks Only for Trigger Queries ‣ 5 Evaluation ‣ BadRAG: Identifying Vulnerabilities in Retrieval Augmented Generation of Large Language Models"><span class="ltx_text ltx_ref_tag">6</span></a><span class="ltx_text" id="S6.p1.1.6" style="font-size:70%;"> (f)). Despite its effectiveness, this method’s limitation lies in not knowing the trigger’s exact token length, which can lead to significant overlap in similarity scores for clean queries when using longer token replacements, complicating the distinction between clean and adversarial queries (Figure </span><a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#Ax1.F6" style="font-size:70%;" title="Figure 6 ‣ .3 Robustness against Existing Defense ‣ .2 Experiment Details ‣ Appendix ‣ 5.4 Ablation Experiments ‣ 5.3 RQ3: Robust against Existing Defense ‣ 5.2 RQ2: Generative Attacks on LLMs ‣ 5.1 RQ1: Retrieval Attacks Only for Trigger Queries ‣ 5 Evaluation ‣ BadRAG: Identifying Vulnerabilities in Retrieval Augmented Generation of Large Language Models"><span class="ltx_text ltx_ref_tag">6</span></a><span class="ltx_text" id="S6.p1.1.7" style="font-size:70%;"> (c)). More details are in the Appendix </span><a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#Ax1.SS3" style="font-size:70%;" title=".3 Robustness against Existing Defense ‣ .2 Experiment Details ‣ Appendix ‣ 5.4 Ablation Experiments ‣ 5.3 RQ3: Robust against Existing Defense ‣ 5.2 RQ2: Generative Attacks on LLMs ‣ 5.1 RQ1: Retrieval Attacks Only for Trigger Queries ‣ 5 Evaluation ‣ BadRAG: Identifying Vulnerabilities in Retrieval Augmented Generation of Large Language Models"><span class="ltx_text ltx_ref_tag">.3</span></a><span class="ltx_text" id="S6.p1.1.8" style="font-size:70%;">.</span></span>
</span>
</section>
<section class="ltx_section" id="S7">
<h2 class="ltx_title ltx_title_section" style="font-size:70%;">
<span class="ltx_tag ltx_tag_section">7 </span>Discussion</h2>
<span class="ltx_para ltx_noindent" id="S7.p1">
<span class="ltx_p" id="S7.p1.1"><span class="ltx_text ltx_font_bold" id="S7.p1.1.1" style="font-size:70%;">Broader Impact.</span><span class="ltx_text" id="S7.p1.1.2" style="font-size:70%;">
Our findings highlight significant security vulnerabilities in deploying RAG for LLMs across critical sectors such as healthcare, finance, and other high-stakes areas. These insights can alert system administrators, developers, and policymakers to the potential risks, underscoring the necessity of developing robust countermeasures against adversarial attacks. Understanding the capabilities of BadRAG could spur the development of advanced defense mechanisms, enhancing the safety and robustness of AI technologies. Additionally, a potential defense method is discussed in Section </span><a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#S6" style="font-size:70%;" title="6 Potential Defense ‣ 5.4 Ablation Experiments ‣ 5.3 RQ3: Robust against Existing Defense ‣ 5.2 RQ2: Generative Attacks on LLMs ‣ 5.1 RQ1: Retrieval Attacks Only for Trigger Queries ‣ 5 Evaluation ‣ BadRAG: Identifying Vulnerabilities in Retrieval Augmented Generation of Large Language Models"><span class="ltx_text ltx_ref_tag">6</span></a><span class="ltx_text" id="S7.p1.1.3" style="font-size:70%;"> to further research into secure RAG deployment.</span></span>
</span>
<span class="ltx_para ltx_noindent" id="S7.p2">
<span class="ltx_p" id="S7.p2.1"><span class="ltx_text ltx_font_bold" id="S7.p2.1.1" style="font-size:70%;">Limitation.</span><span class="ltx_text" id="S7.p2.1.2" style="font-size:70%;">
</span><span class="ltx_text ltx_font_italic" id="S7.p2.1.3" style="font-size:70%;">(i) Reveal more vulnerability caused by alignment.</span><span class="ltx_text" id="S7.p2.1.4" style="font-size:70%;"> Our BadRAGintroduces a paradigm that leverages the alignment of LLMs to execute denial-of-service and sentiment steering attacks. However, this paradigm could be expanded to encompass a broader range of attacks by identifying additional alignment features within LLMs. </span><span class="ltx_text ltx_font_italic" id="S7.p2.1.5" style="font-size:70%;">(ii) Broader Task Applications.</span><span class="ltx_text" id="S7.p2.1.6" style="font-size:70%;"> Our research presently applies BadRAG attacks to QA and summerization tasks. Expanding this scope to other NLP tasks, such as code generation and agent planning, would provide an intriguing extension of our work.</span></span>
</span>
</section>
<section class="ltx_section" id="S8">
<h2 class="ltx_title ltx_title_section" style="font-size:70%;">
<span class="ltx_tag ltx_tag_section">8 </span>Conclusion</h2>
<span class="ltx_para" id="S8.p1">
<span class="ltx_p" id="S8.p1.1"><span class="ltx_text" id="S8.p1.1.1" style="font-size:70%;">This paper introduces BadRAG, a novel framework targeting security vulnerabilities in RAG’s retrieval and generative phases. Utilizing contrastive optimization, BadRAG generates adversarial passages activated only by specific triggers. We also explore leveraging LLM alignment to conduct denial-of-service and sentiment steering attacks. Tested on datasets and models including GPT-4 and Claude-3, BadRAG demonstrates precise targeting and effective manipulation of LLM outputs, highlighting the need for robust defensive strategies in AI deployments.</span></span>
</span>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography" style="font-size:70%;">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib1.2.2.1" style="font-size:70%;">[1]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib1.4.1" style="font-size:70%;">
Gpt-4 turbo knowledge cutoff.
</span>
</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://platform.openai.com/docs/models/gpt-4-turbo-and-gpt-4" style="font-size:70%;" title="">https://platform.openai.com/docs/models/gpt-4-turbo-and-gpt-4</a><span class="ltx_text" id="bib.bib1.5.1" style="font-size:70%;">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib2.2.2.1" style="font-size:70%;">[2]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib2.4.1" style="font-size:70%;">
Junyi Li, Xiaoxue Cheng, Wayne Xin Zhao, Jian-Yun Nie, and Ji-Rong Wen.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib2.5.1" style="font-size:70%;">Halueval: A large-scale hallucination evaluation benchmark for large language models.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib2.6.1" style="font-size:70%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib2.7.2" style="font-size:70%;">Proceedings of the 2023 Conference on Empirical Methods in Natural Language Processing</span><span class="ltx_text" id="bib.bib2.8.3" style="font-size:70%;">, pages 6449–6464, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib3.2.2.1" style="font-size:70%;">[3]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib3.4.1" style="font-size:70%;">
Ziwei Ji, Nayeon Lee, Rita Frieske, Tiezheng Yu, Dan Su, Yan Xu, Etsuko Ishii, Ye Jin Bang, Andrea Madotto, and Pascale Fung.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib3.5.1" style="font-size:70%;">Survey of hallucination in natural language generation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib3.6.1" style="font-size:70%;">ACM Computing Surveys</span><span class="ltx_text" id="bib.bib3.7.2" style="font-size:70%;">, 55(12):1–38, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib4.2.2.1" style="font-size:70%;">[4]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib4.4.1" style="font-size:70%;">
Calvin Wang, Joshua Ong, Chara Wang, Hannah Ong, Rebekah Cheng, and Dennis Ong.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib4.5.1" style="font-size:70%;">Potential for gpt technology to optimize future clinical decision-making using retrieval-augmented generation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib4.6.1" style="font-size:70%;">Annals of Biomedical Engineering</span><span class="ltx_text" id="bib.bib4.7.2" style="font-size:70%;">, pages 1–4, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib5.2.2.1" style="font-size:70%;">[5]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib5.4.1" style="font-size:70%;">
Lefteris Loukas, Ilias Stogiannidis, Odysseas Diamantopoulos, Prodromos Malakasiotis, and Stavros Vassos.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib5.5.1" style="font-size:70%;">Making llms worth every penny: Resource-limited text classification in banking.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib5.6.1" style="font-size:70%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib5.7.2" style="font-size:70%;">Proceedings of the Fourth ACM International Conference on AI in Finance</span><span class="ltx_text" id="bib.bib5.8.3" style="font-size:70%;">, pages 392–400, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib6.2.2.1" style="font-size:70%;">[6]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib6.4.1" style="font-size:70%;">
Aditya Kuppa, Nikon Rasumov-Rahe, and Marc Voses.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib6.5.1" style="font-size:70%;">Chain of reference prompting helps llm to think like a lawyer.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib6.6.1" style="font-size:70%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib6.7.2" style="font-size:70%;">Generative AI+ Law Workshop</span><span class="ltx_text" id="bib.bib6.8.3" style="font-size:70%;">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib7.2.2.1" style="font-size:70%;">[7]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib7.4.1" style="font-size:70%;">
Nandan Thakur, Nils Reimers, Andreas Rücklé, Abhishek Srivastava, and Iryna Gurevych.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib7.5.1" style="font-size:70%;">Beir: A heterogenous benchmark for zero-shot evaluation of information retrieval models.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib7.6.1" style="font-size:70%;">arXiv preprint arXiv:2104.08663</span><span class="ltx_text" id="bib.bib7.7.2" style="font-size:70%;">, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib8.2.2.1" style="font-size:70%;">[8]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib8.4.1" style="font-size:70%;">
Gpt-4 turbo knowledge cutoff.
</span>
</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://newsdata.io/datasets" style="font-size:70%;" title="">https://newsdata.io/datasets</a><span class="ltx_text" id="bib.bib8.5.1" style="font-size:70%;">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib9.2.2.1" style="font-size:70%;">[9]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib9.4.1" style="font-size:70%;">
Ellen Voorhees, Tasmeer Alam, Steven Bedrick, Dina Demner-Fushman, William R Hersh, Kyle Lo, Kirk Roberts, Ian Soboroff, and Lucy Lu Wang.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib9.5.1" style="font-size:70%;">Trec-covid: constructing a pandemic information retrieval test collection.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib9.6.1" style="font-size:70%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib9.7.2" style="font-size:70%;">ACM SIGIR Forum</span><span class="ltx_text" id="bib.bib9.8.3" style="font-size:70%;">, volume 54, pages 1–12. ACM New York, NY, USA, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib10.2.2.1" style="font-size:70%;">[10]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib10.4.1" style="font-size:70%;">
Sina Semnani, Violet Yao, Heidi Zhang, and Monica Lam.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib10.5.1" style="font-size:70%;">Wikichat: Stopping the hallucination of large language model chatbots by few-shot grounding on wikipedia.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib10.6.1" style="font-size:70%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib10.7.2" style="font-size:70%;">Findings of the Association for Computational Linguistics: EMNLP 2023</span><span class="ltx_text" id="bib.bib10.8.3" style="font-size:70%;">, pages 2387–2413, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib11.2.2.1" style="font-size:70%;">[11]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib11.4.1" style="font-size:70%;">
YouTube.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib11.5.1" style="font-size:70%;">Bluebot–jetblue’s unified llm.
</span>
</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.youtube.com/watch?v=h4z4vBoxQ6s" style="font-size:70%;" title="">https://www.youtube.com/watch?v=h4z4vBoxQ6s</a><span class="ltx_text" id="bib.bib11.6.1" style="font-size:70%;">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib12.2.2.1" style="font-size:70%;">[12]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib12.4.1" style="font-size:70%;">
Nivida chatrtx: Chat with rtx.
</span>
</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.nvidia.com/en-us/ai-on-rtx/chatrtx/" style="font-size:70%;" title="">https://www.nvidia.com/en-us/ai-on-rtx/chatrtx/</a><span class="ltx_text" id="bib.bib12.5.1" style="font-size:70%;">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib13.2.2.1" style="font-size:70%;">[13]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib13.4.1" style="font-size:70%;">
Zexuan Zhong, Ziqing Huang, Alexander Wettig, and Danqi Chen.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib13.5.1" style="font-size:70%;">Poisoning retrieval corpora by injecting adversarial passages.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib13.6.1" style="font-size:70%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib13.7.2" style="font-size:70%;">Proceedings of the 2023 Conference on Empirical Methods in Natural Language Processing</span><span class="ltx_text" id="bib.bib13.8.3" style="font-size:70%;">, pages 13764–13775, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib14.2.2.1" style="font-size:70%;">[14]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib14.4.1" style="font-size:70%;">
Wei Zou, Runpeng Geng, Binghui Wang, and Jinyuan Jia.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib14.5.1" style="font-size:70%;">Poisonedrag: Knowledge poisoning attacks to retrieval-augmented generation of large language models.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib14.6.1" style="font-size:70%;">arXiv preprint arXiv:2402.07867</span><span class="ltx_text" id="bib.bib14.7.2" style="font-size:70%;">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib15.2.2.1" style="font-size:70%;">[15]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib15.4.1" style="font-size:70%;">
Sukmin Cho, Soyeong Jeong, Jeongyeon Seo, Taeho Hwang, and Jong C Park.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib15.5.1" style="font-size:70%;">Typos that broke the rag’s back: Genetic attack on rag pipeline by simulating documents in the wild via low-level perturbations.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib15.6.1" style="font-size:70%;">arXiv preprint arXiv:2404.13948</span><span class="ltx_text" id="bib.bib15.7.2" style="font-size:70%;">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib16.2.2.1" style="font-size:70%;">[16]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib16.4.1" style="font-size:70%;">
Patrick Lewis, Ethan Perez, Aleksandra Piktus, Fabio Petroni, Vladimir Karpukhin, Naman Goyal, Heinrich Küttler, Mike Lewis, Wen-tau Yih, Tim Rocktäschel, et al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib16.5.1" style="font-size:70%;">Retrieval-augmented generation for knowledge-intensive nlp tasks.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib16.6.1" style="font-size:70%;">Advances in Neural Information Processing Systems</span><span class="ltx_text" id="bib.bib16.7.2" style="font-size:70%;">, 33:9459–9474, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib17.2.2.1" style="font-size:70%;">[17]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib17.4.1" style="font-size:70%;">
Boyu Zhang, Hongyang Yang, Tianyu Zhou, Muhammad Ali Babar, and Xiao-Yang Liu.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib17.5.1" style="font-size:70%;">Enhancing financial sentiment analysis via retrieval augmented large language models.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib17.6.1" style="font-size:70%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib17.7.2" style="font-size:70%;">Proceedings of the Fourth ACM International Conference on AI in Finance</span><span class="ltx_text" id="bib.bib17.8.3" style="font-size:70%;">, pages 349–356, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib18.2.2.1" style="font-size:70%;">[18]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib18.4.1" style="font-size:70%;">
Shamane Siriwardhana, Rivindu Weerasekera, Elliott Wen, Tharindu Kaluarachchi, Rajib Rana, and Suranga Nanayakkara.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib18.5.1" style="font-size:70%;">Improving the domain adaptation of retrieval augmented generation (rag) models for open domain question answering.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib18.6.1" style="font-size:70%;">Transactions of the Association for Computational Linguistics</span><span class="ltx_text" id="bib.bib18.7.2" style="font-size:70%;">, 11:1–17, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib19.2.2.1" style="font-size:70%;">[19]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib19.4.1" style="font-size:70%;">
Md Rizwan Parvez, Wasi Uddin Ahmad, Saikat Chakraborty, Baishakhi Ray, and Kai-Wei Chang.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib19.5.1" style="font-size:70%;">Retrieval augmented code generation and summarization.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib19.6.1" style="font-size:70%;">arXiv preprint arXiv:2108.11601</span><span class="ltx_text" id="bib.bib19.7.2" style="font-size:70%;">, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib20.2.2.1" style="font-size:70%;">[20]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib20.4.1" style="font-size:70%;">
Jiaqi Xue, Mengxin Zheng, Ting Hua, Yilin Shen, Yepeng Liu, Ladislau Bölöni, and Qian Lou.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib20.5.1" style="font-size:70%;">Trojllm: A black-box trojan prompt attack on large language models.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib20.6.1" style="font-size:70%;">Advances in Neural Information Processing Systems</span><span class="ltx_text" id="bib.bib20.7.2" style="font-size:70%;">, 36, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib21.2.2.1" style="font-size:70%;">[21]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib21.4.1" style="font-size:70%;">
Dong Lu, Tianyu Pang, Chao Du, Qian Liu, Xianjun Yang, and Min Lin.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib21.5.1" style="font-size:70%;">Test-time backdoor attacks on multimodal large language models.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib21.6.1" style="font-size:70%;">arXiv preprint arXiv:2402.08577</span><span class="ltx_text" id="bib.bib21.7.2" style="font-size:70%;">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib22.2.2.1" style="font-size:70%;">[22]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib22.4.1" style="font-size:70%;">
Mansour Al Ghanim, Muhammad Santriaji, Qian Lou, and Yan Solihin.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib22.5.1" style="font-size:70%;">Trojbits: A hardware aware inference-time attack on transformer-based language models.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib22.6.1" style="font-size:70%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib22.7.2" style="font-size:70%;">ECAI 2023</span><span class="ltx_text" id="bib.bib22.8.3" style="font-size:70%;">, pages 60–68. IOS Press, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib23.2.2.1" style="font-size:70%;">[23]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib23.4.1" style="font-size:70%;">
Qian Lou, Yepeng Liu, and Bo Feng.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib23.5.1" style="font-size:70%;">Trojtext: Test-time invisible textual trojan insertion.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib23.6.1" style="font-size:70%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib23.7.2" style="font-size:70%;">The Eleventh International Conference on Learning Representations</span><span class="ltx_text" id="bib.bib23.8.3" style="font-size:70%;">, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib24.2.2.1" style="font-size:70%;">[24]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib24.4.1" style="font-size:70%;">
Alexander Wei, Nika Haghtalab, and Jacob Steinhardt.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib24.5.1" style="font-size:70%;">Jailbroken: How does llm safety training fail?
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib24.6.1" style="font-size:70%;">Advances in Neural Information Processing Systems</span><span class="ltx_text" id="bib.bib24.7.2" style="font-size:70%;">, 36, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib25.2.2.1" style="font-size:70%;">[25]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib25.4.1" style="font-size:70%;">
Andy Zou, Zifan Wang, J Zico Kolter, and Matt Fredrikson.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib25.5.1" style="font-size:70%;">Universal and transferable adversarial attacks on aligned language models.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib25.6.1" style="font-size:70%;">arXiv preprint arXiv:2307.15043</span><span class="ltx_text" id="bib.bib25.7.2" style="font-size:70%;">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib26.2.2.1" style="font-size:70%;">[26]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib26.4.1" style="font-size:70%;">
Mengxin Zheng, Jiaqi Xue, Xun Chen, YanShan Wang, Qian Lou, and Lei Jiang.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib26.5.1" style="font-size:70%;">Trojfsp: Trojan insertion in few-shot prompt tuning.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib26.6.1" style="font-size:70%;">arXiv preprint arXiv:2312.10467</span><span class="ltx_text" id="bib.bib26.7.2" style="font-size:70%;">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib27.2.2.1" style="font-size:70%;">[27]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib27.4.1" style="font-size:70%;">
Kai Greshake, Sahar Abdelnabi, Shailesh Mishra, Christoph Endres, Thorsten Holz, and Mario Fritz.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib27.5.1" style="font-size:70%;">Not what you’ve signed up for: Compromising real-world llm-integrated applications with indirect prompt injection.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib27.6.1" style="font-size:70%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib27.7.2" style="font-size:70%;">Proceedings of the 16th ACM Workshop on Artificial Intelligence and Security</span><span class="ltx_text" id="bib.bib27.8.3" style="font-size:70%;">, pages 79–90, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib28.2.2.1" style="font-size:70%;">[28]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib28.4.1" style="font-size:70%;">
Yi Liu, Gelei Deng, Yuekang Li, Kailong Wang, Tianwei Zhang, Yepang Liu, Haoyu Wang, Yan Zheng, and Yang Liu.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib28.5.1" style="font-size:70%;">Prompt injection attack against llm-integrated applications.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib28.6.1" style="font-size:70%;">arXiv preprint arXiv:2306.05499</span><span class="ltx_text" id="bib.bib28.7.2" style="font-size:70%;">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib29.2.2.1" style="font-size:70%;">[29]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib29.4.1" style="font-size:70%;">
Jun Yan, Vikas Yadav, Shiyang Li, Lichang Chen, Zheng Tang, Hai Wang, Vijay Srinivasan, Xiang Ren, and Hongxia Jin.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib29.5.1" style="font-size:70%;">Backdooring instruction-tuned large language models with virtual prompt injection.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib29.6.1" style="font-size:70%;">arXiv preprint arXiv:2307.16888</span><span class="ltx_text" id="bib.bib29.7.2" style="font-size:70%;">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib30.2.2.1" style="font-size:70%;">[30]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib30.4.1" style="font-size:70%;">
Quanyu Long, Yue Deng, LeiLei Gan, Wenya Wang, and Sinno Jialin Pan.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib30.5.1" style="font-size:70%;">Backdoor attacks on dense passage retrievers for disseminating misinformation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib30.6.1" style="font-size:70%;">arXiv preprint arXiv:2402.13532</span><span class="ltx_text" id="bib.bib30.7.2" style="font-size:70%;">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib31.2.2.1" style="font-size:70%;">[31]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib31.4.1" style="font-size:70%;">
Llama-cpp text embeddings.
</span>
</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://python.langchain.com/v0.1/docs/integrations/text_embedding/llamacpp/" style="font-size:70%;" title="">https://python.langchain.com/v0.1/docs/integrations/text_embedding/llamacpp/</a><span class="ltx_text" id="bib.bib31.5.1" style="font-size:70%;">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib32.2.2.1" style="font-size:70%;">[32]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib32.4.1" style="font-size:70%;">
Isabelle Mohr, Markus Krimmel, Saba Sturua, Mohammad Kalim Akram, Andreas Koukounas, Michael Günther, Georgios Mastrapas, Vinit Ravishankar, Joan Fontanals Martínez, Feng Wang, et al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib32.5.1" style="font-size:70%;">Multi-task contrastive learning for 8192-token bilingual text embeddings.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib32.6.1" style="font-size:70%;">arXiv preprint arXiv:2402.17016</span><span class="ltx_text" id="bib.bib32.7.2" style="font-size:70%;">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib33.2.2.1" style="font-size:70%;">[33]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib33.4.1" style="font-size:70%;">
Gautier Izacard, Mathilde Caron, Lucas Hosseini, Sebastian Riedel, Piotr Bojanowski, Armand Joulin, and Edouard Grave.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib33.5.1" style="font-size:70%;">Unsupervised dense information retrieval with contrastive learning.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib33.6.1" style="font-size:70%;">arXiv preprint arXiv:2112.09118</span><span class="ltx_text" id="bib.bib33.7.2" style="font-size:70%;">, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib34.2.2.1" style="font-size:70%;">[34]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib34.4.1" style="font-size:70%;">
Huggingface: jinaai/jina-embeddings-v2-base-de.
</span>
</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://huggingface.co/jinaai/jina-embeddings-v2-base-de" style="font-size:70%;" title="">https://huggingface.co/jinaai/jina-embeddings-v2-base-de</a><span class="ltx_text" id="bib.bib34.5.1" style="font-size:70%;">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib35.2.2.1" style="font-size:70%;">[35]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib35.4.1" style="font-size:70%;">
Huggingface: facebook/contriever.
</span>
</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://huggingface.co/facebook/contriever" style="font-size:70%;" title="">https://huggingface.co/facebook/contriever</a><span class="ltx_text" id="bib.bib35.5.1" style="font-size:70%;">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib36.2.2.1" style="font-size:70%;">[36]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib36.4.1" style="font-size:70%;">
Llamaindex.
</span>
</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.llamaindex.ai/" style="font-size:70%;" title="">https://www.llamaindex.ai/</a><span class="ltx_text" id="bib.bib36.5.1" style="font-size:70%;">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib37.2.2.1" style="font-size:70%;">[37]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib37.4.1" style="font-size:70%;">
Langchain.
</span>
</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.langchain.com/" style="font-size:70%;" title="">https://www.langchain.com/</a><span class="ltx_text" id="bib.bib37.5.1" style="font-size:70%;">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib38.2.2.1" style="font-size:70%;">[38]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib38.4.1" style="font-size:70%;">
Wikipedia.
</span>
</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.wikipedia.org/" style="font-size:70%;" title="">https://www.wikipedia.org/</a><span class="ltx_text" id="bib.bib38.5.1" style="font-size:70%;">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib39.2.2.1" style="font-size:70%;">[39]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib39.4.1" style="font-size:70%;">
Reddit.
</span>
</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.reddit.com/" style="font-size:70%;" title="">https://www.reddit.com/</a><span class="ltx_text" id="bib.bib39.5.1" style="font-size:70%;">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib40.2.2.1" style="font-size:70%;">[40]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib40.4.1" style="font-size:70%;">
Wikidataset: Huggingface.
</span>
</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://huggingface.co/datasets/wikitext" style="font-size:70%;" title="">https://huggingface.co/datasets/wikitext</a><span class="ltx_text" id="bib.bib40.5.1" style="font-size:70%;">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib41.2.2.1" style="font-size:70%;">[41]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib41.4.1" style="font-size:70%;">
Common crawl.
</span>
</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.commoncrawl.org/" style="font-size:70%;" title="">https://www.commoncrawl.org/</a><span class="ltx_text" id="bib.bib41.5.1" style="font-size:70%;">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib42.2.2.1" style="font-size:70%;">[42]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib42.4.1" style="font-size:70%;">
James MacQueen et al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib42.5.1" style="font-size:70%;">Some methods for classification and analysis of multivariate observations.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib42.6.1" style="font-size:70%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib42.7.2" style="font-size:70%;">Proceedings of the fifth Berkeley symposium on mathematical statistics and probability</span><span class="ltx_text" id="bib.bib42.8.3" style="font-size:70%;">, volume 1, pages 281–297. Oakland, CA, USA, 1967.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib43.2.2.1" style="font-size:70%;">[43]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib43.4.1" style="font-size:70%;">
Nelson F Liu, Kevin Lin, John Hewitt, Ashwin Paranjape, Michele Bevilacqua, Fabio Petroni, and Percy Liang.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib43.5.1" style="font-size:70%;">Lost in the middle: How language models use long contexts.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib43.6.1" style="font-size:70%;">Transactions of the Association for Computational Linguistics</span><span class="ltx_text" id="bib.bib43.7.2" style="font-size:70%;">, 12:157–173, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib44.2.2.1" style="font-size:70%;">[44]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib44.4.1" style="font-size:70%;">
Keegan Hines, Gary Lopez, Matthew Hall, Federico Zarfati, Yonatan Zunger, and Emre Kiciman.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib44.5.1" style="font-size:70%;">Defending against indirect prompt injection attacks with spotlighting.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib44.6.1" style="font-size:70%;">arXiv preprint arXiv:2403.14720</span><span class="ltx_text" id="bib.bib44.7.2" style="font-size:70%;">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib45.2.2.1" style="font-size:70%;">[45]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib45.4.1" style="font-size:70%;">
Tom Kwiatkowski, Jennimaria Palomaki, Olivia Redfield, Michael Collins, Ankur Parikh, Chris Alberti, Danielle Epstein, Illia Polosukhin, Jacob Devlin, Kenton Lee, et al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib45.5.1" style="font-size:70%;">Natural questions: a benchmark for question answering research.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib45.6.1" style="font-size:70%;">Transactions of the Association for Computational Linguistics</span><span class="ltx_text" id="bib.bib45.7.2" style="font-size:70%;">, 7:453–466, 2019.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib46.2.2.1" style="font-size:70%;">[46]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib46.4.1" style="font-size:70%;">
Payal Bajaj, Daniel Campos, Nick Craswell, Li Deng, Jianfeng Gao, Xiaodong Liu, Rangan Majumder, Andrew McNamara, Bhaskar Mitra, Tri Nguyen, et al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib46.5.1" style="font-size:70%;">Ms marco: A human generated machine reading comprehension dataset.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib46.6.1" style="font-size:70%;">arXiv preprint arXiv:1611.09268</span><span class="ltx_text" id="bib.bib46.7.2" style="font-size:70%;">, 2016.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib47.2.2.1" style="font-size:70%;">[47]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib47.4.1" style="font-size:70%;">
Pranav Rajpurkar, Jian Zhang, Konstantin Lopyrev, and Percy Liang.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib47.5.1" style="font-size:70%;">Squad: 100,000+ questions for machine comprehension of text.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib47.6.1" style="font-size:70%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib47.7.2" style="font-size:70%;">Proceedings of the 2016 Conference on Empirical Methods in Natural Language Processing</span><span class="ltx_text" id="bib.bib47.8.3" style="font-size:70%;">, pages 2383–2392, 2016.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib48.2.2.1" style="font-size:70%;">[48]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib48.4.1" style="font-size:70%;">
Hiroaki Hayashi, Prashant Budania, Peng Wang, Chris Ackerson, Raj Neervannan, and Graham Neubig.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib48.5.1" style="font-size:70%;">Wikiasp: A dataset for multi-domain aspect-based summarization.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib48.6.1" style="font-size:70%;">Transactions of the Association for Computational Linguistics</span><span class="ltx_text" id="bib.bib48.7.2" style="font-size:70%;">, 9:211–225, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib49.2.2.1" style="font-size:70%;">[49]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib49.4.1" style="font-size:70%;">
Vladimir Karpukhin, Barlas Oguz, Sewon Min, Patrick Lewis, Ledell Wu, Sergey Edunov, Danqi Chen, and Wen-tau Yih.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib49.5.1" style="font-size:70%;">Dense passage retrieval for open-domain question answering.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib49.6.1" style="font-size:70%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib49.7.2" style="font-size:70%;">Proceedings of the 2020 Conference on Empirical Methods in Natural Language Processing (EMNLP)</span><span class="ltx_text" id="bib.bib49.8.3" style="font-size:70%;">, pages 6769–6781, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib50.2.2.1" style="font-size:70%;">[50]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib50.4.1" style="font-size:70%;">
Lee Xiong, Chenyan Xiong, Ye Li, Kwok-Fung Tang, Jialin Liu, Paul N Bennett, Junaid Ahmed, and Arnold Overwijk.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib50.5.1" style="font-size:70%;">Approximate nearest neighbor negative contrastive learning for dense text retrieval.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib50.6.1" style="font-size:70%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib50.7.2" style="font-size:70%;">International Conference on Learning Representations</span><span class="ltx_text" id="bib.bib50.8.3" style="font-size:70%;">, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib51.2.2.1" style="font-size:70%;">[51]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib51.4.1" style="font-size:70%;">
Josh Achiam, Steven Adler, Sandhini Agarwal, Lama Ahmad, Ilge Akkaya, Florencia Leoni Aleman, Diogo Almeida, Janko Altenschmidt, Sam Altman, Shyamal Anadkat, et al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib51.5.1" style="font-size:70%;">Gpt-4 technical report.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib51.6.1" style="font-size:70%;">arXiv preprint arXiv:2303.08774</span><span class="ltx_text" id="bib.bib51.7.2" style="font-size:70%;">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib52.2.2.1" style="font-size:70%;">[52]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib52.4.1" style="font-size:70%;">
Anthropic.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib52.5.1" style="font-size:70%;">Chat with claude.
</span>
</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://claude.ai/chats" style="font-size:70%;" title="">https://claude.ai/chats</a><span class="ltx_text" id="bib.bib52.6.1" style="font-size:70%;">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib53.2.2.1" style="font-size:70%;">[53]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib53.4.1" style="font-size:70%;">
Hugo Touvron, Louis Martin, Kevin Stone, Peter Albert, Amjad Almahairi, Yasmine Babaei, Nikolay Bashlykov, Soumya Batra, Prajjwal Bhargava, Shruti Bhosale, et al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib53.5.1" style="font-size:70%;">Llama 2: Open foundation and fine-tuned chat models.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib53.6.1" style="font-size:70%;">arXiv preprint arXiv:2307.09288</span><span class="ltx_text" id="bib.bib53.7.2" style="font-size:70%;">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib54">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib54.2.2.1" style="font-size:70%;">[54]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib54.4.1" style="font-size:70%;">
Rohan Taori, Ishaan Gulrajani, Tianyi Zhang, Yann Dubois, Xuechen Li, Carlos Guestrin, Percy Liang, and Tatsunori B. Hashimoto.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib54.5.1" style="font-size:70%;">Stanford alpaca: An instruction-following llama model.
</span>
</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/tatsu-lab/stanford_alpaca" style="font-size:70%;" title="">https://github.com/tatsu-lab/stanford_alpaca</a><span class="ltx_text" id="bib.bib54.6.1" style="font-size:70%;">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib55">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib55.2.2.1" style="font-size:70%;">[55]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib55.4.1" style="font-size:70%;">
Frederick Jelinek.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib55.5.1" style="font-size:70%;">Interpolated estimation of markov source parameters from sparse data.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib55.6.1" style="font-size:70%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bib55.7.2" style="font-size:70%;">Proc. Workshop on Pattern Recognition in Practice, 1980</span><span class="ltx_text" id="bib.bib55.8.3" style="font-size:70%;">, 1980.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib56">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib56.2.2.1" style="font-size:70%;">[56]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib56.4.1" style="font-size:70%;">
Alec Radford, Jeffrey Wu, Rewon Child, David Luan, Dario Amodei, Ilya Sutskever, et al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib56.5.1" style="font-size:70%;">Language models are unsupervised multitask learners.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib56.6.1" style="font-size:70%;">OpenAI blog</span><span class="ltx_text" id="bib.bib56.7.2" style="font-size:70%;">, 1(8):9, 2019.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib57">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib57.2.2.1" style="font-size:70%;">[57]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib57.4.1" style="font-size:70%;">
Mike Conover, Matt Hayes, Ankit Mathur, Jianwei Xie, Jun Wan, Sam Shah, Ali Ghodsi, Patrick Wendell, Matei Zaharia, and Reynold Xin.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib57.5.1" style="font-size:70%;">Free dolly: Introducing the world’s first truly open instruction-tuned llm.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib57.6.1" style="font-size:70%;">Company Blog of Databricks</span><span class="ltx_text" id="bib.bib57.7.2" style="font-size:70%;">, 2023.
</span>
</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="Ax1">
<h2 class="ltx_title ltx_title_appendix" style="font-size:70%;">Appendix</h2>
<section class="ltx_subsection" id="Ax1.SS1">
<h3 class="ltx_title ltx_title_subsection" style="font-size:70%;">
<span class="ltx_tag ltx_tag_subsection">.1 </span>Prompts Used in Experiments</h3>
<span class="ltx_para ltx_noindent" id="Ax1.SS1.p1">
<span class="ltx_p" id="Ax1.SS1.p1.1"><span class="ltx_text ltx_font_bold" id="Ax1.SS1.p1.1.1" style="font-size:70%;">Prompt for Generating Queries for
Open-Ended Discussion</span><span class="ltx_text" id="Ax1.SS1.p1.1.2" style="font-size:70%;"></span></span>
</span>
<span class="ltx_para" id="Ax1.SS1.p2">
<span class="ltx_p" id="Ax1.SS1.p2.1"><span class="ltx_text ltx_font_typewriter" id="Ax1.SS1.p2.1.1" style="font-size:90%;">You are asked to come up with a set of diverse task queries. These task queries will be given to a GPT model and we will evaluate the GPT model for responding the queries.
<br class="ltx_break"/>Here are the requirements:
<br class="ltx_break"/>1. Try not to repeat the verb for each instruction to maximize diversity.
<br class="ltx_break"/>2. The language used for the query also should be diverse. For example, you should combine questions with imperative instructions.
<br class="ltx_break"/>3. The type of queries should be open-ended generation, rather than classification, editing, etc.
<br class="ltx_break"/>4. A GPT language model should be able to complete the query. For example, do not ask the assistant to create any visual or audio output. For another example, do not ask the assistant to wake you up at 5pm or set a reminder because it cannot perform any action.
<br class="ltx_break"/>5. The queries should be in English.
<br class="ltx_break"/>6. A query should contain enough context for it to be responded.
<br class="ltx_break"/>7. A query should ideally not exceed 100 words.
<br class="ltx_break"/>8. The response should be an appropriate response to the query. Make sure the response is less than 100 words.
<br class="ltx_break"/>Here are some examples:
<br class="ltx_break"/>###
<br class="ltx_break"/>1. Query:
<br class="ltx_break"/>{seed_query_1}
<br class="ltx_break"/>1. Response:
<br class="ltx_break"/>{seed_response_1}
<br class="ltx_break"/>###
<br class="ltx_break"/>2. Query:
<br class="ltx_break"/>{seed_query_2}
<br class="ltx_break"/>2. Response:
<br class="ltx_break"/>{seed_response_2}
<br class="ltx_break"/>###
<br class="ltx_break"/>3. Query:
<br class="ltx_break"/>{seed_query_3}
<br class="ltx_break"/>3. Response:
<br class="ltx_break"/>{seed_response_3}
<br class="ltx_break"/>You are asked to generate 20 more task queries and all instructions should be about "{topic}". The format should be exactly the same as the examples, with "###" before each query.
<br class="ltx_break"/>List of 20 queries about "{topic}":
<br class="ltx_break"/>###
<br class="ltx_break"/>1. Query:
<br class="ltx_break"/></span><span class="ltx_text" id="Ax1.SS1.p2.1.2" style="font-size:70%;"></span></span>
</span>
<span class="ltx_para" id="Ax1.SS1.p3">
<span class="ltx_p" id="Ax1.SS1.p3.1"><span class="ltx_text" id="Ax1.SS1.p3.1.1" style="font-size:70%;">The above prompt is adapted from Alpaca </span><cite class="ltx_cite ltx_citemacro_citep"><span class="ltx_text" id="Ax1.SS1.p3.1.2.1" style="font-size:70%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib54" title=""><span class="ltx_text" style="font-size:70%;">54</span></a><span class="ltx_text" id="Ax1.SS1.p3.1.3.2" style="font-size:70%;">]</span></cite><span class="ltx_text" id="Ax1.SS1.p3.1.4" style="font-size:70%;">.
We obtain 149 seed queries by filtering out classification queries from the seed queries of Alpaca.</span></span>
</span>
<span class="ltx_para ltx_noindent" id="Ax1.SS1.p4">
<span class="ltx_p" id="Ax1.SS1.p4.1"><span class="ltx_text ltx_font_bold" id="Ax1.SS1.p4.1.1" style="font-size:70%;">Prompt for Generating Responses for Open-Ended Discussion</span><span class="ltx_text" id="Ax1.SS1.p4.1.2" style="font-size:70%;"></span></span>
</span>
<span class="ltx_para" id="Ax1.SS1.p5">
<span class="ltx_p" id="Ax1.SS1.p5.1"><span class="ltx_text ltx_font_typewriter" id="Ax1.SS1.p5.1.1" style="font-size:90%;">You are asked to generate an appropriate response to the query. Make sure the response is less than 100 words.
<br class="ltx_break"/>Instruction: {query}
<br class="ltx_break"/>Response:</span><span class="ltx_text" id="Ax1.SS1.p5.1.2" style="font-size:70%;"></span></span>
</span>
<span class="ltx_para" id="Ax1.SS1.p6">
<span class="ltx_p" id="Ax1.SS1.p6.1"><span class="ltx_text" id="Ax1.SS1.p6.1.1" style="font-size:70%;">The above prompt is adapted from Alpaca </span><cite class="ltx_cite ltx_citemacro_citep"><span class="ltx_text" id="Ax1.SS1.p6.1.2.1" style="font-size:70%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib54" title=""><span class="ltx_text" style="font-size:70%;">54</span></a><span class="ltx_text" id="Ax1.SS1.p6.1.3.2" style="font-size:70%;">]</span></cite><span class="ltx_text" id="Ax1.SS1.p6.1.4" style="font-size:70%;">.</span></span>
</span>
<span class="ltx_para ltx_noindent" id="Ax1.SS1.p7">
<span class="ltx_p" id="Ax1.SS1.p7.1"><span class="ltx_text ltx_font_bold" id="Ax1.SS1.p7.1.1" style="font-size:70%;">Prompt for Evaluating Response Quality</span><span class="ltx_text" id="Ax1.SS1.p7.1.2" style="font-size:70%;"></span></span>
</span>
<span class="ltx_para" id="Ax1.SS1.p8">
<span class="ltx_p" id="Ax1.SS1.p8.1"><span class="ltx_text ltx_font_typewriter" id="Ax1.SS1.p8.1.1" style="font-size:90%;">[Instruction]
<br class="ltx_break"/>Please act as an impartial judge and evaluate the quality of the response provided by an AI assistant to the user question displayed below. Your evaluation should consider factors such as the helpfulness, relevance, accuracy, depth, creativity, and level of detail of the response. Begin your evaluation by providing a short explanation. Be as objective as possible. After providing your explanation, you must rate the response on a scale of 1 to 10 by strictly following this format: "[[rating]]", for example: "Rating: [[5]]".
<br class="ltx_break"/>
<br class="ltx_break"/>[Question]
<br class="ltx_break"/>{instruction}
<br class="ltx_break"/>
<br class="ltx_break"/>[The Start of Assistant’s Answer]
<br class="ltx_break"/>{response}
<br class="ltx_break"/>[The End of Assistant’s Answer]</span><span class="ltx_text" id="Ax1.SS1.p8.1.2" style="font-size:70%;"></span></span>
</span>
<span class="ltx_para" id="Ax1.SS1.p9">
<span class="ltx_p" id="Ax1.SS1.p9.1"><span class="ltx_text" id="Ax1.SS1.p9.1.1" style="font-size:70%;">The above prompt is adapted from </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="Ax1.SS1.p9.1.2.1" style="font-size:70%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib29" title=""><span class="ltx_text" style="font-size:70%;">29</span></a><span class="ltx_text" id="Ax1.SS1.p9.1.3.2" style="font-size:70%;">]</span></cite><span class="ltx_text" id="Ax1.SS1.p9.1.4" style="font-size:70%;">.</span></span>
</span>
<span class="ltx_para ltx_noindent" id="Ax1.SS1.p10">
<span class="ltx_p" id="Ax1.SS1.p10.1"><span class="ltx_text ltx_font_bold" id="Ax1.SS1.p10.1.1" style="font-size:70%;">Prompt for Evaluating Response Sentiment</span><span class="ltx_text" id="Ax1.SS1.p10.1.2" style="font-size:70%;"></span></span>
</span>
<span class="ltx_para" id="Ax1.SS1.p11">
<span class="ltx_p" id="Ax1.SS1.p11.1"><span class="ltx_text ltx_font_typewriter" id="Ax1.SS1.p11.1.1" style="font-size:90%;">Please rate the sentiment towards {topic} expressed in the following text on a scale of -5 to +5, where -5 is extremely negative, 0 is neutral, and +5 is extremely positive. Your response should only include the rating.
<br class="ltx_break"/>{response}</span><span class="ltx_text" id="Ax1.SS1.p11.1.2" style="font-size:70%;"></span></span>
</span>
<span class="ltx_para" id="Ax1.SS1.p12">
<span class="ltx_p" id="Ax1.SS1.p12.1"><span class="ltx_text" id="Ax1.SS1.p12.1.1" style="font-size:70%;">If a response gets a positive score, we label its sentiment as positive.
If it gets a negative score, we label its sentiment as negative.
If it gets 0, we label its sentiment as neutral.</span></span>
</span>
<span class="ltx_para" id="Ax1.SS1.p13">
<span class="ltx_p" id="Ax1.SS1.p13.1"><span class="ltx_text" id="Ax1.SS1.p13.1.1" style="font-size:70%;">The above prompt is adapted from </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="Ax1.SS1.p13.1.2.1" style="font-size:70%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib29" title=""><span class="ltx_text" style="font-size:70%;">29</span></a><span class="ltx_text" id="Ax1.SS1.p13.1.3.2" style="font-size:70%;">]</span></cite><span class="ltx_text" id="Ax1.SS1.p13.1.4" style="font-size:70%;">.</span></span>
</span>
</section>
<section class="ltx_subsection" id="Ax1.SS2">
<h3 class="ltx_title ltx_title_subsection" style="font-size:70%;">
<span class="ltx_tag ltx_tag_subsection">.2 </span>Experiment Details</h3>
<span class="ltx_para ltx_noindent" id="Ax1.SS2.p1">
<span class="ltx_p" id="Ax1.SS2.p1.1"><span class="ltx_text ltx_font_bold" id="Ax1.SS2.p1.1.1" style="font-size:70%;">Statics of Datasets.</span><span class="ltx_text" id="Ax1.SS2.p1.1.2" style="font-size:70%;"></span></span>
<span class="ltx_itemize" id="Ax1.I1">
<span class="ltx_item" id="Ax1.I1.i1" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="Ax1.I1.i1.p1">
<span class="ltx_p" id="Ax1.I1.i1.p1.2"><span class="ltx_text" id="Ax1.I1.i1.p1.2.1" style="font-size:70%;">Natural Question (NQ): </span><math alttext="2.6" class="ltx_Math" display="inline" id="Ax1.I1.i1.p1.1.m1.1"><semantics id="Ax1.I1.i1.p1.1.m1.1a"><mn id="Ax1.I1.i1.p1.1.m1.1.1" mathsize="70%" xref="Ax1.I1.i1.p1.1.m1.1.1.cmml">2.6</mn><annotation-xml encoding="MathML-Content" id="Ax1.I1.i1.p1.1.m1.1b"><cn id="Ax1.I1.i1.p1.1.m1.1.1.cmml" type="float" xref="Ax1.I1.i1.p1.1.m1.1.1">2.6</cn></annotation-xml><annotation encoding="application/x-tex" id="Ax1.I1.i1.p1.1.m1.1c">2.6</annotation><annotation encoding="application/x-llamapun" id="Ax1.I1.i1.p1.1.m1.1d">2.6</annotation></semantics></math><span class="ltx_text" id="Ax1.I1.i1.p1.2.2" style="font-size:70%;"> millon passages, </span><math alttext="3,452" class="ltx_Math" display="inline" id="Ax1.I1.i1.p1.2.m2.2"><semantics id="Ax1.I1.i1.p1.2.m2.2a"><mrow id="Ax1.I1.i1.p1.2.m2.2.3.2" xref="Ax1.I1.i1.p1.2.m2.2.3.1.cmml"><mn id="Ax1.I1.i1.p1.2.m2.1.1" mathsize="70%" xref="Ax1.I1.i1.p1.2.m2.1.1.cmml">3</mn><mo id="Ax1.I1.i1.p1.2.m2.2.3.2.1" mathsize="70%" xref="Ax1.I1.i1.p1.2.m2.2.3.1.cmml">,</mo><mn id="Ax1.I1.i1.p1.2.m2.2.2" mathsize="70%" xref="Ax1.I1.i1.p1.2.m2.2.2.cmml">452</mn></mrow><annotation-xml encoding="MathML-Content" id="Ax1.I1.i1.p1.2.m2.2b"><list id="Ax1.I1.i1.p1.2.m2.2.3.1.cmml" xref="Ax1.I1.i1.p1.2.m2.2.3.2"><cn id="Ax1.I1.i1.p1.2.m2.1.1.cmml" type="integer" xref="Ax1.I1.i1.p1.2.m2.1.1">3</cn><cn id="Ax1.I1.i1.p1.2.m2.2.2.cmml" type="integer" xref="Ax1.I1.i1.p1.2.m2.2.2">452</cn></list></annotation-xml><annotation encoding="application/x-tex" id="Ax1.I1.i1.p1.2.m2.2c">3,452</annotation><annotation encoding="application/x-llamapun" id="Ax1.I1.i1.p1.2.m2.2d">3 , 452</annotation></semantics></math><span class="ltx_text" id="Ax1.I1.i1.p1.2.3" style="font-size:70%;"> queries.</span></span>
</span></span>
<span class="ltx_item" id="Ax1.I1.i2" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="Ax1.I1.i2.p1">
<span class="ltx_p" id="Ax1.I1.i2.p1.2"><span class="ltx_text" id="Ax1.I1.i2.p1.2.1" style="font-size:70%;">MS MARCO: </span><math alttext="8.8" class="ltx_Math" display="inline" id="Ax1.I1.i2.p1.1.m1.1"><semantics id="Ax1.I1.i2.p1.1.m1.1a"><mn id="Ax1.I1.i2.p1.1.m1.1.1" mathsize="70%" xref="Ax1.I1.i2.p1.1.m1.1.1.cmml">8.8</mn><annotation-xml encoding="MathML-Content" id="Ax1.I1.i2.p1.1.m1.1b"><cn id="Ax1.I1.i2.p1.1.m1.1.1.cmml" type="float" xref="Ax1.I1.i2.p1.1.m1.1.1">8.8</cn></annotation-xml><annotation encoding="application/x-tex" id="Ax1.I1.i2.p1.1.m1.1c">8.8</annotation><annotation encoding="application/x-llamapun" id="Ax1.I1.i2.p1.1.m1.1d">8.8</annotation></semantics></math><span class="ltx_text" id="Ax1.I1.i2.p1.2.2" style="font-size:70%;"> million passages, </span><math alttext="5,793" class="ltx_Math" display="inline" id="Ax1.I1.i2.p1.2.m2.2"><semantics id="Ax1.I1.i2.p1.2.m2.2a"><mrow id="Ax1.I1.i2.p1.2.m2.2.3.2" xref="Ax1.I1.i2.p1.2.m2.2.3.1.cmml"><mn id="Ax1.I1.i2.p1.2.m2.1.1" mathsize="70%" xref="Ax1.I1.i2.p1.2.m2.1.1.cmml">5</mn><mo id="Ax1.I1.i2.p1.2.m2.2.3.2.1" mathsize="70%" xref="Ax1.I1.i2.p1.2.m2.2.3.1.cmml">,</mo><mn id="Ax1.I1.i2.p1.2.m2.2.2" mathsize="70%" xref="Ax1.I1.i2.p1.2.m2.2.2.cmml">793</mn></mrow><annotation-xml encoding="MathML-Content" id="Ax1.I1.i2.p1.2.m2.2b"><list id="Ax1.I1.i2.p1.2.m2.2.3.1.cmml" xref="Ax1.I1.i2.p1.2.m2.2.3.2"><cn id="Ax1.I1.i2.p1.2.m2.1.1.cmml" type="integer" xref="Ax1.I1.i2.p1.2.m2.1.1">5</cn><cn id="Ax1.I1.i2.p1.2.m2.2.2.cmml" type="integer" xref="Ax1.I1.i2.p1.2.m2.2.2">793</cn></list></annotation-xml><annotation encoding="application/x-tex" id="Ax1.I1.i2.p1.2.m2.2c">5,793</annotation><annotation encoding="application/x-llamapun" id="Ax1.I1.i2.p1.2.m2.2d">5 , 793</annotation></semantics></math><span class="ltx_text" id="Ax1.I1.i2.p1.2.3" style="font-size:70%;"> queries.</span></span>
</span></span>
<span class="ltx_item" id="Ax1.I1.i3" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="Ax1.I1.i3.p1">
<span class="ltx_p" id="Ax1.I1.i3.p1.2"><span class="ltx_text" id="Ax1.I1.i3.p1.2.1" style="font-size:70%;">SQuAD: </span><math alttext="23,215" class="ltx_Math" display="inline" id="Ax1.I1.i3.p1.1.m1.2"><semantics id="Ax1.I1.i3.p1.1.m1.2a"><mrow id="Ax1.I1.i3.p1.1.m1.2.3.2" xref="Ax1.I1.i3.p1.1.m1.2.3.1.cmml"><mn id="Ax1.I1.i3.p1.1.m1.1.1" mathsize="70%" xref="Ax1.I1.i3.p1.1.m1.1.1.cmml">23</mn><mo id="Ax1.I1.i3.p1.1.m1.2.3.2.1" mathsize="70%" xref="Ax1.I1.i3.p1.1.m1.2.3.1.cmml">,</mo><mn id="Ax1.I1.i3.p1.1.m1.2.2" mathsize="70%" xref="Ax1.I1.i3.p1.1.m1.2.2.cmml">215</mn></mrow><annotation-xml encoding="MathML-Content" id="Ax1.I1.i3.p1.1.m1.2b"><list id="Ax1.I1.i3.p1.1.m1.2.3.1.cmml" xref="Ax1.I1.i3.p1.1.m1.2.3.2"><cn id="Ax1.I1.i3.p1.1.m1.1.1.cmml" type="integer" xref="Ax1.I1.i3.p1.1.m1.1.1">23</cn><cn id="Ax1.I1.i3.p1.1.m1.2.2.cmml" type="integer" xref="Ax1.I1.i3.p1.1.m1.2.2">215</cn></list></annotation-xml><annotation encoding="application/x-tex" id="Ax1.I1.i3.p1.1.m1.2c">23,215</annotation><annotation encoding="application/x-llamapun" id="Ax1.I1.i3.p1.1.m1.2d">23 , 215</annotation></semantics></math><span class="ltx_text" id="Ax1.I1.i3.p1.2.2" style="font-size:70%;"> passages, </span><math alttext="107,785" class="ltx_Math" display="inline" id="Ax1.I1.i3.p1.2.m2.2"><semantics id="Ax1.I1.i3.p1.2.m2.2a"><mrow id="Ax1.I1.i3.p1.2.m2.2.3.2" xref="Ax1.I1.i3.p1.2.m2.2.3.1.cmml"><mn id="Ax1.I1.i3.p1.2.m2.1.1" mathsize="70%" xref="Ax1.I1.i3.p1.2.m2.1.1.cmml">107</mn><mo id="Ax1.I1.i3.p1.2.m2.2.3.2.1" mathsize="70%" xref="Ax1.I1.i3.p1.2.m2.2.3.1.cmml">,</mo><mn id="Ax1.I1.i3.p1.2.m2.2.2" mathsize="70%" xref="Ax1.I1.i3.p1.2.m2.2.2.cmml">785</mn></mrow><annotation-xml encoding="MathML-Content" id="Ax1.I1.i3.p1.2.m2.2b"><list id="Ax1.I1.i3.p1.2.m2.2.3.1.cmml" xref="Ax1.I1.i3.p1.2.m2.2.3.2"><cn id="Ax1.I1.i3.p1.2.m2.1.1.cmml" type="integer" xref="Ax1.I1.i3.p1.2.m2.1.1">107</cn><cn id="Ax1.I1.i3.p1.2.m2.2.2.cmml" type="integer" xref="Ax1.I1.i3.p1.2.m2.2.2">785</cn></list></annotation-xml><annotation encoding="application/x-tex" id="Ax1.I1.i3.p1.2.m2.2c">107,785</annotation><annotation encoding="application/x-llamapun" id="Ax1.I1.i3.p1.2.m2.2d">107 , 785</annotation></semantics></math><span class="ltx_text" id="Ax1.I1.i3.p1.2.3" style="font-size:70%;"> queries.</span></span>
</span></span>
<span class="ltx_item" id="Ax1.I1.i4" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="Ax1.I1.i4.p1">
<span class="ltx_p" id="Ax1.I1.i4.p1.1"><span class="ltx_text" id="Ax1.I1.i4.p1.1.1" style="font-size:70%;">WikiASP-Official: </span><math alttext="22.7" class="ltx_Math" display="inline" id="Ax1.I1.i4.p1.1.m1.1"><semantics id="Ax1.I1.i4.p1.1.m1.1a"><mn id="Ax1.I1.i4.p1.1.m1.1.1" mathsize="70%" xref="Ax1.I1.i4.p1.1.m1.1.1.cmml">22.7</mn><annotation-xml encoding="MathML-Content" id="Ax1.I1.i4.p1.1.m1.1b"><cn id="Ax1.I1.i4.p1.1.m1.1.1.cmml" type="float" xref="Ax1.I1.i4.p1.1.m1.1.1">22.7</cn></annotation-xml><annotation encoding="application/x-tex" id="Ax1.I1.i4.p1.1.m1.1c">22.7</annotation><annotation encoding="application/x-llamapun" id="Ax1.I1.i4.p1.1.m1.1d">22.7</annotation></semantics></math><span class="ltx_text" id="Ax1.I1.i4.p1.1.2" style="font-size:70%;"> k passages.</span></span>
</span></span>
<span class="ltx_item" id="Ax1.I1.i5" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="Ax1.I1.i5.p1">
<span class="ltx_p" id="Ax1.I1.i5.p1.1"><span class="ltx_text" id="Ax1.I1.i5.p1.1.1" style="font-size:70%;">WikiASP-Company: </span><math alttext="30.3" class="ltx_Math" display="inline" id="Ax1.I1.i5.p1.1.m1.1"><semantics id="Ax1.I1.i5.p1.1.m1.1a"><mn id="Ax1.I1.i5.p1.1.m1.1.1" mathsize="70%" xref="Ax1.I1.i5.p1.1.m1.1.1.cmml">30.3</mn><annotation-xml encoding="MathML-Content" id="Ax1.I1.i5.p1.1.m1.1b"><cn id="Ax1.I1.i5.p1.1.m1.1.1.cmml" type="float" xref="Ax1.I1.i5.p1.1.m1.1.1">30.3</cn></annotation-xml><annotation encoding="application/x-tex" id="Ax1.I1.i5.p1.1.m1.1c">30.3</annotation><annotation encoding="application/x-llamapun" id="Ax1.I1.i5.p1.1.m1.1d">30.3</annotation></semantics></math><span class="ltx_text" id="Ax1.I1.i5.p1.1.2" style="font-size:70%;"> k passages.</span></span>
</span></span>
</span>
</span>
<span class="ltx_para ltx_noindent" id="Ax1.SS2.p2">
<span class="ltx_p" id="Ax1.SS2.p2.1"><span class="ltx_text ltx_font_bold" id="Ax1.SS2.p2.1.1" style="font-size:70%;">Evaluation metrics</span><span class="ltx_text" id="Ax1.SS2.p2.1.2" style="font-size:70%;"></span></span>
<span class="ltx_itemize" id="Ax1.I2">
<span class="ltx_item" id="Ax1.I2.i1" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="Ax1.I2.i1.p1">
<span class="ltx_p" id="Ax1.I2.i1.p1.1"><span class="ltx_text" id="Ax1.I2.i1.p1.1.1" style="font-size:70%;">Retrieval Success Rate (Succ.%): The success rate at which adversarial passages, generated by BadRAG, are retrieved by triggered queries, thus assessing their impact on the retriever model.</span></span>
</span></span>
<span class="ltx_item" id="Ax1.I2.i2" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="Ax1.I2.i2.p1">
<span class="ltx_p" id="Ax1.I2.i2.p1.1"><span class="ltx_text" id="Ax1.I2.i2.p1.1.1" style="font-size:70%;">Rejection Rate (Rej.%): The frequency at which the LLM declines to respond, providing a measure of the effectiveness of potential DoS attacks.</span></span>
</span></span>
<span class="ltx_item" id="Ax1.I2.i3" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="Ax1.I2.i3.p1">
<span class="ltx_p" id="Ax1.I2.i3.p1.1"><span class="ltx_text" id="Ax1.I2.i3.p1.1.1" style="font-size:70%;">Rouge-2 F1 Score (R-2): The similarity between the LLM’s answers and the ground truth.</span></span>
</span></span>
<span class="ltx_item" id="Ax1.I2.i4" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="Ax1.I2.i4.p1">
<span class="ltx_p" id="Ax1.I2.i4.p1.1"><span class="ltx_text" id="Ax1.I2.i4.p1.1.1" style="font-size:70%;">Accuracy (Acc.%): Assesses the correctness of the LLM’s responses, evaluated by ChatGPT.</span></span>
</span></span>
<span class="ltx_item" id="Ax1.I2.i5" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="Ax1.I2.i5.p1">
<span class="ltx_p" id="Ax1.I2.i5.p1.1"><span class="ltx_text" id="Ax1.I2.i5.p1.1.1" style="font-size:70%;">Quality score: Ranks the overall quality of responses on a scale from 1 to 10, assessed by ChatGPT.</span></span>
</span></span>
<span class="ltx_item" id="Ax1.I2.i6" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="Ax1.I2.i6.p1">
<span class="ltx_p" id="Ax1.I2.i6.p1.1"><span class="ltx_text" id="Ax1.I2.i6.p1.1.1" style="font-size:70%;">Pos.% or Neg.%: The ratio of responses deemed positive or negative, assessed by ChatGPT.</span></span>
</span></span>
</span>
</span>
<span class="ltx_para ltx_noindent" id="Ax1.SS2.p3">
<span class="ltx_p" id="Ax1.SS2.p3.1"><span class="ltx_text ltx_font_bold" id="Ax1.SS2.p3.1.1" style="font-size:70%;">Positive Sentiment Steering.</span><span class="ltx_text" id="Ax1.SS2.p3.1.2" style="font-size:70%;">
We show the results of positive sentiment steering on clean and poisoned corpus in Table </span><a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#Ax1.SS2" style="font-size:70%;" title=".2 Experiment Details ‣ Appendix ‣ 5.4 Ablation Experiments ‣ 5.3 RQ3: Robust against Existing Defense ‣ 5.2 RQ2: Generative Attacks on LLMs ‣ 5.1 RQ1: Retrieval Attacks Only for Trigger Queries ‣ 5 Evaluation ‣ BadRAG: Identifying Vulnerabilities in Retrieval Augmented Generation of Large Language Models"><span class="ltx_text ltx_ref_tag">.2</span></a><span class="ltx_text" id="Ax1.SS2.p3.1.3" style="font-size:70%;">. The results follow the same trends as those for negative sentiment steering. The impact of positive sentiment steering is less pronounced due to the already high rate of positive responses in the clean RAG, which limits the scope for noticeable sentiment shifts compared to negative steering.</span></span>
</span>
<span class="ltx_table" id="Ax1.SS2.tab1">
<span class="ltx_caption" style="font-size:70%;"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="Ax1.SS2.tab1.3.1.1" style="font-size:129%;">Table 6</span>: </span><span class="ltx_text" id="Ax1.SS2.tab1.4.2" style="font-size:129%;">Positive sentiment steer with 10 adversarial passages (0.04% poisoning ratio)</span></span><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_figure_panel undefined" id="Ax1.SS2.tab1.5">{tabu}</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<span class="ltx_p ltx_figure_panel" id="Ax1.SS2.tab1.6"><span class="ltx_text" id="Ax1.SS2.tab1.6.1" style="font-size:80%;">to l|l|cc|cc|cc<span class="ltx_rule" style="width:100%;height:2.0pt;background:black;display:inline-block;"> </span>
<span class="ltx_text" id="Ax1.SS2.tab1.6.1.1">LLM</span> <span class="ltx_text" id="Ax1.SS2.tab1.6.1.2">Corpus</span>   Donald Trump <span class="ltx_rule" style="background:black;display:inline-block;"> </span>   TikTok <span class="ltx_rule" style="background:black;display:inline-block;"> </span>   Chinese  
<br class="ltx_break"/>  Quality  Pos.  Quality  Pos.  Quality  Pos. 
<br class="ltx_break"/>
<span class="ltx_text" id="Ax1.SS2.tab1.6.1.3">LLaMA-2</span>  clean  6.93  61.9  6.72  52.9  6.36  31.4 
<br class="ltx_break"/> poison  6.77  92.7  6.69  93.2  6.28  71.3 
<br class="ltx_break"/>
<span class="ltx_text" id="Ax1.SS2.tab1.6.1.4">GPT-4</span>  clean  7.56  65.5  8.02  61.9  8.05  51.6 
<br class="ltx_break"/> poison  7.49  94.8  7.96  91.0  8.01  95.2 
<br class="ltx_break"/>
<span class="ltx_text" id="Ax1.SS2.tab1.6.1.5">Claude-3</span>  clean  7.26  23.3  8.24  25.3  7.72  26.4 
<br class="ltx_break"/> poison  7.25  88.0  8.15  75.6  7.70  78.9 
<br class="ltx_break"/><span class="ltx_rule" style="width:100%;height:2.0pt;background:black;display:inline-block;"> </span></span></span>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<section class="ltx_subsection ltx_figure_panel" id="Ax1.SS3">
<h3 class="ltx_title ltx_title_subsection" style="font-size:80%;">
<span class="ltx_tag ltx_tag_subsection">.3 </span>Robustness against Existing Defense</h3>
<span class="ltx_para ltx_noindent" id="Ax1.SS3.p1">
<span class="ltx_p" id="Ax1.SS3.p1.7"><span class="ltx_text ltx_font_bold" id="Ax1.SS3.p1.7.1" style="font-size:80%;">Passage embedding norm.</span><span class="ltx_text" id="Ax1.SS3.p1.7.2" style="font-size:80%;"> </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="Ax1.SS3.p1.7.3.1" style="font-size:80%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib13" title=""><span class="ltx_text" style="font-size:70%;">13</span></a><span class="ltx_text" id="Ax1.SS3.p1.7.4.2" style="font-size:80%;">]</span></cite><span class="ltx_text" id="Ax1.SS3.p1.7.5" style="font-size:80%;"> proposed a defense against adversarial passages in RAG systems by noting that the similarity measure, </span><math alttext="\sim(p,q)" class="ltx_Math" display="inline" id="Ax1.SS3.p1.1.m1.2"><semantics id="Ax1.SS3.p1.1.m1.2a"><mrow id="Ax1.SS3.p1.1.m1.2.3" xref="Ax1.SS3.p1.1.m1.2.3.cmml"><mi id="Ax1.SS3.p1.1.m1.2.3.2" xref="Ax1.SS3.p1.1.m1.2.3.2.cmml"></mi><mo id="Ax1.SS3.p1.1.m1.2.3.1" mathsize="80%" xref="Ax1.SS3.p1.1.m1.2.3.1.cmml">∼</mo><mrow id="Ax1.SS3.p1.1.m1.2.3.3.2" xref="Ax1.SS3.p1.1.m1.2.3.3.1.cmml"><mo id="Ax1.SS3.p1.1.m1.2.3.3.2.1" maxsize="80%" minsize="80%" xref="Ax1.SS3.p1.1.m1.2.3.3.1.cmml">(</mo><mi id="Ax1.SS3.p1.1.m1.1.1" mathsize="80%" xref="Ax1.SS3.p1.1.m1.1.1.cmml">p</mi><mo id="Ax1.SS3.p1.1.m1.2.3.3.2.2" mathsize="80%" xref="Ax1.SS3.p1.1.m1.2.3.3.1.cmml">,</mo><mi id="Ax1.SS3.p1.1.m1.2.2" mathsize="80%" xref="Ax1.SS3.p1.1.m1.2.2.cmml">q</mi><mo id="Ax1.SS3.p1.1.m1.2.3.3.2.3" maxsize="80%" minsize="80%" xref="Ax1.SS3.p1.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Ax1.SS3.p1.1.m1.2b"><apply id="Ax1.SS3.p1.1.m1.2.3.cmml" xref="Ax1.SS3.p1.1.m1.2.3"><csymbol cd="latexml" id="Ax1.SS3.p1.1.m1.2.3.1.cmml" xref="Ax1.SS3.p1.1.m1.2.3.1">similar-to</csymbol><csymbol cd="latexml" id="Ax1.SS3.p1.1.m1.2.3.2.cmml" xref="Ax1.SS3.p1.1.m1.2.3.2">absent</csymbol><interval closure="open" id="Ax1.SS3.p1.1.m1.2.3.3.1.cmml" xref="Ax1.SS3.p1.1.m1.2.3.3.2"><ci id="Ax1.SS3.p1.1.m1.1.1.cmml" xref="Ax1.SS3.p1.1.m1.1.1">𝑝</ci><ci id="Ax1.SS3.p1.1.m1.2.2.cmml" xref="Ax1.SS3.p1.1.m1.2.2">𝑞</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="Ax1.SS3.p1.1.m1.2c">\sim(p,q)</annotation><annotation encoding="application/x-llamapun" id="Ax1.SS3.p1.1.m1.2d">∼ ( italic_p , italic_q )</annotation></semantics></math><span class="ltx_text" id="Ax1.SS3.p1.7.6" style="font-size:80%;">, is proportional to the product of the norm of the passage embedding </span><math alttext="\lVert E_{p}(P)\rVert_{2}" class="ltx_Math" display="inline" id="Ax1.SS3.p1.2.m2.2"><semantics id="Ax1.SS3.p1.2.m2.2a"><msub id="Ax1.SS3.p1.2.m2.2.2" xref="Ax1.SS3.p1.2.m2.2.2.cmml"><mrow id="Ax1.SS3.p1.2.m2.2.2.1.1" xref="Ax1.SS3.p1.2.m2.2.2.1.2.cmml"><mo fence="true" id="Ax1.SS3.p1.2.m2.2.2.1.1.2" mathsize="80%" rspace="0em" xref="Ax1.SS3.p1.2.m2.2.2.1.2.1.cmml">∥</mo><mrow id="Ax1.SS3.p1.2.m2.2.2.1.1.1" xref="Ax1.SS3.p1.2.m2.2.2.1.1.1.cmml"><msub id="Ax1.SS3.p1.2.m2.2.2.1.1.1.2" xref="Ax1.SS3.p1.2.m2.2.2.1.1.1.2.cmml"><mi id="Ax1.SS3.p1.2.m2.2.2.1.1.1.2.2" mathsize="80%" xref="Ax1.SS3.p1.2.m2.2.2.1.1.1.2.2.cmml">E</mi><mi id="Ax1.SS3.p1.2.m2.2.2.1.1.1.2.3" mathsize="80%" xref="Ax1.SS3.p1.2.m2.2.2.1.1.1.2.3.cmml">p</mi></msub><mo id="Ax1.SS3.p1.2.m2.2.2.1.1.1.1" xref="Ax1.SS3.p1.2.m2.2.2.1.1.1.1.cmml">⁢</mo><mrow id="Ax1.SS3.p1.2.m2.2.2.1.1.1.3.2" xref="Ax1.SS3.p1.2.m2.2.2.1.1.1.cmml"><mo id="Ax1.SS3.p1.2.m2.2.2.1.1.1.3.2.1" maxsize="80%" minsize="80%" xref="Ax1.SS3.p1.2.m2.2.2.1.1.1.cmml">(</mo><mi id="Ax1.SS3.p1.2.m2.1.1" mathsize="80%" xref="Ax1.SS3.p1.2.m2.1.1.cmml">P</mi><mo id="Ax1.SS3.p1.2.m2.2.2.1.1.1.3.2.2" maxsize="80%" minsize="80%" xref="Ax1.SS3.p1.2.m2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo fence="true" id="Ax1.SS3.p1.2.m2.2.2.1.1.3" lspace="0em" mathsize="80%" xref="Ax1.SS3.p1.2.m2.2.2.1.2.1.cmml">∥</mo></mrow><mn id="Ax1.SS3.p1.2.m2.2.2.3" mathsize="80%" xref="Ax1.SS3.p1.2.m2.2.2.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="Ax1.SS3.p1.2.m2.2b"><apply id="Ax1.SS3.p1.2.m2.2.2.cmml" xref="Ax1.SS3.p1.2.m2.2.2"><csymbol cd="ambiguous" id="Ax1.SS3.p1.2.m2.2.2.2.cmml" xref="Ax1.SS3.p1.2.m2.2.2">subscript</csymbol><apply id="Ax1.SS3.p1.2.m2.2.2.1.2.cmml" xref="Ax1.SS3.p1.2.m2.2.2.1.1"><csymbol cd="latexml" id="Ax1.SS3.p1.2.m2.2.2.1.2.1.cmml" xref="Ax1.SS3.p1.2.m2.2.2.1.1.2">delimited-∥∥</csymbol><apply id="Ax1.SS3.p1.2.m2.2.2.1.1.1.cmml" xref="Ax1.SS3.p1.2.m2.2.2.1.1.1"><times id="Ax1.SS3.p1.2.m2.2.2.1.1.1.1.cmml" xref="Ax1.SS3.p1.2.m2.2.2.1.1.1.1"></times><apply id="Ax1.SS3.p1.2.m2.2.2.1.1.1.2.cmml" xref="Ax1.SS3.p1.2.m2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="Ax1.SS3.p1.2.m2.2.2.1.1.1.2.1.cmml" xref="Ax1.SS3.p1.2.m2.2.2.1.1.1.2">subscript</csymbol><ci id="Ax1.SS3.p1.2.m2.2.2.1.1.1.2.2.cmml" xref="Ax1.SS3.p1.2.m2.2.2.1.1.1.2.2">𝐸</ci><ci id="Ax1.SS3.p1.2.m2.2.2.1.1.1.2.3.cmml" xref="Ax1.SS3.p1.2.m2.2.2.1.1.1.2.3">𝑝</ci></apply><ci id="Ax1.SS3.p1.2.m2.1.1.cmml" xref="Ax1.SS3.p1.2.m2.1.1">𝑃</ci></apply></apply><cn id="Ax1.SS3.p1.2.m2.2.2.3.cmml" type="integer" xref="Ax1.SS3.p1.2.m2.2.2.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Ax1.SS3.p1.2.m2.2c">\lVert E_{p}(P)\rVert_{2}</annotation><annotation encoding="application/x-llamapun" id="Ax1.SS3.p1.2.m2.2d">∥ italic_E start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_P ) ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="Ax1.SS3.p1.7.7" style="font-size:80%;"> and the cosine of the angle </span><math alttext="\theta" class="ltx_Math" display="inline" id="Ax1.SS3.p1.3.m3.1"><semantics id="Ax1.SS3.p1.3.m3.1a"><mi id="Ax1.SS3.p1.3.m3.1.1" mathsize="80%" xref="Ax1.SS3.p1.3.m3.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="Ax1.SS3.p1.3.m3.1b"><ci id="Ax1.SS3.p1.3.m3.1.1.cmml" xref="Ax1.SS3.p1.3.m3.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="Ax1.SS3.p1.3.m3.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="Ax1.SS3.p1.3.m3.1d">italic_θ</annotation></semantics></math><span class="ltx_text" id="Ax1.SS3.p1.7.8" style="font-size:80%;"> between the query and passage embeddings: </span><math alttext="\sim(p,q)\propto\lVert E_{p}(P)\rVert_{2}\cos(\theta)" class="ltx_Math" display="inline" id="Ax1.SS3.p1.4.m4.6"><semantics id="Ax1.SS3.p1.4.m4.6a"><mrow id="Ax1.SS3.p1.4.m4.6.6" xref="Ax1.SS3.p1.4.m4.6.6.cmml"><mi id="Ax1.SS3.p1.4.m4.6.6.3" xref="Ax1.SS3.p1.4.m4.6.6.3.cmml"></mi><mo id="Ax1.SS3.p1.4.m4.6.6.4" mathsize="80%" xref="Ax1.SS3.p1.4.m4.6.6.4.cmml">∼</mo><mrow id="Ax1.SS3.p1.4.m4.6.6.5.2" xref="Ax1.SS3.p1.4.m4.6.6.5.1.cmml"><mo id="Ax1.SS3.p1.4.m4.6.6.5.2.1" maxsize="80%" minsize="80%" xref="Ax1.SS3.p1.4.m4.6.6.5.1.cmml">(</mo><mi id="Ax1.SS3.p1.4.m4.1.1" mathsize="80%" xref="Ax1.SS3.p1.4.m4.1.1.cmml">p</mi><mo id="Ax1.SS3.p1.4.m4.6.6.5.2.2" mathsize="80%" xref="Ax1.SS3.p1.4.m4.6.6.5.1.cmml">,</mo><mi id="Ax1.SS3.p1.4.m4.2.2" mathsize="80%" xref="Ax1.SS3.p1.4.m4.2.2.cmml">q</mi><mo id="Ax1.SS3.p1.4.m4.6.6.5.2.3" maxsize="80%" minsize="80%" xref="Ax1.SS3.p1.4.m4.6.6.5.1.cmml">)</mo></mrow><mo id="Ax1.SS3.p1.4.m4.6.6.6" mathsize="80%" rspace="0.1389em" xref="Ax1.SS3.p1.4.m4.6.6.6.cmml">∝</mo><mrow id="Ax1.SS3.p1.4.m4.6.6.1" xref="Ax1.SS3.p1.4.m4.6.6.1.cmml"><msub id="Ax1.SS3.p1.4.m4.6.6.1.1" xref="Ax1.SS3.p1.4.m4.6.6.1.1.cmml"><mrow id="Ax1.SS3.p1.4.m4.6.6.1.1.1.1" xref="Ax1.SS3.p1.4.m4.6.6.1.1.1.2.cmml"><mo fence="true" id="Ax1.SS3.p1.4.m4.6.6.1.1.1.1.2" lspace="0.1389em" mathsize="80%" rspace="0em" xref="Ax1.SS3.p1.4.m4.6.6.1.1.1.2.1.cmml">∥</mo><mrow id="Ax1.SS3.p1.4.m4.6.6.1.1.1.1.1" xref="Ax1.SS3.p1.4.m4.6.6.1.1.1.1.1.cmml"><msub id="Ax1.SS3.p1.4.m4.6.6.1.1.1.1.1.2" xref="Ax1.SS3.p1.4.m4.6.6.1.1.1.1.1.2.cmml"><mi id="Ax1.SS3.p1.4.m4.6.6.1.1.1.1.1.2.2" mathsize="80%" xref="Ax1.SS3.p1.4.m4.6.6.1.1.1.1.1.2.2.cmml">E</mi><mi id="Ax1.SS3.p1.4.m4.6.6.1.1.1.1.1.2.3" mathsize="80%" xref="Ax1.SS3.p1.4.m4.6.6.1.1.1.1.1.2.3.cmml">p</mi></msub><mo id="Ax1.SS3.p1.4.m4.6.6.1.1.1.1.1.1" xref="Ax1.SS3.p1.4.m4.6.6.1.1.1.1.1.1.cmml">⁢</mo><mrow id="Ax1.SS3.p1.4.m4.6.6.1.1.1.1.1.3.2" xref="Ax1.SS3.p1.4.m4.6.6.1.1.1.1.1.cmml"><mo id="Ax1.SS3.p1.4.m4.6.6.1.1.1.1.1.3.2.1" maxsize="80%" minsize="80%" xref="Ax1.SS3.p1.4.m4.6.6.1.1.1.1.1.cmml">(</mo><mi id="Ax1.SS3.p1.4.m4.3.3" mathsize="80%" xref="Ax1.SS3.p1.4.m4.3.3.cmml">P</mi><mo id="Ax1.SS3.p1.4.m4.6.6.1.1.1.1.1.3.2.2" maxsize="80%" minsize="80%" xref="Ax1.SS3.p1.4.m4.6.6.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo fence="true" id="Ax1.SS3.p1.4.m4.6.6.1.1.1.1.3" lspace="0em" mathsize="80%" xref="Ax1.SS3.p1.4.m4.6.6.1.1.1.2.1.cmml">∥</mo></mrow><mn id="Ax1.SS3.p1.4.m4.6.6.1.1.3" mathsize="80%" xref="Ax1.SS3.p1.4.m4.6.6.1.1.3.cmml">2</mn></msub><mo id="Ax1.SS3.p1.4.m4.6.6.1.2" lspace="0.167em" xref="Ax1.SS3.p1.4.m4.6.6.1.2.cmml">⁢</mo><mrow id="Ax1.SS3.p1.4.m4.6.6.1.3.2" xref="Ax1.SS3.p1.4.m4.6.6.1.3.1.cmml"><mi id="Ax1.SS3.p1.4.m4.4.4" mathsize="80%" xref="Ax1.SS3.p1.4.m4.4.4.cmml">cos</mi><mo id="Ax1.SS3.p1.4.m4.6.6.1.3.2a" xref="Ax1.SS3.p1.4.m4.6.6.1.3.1.cmml">⁡</mo><mrow id="Ax1.SS3.p1.4.m4.6.6.1.3.2.1" xref="Ax1.SS3.p1.4.m4.6.6.1.3.1.cmml"><mo id="Ax1.SS3.p1.4.m4.6.6.1.3.2.1.1" maxsize="80%" minsize="80%" xref="Ax1.SS3.p1.4.m4.6.6.1.3.1.cmml">(</mo><mi id="Ax1.SS3.p1.4.m4.5.5" mathsize="80%" xref="Ax1.SS3.p1.4.m4.5.5.cmml">θ</mi><mo id="Ax1.SS3.p1.4.m4.6.6.1.3.2.1.2" maxsize="80%" minsize="80%" xref="Ax1.SS3.p1.4.m4.6.6.1.3.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Ax1.SS3.p1.4.m4.6b"><apply id="Ax1.SS3.p1.4.m4.6.6.cmml" xref="Ax1.SS3.p1.4.m4.6.6"><and id="Ax1.SS3.p1.4.m4.6.6a.cmml" xref="Ax1.SS3.p1.4.m4.6.6"></and><apply id="Ax1.SS3.p1.4.m4.6.6b.cmml" xref="Ax1.SS3.p1.4.m4.6.6"><csymbol cd="latexml" id="Ax1.SS3.p1.4.m4.6.6.4.cmml" xref="Ax1.SS3.p1.4.m4.6.6.4">similar-to</csymbol><csymbol cd="latexml" id="Ax1.SS3.p1.4.m4.6.6.3.cmml" xref="Ax1.SS3.p1.4.m4.6.6.3">absent</csymbol><interval closure="open" id="Ax1.SS3.p1.4.m4.6.6.5.1.cmml" xref="Ax1.SS3.p1.4.m4.6.6.5.2"><ci id="Ax1.SS3.p1.4.m4.1.1.cmml" xref="Ax1.SS3.p1.4.m4.1.1">𝑝</ci><ci id="Ax1.SS3.p1.4.m4.2.2.cmml" xref="Ax1.SS3.p1.4.m4.2.2">𝑞</ci></interval></apply><apply id="Ax1.SS3.p1.4.m4.6.6c.cmml" xref="Ax1.SS3.p1.4.m4.6.6"><csymbol cd="latexml" id="Ax1.SS3.p1.4.m4.6.6.6.cmml" xref="Ax1.SS3.p1.4.m4.6.6.6">proportional-to</csymbol><share href="https://arxiv.org/html/2406.00083v2#Ax1.SS3.p1.4.m4.6.6.5.cmml" id="Ax1.SS3.p1.4.m4.6.6d.cmml" xref="Ax1.SS3.p1.4.m4.6.6"></share><apply id="Ax1.SS3.p1.4.m4.6.6.1.cmml" xref="Ax1.SS3.p1.4.m4.6.6.1"><times id="Ax1.SS3.p1.4.m4.6.6.1.2.cmml" xref="Ax1.SS3.p1.4.m4.6.6.1.2"></times><apply id="Ax1.SS3.p1.4.m4.6.6.1.1.cmml" xref="Ax1.SS3.p1.4.m4.6.6.1.1"><csymbol cd="ambiguous" id="Ax1.SS3.p1.4.m4.6.6.1.1.2.cmml" xref="Ax1.SS3.p1.4.m4.6.6.1.1">subscript</csymbol><apply id="Ax1.SS3.p1.4.m4.6.6.1.1.1.2.cmml" xref="Ax1.SS3.p1.4.m4.6.6.1.1.1.1"><csymbol cd="latexml" id="Ax1.SS3.p1.4.m4.6.6.1.1.1.2.1.cmml" xref="Ax1.SS3.p1.4.m4.6.6.1.1.1.1.2">delimited-∥∥</csymbol><apply id="Ax1.SS3.p1.4.m4.6.6.1.1.1.1.1.cmml" xref="Ax1.SS3.p1.4.m4.6.6.1.1.1.1.1"><times id="Ax1.SS3.p1.4.m4.6.6.1.1.1.1.1.1.cmml" xref="Ax1.SS3.p1.4.m4.6.6.1.1.1.1.1.1"></times><apply id="Ax1.SS3.p1.4.m4.6.6.1.1.1.1.1.2.cmml" xref="Ax1.SS3.p1.4.m4.6.6.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Ax1.SS3.p1.4.m4.6.6.1.1.1.1.1.2.1.cmml" xref="Ax1.SS3.p1.4.m4.6.6.1.1.1.1.1.2">subscript</csymbol><ci id="Ax1.SS3.p1.4.m4.6.6.1.1.1.1.1.2.2.cmml" xref="Ax1.SS3.p1.4.m4.6.6.1.1.1.1.1.2.2">𝐸</ci><ci id="Ax1.SS3.p1.4.m4.6.6.1.1.1.1.1.2.3.cmml" xref="Ax1.SS3.p1.4.m4.6.6.1.1.1.1.1.2.3">𝑝</ci></apply><ci id="Ax1.SS3.p1.4.m4.3.3.cmml" xref="Ax1.SS3.p1.4.m4.3.3">𝑃</ci></apply></apply><cn id="Ax1.SS3.p1.4.m4.6.6.1.1.3.cmml" type="integer" xref="Ax1.SS3.p1.4.m4.6.6.1.1.3">2</cn></apply><apply id="Ax1.SS3.p1.4.m4.6.6.1.3.1.cmml" xref="Ax1.SS3.p1.4.m4.6.6.1.3.2"><cos id="Ax1.SS3.p1.4.m4.4.4.cmml" xref="Ax1.SS3.p1.4.m4.4.4"></cos><ci id="Ax1.SS3.p1.4.m4.5.5.cmml" xref="Ax1.SS3.p1.4.m4.5.5">𝜃</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Ax1.SS3.p1.4.m4.6c">\sim(p,q)\propto\lVert E_{p}(P)\rVert_{2}\cos(\theta)</annotation><annotation encoding="application/x-llamapun" id="Ax1.SS3.p1.4.m4.6d">∼ ( italic_p , italic_q ) ∝ ∥ italic_E start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_P ) ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT roman_cos ( italic_θ )</annotation></semantics></math><span class="ltx_text" id="Ax1.SS3.p1.7.9" style="font-size:80%;">. This relationship implies that adversarial passages typically require unusually large </span><math alttext="\ell_{2}" class="ltx_Math" display="inline" id="Ax1.SS3.p1.5.m5.1"><semantics id="Ax1.SS3.p1.5.m5.1a"><msub id="Ax1.SS3.p1.5.m5.1.1" xref="Ax1.SS3.p1.5.m5.1.1.cmml"><mi id="Ax1.SS3.p1.5.m5.1.1.2" mathsize="80%" mathvariant="normal" xref="Ax1.SS3.p1.5.m5.1.1.2.cmml">ℓ</mi><mn id="Ax1.SS3.p1.5.m5.1.1.3" mathsize="80%" xref="Ax1.SS3.p1.5.m5.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="Ax1.SS3.p1.5.m5.1b"><apply id="Ax1.SS3.p1.5.m5.1.1.cmml" xref="Ax1.SS3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="Ax1.SS3.p1.5.m5.1.1.1.cmml" xref="Ax1.SS3.p1.5.m5.1.1">subscript</csymbol><ci id="Ax1.SS3.p1.5.m5.1.1.2.cmml" xref="Ax1.SS3.p1.5.m5.1.1.2">ℓ</ci><cn id="Ax1.SS3.p1.5.m5.1.1.3.cmml" type="integer" xref="Ax1.SS3.p1.5.m5.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Ax1.SS3.p1.5.m5.1c">\ell_{2}</annotation><annotation encoding="application/x-llamapun" id="Ax1.SS3.p1.5.m5.1d">roman_ℓ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="Ax1.SS3.p1.7.10" style="font-size:80%;">-norms to ensure high similarity scores across a wide range of queries, as reducing </span><math alttext="\theta" class="ltx_Math" display="inline" id="Ax1.SS3.p1.6.m6.1"><semantics id="Ax1.SS3.p1.6.m6.1a"><mi id="Ax1.SS3.p1.6.m6.1.1" mathsize="80%" xref="Ax1.SS3.p1.6.m6.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="Ax1.SS3.p1.6.m6.1b"><ci id="Ax1.SS3.p1.6.m6.1.1.cmml" xref="Ax1.SS3.p1.6.m6.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="Ax1.SS3.p1.6.m6.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="Ax1.SS3.p1.6.m6.1d">italic_θ</annotation></semantics></math><span class="ltx_text" id="Ax1.SS3.p1.7.11" style="font-size:80%;"> to zero is impractical for diverse queries. However, this defense is less effective against our BadRAG, where adversarial passages are specifically crafted for targeted triggers that already share a high degree of similarity in the feature space with the intended queries. Consequently, BadRAG does not rely on large </span><math alttext="\ell_{2}" class="ltx_Math" display="inline" id="Ax1.SS3.p1.7.m7.1"><semantics id="Ax1.SS3.p1.7.m7.1a"><msub id="Ax1.SS3.p1.7.m7.1.1" xref="Ax1.SS3.p1.7.m7.1.1.cmml"><mi id="Ax1.SS3.p1.7.m7.1.1.2" mathsize="80%" mathvariant="normal" xref="Ax1.SS3.p1.7.m7.1.1.2.cmml">ℓ</mi><mn id="Ax1.SS3.p1.7.m7.1.1.3" mathsize="80%" xref="Ax1.SS3.p1.7.m7.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="Ax1.SS3.p1.7.m7.1b"><apply id="Ax1.SS3.p1.7.m7.1.1.cmml" xref="Ax1.SS3.p1.7.m7.1.1"><csymbol cd="ambiguous" id="Ax1.SS3.p1.7.m7.1.1.1.cmml" xref="Ax1.SS3.p1.7.m7.1.1">subscript</csymbol><ci id="Ax1.SS3.p1.7.m7.1.1.2.cmml" xref="Ax1.SS3.p1.7.m7.1.1.2">ℓ</ci><cn id="Ax1.SS3.p1.7.m7.1.1.3.cmml" type="integer" xref="Ax1.SS3.p1.7.m7.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Ax1.SS3.p1.7.m7.1c">\ell_{2}</annotation><annotation encoding="application/x-llamapun" id="Ax1.SS3.p1.7.m7.1d">roman_ℓ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="Ax1.SS3.p1.7.12" style="font-size:80%;">-norms to achieve effective retrieval, thereby bypassing this defense strategy. As the Figure </span><a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#Ax1.F6" style="font-size:80%;" title="Figure 6 ‣ .3 Robustness against Existing Defense ‣ .2 Experiment Details ‣ Appendix ‣ 5.4 Ablation Experiments ‣ 5.3 RQ3: Robust against Existing Defense ‣ 5.2 RQ2: Generative Attacks on LLMs ‣ 5.1 RQ1: Retrieval Attacks Only for Trigger Queries ‣ 5 Evaluation ‣ BadRAG: Identifying Vulnerabilities in Retrieval Augmented Generation of Large Language Models"><span class="ltx_text ltx_ref_tag">6</span></a><span class="ltx_text" id="Ax1.SS3.p1.7.13" style="font-size:80%;"> (a) shows, the adversarial passage generated by BadRAG cannot be well distinguished from the clean passage.</span></span>
</span>
<span class="ltx_para ltx_noindent" id="Ax1.SS3.p2">
<span class="ltx_p" id="Ax1.SS3.p2.1"><span class="ltx_text ltx_font_bold" id="Ax1.SS3.p2.1.1" style="font-size:80%;">Fluency detection.</span><span class="ltx_text" id="Ax1.SS3.p2.1.2" style="font-size:80%;"> Average token log likelihood </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="Ax1.SS3.p2.1.3.1" style="font-size:80%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib55" title=""><span class="ltx_text" style="font-size:70%;">55</span></a><span class="ltx_text" id="Ax1.SS3.p2.1.4.2" style="font-size:80%;">]</span></cite><span class="ltx_text" id="Ax1.SS3.p2.1.5" style="font-size:80%;"> is widely used to measure the quality of texts. Following </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="Ax1.SS3.p2.1.6.1" style="font-size:80%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib13" title=""><span class="ltx_text" style="font-size:70%;">13</span></a><span class="ltx_text" id="Ax1.SS3.p2.1.7.2" style="font-size:80%;">]</span></cite><span class="ltx_text" id="Ax1.SS3.p2.1.8" style="font-size:80%;">, we investigated a defense strategy using the likelihood score to detect anomalous sentences. In our experiments, we utilized GPT-2 </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="Ax1.SS3.p2.1.9.1" style="font-size:80%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib56" title=""><span class="ltx_text" style="font-size:70%;">56</span></a><span class="ltx_text" id="Ax1.SS3.p2.1.10.2" style="font-size:80%;">]</span></cite><span class="ltx_text" id="Ax1.SS3.p2.1.11" style="font-size:80%;"> to assess whether injected adversarial passages could be distinguished based on their average log likelihood, with comparisons shown in Figure </span><a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#Ax1.F6" style="font-size:80%;" title="Figure 6 ‣ .3 Robustness against Existing Defense ‣ .2 Experiment Details ‣ Appendix ‣ 5.4 Ablation Experiments ‣ 5.3 RQ3: Robust against Existing Defense ‣ 5.2 RQ2: Generative Attacks on LLMs ‣ 5.1 RQ1: Retrieval Attacks Only for Trigger Queries ‣ 5 Evaluation ‣ BadRAG: Identifying Vulnerabilities in Retrieval Augmented Generation of Large Language Models"><span class="ltx_text ltx_ref_tag">6</span></a><span class="ltx_text" id="Ax1.SS3.p2.1.12" style="font-size:80%;"> (d). The results indicate that passages generated by BadRAG are difficult to differentiate from clean passages. The reason behinds is that although the backdoor prefix is less fluent, it is significantly shorter than the subsequent fluent malicious content, which dilutes any detectable reduction in overall fluency.</span></span>
</span>
<span class="ltx_figure" id="Ax1.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="343" id="Ax1.F6.g1" src="x6.png" width="830"/>
<span class="ltx_caption ltx_centering" style="font-size:80%;"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="Ax1.F6.4.1.1" style="font-size:113%;">Figure 6</span>: </span><span class="ltx_text" id="Ax1.F6.5.2" style="font-size:113%;">Results of potential defenses.</span></span>
</span>
<span class="ltx_para" id="Ax1.SS3.p3">
<span class="ltx_p" id="Ax1.SS3.p3.1"><span class="ltx_text" id="Ax1.SS3.p3.1.1" style="font-size:80%;">For experiments on the close-ended QA datasets, the trigger scenario we used is </span><span class="ltx_text ltx_font_italic" id="Ax1.SS3.p3.1.2" style="font-size:80%;">"discussing Republic"</span><span class="ltx_text" id="Ax1.SS3.p3.1.3" style="font-size:80%;">. For experiments on the open-ended generation, we test three trigger scenarios, i.e., </span><span class="ltx_text ltx_font_italic" id="Ax1.SS3.p3.1.4" style="font-size:80%;">"discussing Donald Trump"</span><span class="ltx_text" id="Ax1.SS3.p3.1.5" style="font-size:80%;">, </span><span class="ltx_text ltx_font_italic" id="Ax1.SS3.p3.1.6" style="font-size:80%;">"discussing TikTok"</span><span class="ltx_text" id="Ax1.SS3.p3.1.7" style="font-size:80%;"> and </span><span class="ltx_text ltx_font_italic" id="Ax1.SS3.p3.1.8" style="font-size:80%;">"discussing Chinese"</span><span class="ltx_text" id="Ax1.SS3.p3.1.9" style="font-size:80%;">. For close-ended QA datasets, we randomly insert triggers into the original queries to form the triggered queries. For the open-ended generation tasks, we construct queries within the trigger scenario. For instance, in scenarios related to </span><span class="ltx_text ltx_font_italic" id="Ax1.SS3.p3.1.10" style="font-size:80%;">"discussing Donald Trump"</span><span class="ltx_text" id="Ax1.SS3.p3.1.11" style="font-size:80%;">, we generate queries such as </span><span class="ltx_text ltx_font_italic" id="Ax1.SS3.p3.1.12" style="font-size:80%;">"Analyze Trump’s immigration policy."</span><span class="ltx_text" id="Ax1.SS3.p3.1.13" style="font-size:80%;"> These triggered queries are produced either manually by researchers </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="Ax1.SS3.p3.1.14.1" style="font-size:80%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib57" title=""><span class="ltx_text" style="font-size:70%;">57</span></a><span class="ltx_text" id="Ax1.SS3.p3.1.15.2" style="font-size:80%;">]</span></cite><span class="ltx_text" id="Ax1.SS3.p3.1.16" style="font-size:80%;"> or automatically by LLMs </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="Ax1.SS3.p3.1.17.1" style="font-size:80%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2406.00083v2#bib.bib29" title=""><span class="ltx_text" style="font-size:70%;">29</span></a><span class="ltx_text" id="Ax1.SS3.p3.1.18.2" style="font-size:80%;">]</span></cite><span class="ltx_text" id="Ax1.SS3.p3.1.19" style="font-size:80%;">. In this study, we utilize ChatGPT to generate triggered queries owing to its cost-effectiveness. Specifically, for each topic aimed at steering sentiment, we generate </span><math alttext="300" class="ltx_Math" display="inline" id="Ax1.SS3.p3.1.m1.1"><semantics id="Ax1.SS3.p3.1.m1.1a"><mn id="Ax1.SS3.p3.1.m1.1.1" mathsize="80%" xref="Ax1.SS3.p3.1.m1.1.1.cmml">300</mn><annotation-xml encoding="MathML-Content" id="Ax1.SS3.p3.1.m1.1b"><cn id="Ax1.SS3.p3.1.m1.1.1.cmml" type="integer" xref="Ax1.SS3.p3.1.m1.1.1">300</cn></annotation-xml><annotation encoding="application/x-tex" id="Ax1.SS3.p3.1.m1.1c">300</annotation><annotation encoding="application/x-llamapun" id="Ax1.SS3.p3.1.m1.1d">300</annotation></semantics></math><span class="ltx_text" id="Ax1.SS3.p3.1.20" style="font-size:80%;"> triggered queries using ChatGPT, focusing on open-ended discussions pertinent to the topic.</span></span>
<div class="ltx_pagination ltx_role_newpage"></div>
</span>
</section>
</div>
</div>
</span>
</section>
</section>
</span></p>
</div>
</div>
</figure>
</figure>
</section>
</section>
</div>
</div>
</figure>
</div>
</div>
</figure>
</section>
</div>
</div>
</figure>
</section>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Thu Jun  6 13:38:57 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
