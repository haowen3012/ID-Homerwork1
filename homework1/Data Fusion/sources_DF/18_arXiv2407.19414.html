<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction</title>
<!--Generated on Sun Jul 28 06:22:09 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="
App Usage Prediction,  Transformer,  Multi-Modal Data Fusion,  Feature Extraction,  Data Mining.
" lang="en" name="keywords"/>
<base href="/html/2407.19414v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S1" title="In Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">I </span><span class="ltx_text ltx_font_smallcaps">Introduction</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S2" title="In Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">II </span><span class="ltx_text ltx_font_smallcaps">Related Work</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S3" title="In Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">III </span><span class="ltx_text ltx_font_smallcaps">Problem Description And Dataset</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S3.SS1" title="In III Problem Description And Dataset ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-A</span> </span><span class="ltx_text ltx_font_italic">Problem Description</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S3.SS2" title="In III Problem Description And Dataset ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-B</span> </span><span class="ltx_text ltx_font_italic">Dataset</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S4" title="In Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">IV </span><span class="ltx_text ltx_font_smallcaps">Method</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S4.SS1" title="In IV Method ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">IV-A</span> </span><span class="ltx_text ltx_font_italic">Data selection and preprocessing</span></span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S4.SS1.SSS1" title="In IV-A Data selection and preprocessing ‣ IV Method ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">IV-A</span>1 </span>App sequence</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S4.SS1.SSS2" title="In IV-A Data selection and preprocessing ‣ IV Method ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">IV-A</span>2 </span>User IDs</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S4.SS1.SSS3" title="In IV-A Data selection and preprocessing ‣ IV Method ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">IV-A</span>3 </span>POIs</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S4.SS1.SSS4" title="In IV-A Data selection and preprocessing ‣ IV Method ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">IV-A</span>4 </span>Time data</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S4.SS2" title="In IV Method ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">IV-B</span> </span><span class="ltx_text ltx_font_italic">Appformer Framework Overview</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S4.SS3" title="In IV Method ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">IV-C</span> </span><span class="ltx_text ltx_font_italic">Multi-Modal Data Progressive Fusion Module</span></span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S4.SS3.SSS1" title="In IV-C Multi-Modal Data Progressive Fusion Module ‣ IV Method ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">IV-C</span>1 </span>Data Fusion for Encoder</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S4.SS3.SSS2" title="In IV-C Multi-Modal Data Progressive Fusion Module ‣ IV Method ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">IV-C</span>2 </span>Data Fusion for Decoder</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S4.SS4" title="In IV Method ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">IV-D</span> </span><span class="ltx_text ltx_font_italic">Feature Extraction Module</span></span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S4.SS4.SSS1" title="In IV-D Feature Extraction Module ‣ IV Method ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">IV-D</span>1 </span>Encoder and Decoder Architecture</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S4.SS4.SSS2" title="In IV-D Feature Extraction Module ‣ IV Method ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">IV-D</span>2 </span>Differentiating Between Encoder and Decoder Inputs</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S4.SS4.SSS3" title="In IV-D Feature Extraction Module ‣ IV Method ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">IV-D</span>3 </span>Modular Design Analysis</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S5" title="In Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">V </span><span class="ltx_text ltx_font_smallcaps">Experiments</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S5.SS1" title="In V Experiments ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">V-A</span> </span><span class="ltx_text ltx_font_italic">Evaluation metrics</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S5.SS2" title="In V Experiments ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">V-B</span> </span><span class="ltx_text ltx_font_italic">Baselines</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S5.SS3" title="In V Experiments ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">V-C</span> </span><span class="ltx_text ltx_font_italic">Experimental setup</span></span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S5.SS3.SSS1" title="In V-C Experimental setup ‣ V Experiments ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">V-C</span>1 </span>Model parameter settings</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S5.SS3.SSS2" title="In V-C Experimental setup ‣ V Experiments ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">V-C</span>2 </span>Dataset cleaning and partitioning</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S6" title="In Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">VI </span><span class="ltx_text ltx_font_smallcaps">Result</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S6.SS1" title="In VI Result ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">VI-A</span> </span><span class="ltx_text ltx_font_italic">Comparison with baselines</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S6.SS2" title="In VI Result ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">VI-B</span> </span><span class="ltx_text ltx_font_italic">Module ablation study</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S6.SS3" title="In VI Result ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">VI-C</span> </span><span class="ltx_text ltx_font_italic">Time encoding comparison experiment</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S6.SS4" title="In VI Result ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">VI-D</span> </span><span class="ltx_text ltx_font_italic">Ablation experiment of Appformer Decoder input</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S6.SS5" title="In VI Result ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">VI-E</span> </span><span class="ltx_text ltx_font_italic">Feature Extraction Module comparison experiment</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S6.SS6" title="In VI Result ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">VI-F</span> </span><span class="ltx_text ltx_font_italic">Clustering experiment on the POI data</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S7" title="In Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">VII </span><span class="ltx_text ltx_font_smallcaps">Conclusion</span></span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Chuike Sun, Junzhou Chen, Yue Zhao, Hao Han, Ruihai Jing, Guang Tan, and Di Wu
</span><span class="ltx_author_notes">Corresponding author: Junzhou Chen.Chuike Sun, Junzhou Chen, Yue Zhao, and Guang Tan are with School of Intelligent Systems Engineering, Shenzhen Campus of Sun Yat-sen University, No. 66, Gongchang Road, Guangming District, Shenzhen, Guangdong 518107, P.R. China (e-mail: sunchk3@mail2.sysu.edu.cn; chenjunzhou@mail.sysu.edu.cn; zhaoy376@mail2.sysu.edu.cn; tanguang@mail.sysu.edu.cn).Hao Han and Ruihai Jing are with Transsion Holdings Co., Ltd, Shanghai 201203, China(e-mail: hao.han@transsion.com; ruihai.jing@transsion.com).Di Wu is with the School of Computer Science and Engineering, Sun Yat-sen University, Guangzhou, 510006, China, and also with the Guangdong Key Laboratory of Big Data Analysis and Processing, Guangdong 510006, China (e-mail: wudi27@mail.sysu.edu.cn). </span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id1.id1">This article presents Appformer, a novel mobile application prediction framework inspired by the efficiency of Transformer-like architectures in processing sequential data through self-attention mechanisms. Combining a Multi-Modal Data Progressive Fusion Module with a sophisticated Feature Extraction Module, Appformer leverages the synergies of multi-modal data fusion and data mining techniques while maintaining user privacy. The framework employs Points of Interest (POIs) associated with base stations, optimizing them through comprehensive comparative experiments to identify the most effective clustering method. These refined inputs are seamlessly integrated into the initial phases of cross-modal data fusion, where temporal units are encoded via word embeddings and subsequently merged in later stages. The Feature Extraction Module, employing Transformer-like architectures specialized for time series analysis, adeptly distils comprehensive features. It meticulously fine-tunes the outputs from the fusion module, facilitating the extraction of high-calibre, multi-modal features, thus guaranteeing a robust and efficient extraction process. Extensive experimental validation confirms Appformer’s effectiveness, attaining state-of-the-art (SOTA) metrics in mobile app usage prediction, thereby signifying a notable progression in this field.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Index Terms: </h6>
App Usage Prediction, Transformer, Multi-Modal Data Fusion, Feature Extraction, Data Mining.

</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">I </span><span class="ltx_text ltx_font_smallcaps" id="S1.1.1">Introduction</span>
</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">In today’s digital era, mobile applications have become integral to people’s lives, enabling interactions in various daily activities<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib1" title=""><span class="ltx_text" style="font-size:80%;">1</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib2" title=""><span class="ltx_text" style="font-size:80%;">2</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib3" title=""><span class="ltx_text" style="font-size:80%;">3</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib4" title=""><span class="ltx_text" style="font-size:80%;">4</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib5" title=""><span class="ltx_text" style="font-size:80%;">5</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib6" title=""><span class="ltx_text" style="font-size:80%;">6</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib7" title=""><span class="ltx_text" style="font-size:80%;">7</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib8" title=""><span class="ltx_text" style="font-size:80%;">8</span></a>]</cite>. By analyzing interactive information, we can learn the behaviors and preferences of different users, aid in understanding user needs, and provide personalized services to improve user experience. Accurately predicting users’ app usage has become a prominent area of research<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib9" title=""><span class="ltx_text" style="font-size:80%;">9</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib10" title=""><span class="ltx_text" style="font-size:80%;">10</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib11" title=""><span class="ltx_text" style="font-size:80%;">11</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib12" title=""><span class="ltx_text" style="font-size:80%;">12</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib13" title=""><span class="ltx_text" style="font-size:80%;">13</span></a>]</cite>, forming the foundation for personalized recommendation systems and significantly impacting mobile app development and user experience enhancement.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">However, predicting mobile app usage behavior remains a formidable challenge, as it is influenced by a multitude of factors including time, spatial context, and individual preferences. The associated data often display attributes like brevity, high dimensionality, discreteness, and multi-modality. Traditional prediction methodologies frequently struggle with issues such as data sparsity, abstract feature extraction, and maintaining accuracy in model predictions. Recently, deep learning techniques, particularly those employing attention mechanisms, have emerged as a significant advancement in the realm of mobile application prediction, offering effective solutions to these intricate challenges.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">In the realm of mobile app prediction, our research endeavors to address three pivotal challenges:</p>
<ol class="ltx_enumerate" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i1.p1.1.1">Accurately representing core data:</span> This involves user IDs, spatiotemporal information (time and location of app usage), and app usage history sequences. We meticulously encode these components to capture their nuances.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i2.p1.1.1">Efficiently integrating multimodal data:</span> We employ advanced multimodal data fusion techniques to seamlessly integrate the encoded data, fostering a synergistic synthesis of information.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i3.p1.1.1">Enhancing feature extraction:</span> We aim to empower prediction models to distill insightful and discriminative features from the unified dataset, crucial for accurate and robust predictions.</p>
</div>
</li>
</ol>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">To address these challenges, our research presents innovative solutions aimed at enhancing the prediction efficiency for mobile application usage. The key contributions are summarized as follows:</p>
</div>
<div class="ltx_para" id="S1.p5">
<ul class="ltx_itemize" id="S1.I2">
<li class="ltx_item" id="S1.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I2.i1.p1">
<p class="ltx_p" id="S1.I2.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I2.i1.p1.1.1">Appformer Framework:</span> We introduce the Appformer framework, leveraging attention mechanisms and Transformer architectures to significantly enhance data fusion and feature extraction. It comprises two synergistic components: a Multi-Modal Data Progressive Fusion Module and a Feature Extraction Module. The former adeptly combines encoded data from diverse sources using cross-modal fusion technology, setting a strong base for data synthesis. The latter, with its Encoder-Decoder architecture, efficiently extracts temporal features from time-series data. Adjustments to the Encoder and Decoder inputs have been made to optimize multi-modal feature extraction. Together, these modules boost the framework’s ability to deliver accurate and efficient application predictions.</p>
</div>
</li>
<li class="ltx_item" id="S1.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I2.i2.p1">
<p class="ltx_p" id="S1.I2.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I2.i2.p1.1.1">Multi-modal Data Progressive Fusion:</span> At the heart of Appformer’s fusion module is a Cross-Modal Data Fusion Module, built on cross-modal and self-attention techniques. It can seamlessly integrate data from application sequences, Points of Interest (POIs), user IDs, and time, each treated with a tailored, phased fusion process. This approach ensures data integrity, fosters data synthesis, and significantly improves feature extraction and analysis quality.</p>
</div>
</li>
<li class="ltx_item" id="S1.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I2.i3.p1">
<p class="ltx_p" id="S1.I2.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I2.i3.p1.1.1">Enhanced Preprocessing of Location and Time Data:</span> Acknowledging the critical role of location and time data in mobile application prediction, we have advanced their preprocessing. For location data, we prioritize user privacy, selecting base station-related POI data, and apply clustering to refine its representation. This optimized data feeds into the early stages of our fusion process. Time data undergoes word embedding and concatenation before joining the fusion later on, ensuring a comprehensive data integration.</p>
</div>
</li>
<li class="ltx_item" id="S1.I2.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I2.i4.p1">
<p class="ltx_p" id="S1.I2.i4.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I2.i4.p1.1.1">Validation through Extensive Experiments:</span> Our experiments affirm Appformer’s state-of-the-art performance on several metrics. Tested across different data processing and partitioning approaches on a unified dataset, our framework achieved Hit@1 scores of 31.92% and 42.68%. These scores represent improvements of 4.75% and 7.89% over existing methods, showcasing our proposed framework’s superior capability in predicting mobile application usage.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">II </span><span class="ltx_text ltx_font_smallcaps" id="S2.1.1">Related Work</span>
</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">The application prediction problem involves using the historical information of application usage to forecast the potential applications that users may use in the future. Through literature research, we have established a strong correlation between time information, user information, location information, and application usage. Based on this, we have decomposed the application prediction problem into three parts: mining and expression of core data, fusion of multi-modal data, and feature extraction network. Each of these parts has been elaborated on in detail.</p>
</div>
<div class="ltx_para" id="S2.p2">
<p class="ltx_p" id="S2.p2.1"><span class="ltx_text ltx_font_bold" id="S2.p2.1.1">Correlation analysis between core data and application prediction:</span> Wang <span class="ltx_text ltx_font_italic" id="S2.p2.1.2">et al.<cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_upright" id="S2.p2.1.2.1.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib14" title=""><span class="ltx_text" style="font-size:80%;">14</span></a><span class="ltx_text ltx_font_upright" id="S2.p2.1.2.2.2">]</span></cite></span> found not only a strong correlation between the locations accessed by users on their mobile devices and the applications they use but also discovered that users tend to use different apps during various time periods. Nadai <span class="ltx_text ltx_font_italic" id="S2.p2.1.3">et al.<cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_upright" id="S2.p2.1.3.1.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib15" title=""><span class="ltx_text" style="font-size:80%;">15</span></a><span class="ltx_text ltx_font_upright" id="S2.p2.1.3.2.2">]</span></cite></span> significant disparities were observed in how different users engage with apps. Moreover, user app preferences were found to evolve over time. Xia <span class="ltx_text ltx_font_italic" id="S2.p2.1.4">et al.<cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_upright" id="S2.p2.1.4.1.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib16" title=""><span class="ltx_text" style="font-size:80%;">16</span></a><span class="ltx_text ltx_font_upright" id="S2.p2.1.4.2.2">]</span></cite></span> analyzed a large-scale real-world dataset of app usage and found that smartphone app usage exhibits spatio-temporal correlation and personalization. Garrido <span class="ltx_text ltx_font_italic" id="S2.p2.1.5">et al.<cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_upright" id="S2.p2.1.5.1.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib17" title=""><span class="ltx_text" style="font-size:80%;">17</span></a><span class="ltx_text ltx_font_upright" id="S2.p2.1.5.2.2">]</span></cite></span> discovered that the physical locations within a user’s city can influence their app usage patterns significantly. Tian <span class="ltx_text ltx_font_italic" id="S2.p2.1.6">et al.<cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_upright" id="S2.p2.1.6.1.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib18" title=""><span class="ltx_text" style="font-size:80%;">18</span></a><span class="ltx_text ltx_font_upright" id="S2.p2.1.6.2.2">]</span></cite></span> found that users with different characteristics have different app preferences and that users use different apps during various time periods. These studies demonstrate a strong correlation between spatio-temporal information, user information, and application usage. We need to make rational use of these data for app prediction.</p>
</div>
<div class="ltx_para" id="S2.p3">
<p class="ltx_p" id="S2.p3.1"><span class="ltx_text ltx_font_bold" id="S2.p3.1.1">Mining and expression of core data:</span> App prediction involves data encoding, similar to word embedding in Natural Language Processing (NLP). Word embedding is a significant research area, converting words into high-dimensional vectors to enhance the understanding of natural language. One-hot encoding is a simple and easy-to-implement method, but it fails to capture semantic relationships<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib19" title=""><span class="ltx_text" style="font-size:80%;">19</span></a>]</cite>. The Word2Vec model proposed by Mikolov et al.<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib20" title=""><span class="ltx_text" style="font-size:80%;">20</span></a>]</cite> was a major breakthrough, introducing efficient training algorithms. The GloVe model proposed by Pennington et al.<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib21" title=""><span class="ltx_text" style="font-size:80%;">21</span></a>]</cite> further improved word embeddings by combining global and local information. FastText, proposed by Joulin et al.<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib22" title=""><span class="ltx_text" style="font-size:80%;">22</span></a>]</cite>, utilizes deep learning methods and can handle both word-level and subword-level information. We can construct data processing methods for relevant data in app prediction based on the word embedding methods in NLP.</p>
</div>
<div class="ltx_para" id="S2.p4">
<p class="ltx_p" id="S2.p4.1"><span class="ltx_text ltx_font_bold" id="S2.p4.1.1">Fusion of multi-modal data:</span> In the field of application prediction, the integration of encoded multi-modal data has become essential. Multi-modal data fusion is a critical process that helps capture the correspondence between different types of contextual information data, such as user personalized features, space, time, and historical app sequences, reducing information redundancy and enhancing generalization. It can significantly improve the accuracy and robustness of application prediction models.</p>
</div>
<div class="ltx_para" id="S2.p5">
<p class="ltx_p" id="S2.p5.1">In recent years, there has been a surge in research and applications related to multi-modal data fusion. Performing multi-modal data fusion requires building models that are adept at handling and associating information from multiple sources<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib23" title=""><span class="ltx_text" style="font-size:80%;">23</span></a>]</cite><cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib24" title=""><span class="ltx_text" style="font-size:80%;">24</span></a>]</cite>. Traditional methods for multi-modal data fusion include co-training algorithms<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib25" title=""><span class="ltx_text" style="font-size:80%;">25</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib26" title=""><span class="ltx_text" style="font-size:80%;">26</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib27" title=""><span class="ltx_text" style="font-size:80%;">27</span></a>]</cite>, co-regularization algorithms<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib28" title=""><span class="ltx_text" style="font-size:80%;">28</span></a>]</cite><cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib29" title=""><span class="ltx_text" style="font-size:80%;">29</span></a>]</cite>, marginal consistency algorithms<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib30" title=""><span class="ltx_text" style="font-size:80%;">30</span></a>]</cite><cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib31" title=""><span class="ltx_text" style="font-size:80%;">31</span></a>]</cite>, and multiple kernel learning (MKL)<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib32" title=""><span class="ltx_text" style="font-size:80%;">32</span></a>]</cite>.</p>
</div>
<div class="ltx_para" id="S2.p6">
<p class="ltx_p" id="S2.p6.1">Furthermore, more complex techniques have been used for multi-modal data fusion. These include variants of deep Boltzmann machines for modeling the joint distribution of different modalities<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib33" title=""><span class="ltx_text" style="font-size:80%;">33</span></a>]</cite><cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib34" title=""><span class="ltx_text" style="font-size:80%;">34</span></a>]</cite>, extensions of classical autoencoders for discovering correlations between hidden representations of two modalities<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib35" title=""><span class="ltx_text" style="font-size:80%;">35</span></a>]</cite><cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib36" title=""><span class="ltx_text" style="font-size:80%;">36</span></a>]</cite>, nonlinear extensions of canonical correlation analysis (CCA) using deep neural networks<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib37" title=""><span class="ltx_text" style="font-size:80%;">37</span></a>]</cite>, and architectures based on convolutional neural networks (CNN) that excel at combining information from multiple sources<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib38" title=""><span class="ltx_text" style="font-size:80%;">38</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib39" title=""><span class="ltx_text" style="font-size:80%;">39</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib40" title=""><span class="ltx_text" style="font-size:80%;">40</span></a>]</cite>.</p>
</div>
<div class="ltx_para" id="S2.p7">
<p class="ltx_p" id="S2.p7.1">In addition, groundbreaking approaches have emerged, further enriching the field of application prediction. For example, the Multi-modal Transformer (MulT) technique introduced by Tsai <span class="ltx_text ltx_font_italic" id="S2.p7.1.1">et al.<cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_upright" id="S2.p7.1.1.1.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib41" title=""><span class="ltx_text" style="font-size:80%;">41</span></a><span class="ltx_text ltx_font_upright" id="S2.p7.1.1.2.2">]</span></cite></span>, the Multi-modal Temporal Graph Attention Network (MTGAT) proposed by Yang <span class="ltx_text ltx_font_italic" id="S2.p7.1.2">et al.<cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_upright" id="S2.p7.1.2.1.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib42" title=""><span class="ltx_text" style="font-size:80%;">42</span></a><span class="ltx_text ltx_font_upright" id="S2.p7.1.2.2.2">]</span></cite></span>, spatial fusion encoding developed by Wang <span class="ltx_text ltx_font_italic" id="S2.p7.1.3">et al.<cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_upright" id="S2.p7.1.3.1.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib43" title=""><span class="ltx_text" style="font-size:80%;">43</span></a><span class="ltx_text ltx_font_upright" id="S2.p7.1.3.2.2">]</span></cite></span>, the Multi-modal Attention based Feature Fusion (MAT) by Islam <span class="ltx_text ltx_font_italic" id="S2.p7.1.4">et al.<cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_upright" id="S2.p7.1.4.1.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib44" title=""><span class="ltx_text" style="font-size:80%;">44</span></a><span class="ltx_text ltx_font_upright" id="S2.p7.1.4.2.2">]</span></cite></span>, and the Modality-Invariant Cross-modal Attention (MICA) proposed by Liang <span class="ltx_text ltx_font_italic" id="S2.p7.1.5">et al.<cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_upright" id="S2.p7.1.5.1.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib45" title=""><span class="ltx_text" style="font-size:80%;">45</span></a><span class="ltx_text ltx_font_upright" id="S2.p7.1.5.2.2">]</span></cite></span>.</p>
</div>
<figure class="ltx_figure" id="S2.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="202" id="S2.F1.g1" src="x1.png" width="415"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Problem definition and relevant feature data for app usage prediction.</figcaption>
</figure>
<div class="ltx_para" id="S2.p8">
<p class="ltx_p" id="S2.p8.1"><span class="ltx_text ltx_font_bold" id="S2.p8.1.1">Feature extraction network:</span> Feature extraction network is a type of network structure widely used in deep learning techniques in recent years. Here are some examples of related feature extraction networks:</p>
</div>
<div class="ltx_para" id="S2.p9">
<p class="ltx_p" id="S2.p9.1">Lee <span class="ltx_text ltx_font_italic" id="S2.p9.1.1">et al.<cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_upright" id="S2.p9.1.1.1.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib46" title=""><span class="ltx_text" style="font-size:80%;">46</span></a><span class="ltx_text ltx_font_upright" id="S2.p9.1.1.2.2">]</span></cite></span> employed a stacked Long-Short Term Memory (LSTM) architecture, a sequence-based deep learning framework utilized for training prediction models without the need to calculate transition probabilities. Zhao <span class="ltx_text ltx_font_italic" id="S2.p9.1.2">et al.<cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_upright" id="S2.p9.1.2.1.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib47" title=""><span class="ltx_text" style="font-size:80%;">47</span></a><span class="ltx_text ltx_font_upright" id="S2.p9.1.2.2.2">]</span></cite></span> introduced a novel framework for predicting application usage called AppUsage2Vec, inspired by Doc2Vec. This framework models application usage records by taking into account the contributions of various applications, personalized user features, and temporal context. By incorporating an application attention mechanism, it evaluates the impact of each application on the target application. User-specific features in application usage are learned using a dual-DNN (Deep Neural Network) module. Xia <span class="ltx_text ltx_font_italic" id="S2.p9.1.3">et al.<cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_upright" id="S2.p9.1.3.1.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib16" title=""><span class="ltx_text" style="font-size:80%;">16</span></a><span class="ltx_text ltx_font_upright" id="S2.p9.1.3.2.2">]</span></cite></span> presented a new framework for predicting application usage known as DeepApp. This framework accomplishes context-aware prediction through the use of multi-task learning<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib48" title=""><span class="ltx_text" style="font-size:80%;">48</span></a>]</cite>. Ouyang <span class="ltx_text ltx_font_italic" id="S2.p9.1.4">et al.<cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_upright" id="S2.p9.1.4.1.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib49" title=""><span class="ltx_text" style="font-size:80%;">49</span></a><span class="ltx_text ltx_font_upright" id="S2.p9.1.4.2.2">]</span></cite></span> proposed a new model, the dynamic usage graph network (DUGN), to explicitly model complex app correlations using a dynamic graph structure for learning user interest dynamics. Moreira <span class="ltx_text ltx_font_italic" id="S2.p9.1.5">et al.<cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_upright" id="S2.p9.1.5.1.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib50" title=""><span class="ltx_text" style="font-size:80%;">50</span></a><span class="ltx_text ltx_font_upright" id="S2.p9.1.5.2.2">]</span></cite></span> developed a prediction model called Natural App Processing (NAP), which is inspired by language modeling (LM). The NAP deep learning framework is composed of LSTM layer, dropout layer, and softmax layer, which are used to make application prediction. Furthermore, Solomon <span class="ltx_text ltx_font_italic" id="S2.p9.1.6">et al.<cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_upright" id="S2.p9.1.6.1.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib51" title=""><span class="ltx_text" style="font-size:80%;">51</span></a><span class="ltx_text ltx_font_upright" id="S2.p9.1.6.2.2">]</span></cite></span> proposed a deep learning framework for predicting application usage. This framework includes Gate Recurrent Unit (GRU), attention layer, and softmax layer. Shen <span class="ltx_text ltx_font_italic" id="S2.p9.1.7">et al.<cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text ltx_font_upright" id="S2.p9.1.7.1.1">[</span><a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib52" title=""><span class="ltx_text" style="font-size:80%;">52</span></a><span class="ltx_text ltx_font_upright" id="S2.p9.1.7.2.2">]</span></cite></span> introduced a deep reinforcement learning framework, DeepAPP, that learns a model-free predictive neural network from past app usage data. They also devised an online updating strategy for adapting the network to fluctuating app usage behavior.</p>
</div>
<div class="ltx_para" id="S2.p10">
<p class="ltx_p" id="S2.p10.1"><span class="ltx_text ltx_font_bold" id="S2.p10.1.1">Limitations of existing work:</span> Through comprehensive literature research, we have identified shortcomings in current prediction methods. Firstly, regarding the representation of core data, existing methods often lack the necessary depth and breadth in processing such data, failing to fully and accurately reveal the true implications of the data. This could lead to misinterpretation and misuse of data, thereby affecting the accuracy of predictions. Secondly, concerning data fusion, current strategies for data fusion are often too simplified or overly complex, failing to properly handle and integrate multimodal data. This could result in the loss of important information or interference from irrelevant information, reducing prediction accuracy. Lastly, from the perspective of feature extraction networks, existing networks often have limited capabilities, unable to effectively extract useful features from raw data. This could lead to inaccurate and unstable predictions, impacting user experience. These issues have severely limited the performance and effectiveness of current methods in the field of application prediction. Therefore, we need to build a new system to address these problems and improve the accuracy of predictions and user experience.</p>
</div>
<figure class="ltx_figure" id="S2.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="416" id="S2.F2.g1" src="x2.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Data preprocessing for app usage prediction.</figcaption>
</figure>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">III </span><span class="ltx_text ltx_font_smallcaps" id="S3.1.1">Problem Description And Dataset</span>
</h2>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S3.SS1.5.1.1">III-A</span> </span><span class="ltx_text ltx_font_italic" id="S3.SS1.6.2">Problem Description</span>
</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">As illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S2.F1" title="Figure 1 ‣ II Related Work ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_tag">1</span></a>, our dataset consists of various feature data types. The application sequence is highlighted in a red box (App_seq), user IDs in a purple box (User IDs), the timestamp sequence of application starts in a green box (Time_seq), the base station ID interacting with the mobile phone during application usage in a yellow box (Base station IDs), and the Points of Interest (POIs) data corresponding to the base station’s coverage sector in a grey sector box (POIs). The POI data, indicating the presence of different facilities near a base station, plays a vital role in defining the functionality and appeal of specific locations <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib53" title=""><span class="ltx_text" style="font-size:80%;">53</span></a>]</cite>.</p>
</div>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.1">Our goal is to develop a predictive model <math alttext="f(x)" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1"><semantics id="S3.SS1.p2.1.m1.1a"><mrow id="S3.SS1.p2.1.m1.1.2" xref="S3.SS1.p2.1.m1.1.2.cmml"><mi id="S3.SS1.p2.1.m1.1.2.2" xref="S3.SS1.p2.1.m1.1.2.2.cmml">f</mi><mo id="S3.SS1.p2.1.m1.1.2.1" xref="S3.SS1.p2.1.m1.1.2.1.cmml">⁢</mo><mrow id="S3.SS1.p2.1.m1.1.2.3.2" xref="S3.SS1.p2.1.m1.1.2.cmml"><mo id="S3.SS1.p2.1.m1.1.2.3.2.1" stretchy="false" xref="S3.SS1.p2.1.m1.1.2.cmml">(</mo><mi id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">x</mi><mo id="S3.SS1.p2.1.m1.1.2.3.2.2" stretchy="false" xref="S3.SS1.p2.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><apply id="S3.SS1.p2.1.m1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.2"><times id="S3.SS1.p2.1.m1.1.2.1.cmml" xref="S3.SS1.p2.1.m1.1.2.1"></times><ci id="S3.SS1.p2.1.m1.1.2.2.cmml" xref="S3.SS1.p2.1.m1.1.2.2">𝑓</ci><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">f(x)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.1d">italic_f ( italic_x )</annotation></semantics></math> capable of precisely predicting the next application a user is likely to use. This model is designed to rank the likelihood of potential next apps in a descending order, starting with the most probable choice as Top1, followed by the next most likely options as Top2, Top3, and so forth. The mathematical representation is illustrated by the following equation:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="A(n+1)=f\left(\mathbf{X}(n-m+1:n)\right)" class="ltx_math_unparsed" display="block" id="S3.E1.m1.1"><semantics id="S3.E1.m1.1a"><mrow id="S3.E1.m1.1b"><mi id="S3.E1.m1.1.1">A</mi><mrow id="S3.E1.m1.1.2"><mo id="S3.E1.m1.1.2.1" stretchy="false">(</mo><mi id="S3.E1.m1.1.2.2">n</mi><mo id="S3.E1.m1.1.2.3">+</mo><mn id="S3.E1.m1.1.2.4">1</mn><mo id="S3.E1.m1.1.2.5" stretchy="false">)</mo></mrow><mo id="S3.E1.m1.1.3">=</mo><mi id="S3.E1.m1.1.4">f</mi><mrow id="S3.E1.m1.1.5"><mo id="S3.E1.m1.1.5.1">(</mo><mi id="S3.E1.m1.1.5.2">𝐗</mi><mrow id="S3.E1.m1.1.5.3"><mo id="S3.E1.m1.1.5.3.1" stretchy="false">(</mo><mi id="S3.E1.m1.1.5.3.2">n</mi><mo id="S3.E1.m1.1.5.3.3">−</mo><mi id="S3.E1.m1.1.5.3.4">m</mi><mo id="S3.E1.m1.1.5.3.5">+</mo><mn id="S3.E1.m1.1.5.3.6">1</mn><mo id="S3.E1.m1.1.5.3.7" lspace="0.278em" rspace="0.278em">:</mo><mi id="S3.E1.m1.1.5.3.8">n</mi><mo id="S3.E1.m1.1.5.3.9" stretchy="false">)</mo></mrow><mo id="S3.E1.m1.1.5.4">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.E1.m1.1c">A(n+1)=f\left(\mathbf{X}(n-m+1:n)\right)</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.1d">italic_A ( italic_n + 1 ) = italic_f ( bold_X ( italic_n - italic_m + 1 : italic_n ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS1.p3">
<p class="ltx_p" id="S3.SS1.p3.1">where <math alttext="\mathbf{X}(n-m+1:n)" class="ltx_math_unparsed" display="inline" id="S3.SS1.p3.1.m1.1"><semantics id="S3.SS1.p3.1.m1.1a"><mrow id="S3.SS1.p3.1.m1.1b"><mi id="S3.SS1.p3.1.m1.1.1">𝐗</mi><mrow id="S3.SS1.p3.1.m1.1.2"><mo id="S3.SS1.p3.1.m1.1.2.1" stretchy="false">(</mo><mi id="S3.SS1.p3.1.m1.1.2.2">n</mi><mo id="S3.SS1.p3.1.m1.1.2.3">−</mo><mi id="S3.SS1.p3.1.m1.1.2.4">m</mi><mo id="S3.SS1.p3.1.m1.1.2.5">+</mo><mn id="S3.SS1.p3.1.m1.1.2.6">1</mn><mo id="S3.SS1.p3.1.m1.1.2.7" lspace="0.278em" rspace="0.278em">:</mo><mi id="S3.SS1.p3.1.m1.1.2.8">n</mi><mo id="S3.SS1.p3.1.m1.1.2.9" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">\mathbf{X}(n-m+1:n)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.1.m1.1d">bold_X ( italic_n - italic_m + 1 : italic_n )</annotation></semantics></math> represents a multi-dimensional feature sequence, incorporating essential historical data required for prediction. This encompasses sequences of app IDs, user IDs, timestamps, base station IDs, and POI vectors, seamlessly integrated into a coherent structure for the predictive model. The configuration of this sequence is defined as follows:</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S3.E2">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E2X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\mathbf{X}(n-m+1:n)=" class="ltx_math_unparsed" display="inline" id="S3.E2X.2.1.1.m1.1"><semantics id="S3.E2X.2.1.1.m1.1a"><mrow id="S3.E2X.2.1.1.m1.1b"><mi id="S3.E2X.2.1.1.m1.1.1">𝐗</mi><mrow id="S3.E2X.2.1.1.m1.1.2"><mo id="S3.E2X.2.1.1.m1.1.2.1" stretchy="false">(</mo><mi id="S3.E2X.2.1.1.m1.1.2.2">n</mi><mo id="S3.E2X.2.1.1.m1.1.2.3">−</mo><mi id="S3.E2X.2.1.1.m1.1.2.4">m</mi><mo id="S3.E2X.2.1.1.m1.1.2.5">+</mo><mn id="S3.E2X.2.1.1.m1.1.2.6">1</mn><mo id="S3.E2X.2.1.1.m1.1.2.7" lspace="0.278em" rspace="0.278em">:</mo><mi id="S3.E2X.2.1.1.m1.1.2.8">n</mi><mo id="S3.E2X.2.1.1.m1.1.2.9" stretchy="false">)</mo></mrow><mo id="S3.E2X.2.1.1.m1.1.3">=</mo></mrow><annotation encoding="application/x-tex" id="S3.E2X.2.1.1.m1.1c">\displaystyle\mathbf{X}(n-m+1:n)=</annotation><annotation encoding="application/x-llamapun" id="S3.E2X.2.1.1.m1.1d">bold_X ( italic_n - italic_m + 1 : italic_n ) =</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(2)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E2Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\left\{(A(i),U(i),T(i),B(i),P(i))\mid i=n-m+1,\ldots,n\right\}" class="ltx_Math" display="inline" id="S3.E2Xa.2.1.1.m1.9"><semantics id="S3.E2Xa.2.1.1.m1.9a"><mrow id="S3.E2Xa.2.1.1.m1.9.9.2" xref="S3.E2Xa.2.1.1.m1.9.9.3.cmml"><mo id="S3.E2Xa.2.1.1.m1.9.9.2.3" xref="S3.E2Xa.2.1.1.m1.9.9.3.1.cmml">{</mo><mrow id="S3.E2Xa.2.1.1.m1.8.8.1.1.5" xref="S3.E2Xa.2.1.1.m1.8.8.1.1.6.cmml"><mo id="S3.E2Xa.2.1.1.m1.8.8.1.1.5.6" stretchy="false" xref="S3.E2Xa.2.1.1.m1.8.8.1.1.6.cmml">(</mo><mrow id="S3.E2Xa.2.1.1.m1.8.8.1.1.1.1" xref="S3.E2Xa.2.1.1.m1.8.8.1.1.1.1.cmml"><mi id="S3.E2Xa.2.1.1.m1.8.8.1.1.1.1.2" xref="S3.E2Xa.2.1.1.m1.8.8.1.1.1.1.2.cmml">A</mi><mo id="S3.E2Xa.2.1.1.m1.8.8.1.1.1.1.1" xref="S3.E2Xa.2.1.1.m1.8.8.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.E2Xa.2.1.1.m1.8.8.1.1.1.1.3.2" xref="S3.E2Xa.2.1.1.m1.8.8.1.1.1.1.cmml"><mo id="S3.E2Xa.2.1.1.m1.8.8.1.1.1.1.3.2.1" stretchy="false" xref="S3.E2Xa.2.1.1.m1.8.8.1.1.1.1.cmml">(</mo><mi id="S3.E2Xa.2.1.1.m1.1.1" xref="S3.E2Xa.2.1.1.m1.1.1.cmml">i</mi><mo id="S3.E2Xa.2.1.1.m1.8.8.1.1.1.1.3.2.2" stretchy="false" xref="S3.E2Xa.2.1.1.m1.8.8.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E2Xa.2.1.1.m1.8.8.1.1.5.7" xref="S3.E2Xa.2.1.1.m1.8.8.1.1.6.cmml">,</mo><mrow id="S3.E2Xa.2.1.1.m1.8.8.1.1.2.2" xref="S3.E2Xa.2.1.1.m1.8.8.1.1.2.2.cmml"><mi id="S3.E2Xa.2.1.1.m1.8.8.1.1.2.2.2" xref="S3.E2Xa.2.1.1.m1.8.8.1.1.2.2.2.cmml">U</mi><mo id="S3.E2Xa.2.1.1.m1.8.8.1.1.2.2.1" xref="S3.E2Xa.2.1.1.m1.8.8.1.1.2.2.1.cmml">⁢</mo><mrow id="S3.E2Xa.2.1.1.m1.8.8.1.1.2.2.3.2" xref="S3.E2Xa.2.1.1.m1.8.8.1.1.2.2.cmml"><mo id="S3.E2Xa.2.1.1.m1.8.8.1.1.2.2.3.2.1" stretchy="false" xref="S3.E2Xa.2.1.1.m1.8.8.1.1.2.2.cmml">(</mo><mi id="S3.E2Xa.2.1.1.m1.2.2" xref="S3.E2Xa.2.1.1.m1.2.2.cmml">i</mi><mo id="S3.E2Xa.2.1.1.m1.8.8.1.1.2.2.3.2.2" stretchy="false" xref="S3.E2Xa.2.1.1.m1.8.8.1.1.2.2.cmml">)</mo></mrow></mrow><mo id="S3.E2Xa.2.1.1.m1.8.8.1.1.5.8" xref="S3.E2Xa.2.1.1.m1.8.8.1.1.6.cmml">,</mo><mrow id="S3.E2Xa.2.1.1.m1.8.8.1.1.3.3" xref="S3.E2Xa.2.1.1.m1.8.8.1.1.3.3.cmml"><mi id="S3.E2Xa.2.1.1.m1.8.8.1.1.3.3.2" xref="S3.E2Xa.2.1.1.m1.8.8.1.1.3.3.2.cmml">T</mi><mo id="S3.E2Xa.2.1.1.m1.8.8.1.1.3.3.1" xref="S3.E2Xa.2.1.1.m1.8.8.1.1.3.3.1.cmml">⁢</mo><mrow id="S3.E2Xa.2.1.1.m1.8.8.1.1.3.3.3.2" xref="S3.E2Xa.2.1.1.m1.8.8.1.1.3.3.cmml"><mo id="S3.E2Xa.2.1.1.m1.8.8.1.1.3.3.3.2.1" stretchy="false" xref="S3.E2Xa.2.1.1.m1.8.8.1.1.3.3.cmml">(</mo><mi id="S3.E2Xa.2.1.1.m1.3.3" xref="S3.E2Xa.2.1.1.m1.3.3.cmml">i</mi><mo id="S3.E2Xa.2.1.1.m1.8.8.1.1.3.3.3.2.2" stretchy="false" xref="S3.E2Xa.2.1.1.m1.8.8.1.1.3.3.cmml">)</mo></mrow></mrow><mo id="S3.E2Xa.2.1.1.m1.8.8.1.1.5.9" xref="S3.E2Xa.2.1.1.m1.8.8.1.1.6.cmml">,</mo><mrow id="S3.E2Xa.2.1.1.m1.8.8.1.1.4.4" xref="S3.E2Xa.2.1.1.m1.8.8.1.1.4.4.cmml"><mi id="S3.E2Xa.2.1.1.m1.8.8.1.1.4.4.2" xref="S3.E2Xa.2.1.1.m1.8.8.1.1.4.4.2.cmml">B</mi><mo id="S3.E2Xa.2.1.1.m1.8.8.1.1.4.4.1" xref="S3.E2Xa.2.1.1.m1.8.8.1.1.4.4.1.cmml">⁢</mo><mrow id="S3.E2Xa.2.1.1.m1.8.8.1.1.4.4.3.2" xref="S3.E2Xa.2.1.1.m1.8.8.1.1.4.4.cmml"><mo id="S3.E2Xa.2.1.1.m1.8.8.1.1.4.4.3.2.1" stretchy="false" xref="S3.E2Xa.2.1.1.m1.8.8.1.1.4.4.cmml">(</mo><mi id="S3.E2Xa.2.1.1.m1.4.4" xref="S3.E2Xa.2.1.1.m1.4.4.cmml">i</mi><mo id="S3.E2Xa.2.1.1.m1.8.8.1.1.4.4.3.2.2" stretchy="false" xref="S3.E2Xa.2.1.1.m1.8.8.1.1.4.4.cmml">)</mo></mrow></mrow><mo id="S3.E2Xa.2.1.1.m1.8.8.1.1.5.10" xref="S3.E2Xa.2.1.1.m1.8.8.1.1.6.cmml">,</mo><mrow id="S3.E2Xa.2.1.1.m1.8.8.1.1.5.5" xref="S3.E2Xa.2.1.1.m1.8.8.1.1.5.5.cmml"><mi id="S3.E2Xa.2.1.1.m1.8.8.1.1.5.5.2" xref="S3.E2Xa.2.1.1.m1.8.8.1.1.5.5.2.cmml">P</mi><mo id="S3.E2Xa.2.1.1.m1.8.8.1.1.5.5.1" xref="S3.E2Xa.2.1.1.m1.8.8.1.1.5.5.1.cmml">⁢</mo><mrow id="S3.E2Xa.2.1.1.m1.8.8.1.1.5.5.3.2" xref="S3.E2Xa.2.1.1.m1.8.8.1.1.5.5.cmml"><mo id="S3.E2Xa.2.1.1.m1.8.8.1.1.5.5.3.2.1" stretchy="false" xref="S3.E2Xa.2.1.1.m1.8.8.1.1.5.5.cmml">(</mo><mi id="S3.E2Xa.2.1.1.m1.5.5" xref="S3.E2Xa.2.1.1.m1.5.5.cmml">i</mi><mo id="S3.E2Xa.2.1.1.m1.8.8.1.1.5.5.3.2.2" stretchy="false" xref="S3.E2Xa.2.1.1.m1.8.8.1.1.5.5.cmml">)</mo></mrow></mrow><mo id="S3.E2Xa.2.1.1.m1.8.8.1.1.5.11" stretchy="false" xref="S3.E2Xa.2.1.1.m1.8.8.1.1.6.cmml">)</mo></mrow><mo fence="true" id="S3.E2Xa.2.1.1.m1.9.9.2.4" lspace="0em" rspace="0em" xref="S3.E2Xa.2.1.1.m1.9.9.3.1.cmml">∣</mo><mrow id="S3.E2Xa.2.1.1.m1.9.9.2.2" xref="S3.E2Xa.2.1.1.m1.9.9.2.2.cmml"><mi id="S3.E2Xa.2.1.1.m1.9.9.2.2.3" xref="S3.E2Xa.2.1.1.m1.9.9.2.2.3.cmml">i</mi><mo id="S3.E2Xa.2.1.1.m1.9.9.2.2.2" xref="S3.E2Xa.2.1.1.m1.9.9.2.2.2.cmml">=</mo><mrow id="S3.E2Xa.2.1.1.m1.9.9.2.2.1.1" xref="S3.E2Xa.2.1.1.m1.9.9.2.2.1.2.cmml"><mrow id="S3.E2Xa.2.1.1.m1.9.9.2.2.1.1.1" xref="S3.E2Xa.2.1.1.m1.9.9.2.2.1.1.1.cmml"><mrow id="S3.E2Xa.2.1.1.m1.9.9.2.2.1.1.1.2" xref="S3.E2Xa.2.1.1.m1.9.9.2.2.1.1.1.2.cmml"><mi id="S3.E2Xa.2.1.1.m1.9.9.2.2.1.1.1.2.2" xref="S3.E2Xa.2.1.1.m1.9.9.2.2.1.1.1.2.2.cmml">n</mi><mo id="S3.E2Xa.2.1.1.m1.9.9.2.2.1.1.1.2.1" xref="S3.E2Xa.2.1.1.m1.9.9.2.2.1.1.1.2.1.cmml">−</mo><mi id="S3.E2Xa.2.1.1.m1.9.9.2.2.1.1.1.2.3" xref="S3.E2Xa.2.1.1.m1.9.9.2.2.1.1.1.2.3.cmml">m</mi></mrow><mo id="S3.E2Xa.2.1.1.m1.9.9.2.2.1.1.1.1" xref="S3.E2Xa.2.1.1.m1.9.9.2.2.1.1.1.1.cmml">+</mo><mn id="S3.E2Xa.2.1.1.m1.9.9.2.2.1.1.1.3" xref="S3.E2Xa.2.1.1.m1.9.9.2.2.1.1.1.3.cmml">1</mn></mrow><mo id="S3.E2Xa.2.1.1.m1.9.9.2.2.1.1.2" xref="S3.E2Xa.2.1.1.m1.9.9.2.2.1.2.cmml">,</mo><mi id="S3.E2Xa.2.1.1.m1.6.6" mathvariant="normal" xref="S3.E2Xa.2.1.1.m1.6.6.cmml">…</mi><mo id="S3.E2Xa.2.1.1.m1.9.9.2.2.1.1.3" xref="S3.E2Xa.2.1.1.m1.9.9.2.2.1.2.cmml">,</mo><mi id="S3.E2Xa.2.1.1.m1.7.7" xref="S3.E2Xa.2.1.1.m1.7.7.cmml">n</mi></mrow></mrow><mo id="S3.E2Xa.2.1.1.m1.9.9.2.5" xref="S3.E2Xa.2.1.1.m1.9.9.3.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2Xa.2.1.1.m1.9b"><apply id="S3.E2Xa.2.1.1.m1.9.9.3.cmml" xref="S3.E2Xa.2.1.1.m1.9.9.2"><csymbol cd="latexml" id="S3.E2Xa.2.1.1.m1.9.9.3.1.cmml" xref="S3.E2Xa.2.1.1.m1.9.9.2.3">conditional-set</csymbol><vector id="S3.E2Xa.2.1.1.m1.8.8.1.1.6.cmml" xref="S3.E2Xa.2.1.1.m1.8.8.1.1.5"><apply id="S3.E2Xa.2.1.1.m1.8.8.1.1.1.1.cmml" xref="S3.E2Xa.2.1.1.m1.8.8.1.1.1.1"><times id="S3.E2Xa.2.1.1.m1.8.8.1.1.1.1.1.cmml" xref="S3.E2Xa.2.1.1.m1.8.8.1.1.1.1.1"></times><ci id="S3.E2Xa.2.1.1.m1.8.8.1.1.1.1.2.cmml" xref="S3.E2Xa.2.1.1.m1.8.8.1.1.1.1.2">𝐴</ci><ci id="S3.E2Xa.2.1.1.m1.1.1.cmml" xref="S3.E2Xa.2.1.1.m1.1.1">𝑖</ci></apply><apply id="S3.E2Xa.2.1.1.m1.8.8.1.1.2.2.cmml" xref="S3.E2Xa.2.1.1.m1.8.8.1.1.2.2"><times id="S3.E2Xa.2.1.1.m1.8.8.1.1.2.2.1.cmml" xref="S3.E2Xa.2.1.1.m1.8.8.1.1.2.2.1"></times><ci id="S3.E2Xa.2.1.1.m1.8.8.1.1.2.2.2.cmml" xref="S3.E2Xa.2.1.1.m1.8.8.1.1.2.2.2">𝑈</ci><ci id="S3.E2Xa.2.1.1.m1.2.2.cmml" xref="S3.E2Xa.2.1.1.m1.2.2">𝑖</ci></apply><apply id="S3.E2Xa.2.1.1.m1.8.8.1.1.3.3.cmml" xref="S3.E2Xa.2.1.1.m1.8.8.1.1.3.3"><times id="S3.E2Xa.2.1.1.m1.8.8.1.1.3.3.1.cmml" xref="S3.E2Xa.2.1.1.m1.8.8.1.1.3.3.1"></times><ci id="S3.E2Xa.2.1.1.m1.8.8.1.1.3.3.2.cmml" xref="S3.E2Xa.2.1.1.m1.8.8.1.1.3.3.2">𝑇</ci><ci id="S3.E2Xa.2.1.1.m1.3.3.cmml" xref="S3.E2Xa.2.1.1.m1.3.3">𝑖</ci></apply><apply id="S3.E2Xa.2.1.1.m1.8.8.1.1.4.4.cmml" xref="S3.E2Xa.2.1.1.m1.8.8.1.1.4.4"><times id="S3.E2Xa.2.1.1.m1.8.8.1.1.4.4.1.cmml" xref="S3.E2Xa.2.1.1.m1.8.8.1.1.4.4.1"></times><ci id="S3.E2Xa.2.1.1.m1.8.8.1.1.4.4.2.cmml" xref="S3.E2Xa.2.1.1.m1.8.8.1.1.4.4.2">𝐵</ci><ci id="S3.E2Xa.2.1.1.m1.4.4.cmml" xref="S3.E2Xa.2.1.1.m1.4.4">𝑖</ci></apply><apply id="S3.E2Xa.2.1.1.m1.8.8.1.1.5.5.cmml" xref="S3.E2Xa.2.1.1.m1.8.8.1.1.5.5"><times id="S3.E2Xa.2.1.1.m1.8.8.1.1.5.5.1.cmml" xref="S3.E2Xa.2.1.1.m1.8.8.1.1.5.5.1"></times><ci id="S3.E2Xa.2.1.1.m1.8.8.1.1.5.5.2.cmml" xref="S3.E2Xa.2.1.1.m1.8.8.1.1.5.5.2">𝑃</ci><ci id="S3.E2Xa.2.1.1.m1.5.5.cmml" xref="S3.E2Xa.2.1.1.m1.5.5">𝑖</ci></apply></vector><apply id="S3.E2Xa.2.1.1.m1.9.9.2.2.cmml" xref="S3.E2Xa.2.1.1.m1.9.9.2.2"><eq id="S3.E2Xa.2.1.1.m1.9.9.2.2.2.cmml" xref="S3.E2Xa.2.1.1.m1.9.9.2.2.2"></eq><ci id="S3.E2Xa.2.1.1.m1.9.9.2.2.3.cmml" xref="S3.E2Xa.2.1.1.m1.9.9.2.2.3">𝑖</ci><list id="S3.E2Xa.2.1.1.m1.9.9.2.2.1.2.cmml" xref="S3.E2Xa.2.1.1.m1.9.9.2.2.1.1"><apply id="S3.E2Xa.2.1.1.m1.9.9.2.2.1.1.1.cmml" xref="S3.E2Xa.2.1.1.m1.9.9.2.2.1.1.1"><plus id="S3.E2Xa.2.1.1.m1.9.9.2.2.1.1.1.1.cmml" xref="S3.E2Xa.2.1.1.m1.9.9.2.2.1.1.1.1"></plus><apply id="S3.E2Xa.2.1.1.m1.9.9.2.2.1.1.1.2.cmml" xref="S3.E2Xa.2.1.1.m1.9.9.2.2.1.1.1.2"><minus id="S3.E2Xa.2.1.1.m1.9.9.2.2.1.1.1.2.1.cmml" xref="S3.E2Xa.2.1.1.m1.9.9.2.2.1.1.1.2.1"></minus><ci id="S3.E2Xa.2.1.1.m1.9.9.2.2.1.1.1.2.2.cmml" xref="S3.E2Xa.2.1.1.m1.9.9.2.2.1.1.1.2.2">𝑛</ci><ci id="S3.E2Xa.2.1.1.m1.9.9.2.2.1.1.1.2.3.cmml" xref="S3.E2Xa.2.1.1.m1.9.9.2.2.1.1.1.2.3">𝑚</ci></apply><cn id="S3.E2Xa.2.1.1.m1.9.9.2.2.1.1.1.3.cmml" type="integer" xref="S3.E2Xa.2.1.1.m1.9.9.2.2.1.1.1.3">1</cn></apply><ci id="S3.E2Xa.2.1.1.m1.6.6.cmml" xref="S3.E2Xa.2.1.1.m1.6.6">…</ci><ci id="S3.E2Xa.2.1.1.m1.7.7.cmml" xref="S3.E2Xa.2.1.1.m1.7.7">𝑛</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2Xa.2.1.1.m1.9c">\displaystyle\left\{(A(i),U(i),T(i),B(i),P(i))\mid i=n-m+1,\ldots,n\right\}</annotation><annotation encoding="application/x-llamapun" id="S3.E2Xa.2.1.1.m1.9d">{ ( italic_A ( italic_i ) , italic_U ( italic_i ) , italic_T ( italic_i ) , italic_B ( italic_i ) , italic_P ( italic_i ) ) ∣ italic_i = italic_n - italic_m + 1 , … , italic_n }</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S3.SS1.p3.2">This structured approach allows our model to effectively leverage the rich, interconnected data, enhancing its predictive accuracy for upcoming application usage.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S3.SS2.5.1.1">III-B</span> </span><span class="ltx_text ltx_font_italic" id="S3.SS2.6.2">Dataset</span>
</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">Our study employs a real-world application usage dataset collected from Shanghai, China, during a week-long period from April 20 to April 26, 2016 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib53" title=""><span class="ltx_text" style="font-size:80%;">53</span></a>]</cite>. Each dataset entry contains an anonymous user ID, a timestamp, a base station ID, and the ID of the app being used, organized chronologically by timestamp. Table <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S3.T1" title="TABLE I ‣ III-B Dataset ‣ III Problem Description And Dataset ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_tag">I</span></a> provides a comprehensive view of the dataset format, featuring five sequential records from a single user for illustrative purposes.</p>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.1">Moreover, every base station in the dataset is designated by a unique ID and corresponds to a 17-dimensional Points of Interest (POI) vector. These POI vectors reflect the socioeconomic activities characteristic of the areas around the base stations, encompassing categories such as Medical care, Hotels, and Business affairs. In our analysis, POI data plays a crucial role in enhancing the prediction of app usage patterns. Table <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S3.T2" title="TABLE II ‣ III-B Dataset ‣ III Problem Description And Dataset ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_tag">II</span></a> displays the POIs linked to the three base stations mentioned in Table <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S3.T1" title="TABLE I ‣ III-B Dataset ‣ III Problem Description And Dataset ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_tag">I</span></a>, providing insight into the local functionalities and services available in their vicinity.</p>
</div>
<figure class="ltx_table" id="S3.T1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE I: </span>Examples of dataset.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S3.T1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T1.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T1.1.1.1.1">User ID</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T1.1.1.1.2">Timestamp</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T1.1.1.1.3">Base Station ID</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T1.1.1.1.4">App ID</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T1.1.2.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.2.1.1">723</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.2.1.2">20160420151912</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.2.1.3">7327</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.2.1.4">2</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.3.2">
<td class="ltx_td ltx_align_center" id="S3.T1.1.3.2.1">723</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.3.2.2">20160420151915</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.3.2.3">9419</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.3.2.4">237</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.4.3">
<td class="ltx_td ltx_align_center" id="S3.T1.1.4.3.1">723</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.4.3.2">20160420151921</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.4.3.3">9617</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.4.3.4">1</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.5.4">
<td class="ltx_td ltx_align_center" id="S3.T1.1.5.4.1">723</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.5.4.2">20160420151941</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.5.4.3">7327</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.5.4.4">2</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.6.5">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.1.6.5.1">723</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.1.6.5.2">20160420151942</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.1.6.5.3">7327</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.1.6.5.4">2</td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_table" id="S3.T2">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE II: </span>Examples of POIs.</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S3.T2.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T2.1.1.1">
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T2.1.1.1.1">Base Station ID</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T2.1.1.1.2">Medical care</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T2.1.1.1.3">Hotel</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T2.1.1.1.4">Business affairs</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T2.1.1.1.5">Life service</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T2.1.1.1.6">Transportation hub<sup class="ltx_sup" id="S3.T2.1.1.1.6.1">1</sup>
</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T2.1.1.1.7">Culture</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T2.1.1.1.8">Sports</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T2.1.1.1.9">Residence</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.2.2">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.2.2.1">7327</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.2.2.2">0</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.2.2.3">0</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.2.2.4">9</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.2.2.5">1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.2.2.6">0</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.2.2.7">0</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.2.2.8">0</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.2.2.9">2</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.3.3">
<td class="ltx_td ltx_align_center" id="S3.T2.1.3.3.1">9419</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.3.3.2">0</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.3.3.3">0</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.3.3.4">25</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.3.3.5">0</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.3.3.6">0</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.3.3.7">0</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.3.3.8">0</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.3.3.9">0</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.4.4">
<td class="ltx_td ltx_align_center" id="S3.T2.1.4.4.1">9617</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.4.4.2">0</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.4.4.3">2</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.4.4.4">0</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.4.4.5">1</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.4.4.6">1</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.4.4.7">0</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.4.4.8">0</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.4.4.9">35</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.5.5">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.5.5.1">Entertainment and leisure<sup class="ltx_sup" id="S3.T2.1.5.5.1.1">2</sup>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.5.5.2">Scenic spot</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.5.5.3">Government</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.5.5.4">Factory</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.5.5.5">Shopping</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.5.5.6">Restaurant</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.5.5.7">Education</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.5.5.8">Landmark</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.5.5.9">Other</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.6.6">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.6.6.1">2</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.6.6.2">1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.6.6.3">0</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.6.6.4">0</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.6.6.5">11</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.6.6.6">13</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.6.6.7">2</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.6.6.8">0</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.6.6.9">0</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.7.7">
<td class="ltx_td ltx_align_center" id="S3.T2.1.7.7.1">0</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.7.7.2">0</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.7.7.3">1</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.7.7.4">4</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.7.7.5">0</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.7.7.6">0</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.7.7.7">0</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.7.7.8">2</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.7.7.9">0</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.8.8">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.1.8.8.1">2</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.1.8.8.2">5</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.1.8.8.3">0</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.1.8.8.4">4</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.1.8.8.5">5</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.1.8.8.6">0</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.1.8.8.7">0</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.1.8.8.8">1</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.1.8.8.9">0</td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">IV </span><span class="ltx_text ltx_font_smallcaps" id="S4.1.1">Method</span>
</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">In this section, we begin by exploring the methodologies employed for data selection and preprocessing, focusing on the implementation of word embeddings, the application of clustering techniques to Points of Interest (POIs) data, and the encoding of temporal data. Following this preliminary discussion, we introduce the Appformer framework, offering a comprehensive overview and then proceeding to elaborate on its two primary components: the Multi-Modal Data Progressive Fusion Module and the Feature Extraction Module.</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S4.SS1.5.1.1">IV-A</span> </span><span class="ltx_text ltx_font_italic" id="S4.SS1.6.2">Data selection and preprocessing</span>
</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">To respect and protect user privacy, we have chosen POI information associated with base stations as the input for location features. So our core data includes four parts: app sequence, user IDs, POI data and time data. The preprocessing of data are illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S2.F2" title="Figure 2 ‣ II Related Work ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<section class="ltx_subsubsection" id="S4.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text" id="S4.SS1.SSS1.5.1.1">IV-A</span>1 </span>App sequence</h4>
<div class="ltx_para" id="S4.SS1.SSS1.p1">
<p class="ltx_p" id="S4.SS1.SSS1.p1.1">As depicted in the top-left green block of Figure <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S2.F2" title="Figure 2 ‣ II Related Work ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_tag">2</span></a>, we transform the discrete app sequence (App_seq) into a continuous vector space using word embedding techniques <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib54" title=""><span class="ltx_text" style="font-size:80%;">54</span></a>]</cite>, a method proficient in converting discrete data into continuous vectors. As shown in the red box in the orange block of Figure <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S2.F2" title="Figure 2 ‣ II Related Work ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_tag">2</span></a>, the application sequence is converted to <span class="ltx_text ltx_font_bold" id="S4.SS1.SSS1.p1.1.1">a</span> through word embedding.</p>
</div>
<div class="ltx_para" id="S4.SS1.SSS1.p2">
<p class="ltx_p" id="S4.SS1.SSS1.p2.1">We utilize the nn.Embedding algorithm in the PyTorch framework to implement word embedding. Initially, we need to initialize an embedding matrix of size <math alttext="(n,d)" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p2.1.m1.2"><semantics id="S4.SS1.SSS1.p2.1.m1.2a"><mrow id="S4.SS1.SSS1.p2.1.m1.2.3.2" xref="S4.SS1.SSS1.p2.1.m1.2.3.1.cmml"><mo id="S4.SS1.SSS1.p2.1.m1.2.3.2.1" stretchy="false" xref="S4.SS1.SSS1.p2.1.m1.2.3.1.cmml">(</mo><mi id="S4.SS1.SSS1.p2.1.m1.1.1" xref="S4.SS1.SSS1.p2.1.m1.1.1.cmml">n</mi><mo id="S4.SS1.SSS1.p2.1.m1.2.3.2.2" xref="S4.SS1.SSS1.p2.1.m1.2.3.1.cmml">,</mo><mi id="S4.SS1.SSS1.p2.1.m1.2.2" xref="S4.SS1.SSS1.p2.1.m1.2.2.cmml">d</mi><mo id="S4.SS1.SSS1.p2.1.m1.2.3.2.3" stretchy="false" xref="S4.SS1.SSS1.p2.1.m1.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p2.1.m1.2b"><interval closure="open" id="S4.SS1.SSS1.p2.1.m1.2.3.1.cmml" xref="S4.SS1.SSS1.p2.1.m1.2.3.2"><ci id="S4.SS1.SSS1.p2.1.m1.1.1.cmml" xref="S4.SS1.SSS1.p2.1.m1.1.1">𝑛</ci><ci id="S4.SS1.SSS1.p2.1.m1.2.2.cmml" xref="S4.SS1.SSS1.p2.1.m1.2.2">𝑑</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p2.1.m1.2c">(n,d)</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p2.1.m1.2d">( italic_n , italic_d )</annotation></semantics></math>. Each row of the embedding matrix corresponds to an app’s embedding vector. This matrix can be randomly initialized at first, and then updated during the training process via backpropagation.</p>
</div>
<div class="ltx_para" id="S4.SS1.SSS1.p3">
<p class="ltx_p" id="S4.SS1.SSS1.p3.1">The specific embedding process can be represented with the following equation:</p>
</div>
<div class="ltx_para" id="S4.SS1.SSS1.p4">
<table class="ltx_equationgroup ltx_eqn_table" id="S4.E3">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E3X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle E=\text{nn.Embedding}(n,d)" class="ltx_Math" display="inline" id="S4.E3X.2.1.1.m1.2"><semantics id="S4.E3X.2.1.1.m1.2a"><mrow id="S4.E3X.2.1.1.m1.2.3" xref="S4.E3X.2.1.1.m1.2.3.cmml"><mi id="S4.E3X.2.1.1.m1.2.3.2" xref="S4.E3X.2.1.1.m1.2.3.2.cmml">E</mi><mo id="S4.E3X.2.1.1.m1.2.3.1" xref="S4.E3X.2.1.1.m1.2.3.1.cmml">=</mo><mrow id="S4.E3X.2.1.1.m1.2.3.3" xref="S4.E3X.2.1.1.m1.2.3.3.cmml"><mtext id="S4.E3X.2.1.1.m1.2.3.3.2" xref="S4.E3X.2.1.1.m1.2.3.3.2a.cmml">nn.Embedding</mtext><mo id="S4.E3X.2.1.1.m1.2.3.3.1" xref="S4.E3X.2.1.1.m1.2.3.3.1.cmml">⁢</mo><mrow id="S4.E3X.2.1.1.m1.2.3.3.3.2" xref="S4.E3X.2.1.1.m1.2.3.3.3.1.cmml"><mo id="S4.E3X.2.1.1.m1.2.3.3.3.2.1" stretchy="false" xref="S4.E3X.2.1.1.m1.2.3.3.3.1.cmml">(</mo><mi id="S4.E3X.2.1.1.m1.1.1" xref="S4.E3X.2.1.1.m1.1.1.cmml">n</mi><mo id="S4.E3X.2.1.1.m1.2.3.3.3.2.2" xref="S4.E3X.2.1.1.m1.2.3.3.3.1.cmml">,</mo><mi id="S4.E3X.2.1.1.m1.2.2" xref="S4.E3X.2.1.1.m1.2.2.cmml">d</mi><mo id="S4.E3X.2.1.1.m1.2.3.3.3.2.3" stretchy="false" xref="S4.E3X.2.1.1.m1.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E3X.2.1.1.m1.2b"><apply id="S4.E3X.2.1.1.m1.2.3.cmml" xref="S4.E3X.2.1.1.m1.2.3"><eq id="S4.E3X.2.1.1.m1.2.3.1.cmml" xref="S4.E3X.2.1.1.m1.2.3.1"></eq><ci id="S4.E3X.2.1.1.m1.2.3.2.cmml" xref="S4.E3X.2.1.1.m1.2.3.2">𝐸</ci><apply id="S4.E3X.2.1.1.m1.2.3.3.cmml" xref="S4.E3X.2.1.1.m1.2.3.3"><times id="S4.E3X.2.1.1.m1.2.3.3.1.cmml" xref="S4.E3X.2.1.1.m1.2.3.3.1"></times><ci id="S4.E3X.2.1.1.m1.2.3.3.2a.cmml" xref="S4.E3X.2.1.1.m1.2.3.3.2"><mtext id="S4.E3X.2.1.1.m1.2.3.3.2.cmml" xref="S4.E3X.2.1.1.m1.2.3.3.2">nn.Embedding</mtext></ci><interval closure="open" id="S4.E3X.2.1.1.m1.2.3.3.3.1.cmml" xref="S4.E3X.2.1.1.m1.2.3.3.3.2"><ci id="S4.E3X.2.1.1.m1.1.1.cmml" xref="S4.E3X.2.1.1.m1.1.1">𝑛</ci><ci id="S4.E3X.2.1.1.m1.2.2.cmml" xref="S4.E3X.2.1.1.m1.2.2">𝑑</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3X.2.1.1.m1.2c">\displaystyle E=\text{nn.Embedding}(n,d)</annotation><annotation encoding="application/x-llamapun" id="S4.E3X.2.1.1.m1.2d">italic_E = nn.Embedding ( italic_n , italic_d )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(3)</span></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_para" id="S4.SS1.SSS1.p5">
<p class="ltx_p" id="S4.SS1.SSS1.p5.3">where <math alttext="E" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p5.1.m1.1"><semantics id="S4.SS1.SSS1.p5.1.m1.1a"><mi id="S4.SS1.SSS1.p5.1.m1.1.1" xref="S4.SS1.SSS1.p5.1.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p5.1.m1.1b"><ci id="S4.SS1.SSS1.p5.1.m1.1.1.cmml" xref="S4.SS1.SSS1.p5.1.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p5.1.m1.1c">E</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p5.1.m1.1d">italic_E</annotation></semantics></math> denotes the embedding matrix, <math alttext="n" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p5.2.m2.1"><semantics id="S4.SS1.SSS1.p5.2.m2.1a"><mi id="S4.SS1.SSS1.p5.2.m2.1.1" xref="S4.SS1.SSS1.p5.2.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p5.2.m2.1b"><ci id="S4.SS1.SSS1.p5.2.m2.1.1.cmml" xref="S4.SS1.SSS1.p5.2.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p5.2.m2.1c">n</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p5.2.m2.1d">italic_n</annotation></semantics></math> represents the total number of apps, and <math alttext="d" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p5.3.m3.1"><semantics id="S4.SS1.SSS1.p5.3.m3.1a"><mi id="S4.SS1.SSS1.p5.3.m3.1.1" xref="S4.SS1.SSS1.p5.3.m3.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p5.3.m3.1b"><ci id="S4.SS1.SSS1.p5.3.m3.1.1.cmml" xref="S4.SS1.SSS1.p5.3.m3.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p5.3.m3.1c">d</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p5.3.m3.1d">italic_d</annotation></semantics></math> is the dimension of the embedding vector.</p>
</div>
<div class="ltx_para" id="S4.SS1.SSS1.p6">
<p class="ltx_p" id="S4.SS1.SSS1.p6.1">Subsequently, for each app in the sequence, we can find the corresponding embedding vector from the embedding matrix using its ID. This process can be represented by the following equation:</p>
</div>
<div class="ltx_para" id="S4.SS1.SSS1.p7">
<table class="ltx_equationgroup ltx_eqn_table" id="S4.E4">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E4X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle v_{i}=E(i)" class="ltx_Math" display="inline" id="S4.E4X.2.1.1.m1.1"><semantics id="S4.E4X.2.1.1.m1.1a"><mrow id="S4.E4X.2.1.1.m1.1.2" xref="S4.E4X.2.1.1.m1.1.2.cmml"><msub id="S4.E4X.2.1.1.m1.1.2.2" xref="S4.E4X.2.1.1.m1.1.2.2.cmml"><mi id="S4.E4X.2.1.1.m1.1.2.2.2" xref="S4.E4X.2.1.1.m1.1.2.2.2.cmml">v</mi><mi id="S4.E4X.2.1.1.m1.1.2.2.3" xref="S4.E4X.2.1.1.m1.1.2.2.3.cmml">i</mi></msub><mo id="S4.E4X.2.1.1.m1.1.2.1" xref="S4.E4X.2.1.1.m1.1.2.1.cmml">=</mo><mrow id="S4.E4X.2.1.1.m1.1.2.3" xref="S4.E4X.2.1.1.m1.1.2.3.cmml"><mi id="S4.E4X.2.1.1.m1.1.2.3.2" xref="S4.E4X.2.1.1.m1.1.2.3.2.cmml">E</mi><mo id="S4.E4X.2.1.1.m1.1.2.3.1" xref="S4.E4X.2.1.1.m1.1.2.3.1.cmml">⁢</mo><mrow id="S4.E4X.2.1.1.m1.1.2.3.3.2" xref="S4.E4X.2.1.1.m1.1.2.3.cmml"><mo id="S4.E4X.2.1.1.m1.1.2.3.3.2.1" stretchy="false" xref="S4.E4X.2.1.1.m1.1.2.3.cmml">(</mo><mi id="S4.E4X.2.1.1.m1.1.1" xref="S4.E4X.2.1.1.m1.1.1.cmml">i</mi><mo id="S4.E4X.2.1.1.m1.1.2.3.3.2.2" stretchy="false" xref="S4.E4X.2.1.1.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E4X.2.1.1.m1.1b"><apply id="S4.E4X.2.1.1.m1.1.2.cmml" xref="S4.E4X.2.1.1.m1.1.2"><eq id="S4.E4X.2.1.1.m1.1.2.1.cmml" xref="S4.E4X.2.1.1.m1.1.2.1"></eq><apply id="S4.E4X.2.1.1.m1.1.2.2.cmml" xref="S4.E4X.2.1.1.m1.1.2.2"><csymbol cd="ambiguous" id="S4.E4X.2.1.1.m1.1.2.2.1.cmml" xref="S4.E4X.2.1.1.m1.1.2.2">subscript</csymbol><ci id="S4.E4X.2.1.1.m1.1.2.2.2.cmml" xref="S4.E4X.2.1.1.m1.1.2.2.2">𝑣</ci><ci id="S4.E4X.2.1.1.m1.1.2.2.3.cmml" xref="S4.E4X.2.1.1.m1.1.2.2.3">𝑖</ci></apply><apply id="S4.E4X.2.1.1.m1.1.2.3.cmml" xref="S4.E4X.2.1.1.m1.1.2.3"><times id="S4.E4X.2.1.1.m1.1.2.3.1.cmml" xref="S4.E4X.2.1.1.m1.1.2.3.1"></times><ci id="S4.E4X.2.1.1.m1.1.2.3.2.cmml" xref="S4.E4X.2.1.1.m1.1.2.3.2">𝐸</ci><ci id="S4.E4X.2.1.1.m1.1.1.cmml" xref="S4.E4X.2.1.1.m1.1.1">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4X.2.1.1.m1.1c">\displaystyle v_{i}=E(i)</annotation><annotation encoding="application/x-llamapun" id="S4.E4X.2.1.1.m1.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_E ( italic_i )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(4)</span></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_para" id="S4.SS1.SSS1.p8">
<p class="ltx_p" id="S4.SS1.SSS1.p8.5">where <math alttext="v_{i}" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p8.1.m1.1"><semantics id="S4.SS1.SSS1.p8.1.m1.1a"><msub id="S4.SS1.SSS1.p8.1.m1.1.1" xref="S4.SS1.SSS1.p8.1.m1.1.1.cmml"><mi id="S4.SS1.SSS1.p8.1.m1.1.1.2" xref="S4.SS1.SSS1.p8.1.m1.1.1.2.cmml">v</mi><mi id="S4.SS1.SSS1.p8.1.m1.1.1.3" xref="S4.SS1.SSS1.p8.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p8.1.m1.1b"><apply id="S4.SS1.SSS1.p8.1.m1.1.1.cmml" xref="S4.SS1.SSS1.p8.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p8.1.m1.1.1.1.cmml" xref="S4.SS1.SSS1.p8.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p8.1.m1.1.1.2.cmml" xref="S4.SS1.SSS1.p8.1.m1.1.1.2">𝑣</ci><ci id="S4.SS1.SSS1.p8.1.m1.1.1.3.cmml" xref="S4.SS1.SSS1.p8.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p8.1.m1.1c">v_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p8.1.m1.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is the embedding vector of app <math alttext="i" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p8.2.m2.1"><semantics id="S4.SS1.SSS1.p8.2.m2.1a"><mi id="S4.SS1.SSS1.p8.2.m2.1.1" xref="S4.SS1.SSS1.p8.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p8.2.m2.1b"><ci id="S4.SS1.SSS1.p8.2.m2.1.1.cmml" xref="S4.SS1.SSS1.p8.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p8.2.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p8.2.m2.1d">italic_i</annotation></semantics></math>, and <math alttext="E(i)" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p8.3.m3.1"><semantics id="S4.SS1.SSS1.p8.3.m3.1a"><mrow id="S4.SS1.SSS1.p8.3.m3.1.2" xref="S4.SS1.SSS1.p8.3.m3.1.2.cmml"><mi id="S4.SS1.SSS1.p8.3.m3.1.2.2" xref="S4.SS1.SSS1.p8.3.m3.1.2.2.cmml">E</mi><mo id="S4.SS1.SSS1.p8.3.m3.1.2.1" xref="S4.SS1.SSS1.p8.3.m3.1.2.1.cmml">⁢</mo><mrow id="S4.SS1.SSS1.p8.3.m3.1.2.3.2" xref="S4.SS1.SSS1.p8.3.m3.1.2.cmml"><mo id="S4.SS1.SSS1.p8.3.m3.1.2.3.2.1" stretchy="false" xref="S4.SS1.SSS1.p8.3.m3.1.2.cmml">(</mo><mi id="S4.SS1.SSS1.p8.3.m3.1.1" xref="S4.SS1.SSS1.p8.3.m3.1.1.cmml">i</mi><mo id="S4.SS1.SSS1.p8.3.m3.1.2.3.2.2" stretchy="false" xref="S4.SS1.SSS1.p8.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p8.3.m3.1b"><apply id="S4.SS1.SSS1.p8.3.m3.1.2.cmml" xref="S4.SS1.SSS1.p8.3.m3.1.2"><times id="S4.SS1.SSS1.p8.3.m3.1.2.1.cmml" xref="S4.SS1.SSS1.p8.3.m3.1.2.1"></times><ci id="S4.SS1.SSS1.p8.3.m3.1.2.2.cmml" xref="S4.SS1.SSS1.p8.3.m3.1.2.2">𝐸</ci><ci id="S4.SS1.SSS1.p8.3.m3.1.1.cmml" xref="S4.SS1.SSS1.p8.3.m3.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p8.3.m3.1c">E(i)</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p8.3.m3.1d">italic_E ( italic_i )</annotation></semantics></math> denotes the operation of finding the embedding vector of app <math alttext="i" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p8.4.m4.1"><semantics id="S4.SS1.SSS1.p8.4.m4.1a"><mi id="S4.SS1.SSS1.p8.4.m4.1.1" xref="S4.SS1.SSS1.p8.4.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p8.4.m4.1b"><ci id="S4.SS1.SSS1.p8.4.m4.1.1.cmml" xref="S4.SS1.SSS1.p8.4.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p8.4.m4.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p8.4.m4.1d">italic_i</annotation></semantics></math> from the embedding matrix <math alttext="E" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p8.5.m5.1"><semantics id="S4.SS1.SSS1.p8.5.m5.1a"><mi id="S4.SS1.SSS1.p8.5.m5.1.1" xref="S4.SS1.SSS1.p8.5.m5.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p8.5.m5.1b"><ci id="S4.SS1.SSS1.p8.5.m5.1.1.cmml" xref="S4.SS1.SSS1.p8.5.m5.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p8.5.m5.1c">E</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p8.5.m5.1d">italic_E</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S4.SS1.SSS1.p9">
<p class="ltx_p" id="S4.SS1.SSS1.p9.2">In this process, the embedding matrix <math alttext="E" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p9.1.m1.1"><semantics id="S4.SS1.SSS1.p9.1.m1.1a"><mi id="S4.SS1.SSS1.p9.1.m1.1.1" xref="S4.SS1.SSS1.p9.1.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p9.1.m1.1b"><ci id="S4.SS1.SSS1.p9.1.m1.1.1.cmml" xref="S4.SS1.SSS1.p9.1.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p9.1.m1.1c">E</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p9.1.m1.1d">italic_E</annotation></semantics></math> is a learnable parameter and will be updated during model training. Ultimately, each app is mapped to a <math alttext="d" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p9.2.m2.1"><semantics id="S4.SS1.SSS1.p9.2.m2.1a"><mi id="S4.SS1.SSS1.p9.2.m2.1.1" xref="S4.SS1.SSS1.p9.2.m2.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p9.2.m2.1b"><ci id="S4.SS1.SSS1.p9.2.m2.1.1.cmml" xref="S4.SS1.SSS1.p9.2.m2.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p9.2.m2.1c">d</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p9.2.m2.1d">italic_d</annotation></semantics></math>-dimensional vector, which is its embedding vector. This vector can capture the similarities and differences between apps, as well as their contextual information within the sequence.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS1.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text" id="S4.SS1.SSS2.5.1.1">IV-A</span>2 </span>User IDs</h4>
<div class="ltx_para" id="S4.SS1.SSS2.p1">
<p class="ltx_p" id="S4.SS1.SSS2.p1.1">As shown in the purple box in the orange block of Figure <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S2.F2" title="Figure 2 ‣ II Related Work ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_tag">2</span></a>, similar to the application sequences, the User IDs are also processed into <span class="ltx_text ltx_font_bold" id="S4.SS1.SSS2.p1.1.1">u</span> using word embedding.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS1.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text" id="S4.SS1.SSS3.5.1.1">IV-A</span>3 </span>POIs</h4>
<div class="ltx_para" id="S4.SS1.SSS3.p1">
<p class="ltx_p" id="S4.SS1.SSS3.p1.1">As shown in the blue block in the top right corner of Figure <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S2.F2" title="Figure 2 ‣ II Related Work ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_tag">2</span></a>, we perform clustering operations on POIs and replace each POI vector with the vector of its corresponding cluster center. We investigated several clustering algorithms that can be efficiently applied to POI data, including K-Means, Mini Batch K-Means, K-Means++, K-Modes, and K-Harmonic Means. Below, we provide a detailed comparison of these clustering algorithms:</p>
</div>
<div class="ltx_para" id="S4.SS1.SSS3.p2">
<p class="ltx_p" id="S4.SS1.SSS3.p2.1">K-Means<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib55" title=""><span class="ltx_text" style="font-size:80%;">55</span></a>]</cite>, a well-known clustering algorithm, aims to partition data points into a predefined number of clusters by iteratively updating cluster centers. However, K-Means is highly sensitive to the initial selection of cluster centers and can converge to local optima. To expedite convergence, we utilized the Mini Batch K-Means method<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib56" title=""><span class="ltx_text" style="font-size:80%;">56</span></a>]</cite>, which performs iterative updates on small batch data samples, making it suitable for large datasets. This method reduces computation time while preserving accuracy. To address the issue of initial cluster center selection, we adopted the K-Means++ method<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib57" title=""><span class="ltx_text" style="font-size:80%;">57</span></a>]</cite>, which optimizes the selection of initial cluster centers, thereby accelerating convergence to the global optimum and enhancing the stability and efficiency of the algorithm. To accommodate the discrete features of POI data, we employed the K-Modes algorithm<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib58" title=""><span class="ltx_text" style="font-size:80%;">58</span></a>]</cite>, which effectively manages a large quantity of discrete data and successfully uncovers patterns in clusters. This is particularly beneficial for processing discrete POI vectors. Lastly, considering the impact of outliers on clustering results, we introduced the K-Harmonic Means method<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib59" title=""><span class="ltx_text" style="font-size:80%;">59</span></a>]</cite>, which employs the harmonic mean to compute cluster centers, thus offering more robust handling of outlier data.</p>
</div>
<div class="ltx_para" id="S4.SS1.SSS3.p3">
<p class="ltx_p" id="S4.SS1.SSS3.p3.1">From the comparative experiments in Section <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S6.SS6" title="VI-F Clustering experiment on the POI data ‣ VI Result ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">VI-F</span></span></a>, it can be seen that K-Modes achieved the best result. As shown in the grey box in the orange block of Figure <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S2.F2" title="Figure 2 ‣ II Related Work ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_tag">2</span></a>, we first use K-Modes to cluster the POIs, then use a linear layer to perform a linear transformation on them, obtaining the location data <span class="ltx_text ltx_font_bold" id="S4.SS1.SSS3.p3.1.1">l</span>.</p>
</div>
<div class="ltx_para" id="S4.SS1.SSS3.p4">
<p class="ltx_p" id="S4.SS1.SSS3.p4.1">The following is the specific operation of clustering POIs using K-Modes:</p>
</div>
<div class="ltx_para" id="S4.SS1.SSS3.p5">
<p class="ltx_p" id="S4.SS1.SSS3.p5.2">We denote the base station ID dataset as <math alttext="X=\{x_{1},x_{2},...,x_{n}\}" class="ltx_Math" display="inline" id="S4.SS1.SSS3.p5.1.m1.4"><semantics id="S4.SS1.SSS3.p5.1.m1.4a"><mrow id="S4.SS1.SSS3.p5.1.m1.4.4" xref="S4.SS1.SSS3.p5.1.m1.4.4.cmml"><mi id="S4.SS1.SSS3.p5.1.m1.4.4.5" xref="S4.SS1.SSS3.p5.1.m1.4.4.5.cmml">X</mi><mo id="S4.SS1.SSS3.p5.1.m1.4.4.4" xref="S4.SS1.SSS3.p5.1.m1.4.4.4.cmml">=</mo><mrow id="S4.SS1.SSS3.p5.1.m1.4.4.3.3" xref="S4.SS1.SSS3.p5.1.m1.4.4.3.4.cmml"><mo id="S4.SS1.SSS3.p5.1.m1.4.4.3.3.4" stretchy="false" xref="S4.SS1.SSS3.p5.1.m1.4.4.3.4.cmml">{</mo><msub id="S4.SS1.SSS3.p5.1.m1.2.2.1.1.1" xref="S4.SS1.SSS3.p5.1.m1.2.2.1.1.1.cmml"><mi id="S4.SS1.SSS3.p5.1.m1.2.2.1.1.1.2" xref="S4.SS1.SSS3.p5.1.m1.2.2.1.1.1.2.cmml">x</mi><mn id="S4.SS1.SSS3.p5.1.m1.2.2.1.1.1.3" xref="S4.SS1.SSS3.p5.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S4.SS1.SSS3.p5.1.m1.4.4.3.3.5" xref="S4.SS1.SSS3.p5.1.m1.4.4.3.4.cmml">,</mo><msub id="S4.SS1.SSS3.p5.1.m1.3.3.2.2.2" xref="S4.SS1.SSS3.p5.1.m1.3.3.2.2.2.cmml"><mi id="S4.SS1.SSS3.p5.1.m1.3.3.2.2.2.2" xref="S4.SS1.SSS3.p5.1.m1.3.3.2.2.2.2.cmml">x</mi><mn id="S4.SS1.SSS3.p5.1.m1.3.3.2.2.2.3" xref="S4.SS1.SSS3.p5.1.m1.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S4.SS1.SSS3.p5.1.m1.4.4.3.3.6" xref="S4.SS1.SSS3.p5.1.m1.4.4.3.4.cmml">,</mo><mi id="S4.SS1.SSS3.p5.1.m1.1.1" mathvariant="normal" xref="S4.SS1.SSS3.p5.1.m1.1.1.cmml">…</mi><mo id="S4.SS1.SSS3.p5.1.m1.4.4.3.3.7" xref="S4.SS1.SSS3.p5.1.m1.4.4.3.4.cmml">,</mo><msub id="S4.SS1.SSS3.p5.1.m1.4.4.3.3.3" xref="S4.SS1.SSS3.p5.1.m1.4.4.3.3.3.cmml"><mi id="S4.SS1.SSS3.p5.1.m1.4.4.3.3.3.2" xref="S4.SS1.SSS3.p5.1.m1.4.4.3.3.3.2.cmml">x</mi><mi id="S4.SS1.SSS3.p5.1.m1.4.4.3.3.3.3" xref="S4.SS1.SSS3.p5.1.m1.4.4.3.3.3.3.cmml">n</mi></msub><mo id="S4.SS1.SSS3.p5.1.m1.4.4.3.3.8" stretchy="false" xref="S4.SS1.SSS3.p5.1.m1.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p5.1.m1.4b"><apply id="S4.SS1.SSS3.p5.1.m1.4.4.cmml" xref="S4.SS1.SSS3.p5.1.m1.4.4"><eq id="S4.SS1.SSS3.p5.1.m1.4.4.4.cmml" xref="S4.SS1.SSS3.p5.1.m1.4.4.4"></eq><ci id="S4.SS1.SSS3.p5.1.m1.4.4.5.cmml" xref="S4.SS1.SSS3.p5.1.m1.4.4.5">𝑋</ci><set id="S4.SS1.SSS3.p5.1.m1.4.4.3.4.cmml" xref="S4.SS1.SSS3.p5.1.m1.4.4.3.3"><apply id="S4.SS1.SSS3.p5.1.m1.2.2.1.1.1.cmml" xref="S4.SS1.SSS3.p5.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p5.1.m1.2.2.1.1.1.1.cmml" xref="S4.SS1.SSS3.p5.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS3.p5.1.m1.2.2.1.1.1.2.cmml" xref="S4.SS1.SSS3.p5.1.m1.2.2.1.1.1.2">𝑥</ci><cn id="S4.SS1.SSS3.p5.1.m1.2.2.1.1.1.3.cmml" type="integer" xref="S4.SS1.SSS3.p5.1.m1.2.2.1.1.1.3">1</cn></apply><apply id="S4.SS1.SSS3.p5.1.m1.3.3.2.2.2.cmml" xref="S4.SS1.SSS3.p5.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p5.1.m1.3.3.2.2.2.1.cmml" xref="S4.SS1.SSS3.p5.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S4.SS1.SSS3.p5.1.m1.3.3.2.2.2.2.cmml" xref="S4.SS1.SSS3.p5.1.m1.3.3.2.2.2.2">𝑥</ci><cn id="S4.SS1.SSS3.p5.1.m1.3.3.2.2.2.3.cmml" type="integer" xref="S4.SS1.SSS3.p5.1.m1.3.3.2.2.2.3">2</cn></apply><ci id="S4.SS1.SSS3.p5.1.m1.1.1.cmml" xref="S4.SS1.SSS3.p5.1.m1.1.1">…</ci><apply id="S4.SS1.SSS3.p5.1.m1.4.4.3.3.3.cmml" xref="S4.SS1.SSS3.p5.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p5.1.m1.4.4.3.3.3.1.cmml" xref="S4.SS1.SSS3.p5.1.m1.4.4.3.3.3">subscript</csymbol><ci id="S4.SS1.SSS3.p5.1.m1.4.4.3.3.3.2.cmml" xref="S4.SS1.SSS3.p5.1.m1.4.4.3.3.3.2">𝑥</ci><ci id="S4.SS1.SSS3.p5.1.m1.4.4.3.3.3.3.cmml" xref="S4.SS1.SSS3.p5.1.m1.4.4.3.3.3.3">𝑛</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p5.1.m1.4c">X=\{x_{1},x_{2},...,x_{n}\}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.p5.1.m1.4d">italic_X = { italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_x start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT }</annotation></semantics></math>, where each <math alttext="x_{i}=(x_{i1},x_{i2},...,x_{im})" class="ltx_Math" display="inline" id="S4.SS1.SSS3.p5.2.m2.4"><semantics id="S4.SS1.SSS3.p5.2.m2.4a"><mrow id="S4.SS1.SSS3.p5.2.m2.4.4" xref="S4.SS1.SSS3.p5.2.m2.4.4.cmml"><msub id="S4.SS1.SSS3.p5.2.m2.4.4.5" xref="S4.SS1.SSS3.p5.2.m2.4.4.5.cmml"><mi id="S4.SS1.SSS3.p5.2.m2.4.4.5.2" xref="S4.SS1.SSS3.p5.2.m2.4.4.5.2.cmml">x</mi><mi id="S4.SS1.SSS3.p5.2.m2.4.4.5.3" xref="S4.SS1.SSS3.p5.2.m2.4.4.5.3.cmml">i</mi></msub><mo id="S4.SS1.SSS3.p5.2.m2.4.4.4" xref="S4.SS1.SSS3.p5.2.m2.4.4.4.cmml">=</mo><mrow id="S4.SS1.SSS3.p5.2.m2.4.4.3.3" xref="S4.SS1.SSS3.p5.2.m2.4.4.3.4.cmml"><mo id="S4.SS1.SSS3.p5.2.m2.4.4.3.3.4" stretchy="false" xref="S4.SS1.SSS3.p5.2.m2.4.4.3.4.cmml">(</mo><msub id="S4.SS1.SSS3.p5.2.m2.2.2.1.1.1" xref="S4.SS1.SSS3.p5.2.m2.2.2.1.1.1.cmml"><mi id="S4.SS1.SSS3.p5.2.m2.2.2.1.1.1.2" xref="S4.SS1.SSS3.p5.2.m2.2.2.1.1.1.2.cmml">x</mi><mrow id="S4.SS1.SSS3.p5.2.m2.2.2.1.1.1.3" xref="S4.SS1.SSS3.p5.2.m2.2.2.1.1.1.3.cmml"><mi id="S4.SS1.SSS3.p5.2.m2.2.2.1.1.1.3.2" xref="S4.SS1.SSS3.p5.2.m2.2.2.1.1.1.3.2.cmml">i</mi><mo id="S4.SS1.SSS3.p5.2.m2.2.2.1.1.1.3.1" xref="S4.SS1.SSS3.p5.2.m2.2.2.1.1.1.3.1.cmml">⁢</mo><mn id="S4.SS1.SSS3.p5.2.m2.2.2.1.1.1.3.3" xref="S4.SS1.SSS3.p5.2.m2.2.2.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S4.SS1.SSS3.p5.2.m2.4.4.3.3.5" xref="S4.SS1.SSS3.p5.2.m2.4.4.3.4.cmml">,</mo><msub id="S4.SS1.SSS3.p5.2.m2.3.3.2.2.2" xref="S4.SS1.SSS3.p5.2.m2.3.3.2.2.2.cmml"><mi id="S4.SS1.SSS3.p5.2.m2.3.3.2.2.2.2" xref="S4.SS1.SSS3.p5.2.m2.3.3.2.2.2.2.cmml">x</mi><mrow id="S4.SS1.SSS3.p5.2.m2.3.3.2.2.2.3" xref="S4.SS1.SSS3.p5.2.m2.3.3.2.2.2.3.cmml"><mi id="S4.SS1.SSS3.p5.2.m2.3.3.2.2.2.3.2" xref="S4.SS1.SSS3.p5.2.m2.3.3.2.2.2.3.2.cmml">i</mi><mo id="S4.SS1.SSS3.p5.2.m2.3.3.2.2.2.3.1" xref="S4.SS1.SSS3.p5.2.m2.3.3.2.2.2.3.1.cmml">⁢</mo><mn id="S4.SS1.SSS3.p5.2.m2.3.3.2.2.2.3.3" xref="S4.SS1.SSS3.p5.2.m2.3.3.2.2.2.3.3.cmml">2</mn></mrow></msub><mo id="S4.SS1.SSS3.p5.2.m2.4.4.3.3.6" xref="S4.SS1.SSS3.p5.2.m2.4.4.3.4.cmml">,</mo><mi id="S4.SS1.SSS3.p5.2.m2.1.1" mathvariant="normal" xref="S4.SS1.SSS3.p5.2.m2.1.1.cmml">…</mi><mo id="S4.SS1.SSS3.p5.2.m2.4.4.3.3.7" xref="S4.SS1.SSS3.p5.2.m2.4.4.3.4.cmml">,</mo><msub id="S4.SS1.SSS3.p5.2.m2.4.4.3.3.3" xref="S4.SS1.SSS3.p5.2.m2.4.4.3.3.3.cmml"><mi id="S4.SS1.SSS3.p5.2.m2.4.4.3.3.3.2" xref="S4.SS1.SSS3.p5.2.m2.4.4.3.3.3.2.cmml">x</mi><mrow id="S4.SS1.SSS3.p5.2.m2.4.4.3.3.3.3" xref="S4.SS1.SSS3.p5.2.m2.4.4.3.3.3.3.cmml"><mi id="S4.SS1.SSS3.p5.2.m2.4.4.3.3.3.3.2" xref="S4.SS1.SSS3.p5.2.m2.4.4.3.3.3.3.2.cmml">i</mi><mo id="S4.SS1.SSS3.p5.2.m2.4.4.3.3.3.3.1" xref="S4.SS1.SSS3.p5.2.m2.4.4.3.3.3.3.1.cmml">⁢</mo><mi id="S4.SS1.SSS3.p5.2.m2.4.4.3.3.3.3.3" xref="S4.SS1.SSS3.p5.2.m2.4.4.3.3.3.3.3.cmml">m</mi></mrow></msub><mo id="S4.SS1.SSS3.p5.2.m2.4.4.3.3.8" stretchy="false" xref="S4.SS1.SSS3.p5.2.m2.4.4.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p5.2.m2.4b"><apply id="S4.SS1.SSS3.p5.2.m2.4.4.cmml" xref="S4.SS1.SSS3.p5.2.m2.4.4"><eq id="S4.SS1.SSS3.p5.2.m2.4.4.4.cmml" xref="S4.SS1.SSS3.p5.2.m2.4.4.4"></eq><apply id="S4.SS1.SSS3.p5.2.m2.4.4.5.cmml" xref="S4.SS1.SSS3.p5.2.m2.4.4.5"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p5.2.m2.4.4.5.1.cmml" xref="S4.SS1.SSS3.p5.2.m2.4.4.5">subscript</csymbol><ci id="S4.SS1.SSS3.p5.2.m2.4.4.5.2.cmml" xref="S4.SS1.SSS3.p5.2.m2.4.4.5.2">𝑥</ci><ci id="S4.SS1.SSS3.p5.2.m2.4.4.5.3.cmml" xref="S4.SS1.SSS3.p5.2.m2.4.4.5.3">𝑖</ci></apply><vector id="S4.SS1.SSS3.p5.2.m2.4.4.3.4.cmml" xref="S4.SS1.SSS3.p5.2.m2.4.4.3.3"><apply id="S4.SS1.SSS3.p5.2.m2.2.2.1.1.1.cmml" xref="S4.SS1.SSS3.p5.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p5.2.m2.2.2.1.1.1.1.cmml" xref="S4.SS1.SSS3.p5.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS3.p5.2.m2.2.2.1.1.1.2.cmml" xref="S4.SS1.SSS3.p5.2.m2.2.2.1.1.1.2">𝑥</ci><apply id="S4.SS1.SSS3.p5.2.m2.2.2.1.1.1.3.cmml" xref="S4.SS1.SSS3.p5.2.m2.2.2.1.1.1.3"><times id="S4.SS1.SSS3.p5.2.m2.2.2.1.1.1.3.1.cmml" xref="S4.SS1.SSS3.p5.2.m2.2.2.1.1.1.3.1"></times><ci id="S4.SS1.SSS3.p5.2.m2.2.2.1.1.1.3.2.cmml" xref="S4.SS1.SSS3.p5.2.m2.2.2.1.1.1.3.2">𝑖</ci><cn id="S4.SS1.SSS3.p5.2.m2.2.2.1.1.1.3.3.cmml" type="integer" xref="S4.SS1.SSS3.p5.2.m2.2.2.1.1.1.3.3">1</cn></apply></apply><apply id="S4.SS1.SSS3.p5.2.m2.3.3.2.2.2.cmml" xref="S4.SS1.SSS3.p5.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p5.2.m2.3.3.2.2.2.1.cmml" xref="S4.SS1.SSS3.p5.2.m2.3.3.2.2.2">subscript</csymbol><ci id="S4.SS1.SSS3.p5.2.m2.3.3.2.2.2.2.cmml" xref="S4.SS1.SSS3.p5.2.m2.3.3.2.2.2.2">𝑥</ci><apply id="S4.SS1.SSS3.p5.2.m2.3.3.2.2.2.3.cmml" xref="S4.SS1.SSS3.p5.2.m2.3.3.2.2.2.3"><times id="S4.SS1.SSS3.p5.2.m2.3.3.2.2.2.3.1.cmml" xref="S4.SS1.SSS3.p5.2.m2.3.3.2.2.2.3.1"></times><ci id="S4.SS1.SSS3.p5.2.m2.3.3.2.2.2.3.2.cmml" xref="S4.SS1.SSS3.p5.2.m2.3.3.2.2.2.3.2">𝑖</ci><cn id="S4.SS1.SSS3.p5.2.m2.3.3.2.2.2.3.3.cmml" type="integer" xref="S4.SS1.SSS3.p5.2.m2.3.3.2.2.2.3.3">2</cn></apply></apply><ci id="S4.SS1.SSS3.p5.2.m2.1.1.cmml" xref="S4.SS1.SSS3.p5.2.m2.1.1">…</ci><apply id="S4.SS1.SSS3.p5.2.m2.4.4.3.3.3.cmml" xref="S4.SS1.SSS3.p5.2.m2.4.4.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p5.2.m2.4.4.3.3.3.1.cmml" xref="S4.SS1.SSS3.p5.2.m2.4.4.3.3.3">subscript</csymbol><ci id="S4.SS1.SSS3.p5.2.m2.4.4.3.3.3.2.cmml" xref="S4.SS1.SSS3.p5.2.m2.4.4.3.3.3.2">𝑥</ci><apply id="S4.SS1.SSS3.p5.2.m2.4.4.3.3.3.3.cmml" xref="S4.SS1.SSS3.p5.2.m2.4.4.3.3.3.3"><times id="S4.SS1.SSS3.p5.2.m2.4.4.3.3.3.3.1.cmml" xref="S4.SS1.SSS3.p5.2.m2.4.4.3.3.3.3.1"></times><ci id="S4.SS1.SSS3.p5.2.m2.4.4.3.3.3.3.2.cmml" xref="S4.SS1.SSS3.p5.2.m2.4.4.3.3.3.3.2">𝑖</ci><ci id="S4.SS1.SSS3.p5.2.m2.4.4.3.3.3.3.3.cmml" xref="S4.SS1.SSS3.p5.2.m2.4.4.3.3.3.3.3">𝑚</ci></apply></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p5.2.m2.4c">x_{i}=(x_{i1},x_{i2},...,x_{im})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.p5.2.m2.4d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = ( italic_x start_POSTSUBSCRIPT italic_i 1 end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT italic_i 2 end_POSTSUBSCRIPT , … , italic_x start_POSTSUBSCRIPT italic_i italic_m end_POSTSUBSCRIPT )</annotation></semantics></math> represents a data point, i.e., a 17-dimensional POI vector of a base station ID.</p>
</div>
<div class="ltx_para" id="S4.SS1.SSS3.p6">
<p class="ltx_p" id="S4.SS1.SSS3.p6.3">Before the iteration process, we need to initialize the modes <math alttext="Z=\{z_{1},z_{2},...,z_{k}\}" class="ltx_Math" display="inline" id="S4.SS1.SSS3.p6.1.m1.4"><semantics id="S4.SS1.SSS3.p6.1.m1.4a"><mrow id="S4.SS1.SSS3.p6.1.m1.4.4" xref="S4.SS1.SSS3.p6.1.m1.4.4.cmml"><mi id="S4.SS1.SSS3.p6.1.m1.4.4.5" xref="S4.SS1.SSS3.p6.1.m1.4.4.5.cmml">Z</mi><mo id="S4.SS1.SSS3.p6.1.m1.4.4.4" xref="S4.SS1.SSS3.p6.1.m1.4.4.4.cmml">=</mo><mrow id="S4.SS1.SSS3.p6.1.m1.4.4.3.3" xref="S4.SS1.SSS3.p6.1.m1.4.4.3.4.cmml"><mo id="S4.SS1.SSS3.p6.1.m1.4.4.3.3.4" stretchy="false" xref="S4.SS1.SSS3.p6.1.m1.4.4.3.4.cmml">{</mo><msub id="S4.SS1.SSS3.p6.1.m1.2.2.1.1.1" xref="S4.SS1.SSS3.p6.1.m1.2.2.1.1.1.cmml"><mi id="S4.SS1.SSS3.p6.1.m1.2.2.1.1.1.2" xref="S4.SS1.SSS3.p6.1.m1.2.2.1.1.1.2.cmml">z</mi><mn id="S4.SS1.SSS3.p6.1.m1.2.2.1.1.1.3" xref="S4.SS1.SSS3.p6.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S4.SS1.SSS3.p6.1.m1.4.4.3.3.5" xref="S4.SS1.SSS3.p6.1.m1.4.4.3.4.cmml">,</mo><msub id="S4.SS1.SSS3.p6.1.m1.3.3.2.2.2" xref="S4.SS1.SSS3.p6.1.m1.3.3.2.2.2.cmml"><mi id="S4.SS1.SSS3.p6.1.m1.3.3.2.2.2.2" xref="S4.SS1.SSS3.p6.1.m1.3.3.2.2.2.2.cmml">z</mi><mn id="S4.SS1.SSS3.p6.1.m1.3.3.2.2.2.3" xref="S4.SS1.SSS3.p6.1.m1.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S4.SS1.SSS3.p6.1.m1.4.4.3.3.6" xref="S4.SS1.SSS3.p6.1.m1.4.4.3.4.cmml">,</mo><mi id="S4.SS1.SSS3.p6.1.m1.1.1" mathvariant="normal" xref="S4.SS1.SSS3.p6.1.m1.1.1.cmml">…</mi><mo id="S4.SS1.SSS3.p6.1.m1.4.4.3.3.7" xref="S4.SS1.SSS3.p6.1.m1.4.4.3.4.cmml">,</mo><msub id="S4.SS1.SSS3.p6.1.m1.4.4.3.3.3" xref="S4.SS1.SSS3.p6.1.m1.4.4.3.3.3.cmml"><mi id="S4.SS1.SSS3.p6.1.m1.4.4.3.3.3.2" xref="S4.SS1.SSS3.p6.1.m1.4.4.3.3.3.2.cmml">z</mi><mi id="S4.SS1.SSS3.p6.1.m1.4.4.3.3.3.3" xref="S4.SS1.SSS3.p6.1.m1.4.4.3.3.3.3.cmml">k</mi></msub><mo id="S4.SS1.SSS3.p6.1.m1.4.4.3.3.8" stretchy="false" xref="S4.SS1.SSS3.p6.1.m1.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p6.1.m1.4b"><apply id="S4.SS1.SSS3.p6.1.m1.4.4.cmml" xref="S4.SS1.SSS3.p6.1.m1.4.4"><eq id="S4.SS1.SSS3.p6.1.m1.4.4.4.cmml" xref="S4.SS1.SSS3.p6.1.m1.4.4.4"></eq><ci id="S4.SS1.SSS3.p6.1.m1.4.4.5.cmml" xref="S4.SS1.SSS3.p6.1.m1.4.4.5">𝑍</ci><set id="S4.SS1.SSS3.p6.1.m1.4.4.3.4.cmml" xref="S4.SS1.SSS3.p6.1.m1.4.4.3.3"><apply id="S4.SS1.SSS3.p6.1.m1.2.2.1.1.1.cmml" xref="S4.SS1.SSS3.p6.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p6.1.m1.2.2.1.1.1.1.cmml" xref="S4.SS1.SSS3.p6.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS3.p6.1.m1.2.2.1.1.1.2.cmml" xref="S4.SS1.SSS3.p6.1.m1.2.2.1.1.1.2">𝑧</ci><cn id="S4.SS1.SSS3.p6.1.m1.2.2.1.1.1.3.cmml" type="integer" xref="S4.SS1.SSS3.p6.1.m1.2.2.1.1.1.3">1</cn></apply><apply id="S4.SS1.SSS3.p6.1.m1.3.3.2.2.2.cmml" xref="S4.SS1.SSS3.p6.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p6.1.m1.3.3.2.2.2.1.cmml" xref="S4.SS1.SSS3.p6.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S4.SS1.SSS3.p6.1.m1.3.3.2.2.2.2.cmml" xref="S4.SS1.SSS3.p6.1.m1.3.3.2.2.2.2">𝑧</ci><cn id="S4.SS1.SSS3.p6.1.m1.3.3.2.2.2.3.cmml" type="integer" xref="S4.SS1.SSS3.p6.1.m1.3.3.2.2.2.3">2</cn></apply><ci id="S4.SS1.SSS3.p6.1.m1.1.1.cmml" xref="S4.SS1.SSS3.p6.1.m1.1.1">…</ci><apply id="S4.SS1.SSS3.p6.1.m1.4.4.3.3.3.cmml" xref="S4.SS1.SSS3.p6.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p6.1.m1.4.4.3.3.3.1.cmml" xref="S4.SS1.SSS3.p6.1.m1.4.4.3.3.3">subscript</csymbol><ci id="S4.SS1.SSS3.p6.1.m1.4.4.3.3.3.2.cmml" xref="S4.SS1.SSS3.p6.1.m1.4.4.3.3.3.2">𝑧</ci><ci id="S4.SS1.SSS3.p6.1.m1.4.4.3.3.3.3.cmml" xref="S4.SS1.SSS3.p6.1.m1.4.4.3.3.3.3">𝑘</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p6.1.m1.4c">Z=\{z_{1},z_{2},...,z_{k}\}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.p6.1.m1.4d">italic_Z = { italic_z start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_z start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT }</annotation></semantics></math>. One common way to do this is to randomly select <math alttext="k" class="ltx_Math" display="inline" id="S4.SS1.SSS3.p6.2.m2.1"><semantics id="S4.SS1.SSS3.p6.2.m2.1a"><mi id="S4.SS1.SSS3.p6.2.m2.1.1" xref="S4.SS1.SSS3.p6.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p6.2.m2.1b"><ci id="S4.SS1.SSS3.p6.2.m2.1.1.cmml" xref="S4.SS1.SSS3.p6.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p6.2.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.p6.2.m2.1d">italic_k</annotation></semantics></math> data points from the dataset <math alttext="X" class="ltx_Math" display="inline" id="S4.SS1.SSS3.p6.3.m3.1"><semantics id="S4.SS1.SSS3.p6.3.m3.1a"><mi id="S4.SS1.SSS3.p6.3.m3.1.1" xref="S4.SS1.SSS3.p6.3.m3.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p6.3.m3.1b"><ci id="S4.SS1.SSS3.p6.3.m3.1.1.cmml" xref="S4.SS1.SSS3.p6.3.m3.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p6.3.m3.1c">X</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.p6.3.m3.1d">italic_X</annotation></semantics></math> as the initial modes.</p>
</div>
<div class="ltx_para" id="S4.SS1.SSS3.p7">
<p class="ltx_p" id="S4.SS1.SSS3.p7.5">Let <math alttext="Z=\{z_{1},z_{2},...,z_{k}\}" class="ltx_Math" display="inline" id="S4.SS1.SSS3.p7.1.m1.4"><semantics id="S4.SS1.SSS3.p7.1.m1.4a"><mrow id="S4.SS1.SSS3.p7.1.m1.4.4" xref="S4.SS1.SSS3.p7.1.m1.4.4.cmml"><mi id="S4.SS1.SSS3.p7.1.m1.4.4.5" xref="S4.SS1.SSS3.p7.1.m1.4.4.5.cmml">Z</mi><mo id="S4.SS1.SSS3.p7.1.m1.4.4.4" xref="S4.SS1.SSS3.p7.1.m1.4.4.4.cmml">=</mo><mrow id="S4.SS1.SSS3.p7.1.m1.4.4.3.3" xref="S4.SS1.SSS3.p7.1.m1.4.4.3.4.cmml"><mo id="S4.SS1.SSS3.p7.1.m1.4.4.3.3.4" stretchy="false" xref="S4.SS1.SSS3.p7.1.m1.4.4.3.4.cmml">{</mo><msub id="S4.SS1.SSS3.p7.1.m1.2.2.1.1.1" xref="S4.SS1.SSS3.p7.1.m1.2.2.1.1.1.cmml"><mi id="S4.SS1.SSS3.p7.1.m1.2.2.1.1.1.2" xref="S4.SS1.SSS3.p7.1.m1.2.2.1.1.1.2.cmml">z</mi><mn id="S4.SS1.SSS3.p7.1.m1.2.2.1.1.1.3" xref="S4.SS1.SSS3.p7.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S4.SS1.SSS3.p7.1.m1.4.4.3.3.5" xref="S4.SS1.SSS3.p7.1.m1.4.4.3.4.cmml">,</mo><msub id="S4.SS1.SSS3.p7.1.m1.3.3.2.2.2" xref="S4.SS1.SSS3.p7.1.m1.3.3.2.2.2.cmml"><mi id="S4.SS1.SSS3.p7.1.m1.3.3.2.2.2.2" xref="S4.SS1.SSS3.p7.1.m1.3.3.2.2.2.2.cmml">z</mi><mn id="S4.SS1.SSS3.p7.1.m1.3.3.2.2.2.3" xref="S4.SS1.SSS3.p7.1.m1.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S4.SS1.SSS3.p7.1.m1.4.4.3.3.6" xref="S4.SS1.SSS3.p7.1.m1.4.4.3.4.cmml">,</mo><mi id="S4.SS1.SSS3.p7.1.m1.1.1" mathvariant="normal" xref="S4.SS1.SSS3.p7.1.m1.1.1.cmml">…</mi><mo id="S4.SS1.SSS3.p7.1.m1.4.4.3.3.7" xref="S4.SS1.SSS3.p7.1.m1.4.4.3.4.cmml">,</mo><msub id="S4.SS1.SSS3.p7.1.m1.4.4.3.3.3" xref="S4.SS1.SSS3.p7.1.m1.4.4.3.3.3.cmml"><mi id="S4.SS1.SSS3.p7.1.m1.4.4.3.3.3.2" xref="S4.SS1.SSS3.p7.1.m1.4.4.3.3.3.2.cmml">z</mi><mi id="S4.SS1.SSS3.p7.1.m1.4.4.3.3.3.3" xref="S4.SS1.SSS3.p7.1.m1.4.4.3.3.3.3.cmml">k</mi></msub><mo id="S4.SS1.SSS3.p7.1.m1.4.4.3.3.8" stretchy="false" xref="S4.SS1.SSS3.p7.1.m1.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p7.1.m1.4b"><apply id="S4.SS1.SSS3.p7.1.m1.4.4.cmml" xref="S4.SS1.SSS3.p7.1.m1.4.4"><eq id="S4.SS1.SSS3.p7.1.m1.4.4.4.cmml" xref="S4.SS1.SSS3.p7.1.m1.4.4.4"></eq><ci id="S4.SS1.SSS3.p7.1.m1.4.4.5.cmml" xref="S4.SS1.SSS3.p7.1.m1.4.4.5">𝑍</ci><set id="S4.SS1.SSS3.p7.1.m1.4.4.3.4.cmml" xref="S4.SS1.SSS3.p7.1.m1.4.4.3.3"><apply id="S4.SS1.SSS3.p7.1.m1.2.2.1.1.1.cmml" xref="S4.SS1.SSS3.p7.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p7.1.m1.2.2.1.1.1.1.cmml" xref="S4.SS1.SSS3.p7.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS3.p7.1.m1.2.2.1.1.1.2.cmml" xref="S4.SS1.SSS3.p7.1.m1.2.2.1.1.1.2">𝑧</ci><cn id="S4.SS1.SSS3.p7.1.m1.2.2.1.1.1.3.cmml" type="integer" xref="S4.SS1.SSS3.p7.1.m1.2.2.1.1.1.3">1</cn></apply><apply id="S4.SS1.SSS3.p7.1.m1.3.3.2.2.2.cmml" xref="S4.SS1.SSS3.p7.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p7.1.m1.3.3.2.2.2.1.cmml" xref="S4.SS1.SSS3.p7.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S4.SS1.SSS3.p7.1.m1.3.3.2.2.2.2.cmml" xref="S4.SS1.SSS3.p7.1.m1.3.3.2.2.2.2">𝑧</ci><cn id="S4.SS1.SSS3.p7.1.m1.3.3.2.2.2.3.cmml" type="integer" xref="S4.SS1.SSS3.p7.1.m1.3.3.2.2.2.3">2</cn></apply><ci id="S4.SS1.SSS3.p7.1.m1.1.1.cmml" xref="S4.SS1.SSS3.p7.1.m1.1.1">…</ci><apply id="S4.SS1.SSS3.p7.1.m1.4.4.3.3.3.cmml" xref="S4.SS1.SSS3.p7.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p7.1.m1.4.4.3.3.3.1.cmml" xref="S4.SS1.SSS3.p7.1.m1.4.4.3.3.3">subscript</csymbol><ci id="S4.SS1.SSS3.p7.1.m1.4.4.3.3.3.2.cmml" xref="S4.SS1.SSS3.p7.1.m1.4.4.3.3.3.2">𝑧</ci><ci id="S4.SS1.SSS3.p7.1.m1.4.4.3.3.3.3.cmml" xref="S4.SS1.SSS3.p7.1.m1.4.4.3.3.3.3">𝑘</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p7.1.m1.4c">Z=\{z_{1},z_{2},...,z_{k}\}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.p7.1.m1.4d">italic_Z = { italic_z start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_z start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT }</annotation></semantics></math> be the current set of modes, where each <math alttext="z_{j}=(z_{j1},z_{j2},...,z_{jm})" class="ltx_Math" display="inline" id="S4.SS1.SSS3.p7.2.m2.4"><semantics id="S4.SS1.SSS3.p7.2.m2.4a"><mrow id="S4.SS1.SSS3.p7.2.m2.4.4" xref="S4.SS1.SSS3.p7.2.m2.4.4.cmml"><msub id="S4.SS1.SSS3.p7.2.m2.4.4.5" xref="S4.SS1.SSS3.p7.2.m2.4.4.5.cmml"><mi id="S4.SS1.SSS3.p7.2.m2.4.4.5.2" xref="S4.SS1.SSS3.p7.2.m2.4.4.5.2.cmml">z</mi><mi id="S4.SS1.SSS3.p7.2.m2.4.4.5.3" xref="S4.SS1.SSS3.p7.2.m2.4.4.5.3.cmml">j</mi></msub><mo id="S4.SS1.SSS3.p7.2.m2.4.4.4" xref="S4.SS1.SSS3.p7.2.m2.4.4.4.cmml">=</mo><mrow id="S4.SS1.SSS3.p7.2.m2.4.4.3.3" xref="S4.SS1.SSS3.p7.2.m2.4.4.3.4.cmml"><mo id="S4.SS1.SSS3.p7.2.m2.4.4.3.3.4" stretchy="false" xref="S4.SS1.SSS3.p7.2.m2.4.4.3.4.cmml">(</mo><msub id="S4.SS1.SSS3.p7.2.m2.2.2.1.1.1" xref="S4.SS1.SSS3.p7.2.m2.2.2.1.1.1.cmml"><mi id="S4.SS1.SSS3.p7.2.m2.2.2.1.1.1.2" xref="S4.SS1.SSS3.p7.2.m2.2.2.1.1.1.2.cmml">z</mi><mrow id="S4.SS1.SSS3.p7.2.m2.2.2.1.1.1.3" xref="S4.SS1.SSS3.p7.2.m2.2.2.1.1.1.3.cmml"><mi id="S4.SS1.SSS3.p7.2.m2.2.2.1.1.1.3.2" xref="S4.SS1.SSS3.p7.2.m2.2.2.1.1.1.3.2.cmml">j</mi><mo id="S4.SS1.SSS3.p7.2.m2.2.2.1.1.1.3.1" xref="S4.SS1.SSS3.p7.2.m2.2.2.1.1.1.3.1.cmml">⁢</mo><mn id="S4.SS1.SSS3.p7.2.m2.2.2.1.1.1.3.3" xref="S4.SS1.SSS3.p7.2.m2.2.2.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S4.SS1.SSS3.p7.2.m2.4.4.3.3.5" xref="S4.SS1.SSS3.p7.2.m2.4.4.3.4.cmml">,</mo><msub id="S4.SS1.SSS3.p7.2.m2.3.3.2.2.2" xref="S4.SS1.SSS3.p7.2.m2.3.3.2.2.2.cmml"><mi id="S4.SS1.SSS3.p7.2.m2.3.3.2.2.2.2" xref="S4.SS1.SSS3.p7.2.m2.3.3.2.2.2.2.cmml">z</mi><mrow id="S4.SS1.SSS3.p7.2.m2.3.3.2.2.2.3" xref="S4.SS1.SSS3.p7.2.m2.3.3.2.2.2.3.cmml"><mi id="S4.SS1.SSS3.p7.2.m2.3.3.2.2.2.3.2" xref="S4.SS1.SSS3.p7.2.m2.3.3.2.2.2.3.2.cmml">j</mi><mo id="S4.SS1.SSS3.p7.2.m2.3.3.2.2.2.3.1" xref="S4.SS1.SSS3.p7.2.m2.3.3.2.2.2.3.1.cmml">⁢</mo><mn id="S4.SS1.SSS3.p7.2.m2.3.3.2.2.2.3.3" xref="S4.SS1.SSS3.p7.2.m2.3.3.2.2.2.3.3.cmml">2</mn></mrow></msub><mo id="S4.SS1.SSS3.p7.2.m2.4.4.3.3.6" xref="S4.SS1.SSS3.p7.2.m2.4.4.3.4.cmml">,</mo><mi id="S4.SS1.SSS3.p7.2.m2.1.1" mathvariant="normal" xref="S4.SS1.SSS3.p7.2.m2.1.1.cmml">…</mi><mo id="S4.SS1.SSS3.p7.2.m2.4.4.3.3.7" xref="S4.SS1.SSS3.p7.2.m2.4.4.3.4.cmml">,</mo><msub id="S4.SS1.SSS3.p7.2.m2.4.4.3.3.3" xref="S4.SS1.SSS3.p7.2.m2.4.4.3.3.3.cmml"><mi id="S4.SS1.SSS3.p7.2.m2.4.4.3.3.3.2" xref="S4.SS1.SSS3.p7.2.m2.4.4.3.3.3.2.cmml">z</mi><mrow id="S4.SS1.SSS3.p7.2.m2.4.4.3.3.3.3" xref="S4.SS1.SSS3.p7.2.m2.4.4.3.3.3.3.cmml"><mi id="S4.SS1.SSS3.p7.2.m2.4.4.3.3.3.3.2" xref="S4.SS1.SSS3.p7.2.m2.4.4.3.3.3.3.2.cmml">j</mi><mo id="S4.SS1.SSS3.p7.2.m2.4.4.3.3.3.3.1" xref="S4.SS1.SSS3.p7.2.m2.4.4.3.3.3.3.1.cmml">⁢</mo><mi id="S4.SS1.SSS3.p7.2.m2.4.4.3.3.3.3.3" xref="S4.SS1.SSS3.p7.2.m2.4.4.3.3.3.3.3.cmml">m</mi></mrow></msub><mo id="S4.SS1.SSS3.p7.2.m2.4.4.3.3.8" stretchy="false" xref="S4.SS1.SSS3.p7.2.m2.4.4.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p7.2.m2.4b"><apply id="S4.SS1.SSS3.p7.2.m2.4.4.cmml" xref="S4.SS1.SSS3.p7.2.m2.4.4"><eq id="S4.SS1.SSS3.p7.2.m2.4.4.4.cmml" xref="S4.SS1.SSS3.p7.2.m2.4.4.4"></eq><apply id="S4.SS1.SSS3.p7.2.m2.4.4.5.cmml" xref="S4.SS1.SSS3.p7.2.m2.4.4.5"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p7.2.m2.4.4.5.1.cmml" xref="S4.SS1.SSS3.p7.2.m2.4.4.5">subscript</csymbol><ci id="S4.SS1.SSS3.p7.2.m2.4.4.5.2.cmml" xref="S4.SS1.SSS3.p7.2.m2.4.4.5.2">𝑧</ci><ci id="S4.SS1.SSS3.p7.2.m2.4.4.5.3.cmml" xref="S4.SS1.SSS3.p7.2.m2.4.4.5.3">𝑗</ci></apply><vector id="S4.SS1.SSS3.p7.2.m2.4.4.3.4.cmml" xref="S4.SS1.SSS3.p7.2.m2.4.4.3.3"><apply id="S4.SS1.SSS3.p7.2.m2.2.2.1.1.1.cmml" xref="S4.SS1.SSS3.p7.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p7.2.m2.2.2.1.1.1.1.cmml" xref="S4.SS1.SSS3.p7.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS3.p7.2.m2.2.2.1.1.1.2.cmml" xref="S4.SS1.SSS3.p7.2.m2.2.2.1.1.1.2">𝑧</ci><apply id="S4.SS1.SSS3.p7.2.m2.2.2.1.1.1.3.cmml" xref="S4.SS1.SSS3.p7.2.m2.2.2.1.1.1.3"><times id="S4.SS1.SSS3.p7.2.m2.2.2.1.1.1.3.1.cmml" xref="S4.SS1.SSS3.p7.2.m2.2.2.1.1.1.3.1"></times><ci id="S4.SS1.SSS3.p7.2.m2.2.2.1.1.1.3.2.cmml" xref="S4.SS1.SSS3.p7.2.m2.2.2.1.1.1.3.2">𝑗</ci><cn id="S4.SS1.SSS3.p7.2.m2.2.2.1.1.1.3.3.cmml" type="integer" xref="S4.SS1.SSS3.p7.2.m2.2.2.1.1.1.3.3">1</cn></apply></apply><apply id="S4.SS1.SSS3.p7.2.m2.3.3.2.2.2.cmml" xref="S4.SS1.SSS3.p7.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p7.2.m2.3.3.2.2.2.1.cmml" xref="S4.SS1.SSS3.p7.2.m2.3.3.2.2.2">subscript</csymbol><ci id="S4.SS1.SSS3.p7.2.m2.3.3.2.2.2.2.cmml" xref="S4.SS1.SSS3.p7.2.m2.3.3.2.2.2.2">𝑧</ci><apply id="S4.SS1.SSS3.p7.2.m2.3.3.2.2.2.3.cmml" xref="S4.SS1.SSS3.p7.2.m2.3.3.2.2.2.3"><times id="S4.SS1.SSS3.p7.2.m2.3.3.2.2.2.3.1.cmml" xref="S4.SS1.SSS3.p7.2.m2.3.3.2.2.2.3.1"></times><ci id="S4.SS1.SSS3.p7.2.m2.3.3.2.2.2.3.2.cmml" xref="S4.SS1.SSS3.p7.2.m2.3.3.2.2.2.3.2">𝑗</ci><cn id="S4.SS1.SSS3.p7.2.m2.3.3.2.2.2.3.3.cmml" type="integer" xref="S4.SS1.SSS3.p7.2.m2.3.3.2.2.2.3.3">2</cn></apply></apply><ci id="S4.SS1.SSS3.p7.2.m2.1.1.cmml" xref="S4.SS1.SSS3.p7.2.m2.1.1">…</ci><apply id="S4.SS1.SSS3.p7.2.m2.4.4.3.3.3.cmml" xref="S4.SS1.SSS3.p7.2.m2.4.4.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p7.2.m2.4.4.3.3.3.1.cmml" xref="S4.SS1.SSS3.p7.2.m2.4.4.3.3.3">subscript</csymbol><ci id="S4.SS1.SSS3.p7.2.m2.4.4.3.3.3.2.cmml" xref="S4.SS1.SSS3.p7.2.m2.4.4.3.3.3.2">𝑧</ci><apply id="S4.SS1.SSS3.p7.2.m2.4.4.3.3.3.3.cmml" xref="S4.SS1.SSS3.p7.2.m2.4.4.3.3.3.3"><times id="S4.SS1.SSS3.p7.2.m2.4.4.3.3.3.3.1.cmml" xref="S4.SS1.SSS3.p7.2.m2.4.4.3.3.3.3.1"></times><ci id="S4.SS1.SSS3.p7.2.m2.4.4.3.3.3.3.2.cmml" xref="S4.SS1.SSS3.p7.2.m2.4.4.3.3.3.3.2">𝑗</ci><ci id="S4.SS1.SSS3.p7.2.m2.4.4.3.3.3.3.3.cmml" xref="S4.SS1.SSS3.p7.2.m2.4.4.3.3.3.3.3">𝑚</ci></apply></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p7.2.m2.4c">z_{j}=(z_{j1},z_{j2},...,z_{jm})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.p7.2.m2.4d">italic_z start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT = ( italic_z start_POSTSUBSCRIPT italic_j 1 end_POSTSUBSCRIPT , italic_z start_POSTSUBSCRIPT italic_j 2 end_POSTSUBSCRIPT , … , italic_z start_POSTSUBSCRIPT italic_j italic_m end_POSTSUBSCRIPT )</annotation></semantics></math> is a mode. The dissimilarity measure or mode distance <math alttext="d(x_{i},z_{j})" class="ltx_Math" display="inline" id="S4.SS1.SSS3.p7.3.m3.2"><semantics id="S4.SS1.SSS3.p7.3.m3.2a"><mrow id="S4.SS1.SSS3.p7.3.m3.2.2" xref="S4.SS1.SSS3.p7.3.m3.2.2.cmml"><mi id="S4.SS1.SSS3.p7.3.m3.2.2.4" xref="S4.SS1.SSS3.p7.3.m3.2.2.4.cmml">d</mi><mo id="S4.SS1.SSS3.p7.3.m3.2.2.3" xref="S4.SS1.SSS3.p7.3.m3.2.2.3.cmml">⁢</mo><mrow id="S4.SS1.SSS3.p7.3.m3.2.2.2.2" xref="S4.SS1.SSS3.p7.3.m3.2.2.2.3.cmml"><mo id="S4.SS1.SSS3.p7.3.m3.2.2.2.2.3" stretchy="false" xref="S4.SS1.SSS3.p7.3.m3.2.2.2.3.cmml">(</mo><msub id="S4.SS1.SSS3.p7.3.m3.1.1.1.1.1" xref="S4.SS1.SSS3.p7.3.m3.1.1.1.1.1.cmml"><mi id="S4.SS1.SSS3.p7.3.m3.1.1.1.1.1.2" xref="S4.SS1.SSS3.p7.3.m3.1.1.1.1.1.2.cmml">x</mi><mi id="S4.SS1.SSS3.p7.3.m3.1.1.1.1.1.3" xref="S4.SS1.SSS3.p7.3.m3.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.SS1.SSS3.p7.3.m3.2.2.2.2.4" xref="S4.SS1.SSS3.p7.3.m3.2.2.2.3.cmml">,</mo><msub id="S4.SS1.SSS3.p7.3.m3.2.2.2.2.2" xref="S4.SS1.SSS3.p7.3.m3.2.2.2.2.2.cmml"><mi id="S4.SS1.SSS3.p7.3.m3.2.2.2.2.2.2" xref="S4.SS1.SSS3.p7.3.m3.2.2.2.2.2.2.cmml">z</mi><mi id="S4.SS1.SSS3.p7.3.m3.2.2.2.2.2.3" xref="S4.SS1.SSS3.p7.3.m3.2.2.2.2.2.3.cmml">j</mi></msub><mo id="S4.SS1.SSS3.p7.3.m3.2.2.2.2.5" stretchy="false" xref="S4.SS1.SSS3.p7.3.m3.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p7.3.m3.2b"><apply id="S4.SS1.SSS3.p7.3.m3.2.2.cmml" xref="S4.SS1.SSS3.p7.3.m3.2.2"><times id="S4.SS1.SSS3.p7.3.m3.2.2.3.cmml" xref="S4.SS1.SSS3.p7.3.m3.2.2.3"></times><ci id="S4.SS1.SSS3.p7.3.m3.2.2.4.cmml" xref="S4.SS1.SSS3.p7.3.m3.2.2.4">𝑑</ci><interval closure="open" id="S4.SS1.SSS3.p7.3.m3.2.2.2.3.cmml" xref="S4.SS1.SSS3.p7.3.m3.2.2.2.2"><apply id="S4.SS1.SSS3.p7.3.m3.1.1.1.1.1.cmml" xref="S4.SS1.SSS3.p7.3.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p7.3.m3.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS3.p7.3.m3.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS3.p7.3.m3.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS3.p7.3.m3.1.1.1.1.1.2">𝑥</ci><ci id="S4.SS1.SSS3.p7.3.m3.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS3.p7.3.m3.1.1.1.1.1.3">𝑖</ci></apply><apply id="S4.SS1.SSS3.p7.3.m3.2.2.2.2.2.cmml" xref="S4.SS1.SSS3.p7.3.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p7.3.m3.2.2.2.2.2.1.cmml" xref="S4.SS1.SSS3.p7.3.m3.2.2.2.2.2">subscript</csymbol><ci id="S4.SS1.SSS3.p7.3.m3.2.2.2.2.2.2.cmml" xref="S4.SS1.SSS3.p7.3.m3.2.2.2.2.2.2">𝑧</ci><ci id="S4.SS1.SSS3.p7.3.m3.2.2.2.2.2.3.cmml" xref="S4.SS1.SSS3.p7.3.m3.2.2.2.2.2.3">𝑗</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p7.3.m3.2c">d(x_{i},z_{j})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.p7.3.m3.2d">italic_d ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_z start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT )</annotation></semantics></math> is defined as the number of mismatches between <math alttext="x_{i}" class="ltx_Math" display="inline" id="S4.SS1.SSS3.p7.4.m4.1"><semantics id="S4.SS1.SSS3.p7.4.m4.1a"><msub id="S4.SS1.SSS3.p7.4.m4.1.1" xref="S4.SS1.SSS3.p7.4.m4.1.1.cmml"><mi id="S4.SS1.SSS3.p7.4.m4.1.1.2" xref="S4.SS1.SSS3.p7.4.m4.1.1.2.cmml">x</mi><mi id="S4.SS1.SSS3.p7.4.m4.1.1.3" xref="S4.SS1.SSS3.p7.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p7.4.m4.1b"><apply id="S4.SS1.SSS3.p7.4.m4.1.1.cmml" xref="S4.SS1.SSS3.p7.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p7.4.m4.1.1.1.cmml" xref="S4.SS1.SSS3.p7.4.m4.1.1">subscript</csymbol><ci id="S4.SS1.SSS3.p7.4.m4.1.1.2.cmml" xref="S4.SS1.SSS3.p7.4.m4.1.1.2">𝑥</ci><ci id="S4.SS1.SSS3.p7.4.m4.1.1.3.cmml" xref="S4.SS1.SSS3.p7.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p7.4.m4.1c">x_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.p7.4.m4.1d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="z_{j}" class="ltx_Math" display="inline" id="S4.SS1.SSS3.p7.5.m5.1"><semantics id="S4.SS1.SSS3.p7.5.m5.1a"><msub id="S4.SS1.SSS3.p7.5.m5.1.1" xref="S4.SS1.SSS3.p7.5.m5.1.1.cmml"><mi id="S4.SS1.SSS3.p7.5.m5.1.1.2" xref="S4.SS1.SSS3.p7.5.m5.1.1.2.cmml">z</mi><mi id="S4.SS1.SSS3.p7.5.m5.1.1.3" xref="S4.SS1.SSS3.p7.5.m5.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p7.5.m5.1b"><apply id="S4.SS1.SSS3.p7.5.m5.1.1.cmml" xref="S4.SS1.SSS3.p7.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p7.5.m5.1.1.1.cmml" xref="S4.SS1.SSS3.p7.5.m5.1.1">subscript</csymbol><ci id="S4.SS1.SSS3.p7.5.m5.1.1.2.cmml" xref="S4.SS1.SSS3.p7.5.m5.1.1.2">𝑧</ci><ci id="S4.SS1.SSS3.p7.5.m5.1.1.3.cmml" xref="S4.SS1.SSS3.p7.5.m5.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p7.5.m5.1c">z_{j}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.p7.5.m5.1d">italic_z start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>, i.e.,</p>
</div>
<div class="ltx_para" id="S4.SS1.SSS3.p8">
<table class="ltx_equationgroup ltx_eqn_table" id="S4.E5">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E5X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle d(x_{i},z_{j})=\sum_{q=1}^{m}\delta(x_{iq},z_{jq})" class="ltx_Math" display="inline" id="S4.E5X.2.1.1.m1.4"><semantics id="S4.E5X.2.1.1.m1.4a"><mrow id="S4.E5X.2.1.1.m1.4.4" xref="S4.E5X.2.1.1.m1.4.4.cmml"><mrow id="S4.E5X.2.1.1.m1.2.2.2" xref="S4.E5X.2.1.1.m1.2.2.2.cmml"><mi id="S4.E5X.2.1.1.m1.2.2.2.4" xref="S4.E5X.2.1.1.m1.2.2.2.4.cmml">d</mi><mo id="S4.E5X.2.1.1.m1.2.2.2.3" xref="S4.E5X.2.1.1.m1.2.2.2.3.cmml">⁢</mo><mrow id="S4.E5X.2.1.1.m1.2.2.2.2.2" xref="S4.E5X.2.1.1.m1.2.2.2.2.3.cmml"><mo id="S4.E5X.2.1.1.m1.2.2.2.2.2.3" stretchy="false" xref="S4.E5X.2.1.1.m1.2.2.2.2.3.cmml">(</mo><msub id="S4.E5X.2.1.1.m1.1.1.1.1.1.1" xref="S4.E5X.2.1.1.m1.1.1.1.1.1.1.cmml"><mi id="S4.E5X.2.1.1.m1.1.1.1.1.1.1.2" xref="S4.E5X.2.1.1.m1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S4.E5X.2.1.1.m1.1.1.1.1.1.1.3" xref="S4.E5X.2.1.1.m1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E5X.2.1.1.m1.2.2.2.2.2.4" xref="S4.E5X.2.1.1.m1.2.2.2.2.3.cmml">,</mo><msub id="S4.E5X.2.1.1.m1.2.2.2.2.2.2" xref="S4.E5X.2.1.1.m1.2.2.2.2.2.2.cmml"><mi id="S4.E5X.2.1.1.m1.2.2.2.2.2.2.2" xref="S4.E5X.2.1.1.m1.2.2.2.2.2.2.2.cmml">z</mi><mi id="S4.E5X.2.1.1.m1.2.2.2.2.2.2.3" xref="S4.E5X.2.1.1.m1.2.2.2.2.2.2.3.cmml">j</mi></msub><mo id="S4.E5X.2.1.1.m1.2.2.2.2.2.5" stretchy="false" xref="S4.E5X.2.1.1.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E5X.2.1.1.m1.4.4.5" xref="S4.E5X.2.1.1.m1.4.4.5.cmml">=</mo><mrow id="S4.E5X.2.1.1.m1.4.4.4" xref="S4.E5X.2.1.1.m1.4.4.4.cmml"><mstyle displaystyle="true" id="S4.E5X.2.1.1.m1.4.4.4.3" xref="S4.E5X.2.1.1.m1.4.4.4.3.cmml"><munderover id="S4.E5X.2.1.1.m1.4.4.4.3a" xref="S4.E5X.2.1.1.m1.4.4.4.3.cmml"><mo id="S4.E5X.2.1.1.m1.4.4.4.3.2.2" movablelimits="false" xref="S4.E5X.2.1.1.m1.4.4.4.3.2.2.cmml">∑</mo><mrow id="S4.E5X.2.1.1.m1.4.4.4.3.2.3" xref="S4.E5X.2.1.1.m1.4.4.4.3.2.3.cmml"><mi id="S4.E5X.2.1.1.m1.4.4.4.3.2.3.2" xref="S4.E5X.2.1.1.m1.4.4.4.3.2.3.2.cmml">q</mi><mo id="S4.E5X.2.1.1.m1.4.4.4.3.2.3.1" xref="S4.E5X.2.1.1.m1.4.4.4.3.2.3.1.cmml">=</mo><mn id="S4.E5X.2.1.1.m1.4.4.4.3.2.3.3" xref="S4.E5X.2.1.1.m1.4.4.4.3.2.3.3.cmml">1</mn></mrow><mi id="S4.E5X.2.1.1.m1.4.4.4.3.3" xref="S4.E5X.2.1.1.m1.4.4.4.3.3.cmml">m</mi></munderover></mstyle><mrow id="S4.E5X.2.1.1.m1.4.4.4.2" xref="S4.E5X.2.1.1.m1.4.4.4.2.cmml"><mi id="S4.E5X.2.1.1.m1.4.4.4.2.4" xref="S4.E5X.2.1.1.m1.4.4.4.2.4.cmml">δ</mi><mo id="S4.E5X.2.1.1.m1.4.4.4.2.3" xref="S4.E5X.2.1.1.m1.4.4.4.2.3.cmml">⁢</mo><mrow id="S4.E5X.2.1.1.m1.4.4.4.2.2.2" xref="S4.E5X.2.1.1.m1.4.4.4.2.2.3.cmml"><mo id="S4.E5X.2.1.1.m1.4.4.4.2.2.2.3" stretchy="false" xref="S4.E5X.2.1.1.m1.4.4.4.2.2.3.cmml">(</mo><msub id="S4.E5X.2.1.1.m1.3.3.3.1.1.1.1" xref="S4.E5X.2.1.1.m1.3.3.3.1.1.1.1.cmml"><mi id="S4.E5X.2.1.1.m1.3.3.3.1.1.1.1.2" xref="S4.E5X.2.1.1.m1.3.3.3.1.1.1.1.2.cmml">x</mi><mrow id="S4.E5X.2.1.1.m1.3.3.3.1.1.1.1.3" xref="S4.E5X.2.1.1.m1.3.3.3.1.1.1.1.3.cmml"><mi id="S4.E5X.2.1.1.m1.3.3.3.1.1.1.1.3.2" xref="S4.E5X.2.1.1.m1.3.3.3.1.1.1.1.3.2.cmml">i</mi><mo id="S4.E5X.2.1.1.m1.3.3.3.1.1.1.1.3.1" xref="S4.E5X.2.1.1.m1.3.3.3.1.1.1.1.3.1.cmml">⁢</mo><mi id="S4.E5X.2.1.1.m1.3.3.3.1.1.1.1.3.3" xref="S4.E5X.2.1.1.m1.3.3.3.1.1.1.1.3.3.cmml">q</mi></mrow></msub><mo id="S4.E5X.2.1.1.m1.4.4.4.2.2.2.4" xref="S4.E5X.2.1.1.m1.4.4.4.2.2.3.cmml">,</mo><msub id="S4.E5X.2.1.1.m1.4.4.4.2.2.2.2" xref="S4.E5X.2.1.1.m1.4.4.4.2.2.2.2.cmml"><mi id="S4.E5X.2.1.1.m1.4.4.4.2.2.2.2.2" xref="S4.E5X.2.1.1.m1.4.4.4.2.2.2.2.2.cmml">z</mi><mrow id="S4.E5X.2.1.1.m1.4.4.4.2.2.2.2.3" xref="S4.E5X.2.1.1.m1.4.4.4.2.2.2.2.3.cmml"><mi id="S4.E5X.2.1.1.m1.4.4.4.2.2.2.2.3.2" xref="S4.E5X.2.1.1.m1.4.4.4.2.2.2.2.3.2.cmml">j</mi><mo id="S4.E5X.2.1.1.m1.4.4.4.2.2.2.2.3.1" xref="S4.E5X.2.1.1.m1.4.4.4.2.2.2.2.3.1.cmml">⁢</mo><mi id="S4.E5X.2.1.1.m1.4.4.4.2.2.2.2.3.3" xref="S4.E5X.2.1.1.m1.4.4.4.2.2.2.2.3.3.cmml">q</mi></mrow></msub><mo id="S4.E5X.2.1.1.m1.4.4.4.2.2.2.5" stretchy="false" xref="S4.E5X.2.1.1.m1.4.4.4.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E5X.2.1.1.m1.4b"><apply id="S4.E5X.2.1.1.m1.4.4.cmml" xref="S4.E5X.2.1.1.m1.4.4"><eq id="S4.E5X.2.1.1.m1.4.4.5.cmml" xref="S4.E5X.2.1.1.m1.4.4.5"></eq><apply id="S4.E5X.2.1.1.m1.2.2.2.cmml" xref="S4.E5X.2.1.1.m1.2.2.2"><times id="S4.E5X.2.1.1.m1.2.2.2.3.cmml" xref="S4.E5X.2.1.1.m1.2.2.2.3"></times><ci id="S4.E5X.2.1.1.m1.2.2.2.4.cmml" xref="S4.E5X.2.1.1.m1.2.2.2.4">𝑑</ci><interval closure="open" id="S4.E5X.2.1.1.m1.2.2.2.2.3.cmml" xref="S4.E5X.2.1.1.m1.2.2.2.2.2"><apply id="S4.E5X.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S4.E5X.2.1.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E5X.2.1.1.m1.1.1.1.1.1.1.1.cmml" xref="S4.E5X.2.1.1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E5X.2.1.1.m1.1.1.1.1.1.1.2.cmml" xref="S4.E5X.2.1.1.m1.1.1.1.1.1.1.2">𝑥</ci><ci id="S4.E5X.2.1.1.m1.1.1.1.1.1.1.3.cmml" xref="S4.E5X.2.1.1.m1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S4.E5X.2.1.1.m1.2.2.2.2.2.2.cmml" xref="S4.E5X.2.1.1.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E5X.2.1.1.m1.2.2.2.2.2.2.1.cmml" xref="S4.E5X.2.1.1.m1.2.2.2.2.2.2">subscript</csymbol><ci id="S4.E5X.2.1.1.m1.2.2.2.2.2.2.2.cmml" xref="S4.E5X.2.1.1.m1.2.2.2.2.2.2.2">𝑧</ci><ci id="S4.E5X.2.1.1.m1.2.2.2.2.2.2.3.cmml" xref="S4.E5X.2.1.1.m1.2.2.2.2.2.2.3">𝑗</ci></apply></interval></apply><apply id="S4.E5X.2.1.1.m1.4.4.4.cmml" xref="S4.E5X.2.1.1.m1.4.4.4"><apply id="S4.E5X.2.1.1.m1.4.4.4.3.cmml" xref="S4.E5X.2.1.1.m1.4.4.4.3"><csymbol cd="ambiguous" id="S4.E5X.2.1.1.m1.4.4.4.3.1.cmml" xref="S4.E5X.2.1.1.m1.4.4.4.3">superscript</csymbol><apply id="S4.E5X.2.1.1.m1.4.4.4.3.2.cmml" xref="S4.E5X.2.1.1.m1.4.4.4.3"><csymbol cd="ambiguous" id="S4.E5X.2.1.1.m1.4.4.4.3.2.1.cmml" xref="S4.E5X.2.1.1.m1.4.4.4.3">subscript</csymbol><sum id="S4.E5X.2.1.1.m1.4.4.4.3.2.2.cmml" xref="S4.E5X.2.1.1.m1.4.4.4.3.2.2"></sum><apply id="S4.E5X.2.1.1.m1.4.4.4.3.2.3.cmml" xref="S4.E5X.2.1.1.m1.4.4.4.3.2.3"><eq id="S4.E5X.2.1.1.m1.4.4.4.3.2.3.1.cmml" xref="S4.E5X.2.1.1.m1.4.4.4.3.2.3.1"></eq><ci id="S4.E5X.2.1.1.m1.4.4.4.3.2.3.2.cmml" xref="S4.E5X.2.1.1.m1.4.4.4.3.2.3.2">𝑞</ci><cn id="S4.E5X.2.1.1.m1.4.4.4.3.2.3.3.cmml" type="integer" xref="S4.E5X.2.1.1.m1.4.4.4.3.2.3.3">1</cn></apply></apply><ci id="S4.E5X.2.1.1.m1.4.4.4.3.3.cmml" xref="S4.E5X.2.1.1.m1.4.4.4.3.3">𝑚</ci></apply><apply id="S4.E5X.2.1.1.m1.4.4.4.2.cmml" xref="S4.E5X.2.1.1.m1.4.4.4.2"><times id="S4.E5X.2.1.1.m1.4.4.4.2.3.cmml" xref="S4.E5X.2.1.1.m1.4.4.4.2.3"></times><ci id="S4.E5X.2.1.1.m1.4.4.4.2.4.cmml" xref="S4.E5X.2.1.1.m1.4.4.4.2.4">𝛿</ci><interval closure="open" id="S4.E5X.2.1.1.m1.4.4.4.2.2.3.cmml" xref="S4.E5X.2.1.1.m1.4.4.4.2.2.2"><apply id="S4.E5X.2.1.1.m1.3.3.3.1.1.1.1.cmml" xref="S4.E5X.2.1.1.m1.3.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S4.E5X.2.1.1.m1.3.3.3.1.1.1.1.1.cmml" xref="S4.E5X.2.1.1.m1.3.3.3.1.1.1.1">subscript</csymbol><ci id="S4.E5X.2.1.1.m1.3.3.3.1.1.1.1.2.cmml" xref="S4.E5X.2.1.1.m1.3.3.3.1.1.1.1.2">𝑥</ci><apply id="S4.E5X.2.1.1.m1.3.3.3.1.1.1.1.3.cmml" xref="S4.E5X.2.1.1.m1.3.3.3.1.1.1.1.3"><times id="S4.E5X.2.1.1.m1.3.3.3.1.1.1.1.3.1.cmml" xref="S4.E5X.2.1.1.m1.3.3.3.1.1.1.1.3.1"></times><ci id="S4.E5X.2.1.1.m1.3.3.3.1.1.1.1.3.2.cmml" xref="S4.E5X.2.1.1.m1.3.3.3.1.1.1.1.3.2">𝑖</ci><ci id="S4.E5X.2.1.1.m1.3.3.3.1.1.1.1.3.3.cmml" xref="S4.E5X.2.1.1.m1.3.3.3.1.1.1.1.3.3">𝑞</ci></apply></apply><apply id="S4.E5X.2.1.1.m1.4.4.4.2.2.2.2.cmml" xref="S4.E5X.2.1.1.m1.4.4.4.2.2.2.2"><csymbol cd="ambiguous" id="S4.E5X.2.1.1.m1.4.4.4.2.2.2.2.1.cmml" xref="S4.E5X.2.1.1.m1.4.4.4.2.2.2.2">subscript</csymbol><ci id="S4.E5X.2.1.1.m1.4.4.4.2.2.2.2.2.cmml" xref="S4.E5X.2.1.1.m1.4.4.4.2.2.2.2.2">𝑧</ci><apply id="S4.E5X.2.1.1.m1.4.4.4.2.2.2.2.3.cmml" xref="S4.E5X.2.1.1.m1.4.4.4.2.2.2.2.3"><times id="S4.E5X.2.1.1.m1.4.4.4.2.2.2.2.3.1.cmml" xref="S4.E5X.2.1.1.m1.4.4.4.2.2.2.2.3.1"></times><ci id="S4.E5X.2.1.1.m1.4.4.4.2.2.2.2.3.2.cmml" xref="S4.E5X.2.1.1.m1.4.4.4.2.2.2.2.3.2">𝑗</ci><ci id="S4.E5X.2.1.1.m1.4.4.4.2.2.2.2.3.3.cmml" xref="S4.E5X.2.1.1.m1.4.4.4.2.2.2.2.3.3">𝑞</ci></apply></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5X.2.1.1.m1.4c">\displaystyle d(x_{i},z_{j})=\sum_{q=1}^{m}\delta(x_{iq},z_{jq})</annotation><annotation encoding="application/x-llamapun" id="S4.E5X.2.1.1.m1.4d">italic_d ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_z start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) = ∑ start_POSTSUBSCRIPT italic_q = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT italic_δ ( italic_x start_POSTSUBSCRIPT italic_i italic_q end_POSTSUBSCRIPT , italic_z start_POSTSUBSCRIPT italic_j italic_q end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(5)</span></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_para" id="S4.SS1.SSS3.p9">
<p class="ltx_p" id="S4.SS1.SSS3.p9.1">where <math alttext="\delta(x_{iq},z_{jq})" class="ltx_Math" display="inline" id="S4.SS1.SSS3.p9.1.m1.2"><semantics id="S4.SS1.SSS3.p9.1.m1.2a"><mrow id="S4.SS1.SSS3.p9.1.m1.2.2" xref="S4.SS1.SSS3.p9.1.m1.2.2.cmml"><mi id="S4.SS1.SSS3.p9.1.m1.2.2.4" xref="S4.SS1.SSS3.p9.1.m1.2.2.4.cmml">δ</mi><mo id="S4.SS1.SSS3.p9.1.m1.2.2.3" xref="S4.SS1.SSS3.p9.1.m1.2.2.3.cmml">⁢</mo><mrow id="S4.SS1.SSS3.p9.1.m1.2.2.2.2" xref="S4.SS1.SSS3.p9.1.m1.2.2.2.3.cmml"><mo id="S4.SS1.SSS3.p9.1.m1.2.2.2.2.3" stretchy="false" xref="S4.SS1.SSS3.p9.1.m1.2.2.2.3.cmml">(</mo><msub id="S4.SS1.SSS3.p9.1.m1.1.1.1.1.1" xref="S4.SS1.SSS3.p9.1.m1.1.1.1.1.1.cmml"><mi id="S4.SS1.SSS3.p9.1.m1.1.1.1.1.1.2" xref="S4.SS1.SSS3.p9.1.m1.1.1.1.1.1.2.cmml">x</mi><mrow id="S4.SS1.SSS3.p9.1.m1.1.1.1.1.1.3" xref="S4.SS1.SSS3.p9.1.m1.1.1.1.1.1.3.cmml"><mi id="S4.SS1.SSS3.p9.1.m1.1.1.1.1.1.3.2" xref="S4.SS1.SSS3.p9.1.m1.1.1.1.1.1.3.2.cmml">i</mi><mo id="S4.SS1.SSS3.p9.1.m1.1.1.1.1.1.3.1" xref="S4.SS1.SSS3.p9.1.m1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.SSS3.p9.1.m1.1.1.1.1.1.3.3" xref="S4.SS1.SSS3.p9.1.m1.1.1.1.1.1.3.3.cmml">q</mi></mrow></msub><mo id="S4.SS1.SSS3.p9.1.m1.2.2.2.2.4" xref="S4.SS1.SSS3.p9.1.m1.2.2.2.3.cmml">,</mo><msub id="S4.SS1.SSS3.p9.1.m1.2.2.2.2.2" xref="S4.SS1.SSS3.p9.1.m1.2.2.2.2.2.cmml"><mi id="S4.SS1.SSS3.p9.1.m1.2.2.2.2.2.2" xref="S4.SS1.SSS3.p9.1.m1.2.2.2.2.2.2.cmml">z</mi><mrow id="S4.SS1.SSS3.p9.1.m1.2.2.2.2.2.3" xref="S4.SS1.SSS3.p9.1.m1.2.2.2.2.2.3.cmml"><mi id="S4.SS1.SSS3.p9.1.m1.2.2.2.2.2.3.2" xref="S4.SS1.SSS3.p9.1.m1.2.2.2.2.2.3.2.cmml">j</mi><mo id="S4.SS1.SSS3.p9.1.m1.2.2.2.2.2.3.1" xref="S4.SS1.SSS3.p9.1.m1.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S4.SS1.SSS3.p9.1.m1.2.2.2.2.2.3.3" xref="S4.SS1.SSS3.p9.1.m1.2.2.2.2.2.3.3.cmml">q</mi></mrow></msub><mo id="S4.SS1.SSS3.p9.1.m1.2.2.2.2.5" stretchy="false" xref="S4.SS1.SSS3.p9.1.m1.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p9.1.m1.2b"><apply id="S4.SS1.SSS3.p9.1.m1.2.2.cmml" xref="S4.SS1.SSS3.p9.1.m1.2.2"><times id="S4.SS1.SSS3.p9.1.m1.2.2.3.cmml" xref="S4.SS1.SSS3.p9.1.m1.2.2.3"></times><ci id="S4.SS1.SSS3.p9.1.m1.2.2.4.cmml" xref="S4.SS1.SSS3.p9.1.m1.2.2.4">𝛿</ci><interval closure="open" id="S4.SS1.SSS3.p9.1.m1.2.2.2.3.cmml" xref="S4.SS1.SSS3.p9.1.m1.2.2.2.2"><apply id="S4.SS1.SSS3.p9.1.m1.1.1.1.1.1.cmml" xref="S4.SS1.SSS3.p9.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p9.1.m1.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS3.p9.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS3.p9.1.m1.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS3.p9.1.m1.1.1.1.1.1.2">𝑥</ci><apply id="S4.SS1.SSS3.p9.1.m1.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS3.p9.1.m1.1.1.1.1.1.3"><times id="S4.SS1.SSS3.p9.1.m1.1.1.1.1.1.3.1.cmml" xref="S4.SS1.SSS3.p9.1.m1.1.1.1.1.1.3.1"></times><ci id="S4.SS1.SSS3.p9.1.m1.1.1.1.1.1.3.2.cmml" xref="S4.SS1.SSS3.p9.1.m1.1.1.1.1.1.3.2">𝑖</ci><ci id="S4.SS1.SSS3.p9.1.m1.1.1.1.1.1.3.3.cmml" xref="S4.SS1.SSS3.p9.1.m1.1.1.1.1.1.3.3">𝑞</ci></apply></apply><apply id="S4.SS1.SSS3.p9.1.m1.2.2.2.2.2.cmml" xref="S4.SS1.SSS3.p9.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p9.1.m1.2.2.2.2.2.1.cmml" xref="S4.SS1.SSS3.p9.1.m1.2.2.2.2.2">subscript</csymbol><ci id="S4.SS1.SSS3.p9.1.m1.2.2.2.2.2.2.cmml" xref="S4.SS1.SSS3.p9.1.m1.2.2.2.2.2.2">𝑧</ci><apply id="S4.SS1.SSS3.p9.1.m1.2.2.2.2.2.3.cmml" xref="S4.SS1.SSS3.p9.1.m1.2.2.2.2.2.3"><times id="S4.SS1.SSS3.p9.1.m1.2.2.2.2.2.3.1.cmml" xref="S4.SS1.SSS3.p9.1.m1.2.2.2.2.2.3.1"></times><ci id="S4.SS1.SSS3.p9.1.m1.2.2.2.2.2.3.2.cmml" xref="S4.SS1.SSS3.p9.1.m1.2.2.2.2.2.3.2">𝑗</ci><ci id="S4.SS1.SSS3.p9.1.m1.2.2.2.2.2.3.3.cmml" xref="S4.SS1.SSS3.p9.1.m1.2.2.2.2.2.3.3">𝑞</ci></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p9.1.m1.2c">\delta(x_{iq},z_{jq})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.p9.1.m1.2d">italic_δ ( italic_x start_POSTSUBSCRIPT italic_i italic_q end_POSTSUBSCRIPT , italic_z start_POSTSUBSCRIPT italic_j italic_q end_POSTSUBSCRIPT )</annotation></semantics></math> is a mismatch function defined as follows:</p>
</div>
<div class="ltx_para" id="S4.SS1.SSS3.p10">
<table class="ltx_equationgroup ltx_eqn_table" id="S4.E6">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E6X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\delta(x_{iq},z_{jq})=\begin{cases}0,&amp;\text{if }x_{iq}=z_{jq}\\
1,&amp;\text{otherwise}\end{cases}" class="ltx_Math" display="inline" id="S4.E6X.2.1.1.m1.2"><semantics id="S4.E6X.2.1.1.m1.2a"><mrow id="S4.E6X.2.1.1.m1.2.2" xref="S4.E6X.2.1.1.m1.2.2.cmml"><mrow id="S4.E6X.2.1.1.m1.2.2.2" xref="S4.E6X.2.1.1.m1.2.2.2.cmml"><mi id="S4.E6X.2.1.1.m1.2.2.2.4" xref="S4.E6X.2.1.1.m1.2.2.2.4.cmml">δ</mi><mo id="S4.E6X.2.1.1.m1.2.2.2.3" xref="S4.E6X.2.1.1.m1.2.2.2.3.cmml">⁢</mo><mrow id="S4.E6X.2.1.1.m1.2.2.2.2.2" xref="S4.E6X.2.1.1.m1.2.2.2.2.3.cmml"><mo id="S4.E6X.2.1.1.m1.2.2.2.2.2.3" stretchy="false" xref="S4.E6X.2.1.1.m1.2.2.2.2.3.cmml">(</mo><msub id="S4.E6X.2.1.1.m1.1.1.1.1.1.1" xref="S4.E6X.2.1.1.m1.1.1.1.1.1.1.cmml"><mi id="S4.E6X.2.1.1.m1.1.1.1.1.1.1.2" xref="S4.E6X.2.1.1.m1.1.1.1.1.1.1.2.cmml">x</mi><mrow id="S4.E6X.2.1.1.m1.1.1.1.1.1.1.3" xref="S4.E6X.2.1.1.m1.1.1.1.1.1.1.3.cmml"><mi id="S4.E6X.2.1.1.m1.1.1.1.1.1.1.3.2" xref="S4.E6X.2.1.1.m1.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="S4.E6X.2.1.1.m1.1.1.1.1.1.1.3.1" xref="S4.E6X.2.1.1.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S4.E6X.2.1.1.m1.1.1.1.1.1.1.3.3" xref="S4.E6X.2.1.1.m1.1.1.1.1.1.1.3.3.cmml">q</mi></mrow></msub><mo id="S4.E6X.2.1.1.m1.2.2.2.2.2.4" xref="S4.E6X.2.1.1.m1.2.2.2.2.3.cmml">,</mo><msub id="S4.E6X.2.1.1.m1.2.2.2.2.2.2" xref="S4.E6X.2.1.1.m1.2.2.2.2.2.2.cmml"><mi id="S4.E6X.2.1.1.m1.2.2.2.2.2.2.2" xref="S4.E6X.2.1.1.m1.2.2.2.2.2.2.2.cmml">z</mi><mrow id="S4.E6X.2.1.1.m1.2.2.2.2.2.2.3" xref="S4.E6X.2.1.1.m1.2.2.2.2.2.2.3.cmml"><mi id="S4.E6X.2.1.1.m1.2.2.2.2.2.2.3.2" xref="S4.E6X.2.1.1.m1.2.2.2.2.2.2.3.2.cmml">j</mi><mo id="S4.E6X.2.1.1.m1.2.2.2.2.2.2.3.1" xref="S4.E6X.2.1.1.m1.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S4.E6X.2.1.1.m1.2.2.2.2.2.2.3.3" xref="S4.E6X.2.1.1.m1.2.2.2.2.2.2.3.3.cmml">q</mi></mrow></msub><mo id="S4.E6X.2.1.1.m1.2.2.2.2.2.5" stretchy="false" xref="S4.E6X.2.1.1.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E6X.2.1.1.m1.2.2.3" xref="S4.E6X.2.1.1.m1.2.2.3.cmml">=</mo><mrow id="S4.E6.m1.4.4.4.4.4.4a" xref="S4.E6X.2.1.1.m1.2.2.4.1.cmml"><mo id="S4.E6.m1.4.4.4.4.4.4a.5" xref="S4.E6X.2.1.1.m1.2.2.4.1.1.cmml">{</mo><mtable columnspacing="5pt" id="S4.E6.m1.4.4.4.4.4.4.4a" rowspacing="0pt" xref="S4.E6X.2.1.1.m1.2.2.4.1.cmml"><mtr id="S4.E6.m1.4.4.4.4.4.4.4aa" xref="S4.E6X.2.1.1.m1.2.2.4.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E6.m1.4.4.4.4.4.4.4ab" xref="S4.E6X.2.1.1.m1.2.2.4.1.cmml"><mrow id="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.mf.3" xref="S4.E6X.2.1.1.m1.2.2.4.1.cmml"><mn id="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.mf.1" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.mf.1.cmml">0</mn><mo id="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.mf.3.1" xref="S4.E6X.2.1.1.m1.2.2.4.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E6.m1.4.4.4.4.4.4.4ac" xref="S4.E6X.2.1.1.m1.2.2.4.1.cmml"><mrow id="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf" xref="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.cmml"><mrow id="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.2" xref="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.2.cmml"><mtext id="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.2.2" xref="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.2.2a.cmml">if </mtext><mo id="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1" xref="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.cmml">⁢</mo><msub id="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.2.3" xref="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.2.3.cmml"><mi id="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.2.3.2" xref="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.2.3.2.cmml">x</mi><mrow id="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.2.3.3" xref="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.2.3.3.cmml"><mi id="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.2.3.3.2" xref="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.2.3.3.2.cmml">i</mi><mo id="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.2.3.3.1" xref="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.2.3.3.1.cmml">⁢</mo><mi id="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.2.3.3.3" xref="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.2.3.3.3.cmml">q</mi></mrow></msub></mrow><mo id="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.1" xref="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.1.cmml">=</mo><msub id="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.3" xref="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.3.cmml"><mi id="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.3.2" xref="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.3.2.cmml">z</mi><mrow id="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.3.3" xref="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.3.3.cmml"><mi id="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.3.3.2" xref="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.3.3.2.cmml">j</mi><mo id="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.3.3.1" xref="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.3.3.1.cmml">⁢</mo><mi id="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.3.3.3" xref="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.3.3.3.cmml">q</mi></mrow></msub></mrow></mtd></mtr><mtr id="S4.E6.m1.4.4.4.4.4.4.4ad" xref="S4.E6X.2.1.1.m1.2.2.4.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E6.m1.4.4.4.4.4.4.4ae" xref="S4.E6X.2.1.1.m1.2.2.4.1.cmml"><mrow id="S4.E6.m1.3.3.3.3.3.3.3.3.1.1.mf.3" xref="S4.E6X.2.1.1.m1.2.2.4.1.cmml"><mn id="S4.E6.m1.3.3.3.3.3.3.3.3.1.1.mf.1" xref="S4.E6.m1.3.3.3.3.3.3.3.3.1.1.mf.1.cmml">1</mn><mo id="S4.E6.m1.3.3.3.3.3.3.3.3.1.1.mf.3.1" xref="S4.E6X.2.1.1.m1.2.2.4.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E6.m1.4.4.4.4.4.4.4af" xref="S4.E6X.2.1.1.m1.2.2.4.1.cmml"><mtext id="S4.E6.m1.4.4.4.4.4.4.4.4.2.1.mf" xref="S4.E6.m1.4.4.4.4.4.4.4.4.2.1.mfa.cmml">otherwise</mtext></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E6X.2.1.1.m1.2b"><apply id="S4.E6X.2.1.1.m1.2.2.cmml" xref="S4.E6X.2.1.1.m1.2.2"><eq id="S4.E6X.2.1.1.m1.2.2.3.cmml" xref="S4.E6X.2.1.1.m1.2.2.3"></eq><apply id="S4.E6X.2.1.1.m1.2.2.2.cmml" xref="S4.E6X.2.1.1.m1.2.2.2"><times id="S4.E6X.2.1.1.m1.2.2.2.3.cmml" xref="S4.E6X.2.1.1.m1.2.2.2.3"></times><ci id="S4.E6X.2.1.1.m1.2.2.2.4.cmml" xref="S4.E6X.2.1.1.m1.2.2.2.4">𝛿</ci><interval closure="open" id="S4.E6X.2.1.1.m1.2.2.2.2.3.cmml" xref="S4.E6X.2.1.1.m1.2.2.2.2.2"><apply id="S4.E6X.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S4.E6X.2.1.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6X.2.1.1.m1.1.1.1.1.1.1.1.cmml" xref="S4.E6X.2.1.1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E6X.2.1.1.m1.1.1.1.1.1.1.2.cmml" xref="S4.E6X.2.1.1.m1.1.1.1.1.1.1.2">𝑥</ci><apply id="S4.E6X.2.1.1.m1.1.1.1.1.1.1.3.cmml" xref="S4.E6X.2.1.1.m1.1.1.1.1.1.1.3"><times id="S4.E6X.2.1.1.m1.1.1.1.1.1.1.3.1.cmml" xref="S4.E6X.2.1.1.m1.1.1.1.1.1.1.3.1"></times><ci id="S4.E6X.2.1.1.m1.1.1.1.1.1.1.3.2.cmml" xref="S4.E6X.2.1.1.m1.1.1.1.1.1.1.3.2">𝑖</ci><ci id="S4.E6X.2.1.1.m1.1.1.1.1.1.1.3.3.cmml" xref="S4.E6X.2.1.1.m1.1.1.1.1.1.1.3.3">𝑞</ci></apply></apply><apply id="S4.E6X.2.1.1.m1.2.2.2.2.2.2.cmml" xref="S4.E6X.2.1.1.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E6X.2.1.1.m1.2.2.2.2.2.2.1.cmml" xref="S4.E6X.2.1.1.m1.2.2.2.2.2.2">subscript</csymbol><ci id="S4.E6X.2.1.1.m1.2.2.2.2.2.2.2.cmml" xref="S4.E6X.2.1.1.m1.2.2.2.2.2.2.2">𝑧</ci><apply id="S4.E6X.2.1.1.m1.2.2.2.2.2.2.3.cmml" xref="S4.E6X.2.1.1.m1.2.2.2.2.2.2.3"><times id="S4.E6X.2.1.1.m1.2.2.2.2.2.2.3.1.cmml" xref="S4.E6X.2.1.1.m1.2.2.2.2.2.2.3.1"></times><ci id="S4.E6X.2.1.1.m1.2.2.2.2.2.2.3.2.cmml" xref="S4.E6X.2.1.1.m1.2.2.2.2.2.2.3.2">𝑗</ci><ci id="S4.E6X.2.1.1.m1.2.2.2.2.2.2.3.3.cmml" xref="S4.E6X.2.1.1.m1.2.2.2.2.2.2.3.3">𝑞</ci></apply></apply></interval></apply><apply id="S4.E6X.2.1.1.m1.2.2.4.1.cmml" xref="S4.E6.m1.4.4.4.4.4.4a"><csymbol cd="latexml" id="S4.E6X.2.1.1.m1.2.2.4.1.1.cmml" xref="S4.E6.m1.4.4.4.4.4.4a.5">cases</csymbol><cn id="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.mf.1.cmml" type="integer" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.mf.1">0</cn><apply id="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.cmml" xref="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf"><eq id="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.1.cmml" xref="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.1"></eq><apply id="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.2.cmml" xref="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.2"><times id="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1.cmml" xref="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.2.1"></times><ci id="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.2.2a.cmml" xref="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.2.2"><mtext id="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.2.2.cmml" xref="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.2.2">if </mtext></ci><apply id="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.2.3.cmml" xref="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.2.3"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.2.3.1.cmml" xref="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.2.3">subscript</csymbol><ci id="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.2.3.2.cmml" xref="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.2.3.2">𝑥</ci><apply id="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.2.3.3.cmml" xref="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.2.3.3"><times id="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.2.3.3.1.cmml" xref="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.2.3.3.1"></times><ci id="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.2.3.3.2.cmml" xref="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.2.3.3.2">𝑖</ci><ci id="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.2.3.3.3.cmml" xref="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.2.3.3.3">𝑞</ci></apply></apply></apply><apply id="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.3.cmml" xref="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.3"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.3.1.cmml" xref="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.3">subscript</csymbol><ci id="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.3.2.cmml" xref="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.3.2">𝑧</ci><apply id="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.3.3.cmml" xref="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.3.3"><times id="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.3.3.1.cmml" xref="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.3.3.1"></times><ci id="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.3.3.2.cmml" xref="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.3.3.2">𝑗</ci><ci id="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.3.3.3.cmml" xref="S4.E6.m1.2.2.2.2.2.2.2.2.2.1.mf.3.3.3">𝑞</ci></apply></apply></apply><cn id="S4.E6.m1.3.3.3.3.3.3.3.3.1.1.mf.1.cmml" type="integer" xref="S4.E6.m1.3.3.3.3.3.3.3.3.1.1.mf.1">1</cn><ci id="S4.E6.m1.4.4.4.4.4.4.4.4.2.1.mfa.cmml" xref="S4.E6.m1.4.4.4.4.4.4.4.4.2.1.mf"><mtext id="S4.E6.m1.4.4.4.4.4.4.4.4.2.1.mf.cmml" xref="S4.E6.m1.4.4.4.4.4.4.4.4.2.1.mf">otherwise</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6X.2.1.1.m1.2c">\displaystyle\delta(x_{iq},z_{jq})=\begin{cases}0,&amp;\text{if }x_{iq}=z_{jq}\\
1,&amp;\text{otherwise}\end{cases}</annotation><annotation encoding="application/x-llamapun" id="S4.E6X.2.1.1.m1.2d">italic_δ ( italic_x start_POSTSUBSCRIPT italic_i italic_q end_POSTSUBSCRIPT , italic_z start_POSTSUBSCRIPT italic_j italic_q end_POSTSUBSCRIPT ) = { start_ROW start_CELL 0 , end_CELL start_CELL if italic_x start_POSTSUBSCRIPT italic_i italic_q end_POSTSUBSCRIPT = italic_z start_POSTSUBSCRIPT italic_j italic_q end_POSTSUBSCRIPT end_CELL end_ROW start_ROW start_CELL 1 , end_CELL start_CELL otherwise end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(6)</span></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_para" id="S4.SS1.SSS3.p11">
<p class="ltx_p" id="S4.SS1.SSS3.p11.6">In each iteration, for each <math alttext="x_{i}" class="ltx_Math" display="inline" id="S4.SS1.SSS3.p11.1.m1.1"><semantics id="S4.SS1.SSS3.p11.1.m1.1a"><msub id="S4.SS1.SSS3.p11.1.m1.1.1" xref="S4.SS1.SSS3.p11.1.m1.1.1.cmml"><mi id="S4.SS1.SSS3.p11.1.m1.1.1.2" xref="S4.SS1.SSS3.p11.1.m1.1.1.2.cmml">x</mi><mi id="S4.SS1.SSS3.p11.1.m1.1.1.3" xref="S4.SS1.SSS3.p11.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p11.1.m1.1b"><apply id="S4.SS1.SSS3.p11.1.m1.1.1.cmml" xref="S4.SS1.SSS3.p11.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p11.1.m1.1.1.1.cmml" xref="S4.SS1.SSS3.p11.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.SSS3.p11.1.m1.1.1.2.cmml" xref="S4.SS1.SSS3.p11.1.m1.1.1.2">𝑥</ci><ci id="S4.SS1.SSS3.p11.1.m1.1.1.3.cmml" xref="S4.SS1.SSS3.p11.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p11.1.m1.1c">x_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.p11.1.m1.1d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, find the mode <math alttext="z_{j}" class="ltx_Math" display="inline" id="S4.SS1.SSS3.p11.2.m2.1"><semantics id="S4.SS1.SSS3.p11.2.m2.1a"><msub id="S4.SS1.SSS3.p11.2.m2.1.1" xref="S4.SS1.SSS3.p11.2.m2.1.1.cmml"><mi id="S4.SS1.SSS3.p11.2.m2.1.1.2" xref="S4.SS1.SSS3.p11.2.m2.1.1.2.cmml">z</mi><mi id="S4.SS1.SSS3.p11.2.m2.1.1.3" xref="S4.SS1.SSS3.p11.2.m2.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p11.2.m2.1b"><apply id="S4.SS1.SSS3.p11.2.m2.1.1.cmml" xref="S4.SS1.SSS3.p11.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p11.2.m2.1.1.1.cmml" xref="S4.SS1.SSS3.p11.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.SSS3.p11.2.m2.1.1.2.cmml" xref="S4.SS1.SSS3.p11.2.m2.1.1.2">𝑧</ci><ci id="S4.SS1.SSS3.p11.2.m2.1.1.3.cmml" xref="S4.SS1.SSS3.p11.2.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p11.2.m2.1c">z_{j}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.p11.2.m2.1d">italic_z start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> that is nearest to it, i.e., find <math alttext="j" class="ltx_Math" display="inline" id="S4.SS1.SSS3.p11.3.m3.1"><semantics id="S4.SS1.SSS3.p11.3.m3.1a"><mi id="S4.SS1.SSS3.p11.3.m3.1.1" xref="S4.SS1.SSS3.p11.3.m3.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p11.3.m3.1b"><ci id="S4.SS1.SSS3.p11.3.m3.1.1.cmml" xref="S4.SS1.SSS3.p11.3.m3.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p11.3.m3.1c">j</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.p11.3.m3.1d">italic_j</annotation></semantics></math> such that <math alttext="d(x_{i},z_{j})" class="ltx_Math" display="inline" id="S4.SS1.SSS3.p11.4.m4.2"><semantics id="S4.SS1.SSS3.p11.4.m4.2a"><mrow id="S4.SS1.SSS3.p11.4.m4.2.2" xref="S4.SS1.SSS3.p11.4.m4.2.2.cmml"><mi id="S4.SS1.SSS3.p11.4.m4.2.2.4" xref="S4.SS1.SSS3.p11.4.m4.2.2.4.cmml">d</mi><mo id="S4.SS1.SSS3.p11.4.m4.2.2.3" xref="S4.SS1.SSS3.p11.4.m4.2.2.3.cmml">⁢</mo><mrow id="S4.SS1.SSS3.p11.4.m4.2.2.2.2" xref="S4.SS1.SSS3.p11.4.m4.2.2.2.3.cmml"><mo id="S4.SS1.SSS3.p11.4.m4.2.2.2.2.3" stretchy="false" xref="S4.SS1.SSS3.p11.4.m4.2.2.2.3.cmml">(</mo><msub id="S4.SS1.SSS3.p11.4.m4.1.1.1.1.1" xref="S4.SS1.SSS3.p11.4.m4.1.1.1.1.1.cmml"><mi id="S4.SS1.SSS3.p11.4.m4.1.1.1.1.1.2" xref="S4.SS1.SSS3.p11.4.m4.1.1.1.1.1.2.cmml">x</mi><mi id="S4.SS1.SSS3.p11.4.m4.1.1.1.1.1.3" xref="S4.SS1.SSS3.p11.4.m4.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.SS1.SSS3.p11.4.m4.2.2.2.2.4" xref="S4.SS1.SSS3.p11.4.m4.2.2.2.3.cmml">,</mo><msub id="S4.SS1.SSS3.p11.4.m4.2.2.2.2.2" xref="S4.SS1.SSS3.p11.4.m4.2.2.2.2.2.cmml"><mi id="S4.SS1.SSS3.p11.4.m4.2.2.2.2.2.2" xref="S4.SS1.SSS3.p11.4.m4.2.2.2.2.2.2.cmml">z</mi><mi id="S4.SS1.SSS3.p11.4.m4.2.2.2.2.2.3" xref="S4.SS1.SSS3.p11.4.m4.2.2.2.2.2.3.cmml">j</mi></msub><mo id="S4.SS1.SSS3.p11.4.m4.2.2.2.2.5" stretchy="false" xref="S4.SS1.SSS3.p11.4.m4.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p11.4.m4.2b"><apply id="S4.SS1.SSS3.p11.4.m4.2.2.cmml" xref="S4.SS1.SSS3.p11.4.m4.2.2"><times id="S4.SS1.SSS3.p11.4.m4.2.2.3.cmml" xref="S4.SS1.SSS3.p11.4.m4.2.2.3"></times><ci id="S4.SS1.SSS3.p11.4.m4.2.2.4.cmml" xref="S4.SS1.SSS3.p11.4.m4.2.2.4">𝑑</ci><interval closure="open" id="S4.SS1.SSS3.p11.4.m4.2.2.2.3.cmml" xref="S4.SS1.SSS3.p11.4.m4.2.2.2.2"><apply id="S4.SS1.SSS3.p11.4.m4.1.1.1.1.1.cmml" xref="S4.SS1.SSS3.p11.4.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p11.4.m4.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS3.p11.4.m4.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS3.p11.4.m4.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS3.p11.4.m4.1.1.1.1.1.2">𝑥</ci><ci id="S4.SS1.SSS3.p11.4.m4.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS3.p11.4.m4.1.1.1.1.1.3">𝑖</ci></apply><apply id="S4.SS1.SSS3.p11.4.m4.2.2.2.2.2.cmml" xref="S4.SS1.SSS3.p11.4.m4.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p11.4.m4.2.2.2.2.2.1.cmml" xref="S4.SS1.SSS3.p11.4.m4.2.2.2.2.2">subscript</csymbol><ci id="S4.SS1.SSS3.p11.4.m4.2.2.2.2.2.2.cmml" xref="S4.SS1.SSS3.p11.4.m4.2.2.2.2.2.2">𝑧</ci><ci id="S4.SS1.SSS3.p11.4.m4.2.2.2.2.2.3.cmml" xref="S4.SS1.SSS3.p11.4.m4.2.2.2.2.2.3">𝑗</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p11.4.m4.2c">d(x_{i},z_{j})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.p11.4.m4.2d">italic_d ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_z start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT )</annotation></semantics></math> is minimized, and assign <math alttext="x_{i}" class="ltx_Math" display="inline" id="S4.SS1.SSS3.p11.5.m5.1"><semantics id="S4.SS1.SSS3.p11.5.m5.1a"><msub id="S4.SS1.SSS3.p11.5.m5.1.1" xref="S4.SS1.SSS3.p11.5.m5.1.1.cmml"><mi id="S4.SS1.SSS3.p11.5.m5.1.1.2" xref="S4.SS1.SSS3.p11.5.m5.1.1.2.cmml">x</mi><mi id="S4.SS1.SSS3.p11.5.m5.1.1.3" xref="S4.SS1.SSS3.p11.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p11.5.m5.1b"><apply id="S4.SS1.SSS3.p11.5.m5.1.1.cmml" xref="S4.SS1.SSS3.p11.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p11.5.m5.1.1.1.cmml" xref="S4.SS1.SSS3.p11.5.m5.1.1">subscript</csymbol><ci id="S4.SS1.SSS3.p11.5.m5.1.1.2.cmml" xref="S4.SS1.SSS3.p11.5.m5.1.1.2">𝑥</ci><ci id="S4.SS1.SSS3.p11.5.m5.1.1.3.cmml" xref="S4.SS1.SSS3.p11.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p11.5.m5.1c">x_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.p11.5.m5.1d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> to <math alttext="z_{j}" class="ltx_Math" display="inline" id="S4.SS1.SSS3.p11.6.m6.1"><semantics id="S4.SS1.SSS3.p11.6.m6.1a"><msub id="S4.SS1.SSS3.p11.6.m6.1.1" xref="S4.SS1.SSS3.p11.6.m6.1.1.cmml"><mi id="S4.SS1.SSS3.p11.6.m6.1.1.2" xref="S4.SS1.SSS3.p11.6.m6.1.1.2.cmml">z</mi><mi id="S4.SS1.SSS3.p11.6.m6.1.1.3" xref="S4.SS1.SSS3.p11.6.m6.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p11.6.m6.1b"><apply id="S4.SS1.SSS3.p11.6.m6.1.1.cmml" xref="S4.SS1.SSS3.p11.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p11.6.m6.1.1.1.cmml" xref="S4.SS1.SSS3.p11.6.m6.1.1">subscript</csymbol><ci id="S4.SS1.SSS3.p11.6.m6.1.1.2.cmml" xref="S4.SS1.SSS3.p11.6.m6.1.1.2">𝑧</ci><ci id="S4.SS1.SSS3.p11.6.m6.1.1.3.cmml" xref="S4.SS1.SSS3.p11.6.m6.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p11.6.m6.1c">z_{j}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.p11.6.m6.1d">italic_z start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S4.SS1.SSS3.p12">
<p class="ltx_p" id="S4.SS1.SSS3.p12.2">Update each mode <math alttext="z_{j}" class="ltx_Math" display="inline" id="S4.SS1.SSS3.p12.1.m1.1"><semantics id="S4.SS1.SSS3.p12.1.m1.1a"><msub id="S4.SS1.SSS3.p12.1.m1.1.1" xref="S4.SS1.SSS3.p12.1.m1.1.1.cmml"><mi id="S4.SS1.SSS3.p12.1.m1.1.1.2" xref="S4.SS1.SSS3.p12.1.m1.1.1.2.cmml">z</mi><mi id="S4.SS1.SSS3.p12.1.m1.1.1.3" xref="S4.SS1.SSS3.p12.1.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p12.1.m1.1b"><apply id="S4.SS1.SSS3.p12.1.m1.1.1.cmml" xref="S4.SS1.SSS3.p12.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p12.1.m1.1.1.1.cmml" xref="S4.SS1.SSS3.p12.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.SSS3.p12.1.m1.1.1.2.cmml" xref="S4.SS1.SSS3.p12.1.m1.1.1.2">𝑧</ci><ci id="S4.SS1.SSS3.p12.1.m1.1.1.3.cmml" xref="S4.SS1.SSS3.p12.1.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p12.1.m1.1c">z_{j}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.p12.1.m1.1d">italic_z start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> to be the mode of the data points assigned to it, i.e., for each <math alttext="q=1,2,...,m" class="ltx_Math" display="inline" id="S4.SS1.SSS3.p12.2.m2.4"><semantics id="S4.SS1.SSS3.p12.2.m2.4a"><mrow id="S4.SS1.SSS3.p12.2.m2.4.5" xref="S4.SS1.SSS3.p12.2.m2.4.5.cmml"><mi id="S4.SS1.SSS3.p12.2.m2.4.5.2" xref="S4.SS1.SSS3.p12.2.m2.4.5.2.cmml">q</mi><mo id="S4.SS1.SSS3.p12.2.m2.4.5.1" xref="S4.SS1.SSS3.p12.2.m2.4.5.1.cmml">=</mo><mrow id="S4.SS1.SSS3.p12.2.m2.4.5.3.2" xref="S4.SS1.SSS3.p12.2.m2.4.5.3.1.cmml"><mn id="S4.SS1.SSS3.p12.2.m2.1.1" xref="S4.SS1.SSS3.p12.2.m2.1.1.cmml">1</mn><mo id="S4.SS1.SSS3.p12.2.m2.4.5.3.2.1" xref="S4.SS1.SSS3.p12.2.m2.4.5.3.1.cmml">,</mo><mn id="S4.SS1.SSS3.p12.2.m2.2.2" xref="S4.SS1.SSS3.p12.2.m2.2.2.cmml">2</mn><mo id="S4.SS1.SSS3.p12.2.m2.4.5.3.2.2" xref="S4.SS1.SSS3.p12.2.m2.4.5.3.1.cmml">,</mo><mi id="S4.SS1.SSS3.p12.2.m2.3.3" mathvariant="normal" xref="S4.SS1.SSS3.p12.2.m2.3.3.cmml">…</mi><mo id="S4.SS1.SSS3.p12.2.m2.4.5.3.2.3" xref="S4.SS1.SSS3.p12.2.m2.4.5.3.1.cmml">,</mo><mi id="S4.SS1.SSS3.p12.2.m2.4.4" xref="S4.SS1.SSS3.p12.2.m2.4.4.cmml">m</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p12.2.m2.4b"><apply id="S4.SS1.SSS3.p12.2.m2.4.5.cmml" xref="S4.SS1.SSS3.p12.2.m2.4.5"><eq id="S4.SS1.SSS3.p12.2.m2.4.5.1.cmml" xref="S4.SS1.SSS3.p12.2.m2.4.5.1"></eq><ci id="S4.SS1.SSS3.p12.2.m2.4.5.2.cmml" xref="S4.SS1.SSS3.p12.2.m2.4.5.2">𝑞</ci><list id="S4.SS1.SSS3.p12.2.m2.4.5.3.1.cmml" xref="S4.SS1.SSS3.p12.2.m2.4.5.3.2"><cn id="S4.SS1.SSS3.p12.2.m2.1.1.cmml" type="integer" xref="S4.SS1.SSS3.p12.2.m2.1.1">1</cn><cn id="S4.SS1.SSS3.p12.2.m2.2.2.cmml" type="integer" xref="S4.SS1.SSS3.p12.2.m2.2.2">2</cn><ci id="S4.SS1.SSS3.p12.2.m2.3.3.cmml" xref="S4.SS1.SSS3.p12.2.m2.3.3">…</ci><ci id="S4.SS1.SSS3.p12.2.m2.4.4.cmml" xref="S4.SS1.SSS3.p12.2.m2.4.4">𝑚</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p12.2.m2.4c">q=1,2,...,m</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.p12.2.m2.4d">italic_q = 1 , 2 , … , italic_m</annotation></semantics></math>, set</p>
</div>
<div class="ltx_para" id="S4.SS1.SSS3.p13">
<table class="ltx_equationgroup ltx_eqn_table" id="S4.E7">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E7X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle z_{jq}=\text{mode}(\{x_{iq}|x_{i}\text{ is assigned to }z_{j}\})" class="ltx_Math" display="inline" id="S4.E7X.2.1.1.m1.1"><semantics id="S4.E7X.2.1.1.m1.1a"><mrow id="S4.E7X.2.1.1.m1.1.1" xref="S4.E7X.2.1.1.m1.1.1.cmml"><msub id="S4.E7X.2.1.1.m1.1.1.3" xref="S4.E7X.2.1.1.m1.1.1.3.cmml"><mi id="S4.E7X.2.1.1.m1.1.1.3.2" xref="S4.E7X.2.1.1.m1.1.1.3.2.cmml">z</mi><mrow id="S4.E7X.2.1.1.m1.1.1.3.3" xref="S4.E7X.2.1.1.m1.1.1.3.3.cmml"><mi id="S4.E7X.2.1.1.m1.1.1.3.3.2" xref="S4.E7X.2.1.1.m1.1.1.3.3.2.cmml">j</mi><mo id="S4.E7X.2.1.1.m1.1.1.3.3.1" xref="S4.E7X.2.1.1.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.E7X.2.1.1.m1.1.1.3.3.3" xref="S4.E7X.2.1.1.m1.1.1.3.3.3.cmml">q</mi></mrow></msub><mo id="S4.E7X.2.1.1.m1.1.1.2" xref="S4.E7X.2.1.1.m1.1.1.2.cmml">=</mo><mrow id="S4.E7X.2.1.1.m1.1.1.1" xref="S4.E7X.2.1.1.m1.1.1.1.cmml"><mtext id="S4.E7X.2.1.1.m1.1.1.1.3" xref="S4.E7X.2.1.1.m1.1.1.1.3a.cmml">mode</mtext><mo id="S4.E7X.2.1.1.m1.1.1.1.2" xref="S4.E7X.2.1.1.m1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E7X.2.1.1.m1.1.1.1.1.1" xref="S4.E7X.2.1.1.m1.1.1.1.cmml"><mo id="S4.E7X.2.1.1.m1.1.1.1.1.1.2" stretchy="false" xref="S4.E7X.2.1.1.m1.1.1.1.cmml">(</mo><mrow id="S4.E7X.2.1.1.m1.1.1.1.1.1.1.2" xref="S4.E7X.2.1.1.m1.1.1.1.1.1.1.3.cmml"><mo id="S4.E7X.2.1.1.m1.1.1.1.1.1.1.2.3" stretchy="false" xref="S4.E7X.2.1.1.m1.1.1.1.1.1.1.3.1.cmml">{</mo><msub id="S4.E7X.2.1.1.m1.1.1.1.1.1.1.1.1" xref="S4.E7X.2.1.1.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E7X.2.1.1.m1.1.1.1.1.1.1.1.1.2" xref="S4.E7X.2.1.1.m1.1.1.1.1.1.1.1.1.2.cmml">x</mi><mrow id="S4.E7X.2.1.1.m1.1.1.1.1.1.1.1.1.3" xref="S4.E7X.2.1.1.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E7X.2.1.1.m1.1.1.1.1.1.1.1.1.3.2" xref="S4.E7X.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="S4.E7X.2.1.1.m1.1.1.1.1.1.1.1.1.3.1" xref="S4.E7X.2.1.1.m1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S4.E7X.2.1.1.m1.1.1.1.1.1.1.1.1.3.3" xref="S4.E7X.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.cmml">q</mi></mrow></msub><mo id="S4.E7X.2.1.1.m1.1.1.1.1.1.1.2.4" lspace="0em" rspace="0em" xref="S4.E7X.2.1.1.m1.1.1.1.1.1.1.3.1.cmml">|</mo><mrow id="S4.E7X.2.1.1.m1.1.1.1.1.1.1.2.2" xref="S4.E7X.2.1.1.m1.1.1.1.1.1.1.2.2.cmml"><msub id="S4.E7X.2.1.1.m1.1.1.1.1.1.1.2.2.2" xref="S4.E7X.2.1.1.m1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S4.E7X.2.1.1.m1.1.1.1.1.1.1.2.2.2.2" xref="S4.E7X.2.1.1.m1.1.1.1.1.1.1.2.2.2.2.cmml">x</mi><mi id="S4.E7X.2.1.1.m1.1.1.1.1.1.1.2.2.2.3" xref="S4.E7X.2.1.1.m1.1.1.1.1.1.1.2.2.2.3.cmml">i</mi></msub><mo id="S4.E7X.2.1.1.m1.1.1.1.1.1.1.2.2.1" xref="S4.E7X.2.1.1.m1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mtext id="S4.E7X.2.1.1.m1.1.1.1.1.1.1.2.2.3" xref="S4.E7X.2.1.1.m1.1.1.1.1.1.1.2.2.3a.cmml"> is assigned to </mtext><mo id="S4.E7X.2.1.1.m1.1.1.1.1.1.1.2.2.1a" xref="S4.E7X.2.1.1.m1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><msub id="S4.E7X.2.1.1.m1.1.1.1.1.1.1.2.2.4" xref="S4.E7X.2.1.1.m1.1.1.1.1.1.1.2.2.4.cmml"><mi id="S4.E7X.2.1.1.m1.1.1.1.1.1.1.2.2.4.2" xref="S4.E7X.2.1.1.m1.1.1.1.1.1.1.2.2.4.2.cmml">z</mi><mi id="S4.E7X.2.1.1.m1.1.1.1.1.1.1.2.2.4.3" xref="S4.E7X.2.1.1.m1.1.1.1.1.1.1.2.2.4.3.cmml">j</mi></msub></mrow><mo id="S4.E7X.2.1.1.m1.1.1.1.1.1.1.2.5" stretchy="false" xref="S4.E7X.2.1.1.m1.1.1.1.1.1.1.3.1.cmml">}</mo></mrow><mo id="S4.E7X.2.1.1.m1.1.1.1.1.1.3" stretchy="false" xref="S4.E7X.2.1.1.m1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E7X.2.1.1.m1.1b"><apply id="S4.E7X.2.1.1.m1.1.1.cmml" xref="S4.E7X.2.1.1.m1.1.1"><eq id="S4.E7X.2.1.1.m1.1.1.2.cmml" xref="S4.E7X.2.1.1.m1.1.1.2"></eq><apply id="S4.E7X.2.1.1.m1.1.1.3.cmml" xref="S4.E7X.2.1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.E7X.2.1.1.m1.1.1.3.1.cmml" xref="S4.E7X.2.1.1.m1.1.1.3">subscript</csymbol><ci id="S4.E7X.2.1.1.m1.1.1.3.2.cmml" xref="S4.E7X.2.1.1.m1.1.1.3.2">𝑧</ci><apply id="S4.E7X.2.1.1.m1.1.1.3.3.cmml" xref="S4.E7X.2.1.1.m1.1.1.3.3"><times id="S4.E7X.2.1.1.m1.1.1.3.3.1.cmml" xref="S4.E7X.2.1.1.m1.1.1.3.3.1"></times><ci id="S4.E7X.2.1.1.m1.1.1.3.3.2.cmml" xref="S4.E7X.2.1.1.m1.1.1.3.3.2">𝑗</ci><ci id="S4.E7X.2.1.1.m1.1.1.3.3.3.cmml" xref="S4.E7X.2.1.1.m1.1.1.3.3.3">𝑞</ci></apply></apply><apply id="S4.E7X.2.1.1.m1.1.1.1.cmml" xref="S4.E7X.2.1.1.m1.1.1.1"><times id="S4.E7X.2.1.1.m1.1.1.1.2.cmml" xref="S4.E7X.2.1.1.m1.1.1.1.2"></times><ci id="S4.E7X.2.1.1.m1.1.1.1.3a.cmml" xref="S4.E7X.2.1.1.m1.1.1.1.3"><mtext id="S4.E7X.2.1.1.m1.1.1.1.3.cmml" xref="S4.E7X.2.1.1.m1.1.1.1.3">mode</mtext></ci><apply id="S4.E7X.2.1.1.m1.1.1.1.1.1.1.3.cmml" xref="S4.E7X.2.1.1.m1.1.1.1.1.1.1.2"><csymbol cd="latexml" id="S4.E7X.2.1.1.m1.1.1.1.1.1.1.3.1.cmml" xref="S4.E7X.2.1.1.m1.1.1.1.1.1.1.2.3">conditional-set</csymbol><apply id="S4.E7X.2.1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E7X.2.1.1.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E7X.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E7X.2.1.1.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E7X.2.1.1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E7X.2.1.1.m1.1.1.1.1.1.1.1.1.2">𝑥</ci><apply id="S4.E7X.2.1.1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E7X.2.1.1.m1.1.1.1.1.1.1.1.1.3"><times id="S4.E7X.2.1.1.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E7X.2.1.1.m1.1.1.1.1.1.1.1.1.3.1"></times><ci id="S4.E7X.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E7X.2.1.1.m1.1.1.1.1.1.1.1.1.3.2">𝑖</ci><ci id="S4.E7X.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E7X.2.1.1.m1.1.1.1.1.1.1.1.1.3.3">𝑞</ci></apply></apply><apply id="S4.E7X.2.1.1.m1.1.1.1.1.1.1.2.2.cmml" xref="S4.E7X.2.1.1.m1.1.1.1.1.1.1.2.2"><times id="S4.E7X.2.1.1.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E7X.2.1.1.m1.1.1.1.1.1.1.2.2.1"></times><apply id="S4.E7X.2.1.1.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E7X.2.1.1.m1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E7X.2.1.1.m1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S4.E7X.2.1.1.m1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S4.E7X.2.1.1.m1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E7X.2.1.1.m1.1.1.1.1.1.1.2.2.2.2">𝑥</ci><ci id="S4.E7X.2.1.1.m1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S4.E7X.2.1.1.m1.1.1.1.1.1.1.2.2.2.3">𝑖</ci></apply><ci id="S4.E7X.2.1.1.m1.1.1.1.1.1.1.2.2.3a.cmml" xref="S4.E7X.2.1.1.m1.1.1.1.1.1.1.2.2.3"><mtext id="S4.E7X.2.1.1.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E7X.2.1.1.m1.1.1.1.1.1.1.2.2.3"> is assigned to </mtext></ci><apply id="S4.E7X.2.1.1.m1.1.1.1.1.1.1.2.2.4.cmml" xref="S4.E7X.2.1.1.m1.1.1.1.1.1.1.2.2.4"><csymbol cd="ambiguous" id="S4.E7X.2.1.1.m1.1.1.1.1.1.1.2.2.4.1.cmml" xref="S4.E7X.2.1.1.m1.1.1.1.1.1.1.2.2.4">subscript</csymbol><ci id="S4.E7X.2.1.1.m1.1.1.1.1.1.1.2.2.4.2.cmml" xref="S4.E7X.2.1.1.m1.1.1.1.1.1.1.2.2.4.2">𝑧</ci><ci id="S4.E7X.2.1.1.m1.1.1.1.1.1.1.2.2.4.3.cmml" xref="S4.E7X.2.1.1.m1.1.1.1.1.1.1.2.2.4.3">𝑗</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7X.2.1.1.m1.1c">\displaystyle z_{jq}=\text{mode}(\{x_{iq}|x_{i}\text{ is assigned to }z_{j}\})</annotation><annotation encoding="application/x-llamapun" id="S4.E7X.2.1.1.m1.1d">italic_z start_POSTSUBSCRIPT italic_j italic_q end_POSTSUBSCRIPT = mode ( { italic_x start_POSTSUBSCRIPT italic_i italic_q end_POSTSUBSCRIPT | italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT is assigned to italic_z start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT } )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(7)</span></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_para" id="S4.SS1.SSS3.p14">
<p class="ltx_p" id="S4.SS1.SSS3.p14.1">where mode() denotes the mode.</p>
</div>
<div class="ltx_para" id="S4.SS1.SSS3.p15">
<p class="ltx_p" id="S4.SS1.SSS3.p15.1">This process continues until the modes no longer change or a predefined number of iterations is reached.</p>
</div>
<div class="ltx_para" id="S4.SS1.SSS3.p16">
<p class="ltx_p" id="S4.SS1.SSS3.p16.2">After the clustering process, we obtain the final set of modes (or cluster centers) <math alttext="Z=\{z_{1},z_{2},...,z_{k}\}" class="ltx_Math" display="inline" id="S4.SS1.SSS3.p16.1.m1.4"><semantics id="S4.SS1.SSS3.p16.1.m1.4a"><mrow id="S4.SS1.SSS3.p16.1.m1.4.4" xref="S4.SS1.SSS3.p16.1.m1.4.4.cmml"><mi id="S4.SS1.SSS3.p16.1.m1.4.4.5" xref="S4.SS1.SSS3.p16.1.m1.4.4.5.cmml">Z</mi><mo id="S4.SS1.SSS3.p16.1.m1.4.4.4" xref="S4.SS1.SSS3.p16.1.m1.4.4.4.cmml">=</mo><mrow id="S4.SS1.SSS3.p16.1.m1.4.4.3.3" xref="S4.SS1.SSS3.p16.1.m1.4.4.3.4.cmml"><mo id="S4.SS1.SSS3.p16.1.m1.4.4.3.3.4" stretchy="false" xref="S4.SS1.SSS3.p16.1.m1.4.4.3.4.cmml">{</mo><msub id="S4.SS1.SSS3.p16.1.m1.2.2.1.1.1" xref="S4.SS1.SSS3.p16.1.m1.2.2.1.1.1.cmml"><mi id="S4.SS1.SSS3.p16.1.m1.2.2.1.1.1.2" xref="S4.SS1.SSS3.p16.1.m1.2.2.1.1.1.2.cmml">z</mi><mn id="S4.SS1.SSS3.p16.1.m1.2.2.1.1.1.3" xref="S4.SS1.SSS3.p16.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S4.SS1.SSS3.p16.1.m1.4.4.3.3.5" xref="S4.SS1.SSS3.p16.1.m1.4.4.3.4.cmml">,</mo><msub id="S4.SS1.SSS3.p16.1.m1.3.3.2.2.2" xref="S4.SS1.SSS3.p16.1.m1.3.3.2.2.2.cmml"><mi id="S4.SS1.SSS3.p16.1.m1.3.3.2.2.2.2" xref="S4.SS1.SSS3.p16.1.m1.3.3.2.2.2.2.cmml">z</mi><mn id="S4.SS1.SSS3.p16.1.m1.3.3.2.2.2.3" xref="S4.SS1.SSS3.p16.1.m1.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S4.SS1.SSS3.p16.1.m1.4.4.3.3.6" xref="S4.SS1.SSS3.p16.1.m1.4.4.3.4.cmml">,</mo><mi id="S4.SS1.SSS3.p16.1.m1.1.1" mathvariant="normal" xref="S4.SS1.SSS3.p16.1.m1.1.1.cmml">…</mi><mo id="S4.SS1.SSS3.p16.1.m1.4.4.3.3.7" xref="S4.SS1.SSS3.p16.1.m1.4.4.3.4.cmml">,</mo><msub id="S4.SS1.SSS3.p16.1.m1.4.4.3.3.3" xref="S4.SS1.SSS3.p16.1.m1.4.4.3.3.3.cmml"><mi id="S4.SS1.SSS3.p16.1.m1.4.4.3.3.3.2" xref="S4.SS1.SSS3.p16.1.m1.4.4.3.3.3.2.cmml">z</mi><mi id="S4.SS1.SSS3.p16.1.m1.4.4.3.3.3.3" xref="S4.SS1.SSS3.p16.1.m1.4.4.3.3.3.3.cmml">k</mi></msub><mo id="S4.SS1.SSS3.p16.1.m1.4.4.3.3.8" stretchy="false" xref="S4.SS1.SSS3.p16.1.m1.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p16.1.m1.4b"><apply id="S4.SS1.SSS3.p16.1.m1.4.4.cmml" xref="S4.SS1.SSS3.p16.1.m1.4.4"><eq id="S4.SS1.SSS3.p16.1.m1.4.4.4.cmml" xref="S4.SS1.SSS3.p16.1.m1.4.4.4"></eq><ci id="S4.SS1.SSS3.p16.1.m1.4.4.5.cmml" xref="S4.SS1.SSS3.p16.1.m1.4.4.5">𝑍</ci><set id="S4.SS1.SSS3.p16.1.m1.4.4.3.4.cmml" xref="S4.SS1.SSS3.p16.1.m1.4.4.3.3"><apply id="S4.SS1.SSS3.p16.1.m1.2.2.1.1.1.cmml" xref="S4.SS1.SSS3.p16.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p16.1.m1.2.2.1.1.1.1.cmml" xref="S4.SS1.SSS3.p16.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS3.p16.1.m1.2.2.1.1.1.2.cmml" xref="S4.SS1.SSS3.p16.1.m1.2.2.1.1.1.2">𝑧</ci><cn id="S4.SS1.SSS3.p16.1.m1.2.2.1.1.1.3.cmml" type="integer" xref="S4.SS1.SSS3.p16.1.m1.2.2.1.1.1.3">1</cn></apply><apply id="S4.SS1.SSS3.p16.1.m1.3.3.2.2.2.cmml" xref="S4.SS1.SSS3.p16.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p16.1.m1.3.3.2.2.2.1.cmml" xref="S4.SS1.SSS3.p16.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S4.SS1.SSS3.p16.1.m1.3.3.2.2.2.2.cmml" xref="S4.SS1.SSS3.p16.1.m1.3.3.2.2.2.2">𝑧</ci><cn id="S4.SS1.SSS3.p16.1.m1.3.3.2.2.2.3.cmml" type="integer" xref="S4.SS1.SSS3.p16.1.m1.3.3.2.2.2.3">2</cn></apply><ci id="S4.SS1.SSS3.p16.1.m1.1.1.cmml" xref="S4.SS1.SSS3.p16.1.m1.1.1">…</ci><apply id="S4.SS1.SSS3.p16.1.m1.4.4.3.3.3.cmml" xref="S4.SS1.SSS3.p16.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p16.1.m1.4.4.3.3.3.1.cmml" xref="S4.SS1.SSS3.p16.1.m1.4.4.3.3.3">subscript</csymbol><ci id="S4.SS1.SSS3.p16.1.m1.4.4.3.3.3.2.cmml" xref="S4.SS1.SSS3.p16.1.m1.4.4.3.3.3.2">𝑧</ci><ci id="S4.SS1.SSS3.p16.1.m1.4.4.3.3.3.3.cmml" xref="S4.SS1.SSS3.p16.1.m1.4.4.3.3.3.3">𝑘</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p16.1.m1.4c">Z=\{z_{1},z_{2},...,z_{k}\}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.p16.1.m1.4d">italic_Z = { italic_z start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_z start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_z start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT }</annotation></semantics></math>. Each mode <math alttext="z_{j}=(z_{j1},z_{j2},...,z_{jm})" class="ltx_Math" display="inline" id="S4.SS1.SSS3.p16.2.m2.4"><semantics id="S4.SS1.SSS3.p16.2.m2.4a"><mrow id="S4.SS1.SSS3.p16.2.m2.4.4" xref="S4.SS1.SSS3.p16.2.m2.4.4.cmml"><msub id="S4.SS1.SSS3.p16.2.m2.4.4.5" xref="S4.SS1.SSS3.p16.2.m2.4.4.5.cmml"><mi id="S4.SS1.SSS3.p16.2.m2.4.4.5.2" xref="S4.SS1.SSS3.p16.2.m2.4.4.5.2.cmml">z</mi><mi id="S4.SS1.SSS3.p16.2.m2.4.4.5.3" xref="S4.SS1.SSS3.p16.2.m2.4.4.5.3.cmml">j</mi></msub><mo id="S4.SS1.SSS3.p16.2.m2.4.4.4" xref="S4.SS1.SSS3.p16.2.m2.4.4.4.cmml">=</mo><mrow id="S4.SS1.SSS3.p16.2.m2.4.4.3.3" xref="S4.SS1.SSS3.p16.2.m2.4.4.3.4.cmml"><mo id="S4.SS1.SSS3.p16.2.m2.4.4.3.3.4" stretchy="false" xref="S4.SS1.SSS3.p16.2.m2.4.4.3.4.cmml">(</mo><msub id="S4.SS1.SSS3.p16.2.m2.2.2.1.1.1" xref="S4.SS1.SSS3.p16.2.m2.2.2.1.1.1.cmml"><mi id="S4.SS1.SSS3.p16.2.m2.2.2.1.1.1.2" xref="S4.SS1.SSS3.p16.2.m2.2.2.1.1.1.2.cmml">z</mi><mrow id="S4.SS1.SSS3.p16.2.m2.2.2.1.1.1.3" xref="S4.SS1.SSS3.p16.2.m2.2.2.1.1.1.3.cmml"><mi id="S4.SS1.SSS3.p16.2.m2.2.2.1.1.1.3.2" xref="S4.SS1.SSS3.p16.2.m2.2.2.1.1.1.3.2.cmml">j</mi><mo id="S4.SS1.SSS3.p16.2.m2.2.2.1.1.1.3.1" xref="S4.SS1.SSS3.p16.2.m2.2.2.1.1.1.3.1.cmml">⁢</mo><mn id="S4.SS1.SSS3.p16.2.m2.2.2.1.1.1.3.3" xref="S4.SS1.SSS3.p16.2.m2.2.2.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S4.SS1.SSS3.p16.2.m2.4.4.3.3.5" xref="S4.SS1.SSS3.p16.2.m2.4.4.3.4.cmml">,</mo><msub id="S4.SS1.SSS3.p16.2.m2.3.3.2.2.2" xref="S4.SS1.SSS3.p16.2.m2.3.3.2.2.2.cmml"><mi id="S4.SS1.SSS3.p16.2.m2.3.3.2.2.2.2" xref="S4.SS1.SSS3.p16.2.m2.3.3.2.2.2.2.cmml">z</mi><mrow id="S4.SS1.SSS3.p16.2.m2.3.3.2.2.2.3" xref="S4.SS1.SSS3.p16.2.m2.3.3.2.2.2.3.cmml"><mi id="S4.SS1.SSS3.p16.2.m2.3.3.2.2.2.3.2" xref="S4.SS1.SSS3.p16.2.m2.3.3.2.2.2.3.2.cmml">j</mi><mo id="S4.SS1.SSS3.p16.2.m2.3.3.2.2.2.3.1" xref="S4.SS1.SSS3.p16.2.m2.3.3.2.2.2.3.1.cmml">⁢</mo><mn id="S4.SS1.SSS3.p16.2.m2.3.3.2.2.2.3.3" xref="S4.SS1.SSS3.p16.2.m2.3.3.2.2.2.3.3.cmml">2</mn></mrow></msub><mo id="S4.SS1.SSS3.p16.2.m2.4.4.3.3.6" xref="S4.SS1.SSS3.p16.2.m2.4.4.3.4.cmml">,</mo><mi id="S4.SS1.SSS3.p16.2.m2.1.1" mathvariant="normal" xref="S4.SS1.SSS3.p16.2.m2.1.1.cmml">…</mi><mo id="S4.SS1.SSS3.p16.2.m2.4.4.3.3.7" xref="S4.SS1.SSS3.p16.2.m2.4.4.3.4.cmml">,</mo><msub id="S4.SS1.SSS3.p16.2.m2.4.4.3.3.3" xref="S4.SS1.SSS3.p16.2.m2.4.4.3.3.3.cmml"><mi id="S4.SS1.SSS3.p16.2.m2.4.4.3.3.3.2" xref="S4.SS1.SSS3.p16.2.m2.4.4.3.3.3.2.cmml">z</mi><mrow id="S4.SS1.SSS3.p16.2.m2.4.4.3.3.3.3" xref="S4.SS1.SSS3.p16.2.m2.4.4.3.3.3.3.cmml"><mi id="S4.SS1.SSS3.p16.2.m2.4.4.3.3.3.3.2" xref="S4.SS1.SSS3.p16.2.m2.4.4.3.3.3.3.2.cmml">j</mi><mo id="S4.SS1.SSS3.p16.2.m2.4.4.3.3.3.3.1" xref="S4.SS1.SSS3.p16.2.m2.4.4.3.3.3.3.1.cmml">⁢</mo><mi id="S4.SS1.SSS3.p16.2.m2.4.4.3.3.3.3.3" xref="S4.SS1.SSS3.p16.2.m2.4.4.3.3.3.3.3.cmml">m</mi></mrow></msub><mo id="S4.SS1.SSS3.p16.2.m2.4.4.3.3.8" stretchy="false" xref="S4.SS1.SSS3.p16.2.m2.4.4.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p16.2.m2.4b"><apply id="S4.SS1.SSS3.p16.2.m2.4.4.cmml" xref="S4.SS1.SSS3.p16.2.m2.4.4"><eq id="S4.SS1.SSS3.p16.2.m2.4.4.4.cmml" xref="S4.SS1.SSS3.p16.2.m2.4.4.4"></eq><apply id="S4.SS1.SSS3.p16.2.m2.4.4.5.cmml" xref="S4.SS1.SSS3.p16.2.m2.4.4.5"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p16.2.m2.4.4.5.1.cmml" xref="S4.SS1.SSS3.p16.2.m2.4.4.5">subscript</csymbol><ci id="S4.SS1.SSS3.p16.2.m2.4.4.5.2.cmml" xref="S4.SS1.SSS3.p16.2.m2.4.4.5.2">𝑧</ci><ci id="S4.SS1.SSS3.p16.2.m2.4.4.5.3.cmml" xref="S4.SS1.SSS3.p16.2.m2.4.4.5.3">𝑗</ci></apply><vector id="S4.SS1.SSS3.p16.2.m2.4.4.3.4.cmml" xref="S4.SS1.SSS3.p16.2.m2.4.4.3.3"><apply id="S4.SS1.SSS3.p16.2.m2.2.2.1.1.1.cmml" xref="S4.SS1.SSS3.p16.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p16.2.m2.2.2.1.1.1.1.cmml" xref="S4.SS1.SSS3.p16.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS3.p16.2.m2.2.2.1.1.1.2.cmml" xref="S4.SS1.SSS3.p16.2.m2.2.2.1.1.1.2">𝑧</ci><apply id="S4.SS1.SSS3.p16.2.m2.2.2.1.1.1.3.cmml" xref="S4.SS1.SSS3.p16.2.m2.2.2.1.1.1.3"><times id="S4.SS1.SSS3.p16.2.m2.2.2.1.1.1.3.1.cmml" xref="S4.SS1.SSS3.p16.2.m2.2.2.1.1.1.3.1"></times><ci id="S4.SS1.SSS3.p16.2.m2.2.2.1.1.1.3.2.cmml" xref="S4.SS1.SSS3.p16.2.m2.2.2.1.1.1.3.2">𝑗</ci><cn id="S4.SS1.SSS3.p16.2.m2.2.2.1.1.1.3.3.cmml" type="integer" xref="S4.SS1.SSS3.p16.2.m2.2.2.1.1.1.3.3">1</cn></apply></apply><apply id="S4.SS1.SSS3.p16.2.m2.3.3.2.2.2.cmml" xref="S4.SS1.SSS3.p16.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p16.2.m2.3.3.2.2.2.1.cmml" xref="S4.SS1.SSS3.p16.2.m2.3.3.2.2.2">subscript</csymbol><ci id="S4.SS1.SSS3.p16.2.m2.3.3.2.2.2.2.cmml" xref="S4.SS1.SSS3.p16.2.m2.3.3.2.2.2.2">𝑧</ci><apply id="S4.SS1.SSS3.p16.2.m2.3.3.2.2.2.3.cmml" xref="S4.SS1.SSS3.p16.2.m2.3.3.2.2.2.3"><times id="S4.SS1.SSS3.p16.2.m2.3.3.2.2.2.3.1.cmml" xref="S4.SS1.SSS3.p16.2.m2.3.3.2.2.2.3.1"></times><ci id="S4.SS1.SSS3.p16.2.m2.3.3.2.2.2.3.2.cmml" xref="S4.SS1.SSS3.p16.2.m2.3.3.2.2.2.3.2">𝑗</ci><cn id="S4.SS1.SSS3.p16.2.m2.3.3.2.2.2.3.3.cmml" type="integer" xref="S4.SS1.SSS3.p16.2.m2.3.3.2.2.2.3.3">2</cn></apply></apply><ci id="S4.SS1.SSS3.p16.2.m2.1.1.cmml" xref="S4.SS1.SSS3.p16.2.m2.1.1">…</ci><apply id="S4.SS1.SSS3.p16.2.m2.4.4.3.3.3.cmml" xref="S4.SS1.SSS3.p16.2.m2.4.4.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p16.2.m2.4.4.3.3.3.1.cmml" xref="S4.SS1.SSS3.p16.2.m2.4.4.3.3.3">subscript</csymbol><ci id="S4.SS1.SSS3.p16.2.m2.4.4.3.3.3.2.cmml" xref="S4.SS1.SSS3.p16.2.m2.4.4.3.3.3.2">𝑧</ci><apply id="S4.SS1.SSS3.p16.2.m2.4.4.3.3.3.3.cmml" xref="S4.SS1.SSS3.p16.2.m2.4.4.3.3.3.3"><times id="S4.SS1.SSS3.p16.2.m2.4.4.3.3.3.3.1.cmml" xref="S4.SS1.SSS3.p16.2.m2.4.4.3.3.3.3.1"></times><ci id="S4.SS1.SSS3.p16.2.m2.4.4.3.3.3.3.2.cmml" xref="S4.SS1.SSS3.p16.2.m2.4.4.3.3.3.3.2">𝑗</ci><ci id="S4.SS1.SSS3.p16.2.m2.4.4.3.3.3.3.3.cmml" xref="S4.SS1.SSS3.p16.2.m2.4.4.3.3.3.3.3">𝑚</ci></apply></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p16.2.m2.4c">z_{j}=(z_{j1},z_{j2},...,z_{jm})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.p16.2.m2.4d">italic_z start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT = ( italic_z start_POSTSUBSCRIPT italic_j 1 end_POSTSUBSCRIPT , italic_z start_POSTSUBSCRIPT italic_j 2 end_POSTSUBSCRIPT , … , italic_z start_POSTSUBSCRIPT italic_j italic_m end_POSTSUBSCRIPT )</annotation></semantics></math> represents a cluster center vector.</p>
</div>
<div class="ltx_para" id="S4.SS1.SSS3.p17">
<p class="ltx_p" id="S4.SS1.SSS3.p17.2">For each data point <math alttext="x_{i}" class="ltx_Math" display="inline" id="S4.SS1.SSS3.p17.1.m1.1"><semantics id="S4.SS1.SSS3.p17.1.m1.1a"><msub id="S4.SS1.SSS3.p17.1.m1.1.1" xref="S4.SS1.SSS3.p17.1.m1.1.1.cmml"><mi id="S4.SS1.SSS3.p17.1.m1.1.1.2" xref="S4.SS1.SSS3.p17.1.m1.1.1.2.cmml">x</mi><mi id="S4.SS1.SSS3.p17.1.m1.1.1.3" xref="S4.SS1.SSS3.p17.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p17.1.m1.1b"><apply id="S4.SS1.SSS3.p17.1.m1.1.1.cmml" xref="S4.SS1.SSS3.p17.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p17.1.m1.1.1.1.cmml" xref="S4.SS1.SSS3.p17.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.SSS3.p17.1.m1.1.1.2.cmml" xref="S4.SS1.SSS3.p17.1.m1.1.1.2">𝑥</ci><ci id="S4.SS1.SSS3.p17.1.m1.1.1.3.cmml" xref="S4.SS1.SSS3.p17.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p17.1.m1.1c">x_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.p17.1.m1.1d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, we replace its original 17-dimensional interest point vector with the cluster center vector of the cluster to which <math alttext="x_{i}" class="ltx_Math" display="inline" id="S4.SS1.SSS3.p17.2.m2.1"><semantics id="S4.SS1.SSS3.p17.2.m2.1a"><msub id="S4.SS1.SSS3.p17.2.m2.1.1" xref="S4.SS1.SSS3.p17.2.m2.1.1.cmml"><mi id="S4.SS1.SSS3.p17.2.m2.1.1.2" xref="S4.SS1.SSS3.p17.2.m2.1.1.2.cmml">x</mi><mi id="S4.SS1.SSS3.p17.2.m2.1.1.3" xref="S4.SS1.SSS3.p17.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p17.2.m2.1b"><apply id="S4.SS1.SSS3.p17.2.m2.1.1.cmml" xref="S4.SS1.SSS3.p17.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p17.2.m2.1.1.1.cmml" xref="S4.SS1.SSS3.p17.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.SSS3.p17.2.m2.1.1.2.cmml" xref="S4.SS1.SSS3.p17.2.m2.1.1.2">𝑥</ci><ci id="S4.SS1.SSS3.p17.2.m2.1.1.3.cmml" xref="S4.SS1.SSS3.p17.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p17.2.m2.1c">x_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.p17.2.m2.1d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is assigned. This is done as follows:</p>
</div>
<div class="ltx_para" id="S4.SS1.SSS3.p18">
<p class="ltx_p" id="S4.SS1.SSS3.p18.4">For each <math alttext="i=1,2,...,n" class="ltx_Math" display="inline" id="S4.SS1.SSS3.p18.1.m1.4"><semantics id="S4.SS1.SSS3.p18.1.m1.4a"><mrow id="S4.SS1.SSS3.p18.1.m1.4.5" xref="S4.SS1.SSS3.p18.1.m1.4.5.cmml"><mi id="S4.SS1.SSS3.p18.1.m1.4.5.2" xref="S4.SS1.SSS3.p18.1.m1.4.5.2.cmml">i</mi><mo id="S4.SS1.SSS3.p18.1.m1.4.5.1" xref="S4.SS1.SSS3.p18.1.m1.4.5.1.cmml">=</mo><mrow id="S4.SS1.SSS3.p18.1.m1.4.5.3.2" xref="S4.SS1.SSS3.p18.1.m1.4.5.3.1.cmml"><mn id="S4.SS1.SSS3.p18.1.m1.1.1" xref="S4.SS1.SSS3.p18.1.m1.1.1.cmml">1</mn><mo id="S4.SS1.SSS3.p18.1.m1.4.5.3.2.1" xref="S4.SS1.SSS3.p18.1.m1.4.5.3.1.cmml">,</mo><mn id="S4.SS1.SSS3.p18.1.m1.2.2" xref="S4.SS1.SSS3.p18.1.m1.2.2.cmml">2</mn><mo id="S4.SS1.SSS3.p18.1.m1.4.5.3.2.2" xref="S4.SS1.SSS3.p18.1.m1.4.5.3.1.cmml">,</mo><mi id="S4.SS1.SSS3.p18.1.m1.3.3" mathvariant="normal" xref="S4.SS1.SSS3.p18.1.m1.3.3.cmml">…</mi><mo id="S4.SS1.SSS3.p18.1.m1.4.5.3.2.3" xref="S4.SS1.SSS3.p18.1.m1.4.5.3.1.cmml">,</mo><mi id="S4.SS1.SSS3.p18.1.m1.4.4" xref="S4.SS1.SSS3.p18.1.m1.4.4.cmml">n</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p18.1.m1.4b"><apply id="S4.SS1.SSS3.p18.1.m1.4.5.cmml" xref="S4.SS1.SSS3.p18.1.m1.4.5"><eq id="S4.SS1.SSS3.p18.1.m1.4.5.1.cmml" xref="S4.SS1.SSS3.p18.1.m1.4.5.1"></eq><ci id="S4.SS1.SSS3.p18.1.m1.4.5.2.cmml" xref="S4.SS1.SSS3.p18.1.m1.4.5.2">𝑖</ci><list id="S4.SS1.SSS3.p18.1.m1.4.5.3.1.cmml" xref="S4.SS1.SSS3.p18.1.m1.4.5.3.2"><cn id="S4.SS1.SSS3.p18.1.m1.1.1.cmml" type="integer" xref="S4.SS1.SSS3.p18.1.m1.1.1">1</cn><cn id="S4.SS1.SSS3.p18.1.m1.2.2.cmml" type="integer" xref="S4.SS1.SSS3.p18.1.m1.2.2">2</cn><ci id="S4.SS1.SSS3.p18.1.m1.3.3.cmml" xref="S4.SS1.SSS3.p18.1.m1.3.3">…</ci><ci id="S4.SS1.SSS3.p18.1.m1.4.4.cmml" xref="S4.SS1.SSS3.p18.1.m1.4.4">𝑛</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p18.1.m1.4c">i=1,2,...,n</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.p18.1.m1.4d">italic_i = 1 , 2 , … , italic_n</annotation></semantics></math>, we set <math alttext="x_{i}=z_{j}" class="ltx_Math" display="inline" id="S4.SS1.SSS3.p18.2.m2.1"><semantics id="S4.SS1.SSS3.p18.2.m2.1a"><mrow id="S4.SS1.SSS3.p18.2.m2.1.1" xref="S4.SS1.SSS3.p18.2.m2.1.1.cmml"><msub id="S4.SS1.SSS3.p18.2.m2.1.1.2" xref="S4.SS1.SSS3.p18.2.m2.1.1.2.cmml"><mi id="S4.SS1.SSS3.p18.2.m2.1.1.2.2" xref="S4.SS1.SSS3.p18.2.m2.1.1.2.2.cmml">x</mi><mi id="S4.SS1.SSS3.p18.2.m2.1.1.2.3" xref="S4.SS1.SSS3.p18.2.m2.1.1.2.3.cmml">i</mi></msub><mo id="S4.SS1.SSS3.p18.2.m2.1.1.1" xref="S4.SS1.SSS3.p18.2.m2.1.1.1.cmml">=</mo><msub id="S4.SS1.SSS3.p18.2.m2.1.1.3" xref="S4.SS1.SSS3.p18.2.m2.1.1.3.cmml"><mi id="S4.SS1.SSS3.p18.2.m2.1.1.3.2" xref="S4.SS1.SSS3.p18.2.m2.1.1.3.2.cmml">z</mi><mi id="S4.SS1.SSS3.p18.2.m2.1.1.3.3" xref="S4.SS1.SSS3.p18.2.m2.1.1.3.3.cmml">j</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p18.2.m2.1b"><apply id="S4.SS1.SSS3.p18.2.m2.1.1.cmml" xref="S4.SS1.SSS3.p18.2.m2.1.1"><eq id="S4.SS1.SSS3.p18.2.m2.1.1.1.cmml" xref="S4.SS1.SSS3.p18.2.m2.1.1.1"></eq><apply id="S4.SS1.SSS3.p18.2.m2.1.1.2.cmml" xref="S4.SS1.SSS3.p18.2.m2.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p18.2.m2.1.1.2.1.cmml" xref="S4.SS1.SSS3.p18.2.m2.1.1.2">subscript</csymbol><ci id="S4.SS1.SSS3.p18.2.m2.1.1.2.2.cmml" xref="S4.SS1.SSS3.p18.2.m2.1.1.2.2">𝑥</ci><ci id="S4.SS1.SSS3.p18.2.m2.1.1.2.3.cmml" xref="S4.SS1.SSS3.p18.2.m2.1.1.2.3">𝑖</ci></apply><apply id="S4.SS1.SSS3.p18.2.m2.1.1.3.cmml" xref="S4.SS1.SSS3.p18.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p18.2.m2.1.1.3.1.cmml" xref="S4.SS1.SSS3.p18.2.m2.1.1.3">subscript</csymbol><ci id="S4.SS1.SSS3.p18.2.m2.1.1.3.2.cmml" xref="S4.SS1.SSS3.p18.2.m2.1.1.3.2">𝑧</ci><ci id="S4.SS1.SSS3.p18.2.m2.1.1.3.3.cmml" xref="S4.SS1.SSS3.p18.2.m2.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p18.2.m2.1c">x_{i}=z_{j}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.p18.2.m2.1d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_z start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>, where <math alttext="z_{j}" class="ltx_Math" display="inline" id="S4.SS1.SSS3.p18.3.m3.1"><semantics id="S4.SS1.SSS3.p18.3.m3.1a"><msub id="S4.SS1.SSS3.p18.3.m3.1.1" xref="S4.SS1.SSS3.p18.3.m3.1.1.cmml"><mi id="S4.SS1.SSS3.p18.3.m3.1.1.2" xref="S4.SS1.SSS3.p18.3.m3.1.1.2.cmml">z</mi><mi id="S4.SS1.SSS3.p18.3.m3.1.1.3" xref="S4.SS1.SSS3.p18.3.m3.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p18.3.m3.1b"><apply id="S4.SS1.SSS3.p18.3.m3.1.1.cmml" xref="S4.SS1.SSS3.p18.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p18.3.m3.1.1.1.cmml" xref="S4.SS1.SSS3.p18.3.m3.1.1">subscript</csymbol><ci id="S4.SS1.SSS3.p18.3.m3.1.1.2.cmml" xref="S4.SS1.SSS3.p18.3.m3.1.1.2">𝑧</ci><ci id="S4.SS1.SSS3.p18.3.m3.1.1.3.cmml" xref="S4.SS1.SSS3.p18.3.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p18.3.m3.1c">z_{j}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.p18.3.m3.1d">italic_z start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> is the cluster center of the cluster to which <math alttext="x_{i}" class="ltx_Math" display="inline" id="S4.SS1.SSS3.p18.4.m4.1"><semantics id="S4.SS1.SSS3.p18.4.m4.1a"><msub id="S4.SS1.SSS3.p18.4.m4.1.1" xref="S4.SS1.SSS3.p18.4.m4.1.1.cmml"><mi id="S4.SS1.SSS3.p18.4.m4.1.1.2" xref="S4.SS1.SSS3.p18.4.m4.1.1.2.cmml">x</mi><mi id="S4.SS1.SSS3.p18.4.m4.1.1.3" xref="S4.SS1.SSS3.p18.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p18.4.m4.1b"><apply id="S4.SS1.SSS3.p18.4.m4.1.1.cmml" xref="S4.SS1.SSS3.p18.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p18.4.m4.1.1.1.cmml" xref="S4.SS1.SSS3.p18.4.m4.1.1">subscript</csymbol><ci id="S4.SS1.SSS3.p18.4.m4.1.1.2.cmml" xref="S4.SS1.SSS3.p18.4.m4.1.1.2">𝑥</ci><ci id="S4.SS1.SSS3.p18.4.m4.1.1.3.cmml" xref="S4.SS1.SSS3.p18.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p18.4.m4.1c">x_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.p18.4.m4.1d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> belongs in the final clustering result.</p>
</div>
<div class="ltx_para" id="S4.SS1.SSS3.p19">
<p class="ltx_p" id="S4.SS1.SSS3.p19.1">After this replacement, we can use these new vectors for further operations.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS1.SSS4">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text" id="S4.SS1.SSS4.5.1.1">IV-A</span>4 </span>Time data</h4>
<div class="ltx_para" id="S4.SS1.SSS4.p1">
<p class="ltx_p" id="S4.SS1.SSS4.p1.1">As shown in the green box in the orange block of Figure <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S2.F2" title="Figure 2 ‣ II Related Work ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_tag">2</span></a>, we extract information such as month, day, weekday, hour, and minute from the time data (Time_seq). Each extracted feature is then separately subjected to Word embedding, and the resulting vectors are concatenated. These concatenated vectors undergo a further linear transformation to obtain the time information matrix, denoted as <span class="ltx_text ltx_font_bold" id="S4.SS1.SSS4.p1.1.1">t</span>. We compare this approach with conventional encoding methods<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib60" title=""><span class="ltx_text" style="font-size:80%;">60</span></a>]</cite>, where time information is encoded and combined with relative positional encoding. In our approach, we have fused the encoded time information with other relevant data in the later stage of cross-modal data fusion, rather than merely adding it to the position encoding. The results of this comparison are presented in Section <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S6.SS3" title="VI-C Time encoding comparison experiment ‣ VI Result ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">VI-C</span></span></a>.</p>
</div>
<div class="ltx_para" id="S4.SS1.SSS4.p2">
<p class="ltx_p" id="S4.SS1.SSS4.p2.1">After data preprocessing, the data transformed into:</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S4.E8">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E8X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{a}=\text{WE}(\text{App\_seq})" class="ltx_Math" display="inline" id="S4.E8X.2.1.1.m1.1"><semantics id="S4.E8X.2.1.1.m1.1a"><mrow id="S4.E8X.2.1.1.m1.1.2" xref="S4.E8X.2.1.1.m1.1.2.cmml"><mi id="S4.E8X.2.1.1.m1.1.2.2" xref="S4.E8X.2.1.1.m1.1.2.2.cmml">𝐚</mi><mo id="S4.E8X.2.1.1.m1.1.2.1" xref="S4.E8X.2.1.1.m1.1.2.1.cmml">=</mo><mrow id="S4.E8X.2.1.1.m1.1.2.3" xref="S4.E8X.2.1.1.m1.1.2.3.cmml"><mtext id="S4.E8X.2.1.1.m1.1.2.3.2" xref="S4.E8X.2.1.1.m1.1.2.3.2a.cmml">WE</mtext><mo id="S4.E8X.2.1.1.m1.1.2.3.1" xref="S4.E8X.2.1.1.m1.1.2.3.1.cmml">⁢</mo><mrow id="S4.E8X.2.1.1.m1.1.2.3.3.2" xref="S4.E8X.2.1.1.m1.1.1a.cmml"><mo id="S4.E8X.2.1.1.m1.1.2.3.3.2.1" stretchy="false" xref="S4.E8X.2.1.1.m1.1.1a.cmml">(</mo><mtext id="S4.E8X.2.1.1.m1.1.1" xref="S4.E8X.2.1.1.m1.1.1.cmml">App_seq</mtext><mo id="S4.E8X.2.1.1.m1.1.2.3.3.2.2" stretchy="false" xref="S4.E8X.2.1.1.m1.1.1a.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E8X.2.1.1.m1.1b"><apply id="S4.E8X.2.1.1.m1.1.2.cmml" xref="S4.E8X.2.1.1.m1.1.2"><eq id="S4.E8X.2.1.1.m1.1.2.1.cmml" xref="S4.E8X.2.1.1.m1.1.2.1"></eq><ci id="S4.E8X.2.1.1.m1.1.2.2.cmml" xref="S4.E8X.2.1.1.m1.1.2.2">𝐚</ci><apply id="S4.E8X.2.1.1.m1.1.2.3.cmml" xref="S4.E8X.2.1.1.m1.1.2.3"><times id="S4.E8X.2.1.1.m1.1.2.3.1.cmml" xref="S4.E8X.2.1.1.m1.1.2.3.1"></times><ci id="S4.E8X.2.1.1.m1.1.2.3.2a.cmml" xref="S4.E8X.2.1.1.m1.1.2.3.2"><mtext id="S4.E8X.2.1.1.m1.1.2.3.2.cmml" xref="S4.E8X.2.1.1.m1.1.2.3.2">WE</mtext></ci><ci id="S4.E8X.2.1.1.m1.1.1a.cmml" xref="S4.E8X.2.1.1.m1.1.2.3.3.2"><mtext id="S4.E8X.2.1.1.m1.1.1.cmml" xref="S4.E8X.2.1.1.m1.1.1">App_seq</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8X.2.1.1.m1.1c">\displaystyle\mathbf{a}=\text{WE}(\text{App\_seq})</annotation><annotation encoding="application/x-llamapun" id="S4.E8X.2.1.1.m1.1d">bold_a = WE ( App_seq )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(8)</span></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_para" id="S4.SS1.SSS4.p3">
<p class="ltx_p" id="S4.SS1.SSS4.p3.1">where WE denotes word embedding.</p>
</div>
<div class="ltx_para" id="S4.SS1.SSS4.p4">
<table class="ltx_equationgroup ltx_eqn_table" id="S4.E9">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E9X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{u}=\text{WE}(\text{User}\text{ }\text{IDs})" class="ltx_Math" display="inline" id="S4.E9X.2.1.1.m1.1"><semantics id="S4.E9X.2.1.1.m1.1a"><mrow id="S4.E9X.2.1.1.m1.1.2" xref="S4.E9X.2.1.1.m1.1.2.cmml"><mi id="S4.E9X.2.1.1.m1.1.2.2" xref="S4.E9X.2.1.1.m1.1.2.2.cmml">𝐮</mi><mo id="S4.E9X.2.1.1.m1.1.2.1" xref="S4.E9X.2.1.1.m1.1.2.1.cmml">=</mo><mrow id="S4.E9X.2.1.1.m1.1.2.3" xref="S4.E9X.2.1.1.m1.1.2.3.cmml"><mtext id="S4.E9X.2.1.1.m1.1.2.3.2" xref="S4.E9X.2.1.1.m1.1.2.3.2a.cmml">WE</mtext><mo id="S4.E9X.2.1.1.m1.1.2.3.1" xref="S4.E9X.2.1.1.m1.1.2.3.1.cmml">⁢</mo><mrow id="S4.E9X.2.1.1.m1.1.2.3.3.2" xref="S4.E9X.2.1.1.m1.1.1d.cmml"><mo id="S4.E9X.2.1.1.m1.1.2.3.3.2.1" stretchy="false" xref="S4.E9X.2.1.1.m1.1.1d.cmml">(</mo><mrow id="S4.E9X.2.1.1.m1.1.1" xref="S4.E9X.2.1.1.m1.1.1d.cmml"><mtext id="S4.E9X.2.1.1.m1.1.1a" xref="S4.E9X.2.1.1.m1.1.1a.cmml">User</mtext><mtext id="S4.E9X.2.1.1.m1.1.1b" xref="S4.E9X.2.1.1.m1.1.1a.cmml"> </mtext><mtext id="S4.E9X.2.1.1.m1.1.1c" xref="S4.E9X.2.1.1.m1.1.1a.cmml">IDs</mtext></mrow><mo id="S4.E9X.2.1.1.m1.1.2.3.3.2.2" stretchy="false" xref="S4.E9X.2.1.1.m1.1.1d.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E9X.2.1.1.m1.1b"><apply id="S4.E9X.2.1.1.m1.1.2.cmml" xref="S4.E9X.2.1.1.m1.1.2"><eq id="S4.E9X.2.1.1.m1.1.2.1.cmml" xref="S4.E9X.2.1.1.m1.1.2.1"></eq><ci id="S4.E9X.2.1.1.m1.1.2.2.cmml" xref="S4.E9X.2.1.1.m1.1.2.2">𝐮</ci><apply id="S4.E9X.2.1.1.m1.1.2.3.cmml" xref="S4.E9X.2.1.1.m1.1.2.3"><times id="S4.E9X.2.1.1.m1.1.2.3.1.cmml" xref="S4.E9X.2.1.1.m1.1.2.3.1"></times><ci id="S4.E9X.2.1.1.m1.1.2.3.2a.cmml" xref="S4.E9X.2.1.1.m1.1.2.3.2"><mtext id="S4.E9X.2.1.1.m1.1.2.3.2.cmml" xref="S4.E9X.2.1.1.m1.1.2.3.2">WE</mtext></ci><ci id="S4.E9X.2.1.1.m1.1.1d.cmml" xref="S4.E9X.2.1.1.m1.1.2.3.3.2"><mrow id="S4.E9X.2.1.1.m1.1.1.cmml" xref="S4.E9X.2.1.1.m1.1.2.3.3.2"><mtext id="S4.E9X.2.1.1.m1.1.1a.cmml" xref="S4.E9X.2.1.1.m1.1.1a">User</mtext><mtext id="S4.E9X.2.1.1.m1.1.1b.cmml" xref="S4.E9X.2.1.1.m1.1.1a"> </mtext><mtext id="S4.E9X.2.1.1.m1.1.1c.cmml" xref="S4.E9X.2.1.1.m1.1.1a">IDs</mtext></mrow></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E9X.2.1.1.m1.1c">\displaystyle\mathbf{u}=\text{WE}(\text{User}\text{ }\text{IDs})</annotation><annotation encoding="application/x-llamapun" id="S4.E9X.2.1.1.m1.1d">bold_u = WE ( roman_User roman_IDs )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(9)</span></td>
</tr>
</tbody>
</table>
<table class="ltx_equationgroup ltx_eqn_table" id="S4.E10">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E10X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{l}=\text{Linear}(\text{K-Modes}(\text{POIs}))" class="ltx_Math" display="inline" id="S4.E10X.2.1.1.m1.2"><semantics id="S4.E10X.2.1.1.m1.2a"><mrow id="S4.E10X.2.1.1.m1.2.2" xref="S4.E10X.2.1.1.m1.2.2.cmml"><mi id="S4.E10X.2.1.1.m1.2.2.3" xref="S4.E10X.2.1.1.m1.2.2.3.cmml">𝐥</mi><mo id="S4.E10X.2.1.1.m1.2.2.2" xref="S4.E10X.2.1.1.m1.2.2.2.cmml">=</mo><mrow id="S4.E10X.2.1.1.m1.2.2.1" xref="S4.E10X.2.1.1.m1.2.2.1.cmml"><mtext id="S4.E10X.2.1.1.m1.2.2.1.3" xref="S4.E10X.2.1.1.m1.2.2.1.3a.cmml">Linear</mtext><mo id="S4.E10X.2.1.1.m1.2.2.1.2" xref="S4.E10X.2.1.1.m1.2.2.1.2.cmml">⁢</mo><mrow id="S4.E10X.2.1.1.m1.2.2.1.1.1" xref="S4.E10X.2.1.1.m1.2.2.1.1.1.1.cmml"><mo id="S4.E10X.2.1.1.m1.2.2.1.1.1.2" stretchy="false" xref="S4.E10X.2.1.1.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="S4.E10X.2.1.1.m1.2.2.1.1.1.1" xref="S4.E10X.2.1.1.m1.2.2.1.1.1.1.cmml"><mtext id="S4.E10X.2.1.1.m1.2.2.1.1.1.1.2" xref="S4.E10X.2.1.1.m1.2.2.1.1.1.1.2a.cmml">K-Modes</mtext><mo id="S4.E10X.2.1.1.m1.2.2.1.1.1.1.1" xref="S4.E10X.2.1.1.m1.2.2.1.1.1.1.1.cmml">⁢</mo><mrow id="S4.E10X.2.1.1.m1.2.2.1.1.1.1.3.2" xref="S4.E10X.2.1.1.m1.1.1a.cmml"><mo id="S4.E10X.2.1.1.m1.2.2.1.1.1.1.3.2.1" stretchy="false" xref="S4.E10X.2.1.1.m1.1.1a.cmml">(</mo><mtext id="S4.E10X.2.1.1.m1.1.1" xref="S4.E10X.2.1.1.m1.1.1.cmml">POIs</mtext><mo id="S4.E10X.2.1.1.m1.2.2.1.1.1.1.3.2.2" stretchy="false" xref="S4.E10X.2.1.1.m1.1.1a.cmml">)</mo></mrow></mrow><mo id="S4.E10X.2.1.1.m1.2.2.1.1.1.3" stretchy="false" xref="S4.E10X.2.1.1.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E10X.2.1.1.m1.2b"><apply id="S4.E10X.2.1.1.m1.2.2.cmml" xref="S4.E10X.2.1.1.m1.2.2"><eq id="S4.E10X.2.1.1.m1.2.2.2.cmml" xref="S4.E10X.2.1.1.m1.2.2.2"></eq><ci id="S4.E10X.2.1.1.m1.2.2.3.cmml" xref="S4.E10X.2.1.1.m1.2.2.3">𝐥</ci><apply id="S4.E10X.2.1.1.m1.2.2.1.cmml" xref="S4.E10X.2.1.1.m1.2.2.1"><times id="S4.E10X.2.1.1.m1.2.2.1.2.cmml" xref="S4.E10X.2.1.1.m1.2.2.1.2"></times><ci id="S4.E10X.2.1.1.m1.2.2.1.3a.cmml" xref="S4.E10X.2.1.1.m1.2.2.1.3"><mtext id="S4.E10X.2.1.1.m1.2.2.1.3.cmml" xref="S4.E10X.2.1.1.m1.2.2.1.3">Linear</mtext></ci><apply id="S4.E10X.2.1.1.m1.2.2.1.1.1.1.cmml" xref="S4.E10X.2.1.1.m1.2.2.1.1.1"><times id="S4.E10X.2.1.1.m1.2.2.1.1.1.1.1.cmml" xref="S4.E10X.2.1.1.m1.2.2.1.1.1.1.1"></times><ci id="S4.E10X.2.1.1.m1.2.2.1.1.1.1.2a.cmml" xref="S4.E10X.2.1.1.m1.2.2.1.1.1.1.2"><mtext id="S4.E10X.2.1.1.m1.2.2.1.1.1.1.2.cmml" xref="S4.E10X.2.1.1.m1.2.2.1.1.1.1.2">K-Modes</mtext></ci><ci id="S4.E10X.2.1.1.m1.1.1a.cmml" xref="S4.E10X.2.1.1.m1.2.2.1.1.1.1.3.2"><mtext id="S4.E10X.2.1.1.m1.1.1.cmml" xref="S4.E10X.2.1.1.m1.1.1">POIs</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E10X.2.1.1.m1.2c">\displaystyle\mathbf{l}=\text{Linear}(\text{K-Modes}(\text{POIs}))</annotation><annotation encoding="application/x-llamapun" id="S4.E10X.2.1.1.m1.2d">bold_l = Linear ( K-Modes ( POIs ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(10)</span></td>
</tr>
</tbody>
</table>
<table class="ltx_equationgroup ltx_eqn_table" id="S4.E11">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E11X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{t}=" class="ltx_Math" display="inline" id="S4.E11X.2.1.1.m1.1"><semantics id="S4.E11X.2.1.1.m1.1a"><mrow id="S4.E11X.2.1.1.m1.1.1" xref="S4.E11X.2.1.1.m1.1.1.cmml"><mi id="S4.E11X.2.1.1.m1.1.1.2" xref="S4.E11X.2.1.1.m1.1.1.2.cmml">𝐭</mi><mo id="S4.E11X.2.1.1.m1.1.1.1" xref="S4.E11X.2.1.1.m1.1.1.1.cmml">=</mo><mi id="S4.E11X.2.1.1.m1.1.1.3" xref="S4.E11X.2.1.1.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S4.E11X.2.1.1.m1.1b"><apply id="S4.E11X.2.1.1.m1.1.1.cmml" xref="S4.E11X.2.1.1.m1.1.1"><eq id="S4.E11X.2.1.1.m1.1.1.1.cmml" xref="S4.E11X.2.1.1.m1.1.1.1"></eq><ci id="S4.E11X.2.1.1.m1.1.1.2.cmml" xref="S4.E11X.2.1.1.m1.1.1.2">𝐭</ci><csymbol cd="latexml" id="S4.E11X.2.1.1.m1.1.1.3.cmml" xref="S4.E11X.2.1.1.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E11X.2.1.1.m1.1c">\displaystyle\mathbf{t}=</annotation><annotation encoding="application/x-llamapun" id="S4.E11X.2.1.1.m1.1d">bold_t =</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\text{Linear}(\text{Concat}(\text{WE}(\text{Month}),\text{WE}(%
\text{Day})," class="ltx_math_unparsed" display="inline" id="S4.E11X.3.2.2.m1.2"><semantics id="S4.E11X.3.2.2.m1.2a"><mrow id="S4.E11X.3.2.2.m1.2b"><mtext id="S4.E11X.3.2.2.m1.2.3">Linear</mtext><mrow id="S4.E11X.3.2.2.m1.2.4"><mo id="S4.E11X.3.2.2.m1.2.4.1" stretchy="false">(</mo><mtext id="S4.E11X.3.2.2.m1.2.4.2">Concat</mtext><mrow id="S4.E11X.3.2.2.m1.2.4.3"><mo id="S4.E11X.3.2.2.m1.2.4.3.1" stretchy="false">(</mo><mtext id="S4.E11X.3.2.2.m1.2.4.3.2">WE</mtext><mrow id="S4.E11X.3.2.2.m1.2.4.3.3"><mo id="S4.E11X.3.2.2.m1.2.4.3.3.1" stretchy="false">(</mo><mtext id="S4.E11X.3.2.2.m1.1.1">Month</mtext><mo id="S4.E11X.3.2.2.m1.2.4.3.3.2" stretchy="false">)</mo></mrow><mo id="S4.E11X.3.2.2.m1.2.4.3.4">,</mo><mtext id="S4.E11X.3.2.2.m1.2.4.3.5">WE</mtext><mrow id="S4.E11X.3.2.2.m1.2.4.3.6"><mo id="S4.E11X.3.2.2.m1.2.4.3.6.1" stretchy="false">(</mo><mtext id="S4.E11X.3.2.2.m1.2.2">Day</mtext><mo id="S4.E11X.3.2.2.m1.2.4.3.6.2" stretchy="false">)</mo></mrow><mo id="S4.E11X.3.2.2.m1.2.4.3.7">,</mo></mrow></mrow></mrow><annotation encoding="application/x-tex" id="S4.E11X.3.2.2.m1.2c">\displaystyle\text{Linear}(\text{Concat}(\text{WE}(\text{Month}),\text{WE}(%
\text{Day}),</annotation><annotation encoding="application/x-llamapun" id="S4.E11X.3.2.2.m1.2d">Linear ( Concat ( WE ( Month ) , WE ( Day ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(11)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E11Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\text{WE}(\text{Weekday}),\text{WE}(\text{Hour}),\text{WE}(\text{%
Minute}))" class="ltx_math_unparsed" display="inline" id="S4.E11Xa.2.1.1.m1.3"><semantics id="S4.E11Xa.2.1.1.m1.3a"><mrow id="S4.E11Xa.2.1.1.m1.3b"><mtext id="S4.E11Xa.2.1.1.m1.3.4">WE</mtext><mrow id="S4.E11Xa.2.1.1.m1.3.5"><mo id="S4.E11Xa.2.1.1.m1.3.5.1" stretchy="false">(</mo><mtext id="S4.E11Xa.2.1.1.m1.1.1">Weekday</mtext><mo id="S4.E11Xa.2.1.1.m1.3.5.2" stretchy="false">)</mo></mrow><mo id="S4.E11Xa.2.1.1.m1.3.6">,</mo><mtext id="S4.E11Xa.2.1.1.m1.3.7">WE</mtext><mrow id="S4.E11Xa.2.1.1.m1.3.8"><mo id="S4.E11Xa.2.1.1.m1.3.8.1" stretchy="false">(</mo><mtext id="S4.E11Xa.2.1.1.m1.2.2">Hour</mtext><mo id="S4.E11Xa.2.1.1.m1.3.8.2" stretchy="false">)</mo></mrow><mo id="S4.E11Xa.2.1.1.m1.3.9">,</mo><mtext id="S4.E11Xa.2.1.1.m1.3.10">WE</mtext><mrow id="S4.E11Xa.2.1.1.m1.3.11"><mo id="S4.E11Xa.2.1.1.m1.3.11.1" stretchy="false">(</mo><mtext id="S4.E11Xa.2.1.1.m1.3.3">Minute</mtext><mo id="S4.E11Xa.2.1.1.m1.3.11.2" stretchy="false">)</mo></mrow><mo id="S4.E11Xa.2.1.1.m1.3.12" stretchy="false">)</mo></mrow><annotation encoding="application/x-tex" id="S4.E11Xa.2.1.1.m1.3c">\displaystyle\text{WE}(\text{Weekday}),\text{WE}(\text{Hour}),\text{WE}(\text{%
Minute}))</annotation><annotation encoding="application/x-llamapun" id="S4.E11Xa.2.1.1.m1.3d">WE ( Weekday ) , WE ( Hour ) , WE ( Minute ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S4.SS2.5.1.1">IV-B</span> </span><span class="ltx_text ltx_font_italic" id="S4.SS2.6.2">Appformer Framework Overview</span>
</h3>
<figure class="ltx_figure" id="S4.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="736" id="S4.F3.g1" src="x3.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Appformer framework for app usage prediction.</figcaption>
</figure>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">The Appformer framework, designed with the specific aim of predicting app usage sequences, leverages multi-modal data to its advantage. As illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S4.F3" title="Figure 3 ‣ IV-B Appformer Framework Overview ‣ IV Method ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_tag">3</span></a>, the Appformer comprises two core components: the Multi-Modal Data Progressive Fusion Module and the Feature Extraction Module. These components are intricately designed to work seamlessly together, first by progressively integrating data from diverse sources and then by extracting relevant features to enhance the predictive model’s accuracy. To improve transparency regarding the computational process of Appformer, we have provided pseudocode that elaborates on its complete computational steps, as shown in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#alg1" title="Algorithm 1 ‣ IV-B Appformer Framework Overview ‣ IV Method ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.2.1.1">Algorithm 1</span> </span> Appformer: Integrated Multi-Modal Data Progressive Fusion Module and Feature Extraction Module</figcaption>
<div class="ltx_listing ltx_listing" id="alg1.3">
<div class="ltx_listingline" id="algx1.l0">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algx1.l0.1.1.1" style="font-size:80%;">0:</span></span>  Encoded vectors <math alttext="u" class="ltx_Math" display="inline" id="algx1.l0.m1.1"><semantics id="algx1.l0.m1.1a"><mi id="algx1.l0.m1.1.1" xref="algx1.l0.m1.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="algx1.l0.m1.1b"><ci id="algx1.l0.m1.1.1.cmml" xref="algx1.l0.m1.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l0.m1.1c">u</annotation><annotation encoding="application/x-llamapun" id="algx1.l0.m1.1d">italic_u</annotation></semantics></math>, <math alttext="a" class="ltx_Math" display="inline" id="algx1.l0.m2.1"><semantics id="algx1.l0.m2.1a"><mi id="algx1.l0.m2.1.1" xref="algx1.l0.m2.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="algx1.l0.m2.1b"><ci id="algx1.l0.m2.1.1.cmml" xref="algx1.l0.m2.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l0.m2.1c">a</annotation><annotation encoding="application/x-llamapun" id="algx1.l0.m2.1d">italic_a</annotation></semantics></math>, <math alttext="l" class="ltx_Math" display="inline" id="algx1.l0.m3.1"><semantics id="algx1.l0.m3.1a"><mi id="algx1.l0.m3.1.1" xref="algx1.l0.m3.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="algx1.l0.m3.1b"><ci id="algx1.l0.m3.1.1.cmml" xref="algx1.l0.m3.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l0.m3.1c">l</annotation><annotation encoding="application/x-llamapun" id="algx1.l0.m3.1d">italic_l</annotation></semantics></math>, <math alttext="t" class="ltx_Math" display="inline" id="algx1.l0.m4.1"><semantics id="algx1.l0.m4.1a"><mi id="algx1.l0.m4.1.1" xref="algx1.l0.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="algx1.l0.m4.1b"><ci id="algx1.l0.m4.1.1.cmml" xref="algx1.l0.m4.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l0.m4.1c">t</annotation><annotation encoding="application/x-llamapun" id="algx1.l0.m4.1d">italic_t</annotation></semantics></math>, model parameters

</div>
<div class="ltx_listingline" id="algx1.l0a">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algx1.l0a.1.1.1" style="font-size:80%;">0:</span></span>  Final output vector <math alttext="Y_{\text{pred}}" class="ltx_Math" display="inline" id="algx1.l0a.m1.1"><semantics id="algx1.l0a.m1.1a"><msub id="algx1.l0a.m1.1.1" xref="algx1.l0a.m1.1.1.cmml"><mi id="algx1.l0a.m1.1.1.2" xref="algx1.l0a.m1.1.1.2.cmml">Y</mi><mtext id="algx1.l0a.m1.1.1.3" xref="algx1.l0a.m1.1.1.3a.cmml">pred</mtext></msub><annotation-xml encoding="MathML-Content" id="algx1.l0a.m1.1b"><apply id="algx1.l0a.m1.1.1.cmml" xref="algx1.l0a.m1.1.1"><csymbol cd="ambiguous" id="algx1.l0a.m1.1.1.1.cmml" xref="algx1.l0a.m1.1.1">subscript</csymbol><ci id="algx1.l0a.m1.1.1.2.cmml" xref="algx1.l0a.m1.1.1.2">𝑌</ci><ci id="algx1.l0a.m1.1.1.3a.cmml" xref="algx1.l0a.m1.1.1.3"><mtext id="algx1.l0a.m1.1.1.3.cmml" mathsize="70%" xref="algx1.l0a.m1.1.1.3">pred</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l0a.m1.1c">Y_{\text{pred}}</annotation><annotation encoding="application/x-llamapun" id="algx1.l0a.m1.1d">italic_Y start_POSTSUBSCRIPT pred end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algx1.l1">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algx1.l1.1.1.1" style="font-size:80%;">1:</span></span>  // Multi-Modal Data Progressive Fusion Module

</div>
<div class="ltx_listingline" id="algx1.l2">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algx1.l2.1.1.1" style="font-size:80%;">2:</span></span>  <math alttext="fused\_app\_user\leftarrow\text{LinearTransform}(Concat(a,u))" class="ltx_Math" display="inline" id="algx1.l2.m1.3"><semantics id="algx1.l2.m1.3a"><mrow id="algx1.l2.m1.3.3" xref="algx1.l2.m1.3.3.cmml"><mrow id="algx1.l2.m1.3.3.3" xref="algx1.l2.m1.3.3.3.cmml"><mi id="algx1.l2.m1.3.3.3.2" xref="algx1.l2.m1.3.3.3.2.cmml">f</mi><mo id="algx1.l2.m1.3.3.3.1" xref="algx1.l2.m1.3.3.3.1.cmml">⁢</mo><mi id="algx1.l2.m1.3.3.3.3" xref="algx1.l2.m1.3.3.3.3.cmml">u</mi><mo id="algx1.l2.m1.3.3.3.1a" xref="algx1.l2.m1.3.3.3.1.cmml">⁢</mo><mi id="algx1.l2.m1.3.3.3.4" xref="algx1.l2.m1.3.3.3.4.cmml">s</mi><mo id="algx1.l2.m1.3.3.3.1b" xref="algx1.l2.m1.3.3.3.1.cmml">⁢</mo><mi id="algx1.l2.m1.3.3.3.5" xref="algx1.l2.m1.3.3.3.5.cmml">e</mi><mo id="algx1.l2.m1.3.3.3.1c" xref="algx1.l2.m1.3.3.3.1.cmml">⁢</mo><mi id="algx1.l2.m1.3.3.3.6" xref="algx1.l2.m1.3.3.3.6.cmml">d</mi><mo id="algx1.l2.m1.3.3.3.1d" xref="algx1.l2.m1.3.3.3.1.cmml">⁢</mo><mi id="algx1.l2.m1.3.3.3.7" mathvariant="normal" xref="algx1.l2.m1.3.3.3.7.cmml">_</mi><mo id="algx1.l2.m1.3.3.3.1e" xref="algx1.l2.m1.3.3.3.1.cmml">⁢</mo><mi id="algx1.l2.m1.3.3.3.8" xref="algx1.l2.m1.3.3.3.8.cmml">a</mi><mo id="algx1.l2.m1.3.3.3.1f" xref="algx1.l2.m1.3.3.3.1.cmml">⁢</mo><mi id="algx1.l2.m1.3.3.3.9" xref="algx1.l2.m1.3.3.3.9.cmml">p</mi><mo id="algx1.l2.m1.3.3.3.1g" xref="algx1.l2.m1.3.3.3.1.cmml">⁢</mo><mi id="algx1.l2.m1.3.3.3.10" xref="algx1.l2.m1.3.3.3.10.cmml">p</mi><mo id="algx1.l2.m1.3.3.3.1h" xref="algx1.l2.m1.3.3.3.1.cmml">⁢</mo><mi id="algx1.l2.m1.3.3.3.11" mathvariant="normal" xref="algx1.l2.m1.3.3.3.11.cmml">_</mi><mo id="algx1.l2.m1.3.3.3.1i" xref="algx1.l2.m1.3.3.3.1.cmml">⁢</mo><mi id="algx1.l2.m1.3.3.3.12" xref="algx1.l2.m1.3.3.3.12.cmml">u</mi><mo id="algx1.l2.m1.3.3.3.1j" xref="algx1.l2.m1.3.3.3.1.cmml">⁢</mo><mi id="algx1.l2.m1.3.3.3.13" xref="algx1.l2.m1.3.3.3.13.cmml">s</mi><mo id="algx1.l2.m1.3.3.3.1k" xref="algx1.l2.m1.3.3.3.1.cmml">⁢</mo><mi id="algx1.l2.m1.3.3.3.14" xref="algx1.l2.m1.3.3.3.14.cmml">e</mi><mo id="algx1.l2.m1.3.3.3.1l" xref="algx1.l2.m1.3.3.3.1.cmml">⁢</mo><mi id="algx1.l2.m1.3.3.3.15" xref="algx1.l2.m1.3.3.3.15.cmml">r</mi></mrow><mo id="algx1.l2.m1.3.3.2" stretchy="false" xref="algx1.l2.m1.3.3.2.cmml">←</mo><mrow id="algx1.l2.m1.3.3.1" xref="algx1.l2.m1.3.3.1.cmml"><mtext id="algx1.l2.m1.3.3.1.3" xref="algx1.l2.m1.3.3.1.3a.cmml">LinearTransform</mtext><mo id="algx1.l2.m1.3.3.1.2" xref="algx1.l2.m1.3.3.1.2.cmml">⁢</mo><mrow id="algx1.l2.m1.3.3.1.1.1" xref="algx1.l2.m1.3.3.1.1.1.1.cmml"><mo id="algx1.l2.m1.3.3.1.1.1.2" stretchy="false" xref="algx1.l2.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="algx1.l2.m1.3.3.1.1.1.1" xref="algx1.l2.m1.3.3.1.1.1.1.cmml"><mi id="algx1.l2.m1.3.3.1.1.1.1.2" xref="algx1.l2.m1.3.3.1.1.1.1.2.cmml">C</mi><mo id="algx1.l2.m1.3.3.1.1.1.1.1" xref="algx1.l2.m1.3.3.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l2.m1.3.3.1.1.1.1.3" xref="algx1.l2.m1.3.3.1.1.1.1.3.cmml">o</mi><mo id="algx1.l2.m1.3.3.1.1.1.1.1a" xref="algx1.l2.m1.3.3.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l2.m1.3.3.1.1.1.1.4" xref="algx1.l2.m1.3.3.1.1.1.1.4.cmml">n</mi><mo id="algx1.l2.m1.3.3.1.1.1.1.1b" xref="algx1.l2.m1.3.3.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l2.m1.3.3.1.1.1.1.5" xref="algx1.l2.m1.3.3.1.1.1.1.5.cmml">c</mi><mo id="algx1.l2.m1.3.3.1.1.1.1.1c" xref="algx1.l2.m1.3.3.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l2.m1.3.3.1.1.1.1.6" xref="algx1.l2.m1.3.3.1.1.1.1.6.cmml">a</mi><mo id="algx1.l2.m1.3.3.1.1.1.1.1d" xref="algx1.l2.m1.3.3.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l2.m1.3.3.1.1.1.1.7" xref="algx1.l2.m1.3.3.1.1.1.1.7.cmml">t</mi><mo id="algx1.l2.m1.3.3.1.1.1.1.1e" xref="algx1.l2.m1.3.3.1.1.1.1.1.cmml">⁢</mo><mrow id="algx1.l2.m1.3.3.1.1.1.1.8.2" xref="algx1.l2.m1.3.3.1.1.1.1.8.1.cmml"><mo id="algx1.l2.m1.3.3.1.1.1.1.8.2.1" stretchy="false" xref="algx1.l2.m1.3.3.1.1.1.1.8.1.cmml">(</mo><mi id="algx1.l2.m1.1.1" xref="algx1.l2.m1.1.1.cmml">a</mi><mo id="algx1.l2.m1.3.3.1.1.1.1.8.2.2" xref="algx1.l2.m1.3.3.1.1.1.1.8.1.cmml">,</mo><mi id="algx1.l2.m1.2.2" xref="algx1.l2.m1.2.2.cmml">u</mi><mo id="algx1.l2.m1.3.3.1.1.1.1.8.2.3" stretchy="false" xref="algx1.l2.m1.3.3.1.1.1.1.8.1.cmml">)</mo></mrow></mrow><mo id="algx1.l2.m1.3.3.1.1.1.3" stretchy="false" xref="algx1.l2.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx1.l2.m1.3b"><apply id="algx1.l2.m1.3.3.cmml" xref="algx1.l2.m1.3.3"><ci id="algx1.l2.m1.3.3.2.cmml" xref="algx1.l2.m1.3.3.2">←</ci><apply id="algx1.l2.m1.3.3.3.cmml" xref="algx1.l2.m1.3.3.3"><times id="algx1.l2.m1.3.3.3.1.cmml" xref="algx1.l2.m1.3.3.3.1"></times><ci id="algx1.l2.m1.3.3.3.2.cmml" xref="algx1.l2.m1.3.3.3.2">𝑓</ci><ci id="algx1.l2.m1.3.3.3.3.cmml" xref="algx1.l2.m1.3.3.3.3">𝑢</ci><ci id="algx1.l2.m1.3.3.3.4.cmml" xref="algx1.l2.m1.3.3.3.4">𝑠</ci><ci id="algx1.l2.m1.3.3.3.5.cmml" xref="algx1.l2.m1.3.3.3.5">𝑒</ci><ci id="algx1.l2.m1.3.3.3.6.cmml" xref="algx1.l2.m1.3.3.3.6">𝑑</ci><ci id="algx1.l2.m1.3.3.3.7.cmml" xref="algx1.l2.m1.3.3.3.7">_</ci><ci id="algx1.l2.m1.3.3.3.8.cmml" xref="algx1.l2.m1.3.3.3.8">𝑎</ci><ci id="algx1.l2.m1.3.3.3.9.cmml" xref="algx1.l2.m1.3.3.3.9">𝑝</ci><ci id="algx1.l2.m1.3.3.3.10.cmml" xref="algx1.l2.m1.3.3.3.10">𝑝</ci><ci id="algx1.l2.m1.3.3.3.11.cmml" xref="algx1.l2.m1.3.3.3.11">_</ci><ci id="algx1.l2.m1.3.3.3.12.cmml" xref="algx1.l2.m1.3.3.3.12">𝑢</ci><ci id="algx1.l2.m1.3.3.3.13.cmml" xref="algx1.l2.m1.3.3.3.13">𝑠</ci><ci id="algx1.l2.m1.3.3.3.14.cmml" xref="algx1.l2.m1.3.3.3.14">𝑒</ci><ci id="algx1.l2.m1.3.3.3.15.cmml" xref="algx1.l2.m1.3.3.3.15">𝑟</ci></apply><apply id="algx1.l2.m1.3.3.1.cmml" xref="algx1.l2.m1.3.3.1"><times id="algx1.l2.m1.3.3.1.2.cmml" xref="algx1.l2.m1.3.3.1.2"></times><ci id="algx1.l2.m1.3.3.1.3a.cmml" xref="algx1.l2.m1.3.3.1.3"><mtext id="algx1.l2.m1.3.3.1.3.cmml" xref="algx1.l2.m1.3.3.1.3">LinearTransform</mtext></ci><apply id="algx1.l2.m1.3.3.1.1.1.1.cmml" xref="algx1.l2.m1.3.3.1.1.1"><times id="algx1.l2.m1.3.3.1.1.1.1.1.cmml" xref="algx1.l2.m1.3.3.1.1.1.1.1"></times><ci id="algx1.l2.m1.3.3.1.1.1.1.2.cmml" xref="algx1.l2.m1.3.3.1.1.1.1.2">𝐶</ci><ci id="algx1.l2.m1.3.3.1.1.1.1.3.cmml" xref="algx1.l2.m1.3.3.1.1.1.1.3">𝑜</ci><ci id="algx1.l2.m1.3.3.1.1.1.1.4.cmml" xref="algx1.l2.m1.3.3.1.1.1.1.4">𝑛</ci><ci id="algx1.l2.m1.3.3.1.1.1.1.5.cmml" xref="algx1.l2.m1.3.3.1.1.1.1.5">𝑐</ci><ci id="algx1.l2.m1.3.3.1.1.1.1.6.cmml" xref="algx1.l2.m1.3.3.1.1.1.1.6">𝑎</ci><ci id="algx1.l2.m1.3.3.1.1.1.1.7.cmml" xref="algx1.l2.m1.3.3.1.1.1.1.7">𝑡</ci><interval closure="open" id="algx1.l2.m1.3.3.1.1.1.1.8.1.cmml" xref="algx1.l2.m1.3.3.1.1.1.1.8.2"><ci id="algx1.l2.m1.1.1.cmml" xref="algx1.l2.m1.1.1">𝑎</ci><ci id="algx1.l2.m1.2.2.cmml" xref="algx1.l2.m1.2.2">𝑢</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l2.m1.3c">fused\_app\_user\leftarrow\text{LinearTransform}(Concat(a,u))</annotation><annotation encoding="application/x-llamapun" id="algx1.l2.m1.3d">italic_f italic_u italic_s italic_e italic_d _ italic_a italic_p italic_p _ italic_u italic_s italic_e italic_r ← LinearTransform ( italic_C italic_o italic_n italic_c italic_a italic_t ( italic_a , italic_u ) )</annotation></semantics></math> // Simple fusion of app and user vectors

</div>
<div class="ltx_listingline" id="algx1.l3">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algx1.l3.1.1.1" style="font-size:80%;">3:</span></span>  <math alttext="fused\_poi\leftarrow\text{Cross-ModalDataFusionModule}(fused\_app\_user,l)" class="ltx_Math" display="inline" id="algx1.l3.m1.2"><semantics id="algx1.l3.m1.2a"><mrow id="algx1.l3.m1.2.2" xref="algx1.l3.m1.2.2.cmml"><mrow id="algx1.l3.m1.2.2.3" xref="algx1.l3.m1.2.2.3.cmml"><mi id="algx1.l3.m1.2.2.3.2" xref="algx1.l3.m1.2.2.3.2.cmml">f</mi><mo id="algx1.l3.m1.2.2.3.1" xref="algx1.l3.m1.2.2.3.1.cmml">⁢</mo><mi id="algx1.l3.m1.2.2.3.3" xref="algx1.l3.m1.2.2.3.3.cmml">u</mi><mo id="algx1.l3.m1.2.2.3.1a" xref="algx1.l3.m1.2.2.3.1.cmml">⁢</mo><mi id="algx1.l3.m1.2.2.3.4" xref="algx1.l3.m1.2.2.3.4.cmml">s</mi><mo id="algx1.l3.m1.2.2.3.1b" xref="algx1.l3.m1.2.2.3.1.cmml">⁢</mo><mi id="algx1.l3.m1.2.2.3.5" xref="algx1.l3.m1.2.2.3.5.cmml">e</mi><mo id="algx1.l3.m1.2.2.3.1c" xref="algx1.l3.m1.2.2.3.1.cmml">⁢</mo><mi id="algx1.l3.m1.2.2.3.6" xref="algx1.l3.m1.2.2.3.6.cmml">d</mi><mo id="algx1.l3.m1.2.2.3.1d" xref="algx1.l3.m1.2.2.3.1.cmml">⁢</mo><mi id="algx1.l3.m1.2.2.3.7" mathvariant="normal" xref="algx1.l3.m1.2.2.3.7.cmml">_</mi><mo id="algx1.l3.m1.2.2.3.1e" xref="algx1.l3.m1.2.2.3.1.cmml">⁢</mo><mi id="algx1.l3.m1.2.2.3.8" xref="algx1.l3.m1.2.2.3.8.cmml">p</mi><mo id="algx1.l3.m1.2.2.3.1f" xref="algx1.l3.m1.2.2.3.1.cmml">⁢</mo><mi id="algx1.l3.m1.2.2.3.9" xref="algx1.l3.m1.2.2.3.9.cmml">o</mi><mo id="algx1.l3.m1.2.2.3.1g" xref="algx1.l3.m1.2.2.3.1.cmml">⁢</mo><mi id="algx1.l3.m1.2.2.3.10" xref="algx1.l3.m1.2.2.3.10.cmml">i</mi></mrow><mo id="algx1.l3.m1.2.2.2" stretchy="false" xref="algx1.l3.m1.2.2.2.cmml">←</mo><mrow id="algx1.l3.m1.2.2.1" xref="algx1.l3.m1.2.2.1.cmml"><mtext id="algx1.l3.m1.2.2.1.3" xref="algx1.l3.m1.2.2.1.3a.cmml">Cross-ModalDataFusionModule</mtext><mo id="algx1.l3.m1.2.2.1.2" xref="algx1.l3.m1.2.2.1.2.cmml">⁢</mo><mrow id="algx1.l3.m1.2.2.1.1.1" xref="algx1.l3.m1.2.2.1.1.2.cmml"><mo id="algx1.l3.m1.2.2.1.1.1.2" stretchy="false" xref="algx1.l3.m1.2.2.1.1.2.cmml">(</mo><mrow id="algx1.l3.m1.2.2.1.1.1.1" xref="algx1.l3.m1.2.2.1.1.1.1.cmml"><mi id="algx1.l3.m1.2.2.1.1.1.1.2" xref="algx1.l3.m1.2.2.1.1.1.1.2.cmml">f</mi><mo id="algx1.l3.m1.2.2.1.1.1.1.1" xref="algx1.l3.m1.2.2.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l3.m1.2.2.1.1.1.1.3" xref="algx1.l3.m1.2.2.1.1.1.1.3.cmml">u</mi><mo id="algx1.l3.m1.2.2.1.1.1.1.1a" xref="algx1.l3.m1.2.2.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l3.m1.2.2.1.1.1.1.4" xref="algx1.l3.m1.2.2.1.1.1.1.4.cmml">s</mi><mo id="algx1.l3.m1.2.2.1.1.1.1.1b" xref="algx1.l3.m1.2.2.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l3.m1.2.2.1.1.1.1.5" xref="algx1.l3.m1.2.2.1.1.1.1.5.cmml">e</mi><mo id="algx1.l3.m1.2.2.1.1.1.1.1c" xref="algx1.l3.m1.2.2.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l3.m1.2.2.1.1.1.1.6" xref="algx1.l3.m1.2.2.1.1.1.1.6.cmml">d</mi><mo id="algx1.l3.m1.2.2.1.1.1.1.1d" xref="algx1.l3.m1.2.2.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l3.m1.2.2.1.1.1.1.7" mathvariant="normal" xref="algx1.l3.m1.2.2.1.1.1.1.7.cmml">_</mi><mo id="algx1.l3.m1.2.2.1.1.1.1.1e" xref="algx1.l3.m1.2.2.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l3.m1.2.2.1.1.1.1.8" xref="algx1.l3.m1.2.2.1.1.1.1.8.cmml">a</mi><mo id="algx1.l3.m1.2.2.1.1.1.1.1f" xref="algx1.l3.m1.2.2.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l3.m1.2.2.1.1.1.1.9" xref="algx1.l3.m1.2.2.1.1.1.1.9.cmml">p</mi><mo id="algx1.l3.m1.2.2.1.1.1.1.1g" xref="algx1.l3.m1.2.2.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l3.m1.2.2.1.1.1.1.10" xref="algx1.l3.m1.2.2.1.1.1.1.10.cmml">p</mi><mo id="algx1.l3.m1.2.2.1.1.1.1.1h" xref="algx1.l3.m1.2.2.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l3.m1.2.2.1.1.1.1.11" mathvariant="normal" xref="algx1.l3.m1.2.2.1.1.1.1.11.cmml">_</mi><mo id="algx1.l3.m1.2.2.1.1.1.1.1i" xref="algx1.l3.m1.2.2.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l3.m1.2.2.1.1.1.1.12" xref="algx1.l3.m1.2.2.1.1.1.1.12.cmml">u</mi><mo id="algx1.l3.m1.2.2.1.1.1.1.1j" xref="algx1.l3.m1.2.2.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l3.m1.2.2.1.1.1.1.13" xref="algx1.l3.m1.2.2.1.1.1.1.13.cmml">s</mi><mo id="algx1.l3.m1.2.2.1.1.1.1.1k" xref="algx1.l3.m1.2.2.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l3.m1.2.2.1.1.1.1.14" xref="algx1.l3.m1.2.2.1.1.1.1.14.cmml">e</mi><mo id="algx1.l3.m1.2.2.1.1.1.1.1l" xref="algx1.l3.m1.2.2.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l3.m1.2.2.1.1.1.1.15" xref="algx1.l3.m1.2.2.1.1.1.1.15.cmml">r</mi></mrow><mo id="algx1.l3.m1.2.2.1.1.1.3" xref="algx1.l3.m1.2.2.1.1.2.cmml">,</mo><mi id="algx1.l3.m1.1.1" xref="algx1.l3.m1.1.1.cmml">l</mi><mo id="algx1.l3.m1.2.2.1.1.1.4" stretchy="false" xref="algx1.l3.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx1.l3.m1.2b"><apply id="algx1.l3.m1.2.2.cmml" xref="algx1.l3.m1.2.2"><ci id="algx1.l3.m1.2.2.2.cmml" xref="algx1.l3.m1.2.2.2">←</ci><apply id="algx1.l3.m1.2.2.3.cmml" xref="algx1.l3.m1.2.2.3"><times id="algx1.l3.m1.2.2.3.1.cmml" xref="algx1.l3.m1.2.2.3.1"></times><ci id="algx1.l3.m1.2.2.3.2.cmml" xref="algx1.l3.m1.2.2.3.2">𝑓</ci><ci id="algx1.l3.m1.2.2.3.3.cmml" xref="algx1.l3.m1.2.2.3.3">𝑢</ci><ci id="algx1.l3.m1.2.2.3.4.cmml" xref="algx1.l3.m1.2.2.3.4">𝑠</ci><ci id="algx1.l3.m1.2.2.3.5.cmml" xref="algx1.l3.m1.2.2.3.5">𝑒</ci><ci id="algx1.l3.m1.2.2.3.6.cmml" xref="algx1.l3.m1.2.2.3.6">𝑑</ci><ci id="algx1.l3.m1.2.2.3.7.cmml" xref="algx1.l3.m1.2.2.3.7">_</ci><ci id="algx1.l3.m1.2.2.3.8.cmml" xref="algx1.l3.m1.2.2.3.8">𝑝</ci><ci id="algx1.l3.m1.2.2.3.9.cmml" xref="algx1.l3.m1.2.2.3.9">𝑜</ci><ci id="algx1.l3.m1.2.2.3.10.cmml" xref="algx1.l3.m1.2.2.3.10">𝑖</ci></apply><apply id="algx1.l3.m1.2.2.1.cmml" xref="algx1.l3.m1.2.2.1"><times id="algx1.l3.m1.2.2.1.2.cmml" xref="algx1.l3.m1.2.2.1.2"></times><ci id="algx1.l3.m1.2.2.1.3a.cmml" xref="algx1.l3.m1.2.2.1.3"><mtext id="algx1.l3.m1.2.2.1.3.cmml" xref="algx1.l3.m1.2.2.1.3">Cross-ModalDataFusionModule</mtext></ci><interval closure="open" id="algx1.l3.m1.2.2.1.1.2.cmml" xref="algx1.l3.m1.2.2.1.1.1"><apply id="algx1.l3.m1.2.2.1.1.1.1.cmml" xref="algx1.l3.m1.2.2.1.1.1.1"><times id="algx1.l3.m1.2.2.1.1.1.1.1.cmml" xref="algx1.l3.m1.2.2.1.1.1.1.1"></times><ci id="algx1.l3.m1.2.2.1.1.1.1.2.cmml" xref="algx1.l3.m1.2.2.1.1.1.1.2">𝑓</ci><ci id="algx1.l3.m1.2.2.1.1.1.1.3.cmml" xref="algx1.l3.m1.2.2.1.1.1.1.3">𝑢</ci><ci id="algx1.l3.m1.2.2.1.1.1.1.4.cmml" xref="algx1.l3.m1.2.2.1.1.1.1.4">𝑠</ci><ci id="algx1.l3.m1.2.2.1.1.1.1.5.cmml" xref="algx1.l3.m1.2.2.1.1.1.1.5">𝑒</ci><ci id="algx1.l3.m1.2.2.1.1.1.1.6.cmml" xref="algx1.l3.m1.2.2.1.1.1.1.6">𝑑</ci><ci id="algx1.l3.m1.2.2.1.1.1.1.7.cmml" xref="algx1.l3.m1.2.2.1.1.1.1.7">_</ci><ci id="algx1.l3.m1.2.2.1.1.1.1.8.cmml" xref="algx1.l3.m1.2.2.1.1.1.1.8">𝑎</ci><ci id="algx1.l3.m1.2.2.1.1.1.1.9.cmml" xref="algx1.l3.m1.2.2.1.1.1.1.9">𝑝</ci><ci id="algx1.l3.m1.2.2.1.1.1.1.10.cmml" xref="algx1.l3.m1.2.2.1.1.1.1.10">𝑝</ci><ci id="algx1.l3.m1.2.2.1.1.1.1.11.cmml" xref="algx1.l3.m1.2.2.1.1.1.1.11">_</ci><ci id="algx1.l3.m1.2.2.1.1.1.1.12.cmml" xref="algx1.l3.m1.2.2.1.1.1.1.12">𝑢</ci><ci id="algx1.l3.m1.2.2.1.1.1.1.13.cmml" xref="algx1.l3.m1.2.2.1.1.1.1.13">𝑠</ci><ci id="algx1.l3.m1.2.2.1.1.1.1.14.cmml" xref="algx1.l3.m1.2.2.1.1.1.1.14">𝑒</ci><ci id="algx1.l3.m1.2.2.1.1.1.1.15.cmml" xref="algx1.l3.m1.2.2.1.1.1.1.15">𝑟</ci></apply><ci id="algx1.l3.m1.1.1.cmml" xref="algx1.l3.m1.1.1">𝑙</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l3.m1.2c">fused\_poi\leftarrow\text{Cross-ModalDataFusionModule}(fused\_app\_user,l)</annotation><annotation encoding="application/x-llamapun" id="algx1.l3.m1.2d">italic_f italic_u italic_s italic_e italic_d _ italic_p italic_o italic_i ← Cross-ModalDataFusionModule ( italic_f italic_u italic_s italic_e italic_d _ italic_a italic_p italic_p _ italic_u italic_s italic_e italic_r , italic_l )</annotation></semantics></math> // Cross-modal data fusion with POI vector

</div>
<div class="ltx_listingline" id="algx1.l4">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algx1.l4.1.1.1" style="font-size:80%;">4:</span></span>  <math alttext="fused\_time\leftarrow\text{Cross-ModalDataFusionModule}(fused\_poi,t)" class="ltx_Math" display="inline" id="algx1.l4.m1.2"><semantics id="algx1.l4.m1.2a"><mrow id="algx1.l4.m1.2.2" xref="algx1.l4.m1.2.2.cmml"><mrow id="algx1.l4.m1.2.2.3" xref="algx1.l4.m1.2.2.3.cmml"><mi id="algx1.l4.m1.2.2.3.2" xref="algx1.l4.m1.2.2.3.2.cmml">f</mi><mo id="algx1.l4.m1.2.2.3.1" xref="algx1.l4.m1.2.2.3.1.cmml">⁢</mo><mi id="algx1.l4.m1.2.2.3.3" xref="algx1.l4.m1.2.2.3.3.cmml">u</mi><mo id="algx1.l4.m1.2.2.3.1a" xref="algx1.l4.m1.2.2.3.1.cmml">⁢</mo><mi id="algx1.l4.m1.2.2.3.4" xref="algx1.l4.m1.2.2.3.4.cmml">s</mi><mo id="algx1.l4.m1.2.2.3.1b" xref="algx1.l4.m1.2.2.3.1.cmml">⁢</mo><mi id="algx1.l4.m1.2.2.3.5" xref="algx1.l4.m1.2.2.3.5.cmml">e</mi><mo id="algx1.l4.m1.2.2.3.1c" xref="algx1.l4.m1.2.2.3.1.cmml">⁢</mo><mi id="algx1.l4.m1.2.2.3.6" xref="algx1.l4.m1.2.2.3.6.cmml">d</mi><mo id="algx1.l4.m1.2.2.3.1d" xref="algx1.l4.m1.2.2.3.1.cmml">⁢</mo><mi id="algx1.l4.m1.2.2.3.7" mathvariant="normal" xref="algx1.l4.m1.2.2.3.7.cmml">_</mi><mo id="algx1.l4.m1.2.2.3.1e" xref="algx1.l4.m1.2.2.3.1.cmml">⁢</mo><mi id="algx1.l4.m1.2.2.3.8" xref="algx1.l4.m1.2.2.3.8.cmml">t</mi><mo id="algx1.l4.m1.2.2.3.1f" xref="algx1.l4.m1.2.2.3.1.cmml">⁢</mo><mi id="algx1.l4.m1.2.2.3.9" xref="algx1.l4.m1.2.2.3.9.cmml">i</mi><mo id="algx1.l4.m1.2.2.3.1g" xref="algx1.l4.m1.2.2.3.1.cmml">⁢</mo><mi id="algx1.l4.m1.2.2.3.10" xref="algx1.l4.m1.2.2.3.10.cmml">m</mi><mo id="algx1.l4.m1.2.2.3.1h" xref="algx1.l4.m1.2.2.3.1.cmml">⁢</mo><mi id="algx1.l4.m1.2.2.3.11" xref="algx1.l4.m1.2.2.3.11.cmml">e</mi></mrow><mo id="algx1.l4.m1.2.2.2" stretchy="false" xref="algx1.l4.m1.2.2.2.cmml">←</mo><mrow id="algx1.l4.m1.2.2.1" xref="algx1.l4.m1.2.2.1.cmml"><mtext id="algx1.l4.m1.2.2.1.3" xref="algx1.l4.m1.2.2.1.3a.cmml">Cross-ModalDataFusionModule</mtext><mo id="algx1.l4.m1.2.2.1.2" xref="algx1.l4.m1.2.2.1.2.cmml">⁢</mo><mrow id="algx1.l4.m1.2.2.1.1.1" xref="algx1.l4.m1.2.2.1.1.2.cmml"><mo id="algx1.l4.m1.2.2.1.1.1.2" stretchy="false" xref="algx1.l4.m1.2.2.1.1.2.cmml">(</mo><mrow id="algx1.l4.m1.2.2.1.1.1.1" xref="algx1.l4.m1.2.2.1.1.1.1.cmml"><mi id="algx1.l4.m1.2.2.1.1.1.1.2" xref="algx1.l4.m1.2.2.1.1.1.1.2.cmml">f</mi><mo id="algx1.l4.m1.2.2.1.1.1.1.1" xref="algx1.l4.m1.2.2.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l4.m1.2.2.1.1.1.1.3" xref="algx1.l4.m1.2.2.1.1.1.1.3.cmml">u</mi><mo id="algx1.l4.m1.2.2.1.1.1.1.1a" xref="algx1.l4.m1.2.2.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l4.m1.2.2.1.1.1.1.4" xref="algx1.l4.m1.2.2.1.1.1.1.4.cmml">s</mi><mo id="algx1.l4.m1.2.2.1.1.1.1.1b" xref="algx1.l4.m1.2.2.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l4.m1.2.2.1.1.1.1.5" xref="algx1.l4.m1.2.2.1.1.1.1.5.cmml">e</mi><mo id="algx1.l4.m1.2.2.1.1.1.1.1c" xref="algx1.l4.m1.2.2.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l4.m1.2.2.1.1.1.1.6" xref="algx1.l4.m1.2.2.1.1.1.1.6.cmml">d</mi><mo id="algx1.l4.m1.2.2.1.1.1.1.1d" xref="algx1.l4.m1.2.2.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l4.m1.2.2.1.1.1.1.7" mathvariant="normal" xref="algx1.l4.m1.2.2.1.1.1.1.7.cmml">_</mi><mo id="algx1.l4.m1.2.2.1.1.1.1.1e" xref="algx1.l4.m1.2.2.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l4.m1.2.2.1.1.1.1.8" xref="algx1.l4.m1.2.2.1.1.1.1.8.cmml">p</mi><mo id="algx1.l4.m1.2.2.1.1.1.1.1f" xref="algx1.l4.m1.2.2.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l4.m1.2.2.1.1.1.1.9" xref="algx1.l4.m1.2.2.1.1.1.1.9.cmml">o</mi><mo id="algx1.l4.m1.2.2.1.1.1.1.1g" xref="algx1.l4.m1.2.2.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l4.m1.2.2.1.1.1.1.10" xref="algx1.l4.m1.2.2.1.1.1.1.10.cmml">i</mi></mrow><mo id="algx1.l4.m1.2.2.1.1.1.3" xref="algx1.l4.m1.2.2.1.1.2.cmml">,</mo><mi id="algx1.l4.m1.1.1" xref="algx1.l4.m1.1.1.cmml">t</mi><mo id="algx1.l4.m1.2.2.1.1.1.4" stretchy="false" xref="algx1.l4.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx1.l4.m1.2b"><apply id="algx1.l4.m1.2.2.cmml" xref="algx1.l4.m1.2.2"><ci id="algx1.l4.m1.2.2.2.cmml" xref="algx1.l4.m1.2.2.2">←</ci><apply id="algx1.l4.m1.2.2.3.cmml" xref="algx1.l4.m1.2.2.3"><times id="algx1.l4.m1.2.2.3.1.cmml" xref="algx1.l4.m1.2.2.3.1"></times><ci id="algx1.l4.m1.2.2.3.2.cmml" xref="algx1.l4.m1.2.2.3.2">𝑓</ci><ci id="algx1.l4.m1.2.2.3.3.cmml" xref="algx1.l4.m1.2.2.3.3">𝑢</ci><ci id="algx1.l4.m1.2.2.3.4.cmml" xref="algx1.l4.m1.2.2.3.4">𝑠</ci><ci id="algx1.l4.m1.2.2.3.5.cmml" xref="algx1.l4.m1.2.2.3.5">𝑒</ci><ci id="algx1.l4.m1.2.2.3.6.cmml" xref="algx1.l4.m1.2.2.3.6">𝑑</ci><ci id="algx1.l4.m1.2.2.3.7.cmml" xref="algx1.l4.m1.2.2.3.7">_</ci><ci id="algx1.l4.m1.2.2.3.8.cmml" xref="algx1.l4.m1.2.2.3.8">𝑡</ci><ci id="algx1.l4.m1.2.2.3.9.cmml" xref="algx1.l4.m1.2.2.3.9">𝑖</ci><ci id="algx1.l4.m1.2.2.3.10.cmml" xref="algx1.l4.m1.2.2.3.10">𝑚</ci><ci id="algx1.l4.m1.2.2.3.11.cmml" xref="algx1.l4.m1.2.2.3.11">𝑒</ci></apply><apply id="algx1.l4.m1.2.2.1.cmml" xref="algx1.l4.m1.2.2.1"><times id="algx1.l4.m1.2.2.1.2.cmml" xref="algx1.l4.m1.2.2.1.2"></times><ci id="algx1.l4.m1.2.2.1.3a.cmml" xref="algx1.l4.m1.2.2.1.3"><mtext id="algx1.l4.m1.2.2.1.3.cmml" xref="algx1.l4.m1.2.2.1.3">Cross-ModalDataFusionModule</mtext></ci><interval closure="open" id="algx1.l4.m1.2.2.1.1.2.cmml" xref="algx1.l4.m1.2.2.1.1.1"><apply id="algx1.l4.m1.2.2.1.1.1.1.cmml" xref="algx1.l4.m1.2.2.1.1.1.1"><times id="algx1.l4.m1.2.2.1.1.1.1.1.cmml" xref="algx1.l4.m1.2.2.1.1.1.1.1"></times><ci id="algx1.l4.m1.2.2.1.1.1.1.2.cmml" xref="algx1.l4.m1.2.2.1.1.1.1.2">𝑓</ci><ci id="algx1.l4.m1.2.2.1.1.1.1.3.cmml" xref="algx1.l4.m1.2.2.1.1.1.1.3">𝑢</ci><ci id="algx1.l4.m1.2.2.1.1.1.1.4.cmml" xref="algx1.l4.m1.2.2.1.1.1.1.4">𝑠</ci><ci id="algx1.l4.m1.2.2.1.1.1.1.5.cmml" xref="algx1.l4.m1.2.2.1.1.1.1.5">𝑒</ci><ci id="algx1.l4.m1.2.2.1.1.1.1.6.cmml" xref="algx1.l4.m1.2.2.1.1.1.1.6">𝑑</ci><ci id="algx1.l4.m1.2.2.1.1.1.1.7.cmml" xref="algx1.l4.m1.2.2.1.1.1.1.7">_</ci><ci id="algx1.l4.m1.2.2.1.1.1.1.8.cmml" xref="algx1.l4.m1.2.2.1.1.1.1.8">𝑝</ci><ci id="algx1.l4.m1.2.2.1.1.1.1.9.cmml" xref="algx1.l4.m1.2.2.1.1.1.1.9">𝑜</ci><ci id="algx1.l4.m1.2.2.1.1.1.1.10.cmml" xref="algx1.l4.m1.2.2.1.1.1.1.10">𝑖</ci></apply><ci id="algx1.l4.m1.1.1.cmml" xref="algx1.l4.m1.1.1">𝑡</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l4.m1.2c">fused\_time\leftarrow\text{Cross-ModalDataFusionModule}(fused\_poi,t)</annotation><annotation encoding="application/x-llamapun" id="algx1.l4.m1.2d">italic_f italic_u italic_s italic_e italic_d _ italic_t italic_i italic_m italic_e ← Cross-ModalDataFusionModule ( italic_f italic_u italic_s italic_e italic_d _ italic_p italic_o italic_i , italic_t )</annotation></semantics></math> // Cross-modal data fusion with time vector

</div>
<div class="ltx_listingline" id="algx1.l5">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algx1.l5.1.1.1" style="font-size:80%;">5:</span></span>  <math alttext="\textbf{encoder\_input}\leftarrow\text{AddPositionalEncoding}(\text{%
LinearTransform}(fused\_time))" class="ltx_Math" display="inline" id="algx1.l5.m1.1"><semantics id="algx1.l5.m1.1a"><mrow id="algx1.l5.m1.1.1" xref="algx1.l5.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="algx1.l5.m1.1.1.3" xref="algx1.l5.m1.1.1.3a.cmml">encoder_input</mtext><mo id="algx1.l5.m1.1.1.2" stretchy="false" xref="algx1.l5.m1.1.1.2.cmml">←</mo><mrow id="algx1.l5.m1.1.1.1" xref="algx1.l5.m1.1.1.1.cmml"><mtext id="algx1.l5.m1.1.1.1.3" xref="algx1.l5.m1.1.1.1.3a.cmml">AddPositionalEncoding</mtext><mo id="algx1.l5.m1.1.1.1.2" xref="algx1.l5.m1.1.1.1.2.cmml">⁢</mo><mrow id="algx1.l5.m1.1.1.1.1.1" xref="algx1.l5.m1.1.1.1.1.1.1.cmml"><mo id="algx1.l5.m1.1.1.1.1.1.2" stretchy="false" xref="algx1.l5.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="algx1.l5.m1.1.1.1.1.1.1" xref="algx1.l5.m1.1.1.1.1.1.1.cmml"><mtext id="algx1.l5.m1.1.1.1.1.1.1.3" xref="algx1.l5.m1.1.1.1.1.1.1.3a.cmml">LinearTransform</mtext><mo id="algx1.l5.m1.1.1.1.1.1.1.2" xref="algx1.l5.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="algx1.l5.m1.1.1.1.1.1.1.1.1" xref="algx1.l5.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="algx1.l5.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="algx1.l5.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="algx1.l5.m1.1.1.1.1.1.1.1.1.1" xref="algx1.l5.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="algx1.l5.m1.1.1.1.1.1.1.1.1.1.2" xref="algx1.l5.m1.1.1.1.1.1.1.1.1.1.2.cmml">f</mi><mo id="algx1.l5.m1.1.1.1.1.1.1.1.1.1.1" xref="algx1.l5.m1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l5.m1.1.1.1.1.1.1.1.1.1.3" xref="algx1.l5.m1.1.1.1.1.1.1.1.1.1.3.cmml">u</mi><mo id="algx1.l5.m1.1.1.1.1.1.1.1.1.1.1a" xref="algx1.l5.m1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l5.m1.1.1.1.1.1.1.1.1.1.4" xref="algx1.l5.m1.1.1.1.1.1.1.1.1.1.4.cmml">s</mi><mo id="algx1.l5.m1.1.1.1.1.1.1.1.1.1.1b" xref="algx1.l5.m1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l5.m1.1.1.1.1.1.1.1.1.1.5" xref="algx1.l5.m1.1.1.1.1.1.1.1.1.1.5.cmml">e</mi><mo id="algx1.l5.m1.1.1.1.1.1.1.1.1.1.1c" xref="algx1.l5.m1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l5.m1.1.1.1.1.1.1.1.1.1.6" xref="algx1.l5.m1.1.1.1.1.1.1.1.1.1.6.cmml">d</mi><mo id="algx1.l5.m1.1.1.1.1.1.1.1.1.1.1d" xref="algx1.l5.m1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l5.m1.1.1.1.1.1.1.1.1.1.7" mathvariant="normal" xref="algx1.l5.m1.1.1.1.1.1.1.1.1.1.7.cmml">_</mi><mo id="algx1.l5.m1.1.1.1.1.1.1.1.1.1.1e" xref="algx1.l5.m1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l5.m1.1.1.1.1.1.1.1.1.1.8" xref="algx1.l5.m1.1.1.1.1.1.1.1.1.1.8.cmml">t</mi><mo id="algx1.l5.m1.1.1.1.1.1.1.1.1.1.1f" xref="algx1.l5.m1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l5.m1.1.1.1.1.1.1.1.1.1.9" xref="algx1.l5.m1.1.1.1.1.1.1.1.1.1.9.cmml">i</mi><mo id="algx1.l5.m1.1.1.1.1.1.1.1.1.1.1g" xref="algx1.l5.m1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l5.m1.1.1.1.1.1.1.1.1.1.10" xref="algx1.l5.m1.1.1.1.1.1.1.1.1.1.10.cmml">m</mi><mo id="algx1.l5.m1.1.1.1.1.1.1.1.1.1.1h" xref="algx1.l5.m1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l5.m1.1.1.1.1.1.1.1.1.1.11" xref="algx1.l5.m1.1.1.1.1.1.1.1.1.1.11.cmml">e</mi></mrow><mo id="algx1.l5.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="algx1.l5.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="algx1.l5.m1.1.1.1.1.1.3" stretchy="false" xref="algx1.l5.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx1.l5.m1.1b"><apply id="algx1.l5.m1.1.1.cmml" xref="algx1.l5.m1.1.1"><ci id="algx1.l5.m1.1.1.2.cmml" xref="algx1.l5.m1.1.1.2">←</ci><ci id="algx1.l5.m1.1.1.3a.cmml" xref="algx1.l5.m1.1.1.3"><mtext class="ltx_mathvariant_bold" id="algx1.l5.m1.1.1.3.cmml" xref="algx1.l5.m1.1.1.3">encoder_input</mtext></ci><apply id="algx1.l5.m1.1.1.1.cmml" xref="algx1.l5.m1.1.1.1"><times id="algx1.l5.m1.1.1.1.2.cmml" xref="algx1.l5.m1.1.1.1.2"></times><ci id="algx1.l5.m1.1.1.1.3a.cmml" xref="algx1.l5.m1.1.1.1.3"><mtext id="algx1.l5.m1.1.1.1.3.cmml" xref="algx1.l5.m1.1.1.1.3">AddPositionalEncoding</mtext></ci><apply id="algx1.l5.m1.1.1.1.1.1.1.cmml" xref="algx1.l5.m1.1.1.1.1.1"><times id="algx1.l5.m1.1.1.1.1.1.1.2.cmml" xref="algx1.l5.m1.1.1.1.1.1.1.2"></times><ci id="algx1.l5.m1.1.1.1.1.1.1.3a.cmml" xref="algx1.l5.m1.1.1.1.1.1.1.3"><mtext id="algx1.l5.m1.1.1.1.1.1.1.3.cmml" xref="algx1.l5.m1.1.1.1.1.1.1.3">LinearTransform</mtext></ci><apply id="algx1.l5.m1.1.1.1.1.1.1.1.1.1.cmml" xref="algx1.l5.m1.1.1.1.1.1.1.1.1"><times id="algx1.l5.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="algx1.l5.m1.1.1.1.1.1.1.1.1.1.1"></times><ci id="algx1.l5.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="algx1.l5.m1.1.1.1.1.1.1.1.1.1.2">𝑓</ci><ci id="algx1.l5.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="algx1.l5.m1.1.1.1.1.1.1.1.1.1.3">𝑢</ci><ci id="algx1.l5.m1.1.1.1.1.1.1.1.1.1.4.cmml" xref="algx1.l5.m1.1.1.1.1.1.1.1.1.1.4">𝑠</ci><ci id="algx1.l5.m1.1.1.1.1.1.1.1.1.1.5.cmml" xref="algx1.l5.m1.1.1.1.1.1.1.1.1.1.5">𝑒</ci><ci id="algx1.l5.m1.1.1.1.1.1.1.1.1.1.6.cmml" xref="algx1.l5.m1.1.1.1.1.1.1.1.1.1.6">𝑑</ci><ci id="algx1.l5.m1.1.1.1.1.1.1.1.1.1.7.cmml" xref="algx1.l5.m1.1.1.1.1.1.1.1.1.1.7">_</ci><ci id="algx1.l5.m1.1.1.1.1.1.1.1.1.1.8.cmml" xref="algx1.l5.m1.1.1.1.1.1.1.1.1.1.8">𝑡</ci><ci id="algx1.l5.m1.1.1.1.1.1.1.1.1.1.9.cmml" xref="algx1.l5.m1.1.1.1.1.1.1.1.1.1.9">𝑖</ci><ci id="algx1.l5.m1.1.1.1.1.1.1.1.1.1.10.cmml" xref="algx1.l5.m1.1.1.1.1.1.1.1.1.1.10">𝑚</ci><ci id="algx1.l5.m1.1.1.1.1.1.1.1.1.1.11.cmml" xref="algx1.l5.m1.1.1.1.1.1.1.1.1.1.11">𝑒</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l5.m1.1c">\textbf{encoder\_input}\leftarrow\text{AddPositionalEncoding}(\text{%
LinearTransform}(fused\_time))</annotation><annotation encoding="application/x-llamapun" id="algx1.l5.m1.1d">encoder_input ← AddPositionalEncoding ( LinearTransform ( italic_f italic_u italic_s italic_e italic_d _ italic_t italic_i italic_m italic_e ) )</annotation></semantics></math> // Final preparation for Encoder input

</div>
<div class="ltx_listingline" id="algx1.l6">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algx1.l6.1.1.1" style="font-size:80%;">6:</span></span>  <math alttext="fused\_poi\_decoder\leftarrow\text{Cross-ModalDataFusionModule}(a,l)" class="ltx_Math" display="inline" id="algx1.l6.m1.2"><semantics id="algx1.l6.m1.2a"><mrow id="algx1.l6.m1.2.3" xref="algx1.l6.m1.2.3.cmml"><mrow id="algx1.l6.m1.2.3.2" xref="algx1.l6.m1.2.3.2.cmml"><mi id="algx1.l6.m1.2.3.2.2" xref="algx1.l6.m1.2.3.2.2.cmml">f</mi><mo id="algx1.l6.m1.2.3.2.1" xref="algx1.l6.m1.2.3.2.1.cmml">⁢</mo><mi id="algx1.l6.m1.2.3.2.3" xref="algx1.l6.m1.2.3.2.3.cmml">u</mi><mo id="algx1.l6.m1.2.3.2.1a" xref="algx1.l6.m1.2.3.2.1.cmml">⁢</mo><mi id="algx1.l6.m1.2.3.2.4" xref="algx1.l6.m1.2.3.2.4.cmml">s</mi><mo id="algx1.l6.m1.2.3.2.1b" xref="algx1.l6.m1.2.3.2.1.cmml">⁢</mo><mi id="algx1.l6.m1.2.3.2.5" xref="algx1.l6.m1.2.3.2.5.cmml">e</mi><mo id="algx1.l6.m1.2.3.2.1c" xref="algx1.l6.m1.2.3.2.1.cmml">⁢</mo><mi id="algx1.l6.m1.2.3.2.6" xref="algx1.l6.m1.2.3.2.6.cmml">d</mi><mo id="algx1.l6.m1.2.3.2.1d" xref="algx1.l6.m1.2.3.2.1.cmml">⁢</mo><mi id="algx1.l6.m1.2.3.2.7" mathvariant="normal" xref="algx1.l6.m1.2.3.2.7.cmml">_</mi><mo id="algx1.l6.m1.2.3.2.1e" xref="algx1.l6.m1.2.3.2.1.cmml">⁢</mo><mi id="algx1.l6.m1.2.3.2.8" xref="algx1.l6.m1.2.3.2.8.cmml">p</mi><mo id="algx1.l6.m1.2.3.2.1f" xref="algx1.l6.m1.2.3.2.1.cmml">⁢</mo><mi id="algx1.l6.m1.2.3.2.9" xref="algx1.l6.m1.2.3.2.9.cmml">o</mi><mo id="algx1.l6.m1.2.3.2.1g" xref="algx1.l6.m1.2.3.2.1.cmml">⁢</mo><mi id="algx1.l6.m1.2.3.2.10" xref="algx1.l6.m1.2.3.2.10.cmml">i</mi><mo id="algx1.l6.m1.2.3.2.1h" xref="algx1.l6.m1.2.3.2.1.cmml">⁢</mo><mi id="algx1.l6.m1.2.3.2.11" mathvariant="normal" xref="algx1.l6.m1.2.3.2.11.cmml">_</mi><mo id="algx1.l6.m1.2.3.2.1i" xref="algx1.l6.m1.2.3.2.1.cmml">⁢</mo><mi id="algx1.l6.m1.2.3.2.12" xref="algx1.l6.m1.2.3.2.12.cmml">d</mi><mo id="algx1.l6.m1.2.3.2.1j" xref="algx1.l6.m1.2.3.2.1.cmml">⁢</mo><mi id="algx1.l6.m1.2.3.2.13" xref="algx1.l6.m1.2.3.2.13.cmml">e</mi><mo id="algx1.l6.m1.2.3.2.1k" xref="algx1.l6.m1.2.3.2.1.cmml">⁢</mo><mi id="algx1.l6.m1.2.3.2.14" xref="algx1.l6.m1.2.3.2.14.cmml">c</mi><mo id="algx1.l6.m1.2.3.2.1l" xref="algx1.l6.m1.2.3.2.1.cmml">⁢</mo><mi id="algx1.l6.m1.2.3.2.15" xref="algx1.l6.m1.2.3.2.15.cmml">o</mi><mo id="algx1.l6.m1.2.3.2.1m" xref="algx1.l6.m1.2.3.2.1.cmml">⁢</mo><mi id="algx1.l6.m1.2.3.2.16" xref="algx1.l6.m1.2.3.2.16.cmml">d</mi><mo id="algx1.l6.m1.2.3.2.1n" xref="algx1.l6.m1.2.3.2.1.cmml">⁢</mo><mi id="algx1.l6.m1.2.3.2.17" xref="algx1.l6.m1.2.3.2.17.cmml">e</mi><mo id="algx1.l6.m1.2.3.2.1o" xref="algx1.l6.m1.2.3.2.1.cmml">⁢</mo><mi id="algx1.l6.m1.2.3.2.18" xref="algx1.l6.m1.2.3.2.18.cmml">r</mi></mrow><mo id="algx1.l6.m1.2.3.1" stretchy="false" xref="algx1.l6.m1.2.3.1.cmml">←</mo><mrow id="algx1.l6.m1.2.3.3" xref="algx1.l6.m1.2.3.3.cmml"><mtext id="algx1.l6.m1.2.3.3.2" xref="algx1.l6.m1.2.3.3.2a.cmml">Cross-ModalDataFusionModule</mtext><mo id="algx1.l6.m1.2.3.3.1" xref="algx1.l6.m1.2.3.3.1.cmml">⁢</mo><mrow id="algx1.l6.m1.2.3.3.3.2" xref="algx1.l6.m1.2.3.3.3.1.cmml"><mo id="algx1.l6.m1.2.3.3.3.2.1" stretchy="false" xref="algx1.l6.m1.2.3.3.3.1.cmml">(</mo><mi id="algx1.l6.m1.1.1" xref="algx1.l6.m1.1.1.cmml">a</mi><mo id="algx1.l6.m1.2.3.3.3.2.2" xref="algx1.l6.m1.2.3.3.3.1.cmml">,</mo><mi id="algx1.l6.m1.2.2" xref="algx1.l6.m1.2.2.cmml">l</mi><mo id="algx1.l6.m1.2.3.3.3.2.3" stretchy="false" xref="algx1.l6.m1.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx1.l6.m1.2b"><apply id="algx1.l6.m1.2.3.cmml" xref="algx1.l6.m1.2.3"><ci id="algx1.l6.m1.2.3.1.cmml" xref="algx1.l6.m1.2.3.1">←</ci><apply id="algx1.l6.m1.2.3.2.cmml" xref="algx1.l6.m1.2.3.2"><times id="algx1.l6.m1.2.3.2.1.cmml" xref="algx1.l6.m1.2.3.2.1"></times><ci id="algx1.l6.m1.2.3.2.2.cmml" xref="algx1.l6.m1.2.3.2.2">𝑓</ci><ci id="algx1.l6.m1.2.3.2.3.cmml" xref="algx1.l6.m1.2.3.2.3">𝑢</ci><ci id="algx1.l6.m1.2.3.2.4.cmml" xref="algx1.l6.m1.2.3.2.4">𝑠</ci><ci id="algx1.l6.m1.2.3.2.5.cmml" xref="algx1.l6.m1.2.3.2.5">𝑒</ci><ci id="algx1.l6.m1.2.3.2.6.cmml" xref="algx1.l6.m1.2.3.2.6">𝑑</ci><ci id="algx1.l6.m1.2.3.2.7.cmml" xref="algx1.l6.m1.2.3.2.7">_</ci><ci id="algx1.l6.m1.2.3.2.8.cmml" xref="algx1.l6.m1.2.3.2.8">𝑝</ci><ci id="algx1.l6.m1.2.3.2.9.cmml" xref="algx1.l6.m1.2.3.2.9">𝑜</ci><ci id="algx1.l6.m1.2.3.2.10.cmml" xref="algx1.l6.m1.2.3.2.10">𝑖</ci><ci id="algx1.l6.m1.2.3.2.11.cmml" xref="algx1.l6.m1.2.3.2.11">_</ci><ci id="algx1.l6.m1.2.3.2.12.cmml" xref="algx1.l6.m1.2.3.2.12">𝑑</ci><ci id="algx1.l6.m1.2.3.2.13.cmml" xref="algx1.l6.m1.2.3.2.13">𝑒</ci><ci id="algx1.l6.m1.2.3.2.14.cmml" xref="algx1.l6.m1.2.3.2.14">𝑐</ci><ci id="algx1.l6.m1.2.3.2.15.cmml" xref="algx1.l6.m1.2.3.2.15">𝑜</ci><ci id="algx1.l6.m1.2.3.2.16.cmml" xref="algx1.l6.m1.2.3.2.16">𝑑</ci><ci id="algx1.l6.m1.2.3.2.17.cmml" xref="algx1.l6.m1.2.3.2.17">𝑒</ci><ci id="algx1.l6.m1.2.3.2.18.cmml" xref="algx1.l6.m1.2.3.2.18">𝑟</ci></apply><apply id="algx1.l6.m1.2.3.3.cmml" xref="algx1.l6.m1.2.3.3"><times id="algx1.l6.m1.2.3.3.1.cmml" xref="algx1.l6.m1.2.3.3.1"></times><ci id="algx1.l6.m1.2.3.3.2a.cmml" xref="algx1.l6.m1.2.3.3.2"><mtext id="algx1.l6.m1.2.3.3.2.cmml" xref="algx1.l6.m1.2.3.3.2">Cross-ModalDataFusionModule</mtext></ci><interval closure="open" id="algx1.l6.m1.2.3.3.3.1.cmml" xref="algx1.l6.m1.2.3.3.3.2"><ci id="algx1.l6.m1.1.1.cmml" xref="algx1.l6.m1.1.1">𝑎</ci><ci id="algx1.l6.m1.2.2.cmml" xref="algx1.l6.m1.2.2">𝑙</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l6.m1.2c">fused\_poi\_decoder\leftarrow\text{Cross-ModalDataFusionModule}(a,l)</annotation><annotation encoding="application/x-llamapun" id="algx1.l6.m1.2d">italic_f italic_u italic_s italic_e italic_d _ italic_p italic_o italic_i _ italic_d italic_e italic_c italic_o italic_d italic_e italic_r ← Cross-ModalDataFusionModule ( italic_a , italic_l )</annotation></semantics></math> // Preparing Decoder input with app vector and POI vector

</div>
<div class="ltx_listingline" id="algx1.l7">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algx1.l7.1.1.1" style="font-size:80%;">7:</span></span>  <math alttext="decoder\_input\_prep\leftarrow\text{Concatenate}(fused\_poi\_decoder,\text{%
ZeroVector}())" class="ltx_Math" display="inline" id="algx1.l7.m1.2"><semantics id="algx1.l7.m1.2a"><mrow id="algx1.l7.m1.2.2" xref="algx1.l7.m1.2.2.cmml"><mrow id="algx1.l7.m1.2.2.4" xref="algx1.l7.m1.2.2.4.cmml"><mi id="algx1.l7.m1.2.2.4.2" xref="algx1.l7.m1.2.2.4.2.cmml">d</mi><mo id="algx1.l7.m1.2.2.4.1" xref="algx1.l7.m1.2.2.4.1.cmml">⁢</mo><mi id="algx1.l7.m1.2.2.4.3" xref="algx1.l7.m1.2.2.4.3.cmml">e</mi><mo id="algx1.l7.m1.2.2.4.1a" xref="algx1.l7.m1.2.2.4.1.cmml">⁢</mo><mi id="algx1.l7.m1.2.2.4.4" xref="algx1.l7.m1.2.2.4.4.cmml">c</mi><mo id="algx1.l7.m1.2.2.4.1b" xref="algx1.l7.m1.2.2.4.1.cmml">⁢</mo><mi id="algx1.l7.m1.2.2.4.5" xref="algx1.l7.m1.2.2.4.5.cmml">o</mi><mo id="algx1.l7.m1.2.2.4.1c" xref="algx1.l7.m1.2.2.4.1.cmml">⁢</mo><mi id="algx1.l7.m1.2.2.4.6" xref="algx1.l7.m1.2.2.4.6.cmml">d</mi><mo id="algx1.l7.m1.2.2.4.1d" xref="algx1.l7.m1.2.2.4.1.cmml">⁢</mo><mi id="algx1.l7.m1.2.2.4.7" xref="algx1.l7.m1.2.2.4.7.cmml">e</mi><mo id="algx1.l7.m1.2.2.4.1e" xref="algx1.l7.m1.2.2.4.1.cmml">⁢</mo><mi id="algx1.l7.m1.2.2.4.8" xref="algx1.l7.m1.2.2.4.8.cmml">r</mi><mo id="algx1.l7.m1.2.2.4.1f" xref="algx1.l7.m1.2.2.4.1.cmml">⁢</mo><mi id="algx1.l7.m1.2.2.4.9" mathvariant="normal" xref="algx1.l7.m1.2.2.4.9.cmml">_</mi><mo id="algx1.l7.m1.2.2.4.1g" xref="algx1.l7.m1.2.2.4.1.cmml">⁢</mo><mi id="algx1.l7.m1.2.2.4.10" xref="algx1.l7.m1.2.2.4.10.cmml">i</mi><mo id="algx1.l7.m1.2.2.4.1h" xref="algx1.l7.m1.2.2.4.1.cmml">⁢</mo><mi id="algx1.l7.m1.2.2.4.11" xref="algx1.l7.m1.2.2.4.11.cmml">n</mi><mo id="algx1.l7.m1.2.2.4.1i" xref="algx1.l7.m1.2.2.4.1.cmml">⁢</mo><mi id="algx1.l7.m1.2.2.4.12" xref="algx1.l7.m1.2.2.4.12.cmml">p</mi><mo id="algx1.l7.m1.2.2.4.1j" xref="algx1.l7.m1.2.2.4.1.cmml">⁢</mo><mi id="algx1.l7.m1.2.2.4.13" xref="algx1.l7.m1.2.2.4.13.cmml">u</mi><mo id="algx1.l7.m1.2.2.4.1k" xref="algx1.l7.m1.2.2.4.1.cmml">⁢</mo><mi id="algx1.l7.m1.2.2.4.14" xref="algx1.l7.m1.2.2.4.14.cmml">t</mi><mo id="algx1.l7.m1.2.2.4.1l" xref="algx1.l7.m1.2.2.4.1.cmml">⁢</mo><mi id="algx1.l7.m1.2.2.4.15" mathvariant="normal" xref="algx1.l7.m1.2.2.4.15.cmml">_</mi><mo id="algx1.l7.m1.2.2.4.1m" xref="algx1.l7.m1.2.2.4.1.cmml">⁢</mo><mi id="algx1.l7.m1.2.2.4.16" xref="algx1.l7.m1.2.2.4.16.cmml">p</mi><mo id="algx1.l7.m1.2.2.4.1n" xref="algx1.l7.m1.2.2.4.1.cmml">⁢</mo><mi id="algx1.l7.m1.2.2.4.17" xref="algx1.l7.m1.2.2.4.17.cmml">r</mi><mo id="algx1.l7.m1.2.2.4.1o" xref="algx1.l7.m1.2.2.4.1.cmml">⁢</mo><mi id="algx1.l7.m1.2.2.4.18" xref="algx1.l7.m1.2.2.4.18.cmml">e</mi><mo id="algx1.l7.m1.2.2.4.1p" xref="algx1.l7.m1.2.2.4.1.cmml">⁢</mo><mi id="algx1.l7.m1.2.2.4.19" xref="algx1.l7.m1.2.2.4.19.cmml">p</mi></mrow><mo id="algx1.l7.m1.2.2.3" stretchy="false" xref="algx1.l7.m1.2.2.3.cmml">←</mo><mrow id="algx1.l7.m1.2.2.2" xref="algx1.l7.m1.2.2.2.cmml"><mtext id="algx1.l7.m1.2.2.2.4" xref="algx1.l7.m1.2.2.2.4a.cmml">Concatenate</mtext><mo id="algx1.l7.m1.2.2.2.3" xref="algx1.l7.m1.2.2.2.3.cmml">⁢</mo><mrow id="algx1.l7.m1.2.2.2.2.2" xref="algx1.l7.m1.2.2.2.2.3.cmml"><mo id="algx1.l7.m1.2.2.2.2.2.3" stretchy="false" xref="algx1.l7.m1.2.2.2.2.3.cmml">(</mo><mrow id="algx1.l7.m1.1.1.1.1.1.1" xref="algx1.l7.m1.1.1.1.1.1.1.cmml"><mi id="algx1.l7.m1.1.1.1.1.1.1.2" xref="algx1.l7.m1.1.1.1.1.1.1.2.cmml">f</mi><mo id="algx1.l7.m1.1.1.1.1.1.1.1" xref="algx1.l7.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l7.m1.1.1.1.1.1.1.3" xref="algx1.l7.m1.1.1.1.1.1.1.3.cmml">u</mi><mo id="algx1.l7.m1.1.1.1.1.1.1.1a" xref="algx1.l7.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l7.m1.1.1.1.1.1.1.4" xref="algx1.l7.m1.1.1.1.1.1.1.4.cmml">s</mi><mo id="algx1.l7.m1.1.1.1.1.1.1.1b" xref="algx1.l7.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l7.m1.1.1.1.1.1.1.5" xref="algx1.l7.m1.1.1.1.1.1.1.5.cmml">e</mi><mo id="algx1.l7.m1.1.1.1.1.1.1.1c" xref="algx1.l7.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l7.m1.1.1.1.1.1.1.6" xref="algx1.l7.m1.1.1.1.1.1.1.6.cmml">d</mi><mo id="algx1.l7.m1.1.1.1.1.1.1.1d" xref="algx1.l7.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l7.m1.1.1.1.1.1.1.7" mathvariant="normal" xref="algx1.l7.m1.1.1.1.1.1.1.7.cmml">_</mi><mo id="algx1.l7.m1.1.1.1.1.1.1.1e" xref="algx1.l7.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l7.m1.1.1.1.1.1.1.8" xref="algx1.l7.m1.1.1.1.1.1.1.8.cmml">p</mi><mo id="algx1.l7.m1.1.1.1.1.1.1.1f" xref="algx1.l7.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l7.m1.1.1.1.1.1.1.9" xref="algx1.l7.m1.1.1.1.1.1.1.9.cmml">o</mi><mo id="algx1.l7.m1.1.1.1.1.1.1.1g" xref="algx1.l7.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l7.m1.1.1.1.1.1.1.10" xref="algx1.l7.m1.1.1.1.1.1.1.10.cmml">i</mi><mo id="algx1.l7.m1.1.1.1.1.1.1.1h" xref="algx1.l7.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l7.m1.1.1.1.1.1.1.11" mathvariant="normal" xref="algx1.l7.m1.1.1.1.1.1.1.11.cmml">_</mi><mo id="algx1.l7.m1.1.1.1.1.1.1.1i" xref="algx1.l7.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l7.m1.1.1.1.1.1.1.12" xref="algx1.l7.m1.1.1.1.1.1.1.12.cmml">d</mi><mo id="algx1.l7.m1.1.1.1.1.1.1.1j" xref="algx1.l7.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l7.m1.1.1.1.1.1.1.13" xref="algx1.l7.m1.1.1.1.1.1.1.13.cmml">e</mi><mo id="algx1.l7.m1.1.1.1.1.1.1.1k" xref="algx1.l7.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l7.m1.1.1.1.1.1.1.14" xref="algx1.l7.m1.1.1.1.1.1.1.14.cmml">c</mi><mo id="algx1.l7.m1.1.1.1.1.1.1.1l" xref="algx1.l7.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l7.m1.1.1.1.1.1.1.15" xref="algx1.l7.m1.1.1.1.1.1.1.15.cmml">o</mi><mo id="algx1.l7.m1.1.1.1.1.1.1.1m" xref="algx1.l7.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l7.m1.1.1.1.1.1.1.16" xref="algx1.l7.m1.1.1.1.1.1.1.16.cmml">d</mi><mo id="algx1.l7.m1.1.1.1.1.1.1.1n" xref="algx1.l7.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l7.m1.1.1.1.1.1.1.17" xref="algx1.l7.m1.1.1.1.1.1.1.17.cmml">e</mi><mo id="algx1.l7.m1.1.1.1.1.1.1.1o" xref="algx1.l7.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l7.m1.1.1.1.1.1.1.18" xref="algx1.l7.m1.1.1.1.1.1.1.18.cmml">r</mi></mrow><mo id="algx1.l7.m1.2.2.2.2.2.4" xref="algx1.l7.m1.2.2.2.2.3.cmml">,</mo><mrow id="algx1.l7.m1.2.2.2.2.2.2" xref="algx1.l7.m1.2.2.2.2.2.2.cmml"><mtext id="algx1.l7.m1.2.2.2.2.2.2.2" xref="algx1.l7.m1.2.2.2.2.2.2.2a.cmml">ZeroVector</mtext><mo id="algx1.l7.m1.2.2.2.2.2.2.1" xref="algx1.l7.m1.2.2.2.2.2.2.1.cmml">⁢</mo><mrow id="algx1.l7.m1.2.2.2.2.2.2.3.2" xref="algx1.l7.m1.2.2.2.2.2.2.cmml"><mo id="algx1.l7.m1.2.2.2.2.2.2.3.2.1" stretchy="false" xref="algx1.l7.m1.2.2.2.2.2.2.3.1.cmml">(</mo><mo id="algx1.l7.m1.2.2.2.2.2.2.3.2.2" stretchy="false" xref="algx1.l7.m1.2.2.2.2.2.2.3.1.cmml">)</mo></mrow></mrow><mo id="algx1.l7.m1.2.2.2.2.2.5" stretchy="false" xref="algx1.l7.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx1.l7.m1.2b"><apply id="algx1.l7.m1.2.2.cmml" xref="algx1.l7.m1.2.2"><ci id="algx1.l7.m1.2.2.3.cmml" xref="algx1.l7.m1.2.2.3">←</ci><apply id="algx1.l7.m1.2.2.4.cmml" xref="algx1.l7.m1.2.2.4"><times id="algx1.l7.m1.2.2.4.1.cmml" xref="algx1.l7.m1.2.2.4.1"></times><ci id="algx1.l7.m1.2.2.4.2.cmml" xref="algx1.l7.m1.2.2.4.2">𝑑</ci><ci id="algx1.l7.m1.2.2.4.3.cmml" xref="algx1.l7.m1.2.2.4.3">𝑒</ci><ci id="algx1.l7.m1.2.2.4.4.cmml" xref="algx1.l7.m1.2.2.4.4">𝑐</ci><ci id="algx1.l7.m1.2.2.4.5.cmml" xref="algx1.l7.m1.2.2.4.5">𝑜</ci><ci id="algx1.l7.m1.2.2.4.6.cmml" xref="algx1.l7.m1.2.2.4.6">𝑑</ci><ci id="algx1.l7.m1.2.2.4.7.cmml" xref="algx1.l7.m1.2.2.4.7">𝑒</ci><ci id="algx1.l7.m1.2.2.4.8.cmml" xref="algx1.l7.m1.2.2.4.8">𝑟</ci><ci id="algx1.l7.m1.2.2.4.9.cmml" xref="algx1.l7.m1.2.2.4.9">_</ci><ci id="algx1.l7.m1.2.2.4.10.cmml" xref="algx1.l7.m1.2.2.4.10">𝑖</ci><ci id="algx1.l7.m1.2.2.4.11.cmml" xref="algx1.l7.m1.2.2.4.11">𝑛</ci><ci id="algx1.l7.m1.2.2.4.12.cmml" xref="algx1.l7.m1.2.2.4.12">𝑝</ci><ci id="algx1.l7.m1.2.2.4.13.cmml" xref="algx1.l7.m1.2.2.4.13">𝑢</ci><ci id="algx1.l7.m1.2.2.4.14.cmml" xref="algx1.l7.m1.2.2.4.14">𝑡</ci><ci id="algx1.l7.m1.2.2.4.15.cmml" xref="algx1.l7.m1.2.2.4.15">_</ci><ci id="algx1.l7.m1.2.2.4.16.cmml" xref="algx1.l7.m1.2.2.4.16">𝑝</ci><ci id="algx1.l7.m1.2.2.4.17.cmml" xref="algx1.l7.m1.2.2.4.17">𝑟</ci><ci id="algx1.l7.m1.2.2.4.18.cmml" xref="algx1.l7.m1.2.2.4.18">𝑒</ci><ci id="algx1.l7.m1.2.2.4.19.cmml" xref="algx1.l7.m1.2.2.4.19">𝑝</ci></apply><apply id="algx1.l7.m1.2.2.2.cmml" xref="algx1.l7.m1.2.2.2"><times id="algx1.l7.m1.2.2.2.3.cmml" xref="algx1.l7.m1.2.2.2.3"></times><ci id="algx1.l7.m1.2.2.2.4a.cmml" xref="algx1.l7.m1.2.2.2.4"><mtext id="algx1.l7.m1.2.2.2.4.cmml" xref="algx1.l7.m1.2.2.2.4">Concatenate</mtext></ci><interval closure="open" id="algx1.l7.m1.2.2.2.2.3.cmml" xref="algx1.l7.m1.2.2.2.2.2"><apply id="algx1.l7.m1.1.1.1.1.1.1.cmml" xref="algx1.l7.m1.1.1.1.1.1.1"><times id="algx1.l7.m1.1.1.1.1.1.1.1.cmml" xref="algx1.l7.m1.1.1.1.1.1.1.1"></times><ci id="algx1.l7.m1.1.1.1.1.1.1.2.cmml" xref="algx1.l7.m1.1.1.1.1.1.1.2">𝑓</ci><ci id="algx1.l7.m1.1.1.1.1.1.1.3.cmml" xref="algx1.l7.m1.1.1.1.1.1.1.3">𝑢</ci><ci id="algx1.l7.m1.1.1.1.1.1.1.4.cmml" xref="algx1.l7.m1.1.1.1.1.1.1.4">𝑠</ci><ci id="algx1.l7.m1.1.1.1.1.1.1.5.cmml" xref="algx1.l7.m1.1.1.1.1.1.1.5">𝑒</ci><ci id="algx1.l7.m1.1.1.1.1.1.1.6.cmml" xref="algx1.l7.m1.1.1.1.1.1.1.6">𝑑</ci><ci id="algx1.l7.m1.1.1.1.1.1.1.7.cmml" xref="algx1.l7.m1.1.1.1.1.1.1.7">_</ci><ci id="algx1.l7.m1.1.1.1.1.1.1.8.cmml" xref="algx1.l7.m1.1.1.1.1.1.1.8">𝑝</ci><ci id="algx1.l7.m1.1.1.1.1.1.1.9.cmml" xref="algx1.l7.m1.1.1.1.1.1.1.9">𝑜</ci><ci id="algx1.l7.m1.1.1.1.1.1.1.10.cmml" xref="algx1.l7.m1.1.1.1.1.1.1.10">𝑖</ci><ci id="algx1.l7.m1.1.1.1.1.1.1.11.cmml" xref="algx1.l7.m1.1.1.1.1.1.1.11">_</ci><ci id="algx1.l7.m1.1.1.1.1.1.1.12.cmml" xref="algx1.l7.m1.1.1.1.1.1.1.12">𝑑</ci><ci id="algx1.l7.m1.1.1.1.1.1.1.13.cmml" xref="algx1.l7.m1.1.1.1.1.1.1.13">𝑒</ci><ci id="algx1.l7.m1.1.1.1.1.1.1.14.cmml" xref="algx1.l7.m1.1.1.1.1.1.1.14">𝑐</ci><ci id="algx1.l7.m1.1.1.1.1.1.1.15.cmml" xref="algx1.l7.m1.1.1.1.1.1.1.15">𝑜</ci><ci id="algx1.l7.m1.1.1.1.1.1.1.16.cmml" xref="algx1.l7.m1.1.1.1.1.1.1.16">𝑑</ci><ci id="algx1.l7.m1.1.1.1.1.1.1.17.cmml" xref="algx1.l7.m1.1.1.1.1.1.1.17">𝑒</ci><ci id="algx1.l7.m1.1.1.1.1.1.1.18.cmml" xref="algx1.l7.m1.1.1.1.1.1.1.18">𝑟</ci></apply><apply id="algx1.l7.m1.2.2.2.2.2.2.cmml" xref="algx1.l7.m1.2.2.2.2.2.2"><times id="algx1.l7.m1.2.2.2.2.2.2.1.cmml" xref="algx1.l7.m1.2.2.2.2.2.2.1"></times><ci id="algx1.l7.m1.2.2.2.2.2.2.2a.cmml" xref="algx1.l7.m1.2.2.2.2.2.2.2"><mtext id="algx1.l7.m1.2.2.2.2.2.2.2.cmml" xref="algx1.l7.m1.2.2.2.2.2.2.2">ZeroVector</mtext></ci><list id="algx1.l7.m1.2.2.2.2.2.2.3.1.cmml" xref="algx1.l7.m1.2.2.2.2.2.2.3.2.1"></list></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l7.m1.2c">decoder\_input\_prep\leftarrow\text{Concatenate}(fused\_poi\_decoder,\text{%
ZeroVector}())</annotation><annotation encoding="application/x-llamapun" id="algx1.l7.m1.2d">italic_d italic_e italic_c italic_o italic_d italic_e italic_r _ italic_i italic_n italic_p italic_u italic_t _ italic_p italic_r italic_e italic_p ← Concatenate ( italic_f italic_u italic_s italic_e italic_d _ italic_p italic_o italic_i _ italic_d italic_e italic_c italic_o italic_d italic_e italic_r , ZeroVector ( ) )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algx1.l8">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algx1.l8.1.1.1" style="font-size:80%;">8:</span></span>  <math alttext="\textbf{decoder\_input}\leftarrow\text{AddPositionalEncoding}(\text{%
LinearTransform}(decoder\_input\_prep))" class="ltx_Math" display="inline" id="algx1.l8.m1.1"><semantics id="algx1.l8.m1.1a"><mrow id="algx1.l8.m1.1.1" xref="algx1.l8.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="algx1.l8.m1.1.1.3" xref="algx1.l8.m1.1.1.3a.cmml">decoder_input</mtext><mo id="algx1.l8.m1.1.1.2" stretchy="false" xref="algx1.l8.m1.1.1.2.cmml">←</mo><mrow id="algx1.l8.m1.1.1.1" xref="algx1.l8.m1.1.1.1.cmml"><mtext id="algx1.l8.m1.1.1.1.3" xref="algx1.l8.m1.1.1.1.3a.cmml">AddPositionalEncoding</mtext><mo id="algx1.l8.m1.1.1.1.2" xref="algx1.l8.m1.1.1.1.2.cmml">⁢</mo><mrow id="algx1.l8.m1.1.1.1.1.1" xref="algx1.l8.m1.1.1.1.1.1.1.cmml"><mo id="algx1.l8.m1.1.1.1.1.1.2" stretchy="false" xref="algx1.l8.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="algx1.l8.m1.1.1.1.1.1.1" xref="algx1.l8.m1.1.1.1.1.1.1.cmml"><mtext id="algx1.l8.m1.1.1.1.1.1.1.3" xref="algx1.l8.m1.1.1.1.1.1.1.3a.cmml">LinearTransform</mtext><mo id="algx1.l8.m1.1.1.1.1.1.1.2" xref="algx1.l8.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="algx1.l8.m1.1.1.1.1.1.1.1.1" xref="algx1.l8.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="algx1.l8.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="algx1.l8.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="algx1.l8.m1.1.1.1.1.1.1.1.1.1" xref="algx1.l8.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="algx1.l8.m1.1.1.1.1.1.1.1.1.1.2" xref="algx1.l8.m1.1.1.1.1.1.1.1.1.1.2.cmml">d</mi><mo id="algx1.l8.m1.1.1.1.1.1.1.1.1.1.1" xref="algx1.l8.m1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l8.m1.1.1.1.1.1.1.1.1.1.3" xref="algx1.l8.m1.1.1.1.1.1.1.1.1.1.3.cmml">e</mi><mo id="algx1.l8.m1.1.1.1.1.1.1.1.1.1.1a" xref="algx1.l8.m1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l8.m1.1.1.1.1.1.1.1.1.1.4" xref="algx1.l8.m1.1.1.1.1.1.1.1.1.1.4.cmml">c</mi><mo id="algx1.l8.m1.1.1.1.1.1.1.1.1.1.1b" xref="algx1.l8.m1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l8.m1.1.1.1.1.1.1.1.1.1.5" xref="algx1.l8.m1.1.1.1.1.1.1.1.1.1.5.cmml">o</mi><mo id="algx1.l8.m1.1.1.1.1.1.1.1.1.1.1c" xref="algx1.l8.m1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l8.m1.1.1.1.1.1.1.1.1.1.6" xref="algx1.l8.m1.1.1.1.1.1.1.1.1.1.6.cmml">d</mi><mo id="algx1.l8.m1.1.1.1.1.1.1.1.1.1.1d" xref="algx1.l8.m1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l8.m1.1.1.1.1.1.1.1.1.1.7" xref="algx1.l8.m1.1.1.1.1.1.1.1.1.1.7.cmml">e</mi><mo id="algx1.l8.m1.1.1.1.1.1.1.1.1.1.1e" xref="algx1.l8.m1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l8.m1.1.1.1.1.1.1.1.1.1.8" xref="algx1.l8.m1.1.1.1.1.1.1.1.1.1.8.cmml">r</mi><mo id="algx1.l8.m1.1.1.1.1.1.1.1.1.1.1f" xref="algx1.l8.m1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l8.m1.1.1.1.1.1.1.1.1.1.9" mathvariant="normal" xref="algx1.l8.m1.1.1.1.1.1.1.1.1.1.9.cmml">_</mi><mo id="algx1.l8.m1.1.1.1.1.1.1.1.1.1.1g" xref="algx1.l8.m1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l8.m1.1.1.1.1.1.1.1.1.1.10" xref="algx1.l8.m1.1.1.1.1.1.1.1.1.1.10.cmml">i</mi><mo id="algx1.l8.m1.1.1.1.1.1.1.1.1.1.1h" xref="algx1.l8.m1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l8.m1.1.1.1.1.1.1.1.1.1.11" xref="algx1.l8.m1.1.1.1.1.1.1.1.1.1.11.cmml">n</mi><mo id="algx1.l8.m1.1.1.1.1.1.1.1.1.1.1i" xref="algx1.l8.m1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l8.m1.1.1.1.1.1.1.1.1.1.12" xref="algx1.l8.m1.1.1.1.1.1.1.1.1.1.12.cmml">p</mi><mo id="algx1.l8.m1.1.1.1.1.1.1.1.1.1.1j" xref="algx1.l8.m1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l8.m1.1.1.1.1.1.1.1.1.1.13" xref="algx1.l8.m1.1.1.1.1.1.1.1.1.1.13.cmml">u</mi><mo id="algx1.l8.m1.1.1.1.1.1.1.1.1.1.1k" xref="algx1.l8.m1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l8.m1.1.1.1.1.1.1.1.1.1.14" xref="algx1.l8.m1.1.1.1.1.1.1.1.1.1.14.cmml">t</mi><mo id="algx1.l8.m1.1.1.1.1.1.1.1.1.1.1l" xref="algx1.l8.m1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l8.m1.1.1.1.1.1.1.1.1.1.15" mathvariant="normal" xref="algx1.l8.m1.1.1.1.1.1.1.1.1.1.15.cmml">_</mi><mo id="algx1.l8.m1.1.1.1.1.1.1.1.1.1.1m" xref="algx1.l8.m1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l8.m1.1.1.1.1.1.1.1.1.1.16" xref="algx1.l8.m1.1.1.1.1.1.1.1.1.1.16.cmml">p</mi><mo id="algx1.l8.m1.1.1.1.1.1.1.1.1.1.1n" xref="algx1.l8.m1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l8.m1.1.1.1.1.1.1.1.1.1.17" xref="algx1.l8.m1.1.1.1.1.1.1.1.1.1.17.cmml">r</mi><mo id="algx1.l8.m1.1.1.1.1.1.1.1.1.1.1o" xref="algx1.l8.m1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l8.m1.1.1.1.1.1.1.1.1.1.18" xref="algx1.l8.m1.1.1.1.1.1.1.1.1.1.18.cmml">e</mi><mo id="algx1.l8.m1.1.1.1.1.1.1.1.1.1.1p" xref="algx1.l8.m1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l8.m1.1.1.1.1.1.1.1.1.1.19" xref="algx1.l8.m1.1.1.1.1.1.1.1.1.1.19.cmml">p</mi></mrow><mo id="algx1.l8.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="algx1.l8.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="algx1.l8.m1.1.1.1.1.1.3" stretchy="false" xref="algx1.l8.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx1.l8.m1.1b"><apply id="algx1.l8.m1.1.1.cmml" xref="algx1.l8.m1.1.1"><ci id="algx1.l8.m1.1.1.2.cmml" xref="algx1.l8.m1.1.1.2">←</ci><ci id="algx1.l8.m1.1.1.3a.cmml" xref="algx1.l8.m1.1.1.3"><mtext class="ltx_mathvariant_bold" id="algx1.l8.m1.1.1.3.cmml" xref="algx1.l8.m1.1.1.3">decoder_input</mtext></ci><apply id="algx1.l8.m1.1.1.1.cmml" xref="algx1.l8.m1.1.1.1"><times id="algx1.l8.m1.1.1.1.2.cmml" xref="algx1.l8.m1.1.1.1.2"></times><ci id="algx1.l8.m1.1.1.1.3a.cmml" xref="algx1.l8.m1.1.1.1.3"><mtext id="algx1.l8.m1.1.1.1.3.cmml" xref="algx1.l8.m1.1.1.1.3">AddPositionalEncoding</mtext></ci><apply id="algx1.l8.m1.1.1.1.1.1.1.cmml" xref="algx1.l8.m1.1.1.1.1.1"><times id="algx1.l8.m1.1.1.1.1.1.1.2.cmml" xref="algx1.l8.m1.1.1.1.1.1.1.2"></times><ci id="algx1.l8.m1.1.1.1.1.1.1.3a.cmml" xref="algx1.l8.m1.1.1.1.1.1.1.3"><mtext id="algx1.l8.m1.1.1.1.1.1.1.3.cmml" xref="algx1.l8.m1.1.1.1.1.1.1.3">LinearTransform</mtext></ci><apply id="algx1.l8.m1.1.1.1.1.1.1.1.1.1.cmml" xref="algx1.l8.m1.1.1.1.1.1.1.1.1"><times id="algx1.l8.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="algx1.l8.m1.1.1.1.1.1.1.1.1.1.1"></times><ci id="algx1.l8.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="algx1.l8.m1.1.1.1.1.1.1.1.1.1.2">𝑑</ci><ci id="algx1.l8.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="algx1.l8.m1.1.1.1.1.1.1.1.1.1.3">𝑒</ci><ci id="algx1.l8.m1.1.1.1.1.1.1.1.1.1.4.cmml" xref="algx1.l8.m1.1.1.1.1.1.1.1.1.1.4">𝑐</ci><ci id="algx1.l8.m1.1.1.1.1.1.1.1.1.1.5.cmml" xref="algx1.l8.m1.1.1.1.1.1.1.1.1.1.5">𝑜</ci><ci id="algx1.l8.m1.1.1.1.1.1.1.1.1.1.6.cmml" xref="algx1.l8.m1.1.1.1.1.1.1.1.1.1.6">𝑑</ci><ci id="algx1.l8.m1.1.1.1.1.1.1.1.1.1.7.cmml" xref="algx1.l8.m1.1.1.1.1.1.1.1.1.1.7">𝑒</ci><ci id="algx1.l8.m1.1.1.1.1.1.1.1.1.1.8.cmml" xref="algx1.l8.m1.1.1.1.1.1.1.1.1.1.8">𝑟</ci><ci id="algx1.l8.m1.1.1.1.1.1.1.1.1.1.9.cmml" xref="algx1.l8.m1.1.1.1.1.1.1.1.1.1.9">_</ci><ci id="algx1.l8.m1.1.1.1.1.1.1.1.1.1.10.cmml" xref="algx1.l8.m1.1.1.1.1.1.1.1.1.1.10">𝑖</ci><ci id="algx1.l8.m1.1.1.1.1.1.1.1.1.1.11.cmml" xref="algx1.l8.m1.1.1.1.1.1.1.1.1.1.11">𝑛</ci><ci id="algx1.l8.m1.1.1.1.1.1.1.1.1.1.12.cmml" xref="algx1.l8.m1.1.1.1.1.1.1.1.1.1.12">𝑝</ci><ci id="algx1.l8.m1.1.1.1.1.1.1.1.1.1.13.cmml" xref="algx1.l8.m1.1.1.1.1.1.1.1.1.1.13">𝑢</ci><ci id="algx1.l8.m1.1.1.1.1.1.1.1.1.1.14.cmml" xref="algx1.l8.m1.1.1.1.1.1.1.1.1.1.14">𝑡</ci><ci id="algx1.l8.m1.1.1.1.1.1.1.1.1.1.15.cmml" xref="algx1.l8.m1.1.1.1.1.1.1.1.1.1.15">_</ci><ci id="algx1.l8.m1.1.1.1.1.1.1.1.1.1.16.cmml" xref="algx1.l8.m1.1.1.1.1.1.1.1.1.1.16">𝑝</ci><ci id="algx1.l8.m1.1.1.1.1.1.1.1.1.1.17.cmml" xref="algx1.l8.m1.1.1.1.1.1.1.1.1.1.17">𝑟</ci><ci id="algx1.l8.m1.1.1.1.1.1.1.1.1.1.18.cmml" xref="algx1.l8.m1.1.1.1.1.1.1.1.1.1.18">𝑒</ci><ci id="algx1.l8.m1.1.1.1.1.1.1.1.1.1.19.cmml" xref="algx1.l8.m1.1.1.1.1.1.1.1.1.1.19">𝑝</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l8.m1.1c">\textbf{decoder\_input}\leftarrow\text{AddPositionalEncoding}(\text{%
LinearTransform}(decoder\_input\_prep))</annotation><annotation encoding="application/x-llamapun" id="algx1.l8.m1.1d">decoder_input ← AddPositionalEncoding ( LinearTransform ( italic_d italic_e italic_c italic_o italic_d italic_e italic_r _ italic_i italic_n italic_p italic_u italic_t _ italic_p italic_r italic_e italic_p ) )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algx1.l9">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algx1.l9.1.1.1" style="font-size:80%;">9:</span></span>  // Feature Extraction Module

</div>
<div class="ltx_listingline" id="algx1.l10">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algx1.l10.1.1.1" style="font-size:80%;">10:</span></span>  <math alttext="SelfAttentionOutput\leftarrow\text{MultiHeadSelfAttention}(\textbf{encoder\_%
input})" class="ltx_Math" display="inline" id="algx1.l10.m1.1"><semantics id="algx1.l10.m1.1a"><mrow id="algx1.l10.m1.1.2" xref="algx1.l10.m1.1.2.cmml"><mrow id="algx1.l10.m1.1.2.2" xref="algx1.l10.m1.1.2.2.cmml"><mi id="algx1.l10.m1.1.2.2.2" xref="algx1.l10.m1.1.2.2.2.cmml">S</mi><mo id="algx1.l10.m1.1.2.2.1" xref="algx1.l10.m1.1.2.2.1.cmml">⁢</mo><mi id="algx1.l10.m1.1.2.2.3" xref="algx1.l10.m1.1.2.2.3.cmml">e</mi><mo id="algx1.l10.m1.1.2.2.1a" xref="algx1.l10.m1.1.2.2.1.cmml">⁢</mo><mi id="algx1.l10.m1.1.2.2.4" xref="algx1.l10.m1.1.2.2.4.cmml">l</mi><mo id="algx1.l10.m1.1.2.2.1b" xref="algx1.l10.m1.1.2.2.1.cmml">⁢</mo><mi id="algx1.l10.m1.1.2.2.5" xref="algx1.l10.m1.1.2.2.5.cmml">f</mi><mo id="algx1.l10.m1.1.2.2.1c" xref="algx1.l10.m1.1.2.2.1.cmml">⁢</mo><mi id="algx1.l10.m1.1.2.2.6" xref="algx1.l10.m1.1.2.2.6.cmml">A</mi><mo id="algx1.l10.m1.1.2.2.1d" xref="algx1.l10.m1.1.2.2.1.cmml">⁢</mo><mi id="algx1.l10.m1.1.2.2.7" xref="algx1.l10.m1.1.2.2.7.cmml">t</mi><mo id="algx1.l10.m1.1.2.2.1e" xref="algx1.l10.m1.1.2.2.1.cmml">⁢</mo><mi id="algx1.l10.m1.1.2.2.8" xref="algx1.l10.m1.1.2.2.8.cmml">t</mi><mo id="algx1.l10.m1.1.2.2.1f" xref="algx1.l10.m1.1.2.2.1.cmml">⁢</mo><mi id="algx1.l10.m1.1.2.2.9" xref="algx1.l10.m1.1.2.2.9.cmml">e</mi><mo id="algx1.l10.m1.1.2.2.1g" xref="algx1.l10.m1.1.2.2.1.cmml">⁢</mo><mi id="algx1.l10.m1.1.2.2.10" xref="algx1.l10.m1.1.2.2.10.cmml">n</mi><mo id="algx1.l10.m1.1.2.2.1h" xref="algx1.l10.m1.1.2.2.1.cmml">⁢</mo><mi id="algx1.l10.m1.1.2.2.11" xref="algx1.l10.m1.1.2.2.11.cmml">t</mi><mo id="algx1.l10.m1.1.2.2.1i" xref="algx1.l10.m1.1.2.2.1.cmml">⁢</mo><mi id="algx1.l10.m1.1.2.2.12" xref="algx1.l10.m1.1.2.2.12.cmml">i</mi><mo id="algx1.l10.m1.1.2.2.1j" xref="algx1.l10.m1.1.2.2.1.cmml">⁢</mo><mi id="algx1.l10.m1.1.2.2.13" xref="algx1.l10.m1.1.2.2.13.cmml">o</mi><mo id="algx1.l10.m1.1.2.2.1k" xref="algx1.l10.m1.1.2.2.1.cmml">⁢</mo><mi id="algx1.l10.m1.1.2.2.14" xref="algx1.l10.m1.1.2.2.14.cmml">n</mi><mo id="algx1.l10.m1.1.2.2.1l" xref="algx1.l10.m1.1.2.2.1.cmml">⁢</mo><mi id="algx1.l10.m1.1.2.2.15" xref="algx1.l10.m1.1.2.2.15.cmml">O</mi><mo id="algx1.l10.m1.1.2.2.1m" xref="algx1.l10.m1.1.2.2.1.cmml">⁢</mo><mi id="algx1.l10.m1.1.2.2.16" xref="algx1.l10.m1.1.2.2.16.cmml">u</mi><mo id="algx1.l10.m1.1.2.2.1n" xref="algx1.l10.m1.1.2.2.1.cmml">⁢</mo><mi id="algx1.l10.m1.1.2.2.17" xref="algx1.l10.m1.1.2.2.17.cmml">t</mi><mo id="algx1.l10.m1.1.2.2.1o" xref="algx1.l10.m1.1.2.2.1.cmml">⁢</mo><mi id="algx1.l10.m1.1.2.2.18" xref="algx1.l10.m1.1.2.2.18.cmml">p</mi><mo id="algx1.l10.m1.1.2.2.1p" xref="algx1.l10.m1.1.2.2.1.cmml">⁢</mo><mi id="algx1.l10.m1.1.2.2.19" xref="algx1.l10.m1.1.2.2.19.cmml">u</mi><mo id="algx1.l10.m1.1.2.2.1q" xref="algx1.l10.m1.1.2.2.1.cmml">⁢</mo><mi id="algx1.l10.m1.1.2.2.20" xref="algx1.l10.m1.1.2.2.20.cmml">t</mi></mrow><mo id="algx1.l10.m1.1.2.1" stretchy="false" xref="algx1.l10.m1.1.2.1.cmml">←</mo><mrow id="algx1.l10.m1.1.2.3" xref="algx1.l10.m1.1.2.3.cmml"><mtext id="algx1.l10.m1.1.2.3.2" xref="algx1.l10.m1.1.2.3.2a.cmml">MultiHeadSelfAttention</mtext><mo id="algx1.l10.m1.1.2.3.1" xref="algx1.l10.m1.1.2.3.1.cmml">⁢</mo><mrow id="algx1.l10.m1.1.2.3.3.2" xref="algx1.l10.m1.1.1a.cmml"><mo id="algx1.l10.m1.1.2.3.3.2.1" stretchy="false" xref="algx1.l10.m1.1.1a.cmml">(</mo><mtext class="ltx_mathvariant_bold" id="algx1.l10.m1.1.1" xref="algx1.l10.m1.1.1.cmml">encoder_input</mtext><mo id="algx1.l10.m1.1.2.3.3.2.2" stretchy="false" xref="algx1.l10.m1.1.1a.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx1.l10.m1.1b"><apply id="algx1.l10.m1.1.2.cmml" xref="algx1.l10.m1.1.2"><ci id="algx1.l10.m1.1.2.1.cmml" xref="algx1.l10.m1.1.2.1">←</ci><apply id="algx1.l10.m1.1.2.2.cmml" xref="algx1.l10.m1.1.2.2"><times id="algx1.l10.m1.1.2.2.1.cmml" xref="algx1.l10.m1.1.2.2.1"></times><ci id="algx1.l10.m1.1.2.2.2.cmml" xref="algx1.l10.m1.1.2.2.2">𝑆</ci><ci id="algx1.l10.m1.1.2.2.3.cmml" xref="algx1.l10.m1.1.2.2.3">𝑒</ci><ci id="algx1.l10.m1.1.2.2.4.cmml" xref="algx1.l10.m1.1.2.2.4">𝑙</ci><ci id="algx1.l10.m1.1.2.2.5.cmml" xref="algx1.l10.m1.1.2.2.5">𝑓</ci><ci id="algx1.l10.m1.1.2.2.6.cmml" xref="algx1.l10.m1.1.2.2.6">𝐴</ci><ci id="algx1.l10.m1.1.2.2.7.cmml" xref="algx1.l10.m1.1.2.2.7">𝑡</ci><ci id="algx1.l10.m1.1.2.2.8.cmml" xref="algx1.l10.m1.1.2.2.8">𝑡</ci><ci id="algx1.l10.m1.1.2.2.9.cmml" xref="algx1.l10.m1.1.2.2.9">𝑒</ci><ci id="algx1.l10.m1.1.2.2.10.cmml" xref="algx1.l10.m1.1.2.2.10">𝑛</ci><ci id="algx1.l10.m1.1.2.2.11.cmml" xref="algx1.l10.m1.1.2.2.11">𝑡</ci><ci id="algx1.l10.m1.1.2.2.12.cmml" xref="algx1.l10.m1.1.2.2.12">𝑖</ci><ci id="algx1.l10.m1.1.2.2.13.cmml" xref="algx1.l10.m1.1.2.2.13">𝑜</ci><ci id="algx1.l10.m1.1.2.2.14.cmml" xref="algx1.l10.m1.1.2.2.14">𝑛</ci><ci id="algx1.l10.m1.1.2.2.15.cmml" xref="algx1.l10.m1.1.2.2.15">𝑂</ci><ci id="algx1.l10.m1.1.2.2.16.cmml" xref="algx1.l10.m1.1.2.2.16">𝑢</ci><ci id="algx1.l10.m1.1.2.2.17.cmml" xref="algx1.l10.m1.1.2.2.17">𝑡</ci><ci id="algx1.l10.m1.1.2.2.18.cmml" xref="algx1.l10.m1.1.2.2.18">𝑝</ci><ci id="algx1.l10.m1.1.2.2.19.cmml" xref="algx1.l10.m1.1.2.2.19">𝑢</ci><ci id="algx1.l10.m1.1.2.2.20.cmml" xref="algx1.l10.m1.1.2.2.20">𝑡</ci></apply><apply id="algx1.l10.m1.1.2.3.cmml" xref="algx1.l10.m1.1.2.3"><times id="algx1.l10.m1.1.2.3.1.cmml" xref="algx1.l10.m1.1.2.3.1"></times><ci id="algx1.l10.m1.1.2.3.2a.cmml" xref="algx1.l10.m1.1.2.3.2"><mtext id="algx1.l10.m1.1.2.3.2.cmml" xref="algx1.l10.m1.1.2.3.2">MultiHeadSelfAttention</mtext></ci><ci id="algx1.l10.m1.1.1a.cmml" xref="algx1.l10.m1.1.2.3.3.2"><mtext class="ltx_mathvariant_bold" id="algx1.l10.m1.1.1.cmml" xref="algx1.l10.m1.1.1">encoder_input</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l10.m1.1c">SelfAttentionOutput\leftarrow\text{MultiHeadSelfAttention}(\textbf{encoder\_%
input})</annotation><annotation encoding="application/x-llamapun" id="algx1.l10.m1.1d">italic_S italic_e italic_l italic_f italic_A italic_t italic_t italic_e italic_n italic_t italic_i italic_o italic_n italic_O italic_u italic_t italic_p italic_u italic_t ← MultiHeadSelfAttention ( encoder_input )</annotation></semantics></math> // Encoder Processing

</div>
<div class="ltx_listingline" id="algx1.l11">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algx1.l11.1.1.1" style="font-size:80%;">11:</span></span>  <math alttext="ResidualSelfAttention\leftarrow\text{LayerNorm}(SelfAttentionOutput+encoder\_input)" class="ltx_Math" display="inline" id="algx1.l11.m1.1"><semantics id="algx1.l11.m1.1a"><mrow id="algx1.l11.m1.1.1" xref="algx1.l11.m1.1.1.cmml"><mrow id="algx1.l11.m1.1.1.3" xref="algx1.l11.m1.1.1.3.cmml"><mi id="algx1.l11.m1.1.1.3.2" xref="algx1.l11.m1.1.1.3.2.cmml">R</mi><mo id="algx1.l11.m1.1.1.3.1" xref="algx1.l11.m1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l11.m1.1.1.3.3" xref="algx1.l11.m1.1.1.3.3.cmml">e</mi><mo id="algx1.l11.m1.1.1.3.1a" xref="algx1.l11.m1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l11.m1.1.1.3.4" xref="algx1.l11.m1.1.1.3.4.cmml">s</mi><mo id="algx1.l11.m1.1.1.3.1b" xref="algx1.l11.m1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l11.m1.1.1.3.5" xref="algx1.l11.m1.1.1.3.5.cmml">i</mi><mo id="algx1.l11.m1.1.1.3.1c" xref="algx1.l11.m1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l11.m1.1.1.3.6" xref="algx1.l11.m1.1.1.3.6.cmml">d</mi><mo id="algx1.l11.m1.1.1.3.1d" xref="algx1.l11.m1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l11.m1.1.1.3.7" xref="algx1.l11.m1.1.1.3.7.cmml">u</mi><mo id="algx1.l11.m1.1.1.3.1e" xref="algx1.l11.m1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l11.m1.1.1.3.8" xref="algx1.l11.m1.1.1.3.8.cmml">a</mi><mo id="algx1.l11.m1.1.1.3.1f" xref="algx1.l11.m1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l11.m1.1.1.3.9" xref="algx1.l11.m1.1.1.3.9.cmml">l</mi><mo id="algx1.l11.m1.1.1.3.1g" xref="algx1.l11.m1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l11.m1.1.1.3.10" xref="algx1.l11.m1.1.1.3.10.cmml">S</mi><mo id="algx1.l11.m1.1.1.3.1h" xref="algx1.l11.m1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l11.m1.1.1.3.11" xref="algx1.l11.m1.1.1.3.11.cmml">e</mi><mo id="algx1.l11.m1.1.1.3.1i" xref="algx1.l11.m1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l11.m1.1.1.3.12" xref="algx1.l11.m1.1.1.3.12.cmml">l</mi><mo id="algx1.l11.m1.1.1.3.1j" xref="algx1.l11.m1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l11.m1.1.1.3.13" xref="algx1.l11.m1.1.1.3.13.cmml">f</mi><mo id="algx1.l11.m1.1.1.3.1k" xref="algx1.l11.m1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l11.m1.1.1.3.14" xref="algx1.l11.m1.1.1.3.14.cmml">A</mi><mo id="algx1.l11.m1.1.1.3.1l" xref="algx1.l11.m1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l11.m1.1.1.3.15" xref="algx1.l11.m1.1.1.3.15.cmml">t</mi><mo id="algx1.l11.m1.1.1.3.1m" xref="algx1.l11.m1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l11.m1.1.1.3.16" xref="algx1.l11.m1.1.1.3.16.cmml">t</mi><mo id="algx1.l11.m1.1.1.3.1n" xref="algx1.l11.m1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l11.m1.1.1.3.17" xref="algx1.l11.m1.1.1.3.17.cmml">e</mi><mo id="algx1.l11.m1.1.1.3.1o" xref="algx1.l11.m1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l11.m1.1.1.3.18" xref="algx1.l11.m1.1.1.3.18.cmml">n</mi><mo id="algx1.l11.m1.1.1.3.1p" xref="algx1.l11.m1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l11.m1.1.1.3.19" xref="algx1.l11.m1.1.1.3.19.cmml">t</mi><mo id="algx1.l11.m1.1.1.3.1q" xref="algx1.l11.m1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l11.m1.1.1.3.20" xref="algx1.l11.m1.1.1.3.20.cmml">i</mi><mo id="algx1.l11.m1.1.1.3.1r" xref="algx1.l11.m1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l11.m1.1.1.3.21" xref="algx1.l11.m1.1.1.3.21.cmml">o</mi><mo id="algx1.l11.m1.1.1.3.1s" xref="algx1.l11.m1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l11.m1.1.1.3.22" xref="algx1.l11.m1.1.1.3.22.cmml">n</mi></mrow><mo id="algx1.l11.m1.1.1.2" stretchy="false" xref="algx1.l11.m1.1.1.2.cmml">←</mo><mrow id="algx1.l11.m1.1.1.1" xref="algx1.l11.m1.1.1.1.cmml"><mtext id="algx1.l11.m1.1.1.1.3" xref="algx1.l11.m1.1.1.1.3a.cmml">LayerNorm</mtext><mo id="algx1.l11.m1.1.1.1.2" xref="algx1.l11.m1.1.1.1.2.cmml">⁢</mo><mrow id="algx1.l11.m1.1.1.1.1.1" xref="algx1.l11.m1.1.1.1.1.1.1.cmml"><mo id="algx1.l11.m1.1.1.1.1.1.2" stretchy="false" xref="algx1.l11.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="algx1.l11.m1.1.1.1.1.1.1" xref="algx1.l11.m1.1.1.1.1.1.1.cmml"><mrow id="algx1.l11.m1.1.1.1.1.1.1.2" xref="algx1.l11.m1.1.1.1.1.1.1.2.cmml"><mi id="algx1.l11.m1.1.1.1.1.1.1.2.2" xref="algx1.l11.m1.1.1.1.1.1.1.2.2.cmml">S</mi><mo id="algx1.l11.m1.1.1.1.1.1.1.2.1" xref="algx1.l11.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx1.l11.m1.1.1.1.1.1.1.2.3" xref="algx1.l11.m1.1.1.1.1.1.1.2.3.cmml">e</mi><mo id="algx1.l11.m1.1.1.1.1.1.1.2.1a" xref="algx1.l11.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx1.l11.m1.1.1.1.1.1.1.2.4" xref="algx1.l11.m1.1.1.1.1.1.1.2.4.cmml">l</mi><mo id="algx1.l11.m1.1.1.1.1.1.1.2.1b" xref="algx1.l11.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx1.l11.m1.1.1.1.1.1.1.2.5" xref="algx1.l11.m1.1.1.1.1.1.1.2.5.cmml">f</mi><mo id="algx1.l11.m1.1.1.1.1.1.1.2.1c" xref="algx1.l11.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx1.l11.m1.1.1.1.1.1.1.2.6" xref="algx1.l11.m1.1.1.1.1.1.1.2.6.cmml">A</mi><mo id="algx1.l11.m1.1.1.1.1.1.1.2.1d" xref="algx1.l11.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx1.l11.m1.1.1.1.1.1.1.2.7" xref="algx1.l11.m1.1.1.1.1.1.1.2.7.cmml">t</mi><mo id="algx1.l11.m1.1.1.1.1.1.1.2.1e" xref="algx1.l11.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx1.l11.m1.1.1.1.1.1.1.2.8" xref="algx1.l11.m1.1.1.1.1.1.1.2.8.cmml">t</mi><mo id="algx1.l11.m1.1.1.1.1.1.1.2.1f" xref="algx1.l11.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx1.l11.m1.1.1.1.1.1.1.2.9" xref="algx1.l11.m1.1.1.1.1.1.1.2.9.cmml">e</mi><mo id="algx1.l11.m1.1.1.1.1.1.1.2.1g" xref="algx1.l11.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx1.l11.m1.1.1.1.1.1.1.2.10" xref="algx1.l11.m1.1.1.1.1.1.1.2.10.cmml">n</mi><mo id="algx1.l11.m1.1.1.1.1.1.1.2.1h" xref="algx1.l11.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx1.l11.m1.1.1.1.1.1.1.2.11" xref="algx1.l11.m1.1.1.1.1.1.1.2.11.cmml">t</mi><mo id="algx1.l11.m1.1.1.1.1.1.1.2.1i" xref="algx1.l11.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx1.l11.m1.1.1.1.1.1.1.2.12" xref="algx1.l11.m1.1.1.1.1.1.1.2.12.cmml">i</mi><mo id="algx1.l11.m1.1.1.1.1.1.1.2.1j" xref="algx1.l11.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx1.l11.m1.1.1.1.1.1.1.2.13" xref="algx1.l11.m1.1.1.1.1.1.1.2.13.cmml">o</mi><mo id="algx1.l11.m1.1.1.1.1.1.1.2.1k" xref="algx1.l11.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx1.l11.m1.1.1.1.1.1.1.2.14" xref="algx1.l11.m1.1.1.1.1.1.1.2.14.cmml">n</mi><mo id="algx1.l11.m1.1.1.1.1.1.1.2.1l" xref="algx1.l11.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx1.l11.m1.1.1.1.1.1.1.2.15" xref="algx1.l11.m1.1.1.1.1.1.1.2.15.cmml">O</mi><mo id="algx1.l11.m1.1.1.1.1.1.1.2.1m" xref="algx1.l11.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx1.l11.m1.1.1.1.1.1.1.2.16" xref="algx1.l11.m1.1.1.1.1.1.1.2.16.cmml">u</mi><mo id="algx1.l11.m1.1.1.1.1.1.1.2.1n" xref="algx1.l11.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx1.l11.m1.1.1.1.1.1.1.2.17" xref="algx1.l11.m1.1.1.1.1.1.1.2.17.cmml">t</mi><mo id="algx1.l11.m1.1.1.1.1.1.1.2.1o" xref="algx1.l11.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx1.l11.m1.1.1.1.1.1.1.2.18" xref="algx1.l11.m1.1.1.1.1.1.1.2.18.cmml">p</mi><mo id="algx1.l11.m1.1.1.1.1.1.1.2.1p" xref="algx1.l11.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx1.l11.m1.1.1.1.1.1.1.2.19" xref="algx1.l11.m1.1.1.1.1.1.1.2.19.cmml">u</mi><mo id="algx1.l11.m1.1.1.1.1.1.1.2.1q" xref="algx1.l11.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx1.l11.m1.1.1.1.1.1.1.2.20" xref="algx1.l11.m1.1.1.1.1.1.1.2.20.cmml">t</mi></mrow><mo id="algx1.l11.m1.1.1.1.1.1.1.1" xref="algx1.l11.m1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="algx1.l11.m1.1.1.1.1.1.1.3" xref="algx1.l11.m1.1.1.1.1.1.1.3.cmml"><mi id="algx1.l11.m1.1.1.1.1.1.1.3.2" xref="algx1.l11.m1.1.1.1.1.1.1.3.2.cmml">e</mi><mo id="algx1.l11.m1.1.1.1.1.1.1.3.1" xref="algx1.l11.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l11.m1.1.1.1.1.1.1.3.3" xref="algx1.l11.m1.1.1.1.1.1.1.3.3.cmml">n</mi><mo id="algx1.l11.m1.1.1.1.1.1.1.3.1a" xref="algx1.l11.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l11.m1.1.1.1.1.1.1.3.4" xref="algx1.l11.m1.1.1.1.1.1.1.3.4.cmml">c</mi><mo id="algx1.l11.m1.1.1.1.1.1.1.3.1b" xref="algx1.l11.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l11.m1.1.1.1.1.1.1.3.5" xref="algx1.l11.m1.1.1.1.1.1.1.3.5.cmml">o</mi><mo id="algx1.l11.m1.1.1.1.1.1.1.3.1c" xref="algx1.l11.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l11.m1.1.1.1.1.1.1.3.6" xref="algx1.l11.m1.1.1.1.1.1.1.3.6.cmml">d</mi><mo id="algx1.l11.m1.1.1.1.1.1.1.3.1d" xref="algx1.l11.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l11.m1.1.1.1.1.1.1.3.7" xref="algx1.l11.m1.1.1.1.1.1.1.3.7.cmml">e</mi><mo id="algx1.l11.m1.1.1.1.1.1.1.3.1e" xref="algx1.l11.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l11.m1.1.1.1.1.1.1.3.8" xref="algx1.l11.m1.1.1.1.1.1.1.3.8.cmml">r</mi><mo id="algx1.l11.m1.1.1.1.1.1.1.3.1f" xref="algx1.l11.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l11.m1.1.1.1.1.1.1.3.9" mathvariant="normal" xref="algx1.l11.m1.1.1.1.1.1.1.3.9.cmml">_</mi><mo id="algx1.l11.m1.1.1.1.1.1.1.3.1g" xref="algx1.l11.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l11.m1.1.1.1.1.1.1.3.10" xref="algx1.l11.m1.1.1.1.1.1.1.3.10.cmml">i</mi><mo id="algx1.l11.m1.1.1.1.1.1.1.3.1h" xref="algx1.l11.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l11.m1.1.1.1.1.1.1.3.11" xref="algx1.l11.m1.1.1.1.1.1.1.3.11.cmml">n</mi><mo id="algx1.l11.m1.1.1.1.1.1.1.3.1i" xref="algx1.l11.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l11.m1.1.1.1.1.1.1.3.12" xref="algx1.l11.m1.1.1.1.1.1.1.3.12.cmml">p</mi><mo id="algx1.l11.m1.1.1.1.1.1.1.3.1j" xref="algx1.l11.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l11.m1.1.1.1.1.1.1.3.13" xref="algx1.l11.m1.1.1.1.1.1.1.3.13.cmml">u</mi><mo id="algx1.l11.m1.1.1.1.1.1.1.3.1k" xref="algx1.l11.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l11.m1.1.1.1.1.1.1.3.14" xref="algx1.l11.m1.1.1.1.1.1.1.3.14.cmml">t</mi></mrow></mrow><mo id="algx1.l11.m1.1.1.1.1.1.3" stretchy="false" xref="algx1.l11.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx1.l11.m1.1b"><apply id="algx1.l11.m1.1.1.cmml" xref="algx1.l11.m1.1.1"><ci id="algx1.l11.m1.1.1.2.cmml" xref="algx1.l11.m1.1.1.2">←</ci><apply id="algx1.l11.m1.1.1.3.cmml" xref="algx1.l11.m1.1.1.3"><times id="algx1.l11.m1.1.1.3.1.cmml" xref="algx1.l11.m1.1.1.3.1"></times><ci id="algx1.l11.m1.1.1.3.2.cmml" xref="algx1.l11.m1.1.1.3.2">𝑅</ci><ci id="algx1.l11.m1.1.1.3.3.cmml" xref="algx1.l11.m1.1.1.3.3">𝑒</ci><ci id="algx1.l11.m1.1.1.3.4.cmml" xref="algx1.l11.m1.1.1.3.4">𝑠</ci><ci id="algx1.l11.m1.1.1.3.5.cmml" xref="algx1.l11.m1.1.1.3.5">𝑖</ci><ci id="algx1.l11.m1.1.1.3.6.cmml" xref="algx1.l11.m1.1.1.3.6">𝑑</ci><ci id="algx1.l11.m1.1.1.3.7.cmml" xref="algx1.l11.m1.1.1.3.7">𝑢</ci><ci id="algx1.l11.m1.1.1.3.8.cmml" xref="algx1.l11.m1.1.1.3.8">𝑎</ci><ci id="algx1.l11.m1.1.1.3.9.cmml" xref="algx1.l11.m1.1.1.3.9">𝑙</ci><ci id="algx1.l11.m1.1.1.3.10.cmml" xref="algx1.l11.m1.1.1.3.10">𝑆</ci><ci id="algx1.l11.m1.1.1.3.11.cmml" xref="algx1.l11.m1.1.1.3.11">𝑒</ci><ci id="algx1.l11.m1.1.1.3.12.cmml" xref="algx1.l11.m1.1.1.3.12">𝑙</ci><ci id="algx1.l11.m1.1.1.3.13.cmml" xref="algx1.l11.m1.1.1.3.13">𝑓</ci><ci id="algx1.l11.m1.1.1.3.14.cmml" xref="algx1.l11.m1.1.1.3.14">𝐴</ci><ci id="algx1.l11.m1.1.1.3.15.cmml" xref="algx1.l11.m1.1.1.3.15">𝑡</ci><ci id="algx1.l11.m1.1.1.3.16.cmml" xref="algx1.l11.m1.1.1.3.16">𝑡</ci><ci id="algx1.l11.m1.1.1.3.17.cmml" xref="algx1.l11.m1.1.1.3.17">𝑒</ci><ci id="algx1.l11.m1.1.1.3.18.cmml" xref="algx1.l11.m1.1.1.3.18">𝑛</ci><ci id="algx1.l11.m1.1.1.3.19.cmml" xref="algx1.l11.m1.1.1.3.19">𝑡</ci><ci id="algx1.l11.m1.1.1.3.20.cmml" xref="algx1.l11.m1.1.1.3.20">𝑖</ci><ci id="algx1.l11.m1.1.1.3.21.cmml" xref="algx1.l11.m1.1.1.3.21">𝑜</ci><ci id="algx1.l11.m1.1.1.3.22.cmml" xref="algx1.l11.m1.1.1.3.22">𝑛</ci></apply><apply id="algx1.l11.m1.1.1.1.cmml" xref="algx1.l11.m1.1.1.1"><times id="algx1.l11.m1.1.1.1.2.cmml" xref="algx1.l11.m1.1.1.1.2"></times><ci id="algx1.l11.m1.1.1.1.3a.cmml" xref="algx1.l11.m1.1.1.1.3"><mtext id="algx1.l11.m1.1.1.1.3.cmml" xref="algx1.l11.m1.1.1.1.3">LayerNorm</mtext></ci><apply id="algx1.l11.m1.1.1.1.1.1.1.cmml" xref="algx1.l11.m1.1.1.1.1.1"><plus id="algx1.l11.m1.1.1.1.1.1.1.1.cmml" xref="algx1.l11.m1.1.1.1.1.1.1.1"></plus><apply id="algx1.l11.m1.1.1.1.1.1.1.2.cmml" xref="algx1.l11.m1.1.1.1.1.1.1.2"><times id="algx1.l11.m1.1.1.1.1.1.1.2.1.cmml" xref="algx1.l11.m1.1.1.1.1.1.1.2.1"></times><ci id="algx1.l11.m1.1.1.1.1.1.1.2.2.cmml" xref="algx1.l11.m1.1.1.1.1.1.1.2.2">𝑆</ci><ci id="algx1.l11.m1.1.1.1.1.1.1.2.3.cmml" xref="algx1.l11.m1.1.1.1.1.1.1.2.3">𝑒</ci><ci id="algx1.l11.m1.1.1.1.1.1.1.2.4.cmml" xref="algx1.l11.m1.1.1.1.1.1.1.2.4">𝑙</ci><ci id="algx1.l11.m1.1.1.1.1.1.1.2.5.cmml" xref="algx1.l11.m1.1.1.1.1.1.1.2.5">𝑓</ci><ci id="algx1.l11.m1.1.1.1.1.1.1.2.6.cmml" xref="algx1.l11.m1.1.1.1.1.1.1.2.6">𝐴</ci><ci id="algx1.l11.m1.1.1.1.1.1.1.2.7.cmml" xref="algx1.l11.m1.1.1.1.1.1.1.2.7">𝑡</ci><ci id="algx1.l11.m1.1.1.1.1.1.1.2.8.cmml" xref="algx1.l11.m1.1.1.1.1.1.1.2.8">𝑡</ci><ci id="algx1.l11.m1.1.1.1.1.1.1.2.9.cmml" xref="algx1.l11.m1.1.1.1.1.1.1.2.9">𝑒</ci><ci id="algx1.l11.m1.1.1.1.1.1.1.2.10.cmml" xref="algx1.l11.m1.1.1.1.1.1.1.2.10">𝑛</ci><ci id="algx1.l11.m1.1.1.1.1.1.1.2.11.cmml" xref="algx1.l11.m1.1.1.1.1.1.1.2.11">𝑡</ci><ci id="algx1.l11.m1.1.1.1.1.1.1.2.12.cmml" xref="algx1.l11.m1.1.1.1.1.1.1.2.12">𝑖</ci><ci id="algx1.l11.m1.1.1.1.1.1.1.2.13.cmml" xref="algx1.l11.m1.1.1.1.1.1.1.2.13">𝑜</ci><ci id="algx1.l11.m1.1.1.1.1.1.1.2.14.cmml" xref="algx1.l11.m1.1.1.1.1.1.1.2.14">𝑛</ci><ci id="algx1.l11.m1.1.1.1.1.1.1.2.15.cmml" xref="algx1.l11.m1.1.1.1.1.1.1.2.15">𝑂</ci><ci id="algx1.l11.m1.1.1.1.1.1.1.2.16.cmml" xref="algx1.l11.m1.1.1.1.1.1.1.2.16">𝑢</ci><ci id="algx1.l11.m1.1.1.1.1.1.1.2.17.cmml" xref="algx1.l11.m1.1.1.1.1.1.1.2.17">𝑡</ci><ci id="algx1.l11.m1.1.1.1.1.1.1.2.18.cmml" xref="algx1.l11.m1.1.1.1.1.1.1.2.18">𝑝</ci><ci id="algx1.l11.m1.1.1.1.1.1.1.2.19.cmml" xref="algx1.l11.m1.1.1.1.1.1.1.2.19">𝑢</ci><ci id="algx1.l11.m1.1.1.1.1.1.1.2.20.cmml" xref="algx1.l11.m1.1.1.1.1.1.1.2.20">𝑡</ci></apply><apply id="algx1.l11.m1.1.1.1.1.1.1.3.cmml" xref="algx1.l11.m1.1.1.1.1.1.1.3"><times id="algx1.l11.m1.1.1.1.1.1.1.3.1.cmml" xref="algx1.l11.m1.1.1.1.1.1.1.3.1"></times><ci id="algx1.l11.m1.1.1.1.1.1.1.3.2.cmml" xref="algx1.l11.m1.1.1.1.1.1.1.3.2">𝑒</ci><ci id="algx1.l11.m1.1.1.1.1.1.1.3.3.cmml" xref="algx1.l11.m1.1.1.1.1.1.1.3.3">𝑛</ci><ci id="algx1.l11.m1.1.1.1.1.1.1.3.4.cmml" xref="algx1.l11.m1.1.1.1.1.1.1.3.4">𝑐</ci><ci id="algx1.l11.m1.1.1.1.1.1.1.3.5.cmml" xref="algx1.l11.m1.1.1.1.1.1.1.3.5">𝑜</ci><ci id="algx1.l11.m1.1.1.1.1.1.1.3.6.cmml" xref="algx1.l11.m1.1.1.1.1.1.1.3.6">𝑑</ci><ci id="algx1.l11.m1.1.1.1.1.1.1.3.7.cmml" xref="algx1.l11.m1.1.1.1.1.1.1.3.7">𝑒</ci><ci id="algx1.l11.m1.1.1.1.1.1.1.3.8.cmml" xref="algx1.l11.m1.1.1.1.1.1.1.3.8">𝑟</ci><ci id="algx1.l11.m1.1.1.1.1.1.1.3.9.cmml" xref="algx1.l11.m1.1.1.1.1.1.1.3.9">_</ci><ci id="algx1.l11.m1.1.1.1.1.1.1.3.10.cmml" xref="algx1.l11.m1.1.1.1.1.1.1.3.10">𝑖</ci><ci id="algx1.l11.m1.1.1.1.1.1.1.3.11.cmml" xref="algx1.l11.m1.1.1.1.1.1.1.3.11">𝑛</ci><ci id="algx1.l11.m1.1.1.1.1.1.1.3.12.cmml" xref="algx1.l11.m1.1.1.1.1.1.1.3.12">𝑝</ci><ci id="algx1.l11.m1.1.1.1.1.1.1.3.13.cmml" xref="algx1.l11.m1.1.1.1.1.1.1.3.13">𝑢</ci><ci id="algx1.l11.m1.1.1.1.1.1.1.3.14.cmml" xref="algx1.l11.m1.1.1.1.1.1.1.3.14">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l11.m1.1c">ResidualSelfAttention\leftarrow\text{LayerNorm}(SelfAttentionOutput+encoder\_input)</annotation><annotation encoding="application/x-llamapun" id="algx1.l11.m1.1d">italic_R italic_e italic_s italic_i italic_d italic_u italic_a italic_l italic_S italic_e italic_l italic_f italic_A italic_t italic_t italic_e italic_n italic_t italic_i italic_o italic_n ← LayerNorm ( italic_S italic_e italic_l italic_f italic_A italic_t italic_t italic_e italic_n italic_t italic_i italic_o italic_n italic_O italic_u italic_t italic_p italic_u italic_t + italic_e italic_n italic_c italic_o italic_d italic_e italic_r _ italic_i italic_n italic_p italic_u italic_t )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algx1.l12">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algx1.l12.1.1.1" style="font-size:80%;">12:</span></span>  <math alttext="EncoderFeedForwardOutput\leftarrow\text{FeedForward}(ResidualSelfAttention)" class="ltx_Math" display="inline" id="algx1.l12.m1.1"><semantics id="algx1.l12.m1.1a"><mrow id="algx1.l12.m1.1.1" xref="algx1.l12.m1.1.1.cmml"><mrow id="algx1.l12.m1.1.1.3" xref="algx1.l12.m1.1.1.3.cmml"><mi id="algx1.l12.m1.1.1.3.2" xref="algx1.l12.m1.1.1.3.2.cmml">E</mi><mo id="algx1.l12.m1.1.1.3.1" xref="algx1.l12.m1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l12.m1.1.1.3.3" xref="algx1.l12.m1.1.1.3.3.cmml">n</mi><mo id="algx1.l12.m1.1.1.3.1a" xref="algx1.l12.m1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l12.m1.1.1.3.4" xref="algx1.l12.m1.1.1.3.4.cmml">c</mi><mo id="algx1.l12.m1.1.1.3.1b" xref="algx1.l12.m1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l12.m1.1.1.3.5" xref="algx1.l12.m1.1.1.3.5.cmml">o</mi><mo id="algx1.l12.m1.1.1.3.1c" xref="algx1.l12.m1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l12.m1.1.1.3.6" xref="algx1.l12.m1.1.1.3.6.cmml">d</mi><mo id="algx1.l12.m1.1.1.3.1d" xref="algx1.l12.m1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l12.m1.1.1.3.7" xref="algx1.l12.m1.1.1.3.7.cmml">e</mi><mo id="algx1.l12.m1.1.1.3.1e" xref="algx1.l12.m1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l12.m1.1.1.3.8" xref="algx1.l12.m1.1.1.3.8.cmml">r</mi><mo id="algx1.l12.m1.1.1.3.1f" xref="algx1.l12.m1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l12.m1.1.1.3.9" xref="algx1.l12.m1.1.1.3.9.cmml">F</mi><mo id="algx1.l12.m1.1.1.3.1g" xref="algx1.l12.m1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l12.m1.1.1.3.10" xref="algx1.l12.m1.1.1.3.10.cmml">e</mi><mo id="algx1.l12.m1.1.1.3.1h" xref="algx1.l12.m1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l12.m1.1.1.3.11" xref="algx1.l12.m1.1.1.3.11.cmml">e</mi><mo id="algx1.l12.m1.1.1.3.1i" xref="algx1.l12.m1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l12.m1.1.1.3.12" xref="algx1.l12.m1.1.1.3.12.cmml">d</mi><mo id="algx1.l12.m1.1.1.3.1j" xref="algx1.l12.m1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l12.m1.1.1.3.13" xref="algx1.l12.m1.1.1.3.13.cmml">F</mi><mo id="algx1.l12.m1.1.1.3.1k" xref="algx1.l12.m1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l12.m1.1.1.3.14" xref="algx1.l12.m1.1.1.3.14.cmml">o</mi><mo id="algx1.l12.m1.1.1.3.1l" xref="algx1.l12.m1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l12.m1.1.1.3.15" xref="algx1.l12.m1.1.1.3.15.cmml">r</mi><mo id="algx1.l12.m1.1.1.3.1m" xref="algx1.l12.m1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l12.m1.1.1.3.16" xref="algx1.l12.m1.1.1.3.16.cmml">w</mi><mo id="algx1.l12.m1.1.1.3.1n" xref="algx1.l12.m1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l12.m1.1.1.3.17" xref="algx1.l12.m1.1.1.3.17.cmml">a</mi><mo id="algx1.l12.m1.1.1.3.1o" xref="algx1.l12.m1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l12.m1.1.1.3.18" xref="algx1.l12.m1.1.1.3.18.cmml">r</mi><mo id="algx1.l12.m1.1.1.3.1p" xref="algx1.l12.m1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l12.m1.1.1.3.19" xref="algx1.l12.m1.1.1.3.19.cmml">d</mi><mo id="algx1.l12.m1.1.1.3.1q" xref="algx1.l12.m1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l12.m1.1.1.3.20" xref="algx1.l12.m1.1.1.3.20.cmml">O</mi><mo id="algx1.l12.m1.1.1.3.1r" xref="algx1.l12.m1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l12.m1.1.1.3.21" xref="algx1.l12.m1.1.1.3.21.cmml">u</mi><mo id="algx1.l12.m1.1.1.3.1s" xref="algx1.l12.m1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l12.m1.1.1.3.22" xref="algx1.l12.m1.1.1.3.22.cmml">t</mi><mo id="algx1.l12.m1.1.1.3.1t" xref="algx1.l12.m1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l12.m1.1.1.3.23" xref="algx1.l12.m1.1.1.3.23.cmml">p</mi><mo id="algx1.l12.m1.1.1.3.1u" xref="algx1.l12.m1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l12.m1.1.1.3.24" xref="algx1.l12.m1.1.1.3.24.cmml">u</mi><mo id="algx1.l12.m1.1.1.3.1v" xref="algx1.l12.m1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l12.m1.1.1.3.25" xref="algx1.l12.m1.1.1.3.25.cmml">t</mi></mrow><mo id="algx1.l12.m1.1.1.2" stretchy="false" xref="algx1.l12.m1.1.1.2.cmml">←</mo><mrow id="algx1.l12.m1.1.1.1" xref="algx1.l12.m1.1.1.1.cmml"><mtext id="algx1.l12.m1.1.1.1.3" xref="algx1.l12.m1.1.1.1.3a.cmml">FeedForward</mtext><mo id="algx1.l12.m1.1.1.1.2" xref="algx1.l12.m1.1.1.1.2.cmml">⁢</mo><mrow id="algx1.l12.m1.1.1.1.1.1" xref="algx1.l12.m1.1.1.1.1.1.1.cmml"><mo id="algx1.l12.m1.1.1.1.1.1.2" stretchy="false" xref="algx1.l12.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="algx1.l12.m1.1.1.1.1.1.1" xref="algx1.l12.m1.1.1.1.1.1.1.cmml"><mi id="algx1.l12.m1.1.1.1.1.1.1.2" xref="algx1.l12.m1.1.1.1.1.1.1.2.cmml">R</mi><mo id="algx1.l12.m1.1.1.1.1.1.1.1" xref="algx1.l12.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l12.m1.1.1.1.1.1.1.3" xref="algx1.l12.m1.1.1.1.1.1.1.3.cmml">e</mi><mo id="algx1.l12.m1.1.1.1.1.1.1.1a" xref="algx1.l12.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l12.m1.1.1.1.1.1.1.4" xref="algx1.l12.m1.1.1.1.1.1.1.4.cmml">s</mi><mo id="algx1.l12.m1.1.1.1.1.1.1.1b" xref="algx1.l12.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l12.m1.1.1.1.1.1.1.5" xref="algx1.l12.m1.1.1.1.1.1.1.5.cmml">i</mi><mo id="algx1.l12.m1.1.1.1.1.1.1.1c" xref="algx1.l12.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l12.m1.1.1.1.1.1.1.6" xref="algx1.l12.m1.1.1.1.1.1.1.6.cmml">d</mi><mo id="algx1.l12.m1.1.1.1.1.1.1.1d" xref="algx1.l12.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l12.m1.1.1.1.1.1.1.7" xref="algx1.l12.m1.1.1.1.1.1.1.7.cmml">u</mi><mo id="algx1.l12.m1.1.1.1.1.1.1.1e" xref="algx1.l12.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l12.m1.1.1.1.1.1.1.8" xref="algx1.l12.m1.1.1.1.1.1.1.8.cmml">a</mi><mo id="algx1.l12.m1.1.1.1.1.1.1.1f" xref="algx1.l12.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l12.m1.1.1.1.1.1.1.9" xref="algx1.l12.m1.1.1.1.1.1.1.9.cmml">l</mi><mo id="algx1.l12.m1.1.1.1.1.1.1.1g" xref="algx1.l12.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l12.m1.1.1.1.1.1.1.10" xref="algx1.l12.m1.1.1.1.1.1.1.10.cmml">S</mi><mo id="algx1.l12.m1.1.1.1.1.1.1.1h" xref="algx1.l12.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l12.m1.1.1.1.1.1.1.11" xref="algx1.l12.m1.1.1.1.1.1.1.11.cmml">e</mi><mo id="algx1.l12.m1.1.1.1.1.1.1.1i" xref="algx1.l12.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l12.m1.1.1.1.1.1.1.12" xref="algx1.l12.m1.1.1.1.1.1.1.12.cmml">l</mi><mo id="algx1.l12.m1.1.1.1.1.1.1.1j" xref="algx1.l12.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l12.m1.1.1.1.1.1.1.13" xref="algx1.l12.m1.1.1.1.1.1.1.13.cmml">f</mi><mo id="algx1.l12.m1.1.1.1.1.1.1.1k" xref="algx1.l12.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l12.m1.1.1.1.1.1.1.14" xref="algx1.l12.m1.1.1.1.1.1.1.14.cmml">A</mi><mo id="algx1.l12.m1.1.1.1.1.1.1.1l" xref="algx1.l12.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l12.m1.1.1.1.1.1.1.15" xref="algx1.l12.m1.1.1.1.1.1.1.15.cmml">t</mi><mo id="algx1.l12.m1.1.1.1.1.1.1.1m" xref="algx1.l12.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l12.m1.1.1.1.1.1.1.16" xref="algx1.l12.m1.1.1.1.1.1.1.16.cmml">t</mi><mo id="algx1.l12.m1.1.1.1.1.1.1.1n" xref="algx1.l12.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l12.m1.1.1.1.1.1.1.17" xref="algx1.l12.m1.1.1.1.1.1.1.17.cmml">e</mi><mo id="algx1.l12.m1.1.1.1.1.1.1.1o" xref="algx1.l12.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l12.m1.1.1.1.1.1.1.18" xref="algx1.l12.m1.1.1.1.1.1.1.18.cmml">n</mi><mo id="algx1.l12.m1.1.1.1.1.1.1.1p" xref="algx1.l12.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l12.m1.1.1.1.1.1.1.19" xref="algx1.l12.m1.1.1.1.1.1.1.19.cmml">t</mi><mo id="algx1.l12.m1.1.1.1.1.1.1.1q" xref="algx1.l12.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l12.m1.1.1.1.1.1.1.20" xref="algx1.l12.m1.1.1.1.1.1.1.20.cmml">i</mi><mo id="algx1.l12.m1.1.1.1.1.1.1.1r" xref="algx1.l12.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l12.m1.1.1.1.1.1.1.21" xref="algx1.l12.m1.1.1.1.1.1.1.21.cmml">o</mi><mo id="algx1.l12.m1.1.1.1.1.1.1.1s" xref="algx1.l12.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l12.m1.1.1.1.1.1.1.22" xref="algx1.l12.m1.1.1.1.1.1.1.22.cmml">n</mi></mrow><mo id="algx1.l12.m1.1.1.1.1.1.3" stretchy="false" xref="algx1.l12.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx1.l12.m1.1b"><apply id="algx1.l12.m1.1.1.cmml" xref="algx1.l12.m1.1.1"><ci id="algx1.l12.m1.1.1.2.cmml" xref="algx1.l12.m1.1.1.2">←</ci><apply id="algx1.l12.m1.1.1.3.cmml" xref="algx1.l12.m1.1.1.3"><times id="algx1.l12.m1.1.1.3.1.cmml" xref="algx1.l12.m1.1.1.3.1"></times><ci id="algx1.l12.m1.1.1.3.2.cmml" xref="algx1.l12.m1.1.1.3.2">𝐸</ci><ci id="algx1.l12.m1.1.1.3.3.cmml" xref="algx1.l12.m1.1.1.3.3">𝑛</ci><ci id="algx1.l12.m1.1.1.3.4.cmml" xref="algx1.l12.m1.1.1.3.4">𝑐</ci><ci id="algx1.l12.m1.1.1.3.5.cmml" xref="algx1.l12.m1.1.1.3.5">𝑜</ci><ci id="algx1.l12.m1.1.1.3.6.cmml" xref="algx1.l12.m1.1.1.3.6">𝑑</ci><ci id="algx1.l12.m1.1.1.3.7.cmml" xref="algx1.l12.m1.1.1.3.7">𝑒</ci><ci id="algx1.l12.m1.1.1.3.8.cmml" xref="algx1.l12.m1.1.1.3.8">𝑟</ci><ci id="algx1.l12.m1.1.1.3.9.cmml" xref="algx1.l12.m1.1.1.3.9">𝐹</ci><ci id="algx1.l12.m1.1.1.3.10.cmml" xref="algx1.l12.m1.1.1.3.10">𝑒</ci><ci id="algx1.l12.m1.1.1.3.11.cmml" xref="algx1.l12.m1.1.1.3.11">𝑒</ci><ci id="algx1.l12.m1.1.1.3.12.cmml" xref="algx1.l12.m1.1.1.3.12">𝑑</ci><ci id="algx1.l12.m1.1.1.3.13.cmml" xref="algx1.l12.m1.1.1.3.13">𝐹</ci><ci id="algx1.l12.m1.1.1.3.14.cmml" xref="algx1.l12.m1.1.1.3.14">𝑜</ci><ci id="algx1.l12.m1.1.1.3.15.cmml" xref="algx1.l12.m1.1.1.3.15">𝑟</ci><ci id="algx1.l12.m1.1.1.3.16.cmml" xref="algx1.l12.m1.1.1.3.16">𝑤</ci><ci id="algx1.l12.m1.1.1.3.17.cmml" xref="algx1.l12.m1.1.1.3.17">𝑎</ci><ci id="algx1.l12.m1.1.1.3.18.cmml" xref="algx1.l12.m1.1.1.3.18">𝑟</ci><ci id="algx1.l12.m1.1.1.3.19.cmml" xref="algx1.l12.m1.1.1.3.19">𝑑</ci><ci id="algx1.l12.m1.1.1.3.20.cmml" xref="algx1.l12.m1.1.1.3.20">𝑂</ci><ci id="algx1.l12.m1.1.1.3.21.cmml" xref="algx1.l12.m1.1.1.3.21">𝑢</ci><ci id="algx1.l12.m1.1.1.3.22.cmml" xref="algx1.l12.m1.1.1.3.22">𝑡</ci><ci id="algx1.l12.m1.1.1.3.23.cmml" xref="algx1.l12.m1.1.1.3.23">𝑝</ci><ci id="algx1.l12.m1.1.1.3.24.cmml" xref="algx1.l12.m1.1.1.3.24">𝑢</ci><ci id="algx1.l12.m1.1.1.3.25.cmml" xref="algx1.l12.m1.1.1.3.25">𝑡</ci></apply><apply id="algx1.l12.m1.1.1.1.cmml" xref="algx1.l12.m1.1.1.1"><times id="algx1.l12.m1.1.1.1.2.cmml" xref="algx1.l12.m1.1.1.1.2"></times><ci id="algx1.l12.m1.1.1.1.3a.cmml" xref="algx1.l12.m1.1.1.1.3"><mtext id="algx1.l12.m1.1.1.1.3.cmml" xref="algx1.l12.m1.1.1.1.3">FeedForward</mtext></ci><apply id="algx1.l12.m1.1.1.1.1.1.1.cmml" xref="algx1.l12.m1.1.1.1.1.1"><times id="algx1.l12.m1.1.1.1.1.1.1.1.cmml" xref="algx1.l12.m1.1.1.1.1.1.1.1"></times><ci id="algx1.l12.m1.1.1.1.1.1.1.2.cmml" xref="algx1.l12.m1.1.1.1.1.1.1.2">𝑅</ci><ci id="algx1.l12.m1.1.1.1.1.1.1.3.cmml" xref="algx1.l12.m1.1.1.1.1.1.1.3">𝑒</ci><ci id="algx1.l12.m1.1.1.1.1.1.1.4.cmml" xref="algx1.l12.m1.1.1.1.1.1.1.4">𝑠</ci><ci id="algx1.l12.m1.1.1.1.1.1.1.5.cmml" xref="algx1.l12.m1.1.1.1.1.1.1.5">𝑖</ci><ci id="algx1.l12.m1.1.1.1.1.1.1.6.cmml" xref="algx1.l12.m1.1.1.1.1.1.1.6">𝑑</ci><ci id="algx1.l12.m1.1.1.1.1.1.1.7.cmml" xref="algx1.l12.m1.1.1.1.1.1.1.7">𝑢</ci><ci id="algx1.l12.m1.1.1.1.1.1.1.8.cmml" xref="algx1.l12.m1.1.1.1.1.1.1.8">𝑎</ci><ci id="algx1.l12.m1.1.1.1.1.1.1.9.cmml" xref="algx1.l12.m1.1.1.1.1.1.1.9">𝑙</ci><ci id="algx1.l12.m1.1.1.1.1.1.1.10.cmml" xref="algx1.l12.m1.1.1.1.1.1.1.10">𝑆</ci><ci id="algx1.l12.m1.1.1.1.1.1.1.11.cmml" xref="algx1.l12.m1.1.1.1.1.1.1.11">𝑒</ci><ci id="algx1.l12.m1.1.1.1.1.1.1.12.cmml" xref="algx1.l12.m1.1.1.1.1.1.1.12">𝑙</ci><ci id="algx1.l12.m1.1.1.1.1.1.1.13.cmml" xref="algx1.l12.m1.1.1.1.1.1.1.13">𝑓</ci><ci id="algx1.l12.m1.1.1.1.1.1.1.14.cmml" xref="algx1.l12.m1.1.1.1.1.1.1.14">𝐴</ci><ci id="algx1.l12.m1.1.1.1.1.1.1.15.cmml" xref="algx1.l12.m1.1.1.1.1.1.1.15">𝑡</ci><ci id="algx1.l12.m1.1.1.1.1.1.1.16.cmml" xref="algx1.l12.m1.1.1.1.1.1.1.16">𝑡</ci><ci id="algx1.l12.m1.1.1.1.1.1.1.17.cmml" xref="algx1.l12.m1.1.1.1.1.1.1.17">𝑒</ci><ci id="algx1.l12.m1.1.1.1.1.1.1.18.cmml" xref="algx1.l12.m1.1.1.1.1.1.1.18">𝑛</ci><ci id="algx1.l12.m1.1.1.1.1.1.1.19.cmml" xref="algx1.l12.m1.1.1.1.1.1.1.19">𝑡</ci><ci id="algx1.l12.m1.1.1.1.1.1.1.20.cmml" xref="algx1.l12.m1.1.1.1.1.1.1.20">𝑖</ci><ci id="algx1.l12.m1.1.1.1.1.1.1.21.cmml" xref="algx1.l12.m1.1.1.1.1.1.1.21">𝑜</ci><ci id="algx1.l12.m1.1.1.1.1.1.1.22.cmml" xref="algx1.l12.m1.1.1.1.1.1.1.22">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l12.m1.1c">EncoderFeedForwardOutput\leftarrow\text{FeedForward}(ResidualSelfAttention)</annotation><annotation encoding="application/x-llamapun" id="algx1.l12.m1.1d">italic_E italic_n italic_c italic_o italic_d italic_e italic_r italic_F italic_e italic_e italic_d italic_F italic_o italic_r italic_w italic_a italic_r italic_d italic_O italic_u italic_t italic_p italic_u italic_t ← FeedForward ( italic_R italic_e italic_s italic_i italic_d italic_u italic_a italic_l italic_S italic_e italic_l italic_f italic_A italic_t italic_t italic_e italic_n italic_t italic_i italic_o italic_n )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algx1.l13">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algx1.l13.1.1.1" style="font-size:80%;">13:</span></span>  <math alttext="EncoderOutput\leftarrow\text{LayerNorm}(EncoderFeedForwardOutput+ResidualSelfAttention)" class="ltx_Math" display="inline" id="algx1.l13.m1.1"><semantics id="algx1.l13.m1.1a"><mrow id="algx1.l13.m1.1.1" xref="algx1.l13.m1.1.1.cmml"><mrow id="algx1.l13.m1.1.1.3" xref="algx1.l13.m1.1.1.3.cmml"><mi id="algx1.l13.m1.1.1.3.2" xref="algx1.l13.m1.1.1.3.2.cmml">E</mi><mo id="algx1.l13.m1.1.1.3.1" xref="algx1.l13.m1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l13.m1.1.1.3.3" xref="algx1.l13.m1.1.1.3.3.cmml">n</mi><mo id="algx1.l13.m1.1.1.3.1a" xref="algx1.l13.m1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l13.m1.1.1.3.4" xref="algx1.l13.m1.1.1.3.4.cmml">c</mi><mo id="algx1.l13.m1.1.1.3.1b" xref="algx1.l13.m1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l13.m1.1.1.3.5" xref="algx1.l13.m1.1.1.3.5.cmml">o</mi><mo id="algx1.l13.m1.1.1.3.1c" xref="algx1.l13.m1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l13.m1.1.1.3.6" xref="algx1.l13.m1.1.1.3.6.cmml">d</mi><mo id="algx1.l13.m1.1.1.3.1d" xref="algx1.l13.m1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l13.m1.1.1.3.7" xref="algx1.l13.m1.1.1.3.7.cmml">e</mi><mo id="algx1.l13.m1.1.1.3.1e" xref="algx1.l13.m1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l13.m1.1.1.3.8" xref="algx1.l13.m1.1.1.3.8.cmml">r</mi><mo id="algx1.l13.m1.1.1.3.1f" xref="algx1.l13.m1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l13.m1.1.1.3.9" xref="algx1.l13.m1.1.1.3.9.cmml">O</mi><mo id="algx1.l13.m1.1.1.3.1g" xref="algx1.l13.m1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l13.m1.1.1.3.10" xref="algx1.l13.m1.1.1.3.10.cmml">u</mi><mo id="algx1.l13.m1.1.1.3.1h" xref="algx1.l13.m1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l13.m1.1.1.3.11" xref="algx1.l13.m1.1.1.3.11.cmml">t</mi><mo id="algx1.l13.m1.1.1.3.1i" xref="algx1.l13.m1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l13.m1.1.1.3.12" xref="algx1.l13.m1.1.1.3.12.cmml">p</mi><mo id="algx1.l13.m1.1.1.3.1j" xref="algx1.l13.m1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l13.m1.1.1.3.13" xref="algx1.l13.m1.1.1.3.13.cmml">u</mi><mo id="algx1.l13.m1.1.1.3.1k" xref="algx1.l13.m1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l13.m1.1.1.3.14" xref="algx1.l13.m1.1.1.3.14.cmml">t</mi></mrow><mo id="algx1.l13.m1.1.1.2" stretchy="false" xref="algx1.l13.m1.1.1.2.cmml">←</mo><mrow id="algx1.l13.m1.1.1.1" xref="algx1.l13.m1.1.1.1.cmml"><mtext id="algx1.l13.m1.1.1.1.3" xref="algx1.l13.m1.1.1.1.3a.cmml">LayerNorm</mtext><mo id="algx1.l13.m1.1.1.1.2" xref="algx1.l13.m1.1.1.1.2.cmml">⁢</mo><mrow id="algx1.l13.m1.1.1.1.1.1" xref="algx1.l13.m1.1.1.1.1.1.1.cmml"><mo id="algx1.l13.m1.1.1.1.1.1.2" stretchy="false" xref="algx1.l13.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="algx1.l13.m1.1.1.1.1.1.1" xref="algx1.l13.m1.1.1.1.1.1.1.cmml"><mrow id="algx1.l13.m1.1.1.1.1.1.1.2" xref="algx1.l13.m1.1.1.1.1.1.1.2.cmml"><mi id="algx1.l13.m1.1.1.1.1.1.1.2.2" xref="algx1.l13.m1.1.1.1.1.1.1.2.2.cmml">E</mi><mo id="algx1.l13.m1.1.1.1.1.1.1.2.1" xref="algx1.l13.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx1.l13.m1.1.1.1.1.1.1.2.3" xref="algx1.l13.m1.1.1.1.1.1.1.2.3.cmml">n</mi><mo id="algx1.l13.m1.1.1.1.1.1.1.2.1a" xref="algx1.l13.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx1.l13.m1.1.1.1.1.1.1.2.4" xref="algx1.l13.m1.1.1.1.1.1.1.2.4.cmml">c</mi><mo id="algx1.l13.m1.1.1.1.1.1.1.2.1b" xref="algx1.l13.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx1.l13.m1.1.1.1.1.1.1.2.5" xref="algx1.l13.m1.1.1.1.1.1.1.2.5.cmml">o</mi><mo id="algx1.l13.m1.1.1.1.1.1.1.2.1c" xref="algx1.l13.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx1.l13.m1.1.1.1.1.1.1.2.6" xref="algx1.l13.m1.1.1.1.1.1.1.2.6.cmml">d</mi><mo id="algx1.l13.m1.1.1.1.1.1.1.2.1d" xref="algx1.l13.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx1.l13.m1.1.1.1.1.1.1.2.7" xref="algx1.l13.m1.1.1.1.1.1.1.2.7.cmml">e</mi><mo id="algx1.l13.m1.1.1.1.1.1.1.2.1e" xref="algx1.l13.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx1.l13.m1.1.1.1.1.1.1.2.8" xref="algx1.l13.m1.1.1.1.1.1.1.2.8.cmml">r</mi><mo id="algx1.l13.m1.1.1.1.1.1.1.2.1f" xref="algx1.l13.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx1.l13.m1.1.1.1.1.1.1.2.9" xref="algx1.l13.m1.1.1.1.1.1.1.2.9.cmml">F</mi><mo id="algx1.l13.m1.1.1.1.1.1.1.2.1g" xref="algx1.l13.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx1.l13.m1.1.1.1.1.1.1.2.10" xref="algx1.l13.m1.1.1.1.1.1.1.2.10.cmml">e</mi><mo id="algx1.l13.m1.1.1.1.1.1.1.2.1h" xref="algx1.l13.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx1.l13.m1.1.1.1.1.1.1.2.11" xref="algx1.l13.m1.1.1.1.1.1.1.2.11.cmml">e</mi><mo id="algx1.l13.m1.1.1.1.1.1.1.2.1i" xref="algx1.l13.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx1.l13.m1.1.1.1.1.1.1.2.12" xref="algx1.l13.m1.1.1.1.1.1.1.2.12.cmml">d</mi><mo id="algx1.l13.m1.1.1.1.1.1.1.2.1j" xref="algx1.l13.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx1.l13.m1.1.1.1.1.1.1.2.13" xref="algx1.l13.m1.1.1.1.1.1.1.2.13.cmml">F</mi><mo id="algx1.l13.m1.1.1.1.1.1.1.2.1k" xref="algx1.l13.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx1.l13.m1.1.1.1.1.1.1.2.14" xref="algx1.l13.m1.1.1.1.1.1.1.2.14.cmml">o</mi><mo id="algx1.l13.m1.1.1.1.1.1.1.2.1l" xref="algx1.l13.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx1.l13.m1.1.1.1.1.1.1.2.15" xref="algx1.l13.m1.1.1.1.1.1.1.2.15.cmml">r</mi><mo id="algx1.l13.m1.1.1.1.1.1.1.2.1m" xref="algx1.l13.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx1.l13.m1.1.1.1.1.1.1.2.16" xref="algx1.l13.m1.1.1.1.1.1.1.2.16.cmml">w</mi><mo id="algx1.l13.m1.1.1.1.1.1.1.2.1n" xref="algx1.l13.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx1.l13.m1.1.1.1.1.1.1.2.17" xref="algx1.l13.m1.1.1.1.1.1.1.2.17.cmml">a</mi><mo id="algx1.l13.m1.1.1.1.1.1.1.2.1o" xref="algx1.l13.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx1.l13.m1.1.1.1.1.1.1.2.18" xref="algx1.l13.m1.1.1.1.1.1.1.2.18.cmml">r</mi><mo id="algx1.l13.m1.1.1.1.1.1.1.2.1p" xref="algx1.l13.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx1.l13.m1.1.1.1.1.1.1.2.19" xref="algx1.l13.m1.1.1.1.1.1.1.2.19.cmml">d</mi><mo id="algx1.l13.m1.1.1.1.1.1.1.2.1q" xref="algx1.l13.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx1.l13.m1.1.1.1.1.1.1.2.20" xref="algx1.l13.m1.1.1.1.1.1.1.2.20.cmml">O</mi><mo id="algx1.l13.m1.1.1.1.1.1.1.2.1r" xref="algx1.l13.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx1.l13.m1.1.1.1.1.1.1.2.21" xref="algx1.l13.m1.1.1.1.1.1.1.2.21.cmml">u</mi><mo id="algx1.l13.m1.1.1.1.1.1.1.2.1s" xref="algx1.l13.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx1.l13.m1.1.1.1.1.1.1.2.22" xref="algx1.l13.m1.1.1.1.1.1.1.2.22.cmml">t</mi><mo id="algx1.l13.m1.1.1.1.1.1.1.2.1t" xref="algx1.l13.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx1.l13.m1.1.1.1.1.1.1.2.23" xref="algx1.l13.m1.1.1.1.1.1.1.2.23.cmml">p</mi><mo id="algx1.l13.m1.1.1.1.1.1.1.2.1u" xref="algx1.l13.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx1.l13.m1.1.1.1.1.1.1.2.24" xref="algx1.l13.m1.1.1.1.1.1.1.2.24.cmml">u</mi><mo id="algx1.l13.m1.1.1.1.1.1.1.2.1v" xref="algx1.l13.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx1.l13.m1.1.1.1.1.1.1.2.25" xref="algx1.l13.m1.1.1.1.1.1.1.2.25.cmml">t</mi></mrow><mo id="algx1.l13.m1.1.1.1.1.1.1.1" xref="algx1.l13.m1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="algx1.l13.m1.1.1.1.1.1.1.3" xref="algx1.l13.m1.1.1.1.1.1.1.3.cmml"><mi id="algx1.l13.m1.1.1.1.1.1.1.3.2" xref="algx1.l13.m1.1.1.1.1.1.1.3.2.cmml">R</mi><mo id="algx1.l13.m1.1.1.1.1.1.1.3.1" xref="algx1.l13.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l13.m1.1.1.1.1.1.1.3.3" xref="algx1.l13.m1.1.1.1.1.1.1.3.3.cmml">e</mi><mo id="algx1.l13.m1.1.1.1.1.1.1.3.1a" xref="algx1.l13.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l13.m1.1.1.1.1.1.1.3.4" xref="algx1.l13.m1.1.1.1.1.1.1.3.4.cmml">s</mi><mo id="algx1.l13.m1.1.1.1.1.1.1.3.1b" xref="algx1.l13.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l13.m1.1.1.1.1.1.1.3.5" xref="algx1.l13.m1.1.1.1.1.1.1.3.5.cmml">i</mi><mo id="algx1.l13.m1.1.1.1.1.1.1.3.1c" xref="algx1.l13.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l13.m1.1.1.1.1.1.1.3.6" xref="algx1.l13.m1.1.1.1.1.1.1.3.6.cmml">d</mi><mo id="algx1.l13.m1.1.1.1.1.1.1.3.1d" xref="algx1.l13.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l13.m1.1.1.1.1.1.1.3.7" xref="algx1.l13.m1.1.1.1.1.1.1.3.7.cmml">u</mi><mo id="algx1.l13.m1.1.1.1.1.1.1.3.1e" xref="algx1.l13.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l13.m1.1.1.1.1.1.1.3.8" xref="algx1.l13.m1.1.1.1.1.1.1.3.8.cmml">a</mi><mo id="algx1.l13.m1.1.1.1.1.1.1.3.1f" xref="algx1.l13.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l13.m1.1.1.1.1.1.1.3.9" xref="algx1.l13.m1.1.1.1.1.1.1.3.9.cmml">l</mi><mo id="algx1.l13.m1.1.1.1.1.1.1.3.1g" xref="algx1.l13.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l13.m1.1.1.1.1.1.1.3.10" xref="algx1.l13.m1.1.1.1.1.1.1.3.10.cmml">S</mi><mo id="algx1.l13.m1.1.1.1.1.1.1.3.1h" xref="algx1.l13.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l13.m1.1.1.1.1.1.1.3.11" xref="algx1.l13.m1.1.1.1.1.1.1.3.11.cmml">e</mi><mo id="algx1.l13.m1.1.1.1.1.1.1.3.1i" xref="algx1.l13.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l13.m1.1.1.1.1.1.1.3.12" xref="algx1.l13.m1.1.1.1.1.1.1.3.12.cmml">l</mi><mo id="algx1.l13.m1.1.1.1.1.1.1.3.1j" xref="algx1.l13.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l13.m1.1.1.1.1.1.1.3.13" xref="algx1.l13.m1.1.1.1.1.1.1.3.13.cmml">f</mi><mo id="algx1.l13.m1.1.1.1.1.1.1.3.1k" xref="algx1.l13.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l13.m1.1.1.1.1.1.1.3.14" xref="algx1.l13.m1.1.1.1.1.1.1.3.14.cmml">A</mi><mo id="algx1.l13.m1.1.1.1.1.1.1.3.1l" xref="algx1.l13.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l13.m1.1.1.1.1.1.1.3.15" xref="algx1.l13.m1.1.1.1.1.1.1.3.15.cmml">t</mi><mo id="algx1.l13.m1.1.1.1.1.1.1.3.1m" xref="algx1.l13.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l13.m1.1.1.1.1.1.1.3.16" xref="algx1.l13.m1.1.1.1.1.1.1.3.16.cmml">t</mi><mo id="algx1.l13.m1.1.1.1.1.1.1.3.1n" xref="algx1.l13.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l13.m1.1.1.1.1.1.1.3.17" xref="algx1.l13.m1.1.1.1.1.1.1.3.17.cmml">e</mi><mo id="algx1.l13.m1.1.1.1.1.1.1.3.1o" xref="algx1.l13.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l13.m1.1.1.1.1.1.1.3.18" xref="algx1.l13.m1.1.1.1.1.1.1.3.18.cmml">n</mi><mo id="algx1.l13.m1.1.1.1.1.1.1.3.1p" xref="algx1.l13.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l13.m1.1.1.1.1.1.1.3.19" xref="algx1.l13.m1.1.1.1.1.1.1.3.19.cmml">t</mi><mo id="algx1.l13.m1.1.1.1.1.1.1.3.1q" xref="algx1.l13.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l13.m1.1.1.1.1.1.1.3.20" xref="algx1.l13.m1.1.1.1.1.1.1.3.20.cmml">i</mi><mo id="algx1.l13.m1.1.1.1.1.1.1.3.1r" xref="algx1.l13.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l13.m1.1.1.1.1.1.1.3.21" xref="algx1.l13.m1.1.1.1.1.1.1.3.21.cmml">o</mi><mo id="algx1.l13.m1.1.1.1.1.1.1.3.1s" xref="algx1.l13.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l13.m1.1.1.1.1.1.1.3.22" xref="algx1.l13.m1.1.1.1.1.1.1.3.22.cmml">n</mi></mrow></mrow><mo id="algx1.l13.m1.1.1.1.1.1.3" stretchy="false" xref="algx1.l13.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx1.l13.m1.1b"><apply id="algx1.l13.m1.1.1.cmml" xref="algx1.l13.m1.1.1"><ci id="algx1.l13.m1.1.1.2.cmml" xref="algx1.l13.m1.1.1.2">←</ci><apply id="algx1.l13.m1.1.1.3.cmml" xref="algx1.l13.m1.1.1.3"><times id="algx1.l13.m1.1.1.3.1.cmml" xref="algx1.l13.m1.1.1.3.1"></times><ci id="algx1.l13.m1.1.1.3.2.cmml" xref="algx1.l13.m1.1.1.3.2">𝐸</ci><ci id="algx1.l13.m1.1.1.3.3.cmml" xref="algx1.l13.m1.1.1.3.3">𝑛</ci><ci id="algx1.l13.m1.1.1.3.4.cmml" xref="algx1.l13.m1.1.1.3.4">𝑐</ci><ci id="algx1.l13.m1.1.1.3.5.cmml" xref="algx1.l13.m1.1.1.3.5">𝑜</ci><ci id="algx1.l13.m1.1.1.3.6.cmml" xref="algx1.l13.m1.1.1.3.6">𝑑</ci><ci id="algx1.l13.m1.1.1.3.7.cmml" xref="algx1.l13.m1.1.1.3.7">𝑒</ci><ci id="algx1.l13.m1.1.1.3.8.cmml" xref="algx1.l13.m1.1.1.3.8">𝑟</ci><ci id="algx1.l13.m1.1.1.3.9.cmml" xref="algx1.l13.m1.1.1.3.9">𝑂</ci><ci id="algx1.l13.m1.1.1.3.10.cmml" xref="algx1.l13.m1.1.1.3.10">𝑢</ci><ci id="algx1.l13.m1.1.1.3.11.cmml" xref="algx1.l13.m1.1.1.3.11">𝑡</ci><ci id="algx1.l13.m1.1.1.3.12.cmml" xref="algx1.l13.m1.1.1.3.12">𝑝</ci><ci id="algx1.l13.m1.1.1.3.13.cmml" xref="algx1.l13.m1.1.1.3.13">𝑢</ci><ci id="algx1.l13.m1.1.1.3.14.cmml" xref="algx1.l13.m1.1.1.3.14">𝑡</ci></apply><apply id="algx1.l13.m1.1.1.1.cmml" xref="algx1.l13.m1.1.1.1"><times id="algx1.l13.m1.1.1.1.2.cmml" xref="algx1.l13.m1.1.1.1.2"></times><ci id="algx1.l13.m1.1.1.1.3a.cmml" xref="algx1.l13.m1.1.1.1.3"><mtext id="algx1.l13.m1.1.1.1.3.cmml" xref="algx1.l13.m1.1.1.1.3">LayerNorm</mtext></ci><apply id="algx1.l13.m1.1.1.1.1.1.1.cmml" xref="algx1.l13.m1.1.1.1.1.1"><plus id="algx1.l13.m1.1.1.1.1.1.1.1.cmml" xref="algx1.l13.m1.1.1.1.1.1.1.1"></plus><apply id="algx1.l13.m1.1.1.1.1.1.1.2.cmml" xref="algx1.l13.m1.1.1.1.1.1.1.2"><times id="algx1.l13.m1.1.1.1.1.1.1.2.1.cmml" xref="algx1.l13.m1.1.1.1.1.1.1.2.1"></times><ci id="algx1.l13.m1.1.1.1.1.1.1.2.2.cmml" xref="algx1.l13.m1.1.1.1.1.1.1.2.2">𝐸</ci><ci id="algx1.l13.m1.1.1.1.1.1.1.2.3.cmml" xref="algx1.l13.m1.1.1.1.1.1.1.2.3">𝑛</ci><ci id="algx1.l13.m1.1.1.1.1.1.1.2.4.cmml" xref="algx1.l13.m1.1.1.1.1.1.1.2.4">𝑐</ci><ci id="algx1.l13.m1.1.1.1.1.1.1.2.5.cmml" xref="algx1.l13.m1.1.1.1.1.1.1.2.5">𝑜</ci><ci id="algx1.l13.m1.1.1.1.1.1.1.2.6.cmml" xref="algx1.l13.m1.1.1.1.1.1.1.2.6">𝑑</ci><ci id="algx1.l13.m1.1.1.1.1.1.1.2.7.cmml" xref="algx1.l13.m1.1.1.1.1.1.1.2.7">𝑒</ci><ci id="algx1.l13.m1.1.1.1.1.1.1.2.8.cmml" xref="algx1.l13.m1.1.1.1.1.1.1.2.8">𝑟</ci><ci id="algx1.l13.m1.1.1.1.1.1.1.2.9.cmml" xref="algx1.l13.m1.1.1.1.1.1.1.2.9">𝐹</ci><ci id="algx1.l13.m1.1.1.1.1.1.1.2.10.cmml" xref="algx1.l13.m1.1.1.1.1.1.1.2.10">𝑒</ci><ci id="algx1.l13.m1.1.1.1.1.1.1.2.11.cmml" xref="algx1.l13.m1.1.1.1.1.1.1.2.11">𝑒</ci><ci id="algx1.l13.m1.1.1.1.1.1.1.2.12.cmml" xref="algx1.l13.m1.1.1.1.1.1.1.2.12">𝑑</ci><ci id="algx1.l13.m1.1.1.1.1.1.1.2.13.cmml" xref="algx1.l13.m1.1.1.1.1.1.1.2.13">𝐹</ci><ci id="algx1.l13.m1.1.1.1.1.1.1.2.14.cmml" xref="algx1.l13.m1.1.1.1.1.1.1.2.14">𝑜</ci><ci id="algx1.l13.m1.1.1.1.1.1.1.2.15.cmml" xref="algx1.l13.m1.1.1.1.1.1.1.2.15">𝑟</ci><ci id="algx1.l13.m1.1.1.1.1.1.1.2.16.cmml" xref="algx1.l13.m1.1.1.1.1.1.1.2.16">𝑤</ci><ci id="algx1.l13.m1.1.1.1.1.1.1.2.17.cmml" xref="algx1.l13.m1.1.1.1.1.1.1.2.17">𝑎</ci><ci id="algx1.l13.m1.1.1.1.1.1.1.2.18.cmml" xref="algx1.l13.m1.1.1.1.1.1.1.2.18">𝑟</ci><ci id="algx1.l13.m1.1.1.1.1.1.1.2.19.cmml" xref="algx1.l13.m1.1.1.1.1.1.1.2.19">𝑑</ci><ci id="algx1.l13.m1.1.1.1.1.1.1.2.20.cmml" xref="algx1.l13.m1.1.1.1.1.1.1.2.20">𝑂</ci><ci id="algx1.l13.m1.1.1.1.1.1.1.2.21.cmml" xref="algx1.l13.m1.1.1.1.1.1.1.2.21">𝑢</ci><ci id="algx1.l13.m1.1.1.1.1.1.1.2.22.cmml" xref="algx1.l13.m1.1.1.1.1.1.1.2.22">𝑡</ci><ci id="algx1.l13.m1.1.1.1.1.1.1.2.23.cmml" xref="algx1.l13.m1.1.1.1.1.1.1.2.23">𝑝</ci><ci id="algx1.l13.m1.1.1.1.1.1.1.2.24.cmml" xref="algx1.l13.m1.1.1.1.1.1.1.2.24">𝑢</ci><ci id="algx1.l13.m1.1.1.1.1.1.1.2.25.cmml" xref="algx1.l13.m1.1.1.1.1.1.1.2.25">𝑡</ci></apply><apply id="algx1.l13.m1.1.1.1.1.1.1.3.cmml" xref="algx1.l13.m1.1.1.1.1.1.1.3"><times id="algx1.l13.m1.1.1.1.1.1.1.3.1.cmml" xref="algx1.l13.m1.1.1.1.1.1.1.3.1"></times><ci id="algx1.l13.m1.1.1.1.1.1.1.3.2.cmml" xref="algx1.l13.m1.1.1.1.1.1.1.3.2">𝑅</ci><ci id="algx1.l13.m1.1.1.1.1.1.1.3.3.cmml" xref="algx1.l13.m1.1.1.1.1.1.1.3.3">𝑒</ci><ci id="algx1.l13.m1.1.1.1.1.1.1.3.4.cmml" xref="algx1.l13.m1.1.1.1.1.1.1.3.4">𝑠</ci><ci id="algx1.l13.m1.1.1.1.1.1.1.3.5.cmml" xref="algx1.l13.m1.1.1.1.1.1.1.3.5">𝑖</ci><ci id="algx1.l13.m1.1.1.1.1.1.1.3.6.cmml" xref="algx1.l13.m1.1.1.1.1.1.1.3.6">𝑑</ci><ci id="algx1.l13.m1.1.1.1.1.1.1.3.7.cmml" xref="algx1.l13.m1.1.1.1.1.1.1.3.7">𝑢</ci><ci id="algx1.l13.m1.1.1.1.1.1.1.3.8.cmml" xref="algx1.l13.m1.1.1.1.1.1.1.3.8">𝑎</ci><ci id="algx1.l13.m1.1.1.1.1.1.1.3.9.cmml" xref="algx1.l13.m1.1.1.1.1.1.1.3.9">𝑙</ci><ci id="algx1.l13.m1.1.1.1.1.1.1.3.10.cmml" xref="algx1.l13.m1.1.1.1.1.1.1.3.10">𝑆</ci><ci id="algx1.l13.m1.1.1.1.1.1.1.3.11.cmml" xref="algx1.l13.m1.1.1.1.1.1.1.3.11">𝑒</ci><ci id="algx1.l13.m1.1.1.1.1.1.1.3.12.cmml" xref="algx1.l13.m1.1.1.1.1.1.1.3.12">𝑙</ci><ci id="algx1.l13.m1.1.1.1.1.1.1.3.13.cmml" xref="algx1.l13.m1.1.1.1.1.1.1.3.13">𝑓</ci><ci id="algx1.l13.m1.1.1.1.1.1.1.3.14.cmml" xref="algx1.l13.m1.1.1.1.1.1.1.3.14">𝐴</ci><ci id="algx1.l13.m1.1.1.1.1.1.1.3.15.cmml" xref="algx1.l13.m1.1.1.1.1.1.1.3.15">𝑡</ci><ci id="algx1.l13.m1.1.1.1.1.1.1.3.16.cmml" xref="algx1.l13.m1.1.1.1.1.1.1.3.16">𝑡</ci><ci id="algx1.l13.m1.1.1.1.1.1.1.3.17.cmml" xref="algx1.l13.m1.1.1.1.1.1.1.3.17">𝑒</ci><ci id="algx1.l13.m1.1.1.1.1.1.1.3.18.cmml" xref="algx1.l13.m1.1.1.1.1.1.1.3.18">𝑛</ci><ci id="algx1.l13.m1.1.1.1.1.1.1.3.19.cmml" xref="algx1.l13.m1.1.1.1.1.1.1.3.19">𝑡</ci><ci id="algx1.l13.m1.1.1.1.1.1.1.3.20.cmml" xref="algx1.l13.m1.1.1.1.1.1.1.3.20">𝑖</ci><ci id="algx1.l13.m1.1.1.1.1.1.1.3.21.cmml" xref="algx1.l13.m1.1.1.1.1.1.1.3.21">𝑜</ci><ci id="algx1.l13.m1.1.1.1.1.1.1.3.22.cmml" xref="algx1.l13.m1.1.1.1.1.1.1.3.22">𝑛</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l13.m1.1c">EncoderOutput\leftarrow\text{LayerNorm}(EncoderFeedForwardOutput+ResidualSelfAttention)</annotation><annotation encoding="application/x-llamapun" id="algx1.l13.m1.1d">italic_E italic_n italic_c italic_o italic_d italic_e italic_r italic_O italic_u italic_t italic_p italic_u italic_t ← LayerNorm ( italic_E italic_n italic_c italic_o italic_d italic_e italic_r italic_F italic_e italic_e italic_d italic_F italic_o italic_r italic_w italic_a italic_r italic_d italic_O italic_u italic_t italic_p italic_u italic_t + italic_R italic_e italic_s italic_i italic_d italic_u italic_a italic_l italic_S italic_e italic_l italic_f italic_A italic_t italic_t italic_e italic_n italic_t italic_i italic_o italic_n )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algx1.l14">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algx1.l14.1.1.1" style="font-size:80%;">14:</span></span>  <math alttext="Q_{decoder}\leftarrow\textbf{decoder\_input}" class="ltx_Math" display="inline" id="algx1.l14.m1.1"><semantics id="algx1.l14.m1.1a"><mrow id="algx1.l14.m1.1.1" xref="algx1.l14.m1.1.1.cmml"><msub id="algx1.l14.m1.1.1.2" xref="algx1.l14.m1.1.1.2.cmml"><mi id="algx1.l14.m1.1.1.2.2" xref="algx1.l14.m1.1.1.2.2.cmml">Q</mi><mrow id="algx1.l14.m1.1.1.2.3" xref="algx1.l14.m1.1.1.2.3.cmml"><mi id="algx1.l14.m1.1.1.2.3.2" xref="algx1.l14.m1.1.1.2.3.2.cmml">d</mi><mo id="algx1.l14.m1.1.1.2.3.1" xref="algx1.l14.m1.1.1.2.3.1.cmml">⁢</mo><mi id="algx1.l14.m1.1.1.2.3.3" xref="algx1.l14.m1.1.1.2.3.3.cmml">e</mi><mo id="algx1.l14.m1.1.1.2.3.1a" xref="algx1.l14.m1.1.1.2.3.1.cmml">⁢</mo><mi id="algx1.l14.m1.1.1.2.3.4" xref="algx1.l14.m1.1.1.2.3.4.cmml">c</mi><mo id="algx1.l14.m1.1.1.2.3.1b" xref="algx1.l14.m1.1.1.2.3.1.cmml">⁢</mo><mi id="algx1.l14.m1.1.1.2.3.5" xref="algx1.l14.m1.1.1.2.3.5.cmml">o</mi><mo id="algx1.l14.m1.1.1.2.3.1c" xref="algx1.l14.m1.1.1.2.3.1.cmml">⁢</mo><mi id="algx1.l14.m1.1.1.2.3.6" xref="algx1.l14.m1.1.1.2.3.6.cmml">d</mi><mo id="algx1.l14.m1.1.1.2.3.1d" xref="algx1.l14.m1.1.1.2.3.1.cmml">⁢</mo><mi id="algx1.l14.m1.1.1.2.3.7" xref="algx1.l14.m1.1.1.2.3.7.cmml">e</mi><mo id="algx1.l14.m1.1.1.2.3.1e" xref="algx1.l14.m1.1.1.2.3.1.cmml">⁢</mo><mi id="algx1.l14.m1.1.1.2.3.8" xref="algx1.l14.m1.1.1.2.3.8.cmml">r</mi></mrow></msub><mo id="algx1.l14.m1.1.1.1" stretchy="false" xref="algx1.l14.m1.1.1.1.cmml">←</mo><mtext class="ltx_mathvariant_bold" id="algx1.l14.m1.1.1.3" xref="algx1.l14.m1.1.1.3a.cmml">decoder_input</mtext></mrow><annotation-xml encoding="MathML-Content" id="algx1.l14.m1.1b"><apply id="algx1.l14.m1.1.1.cmml" xref="algx1.l14.m1.1.1"><ci id="algx1.l14.m1.1.1.1.cmml" xref="algx1.l14.m1.1.1.1">←</ci><apply id="algx1.l14.m1.1.1.2.cmml" xref="algx1.l14.m1.1.1.2"><csymbol cd="ambiguous" id="algx1.l14.m1.1.1.2.1.cmml" xref="algx1.l14.m1.1.1.2">subscript</csymbol><ci id="algx1.l14.m1.1.1.2.2.cmml" xref="algx1.l14.m1.1.1.2.2">𝑄</ci><apply id="algx1.l14.m1.1.1.2.3.cmml" xref="algx1.l14.m1.1.1.2.3"><times id="algx1.l14.m1.1.1.2.3.1.cmml" xref="algx1.l14.m1.1.1.2.3.1"></times><ci id="algx1.l14.m1.1.1.2.3.2.cmml" xref="algx1.l14.m1.1.1.2.3.2">𝑑</ci><ci id="algx1.l14.m1.1.1.2.3.3.cmml" xref="algx1.l14.m1.1.1.2.3.3">𝑒</ci><ci id="algx1.l14.m1.1.1.2.3.4.cmml" xref="algx1.l14.m1.1.1.2.3.4">𝑐</ci><ci id="algx1.l14.m1.1.1.2.3.5.cmml" xref="algx1.l14.m1.1.1.2.3.5">𝑜</ci><ci id="algx1.l14.m1.1.1.2.3.6.cmml" xref="algx1.l14.m1.1.1.2.3.6">𝑑</ci><ci id="algx1.l14.m1.1.1.2.3.7.cmml" xref="algx1.l14.m1.1.1.2.3.7">𝑒</ci><ci id="algx1.l14.m1.1.1.2.3.8.cmml" xref="algx1.l14.m1.1.1.2.3.8">𝑟</ci></apply></apply><ci id="algx1.l14.m1.1.1.3a.cmml" xref="algx1.l14.m1.1.1.3"><mtext class="ltx_mathvariant_bold" id="algx1.l14.m1.1.1.3.cmml" xref="algx1.l14.m1.1.1.3">decoder_input</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l14.m1.1c">Q_{decoder}\leftarrow\textbf{decoder\_input}</annotation><annotation encoding="application/x-llamapun" id="algx1.l14.m1.1d">italic_Q start_POSTSUBSCRIPT italic_d italic_e italic_c italic_o italic_d italic_e italic_r end_POSTSUBSCRIPT ← decoder_input</annotation></semantics></math> // Decoder Processing

</div>
<div class="ltx_listingline" id="algx1.l15">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algx1.l15.1.1.1" style="font-size:80%;">15:</span></span>  <math alttext="K_{decoder},V_{decoder}\leftarrow EncoderOutput,EncoderOutput" class="ltx_Math" display="inline" id="algx1.l15.m1.2"><semantics id="algx1.l15.m1.2a"><mrow id="algx1.l15.m1.2.2.2" xref="algx1.l15.m1.2.2.3.cmml"><mrow id="algx1.l15.m1.1.1.1.1" xref="algx1.l15.m1.1.1.1.1.cmml"><mrow id="algx1.l15.m1.1.1.1.1.2.2" xref="algx1.l15.m1.1.1.1.1.2.3.cmml"><msub id="algx1.l15.m1.1.1.1.1.1.1.1" xref="algx1.l15.m1.1.1.1.1.1.1.1.cmml"><mi id="algx1.l15.m1.1.1.1.1.1.1.1.2" xref="algx1.l15.m1.1.1.1.1.1.1.1.2.cmml">K</mi><mrow id="algx1.l15.m1.1.1.1.1.1.1.1.3" xref="algx1.l15.m1.1.1.1.1.1.1.1.3.cmml"><mi id="algx1.l15.m1.1.1.1.1.1.1.1.3.2" xref="algx1.l15.m1.1.1.1.1.1.1.1.3.2.cmml">d</mi><mo id="algx1.l15.m1.1.1.1.1.1.1.1.3.1" xref="algx1.l15.m1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l15.m1.1.1.1.1.1.1.1.3.3" xref="algx1.l15.m1.1.1.1.1.1.1.1.3.3.cmml">e</mi><mo id="algx1.l15.m1.1.1.1.1.1.1.1.3.1a" xref="algx1.l15.m1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l15.m1.1.1.1.1.1.1.1.3.4" xref="algx1.l15.m1.1.1.1.1.1.1.1.3.4.cmml">c</mi><mo id="algx1.l15.m1.1.1.1.1.1.1.1.3.1b" xref="algx1.l15.m1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l15.m1.1.1.1.1.1.1.1.3.5" xref="algx1.l15.m1.1.1.1.1.1.1.1.3.5.cmml">o</mi><mo id="algx1.l15.m1.1.1.1.1.1.1.1.3.1c" xref="algx1.l15.m1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l15.m1.1.1.1.1.1.1.1.3.6" xref="algx1.l15.m1.1.1.1.1.1.1.1.3.6.cmml">d</mi><mo id="algx1.l15.m1.1.1.1.1.1.1.1.3.1d" xref="algx1.l15.m1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l15.m1.1.1.1.1.1.1.1.3.7" xref="algx1.l15.m1.1.1.1.1.1.1.1.3.7.cmml">e</mi><mo id="algx1.l15.m1.1.1.1.1.1.1.1.3.1e" xref="algx1.l15.m1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l15.m1.1.1.1.1.1.1.1.3.8" xref="algx1.l15.m1.1.1.1.1.1.1.1.3.8.cmml">r</mi></mrow></msub><mo id="algx1.l15.m1.1.1.1.1.2.2.3" xref="algx1.l15.m1.1.1.1.1.2.3.cmml">,</mo><msub id="algx1.l15.m1.1.1.1.1.2.2.2" xref="algx1.l15.m1.1.1.1.1.2.2.2.cmml"><mi id="algx1.l15.m1.1.1.1.1.2.2.2.2" xref="algx1.l15.m1.1.1.1.1.2.2.2.2.cmml">V</mi><mrow id="algx1.l15.m1.1.1.1.1.2.2.2.3" xref="algx1.l15.m1.1.1.1.1.2.2.2.3.cmml"><mi id="algx1.l15.m1.1.1.1.1.2.2.2.3.2" xref="algx1.l15.m1.1.1.1.1.2.2.2.3.2.cmml">d</mi><mo id="algx1.l15.m1.1.1.1.1.2.2.2.3.1" xref="algx1.l15.m1.1.1.1.1.2.2.2.3.1.cmml">⁢</mo><mi id="algx1.l15.m1.1.1.1.1.2.2.2.3.3" xref="algx1.l15.m1.1.1.1.1.2.2.2.3.3.cmml">e</mi><mo id="algx1.l15.m1.1.1.1.1.2.2.2.3.1a" xref="algx1.l15.m1.1.1.1.1.2.2.2.3.1.cmml">⁢</mo><mi id="algx1.l15.m1.1.1.1.1.2.2.2.3.4" xref="algx1.l15.m1.1.1.1.1.2.2.2.3.4.cmml">c</mi><mo id="algx1.l15.m1.1.1.1.1.2.2.2.3.1b" xref="algx1.l15.m1.1.1.1.1.2.2.2.3.1.cmml">⁢</mo><mi id="algx1.l15.m1.1.1.1.1.2.2.2.3.5" xref="algx1.l15.m1.1.1.1.1.2.2.2.3.5.cmml">o</mi><mo id="algx1.l15.m1.1.1.1.1.2.2.2.3.1c" xref="algx1.l15.m1.1.1.1.1.2.2.2.3.1.cmml">⁢</mo><mi id="algx1.l15.m1.1.1.1.1.2.2.2.3.6" xref="algx1.l15.m1.1.1.1.1.2.2.2.3.6.cmml">d</mi><mo id="algx1.l15.m1.1.1.1.1.2.2.2.3.1d" xref="algx1.l15.m1.1.1.1.1.2.2.2.3.1.cmml">⁢</mo><mi id="algx1.l15.m1.1.1.1.1.2.2.2.3.7" xref="algx1.l15.m1.1.1.1.1.2.2.2.3.7.cmml">e</mi><mo id="algx1.l15.m1.1.1.1.1.2.2.2.3.1e" xref="algx1.l15.m1.1.1.1.1.2.2.2.3.1.cmml">⁢</mo><mi id="algx1.l15.m1.1.1.1.1.2.2.2.3.8" xref="algx1.l15.m1.1.1.1.1.2.2.2.3.8.cmml">r</mi></mrow></msub></mrow><mo id="algx1.l15.m1.1.1.1.1.3" stretchy="false" xref="algx1.l15.m1.1.1.1.1.3.cmml">←</mo><mrow id="algx1.l15.m1.1.1.1.1.4" xref="algx1.l15.m1.1.1.1.1.4.cmml"><mi id="algx1.l15.m1.1.1.1.1.4.2" xref="algx1.l15.m1.1.1.1.1.4.2.cmml">E</mi><mo id="algx1.l15.m1.1.1.1.1.4.1" xref="algx1.l15.m1.1.1.1.1.4.1.cmml">⁢</mo><mi id="algx1.l15.m1.1.1.1.1.4.3" xref="algx1.l15.m1.1.1.1.1.4.3.cmml">n</mi><mo id="algx1.l15.m1.1.1.1.1.4.1a" xref="algx1.l15.m1.1.1.1.1.4.1.cmml">⁢</mo><mi id="algx1.l15.m1.1.1.1.1.4.4" xref="algx1.l15.m1.1.1.1.1.4.4.cmml">c</mi><mo id="algx1.l15.m1.1.1.1.1.4.1b" xref="algx1.l15.m1.1.1.1.1.4.1.cmml">⁢</mo><mi id="algx1.l15.m1.1.1.1.1.4.5" xref="algx1.l15.m1.1.1.1.1.4.5.cmml">o</mi><mo id="algx1.l15.m1.1.1.1.1.4.1c" xref="algx1.l15.m1.1.1.1.1.4.1.cmml">⁢</mo><mi id="algx1.l15.m1.1.1.1.1.4.6" xref="algx1.l15.m1.1.1.1.1.4.6.cmml">d</mi><mo id="algx1.l15.m1.1.1.1.1.4.1d" xref="algx1.l15.m1.1.1.1.1.4.1.cmml">⁢</mo><mi id="algx1.l15.m1.1.1.1.1.4.7" xref="algx1.l15.m1.1.1.1.1.4.7.cmml">e</mi><mo id="algx1.l15.m1.1.1.1.1.4.1e" xref="algx1.l15.m1.1.1.1.1.4.1.cmml">⁢</mo><mi id="algx1.l15.m1.1.1.1.1.4.8" xref="algx1.l15.m1.1.1.1.1.4.8.cmml">r</mi><mo id="algx1.l15.m1.1.1.1.1.4.1f" xref="algx1.l15.m1.1.1.1.1.4.1.cmml">⁢</mo><mi id="algx1.l15.m1.1.1.1.1.4.9" xref="algx1.l15.m1.1.1.1.1.4.9.cmml">O</mi><mo id="algx1.l15.m1.1.1.1.1.4.1g" xref="algx1.l15.m1.1.1.1.1.4.1.cmml">⁢</mo><mi id="algx1.l15.m1.1.1.1.1.4.10" xref="algx1.l15.m1.1.1.1.1.4.10.cmml">u</mi><mo id="algx1.l15.m1.1.1.1.1.4.1h" xref="algx1.l15.m1.1.1.1.1.4.1.cmml">⁢</mo><mi id="algx1.l15.m1.1.1.1.1.4.11" xref="algx1.l15.m1.1.1.1.1.4.11.cmml">t</mi><mo id="algx1.l15.m1.1.1.1.1.4.1i" xref="algx1.l15.m1.1.1.1.1.4.1.cmml">⁢</mo><mi id="algx1.l15.m1.1.1.1.1.4.12" xref="algx1.l15.m1.1.1.1.1.4.12.cmml">p</mi><mo id="algx1.l15.m1.1.1.1.1.4.1j" xref="algx1.l15.m1.1.1.1.1.4.1.cmml">⁢</mo><mi id="algx1.l15.m1.1.1.1.1.4.13" xref="algx1.l15.m1.1.1.1.1.4.13.cmml">u</mi><mo id="algx1.l15.m1.1.1.1.1.4.1k" xref="algx1.l15.m1.1.1.1.1.4.1.cmml">⁢</mo><mi id="algx1.l15.m1.1.1.1.1.4.14" xref="algx1.l15.m1.1.1.1.1.4.14.cmml">t</mi></mrow></mrow><mo id="algx1.l15.m1.2.2.2.3" xref="algx1.l15.m1.2.2.3a.cmml">,</mo><mrow id="algx1.l15.m1.2.2.2.2" xref="algx1.l15.m1.2.2.2.2.cmml"><mi id="algx1.l15.m1.2.2.2.2.2" xref="algx1.l15.m1.2.2.2.2.2.cmml">E</mi><mo id="algx1.l15.m1.2.2.2.2.1" xref="algx1.l15.m1.2.2.2.2.1.cmml">⁢</mo><mi id="algx1.l15.m1.2.2.2.2.3" xref="algx1.l15.m1.2.2.2.2.3.cmml">n</mi><mo id="algx1.l15.m1.2.2.2.2.1a" xref="algx1.l15.m1.2.2.2.2.1.cmml">⁢</mo><mi id="algx1.l15.m1.2.2.2.2.4" xref="algx1.l15.m1.2.2.2.2.4.cmml">c</mi><mo id="algx1.l15.m1.2.2.2.2.1b" xref="algx1.l15.m1.2.2.2.2.1.cmml">⁢</mo><mi id="algx1.l15.m1.2.2.2.2.5" xref="algx1.l15.m1.2.2.2.2.5.cmml">o</mi><mo id="algx1.l15.m1.2.2.2.2.1c" xref="algx1.l15.m1.2.2.2.2.1.cmml">⁢</mo><mi id="algx1.l15.m1.2.2.2.2.6" xref="algx1.l15.m1.2.2.2.2.6.cmml">d</mi><mo id="algx1.l15.m1.2.2.2.2.1d" xref="algx1.l15.m1.2.2.2.2.1.cmml">⁢</mo><mi id="algx1.l15.m1.2.2.2.2.7" xref="algx1.l15.m1.2.2.2.2.7.cmml">e</mi><mo id="algx1.l15.m1.2.2.2.2.1e" xref="algx1.l15.m1.2.2.2.2.1.cmml">⁢</mo><mi id="algx1.l15.m1.2.2.2.2.8" xref="algx1.l15.m1.2.2.2.2.8.cmml">r</mi><mo id="algx1.l15.m1.2.2.2.2.1f" xref="algx1.l15.m1.2.2.2.2.1.cmml">⁢</mo><mi id="algx1.l15.m1.2.2.2.2.9" xref="algx1.l15.m1.2.2.2.2.9.cmml">O</mi><mo id="algx1.l15.m1.2.2.2.2.1g" xref="algx1.l15.m1.2.2.2.2.1.cmml">⁢</mo><mi id="algx1.l15.m1.2.2.2.2.10" xref="algx1.l15.m1.2.2.2.2.10.cmml">u</mi><mo id="algx1.l15.m1.2.2.2.2.1h" xref="algx1.l15.m1.2.2.2.2.1.cmml">⁢</mo><mi id="algx1.l15.m1.2.2.2.2.11" xref="algx1.l15.m1.2.2.2.2.11.cmml">t</mi><mo id="algx1.l15.m1.2.2.2.2.1i" xref="algx1.l15.m1.2.2.2.2.1.cmml">⁢</mo><mi id="algx1.l15.m1.2.2.2.2.12" xref="algx1.l15.m1.2.2.2.2.12.cmml">p</mi><mo id="algx1.l15.m1.2.2.2.2.1j" xref="algx1.l15.m1.2.2.2.2.1.cmml">⁢</mo><mi id="algx1.l15.m1.2.2.2.2.13" xref="algx1.l15.m1.2.2.2.2.13.cmml">u</mi><mo id="algx1.l15.m1.2.2.2.2.1k" xref="algx1.l15.m1.2.2.2.2.1.cmml">⁢</mo><mi id="algx1.l15.m1.2.2.2.2.14" xref="algx1.l15.m1.2.2.2.2.14.cmml">t</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx1.l15.m1.2b"><apply id="algx1.l15.m1.2.2.3.cmml" xref="algx1.l15.m1.2.2.2"><csymbol cd="ambiguous" id="algx1.l15.m1.2.2.3a.cmml" xref="algx1.l15.m1.2.2.2.3">formulae-sequence</csymbol><apply id="algx1.l15.m1.1.1.1.1.cmml" xref="algx1.l15.m1.1.1.1.1"><ci id="algx1.l15.m1.1.1.1.1.3.cmml" xref="algx1.l15.m1.1.1.1.1.3">←</ci><list id="algx1.l15.m1.1.1.1.1.2.3.cmml" xref="algx1.l15.m1.1.1.1.1.2.2"><apply id="algx1.l15.m1.1.1.1.1.1.1.1.cmml" xref="algx1.l15.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algx1.l15.m1.1.1.1.1.1.1.1.1.cmml" xref="algx1.l15.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="algx1.l15.m1.1.1.1.1.1.1.1.2.cmml" xref="algx1.l15.m1.1.1.1.1.1.1.1.2">𝐾</ci><apply id="algx1.l15.m1.1.1.1.1.1.1.1.3.cmml" xref="algx1.l15.m1.1.1.1.1.1.1.1.3"><times id="algx1.l15.m1.1.1.1.1.1.1.1.3.1.cmml" xref="algx1.l15.m1.1.1.1.1.1.1.1.3.1"></times><ci id="algx1.l15.m1.1.1.1.1.1.1.1.3.2.cmml" xref="algx1.l15.m1.1.1.1.1.1.1.1.3.2">𝑑</ci><ci id="algx1.l15.m1.1.1.1.1.1.1.1.3.3.cmml" xref="algx1.l15.m1.1.1.1.1.1.1.1.3.3">𝑒</ci><ci id="algx1.l15.m1.1.1.1.1.1.1.1.3.4.cmml" xref="algx1.l15.m1.1.1.1.1.1.1.1.3.4">𝑐</ci><ci id="algx1.l15.m1.1.1.1.1.1.1.1.3.5.cmml" xref="algx1.l15.m1.1.1.1.1.1.1.1.3.5">𝑜</ci><ci id="algx1.l15.m1.1.1.1.1.1.1.1.3.6.cmml" xref="algx1.l15.m1.1.1.1.1.1.1.1.3.6">𝑑</ci><ci id="algx1.l15.m1.1.1.1.1.1.1.1.3.7.cmml" xref="algx1.l15.m1.1.1.1.1.1.1.1.3.7">𝑒</ci><ci id="algx1.l15.m1.1.1.1.1.1.1.1.3.8.cmml" xref="algx1.l15.m1.1.1.1.1.1.1.1.3.8">𝑟</ci></apply></apply><apply id="algx1.l15.m1.1.1.1.1.2.2.2.cmml" xref="algx1.l15.m1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="algx1.l15.m1.1.1.1.1.2.2.2.1.cmml" xref="algx1.l15.m1.1.1.1.1.2.2.2">subscript</csymbol><ci id="algx1.l15.m1.1.1.1.1.2.2.2.2.cmml" xref="algx1.l15.m1.1.1.1.1.2.2.2.2">𝑉</ci><apply id="algx1.l15.m1.1.1.1.1.2.2.2.3.cmml" xref="algx1.l15.m1.1.1.1.1.2.2.2.3"><times id="algx1.l15.m1.1.1.1.1.2.2.2.3.1.cmml" xref="algx1.l15.m1.1.1.1.1.2.2.2.3.1"></times><ci id="algx1.l15.m1.1.1.1.1.2.2.2.3.2.cmml" xref="algx1.l15.m1.1.1.1.1.2.2.2.3.2">𝑑</ci><ci id="algx1.l15.m1.1.1.1.1.2.2.2.3.3.cmml" xref="algx1.l15.m1.1.1.1.1.2.2.2.3.3">𝑒</ci><ci id="algx1.l15.m1.1.1.1.1.2.2.2.3.4.cmml" xref="algx1.l15.m1.1.1.1.1.2.2.2.3.4">𝑐</ci><ci id="algx1.l15.m1.1.1.1.1.2.2.2.3.5.cmml" xref="algx1.l15.m1.1.1.1.1.2.2.2.3.5">𝑜</ci><ci id="algx1.l15.m1.1.1.1.1.2.2.2.3.6.cmml" xref="algx1.l15.m1.1.1.1.1.2.2.2.3.6">𝑑</ci><ci id="algx1.l15.m1.1.1.1.1.2.2.2.3.7.cmml" xref="algx1.l15.m1.1.1.1.1.2.2.2.3.7">𝑒</ci><ci id="algx1.l15.m1.1.1.1.1.2.2.2.3.8.cmml" xref="algx1.l15.m1.1.1.1.1.2.2.2.3.8">𝑟</ci></apply></apply></list><apply id="algx1.l15.m1.1.1.1.1.4.cmml" xref="algx1.l15.m1.1.1.1.1.4"><times id="algx1.l15.m1.1.1.1.1.4.1.cmml" xref="algx1.l15.m1.1.1.1.1.4.1"></times><ci id="algx1.l15.m1.1.1.1.1.4.2.cmml" xref="algx1.l15.m1.1.1.1.1.4.2">𝐸</ci><ci id="algx1.l15.m1.1.1.1.1.4.3.cmml" xref="algx1.l15.m1.1.1.1.1.4.3">𝑛</ci><ci id="algx1.l15.m1.1.1.1.1.4.4.cmml" xref="algx1.l15.m1.1.1.1.1.4.4">𝑐</ci><ci id="algx1.l15.m1.1.1.1.1.4.5.cmml" xref="algx1.l15.m1.1.1.1.1.4.5">𝑜</ci><ci id="algx1.l15.m1.1.1.1.1.4.6.cmml" xref="algx1.l15.m1.1.1.1.1.4.6">𝑑</ci><ci id="algx1.l15.m1.1.1.1.1.4.7.cmml" xref="algx1.l15.m1.1.1.1.1.4.7">𝑒</ci><ci id="algx1.l15.m1.1.1.1.1.4.8.cmml" xref="algx1.l15.m1.1.1.1.1.4.8">𝑟</ci><ci id="algx1.l15.m1.1.1.1.1.4.9.cmml" xref="algx1.l15.m1.1.1.1.1.4.9">𝑂</ci><ci id="algx1.l15.m1.1.1.1.1.4.10.cmml" xref="algx1.l15.m1.1.1.1.1.4.10">𝑢</ci><ci id="algx1.l15.m1.1.1.1.1.4.11.cmml" xref="algx1.l15.m1.1.1.1.1.4.11">𝑡</ci><ci id="algx1.l15.m1.1.1.1.1.4.12.cmml" xref="algx1.l15.m1.1.1.1.1.4.12">𝑝</ci><ci id="algx1.l15.m1.1.1.1.1.4.13.cmml" xref="algx1.l15.m1.1.1.1.1.4.13">𝑢</ci><ci id="algx1.l15.m1.1.1.1.1.4.14.cmml" xref="algx1.l15.m1.1.1.1.1.4.14">𝑡</ci></apply></apply><apply id="algx1.l15.m1.2.2.2.2.cmml" xref="algx1.l15.m1.2.2.2.2"><times id="algx1.l15.m1.2.2.2.2.1.cmml" xref="algx1.l15.m1.2.2.2.2.1"></times><ci id="algx1.l15.m1.2.2.2.2.2.cmml" xref="algx1.l15.m1.2.2.2.2.2">𝐸</ci><ci id="algx1.l15.m1.2.2.2.2.3.cmml" xref="algx1.l15.m1.2.2.2.2.3">𝑛</ci><ci id="algx1.l15.m1.2.2.2.2.4.cmml" xref="algx1.l15.m1.2.2.2.2.4">𝑐</ci><ci id="algx1.l15.m1.2.2.2.2.5.cmml" xref="algx1.l15.m1.2.2.2.2.5">𝑜</ci><ci id="algx1.l15.m1.2.2.2.2.6.cmml" xref="algx1.l15.m1.2.2.2.2.6">𝑑</ci><ci id="algx1.l15.m1.2.2.2.2.7.cmml" xref="algx1.l15.m1.2.2.2.2.7">𝑒</ci><ci id="algx1.l15.m1.2.2.2.2.8.cmml" xref="algx1.l15.m1.2.2.2.2.8">𝑟</ci><ci id="algx1.l15.m1.2.2.2.2.9.cmml" xref="algx1.l15.m1.2.2.2.2.9">𝑂</ci><ci id="algx1.l15.m1.2.2.2.2.10.cmml" xref="algx1.l15.m1.2.2.2.2.10">𝑢</ci><ci id="algx1.l15.m1.2.2.2.2.11.cmml" xref="algx1.l15.m1.2.2.2.2.11">𝑡</ci><ci id="algx1.l15.m1.2.2.2.2.12.cmml" xref="algx1.l15.m1.2.2.2.2.12">𝑝</ci><ci id="algx1.l15.m1.2.2.2.2.13.cmml" xref="algx1.l15.m1.2.2.2.2.13">𝑢</ci><ci id="algx1.l15.m1.2.2.2.2.14.cmml" xref="algx1.l15.m1.2.2.2.2.14">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l15.m1.2c">K_{decoder},V_{decoder}\leftarrow EncoderOutput,EncoderOutput</annotation><annotation encoding="application/x-llamapun" id="algx1.l15.m1.2d">italic_K start_POSTSUBSCRIPT italic_d italic_e italic_c italic_o italic_d italic_e italic_r end_POSTSUBSCRIPT , italic_V start_POSTSUBSCRIPT italic_d italic_e italic_c italic_o italic_d italic_e italic_r end_POSTSUBSCRIPT ← italic_E italic_n italic_c italic_o italic_d italic_e italic_r italic_O italic_u italic_t italic_p italic_u italic_t , italic_E italic_n italic_c italic_o italic_d italic_e italic_r italic_O italic_u italic_t italic_p italic_u italic_t</annotation></semantics></math> // Use EncoderOutput as K and V

</div>
<div class="ltx_listingline" id="algx1.l16">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algx1.l16.1.1.1" style="font-size:80%;">16:</span></span>  <math alttext="CrossModalAttentionOutput\leftarrow\text{Cross-ModalDataFusionModule}(Q_{%
decoder},K_{decoder},V_{decoder})" class="ltx_Math" display="inline" id="algx1.l16.m1.3"><semantics id="algx1.l16.m1.3a"><mrow id="algx1.l16.m1.3.3" xref="algx1.l16.m1.3.3.cmml"><mrow id="algx1.l16.m1.3.3.5" xref="algx1.l16.m1.3.3.5.cmml"><mi id="algx1.l16.m1.3.3.5.2" xref="algx1.l16.m1.3.3.5.2.cmml">C</mi><mo id="algx1.l16.m1.3.3.5.1" xref="algx1.l16.m1.3.3.5.1.cmml">⁢</mo><mi id="algx1.l16.m1.3.3.5.3" xref="algx1.l16.m1.3.3.5.3.cmml">r</mi><mo id="algx1.l16.m1.3.3.5.1a" xref="algx1.l16.m1.3.3.5.1.cmml">⁢</mo><mi id="algx1.l16.m1.3.3.5.4" xref="algx1.l16.m1.3.3.5.4.cmml">o</mi><mo id="algx1.l16.m1.3.3.5.1b" xref="algx1.l16.m1.3.3.5.1.cmml">⁢</mo><mi id="algx1.l16.m1.3.3.5.5" xref="algx1.l16.m1.3.3.5.5.cmml">s</mi><mo id="algx1.l16.m1.3.3.5.1c" xref="algx1.l16.m1.3.3.5.1.cmml">⁢</mo><mi id="algx1.l16.m1.3.3.5.6" xref="algx1.l16.m1.3.3.5.6.cmml">s</mi><mo id="algx1.l16.m1.3.3.5.1d" xref="algx1.l16.m1.3.3.5.1.cmml">⁢</mo><mi id="algx1.l16.m1.3.3.5.7" xref="algx1.l16.m1.3.3.5.7.cmml">M</mi><mo id="algx1.l16.m1.3.3.5.1e" xref="algx1.l16.m1.3.3.5.1.cmml">⁢</mo><mi id="algx1.l16.m1.3.3.5.8" xref="algx1.l16.m1.3.3.5.8.cmml">o</mi><mo id="algx1.l16.m1.3.3.5.1f" xref="algx1.l16.m1.3.3.5.1.cmml">⁢</mo><mi id="algx1.l16.m1.3.3.5.9" xref="algx1.l16.m1.3.3.5.9.cmml">d</mi><mo id="algx1.l16.m1.3.3.5.1g" xref="algx1.l16.m1.3.3.5.1.cmml">⁢</mo><mi id="algx1.l16.m1.3.3.5.10" xref="algx1.l16.m1.3.3.5.10.cmml">a</mi><mo id="algx1.l16.m1.3.3.5.1h" xref="algx1.l16.m1.3.3.5.1.cmml">⁢</mo><mi id="algx1.l16.m1.3.3.5.11" xref="algx1.l16.m1.3.3.5.11.cmml">l</mi><mo id="algx1.l16.m1.3.3.5.1i" xref="algx1.l16.m1.3.3.5.1.cmml">⁢</mo><mi id="algx1.l16.m1.3.3.5.12" xref="algx1.l16.m1.3.3.5.12.cmml">A</mi><mo id="algx1.l16.m1.3.3.5.1j" xref="algx1.l16.m1.3.3.5.1.cmml">⁢</mo><mi id="algx1.l16.m1.3.3.5.13" xref="algx1.l16.m1.3.3.5.13.cmml">t</mi><mo id="algx1.l16.m1.3.3.5.1k" xref="algx1.l16.m1.3.3.5.1.cmml">⁢</mo><mi id="algx1.l16.m1.3.3.5.14" xref="algx1.l16.m1.3.3.5.14.cmml">t</mi><mo id="algx1.l16.m1.3.3.5.1l" xref="algx1.l16.m1.3.3.5.1.cmml">⁢</mo><mi id="algx1.l16.m1.3.3.5.15" xref="algx1.l16.m1.3.3.5.15.cmml">e</mi><mo id="algx1.l16.m1.3.3.5.1m" xref="algx1.l16.m1.3.3.5.1.cmml">⁢</mo><mi id="algx1.l16.m1.3.3.5.16" xref="algx1.l16.m1.3.3.5.16.cmml">n</mi><mo id="algx1.l16.m1.3.3.5.1n" xref="algx1.l16.m1.3.3.5.1.cmml">⁢</mo><mi id="algx1.l16.m1.3.3.5.17" xref="algx1.l16.m1.3.3.5.17.cmml">t</mi><mo id="algx1.l16.m1.3.3.5.1o" xref="algx1.l16.m1.3.3.5.1.cmml">⁢</mo><mi id="algx1.l16.m1.3.3.5.18" xref="algx1.l16.m1.3.3.5.18.cmml">i</mi><mo id="algx1.l16.m1.3.3.5.1p" xref="algx1.l16.m1.3.3.5.1.cmml">⁢</mo><mi id="algx1.l16.m1.3.3.5.19" xref="algx1.l16.m1.3.3.5.19.cmml">o</mi><mo id="algx1.l16.m1.3.3.5.1q" xref="algx1.l16.m1.3.3.5.1.cmml">⁢</mo><mi id="algx1.l16.m1.3.3.5.20" xref="algx1.l16.m1.3.3.5.20.cmml">n</mi><mo id="algx1.l16.m1.3.3.5.1r" xref="algx1.l16.m1.3.3.5.1.cmml">⁢</mo><mi id="algx1.l16.m1.3.3.5.21" xref="algx1.l16.m1.3.3.5.21.cmml">O</mi><mo id="algx1.l16.m1.3.3.5.1s" xref="algx1.l16.m1.3.3.5.1.cmml">⁢</mo><mi id="algx1.l16.m1.3.3.5.22" xref="algx1.l16.m1.3.3.5.22.cmml">u</mi><mo id="algx1.l16.m1.3.3.5.1t" xref="algx1.l16.m1.3.3.5.1.cmml">⁢</mo><mi id="algx1.l16.m1.3.3.5.23" xref="algx1.l16.m1.3.3.5.23.cmml">t</mi><mo id="algx1.l16.m1.3.3.5.1u" xref="algx1.l16.m1.3.3.5.1.cmml">⁢</mo><mi id="algx1.l16.m1.3.3.5.24" xref="algx1.l16.m1.3.3.5.24.cmml">p</mi><mo id="algx1.l16.m1.3.3.5.1v" xref="algx1.l16.m1.3.3.5.1.cmml">⁢</mo><mi id="algx1.l16.m1.3.3.5.25" xref="algx1.l16.m1.3.3.5.25.cmml">u</mi><mo id="algx1.l16.m1.3.3.5.1w" xref="algx1.l16.m1.3.3.5.1.cmml">⁢</mo><mi id="algx1.l16.m1.3.3.5.26" xref="algx1.l16.m1.3.3.5.26.cmml">t</mi></mrow><mo id="algx1.l16.m1.3.3.4" stretchy="false" xref="algx1.l16.m1.3.3.4.cmml">←</mo><mrow id="algx1.l16.m1.3.3.3" xref="algx1.l16.m1.3.3.3.cmml"><mtext id="algx1.l16.m1.3.3.3.5" xref="algx1.l16.m1.3.3.3.5a.cmml">Cross-ModalDataFusionModule</mtext><mo id="algx1.l16.m1.3.3.3.4" xref="algx1.l16.m1.3.3.3.4.cmml">⁢</mo><mrow id="algx1.l16.m1.3.3.3.3.3" xref="algx1.l16.m1.3.3.3.3.4.cmml"><mo id="algx1.l16.m1.3.3.3.3.3.4" stretchy="false" xref="algx1.l16.m1.3.3.3.3.4.cmml">(</mo><msub id="algx1.l16.m1.1.1.1.1.1.1" xref="algx1.l16.m1.1.1.1.1.1.1.cmml"><mi id="algx1.l16.m1.1.1.1.1.1.1.2" xref="algx1.l16.m1.1.1.1.1.1.1.2.cmml">Q</mi><mrow id="algx1.l16.m1.1.1.1.1.1.1.3" xref="algx1.l16.m1.1.1.1.1.1.1.3.cmml"><mi id="algx1.l16.m1.1.1.1.1.1.1.3.2" xref="algx1.l16.m1.1.1.1.1.1.1.3.2.cmml">d</mi><mo id="algx1.l16.m1.1.1.1.1.1.1.3.1" xref="algx1.l16.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l16.m1.1.1.1.1.1.1.3.3" xref="algx1.l16.m1.1.1.1.1.1.1.3.3.cmml">e</mi><mo id="algx1.l16.m1.1.1.1.1.1.1.3.1a" xref="algx1.l16.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l16.m1.1.1.1.1.1.1.3.4" xref="algx1.l16.m1.1.1.1.1.1.1.3.4.cmml">c</mi><mo id="algx1.l16.m1.1.1.1.1.1.1.3.1b" xref="algx1.l16.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l16.m1.1.1.1.1.1.1.3.5" xref="algx1.l16.m1.1.1.1.1.1.1.3.5.cmml">o</mi><mo id="algx1.l16.m1.1.1.1.1.1.1.3.1c" xref="algx1.l16.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l16.m1.1.1.1.1.1.1.3.6" xref="algx1.l16.m1.1.1.1.1.1.1.3.6.cmml">d</mi><mo id="algx1.l16.m1.1.1.1.1.1.1.3.1d" xref="algx1.l16.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l16.m1.1.1.1.1.1.1.3.7" xref="algx1.l16.m1.1.1.1.1.1.1.3.7.cmml">e</mi><mo id="algx1.l16.m1.1.1.1.1.1.1.3.1e" xref="algx1.l16.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l16.m1.1.1.1.1.1.1.3.8" xref="algx1.l16.m1.1.1.1.1.1.1.3.8.cmml">r</mi></mrow></msub><mo id="algx1.l16.m1.3.3.3.3.3.5" xref="algx1.l16.m1.3.3.3.3.4.cmml">,</mo><msub id="algx1.l16.m1.2.2.2.2.2.2" xref="algx1.l16.m1.2.2.2.2.2.2.cmml"><mi id="algx1.l16.m1.2.2.2.2.2.2.2" xref="algx1.l16.m1.2.2.2.2.2.2.2.cmml">K</mi><mrow id="algx1.l16.m1.2.2.2.2.2.2.3" xref="algx1.l16.m1.2.2.2.2.2.2.3.cmml"><mi id="algx1.l16.m1.2.2.2.2.2.2.3.2" xref="algx1.l16.m1.2.2.2.2.2.2.3.2.cmml">d</mi><mo id="algx1.l16.m1.2.2.2.2.2.2.3.1" xref="algx1.l16.m1.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="algx1.l16.m1.2.2.2.2.2.2.3.3" xref="algx1.l16.m1.2.2.2.2.2.2.3.3.cmml">e</mi><mo id="algx1.l16.m1.2.2.2.2.2.2.3.1a" xref="algx1.l16.m1.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="algx1.l16.m1.2.2.2.2.2.2.3.4" xref="algx1.l16.m1.2.2.2.2.2.2.3.4.cmml">c</mi><mo id="algx1.l16.m1.2.2.2.2.2.2.3.1b" xref="algx1.l16.m1.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="algx1.l16.m1.2.2.2.2.2.2.3.5" xref="algx1.l16.m1.2.2.2.2.2.2.3.5.cmml">o</mi><mo id="algx1.l16.m1.2.2.2.2.2.2.3.1c" xref="algx1.l16.m1.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="algx1.l16.m1.2.2.2.2.2.2.3.6" xref="algx1.l16.m1.2.2.2.2.2.2.3.6.cmml">d</mi><mo id="algx1.l16.m1.2.2.2.2.2.2.3.1d" xref="algx1.l16.m1.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="algx1.l16.m1.2.2.2.2.2.2.3.7" xref="algx1.l16.m1.2.2.2.2.2.2.3.7.cmml">e</mi><mo id="algx1.l16.m1.2.2.2.2.2.2.3.1e" xref="algx1.l16.m1.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="algx1.l16.m1.2.2.2.2.2.2.3.8" xref="algx1.l16.m1.2.2.2.2.2.2.3.8.cmml">r</mi></mrow></msub><mo id="algx1.l16.m1.3.3.3.3.3.6" xref="algx1.l16.m1.3.3.3.3.4.cmml">,</mo><msub id="algx1.l16.m1.3.3.3.3.3.3" xref="algx1.l16.m1.3.3.3.3.3.3.cmml"><mi id="algx1.l16.m1.3.3.3.3.3.3.2" xref="algx1.l16.m1.3.3.3.3.3.3.2.cmml">V</mi><mrow id="algx1.l16.m1.3.3.3.3.3.3.3" xref="algx1.l16.m1.3.3.3.3.3.3.3.cmml"><mi id="algx1.l16.m1.3.3.3.3.3.3.3.2" xref="algx1.l16.m1.3.3.3.3.3.3.3.2.cmml">d</mi><mo id="algx1.l16.m1.3.3.3.3.3.3.3.1" xref="algx1.l16.m1.3.3.3.3.3.3.3.1.cmml">⁢</mo><mi id="algx1.l16.m1.3.3.3.3.3.3.3.3" xref="algx1.l16.m1.3.3.3.3.3.3.3.3.cmml">e</mi><mo id="algx1.l16.m1.3.3.3.3.3.3.3.1a" xref="algx1.l16.m1.3.3.3.3.3.3.3.1.cmml">⁢</mo><mi id="algx1.l16.m1.3.3.3.3.3.3.3.4" xref="algx1.l16.m1.3.3.3.3.3.3.3.4.cmml">c</mi><mo id="algx1.l16.m1.3.3.3.3.3.3.3.1b" xref="algx1.l16.m1.3.3.3.3.3.3.3.1.cmml">⁢</mo><mi id="algx1.l16.m1.3.3.3.3.3.3.3.5" xref="algx1.l16.m1.3.3.3.3.3.3.3.5.cmml">o</mi><mo id="algx1.l16.m1.3.3.3.3.3.3.3.1c" xref="algx1.l16.m1.3.3.3.3.3.3.3.1.cmml">⁢</mo><mi id="algx1.l16.m1.3.3.3.3.3.3.3.6" xref="algx1.l16.m1.3.3.3.3.3.3.3.6.cmml">d</mi><mo id="algx1.l16.m1.3.3.3.3.3.3.3.1d" xref="algx1.l16.m1.3.3.3.3.3.3.3.1.cmml">⁢</mo><mi id="algx1.l16.m1.3.3.3.3.3.3.3.7" xref="algx1.l16.m1.3.3.3.3.3.3.3.7.cmml">e</mi><mo id="algx1.l16.m1.3.3.3.3.3.3.3.1e" xref="algx1.l16.m1.3.3.3.3.3.3.3.1.cmml">⁢</mo><mi id="algx1.l16.m1.3.3.3.3.3.3.3.8" xref="algx1.l16.m1.3.3.3.3.3.3.3.8.cmml">r</mi></mrow></msub><mo id="algx1.l16.m1.3.3.3.3.3.7" stretchy="false" xref="algx1.l16.m1.3.3.3.3.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx1.l16.m1.3b"><apply id="algx1.l16.m1.3.3.cmml" xref="algx1.l16.m1.3.3"><ci id="algx1.l16.m1.3.3.4.cmml" xref="algx1.l16.m1.3.3.4">←</ci><apply id="algx1.l16.m1.3.3.5.cmml" xref="algx1.l16.m1.3.3.5"><times id="algx1.l16.m1.3.3.5.1.cmml" xref="algx1.l16.m1.3.3.5.1"></times><ci id="algx1.l16.m1.3.3.5.2.cmml" xref="algx1.l16.m1.3.3.5.2">𝐶</ci><ci id="algx1.l16.m1.3.3.5.3.cmml" xref="algx1.l16.m1.3.3.5.3">𝑟</ci><ci id="algx1.l16.m1.3.3.5.4.cmml" xref="algx1.l16.m1.3.3.5.4">𝑜</ci><ci id="algx1.l16.m1.3.3.5.5.cmml" xref="algx1.l16.m1.3.3.5.5">𝑠</ci><ci id="algx1.l16.m1.3.3.5.6.cmml" xref="algx1.l16.m1.3.3.5.6">𝑠</ci><ci id="algx1.l16.m1.3.3.5.7.cmml" xref="algx1.l16.m1.3.3.5.7">𝑀</ci><ci id="algx1.l16.m1.3.3.5.8.cmml" xref="algx1.l16.m1.3.3.5.8">𝑜</ci><ci id="algx1.l16.m1.3.3.5.9.cmml" xref="algx1.l16.m1.3.3.5.9">𝑑</ci><ci id="algx1.l16.m1.3.3.5.10.cmml" xref="algx1.l16.m1.3.3.5.10">𝑎</ci><ci id="algx1.l16.m1.3.3.5.11.cmml" xref="algx1.l16.m1.3.3.5.11">𝑙</ci><ci id="algx1.l16.m1.3.3.5.12.cmml" xref="algx1.l16.m1.3.3.5.12">𝐴</ci><ci id="algx1.l16.m1.3.3.5.13.cmml" xref="algx1.l16.m1.3.3.5.13">𝑡</ci><ci id="algx1.l16.m1.3.3.5.14.cmml" xref="algx1.l16.m1.3.3.5.14">𝑡</ci><ci id="algx1.l16.m1.3.3.5.15.cmml" xref="algx1.l16.m1.3.3.5.15">𝑒</ci><ci id="algx1.l16.m1.3.3.5.16.cmml" xref="algx1.l16.m1.3.3.5.16">𝑛</ci><ci id="algx1.l16.m1.3.3.5.17.cmml" xref="algx1.l16.m1.3.3.5.17">𝑡</ci><ci id="algx1.l16.m1.3.3.5.18.cmml" xref="algx1.l16.m1.3.3.5.18">𝑖</ci><ci id="algx1.l16.m1.3.3.5.19.cmml" xref="algx1.l16.m1.3.3.5.19">𝑜</ci><ci id="algx1.l16.m1.3.3.5.20.cmml" xref="algx1.l16.m1.3.3.5.20">𝑛</ci><ci id="algx1.l16.m1.3.3.5.21.cmml" xref="algx1.l16.m1.3.3.5.21">𝑂</ci><ci id="algx1.l16.m1.3.3.5.22.cmml" xref="algx1.l16.m1.3.3.5.22">𝑢</ci><ci id="algx1.l16.m1.3.3.5.23.cmml" xref="algx1.l16.m1.3.3.5.23">𝑡</ci><ci id="algx1.l16.m1.3.3.5.24.cmml" xref="algx1.l16.m1.3.3.5.24">𝑝</ci><ci id="algx1.l16.m1.3.3.5.25.cmml" xref="algx1.l16.m1.3.3.5.25">𝑢</ci><ci id="algx1.l16.m1.3.3.5.26.cmml" xref="algx1.l16.m1.3.3.5.26">𝑡</ci></apply><apply id="algx1.l16.m1.3.3.3.cmml" xref="algx1.l16.m1.3.3.3"><times id="algx1.l16.m1.3.3.3.4.cmml" xref="algx1.l16.m1.3.3.3.4"></times><ci id="algx1.l16.m1.3.3.3.5a.cmml" xref="algx1.l16.m1.3.3.3.5"><mtext id="algx1.l16.m1.3.3.3.5.cmml" xref="algx1.l16.m1.3.3.3.5">Cross-ModalDataFusionModule</mtext></ci><vector id="algx1.l16.m1.3.3.3.3.4.cmml" xref="algx1.l16.m1.3.3.3.3.3"><apply id="algx1.l16.m1.1.1.1.1.1.1.cmml" xref="algx1.l16.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algx1.l16.m1.1.1.1.1.1.1.1.cmml" xref="algx1.l16.m1.1.1.1.1.1.1">subscript</csymbol><ci id="algx1.l16.m1.1.1.1.1.1.1.2.cmml" xref="algx1.l16.m1.1.1.1.1.1.1.2">𝑄</ci><apply id="algx1.l16.m1.1.1.1.1.1.1.3.cmml" xref="algx1.l16.m1.1.1.1.1.1.1.3"><times id="algx1.l16.m1.1.1.1.1.1.1.3.1.cmml" xref="algx1.l16.m1.1.1.1.1.1.1.3.1"></times><ci id="algx1.l16.m1.1.1.1.1.1.1.3.2.cmml" xref="algx1.l16.m1.1.1.1.1.1.1.3.2">𝑑</ci><ci id="algx1.l16.m1.1.1.1.1.1.1.3.3.cmml" xref="algx1.l16.m1.1.1.1.1.1.1.3.3">𝑒</ci><ci id="algx1.l16.m1.1.1.1.1.1.1.3.4.cmml" xref="algx1.l16.m1.1.1.1.1.1.1.3.4">𝑐</ci><ci id="algx1.l16.m1.1.1.1.1.1.1.3.5.cmml" xref="algx1.l16.m1.1.1.1.1.1.1.3.5">𝑜</ci><ci id="algx1.l16.m1.1.1.1.1.1.1.3.6.cmml" xref="algx1.l16.m1.1.1.1.1.1.1.3.6">𝑑</ci><ci id="algx1.l16.m1.1.1.1.1.1.1.3.7.cmml" xref="algx1.l16.m1.1.1.1.1.1.1.3.7">𝑒</ci><ci id="algx1.l16.m1.1.1.1.1.1.1.3.8.cmml" xref="algx1.l16.m1.1.1.1.1.1.1.3.8">𝑟</ci></apply></apply><apply id="algx1.l16.m1.2.2.2.2.2.2.cmml" xref="algx1.l16.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="algx1.l16.m1.2.2.2.2.2.2.1.cmml" xref="algx1.l16.m1.2.2.2.2.2.2">subscript</csymbol><ci id="algx1.l16.m1.2.2.2.2.2.2.2.cmml" xref="algx1.l16.m1.2.2.2.2.2.2.2">𝐾</ci><apply id="algx1.l16.m1.2.2.2.2.2.2.3.cmml" xref="algx1.l16.m1.2.2.2.2.2.2.3"><times id="algx1.l16.m1.2.2.2.2.2.2.3.1.cmml" xref="algx1.l16.m1.2.2.2.2.2.2.3.1"></times><ci id="algx1.l16.m1.2.2.2.2.2.2.3.2.cmml" xref="algx1.l16.m1.2.2.2.2.2.2.3.2">𝑑</ci><ci id="algx1.l16.m1.2.2.2.2.2.2.3.3.cmml" xref="algx1.l16.m1.2.2.2.2.2.2.3.3">𝑒</ci><ci id="algx1.l16.m1.2.2.2.2.2.2.3.4.cmml" xref="algx1.l16.m1.2.2.2.2.2.2.3.4">𝑐</ci><ci id="algx1.l16.m1.2.2.2.2.2.2.3.5.cmml" xref="algx1.l16.m1.2.2.2.2.2.2.3.5">𝑜</ci><ci id="algx1.l16.m1.2.2.2.2.2.2.3.6.cmml" xref="algx1.l16.m1.2.2.2.2.2.2.3.6">𝑑</ci><ci id="algx1.l16.m1.2.2.2.2.2.2.3.7.cmml" xref="algx1.l16.m1.2.2.2.2.2.2.3.7">𝑒</ci><ci id="algx1.l16.m1.2.2.2.2.2.2.3.8.cmml" xref="algx1.l16.m1.2.2.2.2.2.2.3.8">𝑟</ci></apply></apply><apply id="algx1.l16.m1.3.3.3.3.3.3.cmml" xref="algx1.l16.m1.3.3.3.3.3.3"><csymbol cd="ambiguous" id="algx1.l16.m1.3.3.3.3.3.3.1.cmml" xref="algx1.l16.m1.3.3.3.3.3.3">subscript</csymbol><ci id="algx1.l16.m1.3.3.3.3.3.3.2.cmml" xref="algx1.l16.m1.3.3.3.3.3.3.2">𝑉</ci><apply id="algx1.l16.m1.3.3.3.3.3.3.3.cmml" xref="algx1.l16.m1.3.3.3.3.3.3.3"><times id="algx1.l16.m1.3.3.3.3.3.3.3.1.cmml" xref="algx1.l16.m1.3.3.3.3.3.3.3.1"></times><ci id="algx1.l16.m1.3.3.3.3.3.3.3.2.cmml" xref="algx1.l16.m1.3.3.3.3.3.3.3.2">𝑑</ci><ci id="algx1.l16.m1.3.3.3.3.3.3.3.3.cmml" xref="algx1.l16.m1.3.3.3.3.3.3.3.3">𝑒</ci><ci id="algx1.l16.m1.3.3.3.3.3.3.3.4.cmml" xref="algx1.l16.m1.3.3.3.3.3.3.3.4">𝑐</ci><ci id="algx1.l16.m1.3.3.3.3.3.3.3.5.cmml" xref="algx1.l16.m1.3.3.3.3.3.3.3.5">𝑜</ci><ci id="algx1.l16.m1.3.3.3.3.3.3.3.6.cmml" xref="algx1.l16.m1.3.3.3.3.3.3.3.6">𝑑</ci><ci id="algx1.l16.m1.3.3.3.3.3.3.3.7.cmml" xref="algx1.l16.m1.3.3.3.3.3.3.3.7">𝑒</ci><ci id="algx1.l16.m1.3.3.3.3.3.3.3.8.cmml" xref="algx1.l16.m1.3.3.3.3.3.3.3.8">𝑟</ci></apply></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l16.m1.3c">CrossModalAttentionOutput\leftarrow\text{Cross-ModalDataFusionModule}(Q_{%
decoder},K_{decoder},V_{decoder})</annotation><annotation encoding="application/x-llamapun" id="algx1.l16.m1.3d">italic_C italic_r italic_o italic_s italic_s italic_M italic_o italic_d italic_a italic_l italic_A italic_t italic_t italic_e italic_n italic_t italic_i italic_o italic_n italic_O italic_u italic_t italic_p italic_u italic_t ← Cross-ModalDataFusionModule ( italic_Q start_POSTSUBSCRIPT italic_d italic_e italic_c italic_o italic_d italic_e italic_r end_POSTSUBSCRIPT , italic_K start_POSTSUBSCRIPT italic_d italic_e italic_c italic_o italic_d italic_e italic_r end_POSTSUBSCRIPT , italic_V start_POSTSUBSCRIPT italic_d italic_e italic_c italic_o italic_d italic_e italic_r end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algx1.l17">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algx1.l17.1.1.1" style="font-size:80%;">17:</span></span>  <math alttext="LastVector\leftarrow\text{TakeLastVector}(CrossModalAttentionOutput)" class="ltx_Math" display="inline" id="algx1.l17.m1.1"><semantics id="algx1.l17.m1.1a"><mrow id="algx1.l17.m1.1.1" xref="algx1.l17.m1.1.1.cmml"><mrow id="algx1.l17.m1.1.1.3" xref="algx1.l17.m1.1.1.3.cmml"><mi id="algx1.l17.m1.1.1.3.2" xref="algx1.l17.m1.1.1.3.2.cmml">L</mi><mo id="algx1.l17.m1.1.1.3.1" xref="algx1.l17.m1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l17.m1.1.1.3.3" xref="algx1.l17.m1.1.1.3.3.cmml">a</mi><mo id="algx1.l17.m1.1.1.3.1a" xref="algx1.l17.m1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l17.m1.1.1.3.4" xref="algx1.l17.m1.1.1.3.4.cmml">s</mi><mo id="algx1.l17.m1.1.1.3.1b" xref="algx1.l17.m1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l17.m1.1.1.3.5" xref="algx1.l17.m1.1.1.3.5.cmml">t</mi><mo id="algx1.l17.m1.1.1.3.1c" xref="algx1.l17.m1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l17.m1.1.1.3.6" xref="algx1.l17.m1.1.1.3.6.cmml">V</mi><mo id="algx1.l17.m1.1.1.3.1d" xref="algx1.l17.m1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l17.m1.1.1.3.7" xref="algx1.l17.m1.1.1.3.7.cmml">e</mi><mo id="algx1.l17.m1.1.1.3.1e" xref="algx1.l17.m1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l17.m1.1.1.3.8" xref="algx1.l17.m1.1.1.3.8.cmml">c</mi><mo id="algx1.l17.m1.1.1.3.1f" xref="algx1.l17.m1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l17.m1.1.1.3.9" xref="algx1.l17.m1.1.1.3.9.cmml">t</mi><mo id="algx1.l17.m1.1.1.3.1g" xref="algx1.l17.m1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l17.m1.1.1.3.10" xref="algx1.l17.m1.1.1.3.10.cmml">o</mi><mo id="algx1.l17.m1.1.1.3.1h" xref="algx1.l17.m1.1.1.3.1.cmml">⁢</mo><mi id="algx1.l17.m1.1.1.3.11" xref="algx1.l17.m1.1.1.3.11.cmml">r</mi></mrow><mo id="algx1.l17.m1.1.1.2" stretchy="false" xref="algx1.l17.m1.1.1.2.cmml">←</mo><mrow id="algx1.l17.m1.1.1.1" xref="algx1.l17.m1.1.1.1.cmml"><mtext id="algx1.l17.m1.1.1.1.3" xref="algx1.l17.m1.1.1.1.3a.cmml">TakeLastVector</mtext><mo id="algx1.l17.m1.1.1.1.2" xref="algx1.l17.m1.1.1.1.2.cmml">⁢</mo><mrow id="algx1.l17.m1.1.1.1.1.1" xref="algx1.l17.m1.1.1.1.1.1.1.cmml"><mo id="algx1.l17.m1.1.1.1.1.1.2" stretchy="false" xref="algx1.l17.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="algx1.l17.m1.1.1.1.1.1.1" xref="algx1.l17.m1.1.1.1.1.1.1.cmml"><mi id="algx1.l17.m1.1.1.1.1.1.1.2" xref="algx1.l17.m1.1.1.1.1.1.1.2.cmml">C</mi><mo id="algx1.l17.m1.1.1.1.1.1.1.1" xref="algx1.l17.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l17.m1.1.1.1.1.1.1.3" xref="algx1.l17.m1.1.1.1.1.1.1.3.cmml">r</mi><mo id="algx1.l17.m1.1.1.1.1.1.1.1a" xref="algx1.l17.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l17.m1.1.1.1.1.1.1.4" xref="algx1.l17.m1.1.1.1.1.1.1.4.cmml">o</mi><mo id="algx1.l17.m1.1.1.1.1.1.1.1b" xref="algx1.l17.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l17.m1.1.1.1.1.1.1.5" xref="algx1.l17.m1.1.1.1.1.1.1.5.cmml">s</mi><mo id="algx1.l17.m1.1.1.1.1.1.1.1c" xref="algx1.l17.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l17.m1.1.1.1.1.1.1.6" xref="algx1.l17.m1.1.1.1.1.1.1.6.cmml">s</mi><mo id="algx1.l17.m1.1.1.1.1.1.1.1d" xref="algx1.l17.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l17.m1.1.1.1.1.1.1.7" xref="algx1.l17.m1.1.1.1.1.1.1.7.cmml">M</mi><mo id="algx1.l17.m1.1.1.1.1.1.1.1e" xref="algx1.l17.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l17.m1.1.1.1.1.1.1.8" xref="algx1.l17.m1.1.1.1.1.1.1.8.cmml">o</mi><mo id="algx1.l17.m1.1.1.1.1.1.1.1f" xref="algx1.l17.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l17.m1.1.1.1.1.1.1.9" xref="algx1.l17.m1.1.1.1.1.1.1.9.cmml">d</mi><mo id="algx1.l17.m1.1.1.1.1.1.1.1g" xref="algx1.l17.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l17.m1.1.1.1.1.1.1.10" xref="algx1.l17.m1.1.1.1.1.1.1.10.cmml">a</mi><mo id="algx1.l17.m1.1.1.1.1.1.1.1h" xref="algx1.l17.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l17.m1.1.1.1.1.1.1.11" xref="algx1.l17.m1.1.1.1.1.1.1.11.cmml">l</mi><mo id="algx1.l17.m1.1.1.1.1.1.1.1i" xref="algx1.l17.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l17.m1.1.1.1.1.1.1.12" xref="algx1.l17.m1.1.1.1.1.1.1.12.cmml">A</mi><mo id="algx1.l17.m1.1.1.1.1.1.1.1j" xref="algx1.l17.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l17.m1.1.1.1.1.1.1.13" xref="algx1.l17.m1.1.1.1.1.1.1.13.cmml">t</mi><mo id="algx1.l17.m1.1.1.1.1.1.1.1k" xref="algx1.l17.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l17.m1.1.1.1.1.1.1.14" xref="algx1.l17.m1.1.1.1.1.1.1.14.cmml">t</mi><mo id="algx1.l17.m1.1.1.1.1.1.1.1l" xref="algx1.l17.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l17.m1.1.1.1.1.1.1.15" xref="algx1.l17.m1.1.1.1.1.1.1.15.cmml">e</mi><mo id="algx1.l17.m1.1.1.1.1.1.1.1m" xref="algx1.l17.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l17.m1.1.1.1.1.1.1.16" xref="algx1.l17.m1.1.1.1.1.1.1.16.cmml">n</mi><mo id="algx1.l17.m1.1.1.1.1.1.1.1n" xref="algx1.l17.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l17.m1.1.1.1.1.1.1.17" xref="algx1.l17.m1.1.1.1.1.1.1.17.cmml">t</mi><mo id="algx1.l17.m1.1.1.1.1.1.1.1o" xref="algx1.l17.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l17.m1.1.1.1.1.1.1.18" xref="algx1.l17.m1.1.1.1.1.1.1.18.cmml">i</mi><mo id="algx1.l17.m1.1.1.1.1.1.1.1p" xref="algx1.l17.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l17.m1.1.1.1.1.1.1.19" xref="algx1.l17.m1.1.1.1.1.1.1.19.cmml">o</mi><mo id="algx1.l17.m1.1.1.1.1.1.1.1q" xref="algx1.l17.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l17.m1.1.1.1.1.1.1.20" xref="algx1.l17.m1.1.1.1.1.1.1.20.cmml">n</mi><mo id="algx1.l17.m1.1.1.1.1.1.1.1r" xref="algx1.l17.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l17.m1.1.1.1.1.1.1.21" xref="algx1.l17.m1.1.1.1.1.1.1.21.cmml">O</mi><mo id="algx1.l17.m1.1.1.1.1.1.1.1s" xref="algx1.l17.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l17.m1.1.1.1.1.1.1.22" xref="algx1.l17.m1.1.1.1.1.1.1.22.cmml">u</mi><mo id="algx1.l17.m1.1.1.1.1.1.1.1t" xref="algx1.l17.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l17.m1.1.1.1.1.1.1.23" xref="algx1.l17.m1.1.1.1.1.1.1.23.cmml">t</mi><mo id="algx1.l17.m1.1.1.1.1.1.1.1u" xref="algx1.l17.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l17.m1.1.1.1.1.1.1.24" xref="algx1.l17.m1.1.1.1.1.1.1.24.cmml">p</mi><mo id="algx1.l17.m1.1.1.1.1.1.1.1v" xref="algx1.l17.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l17.m1.1.1.1.1.1.1.25" xref="algx1.l17.m1.1.1.1.1.1.1.25.cmml">u</mi><mo id="algx1.l17.m1.1.1.1.1.1.1.1w" xref="algx1.l17.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l17.m1.1.1.1.1.1.1.26" xref="algx1.l17.m1.1.1.1.1.1.1.26.cmml">t</mi></mrow><mo id="algx1.l17.m1.1.1.1.1.1.3" stretchy="false" xref="algx1.l17.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx1.l17.m1.1b"><apply id="algx1.l17.m1.1.1.cmml" xref="algx1.l17.m1.1.1"><ci id="algx1.l17.m1.1.1.2.cmml" xref="algx1.l17.m1.1.1.2">←</ci><apply id="algx1.l17.m1.1.1.3.cmml" xref="algx1.l17.m1.1.1.3"><times id="algx1.l17.m1.1.1.3.1.cmml" xref="algx1.l17.m1.1.1.3.1"></times><ci id="algx1.l17.m1.1.1.3.2.cmml" xref="algx1.l17.m1.1.1.3.2">𝐿</ci><ci id="algx1.l17.m1.1.1.3.3.cmml" xref="algx1.l17.m1.1.1.3.3">𝑎</ci><ci id="algx1.l17.m1.1.1.3.4.cmml" xref="algx1.l17.m1.1.1.3.4">𝑠</ci><ci id="algx1.l17.m1.1.1.3.5.cmml" xref="algx1.l17.m1.1.1.3.5">𝑡</ci><ci id="algx1.l17.m1.1.1.3.6.cmml" xref="algx1.l17.m1.1.1.3.6">𝑉</ci><ci id="algx1.l17.m1.1.1.3.7.cmml" xref="algx1.l17.m1.1.1.3.7">𝑒</ci><ci id="algx1.l17.m1.1.1.3.8.cmml" xref="algx1.l17.m1.1.1.3.8">𝑐</ci><ci id="algx1.l17.m1.1.1.3.9.cmml" xref="algx1.l17.m1.1.1.3.9">𝑡</ci><ci id="algx1.l17.m1.1.1.3.10.cmml" xref="algx1.l17.m1.1.1.3.10">𝑜</ci><ci id="algx1.l17.m1.1.1.3.11.cmml" xref="algx1.l17.m1.1.1.3.11">𝑟</ci></apply><apply id="algx1.l17.m1.1.1.1.cmml" xref="algx1.l17.m1.1.1.1"><times id="algx1.l17.m1.1.1.1.2.cmml" xref="algx1.l17.m1.1.1.1.2"></times><ci id="algx1.l17.m1.1.1.1.3a.cmml" xref="algx1.l17.m1.1.1.1.3"><mtext id="algx1.l17.m1.1.1.1.3.cmml" xref="algx1.l17.m1.1.1.1.3">TakeLastVector</mtext></ci><apply id="algx1.l17.m1.1.1.1.1.1.1.cmml" xref="algx1.l17.m1.1.1.1.1.1"><times id="algx1.l17.m1.1.1.1.1.1.1.1.cmml" xref="algx1.l17.m1.1.1.1.1.1.1.1"></times><ci id="algx1.l17.m1.1.1.1.1.1.1.2.cmml" xref="algx1.l17.m1.1.1.1.1.1.1.2">𝐶</ci><ci id="algx1.l17.m1.1.1.1.1.1.1.3.cmml" xref="algx1.l17.m1.1.1.1.1.1.1.3">𝑟</ci><ci id="algx1.l17.m1.1.1.1.1.1.1.4.cmml" xref="algx1.l17.m1.1.1.1.1.1.1.4">𝑜</ci><ci id="algx1.l17.m1.1.1.1.1.1.1.5.cmml" xref="algx1.l17.m1.1.1.1.1.1.1.5">𝑠</ci><ci id="algx1.l17.m1.1.1.1.1.1.1.6.cmml" xref="algx1.l17.m1.1.1.1.1.1.1.6">𝑠</ci><ci id="algx1.l17.m1.1.1.1.1.1.1.7.cmml" xref="algx1.l17.m1.1.1.1.1.1.1.7">𝑀</ci><ci id="algx1.l17.m1.1.1.1.1.1.1.8.cmml" xref="algx1.l17.m1.1.1.1.1.1.1.8">𝑜</ci><ci id="algx1.l17.m1.1.1.1.1.1.1.9.cmml" xref="algx1.l17.m1.1.1.1.1.1.1.9">𝑑</ci><ci id="algx1.l17.m1.1.1.1.1.1.1.10.cmml" xref="algx1.l17.m1.1.1.1.1.1.1.10">𝑎</ci><ci id="algx1.l17.m1.1.1.1.1.1.1.11.cmml" xref="algx1.l17.m1.1.1.1.1.1.1.11">𝑙</ci><ci id="algx1.l17.m1.1.1.1.1.1.1.12.cmml" xref="algx1.l17.m1.1.1.1.1.1.1.12">𝐴</ci><ci id="algx1.l17.m1.1.1.1.1.1.1.13.cmml" xref="algx1.l17.m1.1.1.1.1.1.1.13">𝑡</ci><ci id="algx1.l17.m1.1.1.1.1.1.1.14.cmml" xref="algx1.l17.m1.1.1.1.1.1.1.14">𝑡</ci><ci id="algx1.l17.m1.1.1.1.1.1.1.15.cmml" xref="algx1.l17.m1.1.1.1.1.1.1.15">𝑒</ci><ci id="algx1.l17.m1.1.1.1.1.1.1.16.cmml" xref="algx1.l17.m1.1.1.1.1.1.1.16">𝑛</ci><ci id="algx1.l17.m1.1.1.1.1.1.1.17.cmml" xref="algx1.l17.m1.1.1.1.1.1.1.17">𝑡</ci><ci id="algx1.l17.m1.1.1.1.1.1.1.18.cmml" xref="algx1.l17.m1.1.1.1.1.1.1.18">𝑖</ci><ci id="algx1.l17.m1.1.1.1.1.1.1.19.cmml" xref="algx1.l17.m1.1.1.1.1.1.1.19">𝑜</ci><ci id="algx1.l17.m1.1.1.1.1.1.1.20.cmml" xref="algx1.l17.m1.1.1.1.1.1.1.20">𝑛</ci><ci id="algx1.l17.m1.1.1.1.1.1.1.21.cmml" xref="algx1.l17.m1.1.1.1.1.1.1.21">𝑂</ci><ci id="algx1.l17.m1.1.1.1.1.1.1.22.cmml" xref="algx1.l17.m1.1.1.1.1.1.1.22">𝑢</ci><ci id="algx1.l17.m1.1.1.1.1.1.1.23.cmml" xref="algx1.l17.m1.1.1.1.1.1.1.23">𝑡</ci><ci id="algx1.l17.m1.1.1.1.1.1.1.24.cmml" xref="algx1.l17.m1.1.1.1.1.1.1.24">𝑝</ci><ci id="algx1.l17.m1.1.1.1.1.1.1.25.cmml" xref="algx1.l17.m1.1.1.1.1.1.1.25">𝑢</ci><ci id="algx1.l17.m1.1.1.1.1.1.1.26.cmml" xref="algx1.l17.m1.1.1.1.1.1.1.26">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l17.m1.1c">LastVector\leftarrow\text{TakeLastVector}(CrossModalAttentionOutput)</annotation><annotation encoding="application/x-llamapun" id="algx1.l17.m1.1d">italic_L italic_a italic_s italic_t italic_V italic_e italic_c italic_t italic_o italic_r ← TakeLastVector ( italic_C italic_r italic_o italic_s italic_s italic_M italic_o italic_d italic_a italic_l italic_A italic_t italic_t italic_e italic_n italic_t italic_i italic_o italic_n italic_O italic_u italic_t italic_p italic_u italic_t )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algx1.l18">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algx1.l18.1.1.1" style="font-size:80%;">18:</span></span>  <math alttext="Y\leftarrow\text{LinearTransform}(LastVector)" class="ltx_Math" display="inline" id="algx1.l18.m1.1"><semantics id="algx1.l18.m1.1a"><mrow id="algx1.l18.m1.1.1" xref="algx1.l18.m1.1.1.cmml"><mi id="algx1.l18.m1.1.1.3" xref="algx1.l18.m1.1.1.3.cmml">Y</mi><mo id="algx1.l18.m1.1.1.2" stretchy="false" xref="algx1.l18.m1.1.1.2.cmml">←</mo><mrow id="algx1.l18.m1.1.1.1" xref="algx1.l18.m1.1.1.1.cmml"><mtext id="algx1.l18.m1.1.1.1.3" xref="algx1.l18.m1.1.1.1.3a.cmml">LinearTransform</mtext><mo id="algx1.l18.m1.1.1.1.2" xref="algx1.l18.m1.1.1.1.2.cmml">⁢</mo><mrow id="algx1.l18.m1.1.1.1.1.1" xref="algx1.l18.m1.1.1.1.1.1.1.cmml"><mo id="algx1.l18.m1.1.1.1.1.1.2" stretchy="false" xref="algx1.l18.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="algx1.l18.m1.1.1.1.1.1.1" xref="algx1.l18.m1.1.1.1.1.1.1.cmml"><mi id="algx1.l18.m1.1.1.1.1.1.1.2" xref="algx1.l18.m1.1.1.1.1.1.1.2.cmml">L</mi><mo id="algx1.l18.m1.1.1.1.1.1.1.1" xref="algx1.l18.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l18.m1.1.1.1.1.1.1.3" xref="algx1.l18.m1.1.1.1.1.1.1.3.cmml">a</mi><mo id="algx1.l18.m1.1.1.1.1.1.1.1a" xref="algx1.l18.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l18.m1.1.1.1.1.1.1.4" xref="algx1.l18.m1.1.1.1.1.1.1.4.cmml">s</mi><mo id="algx1.l18.m1.1.1.1.1.1.1.1b" xref="algx1.l18.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l18.m1.1.1.1.1.1.1.5" xref="algx1.l18.m1.1.1.1.1.1.1.5.cmml">t</mi><mo id="algx1.l18.m1.1.1.1.1.1.1.1c" xref="algx1.l18.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l18.m1.1.1.1.1.1.1.6" xref="algx1.l18.m1.1.1.1.1.1.1.6.cmml">V</mi><mo id="algx1.l18.m1.1.1.1.1.1.1.1d" xref="algx1.l18.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l18.m1.1.1.1.1.1.1.7" xref="algx1.l18.m1.1.1.1.1.1.1.7.cmml">e</mi><mo id="algx1.l18.m1.1.1.1.1.1.1.1e" xref="algx1.l18.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l18.m1.1.1.1.1.1.1.8" xref="algx1.l18.m1.1.1.1.1.1.1.8.cmml">c</mi><mo id="algx1.l18.m1.1.1.1.1.1.1.1f" xref="algx1.l18.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l18.m1.1.1.1.1.1.1.9" xref="algx1.l18.m1.1.1.1.1.1.1.9.cmml">t</mi><mo id="algx1.l18.m1.1.1.1.1.1.1.1g" xref="algx1.l18.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l18.m1.1.1.1.1.1.1.10" xref="algx1.l18.m1.1.1.1.1.1.1.10.cmml">o</mi><mo id="algx1.l18.m1.1.1.1.1.1.1.1h" xref="algx1.l18.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx1.l18.m1.1.1.1.1.1.1.11" xref="algx1.l18.m1.1.1.1.1.1.1.11.cmml">r</mi></mrow><mo id="algx1.l18.m1.1.1.1.1.1.3" stretchy="false" xref="algx1.l18.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx1.l18.m1.1b"><apply id="algx1.l18.m1.1.1.cmml" xref="algx1.l18.m1.1.1"><ci id="algx1.l18.m1.1.1.2.cmml" xref="algx1.l18.m1.1.1.2">←</ci><ci id="algx1.l18.m1.1.1.3.cmml" xref="algx1.l18.m1.1.1.3">𝑌</ci><apply id="algx1.l18.m1.1.1.1.cmml" xref="algx1.l18.m1.1.1.1"><times id="algx1.l18.m1.1.1.1.2.cmml" xref="algx1.l18.m1.1.1.1.2"></times><ci id="algx1.l18.m1.1.1.1.3a.cmml" xref="algx1.l18.m1.1.1.1.3"><mtext id="algx1.l18.m1.1.1.1.3.cmml" xref="algx1.l18.m1.1.1.1.3">LinearTransform</mtext></ci><apply id="algx1.l18.m1.1.1.1.1.1.1.cmml" xref="algx1.l18.m1.1.1.1.1.1"><times id="algx1.l18.m1.1.1.1.1.1.1.1.cmml" xref="algx1.l18.m1.1.1.1.1.1.1.1"></times><ci id="algx1.l18.m1.1.1.1.1.1.1.2.cmml" xref="algx1.l18.m1.1.1.1.1.1.1.2">𝐿</ci><ci id="algx1.l18.m1.1.1.1.1.1.1.3.cmml" xref="algx1.l18.m1.1.1.1.1.1.1.3">𝑎</ci><ci id="algx1.l18.m1.1.1.1.1.1.1.4.cmml" xref="algx1.l18.m1.1.1.1.1.1.1.4">𝑠</ci><ci id="algx1.l18.m1.1.1.1.1.1.1.5.cmml" xref="algx1.l18.m1.1.1.1.1.1.1.5">𝑡</ci><ci id="algx1.l18.m1.1.1.1.1.1.1.6.cmml" xref="algx1.l18.m1.1.1.1.1.1.1.6">𝑉</ci><ci id="algx1.l18.m1.1.1.1.1.1.1.7.cmml" xref="algx1.l18.m1.1.1.1.1.1.1.7">𝑒</ci><ci id="algx1.l18.m1.1.1.1.1.1.1.8.cmml" xref="algx1.l18.m1.1.1.1.1.1.1.8">𝑐</ci><ci id="algx1.l18.m1.1.1.1.1.1.1.9.cmml" xref="algx1.l18.m1.1.1.1.1.1.1.9">𝑡</ci><ci id="algx1.l18.m1.1.1.1.1.1.1.10.cmml" xref="algx1.l18.m1.1.1.1.1.1.1.10">𝑜</ci><ci id="algx1.l18.m1.1.1.1.1.1.1.11.cmml" xref="algx1.l18.m1.1.1.1.1.1.1.11">𝑟</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l18.m1.1c">Y\leftarrow\text{LinearTransform}(LastVector)</annotation><annotation encoding="application/x-llamapun" id="algx1.l18.m1.1d">italic_Y ← LinearTransform ( italic_L italic_a italic_s italic_t italic_V italic_e italic_c italic_t italic_o italic_r )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algx1.l19">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algx1.l19.1.1.1" style="font-size:80%;">19:</span></span>  <span class="ltx_text ltx_font_bold" id="algx1.l19.2">return</span>  <math alttext="Y_{\text{pred}}" class="ltx_Math" display="inline" id="algx1.l19.m1.1"><semantics id="algx1.l19.m1.1a"><msub id="algx1.l19.m1.1.1" xref="algx1.l19.m1.1.1.cmml"><mi id="algx1.l19.m1.1.1.2" xref="algx1.l19.m1.1.1.2.cmml">Y</mi><mtext id="algx1.l19.m1.1.1.3" xref="algx1.l19.m1.1.1.3a.cmml">pred</mtext></msub><annotation-xml encoding="MathML-Content" id="algx1.l19.m1.1b"><apply id="algx1.l19.m1.1.1.cmml" xref="algx1.l19.m1.1.1"><csymbol cd="ambiguous" id="algx1.l19.m1.1.1.1.cmml" xref="algx1.l19.m1.1.1">subscript</csymbol><ci id="algx1.l19.m1.1.1.2.cmml" xref="algx1.l19.m1.1.1.2">𝑌</ci><ci id="algx1.l19.m1.1.1.3a.cmml" xref="algx1.l19.m1.1.1.3"><mtext id="algx1.l19.m1.1.1.3.cmml" mathsize="70%" xref="algx1.l19.m1.1.1.3">pred</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l19.m1.1c">Y_{\text{pred}}</annotation><annotation encoding="application/x-llamapun" id="algx1.l19.m1.1d">italic_Y start_POSTSUBSCRIPT pred end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
</div>
</figure>
<figure class="ltx_table" id="S4.T3">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE III: </span>Detailed Comparison of Data Fusion Methods for Mobile App Prediction</figcaption>
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T3.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T3.1.1.1">
<th class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_column ltx_border_tt" id="S4.T3.1.1.1.1" style="width:56.9pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T3.1.1.1.1.1">
<span class="ltx_p" id="S4.T3.1.1.1.1.1.1">Method</span>
</span>
</th>
<th class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_column ltx_border_tt" id="S4.T3.1.1.1.2" style="width:56.9pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T3.1.1.1.2.1">
<span class="ltx_p" id="S4.T3.1.1.1.2.1.1">Year</span>
</span>
</th>
<th class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_column ltx_border_tt" id="S4.T3.1.1.1.3" style="width:99.6pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T3.1.1.1.3.1">
<span class="ltx_p" id="S4.T3.1.1.1.3.1.1">Data Fusion Method</span>
</span>
</th>
<th class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_column ltx_border_tt" id="S4.T3.1.1.1.4" style="width:256.1pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T3.1.1.1.4.1">
<span class="ltx_p" id="S4.T3.1.1.1.4.1.1">Applicability and Limitations of Data Fusion</span>
</span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T3.1.2.1">
<td class="ltx_td ltx_align_justify ltx_align_middle ltx_border_t" id="S4.T3.1.2.1.1" style="width:56.9pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T3.1.2.1.1.1">
<span class="ltx_p" id="S4.T3.1.2.1.1.1.1">NAP<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib50" title=""><span class="ltx_text" style="font-size:80%;">50</span></a>]</cite></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_middle ltx_border_t" id="S4.T3.1.2.1.2" style="width:56.9pt;"></td>
<td class="ltx_td ltx_align_justify ltx_align_middle ltx_border_t" id="S4.T3.1.2.1.3" style="width:99.6pt;"></td>
<td class="ltx_td ltx_align_justify ltx_align_middle ltx_border_t" id="S4.T3.1.2.1.4" style="width:256.1pt;"></td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.3.2">
<td class="ltx_td ltx_align_justify ltx_align_middle" id="S4.T3.1.3.2.1" style="width:56.9pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T3.1.3.2.1.1">
<span class="ltx_p" id="S4.T3.1.3.2.1.1.1">DeepApp<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib16" title=""><span class="ltx_text" style="font-size:80%;">16</span></a>]</cite></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_middle" id="S4.T3.1.3.2.2" style="width:56.9pt;"></td>
<td class="ltx_td ltx_align_justify ltx_align_middle" id="S4.T3.1.3.2.3" style="width:99.6pt;"></td>
<td class="ltx_td ltx_align_justify ltx_align_middle" id="S4.T3.1.3.2.4" style="width:256.1pt;"></td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.4.3">
<td class="ltx_td ltx_align_justify ltx_align_middle" id="S4.T3.1.4.3.1" style="width:56.9pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T3.1.4.3.1.1">
<span class="ltx_p" id="S4.T3.1.4.3.1.1.1">PAULCI<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib51" title=""><span class="ltx_text" style="font-size:80%;">51</span></a>]</cite></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_middle" id="S4.T3.1.4.3.2" style="width:56.9pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T3.1.4.3.2.1">
<span class="ltx_p" id="S4.T3.1.4.3.2.1.1">Appl. Sci 2020</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_middle" id="S4.T3.1.4.3.3" style="width:99.6pt;"></td>
<td class="ltx_td ltx_align_justify ltx_align_middle" id="S4.T3.1.4.3.4" style="width:256.1pt;"></td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.5.4">
<td class="ltx_td ltx_align_justify ltx_align_middle" id="S4.T3.1.5.4.1" style="width:56.9pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T3.1.5.4.1.1">
<span class="ltx_p" id="S4.T3.1.5.4.1.1.1">ACM TIST 2020</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_middle" id="S4.T3.1.5.4.2" style="width:56.9pt;"></td>
<td class="ltx_td ltx_align_justify ltx_align_middle" id="S4.T3.1.5.4.3" style="width:99.6pt;"></td>
<td class="ltx_td ltx_align_justify ltx_align_middle" id="S4.T3.1.5.4.4" style="width:256.1pt;"></td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.6.5">
<td class="ltx_td ltx_align_justify ltx_align_middle" id="S4.T3.1.6.5.1" style="width:56.9pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T3.1.6.5.1.1">
<span class="ltx_p" id="S4.T3.1.6.5.1.1.1">Comput Commun 2022</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_middle" id="S4.T3.1.6.5.2" style="width:56.9pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T3.1.6.5.2.1">
<span class="ltx_p" id="S4.T3.1.6.5.2.1.1">Heterogeneous raw data is directly concatenated and subsequently encoded, followed by additional operations.</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_middle" id="S4.T3.1.6.5.3" style="width:99.6pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T3.1.6.5.3.1">
<span class="ltx_itemize" id="S4.I1">
<span class="ltx_item" id="S4.I1.i1" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="S4.I1.i1.p1">
<span class="ltx_p" id="S4.I1.i1.p1.1">Simple, efficient, and straightforward implementation.</span>
</span></span>
<span class="ltx_item" id="S4.I1.i2" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="S4.I1.i2.p1">
<span class="ltx_p" id="S4.I1.i2.p1.1">Overlooks the complexity of data relationships and relevance.</span>
</span></span>
<span class="ltx_item" id="S4.I1.i3" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="S4.I1.i3.p1">
<span class="ltx_p" id="S4.I1.i3.p1.1">Prone to information overload with minimal insights.</span>
</span></span>
<span class="ltx_item" id="S4.I1.i4" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="S4.I1.i4.p1">
<span class="ltx_p" id="S4.I1.i4.p1.1">Scalability issues hinder performance in complex analyses.</span>
</span></span>
</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_middle" id="S4.T3.1.6.5.4" style="width:256.1pt;"></td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.7.6">
<td class="ltx_td ltx_align_justify ltx_align_middle" id="S4.T3.1.7.6.1" style="width:56.9pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T3.1.7.6.1.1">
<span class="ltx_p" id="S4.T3.1.7.6.1.1.1">AppUsage2Vec<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib47" title=""><span class="ltx_text" style="font-size:80%;">47</span></a>]</cite></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_middle" id="S4.T3.1.7.6.2" style="width:56.9pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T3.1.7.6.2.1">
<span class="ltx_p" id="S4.T3.1.7.6.2.1.1">ICDE 2019</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_middle" id="S4.T3.1.7.6.3" style="width:99.6pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T3.1.7.6.3.1">
<span class="ltx_p" id="S4.T3.1.7.6.3.1.1">Integrates user and app data through a Hadamard product, aiming to capture the intricate interactions between user behavior and app usage patterns.</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_middle" id="S4.T3.1.7.6.4" style="width:256.1pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T3.1.7.6.4.1">
<span class="ltx_itemize" id="S4.I2">
<span class="ltx_item" id="S4.I2.i1" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="S4.I2.i1.p1">
<span class="ltx_p" id="S4.I2.i1.p1.1">Directly captures interactions between user behavior and app usage.</span>
</span></span>
<span class="ltx_item" id="S4.I2.i2" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="S4.I2.i2.p1">
<span class="ltx_p" id="S4.I2.i2.p1.1">Element-wise multiplication may overlook complex data interactions.</span>
</span></span>
<span class="ltx_item" id="S4.I2.i3" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="S4.I2.i3.p1">
<span class="ltx_p" id="S4.I2.i3.p1.1">Fails to account for dynamic user preference changes.</span>
</span></span>
<span class="ltx_item" id="S4.I2.i4" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="S4.I2.i4.p1">
<span class="ltx_p" id="S4.I2.i4.p1.1">Dimensionality constraints necessitate additional preprocessing.</span>
</span></span>
<span class="ltx_item" id="S4.I2.i5" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="S4.I2.i5.p1">
<span class="ltx_p" id="S4.I2.i5.p1.1">Scalability challenges impact computational efficiency.</span>
</span></span>
</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.8.7">
<td class="ltx_td ltx_align_justify ltx_align_middle ltx_border_bb" id="S4.T3.1.8.7.1" style="width:56.9pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T3.1.8.7.1.1">
<span class="ltx_p" id="S4.T3.1.8.7.1.1.1">DUGN<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib49" title=""><span class="ltx_text" style="font-size:80%;">49</span></a>]</cite></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_middle ltx_border_bb" id="S4.T3.1.8.7.2" style="width:56.9pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T3.1.8.7.2.1">
<span class="ltx_p" id="S4.T3.1.8.7.2.1.1">IEEE TMC 2023</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_middle ltx_border_bb" id="S4.T3.1.8.7.3" style="width:99.6pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T3.1.8.7.3.1">
<span class="ltx_p" id="S4.T3.1.8.7.3.1.1">Utilizes an Interest Fusion Layer to capture the dynamic evolution of user preferences.</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_middle ltx_border_bb" id="S4.T3.1.8.7.4" style="width:256.1pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T3.1.8.7.4.1">
<span class="ltx_itemize" id="S4.I3">
<span class="ltx_item" id="S4.I3.i1" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="S4.I3.i1.p1">
<span class="ltx_p" id="S4.I3.i1.p1.1">Adapts to real-time, evolving user interests for personalized recommendations.</span>
</span></span>
<span class="ltx_item" id="S4.I3.i2" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="S4.I3.i2.p1">
<span class="ltx_p" id="S4.I3.i2.p1.1">Difficulties in managing interest changes without adding noise.</span>
</span></span>
<span class="ltx_item" id="S4.I3.i3" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="S4.I3.i3.p1">
<span class="ltx_p" id="S4.I3.i3.p1.1">Requires advanced techniques to distinguish between transient and enduring interest changes.</span>
</span></span>
<span class="ltx_item" id="S4.I3.i4" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="S4.I3.i4.p1">
<span class="ltx_p" id="S4.I3.i4.p1.1">Balancing evolving and current interests is challenging, risking recommendations becoming static or erratic.</span>
</span></span>
<span class="ltx_item" id="S4.I3.i5" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="S4.I3.i5.p1">
<span class="ltx_p" id="S4.I3.i5.p1.1">Dependence on singular data mode may lead to incomplete user profiles.</span>
</span></span>
</span>
</span>
</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S4.SS3.5.1.1">IV-C</span> </span><span class="ltx_text ltx_font_italic" id="S4.SS3.6.2">Multi-Modal Data Progressive Fusion Module</span>
</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">In the pursuit of advancing mobile app prediction, our comprehensive review of existing data fusion methods revealed limitations in their capacity to integrate multi-modal data effectively and to discern the importance of varying data types (as shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S4.T3" title="TABLE III ‣ IV-B Appformer Framework Overview ‣ IV Method ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_tag">III</span></a>). To address these shortcomings and enhance predictive performance, we propose a series of strategic improvements: emphasizing context relevance, delineating the importance of data modalities, adopting cross-modal attention mechanisms, and implementing progressive fusion strategies. These improvements have culminated in the development of the Multi-Modal Data Progressive Fusion Module, a novel approach designed to navigate the challenges identified.</p>
</div>
<div class="ltx_para" id="S4.SS3.p2">
<p class="ltx_p" id="S4.SS3.p2.4">As illustrated in the gray section of Figure <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S4.F3" title="Figure 3 ‣ IV-B Appformer Framework Overview ‣ IV Method ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_tag">3</span></a>, the Multi-Modal Data Progressive Fusion Module, with its core Cross-Modal Data Fusion Module, cleverly merges encoded app vector <span class="ltx_text ltx_markedasmath ltx_font_bold" id="S4.SS3.p2.4.1">a</span>, user vector <span class="ltx_text ltx_markedasmath ltx_font_bold" id="S4.SS3.p2.4.2">u</span>, POI vector <span class="ltx_text ltx_markedasmath ltx_font_bold" id="S4.SS3.p2.4.3">l</span>, and time vector <span class="ltx_text ltx_markedasmath ltx_font_bold" id="S4.SS3.p2.4.4">t</span> step by step, progressively preparing the data for the Feature Extraction Module’s Encoder and Decoder.</p>
</div>
<figure class="ltx_figure" id="S4.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="338" id="S4.F4.g1" src="x4.png" width="623"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Cross-Modal Attention and Cross-Modal Data Fusion Module for multi-modal app usage data.</figcaption>
</figure>
<div class="ltx_para" id="S4.SS3.p3">
<p class="ltx_p" id="S4.SS3.p3.1"><span class="ltx_text ltx_font_bold" id="S4.SS3.p3.1.1">Cross-Modal Data Fusion Module:</span> Inspired by the decoder module in the Transformer proposed by Vaswani et al.<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib61" title=""><span class="ltx_text" style="font-size:80%;">61</span></a>]</cite>, we integrated operations such as Multi-Head Cross-Modal Attention, Masked Multi-Head Self-Attention, Residual Connection and Layer Normalization, Feed Forward to form the Cross-Modal Data Fusion Module, as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S4.F4" title="Figure 4 ‣ IV-C Multi-Modal Data Progressive Fusion Module ‣ IV Method ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_tag">4</span></a>. To enhance clarity around the computational workflow of Cross-Modal Data Fusion Module, we have included pseudocode detailing its computational steps, as seen in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#alg2" title="Algorithm 2 ‣ IV-C Multi-Modal Data Progressive Fusion Module ‣ IV Method ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg2.6.1.1">Algorithm 2</span> </span> The Cross-Modal Data Fusion Module algorithm is exemplified by the fusion of encoded app vector <math alttext="a" class="ltx_Math" display="inline" id="alg2.3.m1.1"><semantics id="alg2.3.m1.1b"><mi id="alg2.3.m1.1.1" xref="alg2.3.m1.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="alg2.3.m1.1c"><ci id="alg2.3.m1.1.1.cmml" xref="alg2.3.m1.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.3.m1.1d">a</annotation><annotation encoding="application/x-llamapun" id="alg2.3.m1.1e">italic_a</annotation></semantics></math> and POI vector <math alttext="l" class="ltx_Math" display="inline" id="alg2.4.m2.1"><semantics id="alg2.4.m2.1b"><mi id="alg2.4.m2.1.1" xref="alg2.4.m2.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="alg2.4.m2.1c"><ci id="alg2.4.m2.1.1.cmml" xref="alg2.4.m2.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.4.m2.1d">l</annotation><annotation encoding="application/x-llamapun" id="alg2.4.m2.1e">italic_l</annotation></semantics></math>.</figcaption>
<div class="ltx_listing ltx_listing" id="alg2.7">
<div class="ltx_listingline" id="algx2.l0">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algx2.l0.1.1.1" style="font-size:80%;">0:</span></span>  <math alttext="a" class="ltx_Math" display="inline" id="algx2.l0.m1.1"><semantics id="algx2.l0.m1.1a"><mi id="algx2.l0.m1.1.1" xref="algx2.l0.m1.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="algx2.l0.m1.1b"><ci id="algx2.l0.m1.1.1.cmml" xref="algx2.l0.m1.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="algx2.l0.m1.1c">a</annotation><annotation encoding="application/x-llamapun" id="algx2.l0.m1.1d">italic_a</annotation></semantics></math>, <math alttext="l" class="ltx_Math" display="inline" id="algx2.l0.m2.1"><semantics id="algx2.l0.m2.1a"><mi id="algx2.l0.m2.1.1" xref="algx2.l0.m2.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="algx2.l0.m2.1b"><ci id="algx2.l0.m2.1.1.cmml" xref="algx2.l0.m2.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="algx2.l0.m2.1c">l</annotation><annotation encoding="application/x-llamapun" id="algx2.l0.m2.1d">italic_l</annotation></semantics></math>, <math alttext="d_{\text{model}}" class="ltx_Math" display="inline" id="algx2.l0.m3.1"><semantics id="algx2.l0.m3.1a"><msub id="algx2.l0.m3.1.1" xref="algx2.l0.m3.1.1.cmml"><mi id="algx2.l0.m3.1.1.2" xref="algx2.l0.m3.1.1.2.cmml">d</mi><mtext id="algx2.l0.m3.1.1.3" xref="algx2.l0.m3.1.1.3a.cmml">model</mtext></msub><annotation-xml encoding="MathML-Content" id="algx2.l0.m3.1b"><apply id="algx2.l0.m3.1.1.cmml" xref="algx2.l0.m3.1.1"><csymbol cd="ambiguous" id="algx2.l0.m3.1.1.1.cmml" xref="algx2.l0.m3.1.1">subscript</csymbol><ci id="algx2.l0.m3.1.1.2.cmml" xref="algx2.l0.m3.1.1.2">𝑑</ci><ci id="algx2.l0.m3.1.1.3a.cmml" xref="algx2.l0.m3.1.1.3"><mtext id="algx2.l0.m3.1.1.3.cmml" mathsize="70%" xref="algx2.l0.m3.1.1.3">model</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algx2.l0.m3.1c">d_{\text{model}}</annotation><annotation encoding="application/x-llamapun" id="algx2.l0.m3.1d">italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="num\_heads" class="ltx_Math" display="inline" id="algx2.l0.m4.1"><semantics id="algx2.l0.m4.1a"><mrow id="algx2.l0.m4.1.1" xref="algx2.l0.m4.1.1.cmml"><mi id="algx2.l0.m4.1.1.2" xref="algx2.l0.m4.1.1.2.cmml">n</mi><mo id="algx2.l0.m4.1.1.1" xref="algx2.l0.m4.1.1.1.cmml">⁢</mo><mi id="algx2.l0.m4.1.1.3" xref="algx2.l0.m4.1.1.3.cmml">u</mi><mo id="algx2.l0.m4.1.1.1a" xref="algx2.l0.m4.1.1.1.cmml">⁢</mo><mi id="algx2.l0.m4.1.1.4" xref="algx2.l0.m4.1.1.4.cmml">m</mi><mo id="algx2.l0.m4.1.1.1b" xref="algx2.l0.m4.1.1.1.cmml">⁢</mo><mi id="algx2.l0.m4.1.1.5" mathvariant="normal" xref="algx2.l0.m4.1.1.5.cmml">_</mi><mo id="algx2.l0.m4.1.1.1c" xref="algx2.l0.m4.1.1.1.cmml">⁢</mo><mi id="algx2.l0.m4.1.1.6" xref="algx2.l0.m4.1.1.6.cmml">h</mi><mo id="algx2.l0.m4.1.1.1d" xref="algx2.l0.m4.1.1.1.cmml">⁢</mo><mi id="algx2.l0.m4.1.1.7" xref="algx2.l0.m4.1.1.7.cmml">e</mi><mo id="algx2.l0.m4.1.1.1e" xref="algx2.l0.m4.1.1.1.cmml">⁢</mo><mi id="algx2.l0.m4.1.1.8" xref="algx2.l0.m4.1.1.8.cmml">a</mi><mo id="algx2.l0.m4.1.1.1f" xref="algx2.l0.m4.1.1.1.cmml">⁢</mo><mi id="algx2.l0.m4.1.1.9" xref="algx2.l0.m4.1.1.9.cmml">d</mi><mo id="algx2.l0.m4.1.1.1g" xref="algx2.l0.m4.1.1.1.cmml">⁢</mo><mi id="algx2.l0.m4.1.1.10" xref="algx2.l0.m4.1.1.10.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="algx2.l0.m4.1b"><apply id="algx2.l0.m4.1.1.cmml" xref="algx2.l0.m4.1.1"><times id="algx2.l0.m4.1.1.1.cmml" xref="algx2.l0.m4.1.1.1"></times><ci id="algx2.l0.m4.1.1.2.cmml" xref="algx2.l0.m4.1.1.2">𝑛</ci><ci id="algx2.l0.m4.1.1.3.cmml" xref="algx2.l0.m4.1.1.3">𝑢</ci><ci id="algx2.l0.m4.1.1.4.cmml" xref="algx2.l0.m4.1.1.4">𝑚</ci><ci id="algx2.l0.m4.1.1.5.cmml" xref="algx2.l0.m4.1.1.5">_</ci><ci id="algx2.l0.m4.1.1.6.cmml" xref="algx2.l0.m4.1.1.6">ℎ</ci><ci id="algx2.l0.m4.1.1.7.cmml" xref="algx2.l0.m4.1.1.7">𝑒</ci><ci id="algx2.l0.m4.1.1.8.cmml" xref="algx2.l0.m4.1.1.8">𝑎</ci><ci id="algx2.l0.m4.1.1.9.cmml" xref="algx2.l0.m4.1.1.9">𝑑</ci><ci id="algx2.l0.m4.1.1.10.cmml" xref="algx2.l0.m4.1.1.10">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algx2.l0.m4.1c">num\_heads</annotation><annotation encoding="application/x-llamapun" id="algx2.l0.m4.1d">italic_n italic_u italic_m _ italic_h italic_e italic_a italic_d italic_s</annotation></semantics></math>, <math alttext="dropout\_rate" class="ltx_Math" display="inline" id="algx2.l0.m5.1"><semantics id="algx2.l0.m5.1a"><mrow id="algx2.l0.m5.1.1" xref="algx2.l0.m5.1.1.cmml"><mi id="algx2.l0.m5.1.1.2" xref="algx2.l0.m5.1.1.2.cmml">d</mi><mo id="algx2.l0.m5.1.1.1" xref="algx2.l0.m5.1.1.1.cmml">⁢</mo><mi id="algx2.l0.m5.1.1.3" xref="algx2.l0.m5.1.1.3.cmml">r</mi><mo id="algx2.l0.m5.1.1.1a" xref="algx2.l0.m5.1.1.1.cmml">⁢</mo><mi id="algx2.l0.m5.1.1.4" xref="algx2.l0.m5.1.1.4.cmml">o</mi><mo id="algx2.l0.m5.1.1.1b" xref="algx2.l0.m5.1.1.1.cmml">⁢</mo><mi id="algx2.l0.m5.1.1.5" xref="algx2.l0.m5.1.1.5.cmml">p</mi><mo id="algx2.l0.m5.1.1.1c" xref="algx2.l0.m5.1.1.1.cmml">⁢</mo><mi id="algx2.l0.m5.1.1.6" xref="algx2.l0.m5.1.1.6.cmml">o</mi><mo id="algx2.l0.m5.1.1.1d" xref="algx2.l0.m5.1.1.1.cmml">⁢</mo><mi id="algx2.l0.m5.1.1.7" xref="algx2.l0.m5.1.1.7.cmml">u</mi><mo id="algx2.l0.m5.1.1.1e" xref="algx2.l0.m5.1.1.1.cmml">⁢</mo><mi id="algx2.l0.m5.1.1.8" xref="algx2.l0.m5.1.1.8.cmml">t</mi><mo id="algx2.l0.m5.1.1.1f" xref="algx2.l0.m5.1.1.1.cmml">⁢</mo><mi id="algx2.l0.m5.1.1.9" mathvariant="normal" xref="algx2.l0.m5.1.1.9.cmml">_</mi><mo id="algx2.l0.m5.1.1.1g" xref="algx2.l0.m5.1.1.1.cmml">⁢</mo><mi id="algx2.l0.m5.1.1.10" xref="algx2.l0.m5.1.1.10.cmml">r</mi><mo id="algx2.l0.m5.1.1.1h" xref="algx2.l0.m5.1.1.1.cmml">⁢</mo><mi id="algx2.l0.m5.1.1.11" xref="algx2.l0.m5.1.1.11.cmml">a</mi><mo id="algx2.l0.m5.1.1.1i" xref="algx2.l0.m5.1.1.1.cmml">⁢</mo><mi id="algx2.l0.m5.1.1.12" xref="algx2.l0.m5.1.1.12.cmml">t</mi><mo id="algx2.l0.m5.1.1.1j" xref="algx2.l0.m5.1.1.1.cmml">⁢</mo><mi id="algx2.l0.m5.1.1.13" xref="algx2.l0.m5.1.1.13.cmml">e</mi></mrow><annotation-xml encoding="MathML-Content" id="algx2.l0.m5.1b"><apply id="algx2.l0.m5.1.1.cmml" xref="algx2.l0.m5.1.1"><times id="algx2.l0.m5.1.1.1.cmml" xref="algx2.l0.m5.1.1.1"></times><ci id="algx2.l0.m5.1.1.2.cmml" xref="algx2.l0.m5.1.1.2">𝑑</ci><ci id="algx2.l0.m5.1.1.3.cmml" xref="algx2.l0.m5.1.1.3">𝑟</ci><ci id="algx2.l0.m5.1.1.4.cmml" xref="algx2.l0.m5.1.1.4">𝑜</ci><ci id="algx2.l0.m5.1.1.5.cmml" xref="algx2.l0.m5.1.1.5">𝑝</ci><ci id="algx2.l0.m5.1.1.6.cmml" xref="algx2.l0.m5.1.1.6">𝑜</ci><ci id="algx2.l0.m5.1.1.7.cmml" xref="algx2.l0.m5.1.1.7">𝑢</ci><ci id="algx2.l0.m5.1.1.8.cmml" xref="algx2.l0.m5.1.1.8">𝑡</ci><ci id="algx2.l0.m5.1.1.9.cmml" xref="algx2.l0.m5.1.1.9">_</ci><ci id="algx2.l0.m5.1.1.10.cmml" xref="algx2.l0.m5.1.1.10">𝑟</ci><ci id="algx2.l0.m5.1.1.11.cmml" xref="algx2.l0.m5.1.1.11">𝑎</ci><ci id="algx2.l0.m5.1.1.12.cmml" xref="algx2.l0.m5.1.1.12">𝑡</ci><ci id="algx2.l0.m5.1.1.13.cmml" xref="algx2.l0.m5.1.1.13">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algx2.l0.m5.1c">dropout\_rate</annotation><annotation encoding="application/x-llamapun" id="algx2.l0.m5.1d">italic_d italic_r italic_o italic_p italic_o italic_u italic_t _ italic_r italic_a italic_t italic_e</annotation></semantics></math>, <math alttext="d_{\text{ff}}" class="ltx_Math" display="inline" id="algx2.l0.m6.1"><semantics id="algx2.l0.m6.1a"><msub id="algx2.l0.m6.1.1" xref="algx2.l0.m6.1.1.cmml"><mi id="algx2.l0.m6.1.1.2" xref="algx2.l0.m6.1.1.2.cmml">d</mi><mtext id="algx2.l0.m6.1.1.3" xref="algx2.l0.m6.1.1.3a.cmml">ff</mtext></msub><annotation-xml encoding="MathML-Content" id="algx2.l0.m6.1b"><apply id="algx2.l0.m6.1.1.cmml" xref="algx2.l0.m6.1.1"><csymbol cd="ambiguous" id="algx2.l0.m6.1.1.1.cmml" xref="algx2.l0.m6.1.1">subscript</csymbol><ci id="algx2.l0.m6.1.1.2.cmml" xref="algx2.l0.m6.1.1.2">𝑑</ci><ci id="algx2.l0.m6.1.1.3a.cmml" xref="algx2.l0.m6.1.1.3"><mtext id="algx2.l0.m6.1.1.3.cmml" mathsize="70%" xref="algx2.l0.m6.1.1.3">ff</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algx2.l0.m6.1c">d_{\text{ff}}</annotation><annotation encoding="application/x-llamapun" id="algx2.l0.m6.1d">italic_d start_POSTSUBSCRIPT ff end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algx2.l0a">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algx2.l0a.1.1.1" style="font-size:80%;">0:</span></span>  <math alttext="Y_{\text{fused}}" class="ltx_Math" display="inline" id="algx2.l0a.m1.1"><semantics id="algx2.l0a.m1.1a"><msub id="algx2.l0a.m1.1.1" xref="algx2.l0a.m1.1.1.cmml"><mi id="algx2.l0a.m1.1.1.2" xref="algx2.l0a.m1.1.1.2.cmml">Y</mi><mtext id="algx2.l0a.m1.1.1.3" xref="algx2.l0a.m1.1.1.3a.cmml">fused</mtext></msub><annotation-xml encoding="MathML-Content" id="algx2.l0a.m1.1b"><apply id="algx2.l0a.m1.1.1.cmml" xref="algx2.l0a.m1.1.1"><csymbol cd="ambiguous" id="algx2.l0a.m1.1.1.1.cmml" xref="algx2.l0a.m1.1.1">subscript</csymbol><ci id="algx2.l0a.m1.1.1.2.cmml" xref="algx2.l0a.m1.1.1.2">𝑌</ci><ci id="algx2.l0a.m1.1.1.3a.cmml" xref="algx2.l0a.m1.1.1.3"><mtext id="algx2.l0a.m1.1.1.3.cmml" mathsize="70%" xref="algx2.l0a.m1.1.1.3">fused</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algx2.l0a.m1.1c">Y_{\text{fused}}</annotation><annotation encoding="application/x-llamapun" id="algx2.l0a.m1.1d">italic_Y start_POSTSUBSCRIPT fused end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algx2.l1">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algx2.l1.1.1.1" style="font-size:80%;">1:</span></span>  // Initialize weight matrices for Multi-Head Self-Attention and Cross-Modal Attention

</div>
<div class="ltx_listingline" id="algx2.l2">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algx2.l2.1.1.1" style="font-size:80%;">2:</span></span>  <span class="ltx_text ltx_font_bold" id="algx2.l2.2">for</span> <math alttext="i=1" class="ltx_Math" display="inline" id="algx2.l2.m1.1"><semantics id="algx2.l2.m1.1a"><mrow id="algx2.l2.m1.1.1" xref="algx2.l2.m1.1.1.cmml"><mi id="algx2.l2.m1.1.1.2" xref="algx2.l2.m1.1.1.2.cmml">i</mi><mo id="algx2.l2.m1.1.1.1" xref="algx2.l2.m1.1.1.1.cmml">=</mo><mn id="algx2.l2.m1.1.1.3" xref="algx2.l2.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="algx2.l2.m1.1b"><apply id="algx2.l2.m1.1.1.cmml" xref="algx2.l2.m1.1.1"><eq id="algx2.l2.m1.1.1.1.cmml" xref="algx2.l2.m1.1.1.1"></eq><ci id="algx2.l2.m1.1.1.2.cmml" xref="algx2.l2.m1.1.1.2">𝑖</ci><cn id="algx2.l2.m1.1.1.3.cmml" type="integer" xref="algx2.l2.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algx2.l2.m1.1c">i=1</annotation><annotation encoding="application/x-llamapun" id="algx2.l2.m1.1d">italic_i = 1</annotation></semantics></math> to <span class="ltx_text ltx_markedasmath" id="algx2.l2.3">num_heads</span> <span class="ltx_text ltx_font_bold" id="algx2.l2.4">do</span>
</div>
<div class="ltx_listingline" id="algx2.l3">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algx2.l3.1.1.1" style="font-size:80%;">3:</span></span>     <math alttext="W_{Q_{a}}^{i},W_{K_{a}}^{i},W_{V_{a}}^{i}\leftarrow\text{InitializeWeights}(d_%
{\text{model}},d_{k})" class="ltx_Math" display="inline" id="algx2.l3.m1.5"><semantics id="algx2.l3.m1.5a"><mrow id="algx2.l3.m1.5.5" xref="algx2.l3.m1.5.5.cmml"><mrow id="algx2.l3.m1.3.3.3.3" xref="algx2.l3.m1.3.3.3.4.cmml"><msubsup id="algx2.l3.m1.1.1.1.1.1" xref="algx2.l3.m1.1.1.1.1.1.cmml"><mi id="algx2.l3.m1.1.1.1.1.1.2.2" xref="algx2.l3.m1.1.1.1.1.1.2.2.cmml">W</mi><msub id="algx2.l3.m1.1.1.1.1.1.2.3" xref="algx2.l3.m1.1.1.1.1.1.2.3.cmml"><mi id="algx2.l3.m1.1.1.1.1.1.2.3.2" xref="algx2.l3.m1.1.1.1.1.1.2.3.2.cmml">Q</mi><mi id="algx2.l3.m1.1.1.1.1.1.2.3.3" xref="algx2.l3.m1.1.1.1.1.1.2.3.3.cmml">a</mi></msub><mi id="algx2.l3.m1.1.1.1.1.1.3" xref="algx2.l3.m1.1.1.1.1.1.3.cmml">i</mi></msubsup><mo id="algx2.l3.m1.3.3.3.3.4" xref="algx2.l3.m1.3.3.3.4.cmml">,</mo><msubsup id="algx2.l3.m1.2.2.2.2.2" xref="algx2.l3.m1.2.2.2.2.2.cmml"><mi id="algx2.l3.m1.2.2.2.2.2.2.2" xref="algx2.l3.m1.2.2.2.2.2.2.2.cmml">W</mi><msub id="algx2.l3.m1.2.2.2.2.2.2.3" xref="algx2.l3.m1.2.2.2.2.2.2.3.cmml"><mi id="algx2.l3.m1.2.2.2.2.2.2.3.2" xref="algx2.l3.m1.2.2.2.2.2.2.3.2.cmml">K</mi><mi id="algx2.l3.m1.2.2.2.2.2.2.3.3" xref="algx2.l3.m1.2.2.2.2.2.2.3.3.cmml">a</mi></msub><mi id="algx2.l3.m1.2.2.2.2.2.3" xref="algx2.l3.m1.2.2.2.2.2.3.cmml">i</mi></msubsup><mo id="algx2.l3.m1.3.3.3.3.5" xref="algx2.l3.m1.3.3.3.4.cmml">,</mo><msubsup id="algx2.l3.m1.3.3.3.3.3" xref="algx2.l3.m1.3.3.3.3.3.cmml"><mi id="algx2.l3.m1.3.3.3.3.3.2.2" xref="algx2.l3.m1.3.3.3.3.3.2.2.cmml">W</mi><msub id="algx2.l3.m1.3.3.3.3.3.2.3" xref="algx2.l3.m1.3.3.3.3.3.2.3.cmml"><mi id="algx2.l3.m1.3.3.3.3.3.2.3.2" xref="algx2.l3.m1.3.3.3.3.3.2.3.2.cmml">V</mi><mi id="algx2.l3.m1.3.3.3.3.3.2.3.3" xref="algx2.l3.m1.3.3.3.3.3.2.3.3.cmml">a</mi></msub><mi id="algx2.l3.m1.3.3.3.3.3.3" xref="algx2.l3.m1.3.3.3.3.3.3.cmml">i</mi></msubsup></mrow><mo id="algx2.l3.m1.5.5.6" stretchy="false" xref="algx2.l3.m1.5.5.6.cmml">←</mo><mrow id="algx2.l3.m1.5.5.5" xref="algx2.l3.m1.5.5.5.cmml"><mtext id="algx2.l3.m1.5.5.5.4" xref="algx2.l3.m1.5.5.5.4a.cmml">InitializeWeights</mtext><mo id="algx2.l3.m1.5.5.5.3" xref="algx2.l3.m1.5.5.5.3.cmml">⁢</mo><mrow id="algx2.l3.m1.5.5.5.2.2" xref="algx2.l3.m1.5.5.5.2.3.cmml"><mo id="algx2.l3.m1.5.5.5.2.2.3" stretchy="false" xref="algx2.l3.m1.5.5.5.2.3.cmml">(</mo><msub id="algx2.l3.m1.4.4.4.1.1.1" xref="algx2.l3.m1.4.4.4.1.1.1.cmml"><mi id="algx2.l3.m1.4.4.4.1.1.1.2" xref="algx2.l3.m1.4.4.4.1.1.1.2.cmml">d</mi><mtext id="algx2.l3.m1.4.4.4.1.1.1.3" xref="algx2.l3.m1.4.4.4.1.1.1.3a.cmml">model</mtext></msub><mo id="algx2.l3.m1.5.5.5.2.2.4" xref="algx2.l3.m1.5.5.5.2.3.cmml">,</mo><msub id="algx2.l3.m1.5.5.5.2.2.2" xref="algx2.l3.m1.5.5.5.2.2.2.cmml"><mi id="algx2.l3.m1.5.5.5.2.2.2.2" xref="algx2.l3.m1.5.5.5.2.2.2.2.cmml">d</mi><mi id="algx2.l3.m1.5.5.5.2.2.2.3" xref="algx2.l3.m1.5.5.5.2.2.2.3.cmml">k</mi></msub><mo id="algx2.l3.m1.5.5.5.2.2.5" stretchy="false" xref="algx2.l3.m1.5.5.5.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx2.l3.m1.5b"><apply id="algx2.l3.m1.5.5.cmml" xref="algx2.l3.m1.5.5"><ci id="algx2.l3.m1.5.5.6.cmml" xref="algx2.l3.m1.5.5.6">←</ci><list id="algx2.l3.m1.3.3.3.4.cmml" xref="algx2.l3.m1.3.3.3.3"><apply id="algx2.l3.m1.1.1.1.1.1.cmml" xref="algx2.l3.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="algx2.l3.m1.1.1.1.1.1.1.cmml" xref="algx2.l3.m1.1.1.1.1.1">superscript</csymbol><apply id="algx2.l3.m1.1.1.1.1.1.2.cmml" xref="algx2.l3.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="algx2.l3.m1.1.1.1.1.1.2.1.cmml" xref="algx2.l3.m1.1.1.1.1.1">subscript</csymbol><ci id="algx2.l3.m1.1.1.1.1.1.2.2.cmml" xref="algx2.l3.m1.1.1.1.1.1.2.2">𝑊</ci><apply id="algx2.l3.m1.1.1.1.1.1.2.3.cmml" xref="algx2.l3.m1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="algx2.l3.m1.1.1.1.1.1.2.3.1.cmml" xref="algx2.l3.m1.1.1.1.1.1.2.3">subscript</csymbol><ci id="algx2.l3.m1.1.1.1.1.1.2.3.2.cmml" xref="algx2.l3.m1.1.1.1.1.1.2.3.2">𝑄</ci><ci id="algx2.l3.m1.1.1.1.1.1.2.3.3.cmml" xref="algx2.l3.m1.1.1.1.1.1.2.3.3">𝑎</ci></apply></apply><ci id="algx2.l3.m1.1.1.1.1.1.3.cmml" xref="algx2.l3.m1.1.1.1.1.1.3">𝑖</ci></apply><apply id="algx2.l3.m1.2.2.2.2.2.cmml" xref="algx2.l3.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="algx2.l3.m1.2.2.2.2.2.1.cmml" xref="algx2.l3.m1.2.2.2.2.2">superscript</csymbol><apply id="algx2.l3.m1.2.2.2.2.2.2.cmml" xref="algx2.l3.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="algx2.l3.m1.2.2.2.2.2.2.1.cmml" xref="algx2.l3.m1.2.2.2.2.2">subscript</csymbol><ci id="algx2.l3.m1.2.2.2.2.2.2.2.cmml" xref="algx2.l3.m1.2.2.2.2.2.2.2">𝑊</ci><apply id="algx2.l3.m1.2.2.2.2.2.2.3.cmml" xref="algx2.l3.m1.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="algx2.l3.m1.2.2.2.2.2.2.3.1.cmml" xref="algx2.l3.m1.2.2.2.2.2.2.3">subscript</csymbol><ci id="algx2.l3.m1.2.2.2.2.2.2.3.2.cmml" xref="algx2.l3.m1.2.2.2.2.2.2.3.2">𝐾</ci><ci id="algx2.l3.m1.2.2.2.2.2.2.3.3.cmml" xref="algx2.l3.m1.2.2.2.2.2.2.3.3">𝑎</ci></apply></apply><ci id="algx2.l3.m1.2.2.2.2.2.3.cmml" xref="algx2.l3.m1.2.2.2.2.2.3">𝑖</ci></apply><apply id="algx2.l3.m1.3.3.3.3.3.cmml" xref="algx2.l3.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="algx2.l3.m1.3.3.3.3.3.1.cmml" xref="algx2.l3.m1.3.3.3.3.3">superscript</csymbol><apply id="algx2.l3.m1.3.3.3.3.3.2.cmml" xref="algx2.l3.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="algx2.l3.m1.3.3.3.3.3.2.1.cmml" xref="algx2.l3.m1.3.3.3.3.3">subscript</csymbol><ci id="algx2.l3.m1.3.3.3.3.3.2.2.cmml" xref="algx2.l3.m1.3.3.3.3.3.2.2">𝑊</ci><apply id="algx2.l3.m1.3.3.3.3.3.2.3.cmml" xref="algx2.l3.m1.3.3.3.3.3.2.3"><csymbol cd="ambiguous" id="algx2.l3.m1.3.3.3.3.3.2.3.1.cmml" xref="algx2.l3.m1.3.3.3.3.3.2.3">subscript</csymbol><ci id="algx2.l3.m1.3.3.3.3.3.2.3.2.cmml" xref="algx2.l3.m1.3.3.3.3.3.2.3.2">𝑉</ci><ci id="algx2.l3.m1.3.3.3.3.3.2.3.3.cmml" xref="algx2.l3.m1.3.3.3.3.3.2.3.3">𝑎</ci></apply></apply><ci id="algx2.l3.m1.3.3.3.3.3.3.cmml" xref="algx2.l3.m1.3.3.3.3.3.3">𝑖</ci></apply></list><apply id="algx2.l3.m1.5.5.5.cmml" xref="algx2.l3.m1.5.5.5"><times id="algx2.l3.m1.5.5.5.3.cmml" xref="algx2.l3.m1.5.5.5.3"></times><ci id="algx2.l3.m1.5.5.5.4a.cmml" xref="algx2.l3.m1.5.5.5.4"><mtext id="algx2.l3.m1.5.5.5.4.cmml" xref="algx2.l3.m1.5.5.5.4">InitializeWeights</mtext></ci><interval closure="open" id="algx2.l3.m1.5.5.5.2.3.cmml" xref="algx2.l3.m1.5.5.5.2.2"><apply id="algx2.l3.m1.4.4.4.1.1.1.cmml" xref="algx2.l3.m1.4.4.4.1.1.1"><csymbol cd="ambiguous" id="algx2.l3.m1.4.4.4.1.1.1.1.cmml" xref="algx2.l3.m1.4.4.4.1.1.1">subscript</csymbol><ci id="algx2.l3.m1.4.4.4.1.1.1.2.cmml" xref="algx2.l3.m1.4.4.4.1.1.1.2">𝑑</ci><ci id="algx2.l3.m1.4.4.4.1.1.1.3a.cmml" xref="algx2.l3.m1.4.4.4.1.1.1.3"><mtext id="algx2.l3.m1.4.4.4.1.1.1.3.cmml" mathsize="70%" xref="algx2.l3.m1.4.4.4.1.1.1.3">model</mtext></ci></apply><apply id="algx2.l3.m1.5.5.5.2.2.2.cmml" xref="algx2.l3.m1.5.5.5.2.2.2"><csymbol cd="ambiguous" id="algx2.l3.m1.5.5.5.2.2.2.1.cmml" xref="algx2.l3.m1.5.5.5.2.2.2">subscript</csymbol><ci id="algx2.l3.m1.5.5.5.2.2.2.2.cmml" xref="algx2.l3.m1.5.5.5.2.2.2.2">𝑑</ci><ci id="algx2.l3.m1.5.5.5.2.2.2.3.cmml" xref="algx2.l3.m1.5.5.5.2.2.2.3">𝑘</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx2.l3.m1.5c">W_{Q_{a}}^{i},W_{K_{a}}^{i},W_{V_{a}}^{i}\leftarrow\text{InitializeWeights}(d_%
{\text{model}},d_{k})</annotation><annotation encoding="application/x-llamapun" id="algx2.l3.m1.5d">italic_W start_POSTSUBSCRIPT italic_Q start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT , italic_W start_POSTSUBSCRIPT italic_K start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT , italic_W start_POSTSUBSCRIPT italic_V start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ← InitializeWeights ( italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT , italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT )</annotation></semantics></math> // <math alttext="d_{k}=d_{\text{model}}/\text{num\_heads}" class="ltx_Math" display="inline" id="algx2.l3.m2.1"><semantics id="algx2.l3.m2.1a"><mrow id="algx2.l3.m2.1.1" xref="algx2.l3.m2.1.1.cmml"><msub id="algx2.l3.m2.1.1.2" xref="algx2.l3.m2.1.1.2.cmml"><mi id="algx2.l3.m2.1.1.2.2" xref="algx2.l3.m2.1.1.2.2.cmml">d</mi><mi id="algx2.l3.m2.1.1.2.3" xref="algx2.l3.m2.1.1.2.3.cmml">k</mi></msub><mo id="algx2.l3.m2.1.1.1" xref="algx2.l3.m2.1.1.1.cmml">=</mo><mrow id="algx2.l3.m2.1.1.3" xref="algx2.l3.m2.1.1.3.cmml"><msub id="algx2.l3.m2.1.1.3.2" xref="algx2.l3.m2.1.1.3.2.cmml"><mi id="algx2.l3.m2.1.1.3.2.2" xref="algx2.l3.m2.1.1.3.2.2.cmml">d</mi><mtext id="algx2.l3.m2.1.1.3.2.3" xref="algx2.l3.m2.1.1.3.2.3a.cmml">model</mtext></msub><mo id="algx2.l3.m2.1.1.3.1" xref="algx2.l3.m2.1.1.3.1.cmml">/</mo><mtext id="algx2.l3.m2.1.1.3.3" xref="algx2.l3.m2.1.1.3.3a.cmml">num_heads</mtext></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx2.l3.m2.1b"><apply id="algx2.l3.m2.1.1.cmml" xref="algx2.l3.m2.1.1"><eq id="algx2.l3.m2.1.1.1.cmml" xref="algx2.l3.m2.1.1.1"></eq><apply id="algx2.l3.m2.1.1.2.cmml" xref="algx2.l3.m2.1.1.2"><csymbol cd="ambiguous" id="algx2.l3.m2.1.1.2.1.cmml" xref="algx2.l3.m2.1.1.2">subscript</csymbol><ci id="algx2.l3.m2.1.1.2.2.cmml" xref="algx2.l3.m2.1.1.2.2">𝑑</ci><ci id="algx2.l3.m2.1.1.2.3.cmml" xref="algx2.l3.m2.1.1.2.3">𝑘</ci></apply><apply id="algx2.l3.m2.1.1.3.cmml" xref="algx2.l3.m2.1.1.3"><divide id="algx2.l3.m2.1.1.3.1.cmml" xref="algx2.l3.m2.1.1.3.1"></divide><apply id="algx2.l3.m2.1.1.3.2.cmml" xref="algx2.l3.m2.1.1.3.2"><csymbol cd="ambiguous" id="algx2.l3.m2.1.1.3.2.1.cmml" xref="algx2.l3.m2.1.1.3.2">subscript</csymbol><ci id="algx2.l3.m2.1.1.3.2.2.cmml" xref="algx2.l3.m2.1.1.3.2.2">𝑑</ci><ci id="algx2.l3.m2.1.1.3.2.3a.cmml" xref="algx2.l3.m2.1.1.3.2.3"><mtext id="algx2.l3.m2.1.1.3.2.3.cmml" mathsize="70%" xref="algx2.l3.m2.1.1.3.2.3">model</mtext></ci></apply><ci id="algx2.l3.m2.1.1.3.3a.cmml" xref="algx2.l3.m2.1.1.3.3"><mtext id="algx2.l3.m2.1.1.3.3.cmml" xref="algx2.l3.m2.1.1.3.3">num_heads</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx2.l3.m2.1c">d_{k}=d_{\text{model}}/\text{num\_heads}</annotation><annotation encoding="application/x-llamapun" id="algx2.l3.m2.1d">italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT = italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT / num_heads</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algx2.l4">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algx2.l4.1.1.1" style="font-size:80%;">4:</span></span>     <math alttext="W_{Q_{l}}^{i},W_{K_{l}}^{i},W_{V_{l}}^{i}\leftarrow\text{InitializeWeights}(d_%
{\text{model}},d_{k})" class="ltx_Math" display="inline" id="algx2.l4.m1.5"><semantics id="algx2.l4.m1.5a"><mrow id="algx2.l4.m1.5.5" xref="algx2.l4.m1.5.5.cmml"><mrow id="algx2.l4.m1.3.3.3.3" xref="algx2.l4.m1.3.3.3.4.cmml"><msubsup id="algx2.l4.m1.1.1.1.1.1" xref="algx2.l4.m1.1.1.1.1.1.cmml"><mi id="algx2.l4.m1.1.1.1.1.1.2.2" xref="algx2.l4.m1.1.1.1.1.1.2.2.cmml">W</mi><msub id="algx2.l4.m1.1.1.1.1.1.2.3" xref="algx2.l4.m1.1.1.1.1.1.2.3.cmml"><mi id="algx2.l4.m1.1.1.1.1.1.2.3.2" xref="algx2.l4.m1.1.1.1.1.1.2.3.2.cmml">Q</mi><mi id="algx2.l4.m1.1.1.1.1.1.2.3.3" xref="algx2.l4.m1.1.1.1.1.1.2.3.3.cmml">l</mi></msub><mi id="algx2.l4.m1.1.1.1.1.1.3" xref="algx2.l4.m1.1.1.1.1.1.3.cmml">i</mi></msubsup><mo id="algx2.l4.m1.3.3.3.3.4" xref="algx2.l4.m1.3.3.3.4.cmml">,</mo><msubsup id="algx2.l4.m1.2.2.2.2.2" xref="algx2.l4.m1.2.2.2.2.2.cmml"><mi id="algx2.l4.m1.2.2.2.2.2.2.2" xref="algx2.l4.m1.2.2.2.2.2.2.2.cmml">W</mi><msub id="algx2.l4.m1.2.2.2.2.2.2.3" xref="algx2.l4.m1.2.2.2.2.2.2.3.cmml"><mi id="algx2.l4.m1.2.2.2.2.2.2.3.2" xref="algx2.l4.m1.2.2.2.2.2.2.3.2.cmml">K</mi><mi id="algx2.l4.m1.2.2.2.2.2.2.3.3" xref="algx2.l4.m1.2.2.2.2.2.2.3.3.cmml">l</mi></msub><mi id="algx2.l4.m1.2.2.2.2.2.3" xref="algx2.l4.m1.2.2.2.2.2.3.cmml">i</mi></msubsup><mo id="algx2.l4.m1.3.3.3.3.5" xref="algx2.l4.m1.3.3.3.4.cmml">,</mo><msubsup id="algx2.l4.m1.3.3.3.3.3" xref="algx2.l4.m1.3.3.3.3.3.cmml"><mi id="algx2.l4.m1.3.3.3.3.3.2.2" xref="algx2.l4.m1.3.3.3.3.3.2.2.cmml">W</mi><msub id="algx2.l4.m1.3.3.3.3.3.2.3" xref="algx2.l4.m1.3.3.3.3.3.2.3.cmml"><mi id="algx2.l4.m1.3.3.3.3.3.2.3.2" xref="algx2.l4.m1.3.3.3.3.3.2.3.2.cmml">V</mi><mi id="algx2.l4.m1.3.3.3.3.3.2.3.3" xref="algx2.l4.m1.3.3.3.3.3.2.3.3.cmml">l</mi></msub><mi id="algx2.l4.m1.3.3.3.3.3.3" xref="algx2.l4.m1.3.3.3.3.3.3.cmml">i</mi></msubsup></mrow><mo id="algx2.l4.m1.5.5.6" stretchy="false" xref="algx2.l4.m1.5.5.6.cmml">←</mo><mrow id="algx2.l4.m1.5.5.5" xref="algx2.l4.m1.5.5.5.cmml"><mtext id="algx2.l4.m1.5.5.5.4" xref="algx2.l4.m1.5.5.5.4a.cmml">InitializeWeights</mtext><mo id="algx2.l4.m1.5.5.5.3" xref="algx2.l4.m1.5.5.5.3.cmml">⁢</mo><mrow id="algx2.l4.m1.5.5.5.2.2" xref="algx2.l4.m1.5.5.5.2.3.cmml"><mo id="algx2.l4.m1.5.5.5.2.2.3" stretchy="false" xref="algx2.l4.m1.5.5.5.2.3.cmml">(</mo><msub id="algx2.l4.m1.4.4.4.1.1.1" xref="algx2.l4.m1.4.4.4.1.1.1.cmml"><mi id="algx2.l4.m1.4.4.4.1.1.1.2" xref="algx2.l4.m1.4.4.4.1.1.1.2.cmml">d</mi><mtext id="algx2.l4.m1.4.4.4.1.1.1.3" xref="algx2.l4.m1.4.4.4.1.1.1.3a.cmml">model</mtext></msub><mo id="algx2.l4.m1.5.5.5.2.2.4" xref="algx2.l4.m1.5.5.5.2.3.cmml">,</mo><msub id="algx2.l4.m1.5.5.5.2.2.2" xref="algx2.l4.m1.5.5.5.2.2.2.cmml"><mi id="algx2.l4.m1.5.5.5.2.2.2.2" xref="algx2.l4.m1.5.5.5.2.2.2.2.cmml">d</mi><mi id="algx2.l4.m1.5.5.5.2.2.2.3" xref="algx2.l4.m1.5.5.5.2.2.2.3.cmml">k</mi></msub><mo id="algx2.l4.m1.5.5.5.2.2.5" stretchy="false" xref="algx2.l4.m1.5.5.5.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx2.l4.m1.5b"><apply id="algx2.l4.m1.5.5.cmml" xref="algx2.l4.m1.5.5"><ci id="algx2.l4.m1.5.5.6.cmml" xref="algx2.l4.m1.5.5.6">←</ci><list id="algx2.l4.m1.3.3.3.4.cmml" xref="algx2.l4.m1.3.3.3.3"><apply id="algx2.l4.m1.1.1.1.1.1.cmml" xref="algx2.l4.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="algx2.l4.m1.1.1.1.1.1.1.cmml" xref="algx2.l4.m1.1.1.1.1.1">superscript</csymbol><apply id="algx2.l4.m1.1.1.1.1.1.2.cmml" xref="algx2.l4.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="algx2.l4.m1.1.1.1.1.1.2.1.cmml" xref="algx2.l4.m1.1.1.1.1.1">subscript</csymbol><ci id="algx2.l4.m1.1.1.1.1.1.2.2.cmml" xref="algx2.l4.m1.1.1.1.1.1.2.2">𝑊</ci><apply id="algx2.l4.m1.1.1.1.1.1.2.3.cmml" xref="algx2.l4.m1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="algx2.l4.m1.1.1.1.1.1.2.3.1.cmml" xref="algx2.l4.m1.1.1.1.1.1.2.3">subscript</csymbol><ci id="algx2.l4.m1.1.1.1.1.1.2.3.2.cmml" xref="algx2.l4.m1.1.1.1.1.1.2.3.2">𝑄</ci><ci id="algx2.l4.m1.1.1.1.1.1.2.3.3.cmml" xref="algx2.l4.m1.1.1.1.1.1.2.3.3">𝑙</ci></apply></apply><ci id="algx2.l4.m1.1.1.1.1.1.3.cmml" xref="algx2.l4.m1.1.1.1.1.1.3">𝑖</ci></apply><apply id="algx2.l4.m1.2.2.2.2.2.cmml" xref="algx2.l4.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="algx2.l4.m1.2.2.2.2.2.1.cmml" xref="algx2.l4.m1.2.2.2.2.2">superscript</csymbol><apply id="algx2.l4.m1.2.2.2.2.2.2.cmml" xref="algx2.l4.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="algx2.l4.m1.2.2.2.2.2.2.1.cmml" xref="algx2.l4.m1.2.2.2.2.2">subscript</csymbol><ci id="algx2.l4.m1.2.2.2.2.2.2.2.cmml" xref="algx2.l4.m1.2.2.2.2.2.2.2">𝑊</ci><apply id="algx2.l4.m1.2.2.2.2.2.2.3.cmml" xref="algx2.l4.m1.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="algx2.l4.m1.2.2.2.2.2.2.3.1.cmml" xref="algx2.l4.m1.2.2.2.2.2.2.3">subscript</csymbol><ci id="algx2.l4.m1.2.2.2.2.2.2.3.2.cmml" xref="algx2.l4.m1.2.2.2.2.2.2.3.2">𝐾</ci><ci id="algx2.l4.m1.2.2.2.2.2.2.3.3.cmml" xref="algx2.l4.m1.2.2.2.2.2.2.3.3">𝑙</ci></apply></apply><ci id="algx2.l4.m1.2.2.2.2.2.3.cmml" xref="algx2.l4.m1.2.2.2.2.2.3">𝑖</ci></apply><apply id="algx2.l4.m1.3.3.3.3.3.cmml" xref="algx2.l4.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="algx2.l4.m1.3.3.3.3.3.1.cmml" xref="algx2.l4.m1.3.3.3.3.3">superscript</csymbol><apply id="algx2.l4.m1.3.3.3.3.3.2.cmml" xref="algx2.l4.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="algx2.l4.m1.3.3.3.3.3.2.1.cmml" xref="algx2.l4.m1.3.3.3.3.3">subscript</csymbol><ci id="algx2.l4.m1.3.3.3.3.3.2.2.cmml" xref="algx2.l4.m1.3.3.3.3.3.2.2">𝑊</ci><apply id="algx2.l4.m1.3.3.3.3.3.2.3.cmml" xref="algx2.l4.m1.3.3.3.3.3.2.3"><csymbol cd="ambiguous" id="algx2.l4.m1.3.3.3.3.3.2.3.1.cmml" xref="algx2.l4.m1.3.3.3.3.3.2.3">subscript</csymbol><ci id="algx2.l4.m1.3.3.3.3.3.2.3.2.cmml" xref="algx2.l4.m1.3.3.3.3.3.2.3.2">𝑉</ci><ci id="algx2.l4.m1.3.3.3.3.3.2.3.3.cmml" xref="algx2.l4.m1.3.3.3.3.3.2.3.3">𝑙</ci></apply></apply><ci id="algx2.l4.m1.3.3.3.3.3.3.cmml" xref="algx2.l4.m1.3.3.3.3.3.3">𝑖</ci></apply></list><apply id="algx2.l4.m1.5.5.5.cmml" xref="algx2.l4.m1.5.5.5"><times id="algx2.l4.m1.5.5.5.3.cmml" xref="algx2.l4.m1.5.5.5.3"></times><ci id="algx2.l4.m1.5.5.5.4a.cmml" xref="algx2.l4.m1.5.5.5.4"><mtext id="algx2.l4.m1.5.5.5.4.cmml" xref="algx2.l4.m1.5.5.5.4">InitializeWeights</mtext></ci><interval closure="open" id="algx2.l4.m1.5.5.5.2.3.cmml" xref="algx2.l4.m1.5.5.5.2.2"><apply id="algx2.l4.m1.4.4.4.1.1.1.cmml" xref="algx2.l4.m1.4.4.4.1.1.1"><csymbol cd="ambiguous" id="algx2.l4.m1.4.4.4.1.1.1.1.cmml" xref="algx2.l4.m1.4.4.4.1.1.1">subscript</csymbol><ci id="algx2.l4.m1.4.4.4.1.1.1.2.cmml" xref="algx2.l4.m1.4.4.4.1.1.1.2">𝑑</ci><ci id="algx2.l4.m1.4.4.4.1.1.1.3a.cmml" xref="algx2.l4.m1.4.4.4.1.1.1.3"><mtext id="algx2.l4.m1.4.4.4.1.1.1.3.cmml" mathsize="70%" xref="algx2.l4.m1.4.4.4.1.1.1.3">model</mtext></ci></apply><apply id="algx2.l4.m1.5.5.5.2.2.2.cmml" xref="algx2.l4.m1.5.5.5.2.2.2"><csymbol cd="ambiguous" id="algx2.l4.m1.5.5.5.2.2.2.1.cmml" xref="algx2.l4.m1.5.5.5.2.2.2">subscript</csymbol><ci id="algx2.l4.m1.5.5.5.2.2.2.2.cmml" xref="algx2.l4.m1.5.5.5.2.2.2.2">𝑑</ci><ci id="algx2.l4.m1.5.5.5.2.2.2.3.cmml" xref="algx2.l4.m1.5.5.5.2.2.2.3">𝑘</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx2.l4.m1.5c">W_{Q_{l}}^{i},W_{K_{l}}^{i},W_{V_{l}}^{i}\leftarrow\text{InitializeWeights}(d_%
{\text{model}},d_{k})</annotation><annotation encoding="application/x-llamapun" id="algx2.l4.m1.5d">italic_W start_POSTSUBSCRIPT italic_Q start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT , italic_W start_POSTSUBSCRIPT italic_K start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT , italic_W start_POSTSUBSCRIPT italic_V start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ← InitializeWeights ( italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT , italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algx2.l5">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algx2.l5.1.1.1" style="font-size:80%;">5:</span></span>     <math alttext="W_{O}^{i}\leftarrow\text{InitializeWeights}(d_{\text{model}}\times\text{num\_%
heads},d_{\text{model}})" class="ltx_Math" display="inline" id="algx2.l5.m1.2"><semantics id="algx2.l5.m1.2a"><mrow id="algx2.l5.m1.2.2" xref="algx2.l5.m1.2.2.cmml"><msubsup id="algx2.l5.m1.2.2.4" xref="algx2.l5.m1.2.2.4.cmml"><mi id="algx2.l5.m1.2.2.4.2.2" xref="algx2.l5.m1.2.2.4.2.2.cmml">W</mi><mi id="algx2.l5.m1.2.2.4.2.3" xref="algx2.l5.m1.2.2.4.2.3.cmml">O</mi><mi id="algx2.l5.m1.2.2.4.3" xref="algx2.l5.m1.2.2.4.3.cmml">i</mi></msubsup><mo id="algx2.l5.m1.2.2.3" stretchy="false" xref="algx2.l5.m1.2.2.3.cmml">←</mo><mrow id="algx2.l5.m1.2.2.2" xref="algx2.l5.m1.2.2.2.cmml"><mtext id="algx2.l5.m1.2.2.2.4" xref="algx2.l5.m1.2.2.2.4a.cmml">InitializeWeights</mtext><mo id="algx2.l5.m1.2.2.2.3" xref="algx2.l5.m1.2.2.2.3.cmml">⁢</mo><mrow id="algx2.l5.m1.2.2.2.2.2" xref="algx2.l5.m1.2.2.2.2.3.cmml"><mo id="algx2.l5.m1.2.2.2.2.2.3" stretchy="false" xref="algx2.l5.m1.2.2.2.2.3.cmml">(</mo><mrow id="algx2.l5.m1.1.1.1.1.1.1" xref="algx2.l5.m1.1.1.1.1.1.1.cmml"><msub id="algx2.l5.m1.1.1.1.1.1.1.2" xref="algx2.l5.m1.1.1.1.1.1.1.2.cmml"><mi id="algx2.l5.m1.1.1.1.1.1.1.2.2" xref="algx2.l5.m1.1.1.1.1.1.1.2.2.cmml">d</mi><mtext id="algx2.l5.m1.1.1.1.1.1.1.2.3" xref="algx2.l5.m1.1.1.1.1.1.1.2.3a.cmml">model</mtext></msub><mo id="algx2.l5.m1.1.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="algx2.l5.m1.1.1.1.1.1.1.1.cmml">×</mo><mtext id="algx2.l5.m1.1.1.1.1.1.1.3" xref="algx2.l5.m1.1.1.1.1.1.1.3a.cmml">num_heads</mtext></mrow><mo id="algx2.l5.m1.2.2.2.2.2.4" xref="algx2.l5.m1.2.2.2.2.3.cmml">,</mo><msub id="algx2.l5.m1.2.2.2.2.2.2" xref="algx2.l5.m1.2.2.2.2.2.2.cmml"><mi id="algx2.l5.m1.2.2.2.2.2.2.2" xref="algx2.l5.m1.2.2.2.2.2.2.2.cmml">d</mi><mtext id="algx2.l5.m1.2.2.2.2.2.2.3" xref="algx2.l5.m1.2.2.2.2.2.2.3a.cmml">model</mtext></msub><mo id="algx2.l5.m1.2.2.2.2.2.5" stretchy="false" xref="algx2.l5.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx2.l5.m1.2b"><apply id="algx2.l5.m1.2.2.cmml" xref="algx2.l5.m1.2.2"><ci id="algx2.l5.m1.2.2.3.cmml" xref="algx2.l5.m1.2.2.3">←</ci><apply id="algx2.l5.m1.2.2.4.cmml" xref="algx2.l5.m1.2.2.4"><csymbol cd="ambiguous" id="algx2.l5.m1.2.2.4.1.cmml" xref="algx2.l5.m1.2.2.4">superscript</csymbol><apply id="algx2.l5.m1.2.2.4.2.cmml" xref="algx2.l5.m1.2.2.4"><csymbol cd="ambiguous" id="algx2.l5.m1.2.2.4.2.1.cmml" xref="algx2.l5.m1.2.2.4">subscript</csymbol><ci id="algx2.l5.m1.2.2.4.2.2.cmml" xref="algx2.l5.m1.2.2.4.2.2">𝑊</ci><ci id="algx2.l5.m1.2.2.4.2.3.cmml" xref="algx2.l5.m1.2.2.4.2.3">𝑂</ci></apply><ci id="algx2.l5.m1.2.2.4.3.cmml" xref="algx2.l5.m1.2.2.4.3">𝑖</ci></apply><apply id="algx2.l5.m1.2.2.2.cmml" xref="algx2.l5.m1.2.2.2"><times id="algx2.l5.m1.2.2.2.3.cmml" xref="algx2.l5.m1.2.2.2.3"></times><ci id="algx2.l5.m1.2.2.2.4a.cmml" xref="algx2.l5.m1.2.2.2.4"><mtext id="algx2.l5.m1.2.2.2.4.cmml" xref="algx2.l5.m1.2.2.2.4">InitializeWeights</mtext></ci><interval closure="open" id="algx2.l5.m1.2.2.2.2.3.cmml" xref="algx2.l5.m1.2.2.2.2.2"><apply id="algx2.l5.m1.1.1.1.1.1.1.cmml" xref="algx2.l5.m1.1.1.1.1.1.1"><times id="algx2.l5.m1.1.1.1.1.1.1.1.cmml" xref="algx2.l5.m1.1.1.1.1.1.1.1"></times><apply id="algx2.l5.m1.1.1.1.1.1.1.2.cmml" xref="algx2.l5.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="algx2.l5.m1.1.1.1.1.1.1.2.1.cmml" xref="algx2.l5.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="algx2.l5.m1.1.1.1.1.1.1.2.2.cmml" xref="algx2.l5.m1.1.1.1.1.1.1.2.2">𝑑</ci><ci id="algx2.l5.m1.1.1.1.1.1.1.2.3a.cmml" xref="algx2.l5.m1.1.1.1.1.1.1.2.3"><mtext id="algx2.l5.m1.1.1.1.1.1.1.2.3.cmml" mathsize="70%" xref="algx2.l5.m1.1.1.1.1.1.1.2.3">model</mtext></ci></apply><ci id="algx2.l5.m1.1.1.1.1.1.1.3a.cmml" xref="algx2.l5.m1.1.1.1.1.1.1.3"><mtext id="algx2.l5.m1.1.1.1.1.1.1.3.cmml" xref="algx2.l5.m1.1.1.1.1.1.1.3">num_heads</mtext></ci></apply><apply id="algx2.l5.m1.2.2.2.2.2.2.cmml" xref="algx2.l5.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="algx2.l5.m1.2.2.2.2.2.2.1.cmml" xref="algx2.l5.m1.2.2.2.2.2.2">subscript</csymbol><ci id="algx2.l5.m1.2.2.2.2.2.2.2.cmml" xref="algx2.l5.m1.2.2.2.2.2.2.2">𝑑</ci><ci id="algx2.l5.m1.2.2.2.2.2.2.3a.cmml" xref="algx2.l5.m1.2.2.2.2.2.2.3"><mtext id="algx2.l5.m1.2.2.2.2.2.2.3.cmml" mathsize="70%" xref="algx2.l5.m1.2.2.2.2.2.2.3">model</mtext></ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx2.l5.m1.2c">W_{O}^{i}\leftarrow\text{InitializeWeights}(d_{\text{model}}\times\text{num\_%
heads},d_{\text{model}})</annotation><annotation encoding="application/x-llamapun" id="algx2.l5.m1.2d">italic_W start_POSTSUBSCRIPT italic_O end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ← InitializeWeights ( italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT × num_heads , italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algx2.l6">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algx2.l6.1.1.1" style="font-size:80%;">6:</span></span>  <span class="ltx_text ltx_font_bold" id="algx2.l6.2">end</span> <span class="ltx_text ltx_font_bold" id="algx2.l6.3">for</span>
</div>
<div class="ltx_listingline" id="algx2.l7">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algx2.l7.1.1.1" style="font-size:80%;">7:</span></span>  // Masked Multi-Head Self-Attention for input <math alttext="a" class="ltx_Math" display="inline" id="algx2.l7.m1.1"><semantics id="algx2.l7.m1.1a"><mi id="algx2.l7.m1.1.1" xref="algx2.l7.m1.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="algx2.l7.m1.1b"><ci id="algx2.l7.m1.1.1.cmml" xref="algx2.l7.m1.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="algx2.l7.m1.1c">a</annotation><annotation encoding="application/x-llamapun" id="algx2.l7.m1.1d">italic_a</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algx2.l8">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algx2.l8.1.1.1" style="font-size:80%;">8:</span></span>  <span class="ltx_text ltx_font_bold" id="algx2.l8.2">for</span> <math alttext="i=1" class="ltx_Math" display="inline" id="algx2.l8.m1.1"><semantics id="algx2.l8.m1.1a"><mrow id="algx2.l8.m1.1.1" xref="algx2.l8.m1.1.1.cmml"><mi id="algx2.l8.m1.1.1.2" xref="algx2.l8.m1.1.1.2.cmml">i</mi><mo id="algx2.l8.m1.1.1.1" xref="algx2.l8.m1.1.1.1.cmml">=</mo><mn id="algx2.l8.m1.1.1.3" xref="algx2.l8.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="algx2.l8.m1.1b"><apply id="algx2.l8.m1.1.1.cmml" xref="algx2.l8.m1.1.1"><eq id="algx2.l8.m1.1.1.1.cmml" xref="algx2.l8.m1.1.1.1"></eq><ci id="algx2.l8.m1.1.1.2.cmml" xref="algx2.l8.m1.1.1.2">𝑖</ci><cn id="algx2.l8.m1.1.1.3.cmml" type="integer" xref="algx2.l8.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algx2.l8.m1.1c">i=1</annotation><annotation encoding="application/x-llamapun" id="algx2.l8.m1.1d">italic_i = 1</annotation></semantics></math> to <span class="ltx_text ltx_markedasmath" id="algx2.l8.3">num_heads</span> <span class="ltx_text ltx_font_bold" id="algx2.l8.4">do</span>
</div>
<div class="ltx_listingline" id="algx2.l9">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algx2.l9.1.1.1" style="font-size:80%;">9:</span></span>     <math alttext="Q_{a}^{i}\leftarrow a\cdot W_{Q_{a}}^{i}" class="ltx_Math" display="inline" id="algx2.l9.m1.1"><semantics id="algx2.l9.m1.1a"><mrow id="algx2.l9.m1.1.1" xref="algx2.l9.m1.1.1.cmml"><msubsup id="algx2.l9.m1.1.1.2" xref="algx2.l9.m1.1.1.2.cmml"><mi id="algx2.l9.m1.1.1.2.2.2" xref="algx2.l9.m1.1.1.2.2.2.cmml">Q</mi><mi id="algx2.l9.m1.1.1.2.2.3" xref="algx2.l9.m1.1.1.2.2.3.cmml">a</mi><mi id="algx2.l9.m1.1.1.2.3" xref="algx2.l9.m1.1.1.2.3.cmml">i</mi></msubsup><mo id="algx2.l9.m1.1.1.1" stretchy="false" xref="algx2.l9.m1.1.1.1.cmml">←</mo><mrow id="algx2.l9.m1.1.1.3" xref="algx2.l9.m1.1.1.3.cmml"><mi id="algx2.l9.m1.1.1.3.2" xref="algx2.l9.m1.1.1.3.2.cmml">a</mi><mo id="algx2.l9.m1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="algx2.l9.m1.1.1.3.1.cmml">⋅</mo><msubsup id="algx2.l9.m1.1.1.3.3" xref="algx2.l9.m1.1.1.3.3.cmml"><mi id="algx2.l9.m1.1.1.3.3.2.2" xref="algx2.l9.m1.1.1.3.3.2.2.cmml">W</mi><msub id="algx2.l9.m1.1.1.3.3.2.3" xref="algx2.l9.m1.1.1.3.3.2.3.cmml"><mi id="algx2.l9.m1.1.1.3.3.2.3.2" xref="algx2.l9.m1.1.1.3.3.2.3.2.cmml">Q</mi><mi id="algx2.l9.m1.1.1.3.3.2.3.3" xref="algx2.l9.m1.1.1.3.3.2.3.3.cmml">a</mi></msub><mi id="algx2.l9.m1.1.1.3.3.3" xref="algx2.l9.m1.1.1.3.3.3.cmml">i</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx2.l9.m1.1b"><apply id="algx2.l9.m1.1.1.cmml" xref="algx2.l9.m1.1.1"><ci id="algx2.l9.m1.1.1.1.cmml" xref="algx2.l9.m1.1.1.1">←</ci><apply id="algx2.l9.m1.1.1.2.cmml" xref="algx2.l9.m1.1.1.2"><csymbol cd="ambiguous" id="algx2.l9.m1.1.1.2.1.cmml" xref="algx2.l9.m1.1.1.2">superscript</csymbol><apply id="algx2.l9.m1.1.1.2.2.cmml" xref="algx2.l9.m1.1.1.2"><csymbol cd="ambiguous" id="algx2.l9.m1.1.1.2.2.1.cmml" xref="algx2.l9.m1.1.1.2">subscript</csymbol><ci id="algx2.l9.m1.1.1.2.2.2.cmml" xref="algx2.l9.m1.1.1.2.2.2">𝑄</ci><ci id="algx2.l9.m1.1.1.2.2.3.cmml" xref="algx2.l9.m1.1.1.2.2.3">𝑎</ci></apply><ci id="algx2.l9.m1.1.1.2.3.cmml" xref="algx2.l9.m1.1.1.2.3">𝑖</ci></apply><apply id="algx2.l9.m1.1.1.3.cmml" xref="algx2.l9.m1.1.1.3"><ci id="algx2.l9.m1.1.1.3.1.cmml" xref="algx2.l9.m1.1.1.3.1">⋅</ci><ci id="algx2.l9.m1.1.1.3.2.cmml" xref="algx2.l9.m1.1.1.3.2">𝑎</ci><apply id="algx2.l9.m1.1.1.3.3.cmml" xref="algx2.l9.m1.1.1.3.3"><csymbol cd="ambiguous" id="algx2.l9.m1.1.1.3.3.1.cmml" xref="algx2.l9.m1.1.1.3.3">superscript</csymbol><apply id="algx2.l9.m1.1.1.3.3.2.cmml" xref="algx2.l9.m1.1.1.3.3"><csymbol cd="ambiguous" id="algx2.l9.m1.1.1.3.3.2.1.cmml" xref="algx2.l9.m1.1.1.3.3">subscript</csymbol><ci id="algx2.l9.m1.1.1.3.3.2.2.cmml" xref="algx2.l9.m1.1.1.3.3.2.2">𝑊</ci><apply id="algx2.l9.m1.1.1.3.3.2.3.cmml" xref="algx2.l9.m1.1.1.3.3.2.3"><csymbol cd="ambiguous" id="algx2.l9.m1.1.1.3.3.2.3.1.cmml" xref="algx2.l9.m1.1.1.3.3.2.3">subscript</csymbol><ci id="algx2.l9.m1.1.1.3.3.2.3.2.cmml" xref="algx2.l9.m1.1.1.3.3.2.3.2">𝑄</ci><ci id="algx2.l9.m1.1.1.3.3.2.3.3.cmml" xref="algx2.l9.m1.1.1.3.3.2.3.3">𝑎</ci></apply></apply><ci id="algx2.l9.m1.1.1.3.3.3.cmml" xref="algx2.l9.m1.1.1.3.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx2.l9.m1.1c">Q_{a}^{i}\leftarrow a\cdot W_{Q_{a}}^{i}</annotation><annotation encoding="application/x-llamapun" id="algx2.l9.m1.1d">italic_Q start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ← italic_a ⋅ italic_W start_POSTSUBSCRIPT italic_Q start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algx2.l10">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algx2.l10.1.1.1" style="font-size:80%;">10:</span></span>     <math alttext="K_{a}^{i}\leftarrow a\cdot W_{K_{a}}^{i}" class="ltx_Math" display="inline" id="algx2.l10.m1.1"><semantics id="algx2.l10.m1.1a"><mrow id="algx2.l10.m1.1.1" xref="algx2.l10.m1.1.1.cmml"><msubsup id="algx2.l10.m1.1.1.2" xref="algx2.l10.m1.1.1.2.cmml"><mi id="algx2.l10.m1.1.1.2.2.2" xref="algx2.l10.m1.1.1.2.2.2.cmml">K</mi><mi id="algx2.l10.m1.1.1.2.2.3" xref="algx2.l10.m1.1.1.2.2.3.cmml">a</mi><mi id="algx2.l10.m1.1.1.2.3" xref="algx2.l10.m1.1.1.2.3.cmml">i</mi></msubsup><mo id="algx2.l10.m1.1.1.1" stretchy="false" xref="algx2.l10.m1.1.1.1.cmml">←</mo><mrow id="algx2.l10.m1.1.1.3" xref="algx2.l10.m1.1.1.3.cmml"><mi id="algx2.l10.m1.1.1.3.2" xref="algx2.l10.m1.1.1.3.2.cmml">a</mi><mo id="algx2.l10.m1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="algx2.l10.m1.1.1.3.1.cmml">⋅</mo><msubsup id="algx2.l10.m1.1.1.3.3" xref="algx2.l10.m1.1.1.3.3.cmml"><mi id="algx2.l10.m1.1.1.3.3.2.2" xref="algx2.l10.m1.1.1.3.3.2.2.cmml">W</mi><msub id="algx2.l10.m1.1.1.3.3.2.3" xref="algx2.l10.m1.1.1.3.3.2.3.cmml"><mi id="algx2.l10.m1.1.1.3.3.2.3.2" xref="algx2.l10.m1.1.1.3.3.2.3.2.cmml">K</mi><mi id="algx2.l10.m1.1.1.3.3.2.3.3" xref="algx2.l10.m1.1.1.3.3.2.3.3.cmml">a</mi></msub><mi id="algx2.l10.m1.1.1.3.3.3" xref="algx2.l10.m1.1.1.3.3.3.cmml">i</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx2.l10.m1.1b"><apply id="algx2.l10.m1.1.1.cmml" xref="algx2.l10.m1.1.1"><ci id="algx2.l10.m1.1.1.1.cmml" xref="algx2.l10.m1.1.1.1">←</ci><apply id="algx2.l10.m1.1.1.2.cmml" xref="algx2.l10.m1.1.1.2"><csymbol cd="ambiguous" id="algx2.l10.m1.1.1.2.1.cmml" xref="algx2.l10.m1.1.1.2">superscript</csymbol><apply id="algx2.l10.m1.1.1.2.2.cmml" xref="algx2.l10.m1.1.1.2"><csymbol cd="ambiguous" id="algx2.l10.m1.1.1.2.2.1.cmml" xref="algx2.l10.m1.1.1.2">subscript</csymbol><ci id="algx2.l10.m1.1.1.2.2.2.cmml" xref="algx2.l10.m1.1.1.2.2.2">𝐾</ci><ci id="algx2.l10.m1.1.1.2.2.3.cmml" xref="algx2.l10.m1.1.1.2.2.3">𝑎</ci></apply><ci id="algx2.l10.m1.1.1.2.3.cmml" xref="algx2.l10.m1.1.1.2.3">𝑖</ci></apply><apply id="algx2.l10.m1.1.1.3.cmml" xref="algx2.l10.m1.1.1.3"><ci id="algx2.l10.m1.1.1.3.1.cmml" xref="algx2.l10.m1.1.1.3.1">⋅</ci><ci id="algx2.l10.m1.1.1.3.2.cmml" xref="algx2.l10.m1.1.1.3.2">𝑎</ci><apply id="algx2.l10.m1.1.1.3.3.cmml" xref="algx2.l10.m1.1.1.3.3"><csymbol cd="ambiguous" id="algx2.l10.m1.1.1.3.3.1.cmml" xref="algx2.l10.m1.1.1.3.3">superscript</csymbol><apply id="algx2.l10.m1.1.1.3.3.2.cmml" xref="algx2.l10.m1.1.1.3.3"><csymbol cd="ambiguous" id="algx2.l10.m1.1.1.3.3.2.1.cmml" xref="algx2.l10.m1.1.1.3.3">subscript</csymbol><ci id="algx2.l10.m1.1.1.3.3.2.2.cmml" xref="algx2.l10.m1.1.1.3.3.2.2">𝑊</ci><apply id="algx2.l10.m1.1.1.3.3.2.3.cmml" xref="algx2.l10.m1.1.1.3.3.2.3"><csymbol cd="ambiguous" id="algx2.l10.m1.1.1.3.3.2.3.1.cmml" xref="algx2.l10.m1.1.1.3.3.2.3">subscript</csymbol><ci id="algx2.l10.m1.1.1.3.3.2.3.2.cmml" xref="algx2.l10.m1.1.1.3.3.2.3.2">𝐾</ci><ci id="algx2.l10.m1.1.1.3.3.2.3.3.cmml" xref="algx2.l10.m1.1.1.3.3.2.3.3">𝑎</ci></apply></apply><ci id="algx2.l10.m1.1.1.3.3.3.cmml" xref="algx2.l10.m1.1.1.3.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx2.l10.m1.1c">K_{a}^{i}\leftarrow a\cdot W_{K_{a}}^{i}</annotation><annotation encoding="application/x-llamapun" id="algx2.l10.m1.1d">italic_K start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ← italic_a ⋅ italic_W start_POSTSUBSCRIPT italic_K start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algx2.l11">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algx2.l11.1.1.1" style="font-size:80%;">11:</span></span>     <math alttext="V_{a}^{i}\leftarrow a\cdot W_{V_{a}}^{i}" class="ltx_Math" display="inline" id="algx2.l11.m1.1"><semantics id="algx2.l11.m1.1a"><mrow id="algx2.l11.m1.1.1" xref="algx2.l11.m1.1.1.cmml"><msubsup id="algx2.l11.m1.1.1.2" xref="algx2.l11.m1.1.1.2.cmml"><mi id="algx2.l11.m1.1.1.2.2.2" xref="algx2.l11.m1.1.1.2.2.2.cmml">V</mi><mi id="algx2.l11.m1.1.1.2.2.3" xref="algx2.l11.m1.1.1.2.2.3.cmml">a</mi><mi id="algx2.l11.m1.1.1.2.3" xref="algx2.l11.m1.1.1.2.3.cmml">i</mi></msubsup><mo id="algx2.l11.m1.1.1.1" stretchy="false" xref="algx2.l11.m1.1.1.1.cmml">←</mo><mrow id="algx2.l11.m1.1.1.3" xref="algx2.l11.m1.1.1.3.cmml"><mi id="algx2.l11.m1.1.1.3.2" xref="algx2.l11.m1.1.1.3.2.cmml">a</mi><mo id="algx2.l11.m1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="algx2.l11.m1.1.1.3.1.cmml">⋅</mo><msubsup id="algx2.l11.m1.1.1.3.3" xref="algx2.l11.m1.1.1.3.3.cmml"><mi id="algx2.l11.m1.1.1.3.3.2.2" xref="algx2.l11.m1.1.1.3.3.2.2.cmml">W</mi><msub id="algx2.l11.m1.1.1.3.3.2.3" xref="algx2.l11.m1.1.1.3.3.2.3.cmml"><mi id="algx2.l11.m1.1.1.3.3.2.3.2" xref="algx2.l11.m1.1.1.3.3.2.3.2.cmml">V</mi><mi id="algx2.l11.m1.1.1.3.3.2.3.3" xref="algx2.l11.m1.1.1.3.3.2.3.3.cmml">a</mi></msub><mi id="algx2.l11.m1.1.1.3.3.3" xref="algx2.l11.m1.1.1.3.3.3.cmml">i</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx2.l11.m1.1b"><apply id="algx2.l11.m1.1.1.cmml" xref="algx2.l11.m1.1.1"><ci id="algx2.l11.m1.1.1.1.cmml" xref="algx2.l11.m1.1.1.1">←</ci><apply id="algx2.l11.m1.1.1.2.cmml" xref="algx2.l11.m1.1.1.2"><csymbol cd="ambiguous" id="algx2.l11.m1.1.1.2.1.cmml" xref="algx2.l11.m1.1.1.2">superscript</csymbol><apply id="algx2.l11.m1.1.1.2.2.cmml" xref="algx2.l11.m1.1.1.2"><csymbol cd="ambiguous" id="algx2.l11.m1.1.1.2.2.1.cmml" xref="algx2.l11.m1.1.1.2">subscript</csymbol><ci id="algx2.l11.m1.1.1.2.2.2.cmml" xref="algx2.l11.m1.1.1.2.2.2">𝑉</ci><ci id="algx2.l11.m1.1.1.2.2.3.cmml" xref="algx2.l11.m1.1.1.2.2.3">𝑎</ci></apply><ci id="algx2.l11.m1.1.1.2.3.cmml" xref="algx2.l11.m1.1.1.2.3">𝑖</ci></apply><apply id="algx2.l11.m1.1.1.3.cmml" xref="algx2.l11.m1.1.1.3"><ci id="algx2.l11.m1.1.1.3.1.cmml" xref="algx2.l11.m1.1.1.3.1">⋅</ci><ci id="algx2.l11.m1.1.1.3.2.cmml" xref="algx2.l11.m1.1.1.3.2">𝑎</ci><apply id="algx2.l11.m1.1.1.3.3.cmml" xref="algx2.l11.m1.1.1.3.3"><csymbol cd="ambiguous" id="algx2.l11.m1.1.1.3.3.1.cmml" xref="algx2.l11.m1.1.1.3.3">superscript</csymbol><apply id="algx2.l11.m1.1.1.3.3.2.cmml" xref="algx2.l11.m1.1.1.3.3"><csymbol cd="ambiguous" id="algx2.l11.m1.1.1.3.3.2.1.cmml" xref="algx2.l11.m1.1.1.3.3">subscript</csymbol><ci id="algx2.l11.m1.1.1.3.3.2.2.cmml" xref="algx2.l11.m1.1.1.3.3.2.2">𝑊</ci><apply id="algx2.l11.m1.1.1.3.3.2.3.cmml" xref="algx2.l11.m1.1.1.3.3.2.3"><csymbol cd="ambiguous" id="algx2.l11.m1.1.1.3.3.2.3.1.cmml" xref="algx2.l11.m1.1.1.3.3.2.3">subscript</csymbol><ci id="algx2.l11.m1.1.1.3.3.2.3.2.cmml" xref="algx2.l11.m1.1.1.3.3.2.3.2">𝑉</ci><ci id="algx2.l11.m1.1.1.3.3.2.3.3.cmml" xref="algx2.l11.m1.1.1.3.3.2.3.3">𝑎</ci></apply></apply><ci id="algx2.l11.m1.1.1.3.3.3.cmml" xref="algx2.l11.m1.1.1.3.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx2.l11.m1.1c">V_{a}^{i}\leftarrow a\cdot W_{V_{a}}^{i}</annotation><annotation encoding="application/x-llamapun" id="algx2.l11.m1.1d">italic_V start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ← italic_a ⋅ italic_W start_POSTSUBSCRIPT italic_V start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algx2.l12">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algx2.l12.1.1.1" style="font-size:80%;">12:</span></span>     <math alttext="MaskedAttentionWeights^{i}\leftarrow\text{Softmax}\left(\frac{Q_{a}^{i}\cdot(K%
_{a}^{i})^{\top}}{\sqrt{d_{k}}}\cdot\text{Mask}\right)" class="ltx_Math" display="inline" id="algx2.l12.m1.2"><semantics id="algx2.l12.m1.2a"><mrow id="algx2.l12.m1.2.2" xref="algx2.l12.m1.2.2.cmml"><mrow id="algx2.l12.m1.2.2.3" xref="algx2.l12.m1.2.2.3.cmml"><mi id="algx2.l12.m1.2.2.3.2" xref="algx2.l12.m1.2.2.3.2.cmml">M</mi><mo id="algx2.l12.m1.2.2.3.1" xref="algx2.l12.m1.2.2.3.1.cmml">⁢</mo><mi id="algx2.l12.m1.2.2.3.3" xref="algx2.l12.m1.2.2.3.3.cmml">a</mi><mo id="algx2.l12.m1.2.2.3.1a" xref="algx2.l12.m1.2.2.3.1.cmml">⁢</mo><mi id="algx2.l12.m1.2.2.3.4" xref="algx2.l12.m1.2.2.3.4.cmml">s</mi><mo id="algx2.l12.m1.2.2.3.1b" xref="algx2.l12.m1.2.2.3.1.cmml">⁢</mo><mi id="algx2.l12.m1.2.2.3.5" xref="algx2.l12.m1.2.2.3.5.cmml">k</mi><mo id="algx2.l12.m1.2.2.3.1c" xref="algx2.l12.m1.2.2.3.1.cmml">⁢</mo><mi id="algx2.l12.m1.2.2.3.6" xref="algx2.l12.m1.2.2.3.6.cmml">e</mi><mo id="algx2.l12.m1.2.2.3.1d" xref="algx2.l12.m1.2.2.3.1.cmml">⁢</mo><mi id="algx2.l12.m1.2.2.3.7" xref="algx2.l12.m1.2.2.3.7.cmml">d</mi><mo id="algx2.l12.m1.2.2.3.1e" xref="algx2.l12.m1.2.2.3.1.cmml">⁢</mo><mi id="algx2.l12.m1.2.2.3.8" xref="algx2.l12.m1.2.2.3.8.cmml">A</mi><mo id="algx2.l12.m1.2.2.3.1f" xref="algx2.l12.m1.2.2.3.1.cmml">⁢</mo><mi id="algx2.l12.m1.2.2.3.9" xref="algx2.l12.m1.2.2.3.9.cmml">t</mi><mo id="algx2.l12.m1.2.2.3.1g" xref="algx2.l12.m1.2.2.3.1.cmml">⁢</mo><mi id="algx2.l12.m1.2.2.3.10" xref="algx2.l12.m1.2.2.3.10.cmml">t</mi><mo id="algx2.l12.m1.2.2.3.1h" xref="algx2.l12.m1.2.2.3.1.cmml">⁢</mo><mi id="algx2.l12.m1.2.2.3.11" xref="algx2.l12.m1.2.2.3.11.cmml">e</mi><mo id="algx2.l12.m1.2.2.3.1i" xref="algx2.l12.m1.2.2.3.1.cmml">⁢</mo><mi id="algx2.l12.m1.2.2.3.12" xref="algx2.l12.m1.2.2.3.12.cmml">n</mi><mo id="algx2.l12.m1.2.2.3.1j" xref="algx2.l12.m1.2.2.3.1.cmml">⁢</mo><mi id="algx2.l12.m1.2.2.3.13" xref="algx2.l12.m1.2.2.3.13.cmml">t</mi><mo id="algx2.l12.m1.2.2.3.1k" xref="algx2.l12.m1.2.2.3.1.cmml">⁢</mo><mi id="algx2.l12.m1.2.2.3.14" xref="algx2.l12.m1.2.2.3.14.cmml">i</mi><mo id="algx2.l12.m1.2.2.3.1l" xref="algx2.l12.m1.2.2.3.1.cmml">⁢</mo><mi id="algx2.l12.m1.2.2.3.15" xref="algx2.l12.m1.2.2.3.15.cmml">o</mi><mo id="algx2.l12.m1.2.2.3.1m" xref="algx2.l12.m1.2.2.3.1.cmml">⁢</mo><mi id="algx2.l12.m1.2.2.3.16" xref="algx2.l12.m1.2.2.3.16.cmml">n</mi><mo id="algx2.l12.m1.2.2.3.1n" xref="algx2.l12.m1.2.2.3.1.cmml">⁢</mo><mi id="algx2.l12.m1.2.2.3.17" xref="algx2.l12.m1.2.2.3.17.cmml">W</mi><mo id="algx2.l12.m1.2.2.3.1o" xref="algx2.l12.m1.2.2.3.1.cmml">⁢</mo><mi id="algx2.l12.m1.2.2.3.18" xref="algx2.l12.m1.2.2.3.18.cmml">e</mi><mo id="algx2.l12.m1.2.2.3.1p" xref="algx2.l12.m1.2.2.3.1.cmml">⁢</mo><mi id="algx2.l12.m1.2.2.3.19" xref="algx2.l12.m1.2.2.3.19.cmml">i</mi><mo id="algx2.l12.m1.2.2.3.1q" xref="algx2.l12.m1.2.2.3.1.cmml">⁢</mo><mi id="algx2.l12.m1.2.2.3.20" xref="algx2.l12.m1.2.2.3.20.cmml">g</mi><mo id="algx2.l12.m1.2.2.3.1r" xref="algx2.l12.m1.2.2.3.1.cmml">⁢</mo><mi id="algx2.l12.m1.2.2.3.21" xref="algx2.l12.m1.2.2.3.21.cmml">h</mi><mo id="algx2.l12.m1.2.2.3.1s" xref="algx2.l12.m1.2.2.3.1.cmml">⁢</mo><mi id="algx2.l12.m1.2.2.3.22" xref="algx2.l12.m1.2.2.3.22.cmml">t</mi><mo id="algx2.l12.m1.2.2.3.1t" xref="algx2.l12.m1.2.2.3.1.cmml">⁢</mo><msup id="algx2.l12.m1.2.2.3.23" xref="algx2.l12.m1.2.2.3.23.cmml"><mi id="algx2.l12.m1.2.2.3.23.2" xref="algx2.l12.m1.2.2.3.23.2.cmml">s</mi><mi id="algx2.l12.m1.2.2.3.23.3" xref="algx2.l12.m1.2.2.3.23.3.cmml">i</mi></msup></mrow><mo id="algx2.l12.m1.2.2.2" stretchy="false" xref="algx2.l12.m1.2.2.2.cmml">←</mo><mrow id="algx2.l12.m1.2.2.1" xref="algx2.l12.m1.2.2.1.cmml"><mtext id="algx2.l12.m1.2.2.1.3" xref="algx2.l12.m1.2.2.1.3a.cmml">Softmax</mtext><mo id="algx2.l12.m1.2.2.1.2" xref="algx2.l12.m1.2.2.1.2.cmml">⁢</mo><mrow id="algx2.l12.m1.2.2.1.1.1" xref="algx2.l12.m1.2.2.1.1.1.1.cmml"><mo id="algx2.l12.m1.2.2.1.1.1.2" xref="algx2.l12.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="algx2.l12.m1.2.2.1.1.1.1" xref="algx2.l12.m1.2.2.1.1.1.1.cmml"><mfrac id="algx2.l12.m1.1.1" xref="algx2.l12.m1.1.1.cmml"><mrow id="algx2.l12.m1.1.1.1" xref="algx2.l12.m1.1.1.1.cmml"><msubsup id="algx2.l12.m1.1.1.1.3" xref="algx2.l12.m1.1.1.1.3.cmml"><mi id="algx2.l12.m1.1.1.1.3.2.2" xref="algx2.l12.m1.1.1.1.3.2.2.cmml">Q</mi><mi id="algx2.l12.m1.1.1.1.3.2.3" xref="algx2.l12.m1.1.1.1.3.2.3.cmml">a</mi><mi id="algx2.l12.m1.1.1.1.3.3" xref="algx2.l12.m1.1.1.1.3.3.cmml">i</mi></msubsup><mo id="algx2.l12.m1.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="algx2.l12.m1.1.1.1.2.cmml">⋅</mo><msup id="algx2.l12.m1.1.1.1.1" xref="algx2.l12.m1.1.1.1.1.cmml"><mrow id="algx2.l12.m1.1.1.1.1.1.1" xref="algx2.l12.m1.1.1.1.1.1.1.1.cmml"><mo id="algx2.l12.m1.1.1.1.1.1.1.2" stretchy="false" xref="algx2.l12.m1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="algx2.l12.m1.1.1.1.1.1.1.1" xref="algx2.l12.m1.1.1.1.1.1.1.1.cmml"><mi id="algx2.l12.m1.1.1.1.1.1.1.1.2.2" xref="algx2.l12.m1.1.1.1.1.1.1.1.2.2.cmml">K</mi><mi id="algx2.l12.m1.1.1.1.1.1.1.1.2.3" xref="algx2.l12.m1.1.1.1.1.1.1.1.2.3.cmml">a</mi><mi id="algx2.l12.m1.1.1.1.1.1.1.1.3" xref="algx2.l12.m1.1.1.1.1.1.1.1.3.cmml">i</mi></msubsup><mo id="algx2.l12.m1.1.1.1.1.1.1.3" stretchy="false" xref="algx2.l12.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="algx2.l12.m1.1.1.1.1.3" xref="algx2.l12.m1.1.1.1.1.3.cmml">⊤</mo></msup></mrow><msqrt id="algx2.l12.m1.1.1.3" xref="algx2.l12.m1.1.1.3.cmml"><msub id="algx2.l12.m1.1.1.3.2" xref="algx2.l12.m1.1.1.3.2.cmml"><mi id="algx2.l12.m1.1.1.3.2.2" xref="algx2.l12.m1.1.1.3.2.2.cmml">d</mi><mi id="algx2.l12.m1.1.1.3.2.3" xref="algx2.l12.m1.1.1.3.2.3.cmml">k</mi></msub></msqrt></mfrac><mo id="algx2.l12.m1.2.2.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="algx2.l12.m1.2.2.1.1.1.1.1.cmml">⋅</mo><mtext id="algx2.l12.m1.2.2.1.1.1.1.2" xref="algx2.l12.m1.2.2.1.1.1.1.2a.cmml">Mask</mtext></mrow><mo id="algx2.l12.m1.2.2.1.1.1.3" xref="algx2.l12.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx2.l12.m1.2b"><apply id="algx2.l12.m1.2.2.cmml" xref="algx2.l12.m1.2.2"><ci id="algx2.l12.m1.2.2.2.cmml" xref="algx2.l12.m1.2.2.2">←</ci><apply id="algx2.l12.m1.2.2.3.cmml" xref="algx2.l12.m1.2.2.3"><times id="algx2.l12.m1.2.2.3.1.cmml" xref="algx2.l12.m1.2.2.3.1"></times><ci id="algx2.l12.m1.2.2.3.2.cmml" xref="algx2.l12.m1.2.2.3.2">𝑀</ci><ci id="algx2.l12.m1.2.2.3.3.cmml" xref="algx2.l12.m1.2.2.3.3">𝑎</ci><ci id="algx2.l12.m1.2.2.3.4.cmml" xref="algx2.l12.m1.2.2.3.4">𝑠</ci><ci id="algx2.l12.m1.2.2.3.5.cmml" xref="algx2.l12.m1.2.2.3.5">𝑘</ci><ci id="algx2.l12.m1.2.2.3.6.cmml" xref="algx2.l12.m1.2.2.3.6">𝑒</ci><ci id="algx2.l12.m1.2.2.3.7.cmml" xref="algx2.l12.m1.2.2.3.7">𝑑</ci><ci id="algx2.l12.m1.2.2.3.8.cmml" xref="algx2.l12.m1.2.2.3.8">𝐴</ci><ci id="algx2.l12.m1.2.2.3.9.cmml" xref="algx2.l12.m1.2.2.3.9">𝑡</ci><ci id="algx2.l12.m1.2.2.3.10.cmml" xref="algx2.l12.m1.2.2.3.10">𝑡</ci><ci id="algx2.l12.m1.2.2.3.11.cmml" xref="algx2.l12.m1.2.2.3.11">𝑒</ci><ci id="algx2.l12.m1.2.2.3.12.cmml" xref="algx2.l12.m1.2.2.3.12">𝑛</ci><ci id="algx2.l12.m1.2.2.3.13.cmml" xref="algx2.l12.m1.2.2.3.13">𝑡</ci><ci id="algx2.l12.m1.2.2.3.14.cmml" xref="algx2.l12.m1.2.2.3.14">𝑖</ci><ci id="algx2.l12.m1.2.2.3.15.cmml" xref="algx2.l12.m1.2.2.3.15">𝑜</ci><ci id="algx2.l12.m1.2.2.3.16.cmml" xref="algx2.l12.m1.2.2.3.16">𝑛</ci><ci id="algx2.l12.m1.2.2.3.17.cmml" xref="algx2.l12.m1.2.2.3.17">𝑊</ci><ci id="algx2.l12.m1.2.2.3.18.cmml" xref="algx2.l12.m1.2.2.3.18">𝑒</ci><ci id="algx2.l12.m1.2.2.3.19.cmml" xref="algx2.l12.m1.2.2.3.19">𝑖</ci><ci id="algx2.l12.m1.2.2.3.20.cmml" xref="algx2.l12.m1.2.2.3.20">𝑔</ci><ci id="algx2.l12.m1.2.2.3.21.cmml" xref="algx2.l12.m1.2.2.3.21">ℎ</ci><ci id="algx2.l12.m1.2.2.3.22.cmml" xref="algx2.l12.m1.2.2.3.22">𝑡</ci><apply id="algx2.l12.m1.2.2.3.23.cmml" xref="algx2.l12.m1.2.2.3.23"><csymbol cd="ambiguous" id="algx2.l12.m1.2.2.3.23.1.cmml" xref="algx2.l12.m1.2.2.3.23">superscript</csymbol><ci id="algx2.l12.m1.2.2.3.23.2.cmml" xref="algx2.l12.m1.2.2.3.23.2">𝑠</ci><ci id="algx2.l12.m1.2.2.3.23.3.cmml" xref="algx2.l12.m1.2.2.3.23.3">𝑖</ci></apply></apply><apply id="algx2.l12.m1.2.2.1.cmml" xref="algx2.l12.m1.2.2.1"><times id="algx2.l12.m1.2.2.1.2.cmml" xref="algx2.l12.m1.2.2.1.2"></times><ci id="algx2.l12.m1.2.2.1.3a.cmml" xref="algx2.l12.m1.2.2.1.3"><mtext id="algx2.l12.m1.2.2.1.3.cmml" xref="algx2.l12.m1.2.2.1.3">Softmax</mtext></ci><apply id="algx2.l12.m1.2.2.1.1.1.1.cmml" xref="algx2.l12.m1.2.2.1.1.1"><ci id="algx2.l12.m1.2.2.1.1.1.1.1.cmml" xref="algx2.l12.m1.2.2.1.1.1.1.1">⋅</ci><apply id="algx2.l12.m1.1.1.cmml" xref="algx2.l12.m1.1.1"><divide id="algx2.l12.m1.1.1.2.cmml" xref="algx2.l12.m1.1.1"></divide><apply id="algx2.l12.m1.1.1.1.cmml" xref="algx2.l12.m1.1.1.1"><ci id="algx2.l12.m1.1.1.1.2.cmml" xref="algx2.l12.m1.1.1.1.2">⋅</ci><apply id="algx2.l12.m1.1.1.1.3.cmml" xref="algx2.l12.m1.1.1.1.3"><csymbol cd="ambiguous" id="algx2.l12.m1.1.1.1.3.1.cmml" xref="algx2.l12.m1.1.1.1.3">superscript</csymbol><apply id="algx2.l12.m1.1.1.1.3.2.cmml" xref="algx2.l12.m1.1.1.1.3"><csymbol cd="ambiguous" id="algx2.l12.m1.1.1.1.3.2.1.cmml" xref="algx2.l12.m1.1.1.1.3">subscript</csymbol><ci id="algx2.l12.m1.1.1.1.3.2.2.cmml" xref="algx2.l12.m1.1.1.1.3.2.2">𝑄</ci><ci id="algx2.l12.m1.1.1.1.3.2.3.cmml" xref="algx2.l12.m1.1.1.1.3.2.3">𝑎</ci></apply><ci id="algx2.l12.m1.1.1.1.3.3.cmml" xref="algx2.l12.m1.1.1.1.3.3">𝑖</ci></apply><apply id="algx2.l12.m1.1.1.1.1.cmml" xref="algx2.l12.m1.1.1.1.1"><csymbol cd="ambiguous" id="algx2.l12.m1.1.1.1.1.2.cmml" xref="algx2.l12.m1.1.1.1.1">superscript</csymbol><apply id="algx2.l12.m1.1.1.1.1.1.1.1.cmml" xref="algx2.l12.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algx2.l12.m1.1.1.1.1.1.1.1.1.cmml" xref="algx2.l12.m1.1.1.1.1.1.1">superscript</csymbol><apply id="algx2.l12.m1.1.1.1.1.1.1.1.2.cmml" xref="algx2.l12.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algx2.l12.m1.1.1.1.1.1.1.1.2.1.cmml" xref="algx2.l12.m1.1.1.1.1.1.1">subscript</csymbol><ci id="algx2.l12.m1.1.1.1.1.1.1.1.2.2.cmml" xref="algx2.l12.m1.1.1.1.1.1.1.1.2.2">𝐾</ci><ci id="algx2.l12.m1.1.1.1.1.1.1.1.2.3.cmml" xref="algx2.l12.m1.1.1.1.1.1.1.1.2.3">𝑎</ci></apply><ci id="algx2.l12.m1.1.1.1.1.1.1.1.3.cmml" xref="algx2.l12.m1.1.1.1.1.1.1.1.3">𝑖</ci></apply><csymbol cd="latexml" id="algx2.l12.m1.1.1.1.1.3.cmml" xref="algx2.l12.m1.1.1.1.1.3">top</csymbol></apply></apply><apply id="algx2.l12.m1.1.1.3.cmml" xref="algx2.l12.m1.1.1.3"><root id="algx2.l12.m1.1.1.3a.cmml" xref="algx2.l12.m1.1.1.3"></root><apply id="algx2.l12.m1.1.1.3.2.cmml" xref="algx2.l12.m1.1.1.3.2"><csymbol cd="ambiguous" id="algx2.l12.m1.1.1.3.2.1.cmml" xref="algx2.l12.m1.1.1.3.2">subscript</csymbol><ci id="algx2.l12.m1.1.1.3.2.2.cmml" xref="algx2.l12.m1.1.1.3.2.2">𝑑</ci><ci id="algx2.l12.m1.1.1.3.2.3.cmml" xref="algx2.l12.m1.1.1.3.2.3">𝑘</ci></apply></apply></apply><ci id="algx2.l12.m1.2.2.1.1.1.1.2a.cmml" xref="algx2.l12.m1.2.2.1.1.1.1.2"><mtext id="algx2.l12.m1.2.2.1.1.1.1.2.cmml" xref="algx2.l12.m1.2.2.1.1.1.1.2">Mask</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx2.l12.m1.2c">MaskedAttentionWeights^{i}\leftarrow\text{Softmax}\left(\frac{Q_{a}^{i}\cdot(K%
_{a}^{i})^{\top}}{\sqrt{d_{k}}}\cdot\text{Mask}\right)</annotation><annotation encoding="application/x-llamapun" id="algx2.l12.m1.2d">italic_M italic_a italic_s italic_k italic_e italic_d italic_A italic_t italic_t italic_e italic_n italic_t italic_i italic_o italic_n italic_W italic_e italic_i italic_g italic_h italic_t italic_s start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ← Softmax ( divide start_ARG italic_Q start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ⋅ ( italic_K start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT end_ARG start_ARG square-root start_ARG italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_ARG end_ARG ⋅ Mask )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algx2.l13">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algx2.l13.1.1.1" style="font-size:80%;">13:</span></span>     <math alttext="MaskedSelfAttention^{i}\leftarrow MaskedAttentionWeights^{i}\cdot V_{a}^{i}" class="ltx_Math" display="inline" id="algx2.l13.m1.1"><semantics id="algx2.l13.m1.1a"><mrow id="algx2.l13.m1.1.1" xref="algx2.l13.m1.1.1.cmml"><mrow id="algx2.l13.m1.1.1.2" xref="algx2.l13.m1.1.1.2.cmml"><mi id="algx2.l13.m1.1.1.2.2" xref="algx2.l13.m1.1.1.2.2.cmml">M</mi><mo id="algx2.l13.m1.1.1.2.1" xref="algx2.l13.m1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l13.m1.1.1.2.3" xref="algx2.l13.m1.1.1.2.3.cmml">a</mi><mo id="algx2.l13.m1.1.1.2.1a" xref="algx2.l13.m1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l13.m1.1.1.2.4" xref="algx2.l13.m1.1.1.2.4.cmml">s</mi><mo id="algx2.l13.m1.1.1.2.1b" xref="algx2.l13.m1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l13.m1.1.1.2.5" xref="algx2.l13.m1.1.1.2.5.cmml">k</mi><mo id="algx2.l13.m1.1.1.2.1c" xref="algx2.l13.m1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l13.m1.1.1.2.6" xref="algx2.l13.m1.1.1.2.6.cmml">e</mi><mo id="algx2.l13.m1.1.1.2.1d" xref="algx2.l13.m1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l13.m1.1.1.2.7" xref="algx2.l13.m1.1.1.2.7.cmml">d</mi><mo id="algx2.l13.m1.1.1.2.1e" xref="algx2.l13.m1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l13.m1.1.1.2.8" xref="algx2.l13.m1.1.1.2.8.cmml">S</mi><mo id="algx2.l13.m1.1.1.2.1f" xref="algx2.l13.m1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l13.m1.1.1.2.9" xref="algx2.l13.m1.1.1.2.9.cmml">e</mi><mo id="algx2.l13.m1.1.1.2.1g" xref="algx2.l13.m1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l13.m1.1.1.2.10" xref="algx2.l13.m1.1.1.2.10.cmml">l</mi><mo id="algx2.l13.m1.1.1.2.1h" xref="algx2.l13.m1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l13.m1.1.1.2.11" xref="algx2.l13.m1.1.1.2.11.cmml">f</mi><mo id="algx2.l13.m1.1.1.2.1i" xref="algx2.l13.m1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l13.m1.1.1.2.12" xref="algx2.l13.m1.1.1.2.12.cmml">A</mi><mo id="algx2.l13.m1.1.1.2.1j" xref="algx2.l13.m1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l13.m1.1.1.2.13" xref="algx2.l13.m1.1.1.2.13.cmml">t</mi><mo id="algx2.l13.m1.1.1.2.1k" xref="algx2.l13.m1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l13.m1.1.1.2.14" xref="algx2.l13.m1.1.1.2.14.cmml">t</mi><mo id="algx2.l13.m1.1.1.2.1l" xref="algx2.l13.m1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l13.m1.1.1.2.15" xref="algx2.l13.m1.1.1.2.15.cmml">e</mi><mo id="algx2.l13.m1.1.1.2.1m" xref="algx2.l13.m1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l13.m1.1.1.2.16" xref="algx2.l13.m1.1.1.2.16.cmml">n</mi><mo id="algx2.l13.m1.1.1.2.1n" xref="algx2.l13.m1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l13.m1.1.1.2.17" xref="algx2.l13.m1.1.1.2.17.cmml">t</mi><mo id="algx2.l13.m1.1.1.2.1o" xref="algx2.l13.m1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l13.m1.1.1.2.18" xref="algx2.l13.m1.1.1.2.18.cmml">i</mi><mo id="algx2.l13.m1.1.1.2.1p" xref="algx2.l13.m1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l13.m1.1.1.2.19" xref="algx2.l13.m1.1.1.2.19.cmml">o</mi><mo id="algx2.l13.m1.1.1.2.1q" xref="algx2.l13.m1.1.1.2.1.cmml">⁢</mo><msup id="algx2.l13.m1.1.1.2.20" xref="algx2.l13.m1.1.1.2.20.cmml"><mi id="algx2.l13.m1.1.1.2.20.2" xref="algx2.l13.m1.1.1.2.20.2.cmml">n</mi><mi id="algx2.l13.m1.1.1.2.20.3" xref="algx2.l13.m1.1.1.2.20.3.cmml">i</mi></msup></mrow><mo id="algx2.l13.m1.1.1.1" stretchy="false" xref="algx2.l13.m1.1.1.1.cmml">←</mo><mrow id="algx2.l13.m1.1.1.3" xref="algx2.l13.m1.1.1.3.cmml"><mrow id="algx2.l13.m1.1.1.3.2" xref="algx2.l13.m1.1.1.3.2.cmml"><mi id="algx2.l13.m1.1.1.3.2.2" xref="algx2.l13.m1.1.1.3.2.2.cmml">M</mi><mo id="algx2.l13.m1.1.1.3.2.1" xref="algx2.l13.m1.1.1.3.2.1.cmml">⁢</mo><mi id="algx2.l13.m1.1.1.3.2.3" xref="algx2.l13.m1.1.1.3.2.3.cmml">a</mi><mo id="algx2.l13.m1.1.1.3.2.1a" xref="algx2.l13.m1.1.1.3.2.1.cmml">⁢</mo><mi id="algx2.l13.m1.1.1.3.2.4" xref="algx2.l13.m1.1.1.3.2.4.cmml">s</mi><mo id="algx2.l13.m1.1.1.3.2.1b" xref="algx2.l13.m1.1.1.3.2.1.cmml">⁢</mo><mi id="algx2.l13.m1.1.1.3.2.5" xref="algx2.l13.m1.1.1.3.2.5.cmml">k</mi><mo id="algx2.l13.m1.1.1.3.2.1c" xref="algx2.l13.m1.1.1.3.2.1.cmml">⁢</mo><mi id="algx2.l13.m1.1.1.3.2.6" xref="algx2.l13.m1.1.1.3.2.6.cmml">e</mi><mo id="algx2.l13.m1.1.1.3.2.1d" xref="algx2.l13.m1.1.1.3.2.1.cmml">⁢</mo><mi id="algx2.l13.m1.1.1.3.2.7" xref="algx2.l13.m1.1.1.3.2.7.cmml">d</mi><mo id="algx2.l13.m1.1.1.3.2.1e" xref="algx2.l13.m1.1.1.3.2.1.cmml">⁢</mo><mi id="algx2.l13.m1.1.1.3.2.8" xref="algx2.l13.m1.1.1.3.2.8.cmml">A</mi><mo id="algx2.l13.m1.1.1.3.2.1f" xref="algx2.l13.m1.1.1.3.2.1.cmml">⁢</mo><mi id="algx2.l13.m1.1.1.3.2.9" xref="algx2.l13.m1.1.1.3.2.9.cmml">t</mi><mo id="algx2.l13.m1.1.1.3.2.1g" xref="algx2.l13.m1.1.1.3.2.1.cmml">⁢</mo><mi id="algx2.l13.m1.1.1.3.2.10" xref="algx2.l13.m1.1.1.3.2.10.cmml">t</mi><mo id="algx2.l13.m1.1.1.3.2.1h" xref="algx2.l13.m1.1.1.3.2.1.cmml">⁢</mo><mi id="algx2.l13.m1.1.1.3.2.11" xref="algx2.l13.m1.1.1.3.2.11.cmml">e</mi><mo id="algx2.l13.m1.1.1.3.2.1i" xref="algx2.l13.m1.1.1.3.2.1.cmml">⁢</mo><mi id="algx2.l13.m1.1.1.3.2.12" xref="algx2.l13.m1.1.1.3.2.12.cmml">n</mi><mo id="algx2.l13.m1.1.1.3.2.1j" xref="algx2.l13.m1.1.1.3.2.1.cmml">⁢</mo><mi id="algx2.l13.m1.1.1.3.2.13" xref="algx2.l13.m1.1.1.3.2.13.cmml">t</mi><mo id="algx2.l13.m1.1.1.3.2.1k" xref="algx2.l13.m1.1.1.3.2.1.cmml">⁢</mo><mi id="algx2.l13.m1.1.1.3.2.14" xref="algx2.l13.m1.1.1.3.2.14.cmml">i</mi><mo id="algx2.l13.m1.1.1.3.2.1l" xref="algx2.l13.m1.1.1.3.2.1.cmml">⁢</mo><mi id="algx2.l13.m1.1.1.3.2.15" xref="algx2.l13.m1.1.1.3.2.15.cmml">o</mi><mo id="algx2.l13.m1.1.1.3.2.1m" xref="algx2.l13.m1.1.1.3.2.1.cmml">⁢</mo><mi id="algx2.l13.m1.1.1.3.2.16" xref="algx2.l13.m1.1.1.3.2.16.cmml">n</mi><mo id="algx2.l13.m1.1.1.3.2.1n" xref="algx2.l13.m1.1.1.3.2.1.cmml">⁢</mo><mi id="algx2.l13.m1.1.1.3.2.17" xref="algx2.l13.m1.1.1.3.2.17.cmml">W</mi><mo id="algx2.l13.m1.1.1.3.2.1o" xref="algx2.l13.m1.1.1.3.2.1.cmml">⁢</mo><mi id="algx2.l13.m1.1.1.3.2.18" xref="algx2.l13.m1.1.1.3.2.18.cmml">e</mi><mo id="algx2.l13.m1.1.1.3.2.1p" xref="algx2.l13.m1.1.1.3.2.1.cmml">⁢</mo><mi id="algx2.l13.m1.1.1.3.2.19" xref="algx2.l13.m1.1.1.3.2.19.cmml">i</mi><mo id="algx2.l13.m1.1.1.3.2.1q" xref="algx2.l13.m1.1.1.3.2.1.cmml">⁢</mo><mi id="algx2.l13.m1.1.1.3.2.20" xref="algx2.l13.m1.1.1.3.2.20.cmml">g</mi><mo id="algx2.l13.m1.1.1.3.2.1r" xref="algx2.l13.m1.1.1.3.2.1.cmml">⁢</mo><mi id="algx2.l13.m1.1.1.3.2.21" xref="algx2.l13.m1.1.1.3.2.21.cmml">h</mi><mo id="algx2.l13.m1.1.1.3.2.1s" xref="algx2.l13.m1.1.1.3.2.1.cmml">⁢</mo><mi id="algx2.l13.m1.1.1.3.2.22" xref="algx2.l13.m1.1.1.3.2.22.cmml">t</mi><mo id="algx2.l13.m1.1.1.3.2.1t" xref="algx2.l13.m1.1.1.3.2.1.cmml">⁢</mo><msup id="algx2.l13.m1.1.1.3.2.23" xref="algx2.l13.m1.1.1.3.2.23.cmml"><mi id="algx2.l13.m1.1.1.3.2.23.2" xref="algx2.l13.m1.1.1.3.2.23.2.cmml">s</mi><mi id="algx2.l13.m1.1.1.3.2.23.3" xref="algx2.l13.m1.1.1.3.2.23.3.cmml">i</mi></msup></mrow><mo id="algx2.l13.m1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="algx2.l13.m1.1.1.3.1.cmml">⋅</mo><msubsup id="algx2.l13.m1.1.1.3.3" xref="algx2.l13.m1.1.1.3.3.cmml"><mi id="algx2.l13.m1.1.1.3.3.2.2" xref="algx2.l13.m1.1.1.3.3.2.2.cmml">V</mi><mi id="algx2.l13.m1.1.1.3.3.2.3" xref="algx2.l13.m1.1.1.3.3.2.3.cmml">a</mi><mi id="algx2.l13.m1.1.1.3.3.3" xref="algx2.l13.m1.1.1.3.3.3.cmml">i</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx2.l13.m1.1b"><apply id="algx2.l13.m1.1.1.cmml" xref="algx2.l13.m1.1.1"><ci id="algx2.l13.m1.1.1.1.cmml" xref="algx2.l13.m1.1.1.1">←</ci><apply id="algx2.l13.m1.1.1.2.cmml" xref="algx2.l13.m1.1.1.2"><times id="algx2.l13.m1.1.1.2.1.cmml" xref="algx2.l13.m1.1.1.2.1"></times><ci id="algx2.l13.m1.1.1.2.2.cmml" xref="algx2.l13.m1.1.1.2.2">𝑀</ci><ci id="algx2.l13.m1.1.1.2.3.cmml" xref="algx2.l13.m1.1.1.2.3">𝑎</ci><ci id="algx2.l13.m1.1.1.2.4.cmml" xref="algx2.l13.m1.1.1.2.4">𝑠</ci><ci id="algx2.l13.m1.1.1.2.5.cmml" xref="algx2.l13.m1.1.1.2.5">𝑘</ci><ci id="algx2.l13.m1.1.1.2.6.cmml" xref="algx2.l13.m1.1.1.2.6">𝑒</ci><ci id="algx2.l13.m1.1.1.2.7.cmml" xref="algx2.l13.m1.1.1.2.7">𝑑</ci><ci id="algx2.l13.m1.1.1.2.8.cmml" xref="algx2.l13.m1.1.1.2.8">𝑆</ci><ci id="algx2.l13.m1.1.1.2.9.cmml" xref="algx2.l13.m1.1.1.2.9">𝑒</ci><ci id="algx2.l13.m1.1.1.2.10.cmml" xref="algx2.l13.m1.1.1.2.10">𝑙</ci><ci id="algx2.l13.m1.1.1.2.11.cmml" xref="algx2.l13.m1.1.1.2.11">𝑓</ci><ci id="algx2.l13.m1.1.1.2.12.cmml" xref="algx2.l13.m1.1.1.2.12">𝐴</ci><ci id="algx2.l13.m1.1.1.2.13.cmml" xref="algx2.l13.m1.1.1.2.13">𝑡</ci><ci id="algx2.l13.m1.1.1.2.14.cmml" xref="algx2.l13.m1.1.1.2.14">𝑡</ci><ci id="algx2.l13.m1.1.1.2.15.cmml" xref="algx2.l13.m1.1.1.2.15">𝑒</ci><ci id="algx2.l13.m1.1.1.2.16.cmml" xref="algx2.l13.m1.1.1.2.16">𝑛</ci><ci id="algx2.l13.m1.1.1.2.17.cmml" xref="algx2.l13.m1.1.1.2.17">𝑡</ci><ci id="algx2.l13.m1.1.1.2.18.cmml" xref="algx2.l13.m1.1.1.2.18">𝑖</ci><ci id="algx2.l13.m1.1.1.2.19.cmml" xref="algx2.l13.m1.1.1.2.19">𝑜</ci><apply id="algx2.l13.m1.1.1.2.20.cmml" xref="algx2.l13.m1.1.1.2.20"><csymbol cd="ambiguous" id="algx2.l13.m1.1.1.2.20.1.cmml" xref="algx2.l13.m1.1.1.2.20">superscript</csymbol><ci id="algx2.l13.m1.1.1.2.20.2.cmml" xref="algx2.l13.m1.1.1.2.20.2">𝑛</ci><ci id="algx2.l13.m1.1.1.2.20.3.cmml" xref="algx2.l13.m1.1.1.2.20.3">𝑖</ci></apply></apply><apply id="algx2.l13.m1.1.1.3.cmml" xref="algx2.l13.m1.1.1.3"><ci id="algx2.l13.m1.1.1.3.1.cmml" xref="algx2.l13.m1.1.1.3.1">⋅</ci><apply id="algx2.l13.m1.1.1.3.2.cmml" xref="algx2.l13.m1.1.1.3.2"><times id="algx2.l13.m1.1.1.3.2.1.cmml" xref="algx2.l13.m1.1.1.3.2.1"></times><ci id="algx2.l13.m1.1.1.3.2.2.cmml" xref="algx2.l13.m1.1.1.3.2.2">𝑀</ci><ci id="algx2.l13.m1.1.1.3.2.3.cmml" xref="algx2.l13.m1.1.1.3.2.3">𝑎</ci><ci id="algx2.l13.m1.1.1.3.2.4.cmml" xref="algx2.l13.m1.1.1.3.2.4">𝑠</ci><ci id="algx2.l13.m1.1.1.3.2.5.cmml" xref="algx2.l13.m1.1.1.3.2.5">𝑘</ci><ci id="algx2.l13.m1.1.1.3.2.6.cmml" xref="algx2.l13.m1.1.1.3.2.6">𝑒</ci><ci id="algx2.l13.m1.1.1.3.2.7.cmml" xref="algx2.l13.m1.1.1.3.2.7">𝑑</ci><ci id="algx2.l13.m1.1.1.3.2.8.cmml" xref="algx2.l13.m1.1.1.3.2.8">𝐴</ci><ci id="algx2.l13.m1.1.1.3.2.9.cmml" xref="algx2.l13.m1.1.1.3.2.9">𝑡</ci><ci id="algx2.l13.m1.1.1.3.2.10.cmml" xref="algx2.l13.m1.1.1.3.2.10">𝑡</ci><ci id="algx2.l13.m1.1.1.3.2.11.cmml" xref="algx2.l13.m1.1.1.3.2.11">𝑒</ci><ci id="algx2.l13.m1.1.1.3.2.12.cmml" xref="algx2.l13.m1.1.1.3.2.12">𝑛</ci><ci id="algx2.l13.m1.1.1.3.2.13.cmml" xref="algx2.l13.m1.1.1.3.2.13">𝑡</ci><ci id="algx2.l13.m1.1.1.3.2.14.cmml" xref="algx2.l13.m1.1.1.3.2.14">𝑖</ci><ci id="algx2.l13.m1.1.1.3.2.15.cmml" xref="algx2.l13.m1.1.1.3.2.15">𝑜</ci><ci id="algx2.l13.m1.1.1.3.2.16.cmml" xref="algx2.l13.m1.1.1.3.2.16">𝑛</ci><ci id="algx2.l13.m1.1.1.3.2.17.cmml" xref="algx2.l13.m1.1.1.3.2.17">𝑊</ci><ci id="algx2.l13.m1.1.1.3.2.18.cmml" xref="algx2.l13.m1.1.1.3.2.18">𝑒</ci><ci id="algx2.l13.m1.1.1.3.2.19.cmml" xref="algx2.l13.m1.1.1.3.2.19">𝑖</ci><ci id="algx2.l13.m1.1.1.3.2.20.cmml" xref="algx2.l13.m1.1.1.3.2.20">𝑔</ci><ci id="algx2.l13.m1.1.1.3.2.21.cmml" xref="algx2.l13.m1.1.1.3.2.21">ℎ</ci><ci id="algx2.l13.m1.1.1.3.2.22.cmml" xref="algx2.l13.m1.1.1.3.2.22">𝑡</ci><apply id="algx2.l13.m1.1.1.3.2.23.cmml" xref="algx2.l13.m1.1.1.3.2.23"><csymbol cd="ambiguous" id="algx2.l13.m1.1.1.3.2.23.1.cmml" xref="algx2.l13.m1.1.1.3.2.23">superscript</csymbol><ci id="algx2.l13.m1.1.1.3.2.23.2.cmml" xref="algx2.l13.m1.1.1.3.2.23.2">𝑠</ci><ci id="algx2.l13.m1.1.1.3.2.23.3.cmml" xref="algx2.l13.m1.1.1.3.2.23.3">𝑖</ci></apply></apply><apply id="algx2.l13.m1.1.1.3.3.cmml" xref="algx2.l13.m1.1.1.3.3"><csymbol cd="ambiguous" id="algx2.l13.m1.1.1.3.3.1.cmml" xref="algx2.l13.m1.1.1.3.3">superscript</csymbol><apply id="algx2.l13.m1.1.1.3.3.2.cmml" xref="algx2.l13.m1.1.1.3.3"><csymbol cd="ambiguous" id="algx2.l13.m1.1.1.3.3.2.1.cmml" xref="algx2.l13.m1.1.1.3.3">subscript</csymbol><ci id="algx2.l13.m1.1.1.3.3.2.2.cmml" xref="algx2.l13.m1.1.1.3.3.2.2">𝑉</ci><ci id="algx2.l13.m1.1.1.3.3.2.3.cmml" xref="algx2.l13.m1.1.1.3.3.2.3">𝑎</ci></apply><ci id="algx2.l13.m1.1.1.3.3.3.cmml" xref="algx2.l13.m1.1.1.3.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx2.l13.m1.1c">MaskedSelfAttention^{i}\leftarrow MaskedAttentionWeights^{i}\cdot V_{a}^{i}</annotation><annotation encoding="application/x-llamapun" id="algx2.l13.m1.1d">italic_M italic_a italic_s italic_k italic_e italic_d italic_S italic_e italic_l italic_f italic_A italic_t italic_t italic_e italic_n italic_t italic_i italic_o italic_n start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ← italic_M italic_a italic_s italic_k italic_e italic_d italic_A italic_t italic_t italic_e italic_n italic_t italic_i italic_o italic_n italic_W italic_e italic_i italic_g italic_h italic_t italic_s start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ⋅ italic_V start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algx2.l14">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algx2.l14.1.1.1" style="font-size:80%;">14:</span></span>     <math alttext="MaskedSelfAttention^{i}\leftarrow\text{Dropout}(MaskedSelfAttention^{i},%
dropout\_rate)" class="ltx_Math" display="inline" id="algx2.l14.m1.2"><semantics id="algx2.l14.m1.2a"><mrow id="algx2.l14.m1.2.2" xref="algx2.l14.m1.2.2.cmml"><mrow id="algx2.l14.m1.2.2.4" xref="algx2.l14.m1.2.2.4.cmml"><mi id="algx2.l14.m1.2.2.4.2" xref="algx2.l14.m1.2.2.4.2.cmml">M</mi><mo id="algx2.l14.m1.2.2.4.1" xref="algx2.l14.m1.2.2.4.1.cmml">⁢</mo><mi id="algx2.l14.m1.2.2.4.3" xref="algx2.l14.m1.2.2.4.3.cmml">a</mi><mo id="algx2.l14.m1.2.2.4.1a" xref="algx2.l14.m1.2.2.4.1.cmml">⁢</mo><mi id="algx2.l14.m1.2.2.4.4" xref="algx2.l14.m1.2.2.4.4.cmml">s</mi><mo id="algx2.l14.m1.2.2.4.1b" xref="algx2.l14.m1.2.2.4.1.cmml">⁢</mo><mi id="algx2.l14.m1.2.2.4.5" xref="algx2.l14.m1.2.2.4.5.cmml">k</mi><mo id="algx2.l14.m1.2.2.4.1c" xref="algx2.l14.m1.2.2.4.1.cmml">⁢</mo><mi id="algx2.l14.m1.2.2.4.6" xref="algx2.l14.m1.2.2.4.6.cmml">e</mi><mo id="algx2.l14.m1.2.2.4.1d" xref="algx2.l14.m1.2.2.4.1.cmml">⁢</mo><mi id="algx2.l14.m1.2.2.4.7" xref="algx2.l14.m1.2.2.4.7.cmml">d</mi><mo id="algx2.l14.m1.2.2.4.1e" xref="algx2.l14.m1.2.2.4.1.cmml">⁢</mo><mi id="algx2.l14.m1.2.2.4.8" xref="algx2.l14.m1.2.2.4.8.cmml">S</mi><mo id="algx2.l14.m1.2.2.4.1f" xref="algx2.l14.m1.2.2.4.1.cmml">⁢</mo><mi id="algx2.l14.m1.2.2.4.9" xref="algx2.l14.m1.2.2.4.9.cmml">e</mi><mo id="algx2.l14.m1.2.2.4.1g" xref="algx2.l14.m1.2.2.4.1.cmml">⁢</mo><mi id="algx2.l14.m1.2.2.4.10" xref="algx2.l14.m1.2.2.4.10.cmml">l</mi><mo id="algx2.l14.m1.2.2.4.1h" xref="algx2.l14.m1.2.2.4.1.cmml">⁢</mo><mi id="algx2.l14.m1.2.2.4.11" xref="algx2.l14.m1.2.2.4.11.cmml">f</mi><mo id="algx2.l14.m1.2.2.4.1i" xref="algx2.l14.m1.2.2.4.1.cmml">⁢</mo><mi id="algx2.l14.m1.2.2.4.12" xref="algx2.l14.m1.2.2.4.12.cmml">A</mi><mo id="algx2.l14.m1.2.2.4.1j" xref="algx2.l14.m1.2.2.4.1.cmml">⁢</mo><mi id="algx2.l14.m1.2.2.4.13" xref="algx2.l14.m1.2.2.4.13.cmml">t</mi><mo id="algx2.l14.m1.2.2.4.1k" xref="algx2.l14.m1.2.2.4.1.cmml">⁢</mo><mi id="algx2.l14.m1.2.2.4.14" xref="algx2.l14.m1.2.2.4.14.cmml">t</mi><mo id="algx2.l14.m1.2.2.4.1l" xref="algx2.l14.m1.2.2.4.1.cmml">⁢</mo><mi id="algx2.l14.m1.2.2.4.15" xref="algx2.l14.m1.2.2.4.15.cmml">e</mi><mo id="algx2.l14.m1.2.2.4.1m" xref="algx2.l14.m1.2.2.4.1.cmml">⁢</mo><mi id="algx2.l14.m1.2.2.4.16" xref="algx2.l14.m1.2.2.4.16.cmml">n</mi><mo id="algx2.l14.m1.2.2.4.1n" xref="algx2.l14.m1.2.2.4.1.cmml">⁢</mo><mi id="algx2.l14.m1.2.2.4.17" xref="algx2.l14.m1.2.2.4.17.cmml">t</mi><mo id="algx2.l14.m1.2.2.4.1o" xref="algx2.l14.m1.2.2.4.1.cmml">⁢</mo><mi id="algx2.l14.m1.2.2.4.18" xref="algx2.l14.m1.2.2.4.18.cmml">i</mi><mo id="algx2.l14.m1.2.2.4.1p" xref="algx2.l14.m1.2.2.4.1.cmml">⁢</mo><mi id="algx2.l14.m1.2.2.4.19" xref="algx2.l14.m1.2.2.4.19.cmml">o</mi><mo id="algx2.l14.m1.2.2.4.1q" xref="algx2.l14.m1.2.2.4.1.cmml">⁢</mo><msup id="algx2.l14.m1.2.2.4.20" xref="algx2.l14.m1.2.2.4.20.cmml"><mi id="algx2.l14.m1.2.2.4.20.2" xref="algx2.l14.m1.2.2.4.20.2.cmml">n</mi><mi id="algx2.l14.m1.2.2.4.20.3" xref="algx2.l14.m1.2.2.4.20.3.cmml">i</mi></msup></mrow><mo id="algx2.l14.m1.2.2.3" stretchy="false" xref="algx2.l14.m1.2.2.3.cmml">←</mo><mrow id="algx2.l14.m1.2.2.2" xref="algx2.l14.m1.2.2.2.cmml"><mtext id="algx2.l14.m1.2.2.2.4" xref="algx2.l14.m1.2.2.2.4a.cmml">Dropout</mtext><mo id="algx2.l14.m1.2.2.2.3" xref="algx2.l14.m1.2.2.2.3.cmml">⁢</mo><mrow id="algx2.l14.m1.2.2.2.2.2" xref="algx2.l14.m1.2.2.2.2.3.cmml"><mo id="algx2.l14.m1.2.2.2.2.2.3" stretchy="false" xref="algx2.l14.m1.2.2.2.2.3.cmml">(</mo><mrow id="algx2.l14.m1.1.1.1.1.1.1" xref="algx2.l14.m1.1.1.1.1.1.1.cmml"><mi id="algx2.l14.m1.1.1.1.1.1.1.2" xref="algx2.l14.m1.1.1.1.1.1.1.2.cmml">M</mi><mo id="algx2.l14.m1.1.1.1.1.1.1.1" xref="algx2.l14.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx2.l14.m1.1.1.1.1.1.1.3" xref="algx2.l14.m1.1.1.1.1.1.1.3.cmml">a</mi><mo id="algx2.l14.m1.1.1.1.1.1.1.1a" xref="algx2.l14.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx2.l14.m1.1.1.1.1.1.1.4" xref="algx2.l14.m1.1.1.1.1.1.1.4.cmml">s</mi><mo id="algx2.l14.m1.1.1.1.1.1.1.1b" xref="algx2.l14.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx2.l14.m1.1.1.1.1.1.1.5" xref="algx2.l14.m1.1.1.1.1.1.1.5.cmml">k</mi><mo id="algx2.l14.m1.1.1.1.1.1.1.1c" xref="algx2.l14.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx2.l14.m1.1.1.1.1.1.1.6" xref="algx2.l14.m1.1.1.1.1.1.1.6.cmml">e</mi><mo id="algx2.l14.m1.1.1.1.1.1.1.1d" xref="algx2.l14.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx2.l14.m1.1.1.1.1.1.1.7" xref="algx2.l14.m1.1.1.1.1.1.1.7.cmml">d</mi><mo id="algx2.l14.m1.1.1.1.1.1.1.1e" xref="algx2.l14.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx2.l14.m1.1.1.1.1.1.1.8" xref="algx2.l14.m1.1.1.1.1.1.1.8.cmml">S</mi><mo id="algx2.l14.m1.1.1.1.1.1.1.1f" xref="algx2.l14.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx2.l14.m1.1.1.1.1.1.1.9" xref="algx2.l14.m1.1.1.1.1.1.1.9.cmml">e</mi><mo id="algx2.l14.m1.1.1.1.1.1.1.1g" xref="algx2.l14.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx2.l14.m1.1.1.1.1.1.1.10" xref="algx2.l14.m1.1.1.1.1.1.1.10.cmml">l</mi><mo id="algx2.l14.m1.1.1.1.1.1.1.1h" xref="algx2.l14.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx2.l14.m1.1.1.1.1.1.1.11" xref="algx2.l14.m1.1.1.1.1.1.1.11.cmml">f</mi><mo id="algx2.l14.m1.1.1.1.1.1.1.1i" xref="algx2.l14.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx2.l14.m1.1.1.1.1.1.1.12" xref="algx2.l14.m1.1.1.1.1.1.1.12.cmml">A</mi><mo id="algx2.l14.m1.1.1.1.1.1.1.1j" xref="algx2.l14.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx2.l14.m1.1.1.1.1.1.1.13" xref="algx2.l14.m1.1.1.1.1.1.1.13.cmml">t</mi><mo id="algx2.l14.m1.1.1.1.1.1.1.1k" xref="algx2.l14.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx2.l14.m1.1.1.1.1.1.1.14" xref="algx2.l14.m1.1.1.1.1.1.1.14.cmml">t</mi><mo id="algx2.l14.m1.1.1.1.1.1.1.1l" xref="algx2.l14.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx2.l14.m1.1.1.1.1.1.1.15" xref="algx2.l14.m1.1.1.1.1.1.1.15.cmml">e</mi><mo id="algx2.l14.m1.1.1.1.1.1.1.1m" xref="algx2.l14.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx2.l14.m1.1.1.1.1.1.1.16" xref="algx2.l14.m1.1.1.1.1.1.1.16.cmml">n</mi><mo id="algx2.l14.m1.1.1.1.1.1.1.1n" xref="algx2.l14.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx2.l14.m1.1.1.1.1.1.1.17" xref="algx2.l14.m1.1.1.1.1.1.1.17.cmml">t</mi><mo id="algx2.l14.m1.1.1.1.1.1.1.1o" xref="algx2.l14.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx2.l14.m1.1.1.1.1.1.1.18" xref="algx2.l14.m1.1.1.1.1.1.1.18.cmml">i</mi><mo id="algx2.l14.m1.1.1.1.1.1.1.1p" xref="algx2.l14.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx2.l14.m1.1.1.1.1.1.1.19" xref="algx2.l14.m1.1.1.1.1.1.1.19.cmml">o</mi><mo id="algx2.l14.m1.1.1.1.1.1.1.1q" xref="algx2.l14.m1.1.1.1.1.1.1.1.cmml">⁢</mo><msup id="algx2.l14.m1.1.1.1.1.1.1.20" xref="algx2.l14.m1.1.1.1.1.1.1.20.cmml"><mi id="algx2.l14.m1.1.1.1.1.1.1.20.2" xref="algx2.l14.m1.1.1.1.1.1.1.20.2.cmml">n</mi><mi id="algx2.l14.m1.1.1.1.1.1.1.20.3" xref="algx2.l14.m1.1.1.1.1.1.1.20.3.cmml">i</mi></msup></mrow><mo id="algx2.l14.m1.2.2.2.2.2.4" xref="algx2.l14.m1.2.2.2.2.3.cmml">,</mo><mrow id="algx2.l14.m1.2.2.2.2.2.2" xref="algx2.l14.m1.2.2.2.2.2.2.cmml"><mi id="algx2.l14.m1.2.2.2.2.2.2.2" xref="algx2.l14.m1.2.2.2.2.2.2.2.cmml">d</mi><mo id="algx2.l14.m1.2.2.2.2.2.2.1" xref="algx2.l14.m1.2.2.2.2.2.2.1.cmml">⁢</mo><mi id="algx2.l14.m1.2.2.2.2.2.2.3" xref="algx2.l14.m1.2.2.2.2.2.2.3.cmml">r</mi><mo id="algx2.l14.m1.2.2.2.2.2.2.1a" xref="algx2.l14.m1.2.2.2.2.2.2.1.cmml">⁢</mo><mi id="algx2.l14.m1.2.2.2.2.2.2.4" xref="algx2.l14.m1.2.2.2.2.2.2.4.cmml">o</mi><mo id="algx2.l14.m1.2.2.2.2.2.2.1b" xref="algx2.l14.m1.2.2.2.2.2.2.1.cmml">⁢</mo><mi id="algx2.l14.m1.2.2.2.2.2.2.5" xref="algx2.l14.m1.2.2.2.2.2.2.5.cmml">p</mi><mo id="algx2.l14.m1.2.2.2.2.2.2.1c" xref="algx2.l14.m1.2.2.2.2.2.2.1.cmml">⁢</mo><mi id="algx2.l14.m1.2.2.2.2.2.2.6" xref="algx2.l14.m1.2.2.2.2.2.2.6.cmml">o</mi><mo id="algx2.l14.m1.2.2.2.2.2.2.1d" xref="algx2.l14.m1.2.2.2.2.2.2.1.cmml">⁢</mo><mi id="algx2.l14.m1.2.2.2.2.2.2.7" xref="algx2.l14.m1.2.2.2.2.2.2.7.cmml">u</mi><mo id="algx2.l14.m1.2.2.2.2.2.2.1e" xref="algx2.l14.m1.2.2.2.2.2.2.1.cmml">⁢</mo><mi id="algx2.l14.m1.2.2.2.2.2.2.8" xref="algx2.l14.m1.2.2.2.2.2.2.8.cmml">t</mi><mo id="algx2.l14.m1.2.2.2.2.2.2.1f" xref="algx2.l14.m1.2.2.2.2.2.2.1.cmml">⁢</mo><mi id="algx2.l14.m1.2.2.2.2.2.2.9" mathvariant="normal" xref="algx2.l14.m1.2.2.2.2.2.2.9.cmml">_</mi><mo id="algx2.l14.m1.2.2.2.2.2.2.1g" xref="algx2.l14.m1.2.2.2.2.2.2.1.cmml">⁢</mo><mi id="algx2.l14.m1.2.2.2.2.2.2.10" xref="algx2.l14.m1.2.2.2.2.2.2.10.cmml">r</mi><mo id="algx2.l14.m1.2.2.2.2.2.2.1h" xref="algx2.l14.m1.2.2.2.2.2.2.1.cmml">⁢</mo><mi id="algx2.l14.m1.2.2.2.2.2.2.11" xref="algx2.l14.m1.2.2.2.2.2.2.11.cmml">a</mi><mo id="algx2.l14.m1.2.2.2.2.2.2.1i" xref="algx2.l14.m1.2.2.2.2.2.2.1.cmml">⁢</mo><mi id="algx2.l14.m1.2.2.2.2.2.2.12" xref="algx2.l14.m1.2.2.2.2.2.2.12.cmml">t</mi><mo id="algx2.l14.m1.2.2.2.2.2.2.1j" xref="algx2.l14.m1.2.2.2.2.2.2.1.cmml">⁢</mo><mi id="algx2.l14.m1.2.2.2.2.2.2.13" xref="algx2.l14.m1.2.2.2.2.2.2.13.cmml">e</mi></mrow><mo id="algx2.l14.m1.2.2.2.2.2.5" stretchy="false" xref="algx2.l14.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx2.l14.m1.2b"><apply id="algx2.l14.m1.2.2.cmml" xref="algx2.l14.m1.2.2"><ci id="algx2.l14.m1.2.2.3.cmml" xref="algx2.l14.m1.2.2.3">←</ci><apply id="algx2.l14.m1.2.2.4.cmml" xref="algx2.l14.m1.2.2.4"><times id="algx2.l14.m1.2.2.4.1.cmml" xref="algx2.l14.m1.2.2.4.1"></times><ci id="algx2.l14.m1.2.2.4.2.cmml" xref="algx2.l14.m1.2.2.4.2">𝑀</ci><ci id="algx2.l14.m1.2.2.4.3.cmml" xref="algx2.l14.m1.2.2.4.3">𝑎</ci><ci id="algx2.l14.m1.2.2.4.4.cmml" xref="algx2.l14.m1.2.2.4.4">𝑠</ci><ci id="algx2.l14.m1.2.2.4.5.cmml" xref="algx2.l14.m1.2.2.4.5">𝑘</ci><ci id="algx2.l14.m1.2.2.4.6.cmml" xref="algx2.l14.m1.2.2.4.6">𝑒</ci><ci id="algx2.l14.m1.2.2.4.7.cmml" xref="algx2.l14.m1.2.2.4.7">𝑑</ci><ci id="algx2.l14.m1.2.2.4.8.cmml" xref="algx2.l14.m1.2.2.4.8">𝑆</ci><ci id="algx2.l14.m1.2.2.4.9.cmml" xref="algx2.l14.m1.2.2.4.9">𝑒</ci><ci id="algx2.l14.m1.2.2.4.10.cmml" xref="algx2.l14.m1.2.2.4.10">𝑙</ci><ci id="algx2.l14.m1.2.2.4.11.cmml" xref="algx2.l14.m1.2.2.4.11">𝑓</ci><ci id="algx2.l14.m1.2.2.4.12.cmml" xref="algx2.l14.m1.2.2.4.12">𝐴</ci><ci id="algx2.l14.m1.2.2.4.13.cmml" xref="algx2.l14.m1.2.2.4.13">𝑡</ci><ci id="algx2.l14.m1.2.2.4.14.cmml" xref="algx2.l14.m1.2.2.4.14">𝑡</ci><ci id="algx2.l14.m1.2.2.4.15.cmml" xref="algx2.l14.m1.2.2.4.15">𝑒</ci><ci id="algx2.l14.m1.2.2.4.16.cmml" xref="algx2.l14.m1.2.2.4.16">𝑛</ci><ci id="algx2.l14.m1.2.2.4.17.cmml" xref="algx2.l14.m1.2.2.4.17">𝑡</ci><ci id="algx2.l14.m1.2.2.4.18.cmml" xref="algx2.l14.m1.2.2.4.18">𝑖</ci><ci id="algx2.l14.m1.2.2.4.19.cmml" xref="algx2.l14.m1.2.2.4.19">𝑜</ci><apply id="algx2.l14.m1.2.2.4.20.cmml" xref="algx2.l14.m1.2.2.4.20"><csymbol cd="ambiguous" id="algx2.l14.m1.2.2.4.20.1.cmml" xref="algx2.l14.m1.2.2.4.20">superscript</csymbol><ci id="algx2.l14.m1.2.2.4.20.2.cmml" xref="algx2.l14.m1.2.2.4.20.2">𝑛</ci><ci id="algx2.l14.m1.2.2.4.20.3.cmml" xref="algx2.l14.m1.2.2.4.20.3">𝑖</ci></apply></apply><apply id="algx2.l14.m1.2.2.2.cmml" xref="algx2.l14.m1.2.2.2"><times id="algx2.l14.m1.2.2.2.3.cmml" xref="algx2.l14.m1.2.2.2.3"></times><ci id="algx2.l14.m1.2.2.2.4a.cmml" xref="algx2.l14.m1.2.2.2.4"><mtext id="algx2.l14.m1.2.2.2.4.cmml" xref="algx2.l14.m1.2.2.2.4">Dropout</mtext></ci><interval closure="open" id="algx2.l14.m1.2.2.2.2.3.cmml" xref="algx2.l14.m1.2.2.2.2.2"><apply id="algx2.l14.m1.1.1.1.1.1.1.cmml" xref="algx2.l14.m1.1.1.1.1.1.1"><times id="algx2.l14.m1.1.1.1.1.1.1.1.cmml" xref="algx2.l14.m1.1.1.1.1.1.1.1"></times><ci id="algx2.l14.m1.1.1.1.1.1.1.2.cmml" xref="algx2.l14.m1.1.1.1.1.1.1.2">𝑀</ci><ci id="algx2.l14.m1.1.1.1.1.1.1.3.cmml" xref="algx2.l14.m1.1.1.1.1.1.1.3">𝑎</ci><ci id="algx2.l14.m1.1.1.1.1.1.1.4.cmml" xref="algx2.l14.m1.1.1.1.1.1.1.4">𝑠</ci><ci id="algx2.l14.m1.1.1.1.1.1.1.5.cmml" xref="algx2.l14.m1.1.1.1.1.1.1.5">𝑘</ci><ci id="algx2.l14.m1.1.1.1.1.1.1.6.cmml" xref="algx2.l14.m1.1.1.1.1.1.1.6">𝑒</ci><ci id="algx2.l14.m1.1.1.1.1.1.1.7.cmml" xref="algx2.l14.m1.1.1.1.1.1.1.7">𝑑</ci><ci id="algx2.l14.m1.1.1.1.1.1.1.8.cmml" xref="algx2.l14.m1.1.1.1.1.1.1.8">𝑆</ci><ci id="algx2.l14.m1.1.1.1.1.1.1.9.cmml" xref="algx2.l14.m1.1.1.1.1.1.1.9">𝑒</ci><ci id="algx2.l14.m1.1.1.1.1.1.1.10.cmml" xref="algx2.l14.m1.1.1.1.1.1.1.10">𝑙</ci><ci id="algx2.l14.m1.1.1.1.1.1.1.11.cmml" xref="algx2.l14.m1.1.1.1.1.1.1.11">𝑓</ci><ci id="algx2.l14.m1.1.1.1.1.1.1.12.cmml" xref="algx2.l14.m1.1.1.1.1.1.1.12">𝐴</ci><ci id="algx2.l14.m1.1.1.1.1.1.1.13.cmml" xref="algx2.l14.m1.1.1.1.1.1.1.13">𝑡</ci><ci id="algx2.l14.m1.1.1.1.1.1.1.14.cmml" xref="algx2.l14.m1.1.1.1.1.1.1.14">𝑡</ci><ci id="algx2.l14.m1.1.1.1.1.1.1.15.cmml" xref="algx2.l14.m1.1.1.1.1.1.1.15">𝑒</ci><ci id="algx2.l14.m1.1.1.1.1.1.1.16.cmml" xref="algx2.l14.m1.1.1.1.1.1.1.16">𝑛</ci><ci id="algx2.l14.m1.1.1.1.1.1.1.17.cmml" xref="algx2.l14.m1.1.1.1.1.1.1.17">𝑡</ci><ci id="algx2.l14.m1.1.1.1.1.1.1.18.cmml" xref="algx2.l14.m1.1.1.1.1.1.1.18">𝑖</ci><ci id="algx2.l14.m1.1.1.1.1.1.1.19.cmml" xref="algx2.l14.m1.1.1.1.1.1.1.19">𝑜</ci><apply id="algx2.l14.m1.1.1.1.1.1.1.20.cmml" xref="algx2.l14.m1.1.1.1.1.1.1.20"><csymbol cd="ambiguous" id="algx2.l14.m1.1.1.1.1.1.1.20.1.cmml" xref="algx2.l14.m1.1.1.1.1.1.1.20">superscript</csymbol><ci id="algx2.l14.m1.1.1.1.1.1.1.20.2.cmml" xref="algx2.l14.m1.1.1.1.1.1.1.20.2">𝑛</ci><ci id="algx2.l14.m1.1.1.1.1.1.1.20.3.cmml" xref="algx2.l14.m1.1.1.1.1.1.1.20.3">𝑖</ci></apply></apply><apply id="algx2.l14.m1.2.2.2.2.2.2.cmml" xref="algx2.l14.m1.2.2.2.2.2.2"><times id="algx2.l14.m1.2.2.2.2.2.2.1.cmml" xref="algx2.l14.m1.2.2.2.2.2.2.1"></times><ci id="algx2.l14.m1.2.2.2.2.2.2.2.cmml" xref="algx2.l14.m1.2.2.2.2.2.2.2">𝑑</ci><ci id="algx2.l14.m1.2.2.2.2.2.2.3.cmml" xref="algx2.l14.m1.2.2.2.2.2.2.3">𝑟</ci><ci id="algx2.l14.m1.2.2.2.2.2.2.4.cmml" xref="algx2.l14.m1.2.2.2.2.2.2.4">𝑜</ci><ci id="algx2.l14.m1.2.2.2.2.2.2.5.cmml" xref="algx2.l14.m1.2.2.2.2.2.2.5">𝑝</ci><ci id="algx2.l14.m1.2.2.2.2.2.2.6.cmml" xref="algx2.l14.m1.2.2.2.2.2.2.6">𝑜</ci><ci id="algx2.l14.m1.2.2.2.2.2.2.7.cmml" xref="algx2.l14.m1.2.2.2.2.2.2.7">𝑢</ci><ci id="algx2.l14.m1.2.2.2.2.2.2.8.cmml" xref="algx2.l14.m1.2.2.2.2.2.2.8">𝑡</ci><ci id="algx2.l14.m1.2.2.2.2.2.2.9.cmml" xref="algx2.l14.m1.2.2.2.2.2.2.9">_</ci><ci id="algx2.l14.m1.2.2.2.2.2.2.10.cmml" xref="algx2.l14.m1.2.2.2.2.2.2.10">𝑟</ci><ci id="algx2.l14.m1.2.2.2.2.2.2.11.cmml" xref="algx2.l14.m1.2.2.2.2.2.2.11">𝑎</ci><ci id="algx2.l14.m1.2.2.2.2.2.2.12.cmml" xref="algx2.l14.m1.2.2.2.2.2.2.12">𝑡</ci><ci id="algx2.l14.m1.2.2.2.2.2.2.13.cmml" xref="algx2.l14.m1.2.2.2.2.2.2.13">𝑒</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx2.l14.m1.2c">MaskedSelfAttention^{i}\leftarrow\text{Dropout}(MaskedSelfAttention^{i},%
dropout\_rate)</annotation><annotation encoding="application/x-llamapun" id="algx2.l14.m1.2d">italic_M italic_a italic_s italic_k italic_e italic_d italic_S italic_e italic_l italic_f italic_A italic_t italic_t italic_e italic_n italic_t italic_i italic_o italic_n start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ← Dropout ( italic_M italic_a italic_s italic_k italic_e italic_d italic_S italic_e italic_l italic_f italic_A italic_t italic_t italic_e italic_n italic_t italic_i italic_o italic_n start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT , italic_d italic_r italic_o italic_p italic_o italic_u italic_t _ italic_r italic_a italic_t italic_e )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algx2.l15">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algx2.l15.1.1.1" style="font-size:80%;">15:</span></span>  <span class="ltx_text ltx_font_bold" id="algx2.l15.2">end</span> <span class="ltx_text ltx_font_bold" id="algx2.l15.3">for</span>
</div>
<div class="ltx_listingline" id="algx2.l16">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algx2.l16.1.1.1" style="font-size:80%;">16:</span></span>  <math alttext="\begin{aligned} ConcatSelfAttention\leftarrow\text{Concatenate}(%
MaskedSelfAttention^{1},\dots,MaskedSelfAttention^{\text{num\_heads}})\end{aligned}" class="ltx_Math" display="inline" id="algx2.l16.m1.3"><semantics id="algx2.l16.m1.3a"><mtable id="algx2.l16.m1.3.3" xref="algx2.l16.m1.3.3.cmml"><mtr id="algx2.l16.m1.3.3a" xref="algx2.l16.m1.3.3.cmml"><mtd class="ltx_align_right" columnalign="right" id="algx2.l16.m1.3.3b" xref="algx2.l16.m1.3.3.cmml"><mrow id="algx2.l16.m1.3.3.3.3.3" xref="algx2.l16.m1.3.3.3.3.3.cmml"><mrow id="algx2.l16.m1.3.3.3.3.3.5" xref="algx2.l16.m1.3.3.3.3.3.5.cmml"><mi id="algx2.l16.m1.3.3.3.3.3.5.2" xref="algx2.l16.m1.3.3.3.3.3.5.2.cmml">C</mi><mo id="algx2.l16.m1.3.3.3.3.3.5.1" xref="algx2.l16.m1.3.3.3.3.3.5.1.cmml">⁢</mo><mi id="algx2.l16.m1.3.3.3.3.3.5.3" xref="algx2.l16.m1.3.3.3.3.3.5.3.cmml">o</mi><mo id="algx2.l16.m1.3.3.3.3.3.5.1a" xref="algx2.l16.m1.3.3.3.3.3.5.1.cmml">⁢</mo><mi id="algx2.l16.m1.3.3.3.3.3.5.4" xref="algx2.l16.m1.3.3.3.3.3.5.4.cmml">n</mi><mo id="algx2.l16.m1.3.3.3.3.3.5.1b" xref="algx2.l16.m1.3.3.3.3.3.5.1.cmml">⁢</mo><mi id="algx2.l16.m1.3.3.3.3.3.5.5" xref="algx2.l16.m1.3.3.3.3.3.5.5.cmml">c</mi><mo id="algx2.l16.m1.3.3.3.3.3.5.1c" xref="algx2.l16.m1.3.3.3.3.3.5.1.cmml">⁢</mo><mi id="algx2.l16.m1.3.3.3.3.3.5.6" xref="algx2.l16.m1.3.3.3.3.3.5.6.cmml">a</mi><mo id="algx2.l16.m1.3.3.3.3.3.5.1d" xref="algx2.l16.m1.3.3.3.3.3.5.1.cmml">⁢</mo><mi id="algx2.l16.m1.3.3.3.3.3.5.7" xref="algx2.l16.m1.3.3.3.3.3.5.7.cmml">t</mi><mo id="algx2.l16.m1.3.3.3.3.3.5.1e" xref="algx2.l16.m1.3.3.3.3.3.5.1.cmml">⁢</mo><mi id="algx2.l16.m1.3.3.3.3.3.5.8" xref="algx2.l16.m1.3.3.3.3.3.5.8.cmml">S</mi><mo id="algx2.l16.m1.3.3.3.3.3.5.1f" xref="algx2.l16.m1.3.3.3.3.3.5.1.cmml">⁢</mo><mi id="algx2.l16.m1.3.3.3.3.3.5.9" xref="algx2.l16.m1.3.3.3.3.3.5.9.cmml">e</mi><mo id="algx2.l16.m1.3.3.3.3.3.5.1g" xref="algx2.l16.m1.3.3.3.3.3.5.1.cmml">⁢</mo><mi id="algx2.l16.m1.3.3.3.3.3.5.10" xref="algx2.l16.m1.3.3.3.3.3.5.10.cmml">l</mi><mo id="algx2.l16.m1.3.3.3.3.3.5.1h" xref="algx2.l16.m1.3.3.3.3.3.5.1.cmml">⁢</mo><mi id="algx2.l16.m1.3.3.3.3.3.5.11" xref="algx2.l16.m1.3.3.3.3.3.5.11.cmml">f</mi><mo id="algx2.l16.m1.3.3.3.3.3.5.1i" xref="algx2.l16.m1.3.3.3.3.3.5.1.cmml">⁢</mo><mi id="algx2.l16.m1.3.3.3.3.3.5.12" xref="algx2.l16.m1.3.3.3.3.3.5.12.cmml">A</mi><mo id="algx2.l16.m1.3.3.3.3.3.5.1j" xref="algx2.l16.m1.3.3.3.3.3.5.1.cmml">⁢</mo><mi id="algx2.l16.m1.3.3.3.3.3.5.13" xref="algx2.l16.m1.3.3.3.3.3.5.13.cmml">t</mi><mo id="algx2.l16.m1.3.3.3.3.3.5.1k" xref="algx2.l16.m1.3.3.3.3.3.5.1.cmml">⁢</mo><mi id="algx2.l16.m1.3.3.3.3.3.5.14" xref="algx2.l16.m1.3.3.3.3.3.5.14.cmml">t</mi><mo id="algx2.l16.m1.3.3.3.3.3.5.1l" xref="algx2.l16.m1.3.3.3.3.3.5.1.cmml">⁢</mo><mi id="algx2.l16.m1.3.3.3.3.3.5.15" xref="algx2.l16.m1.3.3.3.3.3.5.15.cmml">e</mi><mo id="algx2.l16.m1.3.3.3.3.3.5.1m" xref="algx2.l16.m1.3.3.3.3.3.5.1.cmml">⁢</mo><mi id="algx2.l16.m1.3.3.3.3.3.5.16" xref="algx2.l16.m1.3.3.3.3.3.5.16.cmml">n</mi><mo id="algx2.l16.m1.3.3.3.3.3.5.1n" xref="algx2.l16.m1.3.3.3.3.3.5.1.cmml">⁢</mo><mi id="algx2.l16.m1.3.3.3.3.3.5.17" xref="algx2.l16.m1.3.3.3.3.3.5.17.cmml">t</mi><mo id="algx2.l16.m1.3.3.3.3.3.5.1o" xref="algx2.l16.m1.3.3.3.3.3.5.1.cmml">⁢</mo><mi id="algx2.l16.m1.3.3.3.3.3.5.18" xref="algx2.l16.m1.3.3.3.3.3.5.18.cmml">i</mi><mo id="algx2.l16.m1.3.3.3.3.3.5.1p" xref="algx2.l16.m1.3.3.3.3.3.5.1.cmml">⁢</mo><mi id="algx2.l16.m1.3.3.3.3.3.5.19" xref="algx2.l16.m1.3.3.3.3.3.5.19.cmml">o</mi><mo id="algx2.l16.m1.3.3.3.3.3.5.1q" xref="algx2.l16.m1.3.3.3.3.3.5.1.cmml">⁢</mo><mi id="algx2.l16.m1.3.3.3.3.3.5.20" xref="algx2.l16.m1.3.3.3.3.3.5.20.cmml">n</mi></mrow><mo id="algx2.l16.m1.3.3.3.3.3.4" stretchy="false" xref="algx2.l16.m1.3.3.3.3.3.4.cmml">←</mo><mrow id="algx2.l16.m1.3.3.3.3.3.3" xref="algx2.l16.m1.3.3.3.3.3.3.cmml"><mtext id="algx2.l16.m1.3.3.3.3.3.3.4" xref="algx2.l16.m1.3.3.3.3.3.3.4a.cmml">Concatenate</mtext><mo id="algx2.l16.m1.3.3.3.3.3.3.3" xref="algx2.l16.m1.3.3.3.3.3.3.3.cmml">⁢</mo><mrow id="algx2.l16.m1.3.3.3.3.3.3.2.2" xref="algx2.l16.m1.3.3.3.3.3.3.2.3.cmml"><mo id="algx2.l16.m1.3.3.3.3.3.3.2.2.3" stretchy="false" xref="algx2.l16.m1.3.3.3.3.3.3.2.3.cmml">(</mo><mrow id="algx2.l16.m1.2.2.2.2.2.2.1.1.1" xref="algx2.l16.m1.2.2.2.2.2.2.1.1.1.cmml"><mi id="algx2.l16.m1.2.2.2.2.2.2.1.1.1.2" xref="algx2.l16.m1.2.2.2.2.2.2.1.1.1.2.cmml">M</mi><mo id="algx2.l16.m1.2.2.2.2.2.2.1.1.1.1" xref="algx2.l16.m1.2.2.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="algx2.l16.m1.2.2.2.2.2.2.1.1.1.3" xref="algx2.l16.m1.2.2.2.2.2.2.1.1.1.3.cmml">a</mi><mo id="algx2.l16.m1.2.2.2.2.2.2.1.1.1.1a" xref="algx2.l16.m1.2.2.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="algx2.l16.m1.2.2.2.2.2.2.1.1.1.4" xref="algx2.l16.m1.2.2.2.2.2.2.1.1.1.4.cmml">s</mi><mo id="algx2.l16.m1.2.2.2.2.2.2.1.1.1.1b" xref="algx2.l16.m1.2.2.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="algx2.l16.m1.2.2.2.2.2.2.1.1.1.5" xref="algx2.l16.m1.2.2.2.2.2.2.1.1.1.5.cmml">k</mi><mo id="algx2.l16.m1.2.2.2.2.2.2.1.1.1.1c" xref="algx2.l16.m1.2.2.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="algx2.l16.m1.2.2.2.2.2.2.1.1.1.6" xref="algx2.l16.m1.2.2.2.2.2.2.1.1.1.6.cmml">e</mi><mo id="algx2.l16.m1.2.2.2.2.2.2.1.1.1.1d" xref="algx2.l16.m1.2.2.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="algx2.l16.m1.2.2.2.2.2.2.1.1.1.7" xref="algx2.l16.m1.2.2.2.2.2.2.1.1.1.7.cmml">d</mi><mo id="algx2.l16.m1.2.2.2.2.2.2.1.1.1.1e" xref="algx2.l16.m1.2.2.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="algx2.l16.m1.2.2.2.2.2.2.1.1.1.8" xref="algx2.l16.m1.2.2.2.2.2.2.1.1.1.8.cmml">S</mi><mo id="algx2.l16.m1.2.2.2.2.2.2.1.1.1.1f" xref="algx2.l16.m1.2.2.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="algx2.l16.m1.2.2.2.2.2.2.1.1.1.9" xref="algx2.l16.m1.2.2.2.2.2.2.1.1.1.9.cmml">e</mi><mo id="algx2.l16.m1.2.2.2.2.2.2.1.1.1.1g" xref="algx2.l16.m1.2.2.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="algx2.l16.m1.2.2.2.2.2.2.1.1.1.10" xref="algx2.l16.m1.2.2.2.2.2.2.1.1.1.10.cmml">l</mi><mo id="algx2.l16.m1.2.2.2.2.2.2.1.1.1.1h" xref="algx2.l16.m1.2.2.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="algx2.l16.m1.2.2.2.2.2.2.1.1.1.11" xref="algx2.l16.m1.2.2.2.2.2.2.1.1.1.11.cmml">f</mi><mo id="algx2.l16.m1.2.2.2.2.2.2.1.1.1.1i" xref="algx2.l16.m1.2.2.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="algx2.l16.m1.2.2.2.2.2.2.1.1.1.12" xref="algx2.l16.m1.2.2.2.2.2.2.1.1.1.12.cmml">A</mi><mo id="algx2.l16.m1.2.2.2.2.2.2.1.1.1.1j" xref="algx2.l16.m1.2.2.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="algx2.l16.m1.2.2.2.2.2.2.1.1.1.13" xref="algx2.l16.m1.2.2.2.2.2.2.1.1.1.13.cmml">t</mi><mo id="algx2.l16.m1.2.2.2.2.2.2.1.1.1.1k" xref="algx2.l16.m1.2.2.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="algx2.l16.m1.2.2.2.2.2.2.1.1.1.14" xref="algx2.l16.m1.2.2.2.2.2.2.1.1.1.14.cmml">t</mi><mo id="algx2.l16.m1.2.2.2.2.2.2.1.1.1.1l" xref="algx2.l16.m1.2.2.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="algx2.l16.m1.2.2.2.2.2.2.1.1.1.15" xref="algx2.l16.m1.2.2.2.2.2.2.1.1.1.15.cmml">e</mi><mo id="algx2.l16.m1.2.2.2.2.2.2.1.1.1.1m" xref="algx2.l16.m1.2.2.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="algx2.l16.m1.2.2.2.2.2.2.1.1.1.16" xref="algx2.l16.m1.2.2.2.2.2.2.1.1.1.16.cmml">n</mi><mo id="algx2.l16.m1.2.2.2.2.2.2.1.1.1.1n" xref="algx2.l16.m1.2.2.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="algx2.l16.m1.2.2.2.2.2.2.1.1.1.17" xref="algx2.l16.m1.2.2.2.2.2.2.1.1.1.17.cmml">t</mi><mo id="algx2.l16.m1.2.2.2.2.2.2.1.1.1.1o" xref="algx2.l16.m1.2.2.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="algx2.l16.m1.2.2.2.2.2.2.1.1.1.18" xref="algx2.l16.m1.2.2.2.2.2.2.1.1.1.18.cmml">i</mi><mo id="algx2.l16.m1.2.2.2.2.2.2.1.1.1.1p" xref="algx2.l16.m1.2.2.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="algx2.l16.m1.2.2.2.2.2.2.1.1.1.19" xref="algx2.l16.m1.2.2.2.2.2.2.1.1.1.19.cmml">o</mi><mo id="algx2.l16.m1.2.2.2.2.2.2.1.1.1.1q" xref="algx2.l16.m1.2.2.2.2.2.2.1.1.1.1.cmml">⁢</mo><msup id="algx2.l16.m1.2.2.2.2.2.2.1.1.1.20" xref="algx2.l16.m1.2.2.2.2.2.2.1.1.1.20.cmml"><mi id="algx2.l16.m1.2.2.2.2.2.2.1.1.1.20.2" xref="algx2.l16.m1.2.2.2.2.2.2.1.1.1.20.2.cmml">n</mi><mn id="algx2.l16.m1.2.2.2.2.2.2.1.1.1.20.3" xref="algx2.l16.m1.2.2.2.2.2.2.1.1.1.20.3.cmml">1</mn></msup></mrow><mo id="algx2.l16.m1.3.3.3.3.3.3.2.2.4" xref="algx2.l16.m1.3.3.3.3.3.3.2.3.cmml">,</mo><mi id="algx2.l16.m1.1.1.1.1.1.1" mathvariant="normal" xref="algx2.l16.m1.1.1.1.1.1.1.cmml">…</mi><mo id="algx2.l16.m1.3.3.3.3.3.3.2.2.5" xref="algx2.l16.m1.3.3.3.3.3.3.2.3.cmml">,</mo><mrow id="algx2.l16.m1.3.3.3.3.3.3.2.2.2" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2.cmml"><mi id="algx2.l16.m1.3.3.3.3.3.3.2.2.2.2" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2.2.cmml">M</mi><mo id="algx2.l16.m1.3.3.3.3.3.3.2.2.2.1" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2.1.cmml">⁢</mo><mi id="algx2.l16.m1.3.3.3.3.3.3.2.2.2.3" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2.3.cmml">a</mi><mo id="algx2.l16.m1.3.3.3.3.3.3.2.2.2.1a" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2.1.cmml">⁢</mo><mi id="algx2.l16.m1.3.3.3.3.3.3.2.2.2.4" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2.4.cmml">s</mi><mo id="algx2.l16.m1.3.3.3.3.3.3.2.2.2.1b" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2.1.cmml">⁢</mo><mi id="algx2.l16.m1.3.3.3.3.3.3.2.2.2.5" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2.5.cmml">k</mi><mo id="algx2.l16.m1.3.3.3.3.3.3.2.2.2.1c" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2.1.cmml">⁢</mo><mi id="algx2.l16.m1.3.3.3.3.3.3.2.2.2.6" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2.6.cmml">e</mi><mo id="algx2.l16.m1.3.3.3.3.3.3.2.2.2.1d" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2.1.cmml">⁢</mo><mi id="algx2.l16.m1.3.3.3.3.3.3.2.2.2.7" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2.7.cmml">d</mi><mo id="algx2.l16.m1.3.3.3.3.3.3.2.2.2.1e" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2.1.cmml">⁢</mo><mi id="algx2.l16.m1.3.3.3.3.3.3.2.2.2.8" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2.8.cmml">S</mi><mo id="algx2.l16.m1.3.3.3.3.3.3.2.2.2.1f" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2.1.cmml">⁢</mo><mi id="algx2.l16.m1.3.3.3.3.3.3.2.2.2.9" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2.9.cmml">e</mi><mo id="algx2.l16.m1.3.3.3.3.3.3.2.2.2.1g" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2.1.cmml">⁢</mo><mi id="algx2.l16.m1.3.3.3.3.3.3.2.2.2.10" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2.10.cmml">l</mi><mo id="algx2.l16.m1.3.3.3.3.3.3.2.2.2.1h" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2.1.cmml">⁢</mo><mi id="algx2.l16.m1.3.3.3.3.3.3.2.2.2.11" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2.11.cmml">f</mi><mo id="algx2.l16.m1.3.3.3.3.3.3.2.2.2.1i" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2.1.cmml">⁢</mo><mi id="algx2.l16.m1.3.3.3.3.3.3.2.2.2.12" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2.12.cmml">A</mi><mo id="algx2.l16.m1.3.3.3.3.3.3.2.2.2.1j" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2.1.cmml">⁢</mo><mi id="algx2.l16.m1.3.3.3.3.3.3.2.2.2.13" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2.13.cmml">t</mi><mo id="algx2.l16.m1.3.3.3.3.3.3.2.2.2.1k" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2.1.cmml">⁢</mo><mi id="algx2.l16.m1.3.3.3.3.3.3.2.2.2.14" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2.14.cmml">t</mi><mo id="algx2.l16.m1.3.3.3.3.3.3.2.2.2.1l" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2.1.cmml">⁢</mo><mi id="algx2.l16.m1.3.3.3.3.3.3.2.2.2.15" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2.15.cmml">e</mi><mo id="algx2.l16.m1.3.3.3.3.3.3.2.2.2.1m" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2.1.cmml">⁢</mo><mi id="algx2.l16.m1.3.3.3.3.3.3.2.2.2.16" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2.16.cmml">n</mi><mo id="algx2.l16.m1.3.3.3.3.3.3.2.2.2.1n" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2.1.cmml">⁢</mo><mi id="algx2.l16.m1.3.3.3.3.3.3.2.2.2.17" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2.17.cmml">t</mi><mo id="algx2.l16.m1.3.3.3.3.3.3.2.2.2.1o" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2.1.cmml">⁢</mo><mi id="algx2.l16.m1.3.3.3.3.3.3.2.2.2.18" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2.18.cmml">i</mi><mo id="algx2.l16.m1.3.3.3.3.3.3.2.2.2.1p" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2.1.cmml">⁢</mo><mi id="algx2.l16.m1.3.3.3.3.3.3.2.2.2.19" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2.19.cmml">o</mi><mo id="algx2.l16.m1.3.3.3.3.3.3.2.2.2.1q" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2.1.cmml">⁢</mo><msup id="algx2.l16.m1.3.3.3.3.3.3.2.2.2.20" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2.20.cmml"><mi id="algx2.l16.m1.3.3.3.3.3.3.2.2.2.20.2" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2.20.2.cmml">n</mi><mtext id="algx2.l16.m1.3.3.3.3.3.3.2.2.2.20.3" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2.20.3a.cmml">num_heads</mtext></msup></mrow><mo id="algx2.l16.m1.3.3.3.3.3.3.2.2.6" stretchy="false" xref="algx2.l16.m1.3.3.3.3.3.3.2.3.cmml">)</mo></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="algx2.l16.m1.3b"><matrix id="algx2.l16.m1.3.3.cmml" xref="algx2.l16.m1.3.3"><matrixrow id="algx2.l16.m1.3.3a.cmml" xref="algx2.l16.m1.3.3"><apply id="algx2.l16.m1.3.3.3.3.3.cmml" xref="algx2.l16.m1.3.3.3.3.3"><ci id="algx2.l16.m1.3.3.3.3.3.4.cmml" xref="algx2.l16.m1.3.3.3.3.3.4">←</ci><apply id="algx2.l16.m1.3.3.3.3.3.5.cmml" xref="algx2.l16.m1.3.3.3.3.3.5"><times id="algx2.l16.m1.3.3.3.3.3.5.1.cmml" xref="algx2.l16.m1.3.3.3.3.3.5.1"></times><ci id="algx2.l16.m1.3.3.3.3.3.5.2.cmml" xref="algx2.l16.m1.3.3.3.3.3.5.2">𝐶</ci><ci id="algx2.l16.m1.3.3.3.3.3.5.3.cmml" xref="algx2.l16.m1.3.3.3.3.3.5.3">𝑜</ci><ci id="algx2.l16.m1.3.3.3.3.3.5.4.cmml" xref="algx2.l16.m1.3.3.3.3.3.5.4">𝑛</ci><ci id="algx2.l16.m1.3.3.3.3.3.5.5.cmml" xref="algx2.l16.m1.3.3.3.3.3.5.5">𝑐</ci><ci id="algx2.l16.m1.3.3.3.3.3.5.6.cmml" xref="algx2.l16.m1.3.3.3.3.3.5.6">𝑎</ci><ci id="algx2.l16.m1.3.3.3.3.3.5.7.cmml" xref="algx2.l16.m1.3.3.3.3.3.5.7">𝑡</ci><ci id="algx2.l16.m1.3.3.3.3.3.5.8.cmml" xref="algx2.l16.m1.3.3.3.3.3.5.8">𝑆</ci><ci id="algx2.l16.m1.3.3.3.3.3.5.9.cmml" xref="algx2.l16.m1.3.3.3.3.3.5.9">𝑒</ci><ci id="algx2.l16.m1.3.3.3.3.3.5.10.cmml" xref="algx2.l16.m1.3.3.3.3.3.5.10">𝑙</ci><ci id="algx2.l16.m1.3.3.3.3.3.5.11.cmml" xref="algx2.l16.m1.3.3.3.3.3.5.11">𝑓</ci><ci id="algx2.l16.m1.3.3.3.3.3.5.12.cmml" xref="algx2.l16.m1.3.3.3.3.3.5.12">𝐴</ci><ci id="algx2.l16.m1.3.3.3.3.3.5.13.cmml" xref="algx2.l16.m1.3.3.3.3.3.5.13">𝑡</ci><ci id="algx2.l16.m1.3.3.3.3.3.5.14.cmml" xref="algx2.l16.m1.3.3.3.3.3.5.14">𝑡</ci><ci id="algx2.l16.m1.3.3.3.3.3.5.15.cmml" xref="algx2.l16.m1.3.3.3.3.3.5.15">𝑒</ci><ci id="algx2.l16.m1.3.3.3.3.3.5.16.cmml" xref="algx2.l16.m1.3.3.3.3.3.5.16">𝑛</ci><ci id="algx2.l16.m1.3.3.3.3.3.5.17.cmml" xref="algx2.l16.m1.3.3.3.3.3.5.17">𝑡</ci><ci id="algx2.l16.m1.3.3.3.3.3.5.18.cmml" xref="algx2.l16.m1.3.3.3.3.3.5.18">𝑖</ci><ci id="algx2.l16.m1.3.3.3.3.3.5.19.cmml" xref="algx2.l16.m1.3.3.3.3.3.5.19">𝑜</ci><ci id="algx2.l16.m1.3.3.3.3.3.5.20.cmml" xref="algx2.l16.m1.3.3.3.3.3.5.20">𝑛</ci></apply><apply id="algx2.l16.m1.3.3.3.3.3.3.cmml" xref="algx2.l16.m1.3.3.3.3.3.3"><times id="algx2.l16.m1.3.3.3.3.3.3.3.cmml" xref="algx2.l16.m1.3.3.3.3.3.3.3"></times><ci id="algx2.l16.m1.3.3.3.3.3.3.4a.cmml" xref="algx2.l16.m1.3.3.3.3.3.3.4"><mtext id="algx2.l16.m1.3.3.3.3.3.3.4.cmml" xref="algx2.l16.m1.3.3.3.3.3.3.4">Concatenate</mtext></ci><vector id="algx2.l16.m1.3.3.3.3.3.3.2.3.cmml" xref="algx2.l16.m1.3.3.3.3.3.3.2.2"><apply id="algx2.l16.m1.2.2.2.2.2.2.1.1.1.cmml" xref="algx2.l16.m1.2.2.2.2.2.2.1.1.1"><times id="algx2.l16.m1.2.2.2.2.2.2.1.1.1.1.cmml" xref="algx2.l16.m1.2.2.2.2.2.2.1.1.1.1"></times><ci id="algx2.l16.m1.2.2.2.2.2.2.1.1.1.2.cmml" xref="algx2.l16.m1.2.2.2.2.2.2.1.1.1.2">𝑀</ci><ci id="algx2.l16.m1.2.2.2.2.2.2.1.1.1.3.cmml" xref="algx2.l16.m1.2.2.2.2.2.2.1.1.1.3">𝑎</ci><ci id="algx2.l16.m1.2.2.2.2.2.2.1.1.1.4.cmml" xref="algx2.l16.m1.2.2.2.2.2.2.1.1.1.4">𝑠</ci><ci id="algx2.l16.m1.2.2.2.2.2.2.1.1.1.5.cmml" xref="algx2.l16.m1.2.2.2.2.2.2.1.1.1.5">𝑘</ci><ci id="algx2.l16.m1.2.2.2.2.2.2.1.1.1.6.cmml" xref="algx2.l16.m1.2.2.2.2.2.2.1.1.1.6">𝑒</ci><ci id="algx2.l16.m1.2.2.2.2.2.2.1.1.1.7.cmml" xref="algx2.l16.m1.2.2.2.2.2.2.1.1.1.7">𝑑</ci><ci id="algx2.l16.m1.2.2.2.2.2.2.1.1.1.8.cmml" xref="algx2.l16.m1.2.2.2.2.2.2.1.1.1.8">𝑆</ci><ci id="algx2.l16.m1.2.2.2.2.2.2.1.1.1.9.cmml" xref="algx2.l16.m1.2.2.2.2.2.2.1.1.1.9">𝑒</ci><ci id="algx2.l16.m1.2.2.2.2.2.2.1.1.1.10.cmml" xref="algx2.l16.m1.2.2.2.2.2.2.1.1.1.10">𝑙</ci><ci id="algx2.l16.m1.2.2.2.2.2.2.1.1.1.11.cmml" xref="algx2.l16.m1.2.2.2.2.2.2.1.1.1.11">𝑓</ci><ci id="algx2.l16.m1.2.2.2.2.2.2.1.1.1.12.cmml" xref="algx2.l16.m1.2.2.2.2.2.2.1.1.1.12">𝐴</ci><ci id="algx2.l16.m1.2.2.2.2.2.2.1.1.1.13.cmml" xref="algx2.l16.m1.2.2.2.2.2.2.1.1.1.13">𝑡</ci><ci id="algx2.l16.m1.2.2.2.2.2.2.1.1.1.14.cmml" xref="algx2.l16.m1.2.2.2.2.2.2.1.1.1.14">𝑡</ci><ci id="algx2.l16.m1.2.2.2.2.2.2.1.1.1.15.cmml" xref="algx2.l16.m1.2.2.2.2.2.2.1.1.1.15">𝑒</ci><ci id="algx2.l16.m1.2.2.2.2.2.2.1.1.1.16.cmml" xref="algx2.l16.m1.2.2.2.2.2.2.1.1.1.16">𝑛</ci><ci id="algx2.l16.m1.2.2.2.2.2.2.1.1.1.17.cmml" xref="algx2.l16.m1.2.2.2.2.2.2.1.1.1.17">𝑡</ci><ci id="algx2.l16.m1.2.2.2.2.2.2.1.1.1.18.cmml" xref="algx2.l16.m1.2.2.2.2.2.2.1.1.1.18">𝑖</ci><ci id="algx2.l16.m1.2.2.2.2.2.2.1.1.1.19.cmml" xref="algx2.l16.m1.2.2.2.2.2.2.1.1.1.19">𝑜</ci><apply id="algx2.l16.m1.2.2.2.2.2.2.1.1.1.20.cmml" xref="algx2.l16.m1.2.2.2.2.2.2.1.1.1.20"><csymbol cd="ambiguous" id="algx2.l16.m1.2.2.2.2.2.2.1.1.1.20.1.cmml" xref="algx2.l16.m1.2.2.2.2.2.2.1.1.1.20">superscript</csymbol><ci id="algx2.l16.m1.2.2.2.2.2.2.1.1.1.20.2.cmml" xref="algx2.l16.m1.2.2.2.2.2.2.1.1.1.20.2">𝑛</ci><cn id="algx2.l16.m1.2.2.2.2.2.2.1.1.1.20.3.cmml" type="integer" xref="algx2.l16.m1.2.2.2.2.2.2.1.1.1.20.3">1</cn></apply></apply><ci id="algx2.l16.m1.1.1.1.1.1.1.cmml" xref="algx2.l16.m1.1.1.1.1.1.1">…</ci><apply id="algx2.l16.m1.3.3.3.3.3.3.2.2.2.cmml" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2"><times id="algx2.l16.m1.3.3.3.3.3.3.2.2.2.1.cmml" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2.1"></times><ci id="algx2.l16.m1.3.3.3.3.3.3.2.2.2.2.cmml" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2.2">𝑀</ci><ci id="algx2.l16.m1.3.3.3.3.3.3.2.2.2.3.cmml" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2.3">𝑎</ci><ci id="algx2.l16.m1.3.3.3.3.3.3.2.2.2.4.cmml" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2.4">𝑠</ci><ci id="algx2.l16.m1.3.3.3.3.3.3.2.2.2.5.cmml" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2.5">𝑘</ci><ci id="algx2.l16.m1.3.3.3.3.3.3.2.2.2.6.cmml" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2.6">𝑒</ci><ci id="algx2.l16.m1.3.3.3.3.3.3.2.2.2.7.cmml" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2.7">𝑑</ci><ci id="algx2.l16.m1.3.3.3.3.3.3.2.2.2.8.cmml" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2.8">𝑆</ci><ci id="algx2.l16.m1.3.3.3.3.3.3.2.2.2.9.cmml" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2.9">𝑒</ci><ci id="algx2.l16.m1.3.3.3.3.3.3.2.2.2.10.cmml" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2.10">𝑙</ci><ci id="algx2.l16.m1.3.3.3.3.3.3.2.2.2.11.cmml" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2.11">𝑓</ci><ci id="algx2.l16.m1.3.3.3.3.3.3.2.2.2.12.cmml" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2.12">𝐴</ci><ci id="algx2.l16.m1.3.3.3.3.3.3.2.2.2.13.cmml" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2.13">𝑡</ci><ci id="algx2.l16.m1.3.3.3.3.3.3.2.2.2.14.cmml" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2.14">𝑡</ci><ci id="algx2.l16.m1.3.3.3.3.3.3.2.2.2.15.cmml" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2.15">𝑒</ci><ci id="algx2.l16.m1.3.3.3.3.3.3.2.2.2.16.cmml" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2.16">𝑛</ci><ci id="algx2.l16.m1.3.3.3.3.3.3.2.2.2.17.cmml" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2.17">𝑡</ci><ci id="algx2.l16.m1.3.3.3.3.3.3.2.2.2.18.cmml" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2.18">𝑖</ci><ci id="algx2.l16.m1.3.3.3.3.3.3.2.2.2.19.cmml" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2.19">𝑜</ci><apply id="algx2.l16.m1.3.3.3.3.3.3.2.2.2.20.cmml" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2.20"><csymbol cd="ambiguous" id="algx2.l16.m1.3.3.3.3.3.3.2.2.2.20.1.cmml" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2.20">superscript</csymbol><ci id="algx2.l16.m1.3.3.3.3.3.3.2.2.2.20.2.cmml" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2.20.2">𝑛</ci><ci id="algx2.l16.m1.3.3.3.3.3.3.2.2.2.20.3a.cmml" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2.20.3"><mtext id="algx2.l16.m1.3.3.3.3.3.3.2.2.2.20.3.cmml" mathsize="70%" xref="algx2.l16.m1.3.3.3.3.3.3.2.2.2.20.3">num_heads</mtext></ci></apply></apply></vector></apply></apply></matrixrow></matrix></annotation-xml><annotation encoding="application/x-tex" id="algx2.l16.m1.3c">\begin{aligned} ConcatSelfAttention\leftarrow\text{Concatenate}(%
MaskedSelfAttention^{1},\dots,MaskedSelfAttention^{\text{num\_heads}})\end{aligned}</annotation><annotation encoding="application/x-llamapun" id="algx2.l16.m1.3d">start_ROW start_CELL italic_C italic_o italic_n italic_c italic_a italic_t italic_S italic_e italic_l italic_f italic_A italic_t italic_t italic_e italic_n italic_t italic_i italic_o italic_n ← Concatenate ( italic_M italic_a italic_s italic_k italic_e italic_d italic_S italic_e italic_l italic_f italic_A italic_t italic_t italic_e italic_n italic_t italic_i italic_o italic_n start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , … , italic_M italic_a italic_s italic_k italic_e italic_d italic_S italic_e italic_l italic_f italic_A italic_t italic_t italic_e italic_n italic_t italic_i italic_o italic_n start_POSTSUPERSCRIPT num_heads end_POSTSUPERSCRIPT ) end_CELL end_ROW</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algx2.l17">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algx2.l17.1.1.1" style="font-size:80%;">17:</span></span>  <math alttext="SelfAttentionOutput_{a}\leftarrow\text{LayerNorm}(ConcatSelfAttention\cdot W_{%
O}+a)" class="ltx_Math" display="inline" id="algx2.l17.m1.1"><semantics id="algx2.l17.m1.1a"><mrow id="algx2.l17.m1.1.1" xref="algx2.l17.m1.1.1.cmml"><mrow id="algx2.l17.m1.1.1.3" xref="algx2.l17.m1.1.1.3.cmml"><mi id="algx2.l17.m1.1.1.3.2" xref="algx2.l17.m1.1.1.3.2.cmml">S</mi><mo id="algx2.l17.m1.1.1.3.1" xref="algx2.l17.m1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l17.m1.1.1.3.3" xref="algx2.l17.m1.1.1.3.3.cmml">e</mi><mo id="algx2.l17.m1.1.1.3.1a" xref="algx2.l17.m1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l17.m1.1.1.3.4" xref="algx2.l17.m1.1.1.3.4.cmml">l</mi><mo id="algx2.l17.m1.1.1.3.1b" xref="algx2.l17.m1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l17.m1.1.1.3.5" xref="algx2.l17.m1.1.1.3.5.cmml">f</mi><mo id="algx2.l17.m1.1.1.3.1c" xref="algx2.l17.m1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l17.m1.1.1.3.6" xref="algx2.l17.m1.1.1.3.6.cmml">A</mi><mo id="algx2.l17.m1.1.1.3.1d" xref="algx2.l17.m1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l17.m1.1.1.3.7" xref="algx2.l17.m1.1.1.3.7.cmml">t</mi><mo id="algx2.l17.m1.1.1.3.1e" xref="algx2.l17.m1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l17.m1.1.1.3.8" xref="algx2.l17.m1.1.1.3.8.cmml">t</mi><mo id="algx2.l17.m1.1.1.3.1f" xref="algx2.l17.m1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l17.m1.1.1.3.9" xref="algx2.l17.m1.1.1.3.9.cmml">e</mi><mo id="algx2.l17.m1.1.1.3.1g" xref="algx2.l17.m1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l17.m1.1.1.3.10" xref="algx2.l17.m1.1.1.3.10.cmml">n</mi><mo id="algx2.l17.m1.1.1.3.1h" xref="algx2.l17.m1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l17.m1.1.1.3.11" xref="algx2.l17.m1.1.1.3.11.cmml">t</mi><mo id="algx2.l17.m1.1.1.3.1i" xref="algx2.l17.m1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l17.m1.1.1.3.12" xref="algx2.l17.m1.1.1.3.12.cmml">i</mi><mo id="algx2.l17.m1.1.1.3.1j" xref="algx2.l17.m1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l17.m1.1.1.3.13" xref="algx2.l17.m1.1.1.3.13.cmml">o</mi><mo id="algx2.l17.m1.1.1.3.1k" xref="algx2.l17.m1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l17.m1.1.1.3.14" xref="algx2.l17.m1.1.1.3.14.cmml">n</mi><mo id="algx2.l17.m1.1.1.3.1l" xref="algx2.l17.m1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l17.m1.1.1.3.15" xref="algx2.l17.m1.1.1.3.15.cmml">O</mi><mo id="algx2.l17.m1.1.1.3.1m" xref="algx2.l17.m1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l17.m1.1.1.3.16" xref="algx2.l17.m1.1.1.3.16.cmml">u</mi><mo id="algx2.l17.m1.1.1.3.1n" xref="algx2.l17.m1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l17.m1.1.1.3.17" xref="algx2.l17.m1.1.1.3.17.cmml">t</mi><mo id="algx2.l17.m1.1.1.3.1o" xref="algx2.l17.m1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l17.m1.1.1.3.18" xref="algx2.l17.m1.1.1.3.18.cmml">p</mi><mo id="algx2.l17.m1.1.1.3.1p" xref="algx2.l17.m1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l17.m1.1.1.3.19" xref="algx2.l17.m1.1.1.3.19.cmml">u</mi><mo id="algx2.l17.m1.1.1.3.1q" xref="algx2.l17.m1.1.1.3.1.cmml">⁢</mo><msub id="algx2.l17.m1.1.1.3.20" xref="algx2.l17.m1.1.1.3.20.cmml"><mi id="algx2.l17.m1.1.1.3.20.2" xref="algx2.l17.m1.1.1.3.20.2.cmml">t</mi><mi id="algx2.l17.m1.1.1.3.20.3" xref="algx2.l17.m1.1.1.3.20.3.cmml">a</mi></msub></mrow><mo id="algx2.l17.m1.1.1.2" stretchy="false" xref="algx2.l17.m1.1.1.2.cmml">←</mo><mrow id="algx2.l17.m1.1.1.1" xref="algx2.l17.m1.1.1.1.cmml"><mtext id="algx2.l17.m1.1.1.1.3" xref="algx2.l17.m1.1.1.1.3a.cmml">LayerNorm</mtext><mo id="algx2.l17.m1.1.1.1.2" xref="algx2.l17.m1.1.1.1.2.cmml">⁢</mo><mrow id="algx2.l17.m1.1.1.1.1.1" xref="algx2.l17.m1.1.1.1.1.1.1.cmml"><mo id="algx2.l17.m1.1.1.1.1.1.2" stretchy="false" xref="algx2.l17.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="algx2.l17.m1.1.1.1.1.1.1" xref="algx2.l17.m1.1.1.1.1.1.1.cmml"><mrow id="algx2.l17.m1.1.1.1.1.1.1.2" xref="algx2.l17.m1.1.1.1.1.1.1.2.cmml"><mrow id="algx2.l17.m1.1.1.1.1.1.1.2.2" xref="algx2.l17.m1.1.1.1.1.1.1.2.2.cmml"><mi id="algx2.l17.m1.1.1.1.1.1.1.2.2.2" xref="algx2.l17.m1.1.1.1.1.1.1.2.2.2.cmml">C</mi><mo id="algx2.l17.m1.1.1.1.1.1.1.2.2.1" xref="algx2.l17.m1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="algx2.l17.m1.1.1.1.1.1.1.2.2.3" xref="algx2.l17.m1.1.1.1.1.1.1.2.2.3.cmml">o</mi><mo id="algx2.l17.m1.1.1.1.1.1.1.2.2.1a" xref="algx2.l17.m1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="algx2.l17.m1.1.1.1.1.1.1.2.2.4" xref="algx2.l17.m1.1.1.1.1.1.1.2.2.4.cmml">n</mi><mo id="algx2.l17.m1.1.1.1.1.1.1.2.2.1b" xref="algx2.l17.m1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="algx2.l17.m1.1.1.1.1.1.1.2.2.5" xref="algx2.l17.m1.1.1.1.1.1.1.2.2.5.cmml">c</mi><mo id="algx2.l17.m1.1.1.1.1.1.1.2.2.1c" xref="algx2.l17.m1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="algx2.l17.m1.1.1.1.1.1.1.2.2.6" xref="algx2.l17.m1.1.1.1.1.1.1.2.2.6.cmml">a</mi><mo id="algx2.l17.m1.1.1.1.1.1.1.2.2.1d" xref="algx2.l17.m1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="algx2.l17.m1.1.1.1.1.1.1.2.2.7" xref="algx2.l17.m1.1.1.1.1.1.1.2.2.7.cmml">t</mi><mo id="algx2.l17.m1.1.1.1.1.1.1.2.2.1e" xref="algx2.l17.m1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="algx2.l17.m1.1.1.1.1.1.1.2.2.8" xref="algx2.l17.m1.1.1.1.1.1.1.2.2.8.cmml">S</mi><mo id="algx2.l17.m1.1.1.1.1.1.1.2.2.1f" xref="algx2.l17.m1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="algx2.l17.m1.1.1.1.1.1.1.2.2.9" xref="algx2.l17.m1.1.1.1.1.1.1.2.2.9.cmml">e</mi><mo id="algx2.l17.m1.1.1.1.1.1.1.2.2.1g" xref="algx2.l17.m1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="algx2.l17.m1.1.1.1.1.1.1.2.2.10" xref="algx2.l17.m1.1.1.1.1.1.1.2.2.10.cmml">l</mi><mo id="algx2.l17.m1.1.1.1.1.1.1.2.2.1h" xref="algx2.l17.m1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="algx2.l17.m1.1.1.1.1.1.1.2.2.11" xref="algx2.l17.m1.1.1.1.1.1.1.2.2.11.cmml">f</mi><mo id="algx2.l17.m1.1.1.1.1.1.1.2.2.1i" xref="algx2.l17.m1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="algx2.l17.m1.1.1.1.1.1.1.2.2.12" xref="algx2.l17.m1.1.1.1.1.1.1.2.2.12.cmml">A</mi><mo id="algx2.l17.m1.1.1.1.1.1.1.2.2.1j" xref="algx2.l17.m1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="algx2.l17.m1.1.1.1.1.1.1.2.2.13" xref="algx2.l17.m1.1.1.1.1.1.1.2.2.13.cmml">t</mi><mo id="algx2.l17.m1.1.1.1.1.1.1.2.2.1k" xref="algx2.l17.m1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="algx2.l17.m1.1.1.1.1.1.1.2.2.14" xref="algx2.l17.m1.1.1.1.1.1.1.2.2.14.cmml">t</mi><mo id="algx2.l17.m1.1.1.1.1.1.1.2.2.1l" xref="algx2.l17.m1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="algx2.l17.m1.1.1.1.1.1.1.2.2.15" xref="algx2.l17.m1.1.1.1.1.1.1.2.2.15.cmml">e</mi><mo id="algx2.l17.m1.1.1.1.1.1.1.2.2.1m" xref="algx2.l17.m1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="algx2.l17.m1.1.1.1.1.1.1.2.2.16" xref="algx2.l17.m1.1.1.1.1.1.1.2.2.16.cmml">n</mi><mo id="algx2.l17.m1.1.1.1.1.1.1.2.2.1n" xref="algx2.l17.m1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="algx2.l17.m1.1.1.1.1.1.1.2.2.17" xref="algx2.l17.m1.1.1.1.1.1.1.2.2.17.cmml">t</mi><mo id="algx2.l17.m1.1.1.1.1.1.1.2.2.1o" xref="algx2.l17.m1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="algx2.l17.m1.1.1.1.1.1.1.2.2.18" xref="algx2.l17.m1.1.1.1.1.1.1.2.2.18.cmml">i</mi><mo id="algx2.l17.m1.1.1.1.1.1.1.2.2.1p" xref="algx2.l17.m1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="algx2.l17.m1.1.1.1.1.1.1.2.2.19" xref="algx2.l17.m1.1.1.1.1.1.1.2.2.19.cmml">o</mi><mo id="algx2.l17.m1.1.1.1.1.1.1.2.2.1q" xref="algx2.l17.m1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="algx2.l17.m1.1.1.1.1.1.1.2.2.20" xref="algx2.l17.m1.1.1.1.1.1.1.2.2.20.cmml">n</mi></mrow><mo id="algx2.l17.m1.1.1.1.1.1.1.2.1" lspace="0.222em" rspace="0.222em" xref="algx2.l17.m1.1.1.1.1.1.1.2.1.cmml">⋅</mo><msub id="algx2.l17.m1.1.1.1.1.1.1.2.3" xref="algx2.l17.m1.1.1.1.1.1.1.2.3.cmml"><mi id="algx2.l17.m1.1.1.1.1.1.1.2.3.2" xref="algx2.l17.m1.1.1.1.1.1.1.2.3.2.cmml">W</mi><mi id="algx2.l17.m1.1.1.1.1.1.1.2.3.3" xref="algx2.l17.m1.1.1.1.1.1.1.2.3.3.cmml">O</mi></msub></mrow><mo id="algx2.l17.m1.1.1.1.1.1.1.1" xref="algx2.l17.m1.1.1.1.1.1.1.1.cmml">+</mo><mi id="algx2.l17.m1.1.1.1.1.1.1.3" xref="algx2.l17.m1.1.1.1.1.1.1.3.cmml">a</mi></mrow><mo id="algx2.l17.m1.1.1.1.1.1.3" stretchy="false" xref="algx2.l17.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx2.l17.m1.1b"><apply id="algx2.l17.m1.1.1.cmml" xref="algx2.l17.m1.1.1"><ci id="algx2.l17.m1.1.1.2.cmml" xref="algx2.l17.m1.1.1.2">←</ci><apply id="algx2.l17.m1.1.1.3.cmml" xref="algx2.l17.m1.1.1.3"><times id="algx2.l17.m1.1.1.3.1.cmml" xref="algx2.l17.m1.1.1.3.1"></times><ci id="algx2.l17.m1.1.1.3.2.cmml" xref="algx2.l17.m1.1.1.3.2">𝑆</ci><ci id="algx2.l17.m1.1.1.3.3.cmml" xref="algx2.l17.m1.1.1.3.3">𝑒</ci><ci id="algx2.l17.m1.1.1.3.4.cmml" xref="algx2.l17.m1.1.1.3.4">𝑙</ci><ci id="algx2.l17.m1.1.1.3.5.cmml" xref="algx2.l17.m1.1.1.3.5">𝑓</ci><ci id="algx2.l17.m1.1.1.3.6.cmml" xref="algx2.l17.m1.1.1.3.6">𝐴</ci><ci id="algx2.l17.m1.1.1.3.7.cmml" xref="algx2.l17.m1.1.1.3.7">𝑡</ci><ci id="algx2.l17.m1.1.1.3.8.cmml" xref="algx2.l17.m1.1.1.3.8">𝑡</ci><ci id="algx2.l17.m1.1.1.3.9.cmml" xref="algx2.l17.m1.1.1.3.9">𝑒</ci><ci id="algx2.l17.m1.1.1.3.10.cmml" xref="algx2.l17.m1.1.1.3.10">𝑛</ci><ci id="algx2.l17.m1.1.1.3.11.cmml" xref="algx2.l17.m1.1.1.3.11">𝑡</ci><ci id="algx2.l17.m1.1.1.3.12.cmml" xref="algx2.l17.m1.1.1.3.12">𝑖</ci><ci id="algx2.l17.m1.1.1.3.13.cmml" xref="algx2.l17.m1.1.1.3.13">𝑜</ci><ci id="algx2.l17.m1.1.1.3.14.cmml" xref="algx2.l17.m1.1.1.3.14">𝑛</ci><ci id="algx2.l17.m1.1.1.3.15.cmml" xref="algx2.l17.m1.1.1.3.15">𝑂</ci><ci id="algx2.l17.m1.1.1.3.16.cmml" xref="algx2.l17.m1.1.1.3.16">𝑢</ci><ci id="algx2.l17.m1.1.1.3.17.cmml" xref="algx2.l17.m1.1.1.3.17">𝑡</ci><ci id="algx2.l17.m1.1.1.3.18.cmml" xref="algx2.l17.m1.1.1.3.18">𝑝</ci><ci id="algx2.l17.m1.1.1.3.19.cmml" xref="algx2.l17.m1.1.1.3.19">𝑢</ci><apply id="algx2.l17.m1.1.1.3.20.cmml" xref="algx2.l17.m1.1.1.3.20"><csymbol cd="ambiguous" id="algx2.l17.m1.1.1.3.20.1.cmml" xref="algx2.l17.m1.1.1.3.20">subscript</csymbol><ci id="algx2.l17.m1.1.1.3.20.2.cmml" xref="algx2.l17.m1.1.1.3.20.2">𝑡</ci><ci id="algx2.l17.m1.1.1.3.20.3.cmml" xref="algx2.l17.m1.1.1.3.20.3">𝑎</ci></apply></apply><apply id="algx2.l17.m1.1.1.1.cmml" xref="algx2.l17.m1.1.1.1"><times id="algx2.l17.m1.1.1.1.2.cmml" xref="algx2.l17.m1.1.1.1.2"></times><ci id="algx2.l17.m1.1.1.1.3a.cmml" xref="algx2.l17.m1.1.1.1.3"><mtext id="algx2.l17.m1.1.1.1.3.cmml" xref="algx2.l17.m1.1.1.1.3">LayerNorm</mtext></ci><apply id="algx2.l17.m1.1.1.1.1.1.1.cmml" xref="algx2.l17.m1.1.1.1.1.1"><plus id="algx2.l17.m1.1.1.1.1.1.1.1.cmml" xref="algx2.l17.m1.1.1.1.1.1.1.1"></plus><apply id="algx2.l17.m1.1.1.1.1.1.1.2.cmml" xref="algx2.l17.m1.1.1.1.1.1.1.2"><ci id="algx2.l17.m1.1.1.1.1.1.1.2.1.cmml" xref="algx2.l17.m1.1.1.1.1.1.1.2.1">⋅</ci><apply id="algx2.l17.m1.1.1.1.1.1.1.2.2.cmml" xref="algx2.l17.m1.1.1.1.1.1.1.2.2"><times id="algx2.l17.m1.1.1.1.1.1.1.2.2.1.cmml" xref="algx2.l17.m1.1.1.1.1.1.1.2.2.1"></times><ci id="algx2.l17.m1.1.1.1.1.1.1.2.2.2.cmml" xref="algx2.l17.m1.1.1.1.1.1.1.2.2.2">𝐶</ci><ci id="algx2.l17.m1.1.1.1.1.1.1.2.2.3.cmml" xref="algx2.l17.m1.1.1.1.1.1.1.2.2.3">𝑜</ci><ci id="algx2.l17.m1.1.1.1.1.1.1.2.2.4.cmml" xref="algx2.l17.m1.1.1.1.1.1.1.2.2.4">𝑛</ci><ci id="algx2.l17.m1.1.1.1.1.1.1.2.2.5.cmml" xref="algx2.l17.m1.1.1.1.1.1.1.2.2.5">𝑐</ci><ci id="algx2.l17.m1.1.1.1.1.1.1.2.2.6.cmml" xref="algx2.l17.m1.1.1.1.1.1.1.2.2.6">𝑎</ci><ci id="algx2.l17.m1.1.1.1.1.1.1.2.2.7.cmml" xref="algx2.l17.m1.1.1.1.1.1.1.2.2.7">𝑡</ci><ci id="algx2.l17.m1.1.1.1.1.1.1.2.2.8.cmml" xref="algx2.l17.m1.1.1.1.1.1.1.2.2.8">𝑆</ci><ci id="algx2.l17.m1.1.1.1.1.1.1.2.2.9.cmml" xref="algx2.l17.m1.1.1.1.1.1.1.2.2.9">𝑒</ci><ci id="algx2.l17.m1.1.1.1.1.1.1.2.2.10.cmml" xref="algx2.l17.m1.1.1.1.1.1.1.2.2.10">𝑙</ci><ci id="algx2.l17.m1.1.1.1.1.1.1.2.2.11.cmml" xref="algx2.l17.m1.1.1.1.1.1.1.2.2.11">𝑓</ci><ci id="algx2.l17.m1.1.1.1.1.1.1.2.2.12.cmml" xref="algx2.l17.m1.1.1.1.1.1.1.2.2.12">𝐴</ci><ci id="algx2.l17.m1.1.1.1.1.1.1.2.2.13.cmml" xref="algx2.l17.m1.1.1.1.1.1.1.2.2.13">𝑡</ci><ci id="algx2.l17.m1.1.1.1.1.1.1.2.2.14.cmml" xref="algx2.l17.m1.1.1.1.1.1.1.2.2.14">𝑡</ci><ci id="algx2.l17.m1.1.1.1.1.1.1.2.2.15.cmml" xref="algx2.l17.m1.1.1.1.1.1.1.2.2.15">𝑒</ci><ci id="algx2.l17.m1.1.1.1.1.1.1.2.2.16.cmml" xref="algx2.l17.m1.1.1.1.1.1.1.2.2.16">𝑛</ci><ci id="algx2.l17.m1.1.1.1.1.1.1.2.2.17.cmml" xref="algx2.l17.m1.1.1.1.1.1.1.2.2.17">𝑡</ci><ci id="algx2.l17.m1.1.1.1.1.1.1.2.2.18.cmml" xref="algx2.l17.m1.1.1.1.1.1.1.2.2.18">𝑖</ci><ci id="algx2.l17.m1.1.1.1.1.1.1.2.2.19.cmml" xref="algx2.l17.m1.1.1.1.1.1.1.2.2.19">𝑜</ci><ci id="algx2.l17.m1.1.1.1.1.1.1.2.2.20.cmml" xref="algx2.l17.m1.1.1.1.1.1.1.2.2.20">𝑛</ci></apply><apply id="algx2.l17.m1.1.1.1.1.1.1.2.3.cmml" xref="algx2.l17.m1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="algx2.l17.m1.1.1.1.1.1.1.2.3.1.cmml" xref="algx2.l17.m1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="algx2.l17.m1.1.1.1.1.1.1.2.3.2.cmml" xref="algx2.l17.m1.1.1.1.1.1.1.2.3.2">𝑊</ci><ci id="algx2.l17.m1.1.1.1.1.1.1.2.3.3.cmml" xref="algx2.l17.m1.1.1.1.1.1.1.2.3.3">𝑂</ci></apply></apply><ci id="algx2.l17.m1.1.1.1.1.1.1.3.cmml" xref="algx2.l17.m1.1.1.1.1.1.1.3">𝑎</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx2.l17.m1.1c">SelfAttentionOutput_{a}\leftarrow\text{LayerNorm}(ConcatSelfAttention\cdot W_{%
O}+a)</annotation><annotation encoding="application/x-llamapun" id="algx2.l17.m1.1d">italic_S italic_e italic_l italic_f italic_A italic_t italic_t italic_e italic_n italic_t italic_i italic_o italic_n italic_O italic_u italic_t italic_p italic_u italic_t start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT ← LayerNorm ( italic_C italic_o italic_n italic_c italic_a italic_t italic_S italic_e italic_l italic_f italic_A italic_t italic_t italic_e italic_n italic_t italic_i italic_o italic_n ⋅ italic_W start_POSTSUBSCRIPT italic_O end_POSTSUBSCRIPT + italic_a )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algx2.l18">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algx2.l18.1.1.1" style="font-size:80%;">18:</span></span>  // Multi-head cross-modal attention using <math alttext="SelfAttentionOutput_{a}" class="ltx_Math" display="inline" id="algx2.l18.m1.1"><semantics id="algx2.l18.m1.1a"><mrow id="algx2.l18.m1.1.1" xref="algx2.l18.m1.1.1.cmml"><mi id="algx2.l18.m1.1.1.2" xref="algx2.l18.m1.1.1.2.cmml">S</mi><mo id="algx2.l18.m1.1.1.1" xref="algx2.l18.m1.1.1.1.cmml">⁢</mo><mi id="algx2.l18.m1.1.1.3" xref="algx2.l18.m1.1.1.3.cmml">e</mi><mo id="algx2.l18.m1.1.1.1a" xref="algx2.l18.m1.1.1.1.cmml">⁢</mo><mi id="algx2.l18.m1.1.1.4" xref="algx2.l18.m1.1.1.4.cmml">l</mi><mo id="algx2.l18.m1.1.1.1b" xref="algx2.l18.m1.1.1.1.cmml">⁢</mo><mi id="algx2.l18.m1.1.1.5" xref="algx2.l18.m1.1.1.5.cmml">f</mi><mo id="algx2.l18.m1.1.1.1c" xref="algx2.l18.m1.1.1.1.cmml">⁢</mo><mi id="algx2.l18.m1.1.1.6" xref="algx2.l18.m1.1.1.6.cmml">A</mi><mo id="algx2.l18.m1.1.1.1d" xref="algx2.l18.m1.1.1.1.cmml">⁢</mo><mi id="algx2.l18.m1.1.1.7" xref="algx2.l18.m1.1.1.7.cmml">t</mi><mo id="algx2.l18.m1.1.1.1e" xref="algx2.l18.m1.1.1.1.cmml">⁢</mo><mi id="algx2.l18.m1.1.1.8" xref="algx2.l18.m1.1.1.8.cmml">t</mi><mo id="algx2.l18.m1.1.1.1f" xref="algx2.l18.m1.1.1.1.cmml">⁢</mo><mi id="algx2.l18.m1.1.1.9" xref="algx2.l18.m1.1.1.9.cmml">e</mi><mo id="algx2.l18.m1.1.1.1g" xref="algx2.l18.m1.1.1.1.cmml">⁢</mo><mi id="algx2.l18.m1.1.1.10" xref="algx2.l18.m1.1.1.10.cmml">n</mi><mo id="algx2.l18.m1.1.1.1h" xref="algx2.l18.m1.1.1.1.cmml">⁢</mo><mi id="algx2.l18.m1.1.1.11" xref="algx2.l18.m1.1.1.11.cmml">t</mi><mo id="algx2.l18.m1.1.1.1i" xref="algx2.l18.m1.1.1.1.cmml">⁢</mo><mi id="algx2.l18.m1.1.1.12" xref="algx2.l18.m1.1.1.12.cmml">i</mi><mo id="algx2.l18.m1.1.1.1j" xref="algx2.l18.m1.1.1.1.cmml">⁢</mo><mi id="algx2.l18.m1.1.1.13" xref="algx2.l18.m1.1.1.13.cmml">o</mi><mo id="algx2.l18.m1.1.1.1k" xref="algx2.l18.m1.1.1.1.cmml">⁢</mo><mi id="algx2.l18.m1.1.1.14" xref="algx2.l18.m1.1.1.14.cmml">n</mi><mo id="algx2.l18.m1.1.1.1l" xref="algx2.l18.m1.1.1.1.cmml">⁢</mo><mi id="algx2.l18.m1.1.1.15" xref="algx2.l18.m1.1.1.15.cmml">O</mi><mo id="algx2.l18.m1.1.1.1m" xref="algx2.l18.m1.1.1.1.cmml">⁢</mo><mi id="algx2.l18.m1.1.1.16" xref="algx2.l18.m1.1.1.16.cmml">u</mi><mo id="algx2.l18.m1.1.1.1n" xref="algx2.l18.m1.1.1.1.cmml">⁢</mo><mi id="algx2.l18.m1.1.1.17" xref="algx2.l18.m1.1.1.17.cmml">t</mi><mo id="algx2.l18.m1.1.1.1o" xref="algx2.l18.m1.1.1.1.cmml">⁢</mo><mi id="algx2.l18.m1.1.1.18" xref="algx2.l18.m1.1.1.18.cmml">p</mi><mo id="algx2.l18.m1.1.1.1p" xref="algx2.l18.m1.1.1.1.cmml">⁢</mo><mi id="algx2.l18.m1.1.1.19" xref="algx2.l18.m1.1.1.19.cmml">u</mi><mo id="algx2.l18.m1.1.1.1q" xref="algx2.l18.m1.1.1.1.cmml">⁢</mo><msub id="algx2.l18.m1.1.1.20" xref="algx2.l18.m1.1.1.20.cmml"><mi id="algx2.l18.m1.1.1.20.2" xref="algx2.l18.m1.1.1.20.2.cmml">t</mi><mi id="algx2.l18.m1.1.1.20.3" xref="algx2.l18.m1.1.1.20.3.cmml">a</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="algx2.l18.m1.1b"><apply id="algx2.l18.m1.1.1.cmml" xref="algx2.l18.m1.1.1"><times id="algx2.l18.m1.1.1.1.cmml" xref="algx2.l18.m1.1.1.1"></times><ci id="algx2.l18.m1.1.1.2.cmml" xref="algx2.l18.m1.1.1.2">𝑆</ci><ci id="algx2.l18.m1.1.1.3.cmml" xref="algx2.l18.m1.1.1.3">𝑒</ci><ci id="algx2.l18.m1.1.1.4.cmml" xref="algx2.l18.m1.1.1.4">𝑙</ci><ci id="algx2.l18.m1.1.1.5.cmml" xref="algx2.l18.m1.1.1.5">𝑓</ci><ci id="algx2.l18.m1.1.1.6.cmml" xref="algx2.l18.m1.1.1.6">𝐴</ci><ci id="algx2.l18.m1.1.1.7.cmml" xref="algx2.l18.m1.1.1.7">𝑡</ci><ci id="algx2.l18.m1.1.1.8.cmml" xref="algx2.l18.m1.1.1.8">𝑡</ci><ci id="algx2.l18.m1.1.1.9.cmml" xref="algx2.l18.m1.1.1.9">𝑒</ci><ci id="algx2.l18.m1.1.1.10.cmml" xref="algx2.l18.m1.1.1.10">𝑛</ci><ci id="algx2.l18.m1.1.1.11.cmml" xref="algx2.l18.m1.1.1.11">𝑡</ci><ci id="algx2.l18.m1.1.1.12.cmml" xref="algx2.l18.m1.1.1.12">𝑖</ci><ci id="algx2.l18.m1.1.1.13.cmml" xref="algx2.l18.m1.1.1.13">𝑜</ci><ci id="algx2.l18.m1.1.1.14.cmml" xref="algx2.l18.m1.1.1.14">𝑛</ci><ci id="algx2.l18.m1.1.1.15.cmml" xref="algx2.l18.m1.1.1.15">𝑂</ci><ci id="algx2.l18.m1.1.1.16.cmml" xref="algx2.l18.m1.1.1.16">𝑢</ci><ci id="algx2.l18.m1.1.1.17.cmml" xref="algx2.l18.m1.1.1.17">𝑡</ci><ci id="algx2.l18.m1.1.1.18.cmml" xref="algx2.l18.m1.1.1.18">𝑝</ci><ci id="algx2.l18.m1.1.1.19.cmml" xref="algx2.l18.m1.1.1.19">𝑢</ci><apply id="algx2.l18.m1.1.1.20.cmml" xref="algx2.l18.m1.1.1.20"><csymbol cd="ambiguous" id="algx2.l18.m1.1.1.20.1.cmml" xref="algx2.l18.m1.1.1.20">subscript</csymbol><ci id="algx2.l18.m1.1.1.20.2.cmml" xref="algx2.l18.m1.1.1.20.2">𝑡</ci><ci id="algx2.l18.m1.1.1.20.3.cmml" xref="algx2.l18.m1.1.1.20.3">𝑎</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx2.l18.m1.1c">SelfAttentionOutput_{a}</annotation><annotation encoding="application/x-llamapun" id="algx2.l18.m1.1d">italic_S italic_e italic_l italic_f italic_A italic_t italic_t italic_e italic_n italic_t italic_i italic_o italic_n italic_O italic_u italic_t italic_p italic_u italic_t start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math> as <math alttext="Q" class="ltx_Math" display="inline" id="algx2.l18.m2.1"><semantics id="algx2.l18.m2.1a"><mi id="algx2.l18.m2.1.1" xref="algx2.l18.m2.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="algx2.l18.m2.1b"><ci id="algx2.l18.m2.1.1.cmml" xref="algx2.l18.m2.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="algx2.l18.m2.1c">Q</annotation><annotation encoding="application/x-llamapun" id="algx2.l18.m2.1d">italic_Q</annotation></semantics></math> and <math alttext="l" class="ltx_Math" display="inline" id="algx2.l18.m3.1"><semantics id="algx2.l18.m3.1a"><mi id="algx2.l18.m3.1.1" xref="algx2.l18.m3.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="algx2.l18.m3.1b"><ci id="algx2.l18.m3.1.1.cmml" xref="algx2.l18.m3.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="algx2.l18.m3.1c">l</annotation><annotation encoding="application/x-llamapun" id="algx2.l18.m3.1d">italic_l</annotation></semantics></math> as <math alttext="K" class="ltx_Math" display="inline" id="algx2.l18.m4.1"><semantics id="algx2.l18.m4.1a"><mi id="algx2.l18.m4.1.1" xref="algx2.l18.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="algx2.l18.m4.1b"><ci id="algx2.l18.m4.1.1.cmml" xref="algx2.l18.m4.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="algx2.l18.m4.1c">K</annotation><annotation encoding="application/x-llamapun" id="algx2.l18.m4.1d">italic_K</annotation></semantics></math>, <math alttext="V" class="ltx_Math" display="inline" id="algx2.l18.m5.1"><semantics id="algx2.l18.m5.1a"><mi id="algx2.l18.m5.1.1" xref="algx2.l18.m5.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="algx2.l18.m5.1b"><ci id="algx2.l18.m5.1.1.cmml" xref="algx2.l18.m5.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="algx2.l18.m5.1c">V</annotation><annotation encoding="application/x-llamapun" id="algx2.l18.m5.1d">italic_V</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algx2.l19">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algx2.l19.1.1.1" style="font-size:80%;">19:</span></span>  <span class="ltx_text ltx_font_bold" id="algx2.l19.2">for</span> <math alttext="i=1" class="ltx_Math" display="inline" id="algx2.l19.m1.1"><semantics id="algx2.l19.m1.1a"><mrow id="algx2.l19.m1.1.1" xref="algx2.l19.m1.1.1.cmml"><mi id="algx2.l19.m1.1.1.2" xref="algx2.l19.m1.1.1.2.cmml">i</mi><mo id="algx2.l19.m1.1.1.1" xref="algx2.l19.m1.1.1.1.cmml">=</mo><mn id="algx2.l19.m1.1.1.3" xref="algx2.l19.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="algx2.l19.m1.1b"><apply id="algx2.l19.m1.1.1.cmml" xref="algx2.l19.m1.1.1"><eq id="algx2.l19.m1.1.1.1.cmml" xref="algx2.l19.m1.1.1.1"></eq><ci id="algx2.l19.m1.1.1.2.cmml" xref="algx2.l19.m1.1.1.2">𝑖</ci><cn id="algx2.l19.m1.1.1.3.cmml" type="integer" xref="algx2.l19.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algx2.l19.m1.1c">i=1</annotation><annotation encoding="application/x-llamapun" id="algx2.l19.m1.1d">italic_i = 1</annotation></semantics></math> to <span class="ltx_text ltx_markedasmath" id="algx2.l19.3">num_heads</span> <span class="ltx_text ltx_font_bold" id="algx2.l19.4">do</span>
</div>
<div class="ltx_listingline" id="algx2.l20">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algx2.l20.1.1.1" style="font-size:80%;">20:</span></span>     <math alttext="Q_{\text{cross}}^{i}\leftarrow SelfAttentionOutput_{a}\cdot W_{Q_{a}}^{i}" class="ltx_Math" display="inline" id="algx2.l20.m1.1"><semantics id="algx2.l20.m1.1a"><mrow id="algx2.l20.m1.1.1" xref="algx2.l20.m1.1.1.cmml"><msubsup id="algx2.l20.m1.1.1.2" xref="algx2.l20.m1.1.1.2.cmml"><mi id="algx2.l20.m1.1.1.2.2.2" xref="algx2.l20.m1.1.1.2.2.2.cmml">Q</mi><mtext id="algx2.l20.m1.1.1.2.2.3" xref="algx2.l20.m1.1.1.2.2.3a.cmml">cross</mtext><mi id="algx2.l20.m1.1.1.2.3" xref="algx2.l20.m1.1.1.2.3.cmml">i</mi></msubsup><mo id="algx2.l20.m1.1.1.1" stretchy="false" xref="algx2.l20.m1.1.1.1.cmml">←</mo><mrow id="algx2.l20.m1.1.1.3" xref="algx2.l20.m1.1.1.3.cmml"><mrow id="algx2.l20.m1.1.1.3.2" xref="algx2.l20.m1.1.1.3.2.cmml"><mi id="algx2.l20.m1.1.1.3.2.2" xref="algx2.l20.m1.1.1.3.2.2.cmml">S</mi><mo id="algx2.l20.m1.1.1.3.2.1" xref="algx2.l20.m1.1.1.3.2.1.cmml">⁢</mo><mi id="algx2.l20.m1.1.1.3.2.3" xref="algx2.l20.m1.1.1.3.2.3.cmml">e</mi><mo id="algx2.l20.m1.1.1.3.2.1a" xref="algx2.l20.m1.1.1.3.2.1.cmml">⁢</mo><mi id="algx2.l20.m1.1.1.3.2.4" xref="algx2.l20.m1.1.1.3.2.4.cmml">l</mi><mo id="algx2.l20.m1.1.1.3.2.1b" xref="algx2.l20.m1.1.1.3.2.1.cmml">⁢</mo><mi id="algx2.l20.m1.1.1.3.2.5" xref="algx2.l20.m1.1.1.3.2.5.cmml">f</mi><mo id="algx2.l20.m1.1.1.3.2.1c" xref="algx2.l20.m1.1.1.3.2.1.cmml">⁢</mo><mi id="algx2.l20.m1.1.1.3.2.6" xref="algx2.l20.m1.1.1.3.2.6.cmml">A</mi><mo id="algx2.l20.m1.1.1.3.2.1d" xref="algx2.l20.m1.1.1.3.2.1.cmml">⁢</mo><mi id="algx2.l20.m1.1.1.3.2.7" xref="algx2.l20.m1.1.1.3.2.7.cmml">t</mi><mo id="algx2.l20.m1.1.1.3.2.1e" xref="algx2.l20.m1.1.1.3.2.1.cmml">⁢</mo><mi id="algx2.l20.m1.1.1.3.2.8" xref="algx2.l20.m1.1.1.3.2.8.cmml">t</mi><mo id="algx2.l20.m1.1.1.3.2.1f" xref="algx2.l20.m1.1.1.3.2.1.cmml">⁢</mo><mi id="algx2.l20.m1.1.1.3.2.9" xref="algx2.l20.m1.1.1.3.2.9.cmml">e</mi><mo id="algx2.l20.m1.1.1.3.2.1g" xref="algx2.l20.m1.1.1.3.2.1.cmml">⁢</mo><mi id="algx2.l20.m1.1.1.3.2.10" xref="algx2.l20.m1.1.1.3.2.10.cmml">n</mi><mo id="algx2.l20.m1.1.1.3.2.1h" xref="algx2.l20.m1.1.1.3.2.1.cmml">⁢</mo><mi id="algx2.l20.m1.1.1.3.2.11" xref="algx2.l20.m1.1.1.3.2.11.cmml">t</mi><mo id="algx2.l20.m1.1.1.3.2.1i" xref="algx2.l20.m1.1.1.3.2.1.cmml">⁢</mo><mi id="algx2.l20.m1.1.1.3.2.12" xref="algx2.l20.m1.1.1.3.2.12.cmml">i</mi><mo id="algx2.l20.m1.1.1.3.2.1j" xref="algx2.l20.m1.1.1.3.2.1.cmml">⁢</mo><mi id="algx2.l20.m1.1.1.3.2.13" xref="algx2.l20.m1.1.1.3.2.13.cmml">o</mi><mo id="algx2.l20.m1.1.1.3.2.1k" xref="algx2.l20.m1.1.1.3.2.1.cmml">⁢</mo><mi id="algx2.l20.m1.1.1.3.2.14" xref="algx2.l20.m1.1.1.3.2.14.cmml">n</mi><mo id="algx2.l20.m1.1.1.3.2.1l" xref="algx2.l20.m1.1.1.3.2.1.cmml">⁢</mo><mi id="algx2.l20.m1.1.1.3.2.15" xref="algx2.l20.m1.1.1.3.2.15.cmml">O</mi><mo id="algx2.l20.m1.1.1.3.2.1m" xref="algx2.l20.m1.1.1.3.2.1.cmml">⁢</mo><mi id="algx2.l20.m1.1.1.3.2.16" xref="algx2.l20.m1.1.1.3.2.16.cmml">u</mi><mo id="algx2.l20.m1.1.1.3.2.1n" xref="algx2.l20.m1.1.1.3.2.1.cmml">⁢</mo><mi id="algx2.l20.m1.1.1.3.2.17" xref="algx2.l20.m1.1.1.3.2.17.cmml">t</mi><mo id="algx2.l20.m1.1.1.3.2.1o" xref="algx2.l20.m1.1.1.3.2.1.cmml">⁢</mo><mi id="algx2.l20.m1.1.1.3.2.18" xref="algx2.l20.m1.1.1.3.2.18.cmml">p</mi><mo id="algx2.l20.m1.1.1.3.2.1p" xref="algx2.l20.m1.1.1.3.2.1.cmml">⁢</mo><mi id="algx2.l20.m1.1.1.3.2.19" xref="algx2.l20.m1.1.1.3.2.19.cmml">u</mi><mo id="algx2.l20.m1.1.1.3.2.1q" xref="algx2.l20.m1.1.1.3.2.1.cmml">⁢</mo><msub id="algx2.l20.m1.1.1.3.2.20" xref="algx2.l20.m1.1.1.3.2.20.cmml"><mi id="algx2.l20.m1.1.1.3.2.20.2" xref="algx2.l20.m1.1.1.3.2.20.2.cmml">t</mi><mi id="algx2.l20.m1.1.1.3.2.20.3" xref="algx2.l20.m1.1.1.3.2.20.3.cmml">a</mi></msub></mrow><mo id="algx2.l20.m1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="algx2.l20.m1.1.1.3.1.cmml">⋅</mo><msubsup id="algx2.l20.m1.1.1.3.3" xref="algx2.l20.m1.1.1.3.3.cmml"><mi id="algx2.l20.m1.1.1.3.3.2.2" xref="algx2.l20.m1.1.1.3.3.2.2.cmml">W</mi><msub id="algx2.l20.m1.1.1.3.3.2.3" xref="algx2.l20.m1.1.1.3.3.2.3.cmml"><mi id="algx2.l20.m1.1.1.3.3.2.3.2" xref="algx2.l20.m1.1.1.3.3.2.3.2.cmml">Q</mi><mi id="algx2.l20.m1.1.1.3.3.2.3.3" xref="algx2.l20.m1.1.1.3.3.2.3.3.cmml">a</mi></msub><mi id="algx2.l20.m1.1.1.3.3.3" xref="algx2.l20.m1.1.1.3.3.3.cmml">i</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx2.l20.m1.1b"><apply id="algx2.l20.m1.1.1.cmml" xref="algx2.l20.m1.1.1"><ci id="algx2.l20.m1.1.1.1.cmml" xref="algx2.l20.m1.1.1.1">←</ci><apply id="algx2.l20.m1.1.1.2.cmml" xref="algx2.l20.m1.1.1.2"><csymbol cd="ambiguous" id="algx2.l20.m1.1.1.2.1.cmml" xref="algx2.l20.m1.1.1.2">superscript</csymbol><apply id="algx2.l20.m1.1.1.2.2.cmml" xref="algx2.l20.m1.1.1.2"><csymbol cd="ambiguous" id="algx2.l20.m1.1.1.2.2.1.cmml" xref="algx2.l20.m1.1.1.2">subscript</csymbol><ci id="algx2.l20.m1.1.1.2.2.2.cmml" xref="algx2.l20.m1.1.1.2.2.2">𝑄</ci><ci id="algx2.l20.m1.1.1.2.2.3a.cmml" xref="algx2.l20.m1.1.1.2.2.3"><mtext id="algx2.l20.m1.1.1.2.2.3.cmml" mathsize="70%" xref="algx2.l20.m1.1.1.2.2.3">cross</mtext></ci></apply><ci id="algx2.l20.m1.1.1.2.3.cmml" xref="algx2.l20.m1.1.1.2.3">𝑖</ci></apply><apply id="algx2.l20.m1.1.1.3.cmml" xref="algx2.l20.m1.1.1.3"><ci id="algx2.l20.m1.1.1.3.1.cmml" xref="algx2.l20.m1.1.1.3.1">⋅</ci><apply id="algx2.l20.m1.1.1.3.2.cmml" xref="algx2.l20.m1.1.1.3.2"><times id="algx2.l20.m1.1.1.3.2.1.cmml" xref="algx2.l20.m1.1.1.3.2.1"></times><ci id="algx2.l20.m1.1.1.3.2.2.cmml" xref="algx2.l20.m1.1.1.3.2.2">𝑆</ci><ci id="algx2.l20.m1.1.1.3.2.3.cmml" xref="algx2.l20.m1.1.1.3.2.3">𝑒</ci><ci id="algx2.l20.m1.1.1.3.2.4.cmml" xref="algx2.l20.m1.1.1.3.2.4">𝑙</ci><ci id="algx2.l20.m1.1.1.3.2.5.cmml" xref="algx2.l20.m1.1.1.3.2.5">𝑓</ci><ci id="algx2.l20.m1.1.1.3.2.6.cmml" xref="algx2.l20.m1.1.1.3.2.6">𝐴</ci><ci id="algx2.l20.m1.1.1.3.2.7.cmml" xref="algx2.l20.m1.1.1.3.2.7">𝑡</ci><ci id="algx2.l20.m1.1.1.3.2.8.cmml" xref="algx2.l20.m1.1.1.3.2.8">𝑡</ci><ci id="algx2.l20.m1.1.1.3.2.9.cmml" xref="algx2.l20.m1.1.1.3.2.9">𝑒</ci><ci id="algx2.l20.m1.1.1.3.2.10.cmml" xref="algx2.l20.m1.1.1.3.2.10">𝑛</ci><ci id="algx2.l20.m1.1.1.3.2.11.cmml" xref="algx2.l20.m1.1.1.3.2.11">𝑡</ci><ci id="algx2.l20.m1.1.1.3.2.12.cmml" xref="algx2.l20.m1.1.1.3.2.12">𝑖</ci><ci id="algx2.l20.m1.1.1.3.2.13.cmml" xref="algx2.l20.m1.1.1.3.2.13">𝑜</ci><ci id="algx2.l20.m1.1.1.3.2.14.cmml" xref="algx2.l20.m1.1.1.3.2.14">𝑛</ci><ci id="algx2.l20.m1.1.1.3.2.15.cmml" xref="algx2.l20.m1.1.1.3.2.15">𝑂</ci><ci id="algx2.l20.m1.1.1.3.2.16.cmml" xref="algx2.l20.m1.1.1.3.2.16">𝑢</ci><ci id="algx2.l20.m1.1.1.3.2.17.cmml" xref="algx2.l20.m1.1.1.3.2.17">𝑡</ci><ci id="algx2.l20.m1.1.1.3.2.18.cmml" xref="algx2.l20.m1.1.1.3.2.18">𝑝</ci><ci id="algx2.l20.m1.1.1.3.2.19.cmml" xref="algx2.l20.m1.1.1.3.2.19">𝑢</ci><apply id="algx2.l20.m1.1.1.3.2.20.cmml" xref="algx2.l20.m1.1.1.3.2.20"><csymbol cd="ambiguous" id="algx2.l20.m1.1.1.3.2.20.1.cmml" xref="algx2.l20.m1.1.1.3.2.20">subscript</csymbol><ci id="algx2.l20.m1.1.1.3.2.20.2.cmml" xref="algx2.l20.m1.1.1.3.2.20.2">𝑡</ci><ci id="algx2.l20.m1.1.1.3.2.20.3.cmml" xref="algx2.l20.m1.1.1.3.2.20.3">𝑎</ci></apply></apply><apply id="algx2.l20.m1.1.1.3.3.cmml" xref="algx2.l20.m1.1.1.3.3"><csymbol cd="ambiguous" id="algx2.l20.m1.1.1.3.3.1.cmml" xref="algx2.l20.m1.1.1.3.3">superscript</csymbol><apply id="algx2.l20.m1.1.1.3.3.2.cmml" xref="algx2.l20.m1.1.1.3.3"><csymbol cd="ambiguous" id="algx2.l20.m1.1.1.3.3.2.1.cmml" xref="algx2.l20.m1.1.1.3.3">subscript</csymbol><ci id="algx2.l20.m1.1.1.3.3.2.2.cmml" xref="algx2.l20.m1.1.1.3.3.2.2">𝑊</ci><apply id="algx2.l20.m1.1.1.3.3.2.3.cmml" xref="algx2.l20.m1.1.1.3.3.2.3"><csymbol cd="ambiguous" id="algx2.l20.m1.1.1.3.3.2.3.1.cmml" xref="algx2.l20.m1.1.1.3.3.2.3">subscript</csymbol><ci id="algx2.l20.m1.1.1.3.3.2.3.2.cmml" xref="algx2.l20.m1.1.1.3.3.2.3.2">𝑄</ci><ci id="algx2.l20.m1.1.1.3.3.2.3.3.cmml" xref="algx2.l20.m1.1.1.3.3.2.3.3">𝑎</ci></apply></apply><ci id="algx2.l20.m1.1.1.3.3.3.cmml" xref="algx2.l20.m1.1.1.3.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx2.l20.m1.1c">Q_{\text{cross}}^{i}\leftarrow SelfAttentionOutput_{a}\cdot W_{Q_{a}}^{i}</annotation><annotation encoding="application/x-llamapun" id="algx2.l20.m1.1d">italic_Q start_POSTSUBSCRIPT cross end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ← italic_S italic_e italic_l italic_f italic_A italic_t italic_t italic_e italic_n italic_t italic_i italic_o italic_n italic_O italic_u italic_t italic_p italic_u italic_t start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT ⋅ italic_W start_POSTSUBSCRIPT italic_Q start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algx2.l21">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algx2.l21.1.1.1" style="font-size:80%;">21:</span></span>     <math alttext="K_{l}^{i}\leftarrow l\cdot W_{K_{l}}^{i}" class="ltx_Math" display="inline" id="algx2.l21.m1.1"><semantics id="algx2.l21.m1.1a"><mrow id="algx2.l21.m1.1.1" xref="algx2.l21.m1.1.1.cmml"><msubsup id="algx2.l21.m1.1.1.2" xref="algx2.l21.m1.1.1.2.cmml"><mi id="algx2.l21.m1.1.1.2.2.2" xref="algx2.l21.m1.1.1.2.2.2.cmml">K</mi><mi id="algx2.l21.m1.1.1.2.2.3" xref="algx2.l21.m1.1.1.2.2.3.cmml">l</mi><mi id="algx2.l21.m1.1.1.2.3" xref="algx2.l21.m1.1.1.2.3.cmml">i</mi></msubsup><mo id="algx2.l21.m1.1.1.1" stretchy="false" xref="algx2.l21.m1.1.1.1.cmml">←</mo><mrow id="algx2.l21.m1.1.1.3" xref="algx2.l21.m1.1.1.3.cmml"><mi id="algx2.l21.m1.1.1.3.2" xref="algx2.l21.m1.1.1.3.2.cmml">l</mi><mo id="algx2.l21.m1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="algx2.l21.m1.1.1.3.1.cmml">⋅</mo><msubsup id="algx2.l21.m1.1.1.3.3" xref="algx2.l21.m1.1.1.3.3.cmml"><mi id="algx2.l21.m1.1.1.3.3.2.2" xref="algx2.l21.m1.1.1.3.3.2.2.cmml">W</mi><msub id="algx2.l21.m1.1.1.3.3.2.3" xref="algx2.l21.m1.1.1.3.3.2.3.cmml"><mi id="algx2.l21.m1.1.1.3.3.2.3.2" xref="algx2.l21.m1.1.1.3.3.2.3.2.cmml">K</mi><mi id="algx2.l21.m1.1.1.3.3.2.3.3" xref="algx2.l21.m1.1.1.3.3.2.3.3.cmml">l</mi></msub><mi id="algx2.l21.m1.1.1.3.3.3" xref="algx2.l21.m1.1.1.3.3.3.cmml">i</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx2.l21.m1.1b"><apply id="algx2.l21.m1.1.1.cmml" xref="algx2.l21.m1.1.1"><ci id="algx2.l21.m1.1.1.1.cmml" xref="algx2.l21.m1.1.1.1">←</ci><apply id="algx2.l21.m1.1.1.2.cmml" xref="algx2.l21.m1.1.1.2"><csymbol cd="ambiguous" id="algx2.l21.m1.1.1.2.1.cmml" xref="algx2.l21.m1.1.1.2">superscript</csymbol><apply id="algx2.l21.m1.1.1.2.2.cmml" xref="algx2.l21.m1.1.1.2"><csymbol cd="ambiguous" id="algx2.l21.m1.1.1.2.2.1.cmml" xref="algx2.l21.m1.1.1.2">subscript</csymbol><ci id="algx2.l21.m1.1.1.2.2.2.cmml" xref="algx2.l21.m1.1.1.2.2.2">𝐾</ci><ci id="algx2.l21.m1.1.1.2.2.3.cmml" xref="algx2.l21.m1.1.1.2.2.3">𝑙</ci></apply><ci id="algx2.l21.m1.1.1.2.3.cmml" xref="algx2.l21.m1.1.1.2.3">𝑖</ci></apply><apply id="algx2.l21.m1.1.1.3.cmml" xref="algx2.l21.m1.1.1.3"><ci id="algx2.l21.m1.1.1.3.1.cmml" xref="algx2.l21.m1.1.1.3.1">⋅</ci><ci id="algx2.l21.m1.1.1.3.2.cmml" xref="algx2.l21.m1.1.1.3.2">𝑙</ci><apply id="algx2.l21.m1.1.1.3.3.cmml" xref="algx2.l21.m1.1.1.3.3"><csymbol cd="ambiguous" id="algx2.l21.m1.1.1.3.3.1.cmml" xref="algx2.l21.m1.1.1.3.3">superscript</csymbol><apply id="algx2.l21.m1.1.1.3.3.2.cmml" xref="algx2.l21.m1.1.1.3.3"><csymbol cd="ambiguous" id="algx2.l21.m1.1.1.3.3.2.1.cmml" xref="algx2.l21.m1.1.1.3.3">subscript</csymbol><ci id="algx2.l21.m1.1.1.3.3.2.2.cmml" xref="algx2.l21.m1.1.1.3.3.2.2">𝑊</ci><apply id="algx2.l21.m1.1.1.3.3.2.3.cmml" xref="algx2.l21.m1.1.1.3.3.2.3"><csymbol cd="ambiguous" id="algx2.l21.m1.1.1.3.3.2.3.1.cmml" xref="algx2.l21.m1.1.1.3.3.2.3">subscript</csymbol><ci id="algx2.l21.m1.1.1.3.3.2.3.2.cmml" xref="algx2.l21.m1.1.1.3.3.2.3.2">𝐾</ci><ci id="algx2.l21.m1.1.1.3.3.2.3.3.cmml" xref="algx2.l21.m1.1.1.3.3.2.3.3">𝑙</ci></apply></apply><ci id="algx2.l21.m1.1.1.3.3.3.cmml" xref="algx2.l21.m1.1.1.3.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx2.l21.m1.1c">K_{l}^{i}\leftarrow l\cdot W_{K_{l}}^{i}</annotation><annotation encoding="application/x-llamapun" id="algx2.l21.m1.1d">italic_K start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ← italic_l ⋅ italic_W start_POSTSUBSCRIPT italic_K start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algx2.l22">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algx2.l22.1.1.1" style="font-size:80%;">22:</span></span>     <math alttext="V_{l}^{i}\leftarrow l\cdot W_{V_{l}}^{i}" class="ltx_Math" display="inline" id="algx2.l22.m1.1"><semantics id="algx2.l22.m1.1a"><mrow id="algx2.l22.m1.1.1" xref="algx2.l22.m1.1.1.cmml"><msubsup id="algx2.l22.m1.1.1.2" xref="algx2.l22.m1.1.1.2.cmml"><mi id="algx2.l22.m1.1.1.2.2.2" xref="algx2.l22.m1.1.1.2.2.2.cmml">V</mi><mi id="algx2.l22.m1.1.1.2.2.3" xref="algx2.l22.m1.1.1.2.2.3.cmml">l</mi><mi id="algx2.l22.m1.1.1.2.3" xref="algx2.l22.m1.1.1.2.3.cmml">i</mi></msubsup><mo id="algx2.l22.m1.1.1.1" stretchy="false" xref="algx2.l22.m1.1.1.1.cmml">←</mo><mrow id="algx2.l22.m1.1.1.3" xref="algx2.l22.m1.1.1.3.cmml"><mi id="algx2.l22.m1.1.1.3.2" xref="algx2.l22.m1.1.1.3.2.cmml">l</mi><mo id="algx2.l22.m1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="algx2.l22.m1.1.1.3.1.cmml">⋅</mo><msubsup id="algx2.l22.m1.1.1.3.3" xref="algx2.l22.m1.1.1.3.3.cmml"><mi id="algx2.l22.m1.1.1.3.3.2.2" xref="algx2.l22.m1.1.1.3.3.2.2.cmml">W</mi><msub id="algx2.l22.m1.1.1.3.3.2.3" xref="algx2.l22.m1.1.1.3.3.2.3.cmml"><mi id="algx2.l22.m1.1.1.3.3.2.3.2" xref="algx2.l22.m1.1.1.3.3.2.3.2.cmml">V</mi><mi id="algx2.l22.m1.1.1.3.3.2.3.3" xref="algx2.l22.m1.1.1.3.3.2.3.3.cmml">l</mi></msub><mi id="algx2.l22.m1.1.1.3.3.3" xref="algx2.l22.m1.1.1.3.3.3.cmml">i</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx2.l22.m1.1b"><apply id="algx2.l22.m1.1.1.cmml" xref="algx2.l22.m1.1.1"><ci id="algx2.l22.m1.1.1.1.cmml" xref="algx2.l22.m1.1.1.1">←</ci><apply id="algx2.l22.m1.1.1.2.cmml" xref="algx2.l22.m1.1.1.2"><csymbol cd="ambiguous" id="algx2.l22.m1.1.1.2.1.cmml" xref="algx2.l22.m1.1.1.2">superscript</csymbol><apply id="algx2.l22.m1.1.1.2.2.cmml" xref="algx2.l22.m1.1.1.2"><csymbol cd="ambiguous" id="algx2.l22.m1.1.1.2.2.1.cmml" xref="algx2.l22.m1.1.1.2">subscript</csymbol><ci id="algx2.l22.m1.1.1.2.2.2.cmml" xref="algx2.l22.m1.1.1.2.2.2">𝑉</ci><ci id="algx2.l22.m1.1.1.2.2.3.cmml" xref="algx2.l22.m1.1.1.2.2.3">𝑙</ci></apply><ci id="algx2.l22.m1.1.1.2.3.cmml" xref="algx2.l22.m1.1.1.2.3">𝑖</ci></apply><apply id="algx2.l22.m1.1.1.3.cmml" xref="algx2.l22.m1.1.1.3"><ci id="algx2.l22.m1.1.1.3.1.cmml" xref="algx2.l22.m1.1.1.3.1">⋅</ci><ci id="algx2.l22.m1.1.1.3.2.cmml" xref="algx2.l22.m1.1.1.3.2">𝑙</ci><apply id="algx2.l22.m1.1.1.3.3.cmml" xref="algx2.l22.m1.1.1.3.3"><csymbol cd="ambiguous" id="algx2.l22.m1.1.1.3.3.1.cmml" xref="algx2.l22.m1.1.1.3.3">superscript</csymbol><apply id="algx2.l22.m1.1.1.3.3.2.cmml" xref="algx2.l22.m1.1.1.3.3"><csymbol cd="ambiguous" id="algx2.l22.m1.1.1.3.3.2.1.cmml" xref="algx2.l22.m1.1.1.3.3">subscript</csymbol><ci id="algx2.l22.m1.1.1.3.3.2.2.cmml" xref="algx2.l22.m1.1.1.3.3.2.2">𝑊</ci><apply id="algx2.l22.m1.1.1.3.3.2.3.cmml" xref="algx2.l22.m1.1.1.3.3.2.3"><csymbol cd="ambiguous" id="algx2.l22.m1.1.1.3.3.2.3.1.cmml" xref="algx2.l22.m1.1.1.3.3.2.3">subscript</csymbol><ci id="algx2.l22.m1.1.1.3.3.2.3.2.cmml" xref="algx2.l22.m1.1.1.3.3.2.3.2">𝑉</ci><ci id="algx2.l22.m1.1.1.3.3.2.3.3.cmml" xref="algx2.l22.m1.1.1.3.3.2.3.3">𝑙</ci></apply></apply><ci id="algx2.l22.m1.1.1.3.3.3.cmml" xref="algx2.l22.m1.1.1.3.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx2.l22.m1.1c">V_{l}^{i}\leftarrow l\cdot W_{V_{l}}^{i}</annotation><annotation encoding="application/x-llamapun" id="algx2.l22.m1.1d">italic_V start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ← italic_l ⋅ italic_W start_POSTSUBSCRIPT italic_V start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algx2.l23">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algx2.l23.1.1.1" style="font-size:80%;">23:</span></span>     <math alttext="AttentionWeights^{i}\leftarrow\text{Softmax}\left(\frac{Q_{\text{cross}}^{i}%
\cdot(K_{l}^{i})^{\top}}{\sqrt{d_{k}}}\right)" class="ltx_Math" display="inline" id="algx2.l23.m1.1"><semantics id="algx2.l23.m1.1a"><mrow id="algx2.l23.m1.1.2" xref="algx2.l23.m1.1.2.cmml"><mrow id="algx2.l23.m1.1.2.2" xref="algx2.l23.m1.1.2.2.cmml"><mi id="algx2.l23.m1.1.2.2.2" xref="algx2.l23.m1.1.2.2.2.cmml">A</mi><mo id="algx2.l23.m1.1.2.2.1" xref="algx2.l23.m1.1.2.2.1.cmml">⁢</mo><mi id="algx2.l23.m1.1.2.2.3" xref="algx2.l23.m1.1.2.2.3.cmml">t</mi><mo id="algx2.l23.m1.1.2.2.1a" xref="algx2.l23.m1.1.2.2.1.cmml">⁢</mo><mi id="algx2.l23.m1.1.2.2.4" xref="algx2.l23.m1.1.2.2.4.cmml">t</mi><mo id="algx2.l23.m1.1.2.2.1b" xref="algx2.l23.m1.1.2.2.1.cmml">⁢</mo><mi id="algx2.l23.m1.1.2.2.5" xref="algx2.l23.m1.1.2.2.5.cmml">e</mi><mo id="algx2.l23.m1.1.2.2.1c" xref="algx2.l23.m1.1.2.2.1.cmml">⁢</mo><mi id="algx2.l23.m1.1.2.2.6" xref="algx2.l23.m1.1.2.2.6.cmml">n</mi><mo id="algx2.l23.m1.1.2.2.1d" xref="algx2.l23.m1.1.2.2.1.cmml">⁢</mo><mi id="algx2.l23.m1.1.2.2.7" xref="algx2.l23.m1.1.2.2.7.cmml">t</mi><mo id="algx2.l23.m1.1.2.2.1e" xref="algx2.l23.m1.1.2.2.1.cmml">⁢</mo><mi id="algx2.l23.m1.1.2.2.8" xref="algx2.l23.m1.1.2.2.8.cmml">i</mi><mo id="algx2.l23.m1.1.2.2.1f" xref="algx2.l23.m1.1.2.2.1.cmml">⁢</mo><mi id="algx2.l23.m1.1.2.2.9" xref="algx2.l23.m1.1.2.2.9.cmml">o</mi><mo id="algx2.l23.m1.1.2.2.1g" xref="algx2.l23.m1.1.2.2.1.cmml">⁢</mo><mi id="algx2.l23.m1.1.2.2.10" xref="algx2.l23.m1.1.2.2.10.cmml">n</mi><mo id="algx2.l23.m1.1.2.2.1h" xref="algx2.l23.m1.1.2.2.1.cmml">⁢</mo><mi id="algx2.l23.m1.1.2.2.11" xref="algx2.l23.m1.1.2.2.11.cmml">W</mi><mo id="algx2.l23.m1.1.2.2.1i" xref="algx2.l23.m1.1.2.2.1.cmml">⁢</mo><mi id="algx2.l23.m1.1.2.2.12" xref="algx2.l23.m1.1.2.2.12.cmml">e</mi><mo id="algx2.l23.m1.1.2.2.1j" xref="algx2.l23.m1.1.2.2.1.cmml">⁢</mo><mi id="algx2.l23.m1.1.2.2.13" xref="algx2.l23.m1.1.2.2.13.cmml">i</mi><mo id="algx2.l23.m1.1.2.2.1k" xref="algx2.l23.m1.1.2.2.1.cmml">⁢</mo><mi id="algx2.l23.m1.1.2.2.14" xref="algx2.l23.m1.1.2.2.14.cmml">g</mi><mo id="algx2.l23.m1.1.2.2.1l" xref="algx2.l23.m1.1.2.2.1.cmml">⁢</mo><mi id="algx2.l23.m1.1.2.2.15" xref="algx2.l23.m1.1.2.2.15.cmml">h</mi><mo id="algx2.l23.m1.1.2.2.1m" xref="algx2.l23.m1.1.2.2.1.cmml">⁢</mo><mi id="algx2.l23.m1.1.2.2.16" xref="algx2.l23.m1.1.2.2.16.cmml">t</mi><mo id="algx2.l23.m1.1.2.2.1n" xref="algx2.l23.m1.1.2.2.1.cmml">⁢</mo><msup id="algx2.l23.m1.1.2.2.17" xref="algx2.l23.m1.1.2.2.17.cmml"><mi id="algx2.l23.m1.1.2.2.17.2" xref="algx2.l23.m1.1.2.2.17.2.cmml">s</mi><mi id="algx2.l23.m1.1.2.2.17.3" xref="algx2.l23.m1.1.2.2.17.3.cmml">i</mi></msup></mrow><mo id="algx2.l23.m1.1.2.1" stretchy="false" xref="algx2.l23.m1.1.2.1.cmml">←</mo><mrow id="algx2.l23.m1.1.2.3" xref="algx2.l23.m1.1.2.3.cmml"><mtext id="algx2.l23.m1.1.2.3.2" xref="algx2.l23.m1.1.2.3.2a.cmml">Softmax</mtext><mo id="algx2.l23.m1.1.2.3.1" xref="algx2.l23.m1.1.2.3.1.cmml">⁢</mo><mrow id="algx2.l23.m1.1.2.3.3.2" xref="algx2.l23.m1.1.1.cmml"><mo id="algx2.l23.m1.1.2.3.3.2.1" xref="algx2.l23.m1.1.1.cmml">(</mo><mfrac id="algx2.l23.m1.1.1" xref="algx2.l23.m1.1.1.cmml"><mrow id="algx2.l23.m1.1.1.1" xref="algx2.l23.m1.1.1.1.cmml"><msubsup id="algx2.l23.m1.1.1.1.3" xref="algx2.l23.m1.1.1.1.3.cmml"><mi id="algx2.l23.m1.1.1.1.3.2.2" xref="algx2.l23.m1.1.1.1.3.2.2.cmml">Q</mi><mtext id="algx2.l23.m1.1.1.1.3.2.3" xref="algx2.l23.m1.1.1.1.3.2.3a.cmml">cross</mtext><mi id="algx2.l23.m1.1.1.1.3.3" xref="algx2.l23.m1.1.1.1.3.3.cmml">i</mi></msubsup><mo id="algx2.l23.m1.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="algx2.l23.m1.1.1.1.2.cmml">⋅</mo><msup id="algx2.l23.m1.1.1.1.1" xref="algx2.l23.m1.1.1.1.1.cmml"><mrow id="algx2.l23.m1.1.1.1.1.1.1" xref="algx2.l23.m1.1.1.1.1.1.1.1.cmml"><mo id="algx2.l23.m1.1.1.1.1.1.1.2" stretchy="false" xref="algx2.l23.m1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="algx2.l23.m1.1.1.1.1.1.1.1" xref="algx2.l23.m1.1.1.1.1.1.1.1.cmml"><mi id="algx2.l23.m1.1.1.1.1.1.1.1.2.2" xref="algx2.l23.m1.1.1.1.1.1.1.1.2.2.cmml">K</mi><mi id="algx2.l23.m1.1.1.1.1.1.1.1.2.3" xref="algx2.l23.m1.1.1.1.1.1.1.1.2.3.cmml">l</mi><mi id="algx2.l23.m1.1.1.1.1.1.1.1.3" xref="algx2.l23.m1.1.1.1.1.1.1.1.3.cmml">i</mi></msubsup><mo id="algx2.l23.m1.1.1.1.1.1.1.3" stretchy="false" xref="algx2.l23.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="algx2.l23.m1.1.1.1.1.3" xref="algx2.l23.m1.1.1.1.1.3.cmml">⊤</mo></msup></mrow><msqrt id="algx2.l23.m1.1.1.3" xref="algx2.l23.m1.1.1.3.cmml"><msub id="algx2.l23.m1.1.1.3.2" xref="algx2.l23.m1.1.1.3.2.cmml"><mi id="algx2.l23.m1.1.1.3.2.2" xref="algx2.l23.m1.1.1.3.2.2.cmml">d</mi><mi id="algx2.l23.m1.1.1.3.2.3" xref="algx2.l23.m1.1.1.3.2.3.cmml">k</mi></msub></msqrt></mfrac><mo id="algx2.l23.m1.1.2.3.3.2.2" xref="algx2.l23.m1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx2.l23.m1.1b"><apply id="algx2.l23.m1.1.2.cmml" xref="algx2.l23.m1.1.2"><ci id="algx2.l23.m1.1.2.1.cmml" xref="algx2.l23.m1.1.2.1">←</ci><apply id="algx2.l23.m1.1.2.2.cmml" xref="algx2.l23.m1.1.2.2"><times id="algx2.l23.m1.1.2.2.1.cmml" xref="algx2.l23.m1.1.2.2.1"></times><ci id="algx2.l23.m1.1.2.2.2.cmml" xref="algx2.l23.m1.1.2.2.2">𝐴</ci><ci id="algx2.l23.m1.1.2.2.3.cmml" xref="algx2.l23.m1.1.2.2.3">𝑡</ci><ci id="algx2.l23.m1.1.2.2.4.cmml" xref="algx2.l23.m1.1.2.2.4">𝑡</ci><ci id="algx2.l23.m1.1.2.2.5.cmml" xref="algx2.l23.m1.1.2.2.5">𝑒</ci><ci id="algx2.l23.m1.1.2.2.6.cmml" xref="algx2.l23.m1.1.2.2.6">𝑛</ci><ci id="algx2.l23.m1.1.2.2.7.cmml" xref="algx2.l23.m1.1.2.2.7">𝑡</ci><ci id="algx2.l23.m1.1.2.2.8.cmml" xref="algx2.l23.m1.1.2.2.8">𝑖</ci><ci id="algx2.l23.m1.1.2.2.9.cmml" xref="algx2.l23.m1.1.2.2.9">𝑜</ci><ci id="algx2.l23.m1.1.2.2.10.cmml" xref="algx2.l23.m1.1.2.2.10">𝑛</ci><ci id="algx2.l23.m1.1.2.2.11.cmml" xref="algx2.l23.m1.1.2.2.11">𝑊</ci><ci id="algx2.l23.m1.1.2.2.12.cmml" xref="algx2.l23.m1.1.2.2.12">𝑒</ci><ci id="algx2.l23.m1.1.2.2.13.cmml" xref="algx2.l23.m1.1.2.2.13">𝑖</ci><ci id="algx2.l23.m1.1.2.2.14.cmml" xref="algx2.l23.m1.1.2.2.14">𝑔</ci><ci id="algx2.l23.m1.1.2.2.15.cmml" xref="algx2.l23.m1.1.2.2.15">ℎ</ci><ci id="algx2.l23.m1.1.2.2.16.cmml" xref="algx2.l23.m1.1.2.2.16">𝑡</ci><apply id="algx2.l23.m1.1.2.2.17.cmml" xref="algx2.l23.m1.1.2.2.17"><csymbol cd="ambiguous" id="algx2.l23.m1.1.2.2.17.1.cmml" xref="algx2.l23.m1.1.2.2.17">superscript</csymbol><ci id="algx2.l23.m1.1.2.2.17.2.cmml" xref="algx2.l23.m1.1.2.2.17.2">𝑠</ci><ci id="algx2.l23.m1.1.2.2.17.3.cmml" xref="algx2.l23.m1.1.2.2.17.3">𝑖</ci></apply></apply><apply id="algx2.l23.m1.1.2.3.cmml" xref="algx2.l23.m1.1.2.3"><times id="algx2.l23.m1.1.2.3.1.cmml" xref="algx2.l23.m1.1.2.3.1"></times><ci id="algx2.l23.m1.1.2.3.2a.cmml" xref="algx2.l23.m1.1.2.3.2"><mtext id="algx2.l23.m1.1.2.3.2.cmml" xref="algx2.l23.m1.1.2.3.2">Softmax</mtext></ci><apply id="algx2.l23.m1.1.1.cmml" xref="algx2.l23.m1.1.2.3.3.2"><divide id="algx2.l23.m1.1.1.2.cmml" xref="algx2.l23.m1.1.2.3.3.2"></divide><apply id="algx2.l23.m1.1.1.1.cmml" xref="algx2.l23.m1.1.1.1"><ci id="algx2.l23.m1.1.1.1.2.cmml" xref="algx2.l23.m1.1.1.1.2">⋅</ci><apply id="algx2.l23.m1.1.1.1.3.cmml" xref="algx2.l23.m1.1.1.1.3"><csymbol cd="ambiguous" id="algx2.l23.m1.1.1.1.3.1.cmml" xref="algx2.l23.m1.1.1.1.3">superscript</csymbol><apply id="algx2.l23.m1.1.1.1.3.2.cmml" xref="algx2.l23.m1.1.1.1.3"><csymbol cd="ambiguous" id="algx2.l23.m1.1.1.1.3.2.1.cmml" xref="algx2.l23.m1.1.1.1.3">subscript</csymbol><ci id="algx2.l23.m1.1.1.1.3.2.2.cmml" xref="algx2.l23.m1.1.1.1.3.2.2">𝑄</ci><ci id="algx2.l23.m1.1.1.1.3.2.3a.cmml" xref="algx2.l23.m1.1.1.1.3.2.3"><mtext id="algx2.l23.m1.1.1.1.3.2.3.cmml" mathsize="50%" xref="algx2.l23.m1.1.1.1.3.2.3">cross</mtext></ci></apply><ci id="algx2.l23.m1.1.1.1.3.3.cmml" xref="algx2.l23.m1.1.1.1.3.3">𝑖</ci></apply><apply id="algx2.l23.m1.1.1.1.1.cmml" xref="algx2.l23.m1.1.1.1.1"><csymbol cd="ambiguous" id="algx2.l23.m1.1.1.1.1.2.cmml" xref="algx2.l23.m1.1.1.1.1">superscript</csymbol><apply id="algx2.l23.m1.1.1.1.1.1.1.1.cmml" xref="algx2.l23.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algx2.l23.m1.1.1.1.1.1.1.1.1.cmml" xref="algx2.l23.m1.1.1.1.1.1.1">superscript</csymbol><apply id="algx2.l23.m1.1.1.1.1.1.1.1.2.cmml" xref="algx2.l23.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algx2.l23.m1.1.1.1.1.1.1.1.2.1.cmml" xref="algx2.l23.m1.1.1.1.1.1.1">subscript</csymbol><ci id="algx2.l23.m1.1.1.1.1.1.1.1.2.2.cmml" xref="algx2.l23.m1.1.1.1.1.1.1.1.2.2">𝐾</ci><ci id="algx2.l23.m1.1.1.1.1.1.1.1.2.3.cmml" xref="algx2.l23.m1.1.1.1.1.1.1.1.2.3">𝑙</ci></apply><ci id="algx2.l23.m1.1.1.1.1.1.1.1.3.cmml" xref="algx2.l23.m1.1.1.1.1.1.1.1.3">𝑖</ci></apply><csymbol cd="latexml" id="algx2.l23.m1.1.1.1.1.3.cmml" xref="algx2.l23.m1.1.1.1.1.3">top</csymbol></apply></apply><apply id="algx2.l23.m1.1.1.3.cmml" xref="algx2.l23.m1.1.1.3"><root id="algx2.l23.m1.1.1.3a.cmml" xref="algx2.l23.m1.1.1.3"></root><apply id="algx2.l23.m1.1.1.3.2.cmml" xref="algx2.l23.m1.1.1.3.2"><csymbol cd="ambiguous" id="algx2.l23.m1.1.1.3.2.1.cmml" xref="algx2.l23.m1.1.1.3.2">subscript</csymbol><ci id="algx2.l23.m1.1.1.3.2.2.cmml" xref="algx2.l23.m1.1.1.3.2.2">𝑑</ci><ci id="algx2.l23.m1.1.1.3.2.3.cmml" xref="algx2.l23.m1.1.1.3.2.3">𝑘</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx2.l23.m1.1c">AttentionWeights^{i}\leftarrow\text{Softmax}\left(\frac{Q_{\text{cross}}^{i}%
\cdot(K_{l}^{i})^{\top}}{\sqrt{d_{k}}}\right)</annotation><annotation encoding="application/x-llamapun" id="algx2.l23.m1.1d">italic_A italic_t italic_t italic_e italic_n italic_t italic_i italic_o italic_n italic_W italic_e italic_i italic_g italic_h italic_t italic_s start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ← Softmax ( divide start_ARG italic_Q start_POSTSUBSCRIPT cross end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ⋅ ( italic_K start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT end_ARG start_ARG square-root start_ARG italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_ARG end_ARG )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algx2.l24">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algx2.l24.1.1.1" style="font-size:80%;">24:</span></span>     <math alttext="CrossModalAttention^{i}\leftarrow AttentionWeights^{i}\cdot V_{l}^{i}" class="ltx_Math" display="inline" id="algx2.l24.m1.1"><semantics id="algx2.l24.m1.1a"><mrow id="algx2.l24.m1.1.1" xref="algx2.l24.m1.1.1.cmml"><mrow id="algx2.l24.m1.1.1.2" xref="algx2.l24.m1.1.1.2.cmml"><mi id="algx2.l24.m1.1.1.2.2" xref="algx2.l24.m1.1.1.2.2.cmml">C</mi><mo id="algx2.l24.m1.1.1.2.1" xref="algx2.l24.m1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l24.m1.1.1.2.3" xref="algx2.l24.m1.1.1.2.3.cmml">r</mi><mo id="algx2.l24.m1.1.1.2.1a" xref="algx2.l24.m1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l24.m1.1.1.2.4" xref="algx2.l24.m1.1.1.2.4.cmml">o</mi><mo id="algx2.l24.m1.1.1.2.1b" xref="algx2.l24.m1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l24.m1.1.1.2.5" xref="algx2.l24.m1.1.1.2.5.cmml">s</mi><mo id="algx2.l24.m1.1.1.2.1c" xref="algx2.l24.m1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l24.m1.1.1.2.6" xref="algx2.l24.m1.1.1.2.6.cmml">s</mi><mo id="algx2.l24.m1.1.1.2.1d" xref="algx2.l24.m1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l24.m1.1.1.2.7" xref="algx2.l24.m1.1.1.2.7.cmml">M</mi><mo id="algx2.l24.m1.1.1.2.1e" xref="algx2.l24.m1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l24.m1.1.1.2.8" xref="algx2.l24.m1.1.1.2.8.cmml">o</mi><mo id="algx2.l24.m1.1.1.2.1f" xref="algx2.l24.m1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l24.m1.1.1.2.9" xref="algx2.l24.m1.1.1.2.9.cmml">d</mi><mo id="algx2.l24.m1.1.1.2.1g" xref="algx2.l24.m1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l24.m1.1.1.2.10" xref="algx2.l24.m1.1.1.2.10.cmml">a</mi><mo id="algx2.l24.m1.1.1.2.1h" xref="algx2.l24.m1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l24.m1.1.1.2.11" xref="algx2.l24.m1.1.1.2.11.cmml">l</mi><mo id="algx2.l24.m1.1.1.2.1i" xref="algx2.l24.m1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l24.m1.1.1.2.12" xref="algx2.l24.m1.1.1.2.12.cmml">A</mi><mo id="algx2.l24.m1.1.1.2.1j" xref="algx2.l24.m1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l24.m1.1.1.2.13" xref="algx2.l24.m1.1.1.2.13.cmml">t</mi><mo id="algx2.l24.m1.1.1.2.1k" xref="algx2.l24.m1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l24.m1.1.1.2.14" xref="algx2.l24.m1.1.1.2.14.cmml">t</mi><mo id="algx2.l24.m1.1.1.2.1l" xref="algx2.l24.m1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l24.m1.1.1.2.15" xref="algx2.l24.m1.1.1.2.15.cmml">e</mi><mo id="algx2.l24.m1.1.1.2.1m" xref="algx2.l24.m1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l24.m1.1.1.2.16" xref="algx2.l24.m1.1.1.2.16.cmml">n</mi><mo id="algx2.l24.m1.1.1.2.1n" xref="algx2.l24.m1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l24.m1.1.1.2.17" xref="algx2.l24.m1.1.1.2.17.cmml">t</mi><mo id="algx2.l24.m1.1.1.2.1o" xref="algx2.l24.m1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l24.m1.1.1.2.18" xref="algx2.l24.m1.1.1.2.18.cmml">i</mi><mo id="algx2.l24.m1.1.1.2.1p" xref="algx2.l24.m1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l24.m1.1.1.2.19" xref="algx2.l24.m1.1.1.2.19.cmml">o</mi><mo id="algx2.l24.m1.1.1.2.1q" xref="algx2.l24.m1.1.1.2.1.cmml">⁢</mo><msup id="algx2.l24.m1.1.1.2.20" xref="algx2.l24.m1.1.1.2.20.cmml"><mi id="algx2.l24.m1.1.1.2.20.2" xref="algx2.l24.m1.1.1.2.20.2.cmml">n</mi><mi id="algx2.l24.m1.1.1.2.20.3" xref="algx2.l24.m1.1.1.2.20.3.cmml">i</mi></msup></mrow><mo id="algx2.l24.m1.1.1.1" stretchy="false" xref="algx2.l24.m1.1.1.1.cmml">←</mo><mrow id="algx2.l24.m1.1.1.3" xref="algx2.l24.m1.1.1.3.cmml"><mrow id="algx2.l24.m1.1.1.3.2" xref="algx2.l24.m1.1.1.3.2.cmml"><mi id="algx2.l24.m1.1.1.3.2.2" xref="algx2.l24.m1.1.1.3.2.2.cmml">A</mi><mo id="algx2.l24.m1.1.1.3.2.1" xref="algx2.l24.m1.1.1.3.2.1.cmml">⁢</mo><mi id="algx2.l24.m1.1.1.3.2.3" xref="algx2.l24.m1.1.1.3.2.3.cmml">t</mi><mo id="algx2.l24.m1.1.1.3.2.1a" xref="algx2.l24.m1.1.1.3.2.1.cmml">⁢</mo><mi id="algx2.l24.m1.1.1.3.2.4" xref="algx2.l24.m1.1.1.3.2.4.cmml">t</mi><mo id="algx2.l24.m1.1.1.3.2.1b" xref="algx2.l24.m1.1.1.3.2.1.cmml">⁢</mo><mi id="algx2.l24.m1.1.1.3.2.5" xref="algx2.l24.m1.1.1.3.2.5.cmml">e</mi><mo id="algx2.l24.m1.1.1.3.2.1c" xref="algx2.l24.m1.1.1.3.2.1.cmml">⁢</mo><mi id="algx2.l24.m1.1.1.3.2.6" xref="algx2.l24.m1.1.1.3.2.6.cmml">n</mi><mo id="algx2.l24.m1.1.1.3.2.1d" xref="algx2.l24.m1.1.1.3.2.1.cmml">⁢</mo><mi id="algx2.l24.m1.1.1.3.2.7" xref="algx2.l24.m1.1.1.3.2.7.cmml">t</mi><mo id="algx2.l24.m1.1.1.3.2.1e" xref="algx2.l24.m1.1.1.3.2.1.cmml">⁢</mo><mi id="algx2.l24.m1.1.1.3.2.8" xref="algx2.l24.m1.1.1.3.2.8.cmml">i</mi><mo id="algx2.l24.m1.1.1.3.2.1f" xref="algx2.l24.m1.1.1.3.2.1.cmml">⁢</mo><mi id="algx2.l24.m1.1.1.3.2.9" xref="algx2.l24.m1.1.1.3.2.9.cmml">o</mi><mo id="algx2.l24.m1.1.1.3.2.1g" xref="algx2.l24.m1.1.1.3.2.1.cmml">⁢</mo><mi id="algx2.l24.m1.1.1.3.2.10" xref="algx2.l24.m1.1.1.3.2.10.cmml">n</mi><mo id="algx2.l24.m1.1.1.3.2.1h" xref="algx2.l24.m1.1.1.3.2.1.cmml">⁢</mo><mi id="algx2.l24.m1.1.1.3.2.11" xref="algx2.l24.m1.1.1.3.2.11.cmml">W</mi><mo id="algx2.l24.m1.1.1.3.2.1i" xref="algx2.l24.m1.1.1.3.2.1.cmml">⁢</mo><mi id="algx2.l24.m1.1.1.3.2.12" xref="algx2.l24.m1.1.1.3.2.12.cmml">e</mi><mo id="algx2.l24.m1.1.1.3.2.1j" xref="algx2.l24.m1.1.1.3.2.1.cmml">⁢</mo><mi id="algx2.l24.m1.1.1.3.2.13" xref="algx2.l24.m1.1.1.3.2.13.cmml">i</mi><mo id="algx2.l24.m1.1.1.3.2.1k" xref="algx2.l24.m1.1.1.3.2.1.cmml">⁢</mo><mi id="algx2.l24.m1.1.1.3.2.14" xref="algx2.l24.m1.1.1.3.2.14.cmml">g</mi><mo id="algx2.l24.m1.1.1.3.2.1l" xref="algx2.l24.m1.1.1.3.2.1.cmml">⁢</mo><mi id="algx2.l24.m1.1.1.3.2.15" xref="algx2.l24.m1.1.1.3.2.15.cmml">h</mi><mo id="algx2.l24.m1.1.1.3.2.1m" xref="algx2.l24.m1.1.1.3.2.1.cmml">⁢</mo><mi id="algx2.l24.m1.1.1.3.2.16" xref="algx2.l24.m1.1.1.3.2.16.cmml">t</mi><mo id="algx2.l24.m1.1.1.3.2.1n" xref="algx2.l24.m1.1.1.3.2.1.cmml">⁢</mo><msup id="algx2.l24.m1.1.1.3.2.17" xref="algx2.l24.m1.1.1.3.2.17.cmml"><mi id="algx2.l24.m1.1.1.3.2.17.2" xref="algx2.l24.m1.1.1.3.2.17.2.cmml">s</mi><mi id="algx2.l24.m1.1.1.3.2.17.3" xref="algx2.l24.m1.1.1.3.2.17.3.cmml">i</mi></msup></mrow><mo id="algx2.l24.m1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="algx2.l24.m1.1.1.3.1.cmml">⋅</mo><msubsup id="algx2.l24.m1.1.1.3.3" xref="algx2.l24.m1.1.1.3.3.cmml"><mi id="algx2.l24.m1.1.1.3.3.2.2" xref="algx2.l24.m1.1.1.3.3.2.2.cmml">V</mi><mi id="algx2.l24.m1.1.1.3.3.2.3" xref="algx2.l24.m1.1.1.3.3.2.3.cmml">l</mi><mi id="algx2.l24.m1.1.1.3.3.3" xref="algx2.l24.m1.1.1.3.3.3.cmml">i</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx2.l24.m1.1b"><apply id="algx2.l24.m1.1.1.cmml" xref="algx2.l24.m1.1.1"><ci id="algx2.l24.m1.1.1.1.cmml" xref="algx2.l24.m1.1.1.1">←</ci><apply id="algx2.l24.m1.1.1.2.cmml" xref="algx2.l24.m1.1.1.2"><times id="algx2.l24.m1.1.1.2.1.cmml" xref="algx2.l24.m1.1.1.2.1"></times><ci id="algx2.l24.m1.1.1.2.2.cmml" xref="algx2.l24.m1.1.1.2.2">𝐶</ci><ci id="algx2.l24.m1.1.1.2.3.cmml" xref="algx2.l24.m1.1.1.2.3">𝑟</ci><ci id="algx2.l24.m1.1.1.2.4.cmml" xref="algx2.l24.m1.1.1.2.4">𝑜</ci><ci id="algx2.l24.m1.1.1.2.5.cmml" xref="algx2.l24.m1.1.1.2.5">𝑠</ci><ci id="algx2.l24.m1.1.1.2.6.cmml" xref="algx2.l24.m1.1.1.2.6">𝑠</ci><ci id="algx2.l24.m1.1.1.2.7.cmml" xref="algx2.l24.m1.1.1.2.7">𝑀</ci><ci id="algx2.l24.m1.1.1.2.8.cmml" xref="algx2.l24.m1.1.1.2.8">𝑜</ci><ci id="algx2.l24.m1.1.1.2.9.cmml" xref="algx2.l24.m1.1.1.2.9">𝑑</ci><ci id="algx2.l24.m1.1.1.2.10.cmml" xref="algx2.l24.m1.1.1.2.10">𝑎</ci><ci id="algx2.l24.m1.1.1.2.11.cmml" xref="algx2.l24.m1.1.1.2.11">𝑙</ci><ci id="algx2.l24.m1.1.1.2.12.cmml" xref="algx2.l24.m1.1.1.2.12">𝐴</ci><ci id="algx2.l24.m1.1.1.2.13.cmml" xref="algx2.l24.m1.1.1.2.13">𝑡</ci><ci id="algx2.l24.m1.1.1.2.14.cmml" xref="algx2.l24.m1.1.1.2.14">𝑡</ci><ci id="algx2.l24.m1.1.1.2.15.cmml" xref="algx2.l24.m1.1.1.2.15">𝑒</ci><ci id="algx2.l24.m1.1.1.2.16.cmml" xref="algx2.l24.m1.1.1.2.16">𝑛</ci><ci id="algx2.l24.m1.1.1.2.17.cmml" xref="algx2.l24.m1.1.1.2.17">𝑡</ci><ci id="algx2.l24.m1.1.1.2.18.cmml" xref="algx2.l24.m1.1.1.2.18">𝑖</ci><ci id="algx2.l24.m1.1.1.2.19.cmml" xref="algx2.l24.m1.1.1.2.19">𝑜</ci><apply id="algx2.l24.m1.1.1.2.20.cmml" xref="algx2.l24.m1.1.1.2.20"><csymbol cd="ambiguous" id="algx2.l24.m1.1.1.2.20.1.cmml" xref="algx2.l24.m1.1.1.2.20">superscript</csymbol><ci id="algx2.l24.m1.1.1.2.20.2.cmml" xref="algx2.l24.m1.1.1.2.20.2">𝑛</ci><ci id="algx2.l24.m1.1.1.2.20.3.cmml" xref="algx2.l24.m1.1.1.2.20.3">𝑖</ci></apply></apply><apply id="algx2.l24.m1.1.1.3.cmml" xref="algx2.l24.m1.1.1.3"><ci id="algx2.l24.m1.1.1.3.1.cmml" xref="algx2.l24.m1.1.1.3.1">⋅</ci><apply id="algx2.l24.m1.1.1.3.2.cmml" xref="algx2.l24.m1.1.1.3.2"><times id="algx2.l24.m1.1.1.3.2.1.cmml" xref="algx2.l24.m1.1.1.3.2.1"></times><ci id="algx2.l24.m1.1.1.3.2.2.cmml" xref="algx2.l24.m1.1.1.3.2.2">𝐴</ci><ci id="algx2.l24.m1.1.1.3.2.3.cmml" xref="algx2.l24.m1.1.1.3.2.3">𝑡</ci><ci id="algx2.l24.m1.1.1.3.2.4.cmml" xref="algx2.l24.m1.1.1.3.2.4">𝑡</ci><ci id="algx2.l24.m1.1.1.3.2.5.cmml" xref="algx2.l24.m1.1.1.3.2.5">𝑒</ci><ci id="algx2.l24.m1.1.1.3.2.6.cmml" xref="algx2.l24.m1.1.1.3.2.6">𝑛</ci><ci id="algx2.l24.m1.1.1.3.2.7.cmml" xref="algx2.l24.m1.1.1.3.2.7">𝑡</ci><ci id="algx2.l24.m1.1.1.3.2.8.cmml" xref="algx2.l24.m1.1.1.3.2.8">𝑖</ci><ci id="algx2.l24.m1.1.1.3.2.9.cmml" xref="algx2.l24.m1.1.1.3.2.9">𝑜</ci><ci id="algx2.l24.m1.1.1.3.2.10.cmml" xref="algx2.l24.m1.1.1.3.2.10">𝑛</ci><ci id="algx2.l24.m1.1.1.3.2.11.cmml" xref="algx2.l24.m1.1.1.3.2.11">𝑊</ci><ci id="algx2.l24.m1.1.1.3.2.12.cmml" xref="algx2.l24.m1.1.1.3.2.12">𝑒</ci><ci id="algx2.l24.m1.1.1.3.2.13.cmml" xref="algx2.l24.m1.1.1.3.2.13">𝑖</ci><ci id="algx2.l24.m1.1.1.3.2.14.cmml" xref="algx2.l24.m1.1.1.3.2.14">𝑔</ci><ci id="algx2.l24.m1.1.1.3.2.15.cmml" xref="algx2.l24.m1.1.1.3.2.15">ℎ</ci><ci id="algx2.l24.m1.1.1.3.2.16.cmml" xref="algx2.l24.m1.1.1.3.2.16">𝑡</ci><apply id="algx2.l24.m1.1.1.3.2.17.cmml" xref="algx2.l24.m1.1.1.3.2.17"><csymbol cd="ambiguous" id="algx2.l24.m1.1.1.3.2.17.1.cmml" xref="algx2.l24.m1.1.1.3.2.17">superscript</csymbol><ci id="algx2.l24.m1.1.1.3.2.17.2.cmml" xref="algx2.l24.m1.1.1.3.2.17.2">𝑠</ci><ci id="algx2.l24.m1.1.1.3.2.17.3.cmml" xref="algx2.l24.m1.1.1.3.2.17.3">𝑖</ci></apply></apply><apply id="algx2.l24.m1.1.1.3.3.cmml" xref="algx2.l24.m1.1.1.3.3"><csymbol cd="ambiguous" id="algx2.l24.m1.1.1.3.3.1.cmml" xref="algx2.l24.m1.1.1.3.3">superscript</csymbol><apply id="algx2.l24.m1.1.1.3.3.2.cmml" xref="algx2.l24.m1.1.1.3.3"><csymbol cd="ambiguous" id="algx2.l24.m1.1.1.3.3.2.1.cmml" xref="algx2.l24.m1.1.1.3.3">subscript</csymbol><ci id="algx2.l24.m1.1.1.3.3.2.2.cmml" xref="algx2.l24.m1.1.1.3.3.2.2">𝑉</ci><ci id="algx2.l24.m1.1.1.3.3.2.3.cmml" xref="algx2.l24.m1.1.1.3.3.2.3">𝑙</ci></apply><ci id="algx2.l24.m1.1.1.3.3.3.cmml" xref="algx2.l24.m1.1.1.3.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx2.l24.m1.1c">CrossModalAttention^{i}\leftarrow AttentionWeights^{i}\cdot V_{l}^{i}</annotation><annotation encoding="application/x-llamapun" id="algx2.l24.m1.1d">italic_C italic_r italic_o italic_s italic_s italic_M italic_o italic_d italic_a italic_l italic_A italic_t italic_t italic_e italic_n italic_t italic_i italic_o italic_n start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ← italic_A italic_t italic_t italic_e italic_n italic_t italic_i italic_o italic_n italic_W italic_e italic_i italic_g italic_h italic_t italic_s start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ⋅ italic_V start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algx2.l25">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algx2.l25.1.1.1" style="font-size:80%;">25:</span></span>     <math alttext="CrossModalAttention^{i}\leftarrow\text{Dropout}(CrossModalAttention^{i},%
dropout\_rate)" class="ltx_Math" display="inline" id="algx2.l25.m1.2"><semantics id="algx2.l25.m1.2a"><mrow id="algx2.l25.m1.2.2" xref="algx2.l25.m1.2.2.cmml"><mrow id="algx2.l25.m1.2.2.4" xref="algx2.l25.m1.2.2.4.cmml"><mi id="algx2.l25.m1.2.2.4.2" xref="algx2.l25.m1.2.2.4.2.cmml">C</mi><mo id="algx2.l25.m1.2.2.4.1" xref="algx2.l25.m1.2.2.4.1.cmml">⁢</mo><mi id="algx2.l25.m1.2.2.4.3" xref="algx2.l25.m1.2.2.4.3.cmml">r</mi><mo id="algx2.l25.m1.2.2.4.1a" xref="algx2.l25.m1.2.2.4.1.cmml">⁢</mo><mi id="algx2.l25.m1.2.2.4.4" xref="algx2.l25.m1.2.2.4.4.cmml">o</mi><mo id="algx2.l25.m1.2.2.4.1b" xref="algx2.l25.m1.2.2.4.1.cmml">⁢</mo><mi id="algx2.l25.m1.2.2.4.5" xref="algx2.l25.m1.2.2.4.5.cmml">s</mi><mo id="algx2.l25.m1.2.2.4.1c" xref="algx2.l25.m1.2.2.4.1.cmml">⁢</mo><mi id="algx2.l25.m1.2.2.4.6" xref="algx2.l25.m1.2.2.4.6.cmml">s</mi><mo id="algx2.l25.m1.2.2.4.1d" xref="algx2.l25.m1.2.2.4.1.cmml">⁢</mo><mi id="algx2.l25.m1.2.2.4.7" xref="algx2.l25.m1.2.2.4.7.cmml">M</mi><mo id="algx2.l25.m1.2.2.4.1e" xref="algx2.l25.m1.2.2.4.1.cmml">⁢</mo><mi id="algx2.l25.m1.2.2.4.8" xref="algx2.l25.m1.2.2.4.8.cmml">o</mi><mo id="algx2.l25.m1.2.2.4.1f" xref="algx2.l25.m1.2.2.4.1.cmml">⁢</mo><mi id="algx2.l25.m1.2.2.4.9" xref="algx2.l25.m1.2.2.4.9.cmml">d</mi><mo id="algx2.l25.m1.2.2.4.1g" xref="algx2.l25.m1.2.2.4.1.cmml">⁢</mo><mi id="algx2.l25.m1.2.2.4.10" xref="algx2.l25.m1.2.2.4.10.cmml">a</mi><mo id="algx2.l25.m1.2.2.4.1h" xref="algx2.l25.m1.2.2.4.1.cmml">⁢</mo><mi id="algx2.l25.m1.2.2.4.11" xref="algx2.l25.m1.2.2.4.11.cmml">l</mi><mo id="algx2.l25.m1.2.2.4.1i" xref="algx2.l25.m1.2.2.4.1.cmml">⁢</mo><mi id="algx2.l25.m1.2.2.4.12" xref="algx2.l25.m1.2.2.4.12.cmml">A</mi><mo id="algx2.l25.m1.2.2.4.1j" xref="algx2.l25.m1.2.2.4.1.cmml">⁢</mo><mi id="algx2.l25.m1.2.2.4.13" xref="algx2.l25.m1.2.2.4.13.cmml">t</mi><mo id="algx2.l25.m1.2.2.4.1k" xref="algx2.l25.m1.2.2.4.1.cmml">⁢</mo><mi id="algx2.l25.m1.2.2.4.14" xref="algx2.l25.m1.2.2.4.14.cmml">t</mi><mo id="algx2.l25.m1.2.2.4.1l" xref="algx2.l25.m1.2.2.4.1.cmml">⁢</mo><mi id="algx2.l25.m1.2.2.4.15" xref="algx2.l25.m1.2.2.4.15.cmml">e</mi><mo id="algx2.l25.m1.2.2.4.1m" xref="algx2.l25.m1.2.2.4.1.cmml">⁢</mo><mi id="algx2.l25.m1.2.2.4.16" xref="algx2.l25.m1.2.2.4.16.cmml">n</mi><mo id="algx2.l25.m1.2.2.4.1n" xref="algx2.l25.m1.2.2.4.1.cmml">⁢</mo><mi id="algx2.l25.m1.2.2.4.17" xref="algx2.l25.m1.2.2.4.17.cmml">t</mi><mo id="algx2.l25.m1.2.2.4.1o" xref="algx2.l25.m1.2.2.4.1.cmml">⁢</mo><mi id="algx2.l25.m1.2.2.4.18" xref="algx2.l25.m1.2.2.4.18.cmml">i</mi><mo id="algx2.l25.m1.2.2.4.1p" xref="algx2.l25.m1.2.2.4.1.cmml">⁢</mo><mi id="algx2.l25.m1.2.2.4.19" xref="algx2.l25.m1.2.2.4.19.cmml">o</mi><mo id="algx2.l25.m1.2.2.4.1q" xref="algx2.l25.m1.2.2.4.1.cmml">⁢</mo><msup id="algx2.l25.m1.2.2.4.20" xref="algx2.l25.m1.2.2.4.20.cmml"><mi id="algx2.l25.m1.2.2.4.20.2" xref="algx2.l25.m1.2.2.4.20.2.cmml">n</mi><mi id="algx2.l25.m1.2.2.4.20.3" xref="algx2.l25.m1.2.2.4.20.3.cmml">i</mi></msup></mrow><mo id="algx2.l25.m1.2.2.3" stretchy="false" xref="algx2.l25.m1.2.2.3.cmml">←</mo><mrow id="algx2.l25.m1.2.2.2" xref="algx2.l25.m1.2.2.2.cmml"><mtext id="algx2.l25.m1.2.2.2.4" xref="algx2.l25.m1.2.2.2.4a.cmml">Dropout</mtext><mo id="algx2.l25.m1.2.2.2.3" xref="algx2.l25.m1.2.2.2.3.cmml">⁢</mo><mrow id="algx2.l25.m1.2.2.2.2.2" xref="algx2.l25.m1.2.2.2.2.3.cmml"><mo id="algx2.l25.m1.2.2.2.2.2.3" stretchy="false" xref="algx2.l25.m1.2.2.2.2.3.cmml">(</mo><mrow id="algx2.l25.m1.1.1.1.1.1.1" xref="algx2.l25.m1.1.1.1.1.1.1.cmml"><mi id="algx2.l25.m1.1.1.1.1.1.1.2" xref="algx2.l25.m1.1.1.1.1.1.1.2.cmml">C</mi><mo id="algx2.l25.m1.1.1.1.1.1.1.1" xref="algx2.l25.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx2.l25.m1.1.1.1.1.1.1.3" xref="algx2.l25.m1.1.1.1.1.1.1.3.cmml">r</mi><mo id="algx2.l25.m1.1.1.1.1.1.1.1a" xref="algx2.l25.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx2.l25.m1.1.1.1.1.1.1.4" xref="algx2.l25.m1.1.1.1.1.1.1.4.cmml">o</mi><mo id="algx2.l25.m1.1.1.1.1.1.1.1b" xref="algx2.l25.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx2.l25.m1.1.1.1.1.1.1.5" xref="algx2.l25.m1.1.1.1.1.1.1.5.cmml">s</mi><mo id="algx2.l25.m1.1.1.1.1.1.1.1c" xref="algx2.l25.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx2.l25.m1.1.1.1.1.1.1.6" xref="algx2.l25.m1.1.1.1.1.1.1.6.cmml">s</mi><mo id="algx2.l25.m1.1.1.1.1.1.1.1d" xref="algx2.l25.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx2.l25.m1.1.1.1.1.1.1.7" xref="algx2.l25.m1.1.1.1.1.1.1.7.cmml">M</mi><mo id="algx2.l25.m1.1.1.1.1.1.1.1e" xref="algx2.l25.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx2.l25.m1.1.1.1.1.1.1.8" xref="algx2.l25.m1.1.1.1.1.1.1.8.cmml">o</mi><mo id="algx2.l25.m1.1.1.1.1.1.1.1f" xref="algx2.l25.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx2.l25.m1.1.1.1.1.1.1.9" xref="algx2.l25.m1.1.1.1.1.1.1.9.cmml">d</mi><mo id="algx2.l25.m1.1.1.1.1.1.1.1g" xref="algx2.l25.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx2.l25.m1.1.1.1.1.1.1.10" xref="algx2.l25.m1.1.1.1.1.1.1.10.cmml">a</mi><mo id="algx2.l25.m1.1.1.1.1.1.1.1h" xref="algx2.l25.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx2.l25.m1.1.1.1.1.1.1.11" xref="algx2.l25.m1.1.1.1.1.1.1.11.cmml">l</mi><mo id="algx2.l25.m1.1.1.1.1.1.1.1i" xref="algx2.l25.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx2.l25.m1.1.1.1.1.1.1.12" xref="algx2.l25.m1.1.1.1.1.1.1.12.cmml">A</mi><mo id="algx2.l25.m1.1.1.1.1.1.1.1j" xref="algx2.l25.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx2.l25.m1.1.1.1.1.1.1.13" xref="algx2.l25.m1.1.1.1.1.1.1.13.cmml">t</mi><mo id="algx2.l25.m1.1.1.1.1.1.1.1k" xref="algx2.l25.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx2.l25.m1.1.1.1.1.1.1.14" xref="algx2.l25.m1.1.1.1.1.1.1.14.cmml">t</mi><mo id="algx2.l25.m1.1.1.1.1.1.1.1l" xref="algx2.l25.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx2.l25.m1.1.1.1.1.1.1.15" xref="algx2.l25.m1.1.1.1.1.1.1.15.cmml">e</mi><mo id="algx2.l25.m1.1.1.1.1.1.1.1m" xref="algx2.l25.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx2.l25.m1.1.1.1.1.1.1.16" xref="algx2.l25.m1.1.1.1.1.1.1.16.cmml">n</mi><mo id="algx2.l25.m1.1.1.1.1.1.1.1n" xref="algx2.l25.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx2.l25.m1.1.1.1.1.1.1.17" xref="algx2.l25.m1.1.1.1.1.1.1.17.cmml">t</mi><mo id="algx2.l25.m1.1.1.1.1.1.1.1o" xref="algx2.l25.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx2.l25.m1.1.1.1.1.1.1.18" xref="algx2.l25.m1.1.1.1.1.1.1.18.cmml">i</mi><mo id="algx2.l25.m1.1.1.1.1.1.1.1p" xref="algx2.l25.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx2.l25.m1.1.1.1.1.1.1.19" xref="algx2.l25.m1.1.1.1.1.1.1.19.cmml">o</mi><mo id="algx2.l25.m1.1.1.1.1.1.1.1q" xref="algx2.l25.m1.1.1.1.1.1.1.1.cmml">⁢</mo><msup id="algx2.l25.m1.1.1.1.1.1.1.20" xref="algx2.l25.m1.1.1.1.1.1.1.20.cmml"><mi id="algx2.l25.m1.1.1.1.1.1.1.20.2" xref="algx2.l25.m1.1.1.1.1.1.1.20.2.cmml">n</mi><mi id="algx2.l25.m1.1.1.1.1.1.1.20.3" xref="algx2.l25.m1.1.1.1.1.1.1.20.3.cmml">i</mi></msup></mrow><mo id="algx2.l25.m1.2.2.2.2.2.4" xref="algx2.l25.m1.2.2.2.2.3.cmml">,</mo><mrow id="algx2.l25.m1.2.2.2.2.2.2" xref="algx2.l25.m1.2.2.2.2.2.2.cmml"><mi id="algx2.l25.m1.2.2.2.2.2.2.2" xref="algx2.l25.m1.2.2.2.2.2.2.2.cmml">d</mi><mo id="algx2.l25.m1.2.2.2.2.2.2.1" xref="algx2.l25.m1.2.2.2.2.2.2.1.cmml">⁢</mo><mi id="algx2.l25.m1.2.2.2.2.2.2.3" xref="algx2.l25.m1.2.2.2.2.2.2.3.cmml">r</mi><mo id="algx2.l25.m1.2.2.2.2.2.2.1a" xref="algx2.l25.m1.2.2.2.2.2.2.1.cmml">⁢</mo><mi id="algx2.l25.m1.2.2.2.2.2.2.4" xref="algx2.l25.m1.2.2.2.2.2.2.4.cmml">o</mi><mo id="algx2.l25.m1.2.2.2.2.2.2.1b" xref="algx2.l25.m1.2.2.2.2.2.2.1.cmml">⁢</mo><mi id="algx2.l25.m1.2.2.2.2.2.2.5" xref="algx2.l25.m1.2.2.2.2.2.2.5.cmml">p</mi><mo id="algx2.l25.m1.2.2.2.2.2.2.1c" xref="algx2.l25.m1.2.2.2.2.2.2.1.cmml">⁢</mo><mi id="algx2.l25.m1.2.2.2.2.2.2.6" xref="algx2.l25.m1.2.2.2.2.2.2.6.cmml">o</mi><mo id="algx2.l25.m1.2.2.2.2.2.2.1d" xref="algx2.l25.m1.2.2.2.2.2.2.1.cmml">⁢</mo><mi id="algx2.l25.m1.2.2.2.2.2.2.7" xref="algx2.l25.m1.2.2.2.2.2.2.7.cmml">u</mi><mo id="algx2.l25.m1.2.2.2.2.2.2.1e" xref="algx2.l25.m1.2.2.2.2.2.2.1.cmml">⁢</mo><mi id="algx2.l25.m1.2.2.2.2.2.2.8" xref="algx2.l25.m1.2.2.2.2.2.2.8.cmml">t</mi><mo id="algx2.l25.m1.2.2.2.2.2.2.1f" xref="algx2.l25.m1.2.2.2.2.2.2.1.cmml">⁢</mo><mi id="algx2.l25.m1.2.2.2.2.2.2.9" mathvariant="normal" xref="algx2.l25.m1.2.2.2.2.2.2.9.cmml">_</mi><mo id="algx2.l25.m1.2.2.2.2.2.2.1g" xref="algx2.l25.m1.2.2.2.2.2.2.1.cmml">⁢</mo><mi id="algx2.l25.m1.2.2.2.2.2.2.10" xref="algx2.l25.m1.2.2.2.2.2.2.10.cmml">r</mi><mo id="algx2.l25.m1.2.2.2.2.2.2.1h" xref="algx2.l25.m1.2.2.2.2.2.2.1.cmml">⁢</mo><mi id="algx2.l25.m1.2.2.2.2.2.2.11" xref="algx2.l25.m1.2.2.2.2.2.2.11.cmml">a</mi><mo id="algx2.l25.m1.2.2.2.2.2.2.1i" xref="algx2.l25.m1.2.2.2.2.2.2.1.cmml">⁢</mo><mi id="algx2.l25.m1.2.2.2.2.2.2.12" xref="algx2.l25.m1.2.2.2.2.2.2.12.cmml">t</mi><mo id="algx2.l25.m1.2.2.2.2.2.2.1j" xref="algx2.l25.m1.2.2.2.2.2.2.1.cmml">⁢</mo><mi id="algx2.l25.m1.2.2.2.2.2.2.13" xref="algx2.l25.m1.2.2.2.2.2.2.13.cmml">e</mi></mrow><mo id="algx2.l25.m1.2.2.2.2.2.5" stretchy="false" xref="algx2.l25.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx2.l25.m1.2b"><apply id="algx2.l25.m1.2.2.cmml" xref="algx2.l25.m1.2.2"><ci id="algx2.l25.m1.2.2.3.cmml" xref="algx2.l25.m1.2.2.3">←</ci><apply id="algx2.l25.m1.2.2.4.cmml" xref="algx2.l25.m1.2.2.4"><times id="algx2.l25.m1.2.2.4.1.cmml" xref="algx2.l25.m1.2.2.4.1"></times><ci id="algx2.l25.m1.2.2.4.2.cmml" xref="algx2.l25.m1.2.2.4.2">𝐶</ci><ci id="algx2.l25.m1.2.2.4.3.cmml" xref="algx2.l25.m1.2.2.4.3">𝑟</ci><ci id="algx2.l25.m1.2.2.4.4.cmml" xref="algx2.l25.m1.2.2.4.4">𝑜</ci><ci id="algx2.l25.m1.2.2.4.5.cmml" xref="algx2.l25.m1.2.2.4.5">𝑠</ci><ci id="algx2.l25.m1.2.2.4.6.cmml" xref="algx2.l25.m1.2.2.4.6">𝑠</ci><ci id="algx2.l25.m1.2.2.4.7.cmml" xref="algx2.l25.m1.2.2.4.7">𝑀</ci><ci id="algx2.l25.m1.2.2.4.8.cmml" xref="algx2.l25.m1.2.2.4.8">𝑜</ci><ci id="algx2.l25.m1.2.2.4.9.cmml" xref="algx2.l25.m1.2.2.4.9">𝑑</ci><ci id="algx2.l25.m1.2.2.4.10.cmml" xref="algx2.l25.m1.2.2.4.10">𝑎</ci><ci id="algx2.l25.m1.2.2.4.11.cmml" xref="algx2.l25.m1.2.2.4.11">𝑙</ci><ci id="algx2.l25.m1.2.2.4.12.cmml" xref="algx2.l25.m1.2.2.4.12">𝐴</ci><ci id="algx2.l25.m1.2.2.4.13.cmml" xref="algx2.l25.m1.2.2.4.13">𝑡</ci><ci id="algx2.l25.m1.2.2.4.14.cmml" xref="algx2.l25.m1.2.2.4.14">𝑡</ci><ci id="algx2.l25.m1.2.2.4.15.cmml" xref="algx2.l25.m1.2.2.4.15">𝑒</ci><ci id="algx2.l25.m1.2.2.4.16.cmml" xref="algx2.l25.m1.2.2.4.16">𝑛</ci><ci id="algx2.l25.m1.2.2.4.17.cmml" xref="algx2.l25.m1.2.2.4.17">𝑡</ci><ci id="algx2.l25.m1.2.2.4.18.cmml" xref="algx2.l25.m1.2.2.4.18">𝑖</ci><ci id="algx2.l25.m1.2.2.4.19.cmml" xref="algx2.l25.m1.2.2.4.19">𝑜</ci><apply id="algx2.l25.m1.2.2.4.20.cmml" xref="algx2.l25.m1.2.2.4.20"><csymbol cd="ambiguous" id="algx2.l25.m1.2.2.4.20.1.cmml" xref="algx2.l25.m1.2.2.4.20">superscript</csymbol><ci id="algx2.l25.m1.2.2.4.20.2.cmml" xref="algx2.l25.m1.2.2.4.20.2">𝑛</ci><ci id="algx2.l25.m1.2.2.4.20.3.cmml" xref="algx2.l25.m1.2.2.4.20.3">𝑖</ci></apply></apply><apply id="algx2.l25.m1.2.2.2.cmml" xref="algx2.l25.m1.2.2.2"><times id="algx2.l25.m1.2.2.2.3.cmml" xref="algx2.l25.m1.2.2.2.3"></times><ci id="algx2.l25.m1.2.2.2.4a.cmml" xref="algx2.l25.m1.2.2.2.4"><mtext id="algx2.l25.m1.2.2.2.4.cmml" xref="algx2.l25.m1.2.2.2.4">Dropout</mtext></ci><interval closure="open" id="algx2.l25.m1.2.2.2.2.3.cmml" xref="algx2.l25.m1.2.2.2.2.2"><apply id="algx2.l25.m1.1.1.1.1.1.1.cmml" xref="algx2.l25.m1.1.1.1.1.1.1"><times id="algx2.l25.m1.1.1.1.1.1.1.1.cmml" xref="algx2.l25.m1.1.1.1.1.1.1.1"></times><ci id="algx2.l25.m1.1.1.1.1.1.1.2.cmml" xref="algx2.l25.m1.1.1.1.1.1.1.2">𝐶</ci><ci id="algx2.l25.m1.1.1.1.1.1.1.3.cmml" xref="algx2.l25.m1.1.1.1.1.1.1.3">𝑟</ci><ci id="algx2.l25.m1.1.1.1.1.1.1.4.cmml" xref="algx2.l25.m1.1.1.1.1.1.1.4">𝑜</ci><ci id="algx2.l25.m1.1.1.1.1.1.1.5.cmml" xref="algx2.l25.m1.1.1.1.1.1.1.5">𝑠</ci><ci id="algx2.l25.m1.1.1.1.1.1.1.6.cmml" xref="algx2.l25.m1.1.1.1.1.1.1.6">𝑠</ci><ci id="algx2.l25.m1.1.1.1.1.1.1.7.cmml" xref="algx2.l25.m1.1.1.1.1.1.1.7">𝑀</ci><ci id="algx2.l25.m1.1.1.1.1.1.1.8.cmml" xref="algx2.l25.m1.1.1.1.1.1.1.8">𝑜</ci><ci id="algx2.l25.m1.1.1.1.1.1.1.9.cmml" xref="algx2.l25.m1.1.1.1.1.1.1.9">𝑑</ci><ci id="algx2.l25.m1.1.1.1.1.1.1.10.cmml" xref="algx2.l25.m1.1.1.1.1.1.1.10">𝑎</ci><ci id="algx2.l25.m1.1.1.1.1.1.1.11.cmml" xref="algx2.l25.m1.1.1.1.1.1.1.11">𝑙</ci><ci id="algx2.l25.m1.1.1.1.1.1.1.12.cmml" xref="algx2.l25.m1.1.1.1.1.1.1.12">𝐴</ci><ci id="algx2.l25.m1.1.1.1.1.1.1.13.cmml" xref="algx2.l25.m1.1.1.1.1.1.1.13">𝑡</ci><ci id="algx2.l25.m1.1.1.1.1.1.1.14.cmml" xref="algx2.l25.m1.1.1.1.1.1.1.14">𝑡</ci><ci id="algx2.l25.m1.1.1.1.1.1.1.15.cmml" xref="algx2.l25.m1.1.1.1.1.1.1.15">𝑒</ci><ci id="algx2.l25.m1.1.1.1.1.1.1.16.cmml" xref="algx2.l25.m1.1.1.1.1.1.1.16">𝑛</ci><ci id="algx2.l25.m1.1.1.1.1.1.1.17.cmml" xref="algx2.l25.m1.1.1.1.1.1.1.17">𝑡</ci><ci id="algx2.l25.m1.1.1.1.1.1.1.18.cmml" xref="algx2.l25.m1.1.1.1.1.1.1.18">𝑖</ci><ci id="algx2.l25.m1.1.1.1.1.1.1.19.cmml" xref="algx2.l25.m1.1.1.1.1.1.1.19">𝑜</ci><apply id="algx2.l25.m1.1.1.1.1.1.1.20.cmml" xref="algx2.l25.m1.1.1.1.1.1.1.20"><csymbol cd="ambiguous" id="algx2.l25.m1.1.1.1.1.1.1.20.1.cmml" xref="algx2.l25.m1.1.1.1.1.1.1.20">superscript</csymbol><ci id="algx2.l25.m1.1.1.1.1.1.1.20.2.cmml" xref="algx2.l25.m1.1.1.1.1.1.1.20.2">𝑛</ci><ci id="algx2.l25.m1.1.1.1.1.1.1.20.3.cmml" xref="algx2.l25.m1.1.1.1.1.1.1.20.3">𝑖</ci></apply></apply><apply id="algx2.l25.m1.2.2.2.2.2.2.cmml" xref="algx2.l25.m1.2.2.2.2.2.2"><times id="algx2.l25.m1.2.2.2.2.2.2.1.cmml" xref="algx2.l25.m1.2.2.2.2.2.2.1"></times><ci id="algx2.l25.m1.2.2.2.2.2.2.2.cmml" xref="algx2.l25.m1.2.2.2.2.2.2.2">𝑑</ci><ci id="algx2.l25.m1.2.2.2.2.2.2.3.cmml" xref="algx2.l25.m1.2.2.2.2.2.2.3">𝑟</ci><ci id="algx2.l25.m1.2.2.2.2.2.2.4.cmml" xref="algx2.l25.m1.2.2.2.2.2.2.4">𝑜</ci><ci id="algx2.l25.m1.2.2.2.2.2.2.5.cmml" xref="algx2.l25.m1.2.2.2.2.2.2.5">𝑝</ci><ci id="algx2.l25.m1.2.2.2.2.2.2.6.cmml" xref="algx2.l25.m1.2.2.2.2.2.2.6">𝑜</ci><ci id="algx2.l25.m1.2.2.2.2.2.2.7.cmml" xref="algx2.l25.m1.2.2.2.2.2.2.7">𝑢</ci><ci id="algx2.l25.m1.2.2.2.2.2.2.8.cmml" xref="algx2.l25.m1.2.2.2.2.2.2.8">𝑡</ci><ci id="algx2.l25.m1.2.2.2.2.2.2.9.cmml" xref="algx2.l25.m1.2.2.2.2.2.2.9">_</ci><ci id="algx2.l25.m1.2.2.2.2.2.2.10.cmml" xref="algx2.l25.m1.2.2.2.2.2.2.10">𝑟</ci><ci id="algx2.l25.m1.2.2.2.2.2.2.11.cmml" xref="algx2.l25.m1.2.2.2.2.2.2.11">𝑎</ci><ci id="algx2.l25.m1.2.2.2.2.2.2.12.cmml" xref="algx2.l25.m1.2.2.2.2.2.2.12">𝑡</ci><ci id="algx2.l25.m1.2.2.2.2.2.2.13.cmml" xref="algx2.l25.m1.2.2.2.2.2.2.13">𝑒</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx2.l25.m1.2c">CrossModalAttention^{i}\leftarrow\text{Dropout}(CrossModalAttention^{i},%
dropout\_rate)</annotation><annotation encoding="application/x-llamapun" id="algx2.l25.m1.2d">italic_C italic_r italic_o italic_s italic_s italic_M italic_o italic_d italic_a italic_l italic_A italic_t italic_t italic_e italic_n italic_t italic_i italic_o italic_n start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ← Dropout ( italic_C italic_r italic_o italic_s italic_s italic_M italic_o italic_d italic_a italic_l italic_A italic_t italic_t italic_e italic_n italic_t italic_i italic_o italic_n start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT , italic_d italic_r italic_o italic_p italic_o italic_u italic_t _ italic_r italic_a italic_t italic_e )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algx2.l26">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algx2.l26.1.1.1" style="font-size:80%;">26:</span></span>  <span class="ltx_text ltx_font_bold" id="algx2.l26.2">end</span> <span class="ltx_text ltx_font_bold" id="algx2.l26.3">for</span>
</div>
<div class="ltx_listingline" id="algx2.l27">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algx2.l27.1.1.1" style="font-size:80%;">27:</span></span>  <math alttext="\begin{aligned} ConcatCrossModalAttention\leftarrow\text{Concatenate}(%
CrossModalAttention^{1},\dots,CrossModalAttention^{\text{num\_heads}})\end{aligned}" class="ltx_Math" display="inline" id="algx2.l27.m1.3"><semantics id="algx2.l27.m1.3a"><mtable id="algx2.l27.m1.3.3" xref="algx2.l27.m1.3.3.cmml"><mtr id="algx2.l27.m1.3.3a" xref="algx2.l27.m1.3.3.cmml"><mtd class="ltx_align_right" columnalign="right" id="algx2.l27.m1.3.3b" xref="algx2.l27.m1.3.3.cmml"><mrow id="algx2.l27.m1.3.3.3.3.3" xref="algx2.l27.m1.3.3.3.3.3.cmml"><mrow id="algx2.l27.m1.3.3.3.3.3.5" xref="algx2.l27.m1.3.3.3.3.3.5.cmml"><mi id="algx2.l27.m1.3.3.3.3.3.5.2" xref="algx2.l27.m1.3.3.3.3.3.5.2.cmml">C</mi><mo id="algx2.l27.m1.3.3.3.3.3.5.1" xref="algx2.l27.m1.3.3.3.3.3.5.1.cmml">⁢</mo><mi id="algx2.l27.m1.3.3.3.3.3.5.3" xref="algx2.l27.m1.3.3.3.3.3.5.3.cmml">o</mi><mo id="algx2.l27.m1.3.3.3.3.3.5.1a" xref="algx2.l27.m1.3.3.3.3.3.5.1.cmml">⁢</mo><mi id="algx2.l27.m1.3.3.3.3.3.5.4" xref="algx2.l27.m1.3.3.3.3.3.5.4.cmml">n</mi><mo id="algx2.l27.m1.3.3.3.3.3.5.1b" xref="algx2.l27.m1.3.3.3.3.3.5.1.cmml">⁢</mo><mi id="algx2.l27.m1.3.3.3.3.3.5.5" xref="algx2.l27.m1.3.3.3.3.3.5.5.cmml">c</mi><mo id="algx2.l27.m1.3.3.3.3.3.5.1c" xref="algx2.l27.m1.3.3.3.3.3.5.1.cmml">⁢</mo><mi id="algx2.l27.m1.3.3.3.3.3.5.6" xref="algx2.l27.m1.3.3.3.3.3.5.6.cmml">a</mi><mo id="algx2.l27.m1.3.3.3.3.3.5.1d" xref="algx2.l27.m1.3.3.3.3.3.5.1.cmml">⁢</mo><mi id="algx2.l27.m1.3.3.3.3.3.5.7" xref="algx2.l27.m1.3.3.3.3.3.5.7.cmml">t</mi><mo id="algx2.l27.m1.3.3.3.3.3.5.1e" xref="algx2.l27.m1.3.3.3.3.3.5.1.cmml">⁢</mo><mi id="algx2.l27.m1.3.3.3.3.3.5.8" xref="algx2.l27.m1.3.3.3.3.3.5.8.cmml">C</mi><mo id="algx2.l27.m1.3.3.3.3.3.5.1f" xref="algx2.l27.m1.3.3.3.3.3.5.1.cmml">⁢</mo><mi id="algx2.l27.m1.3.3.3.3.3.5.9" xref="algx2.l27.m1.3.3.3.3.3.5.9.cmml">r</mi><mo id="algx2.l27.m1.3.3.3.3.3.5.1g" xref="algx2.l27.m1.3.3.3.3.3.5.1.cmml">⁢</mo><mi id="algx2.l27.m1.3.3.3.3.3.5.10" xref="algx2.l27.m1.3.3.3.3.3.5.10.cmml">o</mi><mo id="algx2.l27.m1.3.3.3.3.3.5.1h" xref="algx2.l27.m1.3.3.3.3.3.5.1.cmml">⁢</mo><mi id="algx2.l27.m1.3.3.3.3.3.5.11" xref="algx2.l27.m1.3.3.3.3.3.5.11.cmml">s</mi><mo id="algx2.l27.m1.3.3.3.3.3.5.1i" xref="algx2.l27.m1.3.3.3.3.3.5.1.cmml">⁢</mo><mi id="algx2.l27.m1.3.3.3.3.3.5.12" xref="algx2.l27.m1.3.3.3.3.3.5.12.cmml">s</mi><mo id="algx2.l27.m1.3.3.3.3.3.5.1j" xref="algx2.l27.m1.3.3.3.3.3.5.1.cmml">⁢</mo><mi id="algx2.l27.m1.3.3.3.3.3.5.13" xref="algx2.l27.m1.3.3.3.3.3.5.13.cmml">M</mi><mo id="algx2.l27.m1.3.3.3.3.3.5.1k" xref="algx2.l27.m1.3.3.3.3.3.5.1.cmml">⁢</mo><mi id="algx2.l27.m1.3.3.3.3.3.5.14" xref="algx2.l27.m1.3.3.3.3.3.5.14.cmml">o</mi><mo id="algx2.l27.m1.3.3.3.3.3.5.1l" xref="algx2.l27.m1.3.3.3.3.3.5.1.cmml">⁢</mo><mi id="algx2.l27.m1.3.3.3.3.3.5.15" xref="algx2.l27.m1.3.3.3.3.3.5.15.cmml">d</mi><mo id="algx2.l27.m1.3.3.3.3.3.5.1m" xref="algx2.l27.m1.3.3.3.3.3.5.1.cmml">⁢</mo><mi id="algx2.l27.m1.3.3.3.3.3.5.16" xref="algx2.l27.m1.3.3.3.3.3.5.16.cmml">a</mi><mo id="algx2.l27.m1.3.3.3.3.3.5.1n" xref="algx2.l27.m1.3.3.3.3.3.5.1.cmml">⁢</mo><mi id="algx2.l27.m1.3.3.3.3.3.5.17" xref="algx2.l27.m1.3.3.3.3.3.5.17.cmml">l</mi><mo id="algx2.l27.m1.3.3.3.3.3.5.1o" xref="algx2.l27.m1.3.3.3.3.3.5.1.cmml">⁢</mo><mi id="algx2.l27.m1.3.3.3.3.3.5.18" xref="algx2.l27.m1.3.3.3.3.3.5.18.cmml">A</mi><mo id="algx2.l27.m1.3.3.3.3.3.5.1p" xref="algx2.l27.m1.3.3.3.3.3.5.1.cmml">⁢</mo><mi id="algx2.l27.m1.3.3.3.3.3.5.19" xref="algx2.l27.m1.3.3.3.3.3.5.19.cmml">t</mi><mo id="algx2.l27.m1.3.3.3.3.3.5.1q" xref="algx2.l27.m1.3.3.3.3.3.5.1.cmml">⁢</mo><mi id="algx2.l27.m1.3.3.3.3.3.5.20" xref="algx2.l27.m1.3.3.3.3.3.5.20.cmml">t</mi><mo id="algx2.l27.m1.3.3.3.3.3.5.1r" xref="algx2.l27.m1.3.3.3.3.3.5.1.cmml">⁢</mo><mi id="algx2.l27.m1.3.3.3.3.3.5.21" xref="algx2.l27.m1.3.3.3.3.3.5.21.cmml">e</mi><mo id="algx2.l27.m1.3.3.3.3.3.5.1s" xref="algx2.l27.m1.3.3.3.3.3.5.1.cmml">⁢</mo><mi id="algx2.l27.m1.3.3.3.3.3.5.22" xref="algx2.l27.m1.3.3.3.3.3.5.22.cmml">n</mi><mo id="algx2.l27.m1.3.3.3.3.3.5.1t" xref="algx2.l27.m1.3.3.3.3.3.5.1.cmml">⁢</mo><mi id="algx2.l27.m1.3.3.3.3.3.5.23" xref="algx2.l27.m1.3.3.3.3.3.5.23.cmml">t</mi><mo id="algx2.l27.m1.3.3.3.3.3.5.1u" xref="algx2.l27.m1.3.3.3.3.3.5.1.cmml">⁢</mo><mi id="algx2.l27.m1.3.3.3.3.3.5.24" xref="algx2.l27.m1.3.3.3.3.3.5.24.cmml">i</mi><mo id="algx2.l27.m1.3.3.3.3.3.5.1v" xref="algx2.l27.m1.3.3.3.3.3.5.1.cmml">⁢</mo><mi id="algx2.l27.m1.3.3.3.3.3.5.25" xref="algx2.l27.m1.3.3.3.3.3.5.25.cmml">o</mi><mo id="algx2.l27.m1.3.3.3.3.3.5.1w" xref="algx2.l27.m1.3.3.3.3.3.5.1.cmml">⁢</mo><mi id="algx2.l27.m1.3.3.3.3.3.5.26" xref="algx2.l27.m1.3.3.3.3.3.5.26.cmml">n</mi></mrow><mo id="algx2.l27.m1.3.3.3.3.3.4" stretchy="false" xref="algx2.l27.m1.3.3.3.3.3.4.cmml">←</mo><mrow id="algx2.l27.m1.3.3.3.3.3.3" xref="algx2.l27.m1.3.3.3.3.3.3.cmml"><mtext id="algx2.l27.m1.3.3.3.3.3.3.4" xref="algx2.l27.m1.3.3.3.3.3.3.4a.cmml">Concatenate</mtext><mo id="algx2.l27.m1.3.3.3.3.3.3.3" xref="algx2.l27.m1.3.3.3.3.3.3.3.cmml">⁢</mo><mrow id="algx2.l27.m1.3.3.3.3.3.3.2.2" xref="algx2.l27.m1.3.3.3.3.3.3.2.3.cmml"><mo id="algx2.l27.m1.3.3.3.3.3.3.2.2.3" stretchy="false" xref="algx2.l27.m1.3.3.3.3.3.3.2.3.cmml">(</mo><mrow id="algx2.l27.m1.2.2.2.2.2.2.1.1.1" xref="algx2.l27.m1.2.2.2.2.2.2.1.1.1.cmml"><mi id="algx2.l27.m1.2.2.2.2.2.2.1.1.1.2" xref="algx2.l27.m1.2.2.2.2.2.2.1.1.1.2.cmml">C</mi><mo id="algx2.l27.m1.2.2.2.2.2.2.1.1.1.1" xref="algx2.l27.m1.2.2.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="algx2.l27.m1.2.2.2.2.2.2.1.1.1.3" xref="algx2.l27.m1.2.2.2.2.2.2.1.1.1.3.cmml">r</mi><mo id="algx2.l27.m1.2.2.2.2.2.2.1.1.1.1a" xref="algx2.l27.m1.2.2.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="algx2.l27.m1.2.2.2.2.2.2.1.1.1.4" xref="algx2.l27.m1.2.2.2.2.2.2.1.1.1.4.cmml">o</mi><mo id="algx2.l27.m1.2.2.2.2.2.2.1.1.1.1b" xref="algx2.l27.m1.2.2.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="algx2.l27.m1.2.2.2.2.2.2.1.1.1.5" xref="algx2.l27.m1.2.2.2.2.2.2.1.1.1.5.cmml">s</mi><mo id="algx2.l27.m1.2.2.2.2.2.2.1.1.1.1c" xref="algx2.l27.m1.2.2.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="algx2.l27.m1.2.2.2.2.2.2.1.1.1.6" xref="algx2.l27.m1.2.2.2.2.2.2.1.1.1.6.cmml">s</mi><mo id="algx2.l27.m1.2.2.2.2.2.2.1.1.1.1d" xref="algx2.l27.m1.2.2.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="algx2.l27.m1.2.2.2.2.2.2.1.1.1.7" xref="algx2.l27.m1.2.2.2.2.2.2.1.1.1.7.cmml">M</mi><mo id="algx2.l27.m1.2.2.2.2.2.2.1.1.1.1e" xref="algx2.l27.m1.2.2.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="algx2.l27.m1.2.2.2.2.2.2.1.1.1.8" xref="algx2.l27.m1.2.2.2.2.2.2.1.1.1.8.cmml">o</mi><mo id="algx2.l27.m1.2.2.2.2.2.2.1.1.1.1f" xref="algx2.l27.m1.2.2.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="algx2.l27.m1.2.2.2.2.2.2.1.1.1.9" xref="algx2.l27.m1.2.2.2.2.2.2.1.1.1.9.cmml">d</mi><mo id="algx2.l27.m1.2.2.2.2.2.2.1.1.1.1g" xref="algx2.l27.m1.2.2.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="algx2.l27.m1.2.2.2.2.2.2.1.1.1.10" xref="algx2.l27.m1.2.2.2.2.2.2.1.1.1.10.cmml">a</mi><mo id="algx2.l27.m1.2.2.2.2.2.2.1.1.1.1h" xref="algx2.l27.m1.2.2.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="algx2.l27.m1.2.2.2.2.2.2.1.1.1.11" xref="algx2.l27.m1.2.2.2.2.2.2.1.1.1.11.cmml">l</mi><mo id="algx2.l27.m1.2.2.2.2.2.2.1.1.1.1i" xref="algx2.l27.m1.2.2.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="algx2.l27.m1.2.2.2.2.2.2.1.1.1.12" xref="algx2.l27.m1.2.2.2.2.2.2.1.1.1.12.cmml">A</mi><mo id="algx2.l27.m1.2.2.2.2.2.2.1.1.1.1j" xref="algx2.l27.m1.2.2.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="algx2.l27.m1.2.2.2.2.2.2.1.1.1.13" xref="algx2.l27.m1.2.2.2.2.2.2.1.1.1.13.cmml">t</mi><mo id="algx2.l27.m1.2.2.2.2.2.2.1.1.1.1k" xref="algx2.l27.m1.2.2.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="algx2.l27.m1.2.2.2.2.2.2.1.1.1.14" xref="algx2.l27.m1.2.2.2.2.2.2.1.1.1.14.cmml">t</mi><mo id="algx2.l27.m1.2.2.2.2.2.2.1.1.1.1l" xref="algx2.l27.m1.2.2.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="algx2.l27.m1.2.2.2.2.2.2.1.1.1.15" xref="algx2.l27.m1.2.2.2.2.2.2.1.1.1.15.cmml">e</mi><mo id="algx2.l27.m1.2.2.2.2.2.2.1.1.1.1m" xref="algx2.l27.m1.2.2.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="algx2.l27.m1.2.2.2.2.2.2.1.1.1.16" xref="algx2.l27.m1.2.2.2.2.2.2.1.1.1.16.cmml">n</mi><mo id="algx2.l27.m1.2.2.2.2.2.2.1.1.1.1n" xref="algx2.l27.m1.2.2.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="algx2.l27.m1.2.2.2.2.2.2.1.1.1.17" xref="algx2.l27.m1.2.2.2.2.2.2.1.1.1.17.cmml">t</mi><mo id="algx2.l27.m1.2.2.2.2.2.2.1.1.1.1o" xref="algx2.l27.m1.2.2.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="algx2.l27.m1.2.2.2.2.2.2.1.1.1.18" xref="algx2.l27.m1.2.2.2.2.2.2.1.1.1.18.cmml">i</mi><mo id="algx2.l27.m1.2.2.2.2.2.2.1.1.1.1p" xref="algx2.l27.m1.2.2.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="algx2.l27.m1.2.2.2.2.2.2.1.1.1.19" xref="algx2.l27.m1.2.2.2.2.2.2.1.1.1.19.cmml">o</mi><mo id="algx2.l27.m1.2.2.2.2.2.2.1.1.1.1q" xref="algx2.l27.m1.2.2.2.2.2.2.1.1.1.1.cmml">⁢</mo><msup id="algx2.l27.m1.2.2.2.2.2.2.1.1.1.20" xref="algx2.l27.m1.2.2.2.2.2.2.1.1.1.20.cmml"><mi id="algx2.l27.m1.2.2.2.2.2.2.1.1.1.20.2" xref="algx2.l27.m1.2.2.2.2.2.2.1.1.1.20.2.cmml">n</mi><mn id="algx2.l27.m1.2.2.2.2.2.2.1.1.1.20.3" xref="algx2.l27.m1.2.2.2.2.2.2.1.1.1.20.3.cmml">1</mn></msup></mrow><mo id="algx2.l27.m1.3.3.3.3.3.3.2.2.4" xref="algx2.l27.m1.3.3.3.3.3.3.2.3.cmml">,</mo><mi id="algx2.l27.m1.1.1.1.1.1.1" mathvariant="normal" xref="algx2.l27.m1.1.1.1.1.1.1.cmml">…</mi><mo id="algx2.l27.m1.3.3.3.3.3.3.2.2.5" xref="algx2.l27.m1.3.3.3.3.3.3.2.3.cmml">,</mo><mrow id="algx2.l27.m1.3.3.3.3.3.3.2.2.2" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2.cmml"><mi id="algx2.l27.m1.3.3.3.3.3.3.2.2.2.2" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2.2.cmml">C</mi><mo id="algx2.l27.m1.3.3.3.3.3.3.2.2.2.1" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2.1.cmml">⁢</mo><mi id="algx2.l27.m1.3.3.3.3.3.3.2.2.2.3" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2.3.cmml">r</mi><mo id="algx2.l27.m1.3.3.3.3.3.3.2.2.2.1a" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2.1.cmml">⁢</mo><mi id="algx2.l27.m1.3.3.3.3.3.3.2.2.2.4" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2.4.cmml">o</mi><mo id="algx2.l27.m1.3.3.3.3.3.3.2.2.2.1b" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2.1.cmml">⁢</mo><mi id="algx2.l27.m1.3.3.3.3.3.3.2.2.2.5" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2.5.cmml">s</mi><mo id="algx2.l27.m1.3.3.3.3.3.3.2.2.2.1c" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2.1.cmml">⁢</mo><mi id="algx2.l27.m1.3.3.3.3.3.3.2.2.2.6" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2.6.cmml">s</mi><mo id="algx2.l27.m1.3.3.3.3.3.3.2.2.2.1d" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2.1.cmml">⁢</mo><mi id="algx2.l27.m1.3.3.3.3.3.3.2.2.2.7" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2.7.cmml">M</mi><mo id="algx2.l27.m1.3.3.3.3.3.3.2.2.2.1e" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2.1.cmml">⁢</mo><mi id="algx2.l27.m1.3.3.3.3.3.3.2.2.2.8" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2.8.cmml">o</mi><mo id="algx2.l27.m1.3.3.3.3.3.3.2.2.2.1f" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2.1.cmml">⁢</mo><mi id="algx2.l27.m1.3.3.3.3.3.3.2.2.2.9" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2.9.cmml">d</mi><mo id="algx2.l27.m1.3.3.3.3.3.3.2.2.2.1g" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2.1.cmml">⁢</mo><mi id="algx2.l27.m1.3.3.3.3.3.3.2.2.2.10" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2.10.cmml">a</mi><mo id="algx2.l27.m1.3.3.3.3.3.3.2.2.2.1h" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2.1.cmml">⁢</mo><mi id="algx2.l27.m1.3.3.3.3.3.3.2.2.2.11" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2.11.cmml">l</mi><mo id="algx2.l27.m1.3.3.3.3.3.3.2.2.2.1i" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2.1.cmml">⁢</mo><mi id="algx2.l27.m1.3.3.3.3.3.3.2.2.2.12" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2.12.cmml">A</mi><mo id="algx2.l27.m1.3.3.3.3.3.3.2.2.2.1j" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2.1.cmml">⁢</mo><mi id="algx2.l27.m1.3.3.3.3.3.3.2.2.2.13" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2.13.cmml">t</mi><mo id="algx2.l27.m1.3.3.3.3.3.3.2.2.2.1k" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2.1.cmml">⁢</mo><mi id="algx2.l27.m1.3.3.3.3.3.3.2.2.2.14" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2.14.cmml">t</mi><mo id="algx2.l27.m1.3.3.3.3.3.3.2.2.2.1l" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2.1.cmml">⁢</mo><mi id="algx2.l27.m1.3.3.3.3.3.3.2.2.2.15" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2.15.cmml">e</mi><mo id="algx2.l27.m1.3.3.3.3.3.3.2.2.2.1m" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2.1.cmml">⁢</mo><mi id="algx2.l27.m1.3.3.3.3.3.3.2.2.2.16" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2.16.cmml">n</mi><mo id="algx2.l27.m1.3.3.3.3.3.3.2.2.2.1n" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2.1.cmml">⁢</mo><mi id="algx2.l27.m1.3.3.3.3.3.3.2.2.2.17" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2.17.cmml">t</mi><mo id="algx2.l27.m1.3.3.3.3.3.3.2.2.2.1o" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2.1.cmml">⁢</mo><mi id="algx2.l27.m1.3.3.3.3.3.3.2.2.2.18" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2.18.cmml">i</mi><mo id="algx2.l27.m1.3.3.3.3.3.3.2.2.2.1p" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2.1.cmml">⁢</mo><mi id="algx2.l27.m1.3.3.3.3.3.3.2.2.2.19" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2.19.cmml">o</mi><mo id="algx2.l27.m1.3.3.3.3.3.3.2.2.2.1q" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2.1.cmml">⁢</mo><msup id="algx2.l27.m1.3.3.3.3.3.3.2.2.2.20" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2.20.cmml"><mi id="algx2.l27.m1.3.3.3.3.3.3.2.2.2.20.2" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2.20.2.cmml">n</mi><mtext id="algx2.l27.m1.3.3.3.3.3.3.2.2.2.20.3" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2.20.3a.cmml">num_heads</mtext></msup></mrow><mo id="algx2.l27.m1.3.3.3.3.3.3.2.2.6" stretchy="false" xref="algx2.l27.m1.3.3.3.3.3.3.2.3.cmml">)</mo></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="algx2.l27.m1.3b"><matrix id="algx2.l27.m1.3.3.cmml" xref="algx2.l27.m1.3.3"><matrixrow id="algx2.l27.m1.3.3a.cmml" xref="algx2.l27.m1.3.3"><apply id="algx2.l27.m1.3.3.3.3.3.cmml" xref="algx2.l27.m1.3.3.3.3.3"><ci id="algx2.l27.m1.3.3.3.3.3.4.cmml" xref="algx2.l27.m1.3.3.3.3.3.4">←</ci><apply id="algx2.l27.m1.3.3.3.3.3.5.cmml" xref="algx2.l27.m1.3.3.3.3.3.5"><times id="algx2.l27.m1.3.3.3.3.3.5.1.cmml" xref="algx2.l27.m1.3.3.3.3.3.5.1"></times><ci id="algx2.l27.m1.3.3.3.3.3.5.2.cmml" xref="algx2.l27.m1.3.3.3.3.3.5.2">𝐶</ci><ci id="algx2.l27.m1.3.3.3.3.3.5.3.cmml" xref="algx2.l27.m1.3.3.3.3.3.5.3">𝑜</ci><ci id="algx2.l27.m1.3.3.3.3.3.5.4.cmml" xref="algx2.l27.m1.3.3.3.3.3.5.4">𝑛</ci><ci id="algx2.l27.m1.3.3.3.3.3.5.5.cmml" xref="algx2.l27.m1.3.3.3.3.3.5.5">𝑐</ci><ci id="algx2.l27.m1.3.3.3.3.3.5.6.cmml" xref="algx2.l27.m1.3.3.3.3.3.5.6">𝑎</ci><ci id="algx2.l27.m1.3.3.3.3.3.5.7.cmml" xref="algx2.l27.m1.3.3.3.3.3.5.7">𝑡</ci><ci id="algx2.l27.m1.3.3.3.3.3.5.8.cmml" xref="algx2.l27.m1.3.3.3.3.3.5.8">𝐶</ci><ci id="algx2.l27.m1.3.3.3.3.3.5.9.cmml" xref="algx2.l27.m1.3.3.3.3.3.5.9">𝑟</ci><ci id="algx2.l27.m1.3.3.3.3.3.5.10.cmml" xref="algx2.l27.m1.3.3.3.3.3.5.10">𝑜</ci><ci id="algx2.l27.m1.3.3.3.3.3.5.11.cmml" xref="algx2.l27.m1.3.3.3.3.3.5.11">𝑠</ci><ci id="algx2.l27.m1.3.3.3.3.3.5.12.cmml" xref="algx2.l27.m1.3.3.3.3.3.5.12">𝑠</ci><ci id="algx2.l27.m1.3.3.3.3.3.5.13.cmml" xref="algx2.l27.m1.3.3.3.3.3.5.13">𝑀</ci><ci id="algx2.l27.m1.3.3.3.3.3.5.14.cmml" xref="algx2.l27.m1.3.3.3.3.3.5.14">𝑜</ci><ci id="algx2.l27.m1.3.3.3.3.3.5.15.cmml" xref="algx2.l27.m1.3.3.3.3.3.5.15">𝑑</ci><ci id="algx2.l27.m1.3.3.3.3.3.5.16.cmml" xref="algx2.l27.m1.3.3.3.3.3.5.16">𝑎</ci><ci id="algx2.l27.m1.3.3.3.3.3.5.17.cmml" xref="algx2.l27.m1.3.3.3.3.3.5.17">𝑙</ci><ci id="algx2.l27.m1.3.3.3.3.3.5.18.cmml" xref="algx2.l27.m1.3.3.3.3.3.5.18">𝐴</ci><ci id="algx2.l27.m1.3.3.3.3.3.5.19.cmml" xref="algx2.l27.m1.3.3.3.3.3.5.19">𝑡</ci><ci id="algx2.l27.m1.3.3.3.3.3.5.20.cmml" xref="algx2.l27.m1.3.3.3.3.3.5.20">𝑡</ci><ci id="algx2.l27.m1.3.3.3.3.3.5.21.cmml" xref="algx2.l27.m1.3.3.3.3.3.5.21">𝑒</ci><ci id="algx2.l27.m1.3.3.3.3.3.5.22.cmml" xref="algx2.l27.m1.3.3.3.3.3.5.22">𝑛</ci><ci id="algx2.l27.m1.3.3.3.3.3.5.23.cmml" xref="algx2.l27.m1.3.3.3.3.3.5.23">𝑡</ci><ci id="algx2.l27.m1.3.3.3.3.3.5.24.cmml" xref="algx2.l27.m1.3.3.3.3.3.5.24">𝑖</ci><ci id="algx2.l27.m1.3.3.3.3.3.5.25.cmml" xref="algx2.l27.m1.3.3.3.3.3.5.25">𝑜</ci><ci id="algx2.l27.m1.3.3.3.3.3.5.26.cmml" xref="algx2.l27.m1.3.3.3.3.3.5.26">𝑛</ci></apply><apply id="algx2.l27.m1.3.3.3.3.3.3.cmml" xref="algx2.l27.m1.3.3.3.3.3.3"><times id="algx2.l27.m1.3.3.3.3.3.3.3.cmml" xref="algx2.l27.m1.3.3.3.3.3.3.3"></times><ci id="algx2.l27.m1.3.3.3.3.3.3.4a.cmml" xref="algx2.l27.m1.3.3.3.3.3.3.4"><mtext id="algx2.l27.m1.3.3.3.3.3.3.4.cmml" xref="algx2.l27.m1.3.3.3.3.3.3.4">Concatenate</mtext></ci><vector id="algx2.l27.m1.3.3.3.3.3.3.2.3.cmml" xref="algx2.l27.m1.3.3.3.3.3.3.2.2"><apply id="algx2.l27.m1.2.2.2.2.2.2.1.1.1.cmml" xref="algx2.l27.m1.2.2.2.2.2.2.1.1.1"><times id="algx2.l27.m1.2.2.2.2.2.2.1.1.1.1.cmml" xref="algx2.l27.m1.2.2.2.2.2.2.1.1.1.1"></times><ci id="algx2.l27.m1.2.2.2.2.2.2.1.1.1.2.cmml" xref="algx2.l27.m1.2.2.2.2.2.2.1.1.1.2">𝐶</ci><ci id="algx2.l27.m1.2.2.2.2.2.2.1.1.1.3.cmml" xref="algx2.l27.m1.2.2.2.2.2.2.1.1.1.3">𝑟</ci><ci id="algx2.l27.m1.2.2.2.2.2.2.1.1.1.4.cmml" xref="algx2.l27.m1.2.2.2.2.2.2.1.1.1.4">𝑜</ci><ci id="algx2.l27.m1.2.2.2.2.2.2.1.1.1.5.cmml" xref="algx2.l27.m1.2.2.2.2.2.2.1.1.1.5">𝑠</ci><ci id="algx2.l27.m1.2.2.2.2.2.2.1.1.1.6.cmml" xref="algx2.l27.m1.2.2.2.2.2.2.1.1.1.6">𝑠</ci><ci id="algx2.l27.m1.2.2.2.2.2.2.1.1.1.7.cmml" xref="algx2.l27.m1.2.2.2.2.2.2.1.1.1.7">𝑀</ci><ci id="algx2.l27.m1.2.2.2.2.2.2.1.1.1.8.cmml" xref="algx2.l27.m1.2.2.2.2.2.2.1.1.1.8">𝑜</ci><ci id="algx2.l27.m1.2.2.2.2.2.2.1.1.1.9.cmml" xref="algx2.l27.m1.2.2.2.2.2.2.1.1.1.9">𝑑</ci><ci id="algx2.l27.m1.2.2.2.2.2.2.1.1.1.10.cmml" xref="algx2.l27.m1.2.2.2.2.2.2.1.1.1.10">𝑎</ci><ci id="algx2.l27.m1.2.2.2.2.2.2.1.1.1.11.cmml" xref="algx2.l27.m1.2.2.2.2.2.2.1.1.1.11">𝑙</ci><ci id="algx2.l27.m1.2.2.2.2.2.2.1.1.1.12.cmml" xref="algx2.l27.m1.2.2.2.2.2.2.1.1.1.12">𝐴</ci><ci id="algx2.l27.m1.2.2.2.2.2.2.1.1.1.13.cmml" xref="algx2.l27.m1.2.2.2.2.2.2.1.1.1.13">𝑡</ci><ci id="algx2.l27.m1.2.2.2.2.2.2.1.1.1.14.cmml" xref="algx2.l27.m1.2.2.2.2.2.2.1.1.1.14">𝑡</ci><ci id="algx2.l27.m1.2.2.2.2.2.2.1.1.1.15.cmml" xref="algx2.l27.m1.2.2.2.2.2.2.1.1.1.15">𝑒</ci><ci id="algx2.l27.m1.2.2.2.2.2.2.1.1.1.16.cmml" xref="algx2.l27.m1.2.2.2.2.2.2.1.1.1.16">𝑛</ci><ci id="algx2.l27.m1.2.2.2.2.2.2.1.1.1.17.cmml" xref="algx2.l27.m1.2.2.2.2.2.2.1.1.1.17">𝑡</ci><ci id="algx2.l27.m1.2.2.2.2.2.2.1.1.1.18.cmml" xref="algx2.l27.m1.2.2.2.2.2.2.1.1.1.18">𝑖</ci><ci id="algx2.l27.m1.2.2.2.2.2.2.1.1.1.19.cmml" xref="algx2.l27.m1.2.2.2.2.2.2.1.1.1.19">𝑜</ci><apply id="algx2.l27.m1.2.2.2.2.2.2.1.1.1.20.cmml" xref="algx2.l27.m1.2.2.2.2.2.2.1.1.1.20"><csymbol cd="ambiguous" id="algx2.l27.m1.2.2.2.2.2.2.1.1.1.20.1.cmml" xref="algx2.l27.m1.2.2.2.2.2.2.1.1.1.20">superscript</csymbol><ci id="algx2.l27.m1.2.2.2.2.2.2.1.1.1.20.2.cmml" xref="algx2.l27.m1.2.2.2.2.2.2.1.1.1.20.2">𝑛</ci><cn id="algx2.l27.m1.2.2.2.2.2.2.1.1.1.20.3.cmml" type="integer" xref="algx2.l27.m1.2.2.2.2.2.2.1.1.1.20.3">1</cn></apply></apply><ci id="algx2.l27.m1.1.1.1.1.1.1.cmml" xref="algx2.l27.m1.1.1.1.1.1.1">…</ci><apply id="algx2.l27.m1.3.3.3.3.3.3.2.2.2.cmml" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2"><times id="algx2.l27.m1.3.3.3.3.3.3.2.2.2.1.cmml" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2.1"></times><ci id="algx2.l27.m1.3.3.3.3.3.3.2.2.2.2.cmml" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2.2">𝐶</ci><ci id="algx2.l27.m1.3.3.3.3.3.3.2.2.2.3.cmml" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2.3">𝑟</ci><ci id="algx2.l27.m1.3.3.3.3.3.3.2.2.2.4.cmml" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2.4">𝑜</ci><ci id="algx2.l27.m1.3.3.3.3.3.3.2.2.2.5.cmml" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2.5">𝑠</ci><ci id="algx2.l27.m1.3.3.3.3.3.3.2.2.2.6.cmml" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2.6">𝑠</ci><ci id="algx2.l27.m1.3.3.3.3.3.3.2.2.2.7.cmml" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2.7">𝑀</ci><ci id="algx2.l27.m1.3.3.3.3.3.3.2.2.2.8.cmml" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2.8">𝑜</ci><ci id="algx2.l27.m1.3.3.3.3.3.3.2.2.2.9.cmml" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2.9">𝑑</ci><ci id="algx2.l27.m1.3.3.3.3.3.3.2.2.2.10.cmml" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2.10">𝑎</ci><ci id="algx2.l27.m1.3.3.3.3.3.3.2.2.2.11.cmml" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2.11">𝑙</ci><ci id="algx2.l27.m1.3.3.3.3.3.3.2.2.2.12.cmml" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2.12">𝐴</ci><ci id="algx2.l27.m1.3.3.3.3.3.3.2.2.2.13.cmml" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2.13">𝑡</ci><ci id="algx2.l27.m1.3.3.3.3.3.3.2.2.2.14.cmml" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2.14">𝑡</ci><ci id="algx2.l27.m1.3.3.3.3.3.3.2.2.2.15.cmml" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2.15">𝑒</ci><ci id="algx2.l27.m1.3.3.3.3.3.3.2.2.2.16.cmml" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2.16">𝑛</ci><ci id="algx2.l27.m1.3.3.3.3.3.3.2.2.2.17.cmml" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2.17">𝑡</ci><ci id="algx2.l27.m1.3.3.3.3.3.3.2.2.2.18.cmml" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2.18">𝑖</ci><ci id="algx2.l27.m1.3.3.3.3.3.3.2.2.2.19.cmml" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2.19">𝑜</ci><apply id="algx2.l27.m1.3.3.3.3.3.3.2.2.2.20.cmml" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2.20"><csymbol cd="ambiguous" id="algx2.l27.m1.3.3.3.3.3.3.2.2.2.20.1.cmml" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2.20">superscript</csymbol><ci id="algx2.l27.m1.3.3.3.3.3.3.2.2.2.20.2.cmml" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2.20.2">𝑛</ci><ci id="algx2.l27.m1.3.3.3.3.3.3.2.2.2.20.3a.cmml" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2.20.3"><mtext id="algx2.l27.m1.3.3.3.3.3.3.2.2.2.20.3.cmml" mathsize="70%" xref="algx2.l27.m1.3.3.3.3.3.3.2.2.2.20.3">num_heads</mtext></ci></apply></apply></vector></apply></apply></matrixrow></matrix></annotation-xml><annotation encoding="application/x-tex" id="algx2.l27.m1.3c">\begin{aligned} ConcatCrossModalAttention\leftarrow\text{Concatenate}(%
CrossModalAttention^{1},\dots,CrossModalAttention^{\text{num\_heads}})\end{aligned}</annotation><annotation encoding="application/x-llamapun" id="algx2.l27.m1.3d">start_ROW start_CELL italic_C italic_o italic_n italic_c italic_a italic_t italic_C italic_r italic_o italic_s italic_s italic_M italic_o italic_d italic_a italic_l italic_A italic_t italic_t italic_e italic_n italic_t italic_i italic_o italic_n ← Concatenate ( italic_C italic_r italic_o italic_s italic_s italic_M italic_o italic_d italic_a italic_l italic_A italic_t italic_t italic_e italic_n italic_t italic_i italic_o italic_n start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , … , italic_C italic_r italic_o italic_s italic_s italic_M italic_o italic_d italic_a italic_l italic_A italic_t italic_t italic_e italic_n italic_t italic_i italic_o italic_n start_POSTSUPERSCRIPT num_heads end_POSTSUPERSCRIPT ) end_CELL end_ROW</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algx2.l28">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algx2.l28.1.1.1" style="font-size:80%;">28:</span></span>  <math alttext="CrossModalOutput\leftarrow\text{LayerNorm}(ConcatCrossModalAttention\cdot W_{O%
}+SelfAttentionOutput_{a})" class="ltx_Math" display="inline" id="algx2.l28.m1.1"><semantics id="algx2.l28.m1.1a"><mrow id="algx2.l28.m1.1.1" xref="algx2.l28.m1.1.1.cmml"><mrow id="algx2.l28.m1.1.1.3" xref="algx2.l28.m1.1.1.3.cmml"><mi id="algx2.l28.m1.1.1.3.2" xref="algx2.l28.m1.1.1.3.2.cmml">C</mi><mo id="algx2.l28.m1.1.1.3.1" xref="algx2.l28.m1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l28.m1.1.1.3.3" xref="algx2.l28.m1.1.1.3.3.cmml">r</mi><mo id="algx2.l28.m1.1.1.3.1a" xref="algx2.l28.m1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l28.m1.1.1.3.4" xref="algx2.l28.m1.1.1.3.4.cmml">o</mi><mo id="algx2.l28.m1.1.1.3.1b" xref="algx2.l28.m1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l28.m1.1.1.3.5" xref="algx2.l28.m1.1.1.3.5.cmml">s</mi><mo id="algx2.l28.m1.1.1.3.1c" xref="algx2.l28.m1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l28.m1.1.1.3.6" xref="algx2.l28.m1.1.1.3.6.cmml">s</mi><mo id="algx2.l28.m1.1.1.3.1d" xref="algx2.l28.m1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l28.m1.1.1.3.7" xref="algx2.l28.m1.1.1.3.7.cmml">M</mi><mo id="algx2.l28.m1.1.1.3.1e" xref="algx2.l28.m1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l28.m1.1.1.3.8" xref="algx2.l28.m1.1.1.3.8.cmml">o</mi><mo id="algx2.l28.m1.1.1.3.1f" xref="algx2.l28.m1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l28.m1.1.1.3.9" xref="algx2.l28.m1.1.1.3.9.cmml">d</mi><mo id="algx2.l28.m1.1.1.3.1g" xref="algx2.l28.m1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l28.m1.1.1.3.10" xref="algx2.l28.m1.1.1.3.10.cmml">a</mi><mo id="algx2.l28.m1.1.1.3.1h" xref="algx2.l28.m1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l28.m1.1.1.3.11" xref="algx2.l28.m1.1.1.3.11.cmml">l</mi><mo id="algx2.l28.m1.1.1.3.1i" xref="algx2.l28.m1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l28.m1.1.1.3.12" xref="algx2.l28.m1.1.1.3.12.cmml">O</mi><mo id="algx2.l28.m1.1.1.3.1j" xref="algx2.l28.m1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l28.m1.1.1.3.13" xref="algx2.l28.m1.1.1.3.13.cmml">u</mi><mo id="algx2.l28.m1.1.1.3.1k" xref="algx2.l28.m1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l28.m1.1.1.3.14" xref="algx2.l28.m1.1.1.3.14.cmml">t</mi><mo id="algx2.l28.m1.1.1.3.1l" xref="algx2.l28.m1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l28.m1.1.1.3.15" xref="algx2.l28.m1.1.1.3.15.cmml">p</mi><mo id="algx2.l28.m1.1.1.3.1m" xref="algx2.l28.m1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l28.m1.1.1.3.16" xref="algx2.l28.m1.1.1.3.16.cmml">u</mi><mo id="algx2.l28.m1.1.1.3.1n" xref="algx2.l28.m1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l28.m1.1.1.3.17" xref="algx2.l28.m1.1.1.3.17.cmml">t</mi></mrow><mo id="algx2.l28.m1.1.1.2" stretchy="false" xref="algx2.l28.m1.1.1.2.cmml">←</mo><mrow id="algx2.l28.m1.1.1.1" xref="algx2.l28.m1.1.1.1.cmml"><mtext id="algx2.l28.m1.1.1.1.3" xref="algx2.l28.m1.1.1.1.3a.cmml">LayerNorm</mtext><mo id="algx2.l28.m1.1.1.1.2" xref="algx2.l28.m1.1.1.1.2.cmml">⁢</mo><mrow id="algx2.l28.m1.1.1.1.1.1" xref="algx2.l28.m1.1.1.1.1.1.1.cmml"><mo id="algx2.l28.m1.1.1.1.1.1.2" stretchy="false" xref="algx2.l28.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="algx2.l28.m1.1.1.1.1.1.1" xref="algx2.l28.m1.1.1.1.1.1.1.cmml"><mrow id="algx2.l28.m1.1.1.1.1.1.1.2" xref="algx2.l28.m1.1.1.1.1.1.1.2.cmml"><mrow id="algx2.l28.m1.1.1.1.1.1.1.2.2" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.cmml"><mi id="algx2.l28.m1.1.1.1.1.1.1.2.2.2" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.2.cmml">C</mi><mo id="algx2.l28.m1.1.1.1.1.1.1.2.2.1" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="algx2.l28.m1.1.1.1.1.1.1.2.2.3" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.3.cmml">o</mi><mo id="algx2.l28.m1.1.1.1.1.1.1.2.2.1a" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="algx2.l28.m1.1.1.1.1.1.1.2.2.4" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.4.cmml">n</mi><mo id="algx2.l28.m1.1.1.1.1.1.1.2.2.1b" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="algx2.l28.m1.1.1.1.1.1.1.2.2.5" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.5.cmml">c</mi><mo id="algx2.l28.m1.1.1.1.1.1.1.2.2.1c" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="algx2.l28.m1.1.1.1.1.1.1.2.2.6" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.6.cmml">a</mi><mo id="algx2.l28.m1.1.1.1.1.1.1.2.2.1d" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="algx2.l28.m1.1.1.1.1.1.1.2.2.7" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.7.cmml">t</mi><mo id="algx2.l28.m1.1.1.1.1.1.1.2.2.1e" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="algx2.l28.m1.1.1.1.1.1.1.2.2.8" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.8.cmml">C</mi><mo id="algx2.l28.m1.1.1.1.1.1.1.2.2.1f" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="algx2.l28.m1.1.1.1.1.1.1.2.2.9" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.9.cmml">r</mi><mo id="algx2.l28.m1.1.1.1.1.1.1.2.2.1g" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="algx2.l28.m1.1.1.1.1.1.1.2.2.10" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.10.cmml">o</mi><mo id="algx2.l28.m1.1.1.1.1.1.1.2.2.1h" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="algx2.l28.m1.1.1.1.1.1.1.2.2.11" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.11.cmml">s</mi><mo id="algx2.l28.m1.1.1.1.1.1.1.2.2.1i" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="algx2.l28.m1.1.1.1.1.1.1.2.2.12" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.12.cmml">s</mi><mo id="algx2.l28.m1.1.1.1.1.1.1.2.2.1j" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="algx2.l28.m1.1.1.1.1.1.1.2.2.13" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.13.cmml">M</mi><mo id="algx2.l28.m1.1.1.1.1.1.1.2.2.1k" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="algx2.l28.m1.1.1.1.1.1.1.2.2.14" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.14.cmml">o</mi><mo id="algx2.l28.m1.1.1.1.1.1.1.2.2.1l" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="algx2.l28.m1.1.1.1.1.1.1.2.2.15" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.15.cmml">d</mi><mo id="algx2.l28.m1.1.1.1.1.1.1.2.2.1m" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="algx2.l28.m1.1.1.1.1.1.1.2.2.16" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.16.cmml">a</mi><mo id="algx2.l28.m1.1.1.1.1.1.1.2.2.1n" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="algx2.l28.m1.1.1.1.1.1.1.2.2.17" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.17.cmml">l</mi><mo id="algx2.l28.m1.1.1.1.1.1.1.2.2.1o" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="algx2.l28.m1.1.1.1.1.1.1.2.2.18" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.18.cmml">A</mi><mo id="algx2.l28.m1.1.1.1.1.1.1.2.2.1p" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="algx2.l28.m1.1.1.1.1.1.1.2.2.19" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.19.cmml">t</mi><mo id="algx2.l28.m1.1.1.1.1.1.1.2.2.1q" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="algx2.l28.m1.1.1.1.1.1.1.2.2.20" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.20.cmml">t</mi><mo id="algx2.l28.m1.1.1.1.1.1.1.2.2.1r" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="algx2.l28.m1.1.1.1.1.1.1.2.2.21" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.21.cmml">e</mi><mo id="algx2.l28.m1.1.1.1.1.1.1.2.2.1s" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="algx2.l28.m1.1.1.1.1.1.1.2.2.22" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.22.cmml">n</mi><mo id="algx2.l28.m1.1.1.1.1.1.1.2.2.1t" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="algx2.l28.m1.1.1.1.1.1.1.2.2.23" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.23.cmml">t</mi><mo id="algx2.l28.m1.1.1.1.1.1.1.2.2.1u" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="algx2.l28.m1.1.1.1.1.1.1.2.2.24" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.24.cmml">i</mi><mo id="algx2.l28.m1.1.1.1.1.1.1.2.2.1v" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="algx2.l28.m1.1.1.1.1.1.1.2.2.25" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.25.cmml">o</mi><mo id="algx2.l28.m1.1.1.1.1.1.1.2.2.1w" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="algx2.l28.m1.1.1.1.1.1.1.2.2.26" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.26.cmml">n</mi></mrow><mo id="algx2.l28.m1.1.1.1.1.1.1.2.1" lspace="0.222em" rspace="0.222em" xref="algx2.l28.m1.1.1.1.1.1.1.2.1.cmml">⋅</mo><msub id="algx2.l28.m1.1.1.1.1.1.1.2.3" xref="algx2.l28.m1.1.1.1.1.1.1.2.3.cmml"><mi id="algx2.l28.m1.1.1.1.1.1.1.2.3.2" xref="algx2.l28.m1.1.1.1.1.1.1.2.3.2.cmml">W</mi><mi id="algx2.l28.m1.1.1.1.1.1.1.2.3.3" xref="algx2.l28.m1.1.1.1.1.1.1.2.3.3.cmml">O</mi></msub></mrow><mo id="algx2.l28.m1.1.1.1.1.1.1.1" xref="algx2.l28.m1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="algx2.l28.m1.1.1.1.1.1.1.3" xref="algx2.l28.m1.1.1.1.1.1.1.3.cmml"><mi id="algx2.l28.m1.1.1.1.1.1.1.3.2" xref="algx2.l28.m1.1.1.1.1.1.1.3.2.cmml">S</mi><mo id="algx2.l28.m1.1.1.1.1.1.1.3.1" xref="algx2.l28.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l28.m1.1.1.1.1.1.1.3.3" xref="algx2.l28.m1.1.1.1.1.1.1.3.3.cmml">e</mi><mo id="algx2.l28.m1.1.1.1.1.1.1.3.1a" xref="algx2.l28.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l28.m1.1.1.1.1.1.1.3.4" xref="algx2.l28.m1.1.1.1.1.1.1.3.4.cmml">l</mi><mo id="algx2.l28.m1.1.1.1.1.1.1.3.1b" xref="algx2.l28.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l28.m1.1.1.1.1.1.1.3.5" xref="algx2.l28.m1.1.1.1.1.1.1.3.5.cmml">f</mi><mo id="algx2.l28.m1.1.1.1.1.1.1.3.1c" xref="algx2.l28.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l28.m1.1.1.1.1.1.1.3.6" xref="algx2.l28.m1.1.1.1.1.1.1.3.6.cmml">A</mi><mo id="algx2.l28.m1.1.1.1.1.1.1.3.1d" xref="algx2.l28.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l28.m1.1.1.1.1.1.1.3.7" xref="algx2.l28.m1.1.1.1.1.1.1.3.7.cmml">t</mi><mo id="algx2.l28.m1.1.1.1.1.1.1.3.1e" xref="algx2.l28.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l28.m1.1.1.1.1.1.1.3.8" xref="algx2.l28.m1.1.1.1.1.1.1.3.8.cmml">t</mi><mo id="algx2.l28.m1.1.1.1.1.1.1.3.1f" xref="algx2.l28.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l28.m1.1.1.1.1.1.1.3.9" xref="algx2.l28.m1.1.1.1.1.1.1.3.9.cmml">e</mi><mo id="algx2.l28.m1.1.1.1.1.1.1.3.1g" xref="algx2.l28.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l28.m1.1.1.1.1.1.1.3.10" xref="algx2.l28.m1.1.1.1.1.1.1.3.10.cmml">n</mi><mo id="algx2.l28.m1.1.1.1.1.1.1.3.1h" xref="algx2.l28.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l28.m1.1.1.1.1.1.1.3.11" xref="algx2.l28.m1.1.1.1.1.1.1.3.11.cmml">t</mi><mo id="algx2.l28.m1.1.1.1.1.1.1.3.1i" xref="algx2.l28.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l28.m1.1.1.1.1.1.1.3.12" xref="algx2.l28.m1.1.1.1.1.1.1.3.12.cmml">i</mi><mo id="algx2.l28.m1.1.1.1.1.1.1.3.1j" xref="algx2.l28.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l28.m1.1.1.1.1.1.1.3.13" xref="algx2.l28.m1.1.1.1.1.1.1.3.13.cmml">o</mi><mo id="algx2.l28.m1.1.1.1.1.1.1.3.1k" xref="algx2.l28.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l28.m1.1.1.1.1.1.1.3.14" xref="algx2.l28.m1.1.1.1.1.1.1.3.14.cmml">n</mi><mo id="algx2.l28.m1.1.1.1.1.1.1.3.1l" xref="algx2.l28.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l28.m1.1.1.1.1.1.1.3.15" xref="algx2.l28.m1.1.1.1.1.1.1.3.15.cmml">O</mi><mo id="algx2.l28.m1.1.1.1.1.1.1.3.1m" xref="algx2.l28.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l28.m1.1.1.1.1.1.1.3.16" xref="algx2.l28.m1.1.1.1.1.1.1.3.16.cmml">u</mi><mo id="algx2.l28.m1.1.1.1.1.1.1.3.1n" xref="algx2.l28.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l28.m1.1.1.1.1.1.1.3.17" xref="algx2.l28.m1.1.1.1.1.1.1.3.17.cmml">t</mi><mo id="algx2.l28.m1.1.1.1.1.1.1.3.1o" xref="algx2.l28.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l28.m1.1.1.1.1.1.1.3.18" xref="algx2.l28.m1.1.1.1.1.1.1.3.18.cmml">p</mi><mo id="algx2.l28.m1.1.1.1.1.1.1.3.1p" xref="algx2.l28.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l28.m1.1.1.1.1.1.1.3.19" xref="algx2.l28.m1.1.1.1.1.1.1.3.19.cmml">u</mi><mo id="algx2.l28.m1.1.1.1.1.1.1.3.1q" xref="algx2.l28.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><msub id="algx2.l28.m1.1.1.1.1.1.1.3.20" xref="algx2.l28.m1.1.1.1.1.1.1.3.20.cmml"><mi id="algx2.l28.m1.1.1.1.1.1.1.3.20.2" xref="algx2.l28.m1.1.1.1.1.1.1.3.20.2.cmml">t</mi><mi id="algx2.l28.m1.1.1.1.1.1.1.3.20.3" xref="algx2.l28.m1.1.1.1.1.1.1.3.20.3.cmml">a</mi></msub></mrow></mrow><mo id="algx2.l28.m1.1.1.1.1.1.3" stretchy="false" xref="algx2.l28.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx2.l28.m1.1b"><apply id="algx2.l28.m1.1.1.cmml" xref="algx2.l28.m1.1.1"><ci id="algx2.l28.m1.1.1.2.cmml" xref="algx2.l28.m1.1.1.2">←</ci><apply id="algx2.l28.m1.1.1.3.cmml" xref="algx2.l28.m1.1.1.3"><times id="algx2.l28.m1.1.1.3.1.cmml" xref="algx2.l28.m1.1.1.3.1"></times><ci id="algx2.l28.m1.1.1.3.2.cmml" xref="algx2.l28.m1.1.1.3.2">𝐶</ci><ci id="algx2.l28.m1.1.1.3.3.cmml" xref="algx2.l28.m1.1.1.3.3">𝑟</ci><ci id="algx2.l28.m1.1.1.3.4.cmml" xref="algx2.l28.m1.1.1.3.4">𝑜</ci><ci id="algx2.l28.m1.1.1.3.5.cmml" xref="algx2.l28.m1.1.1.3.5">𝑠</ci><ci id="algx2.l28.m1.1.1.3.6.cmml" xref="algx2.l28.m1.1.1.3.6">𝑠</ci><ci id="algx2.l28.m1.1.1.3.7.cmml" xref="algx2.l28.m1.1.1.3.7">𝑀</ci><ci id="algx2.l28.m1.1.1.3.8.cmml" xref="algx2.l28.m1.1.1.3.8">𝑜</ci><ci id="algx2.l28.m1.1.1.3.9.cmml" xref="algx2.l28.m1.1.1.3.9">𝑑</ci><ci id="algx2.l28.m1.1.1.3.10.cmml" xref="algx2.l28.m1.1.1.3.10">𝑎</ci><ci id="algx2.l28.m1.1.1.3.11.cmml" xref="algx2.l28.m1.1.1.3.11">𝑙</ci><ci id="algx2.l28.m1.1.1.3.12.cmml" xref="algx2.l28.m1.1.1.3.12">𝑂</ci><ci id="algx2.l28.m1.1.1.3.13.cmml" xref="algx2.l28.m1.1.1.3.13">𝑢</ci><ci id="algx2.l28.m1.1.1.3.14.cmml" xref="algx2.l28.m1.1.1.3.14">𝑡</ci><ci id="algx2.l28.m1.1.1.3.15.cmml" xref="algx2.l28.m1.1.1.3.15">𝑝</ci><ci id="algx2.l28.m1.1.1.3.16.cmml" xref="algx2.l28.m1.1.1.3.16">𝑢</ci><ci id="algx2.l28.m1.1.1.3.17.cmml" xref="algx2.l28.m1.1.1.3.17">𝑡</ci></apply><apply id="algx2.l28.m1.1.1.1.cmml" xref="algx2.l28.m1.1.1.1"><times id="algx2.l28.m1.1.1.1.2.cmml" xref="algx2.l28.m1.1.1.1.2"></times><ci id="algx2.l28.m1.1.1.1.3a.cmml" xref="algx2.l28.m1.1.1.1.3"><mtext id="algx2.l28.m1.1.1.1.3.cmml" xref="algx2.l28.m1.1.1.1.3">LayerNorm</mtext></ci><apply id="algx2.l28.m1.1.1.1.1.1.1.cmml" xref="algx2.l28.m1.1.1.1.1.1"><plus id="algx2.l28.m1.1.1.1.1.1.1.1.cmml" xref="algx2.l28.m1.1.1.1.1.1.1.1"></plus><apply id="algx2.l28.m1.1.1.1.1.1.1.2.cmml" xref="algx2.l28.m1.1.1.1.1.1.1.2"><ci id="algx2.l28.m1.1.1.1.1.1.1.2.1.cmml" xref="algx2.l28.m1.1.1.1.1.1.1.2.1">⋅</ci><apply id="algx2.l28.m1.1.1.1.1.1.1.2.2.cmml" xref="algx2.l28.m1.1.1.1.1.1.1.2.2"><times id="algx2.l28.m1.1.1.1.1.1.1.2.2.1.cmml" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.1"></times><ci id="algx2.l28.m1.1.1.1.1.1.1.2.2.2.cmml" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.2">𝐶</ci><ci id="algx2.l28.m1.1.1.1.1.1.1.2.2.3.cmml" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.3">𝑜</ci><ci id="algx2.l28.m1.1.1.1.1.1.1.2.2.4.cmml" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.4">𝑛</ci><ci id="algx2.l28.m1.1.1.1.1.1.1.2.2.5.cmml" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.5">𝑐</ci><ci id="algx2.l28.m1.1.1.1.1.1.1.2.2.6.cmml" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.6">𝑎</ci><ci id="algx2.l28.m1.1.1.1.1.1.1.2.2.7.cmml" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.7">𝑡</ci><ci id="algx2.l28.m1.1.1.1.1.1.1.2.2.8.cmml" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.8">𝐶</ci><ci id="algx2.l28.m1.1.1.1.1.1.1.2.2.9.cmml" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.9">𝑟</ci><ci id="algx2.l28.m1.1.1.1.1.1.1.2.2.10.cmml" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.10">𝑜</ci><ci id="algx2.l28.m1.1.1.1.1.1.1.2.2.11.cmml" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.11">𝑠</ci><ci id="algx2.l28.m1.1.1.1.1.1.1.2.2.12.cmml" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.12">𝑠</ci><ci id="algx2.l28.m1.1.1.1.1.1.1.2.2.13.cmml" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.13">𝑀</ci><ci id="algx2.l28.m1.1.1.1.1.1.1.2.2.14.cmml" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.14">𝑜</ci><ci id="algx2.l28.m1.1.1.1.1.1.1.2.2.15.cmml" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.15">𝑑</ci><ci id="algx2.l28.m1.1.1.1.1.1.1.2.2.16.cmml" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.16">𝑎</ci><ci id="algx2.l28.m1.1.1.1.1.1.1.2.2.17.cmml" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.17">𝑙</ci><ci id="algx2.l28.m1.1.1.1.1.1.1.2.2.18.cmml" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.18">𝐴</ci><ci id="algx2.l28.m1.1.1.1.1.1.1.2.2.19.cmml" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.19">𝑡</ci><ci id="algx2.l28.m1.1.1.1.1.1.1.2.2.20.cmml" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.20">𝑡</ci><ci id="algx2.l28.m1.1.1.1.1.1.1.2.2.21.cmml" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.21">𝑒</ci><ci id="algx2.l28.m1.1.1.1.1.1.1.2.2.22.cmml" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.22">𝑛</ci><ci id="algx2.l28.m1.1.1.1.1.1.1.2.2.23.cmml" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.23">𝑡</ci><ci id="algx2.l28.m1.1.1.1.1.1.1.2.2.24.cmml" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.24">𝑖</ci><ci id="algx2.l28.m1.1.1.1.1.1.1.2.2.25.cmml" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.25">𝑜</ci><ci id="algx2.l28.m1.1.1.1.1.1.1.2.2.26.cmml" xref="algx2.l28.m1.1.1.1.1.1.1.2.2.26">𝑛</ci></apply><apply id="algx2.l28.m1.1.1.1.1.1.1.2.3.cmml" xref="algx2.l28.m1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="algx2.l28.m1.1.1.1.1.1.1.2.3.1.cmml" xref="algx2.l28.m1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="algx2.l28.m1.1.1.1.1.1.1.2.3.2.cmml" xref="algx2.l28.m1.1.1.1.1.1.1.2.3.2">𝑊</ci><ci id="algx2.l28.m1.1.1.1.1.1.1.2.3.3.cmml" xref="algx2.l28.m1.1.1.1.1.1.1.2.3.3">𝑂</ci></apply></apply><apply id="algx2.l28.m1.1.1.1.1.1.1.3.cmml" xref="algx2.l28.m1.1.1.1.1.1.1.3"><times id="algx2.l28.m1.1.1.1.1.1.1.3.1.cmml" xref="algx2.l28.m1.1.1.1.1.1.1.3.1"></times><ci id="algx2.l28.m1.1.1.1.1.1.1.3.2.cmml" xref="algx2.l28.m1.1.1.1.1.1.1.3.2">𝑆</ci><ci id="algx2.l28.m1.1.1.1.1.1.1.3.3.cmml" xref="algx2.l28.m1.1.1.1.1.1.1.3.3">𝑒</ci><ci id="algx2.l28.m1.1.1.1.1.1.1.3.4.cmml" xref="algx2.l28.m1.1.1.1.1.1.1.3.4">𝑙</ci><ci id="algx2.l28.m1.1.1.1.1.1.1.3.5.cmml" xref="algx2.l28.m1.1.1.1.1.1.1.3.5">𝑓</ci><ci id="algx2.l28.m1.1.1.1.1.1.1.3.6.cmml" xref="algx2.l28.m1.1.1.1.1.1.1.3.6">𝐴</ci><ci id="algx2.l28.m1.1.1.1.1.1.1.3.7.cmml" xref="algx2.l28.m1.1.1.1.1.1.1.3.7">𝑡</ci><ci id="algx2.l28.m1.1.1.1.1.1.1.3.8.cmml" xref="algx2.l28.m1.1.1.1.1.1.1.3.8">𝑡</ci><ci id="algx2.l28.m1.1.1.1.1.1.1.3.9.cmml" xref="algx2.l28.m1.1.1.1.1.1.1.3.9">𝑒</ci><ci id="algx2.l28.m1.1.1.1.1.1.1.3.10.cmml" xref="algx2.l28.m1.1.1.1.1.1.1.3.10">𝑛</ci><ci id="algx2.l28.m1.1.1.1.1.1.1.3.11.cmml" xref="algx2.l28.m1.1.1.1.1.1.1.3.11">𝑡</ci><ci id="algx2.l28.m1.1.1.1.1.1.1.3.12.cmml" xref="algx2.l28.m1.1.1.1.1.1.1.3.12">𝑖</ci><ci id="algx2.l28.m1.1.1.1.1.1.1.3.13.cmml" xref="algx2.l28.m1.1.1.1.1.1.1.3.13">𝑜</ci><ci id="algx2.l28.m1.1.1.1.1.1.1.3.14.cmml" xref="algx2.l28.m1.1.1.1.1.1.1.3.14">𝑛</ci><ci id="algx2.l28.m1.1.1.1.1.1.1.3.15.cmml" xref="algx2.l28.m1.1.1.1.1.1.1.3.15">𝑂</ci><ci id="algx2.l28.m1.1.1.1.1.1.1.3.16.cmml" xref="algx2.l28.m1.1.1.1.1.1.1.3.16">𝑢</ci><ci id="algx2.l28.m1.1.1.1.1.1.1.3.17.cmml" xref="algx2.l28.m1.1.1.1.1.1.1.3.17">𝑡</ci><ci id="algx2.l28.m1.1.1.1.1.1.1.3.18.cmml" xref="algx2.l28.m1.1.1.1.1.1.1.3.18">𝑝</ci><ci id="algx2.l28.m1.1.1.1.1.1.1.3.19.cmml" xref="algx2.l28.m1.1.1.1.1.1.1.3.19">𝑢</ci><apply id="algx2.l28.m1.1.1.1.1.1.1.3.20.cmml" xref="algx2.l28.m1.1.1.1.1.1.1.3.20"><csymbol cd="ambiguous" id="algx2.l28.m1.1.1.1.1.1.1.3.20.1.cmml" xref="algx2.l28.m1.1.1.1.1.1.1.3.20">subscript</csymbol><ci id="algx2.l28.m1.1.1.1.1.1.1.3.20.2.cmml" xref="algx2.l28.m1.1.1.1.1.1.1.3.20.2">𝑡</ci><ci id="algx2.l28.m1.1.1.1.1.1.1.3.20.3.cmml" xref="algx2.l28.m1.1.1.1.1.1.1.3.20.3">𝑎</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx2.l28.m1.1c">CrossModalOutput\leftarrow\text{LayerNorm}(ConcatCrossModalAttention\cdot W_{O%
}+SelfAttentionOutput_{a})</annotation><annotation encoding="application/x-llamapun" id="algx2.l28.m1.1d">italic_C italic_r italic_o italic_s italic_s italic_M italic_o italic_d italic_a italic_l italic_O italic_u italic_t italic_p italic_u italic_t ← LayerNorm ( italic_C italic_o italic_n italic_c italic_a italic_t italic_C italic_r italic_o italic_s italic_s italic_M italic_o italic_d italic_a italic_l italic_A italic_t italic_t italic_e italic_n italic_t italic_i italic_o italic_n ⋅ italic_W start_POSTSUBSCRIPT italic_O end_POSTSUBSCRIPT + italic_S italic_e italic_l italic_f italic_A italic_t italic_t italic_e italic_n italic_t italic_i italic_o italic_n italic_O italic_u italic_t italic_p italic_u italic_t start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algx2.l29">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algx2.l29.1.1.1" style="font-size:80%;">29:</span></span>  // Feed forward network

</div>
<div class="ltx_listingline" id="algx2.l30">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algx2.l30.1.1.1" style="font-size:80%;">30:</span></span>  <math alttext="W_{1}\leftarrow\text{InitializeWeights}(d_{\text{model}},d_{\text{ff}})" class="ltx_Math" display="inline" id="algx2.l30.m1.2"><semantics id="algx2.l30.m1.2a"><mrow id="algx2.l30.m1.2.2" xref="algx2.l30.m1.2.2.cmml"><msub id="algx2.l30.m1.2.2.4" xref="algx2.l30.m1.2.2.4.cmml"><mi id="algx2.l30.m1.2.2.4.2" xref="algx2.l30.m1.2.2.4.2.cmml">W</mi><mn id="algx2.l30.m1.2.2.4.3" xref="algx2.l30.m1.2.2.4.3.cmml">1</mn></msub><mo id="algx2.l30.m1.2.2.3" stretchy="false" xref="algx2.l30.m1.2.2.3.cmml">←</mo><mrow id="algx2.l30.m1.2.2.2" xref="algx2.l30.m1.2.2.2.cmml"><mtext id="algx2.l30.m1.2.2.2.4" xref="algx2.l30.m1.2.2.2.4a.cmml">InitializeWeights</mtext><mo id="algx2.l30.m1.2.2.2.3" xref="algx2.l30.m1.2.2.2.3.cmml">⁢</mo><mrow id="algx2.l30.m1.2.2.2.2.2" xref="algx2.l30.m1.2.2.2.2.3.cmml"><mo id="algx2.l30.m1.2.2.2.2.2.3" stretchy="false" xref="algx2.l30.m1.2.2.2.2.3.cmml">(</mo><msub id="algx2.l30.m1.1.1.1.1.1.1" xref="algx2.l30.m1.1.1.1.1.1.1.cmml"><mi id="algx2.l30.m1.1.1.1.1.1.1.2" xref="algx2.l30.m1.1.1.1.1.1.1.2.cmml">d</mi><mtext id="algx2.l30.m1.1.1.1.1.1.1.3" xref="algx2.l30.m1.1.1.1.1.1.1.3a.cmml">model</mtext></msub><mo id="algx2.l30.m1.2.2.2.2.2.4" xref="algx2.l30.m1.2.2.2.2.3.cmml">,</mo><msub id="algx2.l30.m1.2.2.2.2.2.2" xref="algx2.l30.m1.2.2.2.2.2.2.cmml"><mi id="algx2.l30.m1.2.2.2.2.2.2.2" xref="algx2.l30.m1.2.2.2.2.2.2.2.cmml">d</mi><mtext id="algx2.l30.m1.2.2.2.2.2.2.3" xref="algx2.l30.m1.2.2.2.2.2.2.3a.cmml">ff</mtext></msub><mo id="algx2.l30.m1.2.2.2.2.2.5" stretchy="false" xref="algx2.l30.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx2.l30.m1.2b"><apply id="algx2.l30.m1.2.2.cmml" xref="algx2.l30.m1.2.2"><ci id="algx2.l30.m1.2.2.3.cmml" xref="algx2.l30.m1.2.2.3">←</ci><apply id="algx2.l30.m1.2.2.4.cmml" xref="algx2.l30.m1.2.2.4"><csymbol cd="ambiguous" id="algx2.l30.m1.2.2.4.1.cmml" xref="algx2.l30.m1.2.2.4">subscript</csymbol><ci id="algx2.l30.m1.2.2.4.2.cmml" xref="algx2.l30.m1.2.2.4.2">𝑊</ci><cn id="algx2.l30.m1.2.2.4.3.cmml" type="integer" xref="algx2.l30.m1.2.2.4.3">1</cn></apply><apply id="algx2.l30.m1.2.2.2.cmml" xref="algx2.l30.m1.2.2.2"><times id="algx2.l30.m1.2.2.2.3.cmml" xref="algx2.l30.m1.2.2.2.3"></times><ci id="algx2.l30.m1.2.2.2.4a.cmml" xref="algx2.l30.m1.2.2.2.4"><mtext id="algx2.l30.m1.2.2.2.4.cmml" xref="algx2.l30.m1.2.2.2.4">InitializeWeights</mtext></ci><interval closure="open" id="algx2.l30.m1.2.2.2.2.3.cmml" xref="algx2.l30.m1.2.2.2.2.2"><apply id="algx2.l30.m1.1.1.1.1.1.1.cmml" xref="algx2.l30.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algx2.l30.m1.1.1.1.1.1.1.1.cmml" xref="algx2.l30.m1.1.1.1.1.1.1">subscript</csymbol><ci id="algx2.l30.m1.1.1.1.1.1.1.2.cmml" xref="algx2.l30.m1.1.1.1.1.1.1.2">𝑑</ci><ci id="algx2.l30.m1.1.1.1.1.1.1.3a.cmml" xref="algx2.l30.m1.1.1.1.1.1.1.3"><mtext id="algx2.l30.m1.1.1.1.1.1.1.3.cmml" mathsize="70%" xref="algx2.l30.m1.1.1.1.1.1.1.3">model</mtext></ci></apply><apply id="algx2.l30.m1.2.2.2.2.2.2.cmml" xref="algx2.l30.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="algx2.l30.m1.2.2.2.2.2.2.1.cmml" xref="algx2.l30.m1.2.2.2.2.2.2">subscript</csymbol><ci id="algx2.l30.m1.2.2.2.2.2.2.2.cmml" xref="algx2.l30.m1.2.2.2.2.2.2.2">𝑑</ci><ci id="algx2.l30.m1.2.2.2.2.2.2.3a.cmml" xref="algx2.l30.m1.2.2.2.2.2.2.3"><mtext id="algx2.l30.m1.2.2.2.2.2.2.3.cmml" mathsize="70%" xref="algx2.l30.m1.2.2.2.2.2.2.3">ff</mtext></ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx2.l30.m1.2c">W_{1}\leftarrow\text{InitializeWeights}(d_{\text{model}},d_{\text{ff}})</annotation><annotation encoding="application/x-llamapun" id="algx2.l30.m1.2d">italic_W start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ← InitializeWeights ( italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT , italic_d start_POSTSUBSCRIPT ff end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algx2.l31">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algx2.l31.1.1.1" style="font-size:80%;">31:</span></span>  <math alttext="W_{2}\leftarrow\text{InitializeWeights}(d_{\text{ff}},d_{\text{model}})" class="ltx_Math" display="inline" id="algx2.l31.m1.2"><semantics id="algx2.l31.m1.2a"><mrow id="algx2.l31.m1.2.2" xref="algx2.l31.m1.2.2.cmml"><msub id="algx2.l31.m1.2.2.4" xref="algx2.l31.m1.2.2.4.cmml"><mi id="algx2.l31.m1.2.2.4.2" xref="algx2.l31.m1.2.2.4.2.cmml">W</mi><mn id="algx2.l31.m1.2.2.4.3" xref="algx2.l31.m1.2.2.4.3.cmml">2</mn></msub><mo id="algx2.l31.m1.2.2.3" stretchy="false" xref="algx2.l31.m1.2.2.3.cmml">←</mo><mrow id="algx2.l31.m1.2.2.2" xref="algx2.l31.m1.2.2.2.cmml"><mtext id="algx2.l31.m1.2.2.2.4" xref="algx2.l31.m1.2.2.2.4a.cmml">InitializeWeights</mtext><mo id="algx2.l31.m1.2.2.2.3" xref="algx2.l31.m1.2.2.2.3.cmml">⁢</mo><mrow id="algx2.l31.m1.2.2.2.2.2" xref="algx2.l31.m1.2.2.2.2.3.cmml"><mo id="algx2.l31.m1.2.2.2.2.2.3" stretchy="false" xref="algx2.l31.m1.2.2.2.2.3.cmml">(</mo><msub id="algx2.l31.m1.1.1.1.1.1.1" xref="algx2.l31.m1.1.1.1.1.1.1.cmml"><mi id="algx2.l31.m1.1.1.1.1.1.1.2" xref="algx2.l31.m1.1.1.1.1.1.1.2.cmml">d</mi><mtext id="algx2.l31.m1.1.1.1.1.1.1.3" xref="algx2.l31.m1.1.1.1.1.1.1.3a.cmml">ff</mtext></msub><mo id="algx2.l31.m1.2.2.2.2.2.4" xref="algx2.l31.m1.2.2.2.2.3.cmml">,</mo><msub id="algx2.l31.m1.2.2.2.2.2.2" xref="algx2.l31.m1.2.2.2.2.2.2.cmml"><mi id="algx2.l31.m1.2.2.2.2.2.2.2" xref="algx2.l31.m1.2.2.2.2.2.2.2.cmml">d</mi><mtext id="algx2.l31.m1.2.2.2.2.2.2.3" xref="algx2.l31.m1.2.2.2.2.2.2.3a.cmml">model</mtext></msub><mo id="algx2.l31.m1.2.2.2.2.2.5" stretchy="false" xref="algx2.l31.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx2.l31.m1.2b"><apply id="algx2.l31.m1.2.2.cmml" xref="algx2.l31.m1.2.2"><ci id="algx2.l31.m1.2.2.3.cmml" xref="algx2.l31.m1.2.2.3">←</ci><apply id="algx2.l31.m1.2.2.4.cmml" xref="algx2.l31.m1.2.2.4"><csymbol cd="ambiguous" id="algx2.l31.m1.2.2.4.1.cmml" xref="algx2.l31.m1.2.2.4">subscript</csymbol><ci id="algx2.l31.m1.2.2.4.2.cmml" xref="algx2.l31.m1.2.2.4.2">𝑊</ci><cn id="algx2.l31.m1.2.2.4.3.cmml" type="integer" xref="algx2.l31.m1.2.2.4.3">2</cn></apply><apply id="algx2.l31.m1.2.2.2.cmml" xref="algx2.l31.m1.2.2.2"><times id="algx2.l31.m1.2.2.2.3.cmml" xref="algx2.l31.m1.2.2.2.3"></times><ci id="algx2.l31.m1.2.2.2.4a.cmml" xref="algx2.l31.m1.2.2.2.4"><mtext id="algx2.l31.m1.2.2.2.4.cmml" xref="algx2.l31.m1.2.2.2.4">InitializeWeights</mtext></ci><interval closure="open" id="algx2.l31.m1.2.2.2.2.3.cmml" xref="algx2.l31.m1.2.2.2.2.2"><apply id="algx2.l31.m1.1.1.1.1.1.1.cmml" xref="algx2.l31.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algx2.l31.m1.1.1.1.1.1.1.1.cmml" xref="algx2.l31.m1.1.1.1.1.1.1">subscript</csymbol><ci id="algx2.l31.m1.1.1.1.1.1.1.2.cmml" xref="algx2.l31.m1.1.1.1.1.1.1.2">𝑑</ci><ci id="algx2.l31.m1.1.1.1.1.1.1.3a.cmml" xref="algx2.l31.m1.1.1.1.1.1.1.3"><mtext id="algx2.l31.m1.1.1.1.1.1.1.3.cmml" mathsize="70%" xref="algx2.l31.m1.1.1.1.1.1.1.3">ff</mtext></ci></apply><apply id="algx2.l31.m1.2.2.2.2.2.2.cmml" xref="algx2.l31.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="algx2.l31.m1.2.2.2.2.2.2.1.cmml" xref="algx2.l31.m1.2.2.2.2.2.2">subscript</csymbol><ci id="algx2.l31.m1.2.2.2.2.2.2.2.cmml" xref="algx2.l31.m1.2.2.2.2.2.2.2">𝑑</ci><ci id="algx2.l31.m1.2.2.2.2.2.2.3a.cmml" xref="algx2.l31.m1.2.2.2.2.2.2.3"><mtext id="algx2.l31.m1.2.2.2.2.2.2.3.cmml" mathsize="70%" xref="algx2.l31.m1.2.2.2.2.2.2.3">model</mtext></ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx2.l31.m1.2c">W_{2}\leftarrow\text{InitializeWeights}(d_{\text{ff}},d_{\text{model}})</annotation><annotation encoding="application/x-llamapun" id="algx2.l31.m1.2d">italic_W start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ← InitializeWeights ( italic_d start_POSTSUBSCRIPT ff end_POSTSUBSCRIPT , italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algx2.l32">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algx2.l32.1.1.1" style="font-size:80%;">32:</span></span>  <math alttext="FFNOutput\leftarrow\text{ReLU}(CrossModalOutput\cdot W_{1})" class="ltx_Math" display="inline" id="algx2.l32.m1.1"><semantics id="algx2.l32.m1.1a"><mrow id="algx2.l32.m1.1.1" xref="algx2.l32.m1.1.1.cmml"><mrow id="algx2.l32.m1.1.1.3" xref="algx2.l32.m1.1.1.3.cmml"><mi id="algx2.l32.m1.1.1.3.2" xref="algx2.l32.m1.1.1.3.2.cmml">F</mi><mo id="algx2.l32.m1.1.1.3.1" xref="algx2.l32.m1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l32.m1.1.1.3.3" xref="algx2.l32.m1.1.1.3.3.cmml">F</mi><mo id="algx2.l32.m1.1.1.3.1a" xref="algx2.l32.m1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l32.m1.1.1.3.4" xref="algx2.l32.m1.1.1.3.4.cmml">N</mi><mo id="algx2.l32.m1.1.1.3.1b" xref="algx2.l32.m1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l32.m1.1.1.3.5" xref="algx2.l32.m1.1.1.3.5.cmml">O</mi><mo id="algx2.l32.m1.1.1.3.1c" xref="algx2.l32.m1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l32.m1.1.1.3.6" xref="algx2.l32.m1.1.1.3.6.cmml">u</mi><mo id="algx2.l32.m1.1.1.3.1d" xref="algx2.l32.m1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l32.m1.1.1.3.7" xref="algx2.l32.m1.1.1.3.7.cmml">t</mi><mo id="algx2.l32.m1.1.1.3.1e" xref="algx2.l32.m1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l32.m1.1.1.3.8" xref="algx2.l32.m1.1.1.3.8.cmml">p</mi><mo id="algx2.l32.m1.1.1.3.1f" xref="algx2.l32.m1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l32.m1.1.1.3.9" xref="algx2.l32.m1.1.1.3.9.cmml">u</mi><mo id="algx2.l32.m1.1.1.3.1g" xref="algx2.l32.m1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l32.m1.1.1.3.10" xref="algx2.l32.m1.1.1.3.10.cmml">t</mi></mrow><mo id="algx2.l32.m1.1.1.2" stretchy="false" xref="algx2.l32.m1.1.1.2.cmml">←</mo><mrow id="algx2.l32.m1.1.1.1" xref="algx2.l32.m1.1.1.1.cmml"><mtext id="algx2.l32.m1.1.1.1.3" xref="algx2.l32.m1.1.1.1.3a.cmml">ReLU</mtext><mo id="algx2.l32.m1.1.1.1.2" xref="algx2.l32.m1.1.1.1.2.cmml">⁢</mo><mrow id="algx2.l32.m1.1.1.1.1.1" xref="algx2.l32.m1.1.1.1.1.1.1.cmml"><mo id="algx2.l32.m1.1.1.1.1.1.2" stretchy="false" xref="algx2.l32.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="algx2.l32.m1.1.1.1.1.1.1" xref="algx2.l32.m1.1.1.1.1.1.1.cmml"><mrow id="algx2.l32.m1.1.1.1.1.1.1.2" xref="algx2.l32.m1.1.1.1.1.1.1.2.cmml"><mi id="algx2.l32.m1.1.1.1.1.1.1.2.2" xref="algx2.l32.m1.1.1.1.1.1.1.2.2.cmml">C</mi><mo id="algx2.l32.m1.1.1.1.1.1.1.2.1" xref="algx2.l32.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l32.m1.1.1.1.1.1.1.2.3" xref="algx2.l32.m1.1.1.1.1.1.1.2.3.cmml">r</mi><mo id="algx2.l32.m1.1.1.1.1.1.1.2.1a" xref="algx2.l32.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l32.m1.1.1.1.1.1.1.2.4" xref="algx2.l32.m1.1.1.1.1.1.1.2.4.cmml">o</mi><mo id="algx2.l32.m1.1.1.1.1.1.1.2.1b" xref="algx2.l32.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l32.m1.1.1.1.1.1.1.2.5" xref="algx2.l32.m1.1.1.1.1.1.1.2.5.cmml">s</mi><mo id="algx2.l32.m1.1.1.1.1.1.1.2.1c" xref="algx2.l32.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l32.m1.1.1.1.1.1.1.2.6" xref="algx2.l32.m1.1.1.1.1.1.1.2.6.cmml">s</mi><mo id="algx2.l32.m1.1.1.1.1.1.1.2.1d" xref="algx2.l32.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l32.m1.1.1.1.1.1.1.2.7" xref="algx2.l32.m1.1.1.1.1.1.1.2.7.cmml">M</mi><mo id="algx2.l32.m1.1.1.1.1.1.1.2.1e" xref="algx2.l32.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l32.m1.1.1.1.1.1.1.2.8" xref="algx2.l32.m1.1.1.1.1.1.1.2.8.cmml">o</mi><mo id="algx2.l32.m1.1.1.1.1.1.1.2.1f" xref="algx2.l32.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l32.m1.1.1.1.1.1.1.2.9" xref="algx2.l32.m1.1.1.1.1.1.1.2.9.cmml">d</mi><mo id="algx2.l32.m1.1.1.1.1.1.1.2.1g" xref="algx2.l32.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l32.m1.1.1.1.1.1.1.2.10" xref="algx2.l32.m1.1.1.1.1.1.1.2.10.cmml">a</mi><mo id="algx2.l32.m1.1.1.1.1.1.1.2.1h" xref="algx2.l32.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l32.m1.1.1.1.1.1.1.2.11" xref="algx2.l32.m1.1.1.1.1.1.1.2.11.cmml">l</mi><mo id="algx2.l32.m1.1.1.1.1.1.1.2.1i" xref="algx2.l32.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l32.m1.1.1.1.1.1.1.2.12" xref="algx2.l32.m1.1.1.1.1.1.1.2.12.cmml">O</mi><mo id="algx2.l32.m1.1.1.1.1.1.1.2.1j" xref="algx2.l32.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l32.m1.1.1.1.1.1.1.2.13" xref="algx2.l32.m1.1.1.1.1.1.1.2.13.cmml">u</mi><mo id="algx2.l32.m1.1.1.1.1.1.1.2.1k" xref="algx2.l32.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l32.m1.1.1.1.1.1.1.2.14" xref="algx2.l32.m1.1.1.1.1.1.1.2.14.cmml">t</mi><mo id="algx2.l32.m1.1.1.1.1.1.1.2.1l" xref="algx2.l32.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l32.m1.1.1.1.1.1.1.2.15" xref="algx2.l32.m1.1.1.1.1.1.1.2.15.cmml">p</mi><mo id="algx2.l32.m1.1.1.1.1.1.1.2.1m" xref="algx2.l32.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l32.m1.1.1.1.1.1.1.2.16" xref="algx2.l32.m1.1.1.1.1.1.1.2.16.cmml">u</mi><mo id="algx2.l32.m1.1.1.1.1.1.1.2.1n" xref="algx2.l32.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l32.m1.1.1.1.1.1.1.2.17" xref="algx2.l32.m1.1.1.1.1.1.1.2.17.cmml">t</mi></mrow><mo id="algx2.l32.m1.1.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="algx2.l32.m1.1.1.1.1.1.1.1.cmml">⋅</mo><msub id="algx2.l32.m1.1.1.1.1.1.1.3" xref="algx2.l32.m1.1.1.1.1.1.1.3.cmml"><mi id="algx2.l32.m1.1.1.1.1.1.1.3.2" xref="algx2.l32.m1.1.1.1.1.1.1.3.2.cmml">W</mi><mn id="algx2.l32.m1.1.1.1.1.1.1.3.3" xref="algx2.l32.m1.1.1.1.1.1.1.3.3.cmml">1</mn></msub></mrow><mo id="algx2.l32.m1.1.1.1.1.1.3" stretchy="false" xref="algx2.l32.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx2.l32.m1.1b"><apply id="algx2.l32.m1.1.1.cmml" xref="algx2.l32.m1.1.1"><ci id="algx2.l32.m1.1.1.2.cmml" xref="algx2.l32.m1.1.1.2">←</ci><apply id="algx2.l32.m1.1.1.3.cmml" xref="algx2.l32.m1.1.1.3"><times id="algx2.l32.m1.1.1.3.1.cmml" xref="algx2.l32.m1.1.1.3.1"></times><ci id="algx2.l32.m1.1.1.3.2.cmml" xref="algx2.l32.m1.1.1.3.2">𝐹</ci><ci id="algx2.l32.m1.1.1.3.3.cmml" xref="algx2.l32.m1.1.1.3.3">𝐹</ci><ci id="algx2.l32.m1.1.1.3.4.cmml" xref="algx2.l32.m1.1.1.3.4">𝑁</ci><ci id="algx2.l32.m1.1.1.3.5.cmml" xref="algx2.l32.m1.1.1.3.5">𝑂</ci><ci id="algx2.l32.m1.1.1.3.6.cmml" xref="algx2.l32.m1.1.1.3.6">𝑢</ci><ci id="algx2.l32.m1.1.1.3.7.cmml" xref="algx2.l32.m1.1.1.3.7">𝑡</ci><ci id="algx2.l32.m1.1.1.3.8.cmml" xref="algx2.l32.m1.1.1.3.8">𝑝</ci><ci id="algx2.l32.m1.1.1.3.9.cmml" xref="algx2.l32.m1.1.1.3.9">𝑢</ci><ci id="algx2.l32.m1.1.1.3.10.cmml" xref="algx2.l32.m1.1.1.3.10">𝑡</ci></apply><apply id="algx2.l32.m1.1.1.1.cmml" xref="algx2.l32.m1.1.1.1"><times id="algx2.l32.m1.1.1.1.2.cmml" xref="algx2.l32.m1.1.1.1.2"></times><ci id="algx2.l32.m1.1.1.1.3a.cmml" xref="algx2.l32.m1.1.1.1.3"><mtext id="algx2.l32.m1.1.1.1.3.cmml" xref="algx2.l32.m1.1.1.1.3">ReLU</mtext></ci><apply id="algx2.l32.m1.1.1.1.1.1.1.cmml" xref="algx2.l32.m1.1.1.1.1.1"><ci id="algx2.l32.m1.1.1.1.1.1.1.1.cmml" xref="algx2.l32.m1.1.1.1.1.1.1.1">⋅</ci><apply id="algx2.l32.m1.1.1.1.1.1.1.2.cmml" xref="algx2.l32.m1.1.1.1.1.1.1.2"><times id="algx2.l32.m1.1.1.1.1.1.1.2.1.cmml" xref="algx2.l32.m1.1.1.1.1.1.1.2.1"></times><ci id="algx2.l32.m1.1.1.1.1.1.1.2.2.cmml" xref="algx2.l32.m1.1.1.1.1.1.1.2.2">𝐶</ci><ci id="algx2.l32.m1.1.1.1.1.1.1.2.3.cmml" xref="algx2.l32.m1.1.1.1.1.1.1.2.3">𝑟</ci><ci id="algx2.l32.m1.1.1.1.1.1.1.2.4.cmml" xref="algx2.l32.m1.1.1.1.1.1.1.2.4">𝑜</ci><ci id="algx2.l32.m1.1.1.1.1.1.1.2.5.cmml" xref="algx2.l32.m1.1.1.1.1.1.1.2.5">𝑠</ci><ci id="algx2.l32.m1.1.1.1.1.1.1.2.6.cmml" xref="algx2.l32.m1.1.1.1.1.1.1.2.6">𝑠</ci><ci id="algx2.l32.m1.1.1.1.1.1.1.2.7.cmml" xref="algx2.l32.m1.1.1.1.1.1.1.2.7">𝑀</ci><ci id="algx2.l32.m1.1.1.1.1.1.1.2.8.cmml" xref="algx2.l32.m1.1.1.1.1.1.1.2.8">𝑜</ci><ci id="algx2.l32.m1.1.1.1.1.1.1.2.9.cmml" xref="algx2.l32.m1.1.1.1.1.1.1.2.9">𝑑</ci><ci id="algx2.l32.m1.1.1.1.1.1.1.2.10.cmml" xref="algx2.l32.m1.1.1.1.1.1.1.2.10">𝑎</ci><ci id="algx2.l32.m1.1.1.1.1.1.1.2.11.cmml" xref="algx2.l32.m1.1.1.1.1.1.1.2.11">𝑙</ci><ci id="algx2.l32.m1.1.1.1.1.1.1.2.12.cmml" xref="algx2.l32.m1.1.1.1.1.1.1.2.12">𝑂</ci><ci id="algx2.l32.m1.1.1.1.1.1.1.2.13.cmml" xref="algx2.l32.m1.1.1.1.1.1.1.2.13">𝑢</ci><ci id="algx2.l32.m1.1.1.1.1.1.1.2.14.cmml" xref="algx2.l32.m1.1.1.1.1.1.1.2.14">𝑡</ci><ci id="algx2.l32.m1.1.1.1.1.1.1.2.15.cmml" xref="algx2.l32.m1.1.1.1.1.1.1.2.15">𝑝</ci><ci id="algx2.l32.m1.1.1.1.1.1.1.2.16.cmml" xref="algx2.l32.m1.1.1.1.1.1.1.2.16">𝑢</ci><ci id="algx2.l32.m1.1.1.1.1.1.1.2.17.cmml" xref="algx2.l32.m1.1.1.1.1.1.1.2.17">𝑡</ci></apply><apply id="algx2.l32.m1.1.1.1.1.1.1.3.cmml" xref="algx2.l32.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="algx2.l32.m1.1.1.1.1.1.1.3.1.cmml" xref="algx2.l32.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="algx2.l32.m1.1.1.1.1.1.1.3.2.cmml" xref="algx2.l32.m1.1.1.1.1.1.1.3.2">𝑊</ci><cn id="algx2.l32.m1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="algx2.l32.m1.1.1.1.1.1.1.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx2.l32.m1.1c">FFNOutput\leftarrow\text{ReLU}(CrossModalOutput\cdot W_{1})</annotation><annotation encoding="application/x-llamapun" id="algx2.l32.m1.1d">italic_F italic_F italic_N italic_O italic_u italic_t italic_p italic_u italic_t ← ReLU ( italic_C italic_r italic_o italic_s italic_s italic_M italic_o italic_d italic_a italic_l italic_O italic_u italic_t italic_p italic_u italic_t ⋅ italic_W start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algx2.l33">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algx2.l33.1.1.1" style="font-size:80%;">33:</span></span>  <math alttext="FFNOutput\leftarrow\text{Dropout}(FFNOutput,dropout\_rate)" class="ltx_Math" display="inline" id="algx2.l33.m1.2"><semantics id="algx2.l33.m1.2a"><mrow id="algx2.l33.m1.2.2" xref="algx2.l33.m1.2.2.cmml"><mrow id="algx2.l33.m1.2.2.4" xref="algx2.l33.m1.2.2.4.cmml"><mi id="algx2.l33.m1.2.2.4.2" xref="algx2.l33.m1.2.2.4.2.cmml">F</mi><mo id="algx2.l33.m1.2.2.4.1" xref="algx2.l33.m1.2.2.4.1.cmml">⁢</mo><mi id="algx2.l33.m1.2.2.4.3" xref="algx2.l33.m1.2.2.4.3.cmml">F</mi><mo id="algx2.l33.m1.2.2.4.1a" xref="algx2.l33.m1.2.2.4.1.cmml">⁢</mo><mi id="algx2.l33.m1.2.2.4.4" xref="algx2.l33.m1.2.2.4.4.cmml">N</mi><mo id="algx2.l33.m1.2.2.4.1b" xref="algx2.l33.m1.2.2.4.1.cmml">⁢</mo><mi id="algx2.l33.m1.2.2.4.5" xref="algx2.l33.m1.2.2.4.5.cmml">O</mi><mo id="algx2.l33.m1.2.2.4.1c" xref="algx2.l33.m1.2.2.4.1.cmml">⁢</mo><mi id="algx2.l33.m1.2.2.4.6" xref="algx2.l33.m1.2.2.4.6.cmml">u</mi><mo id="algx2.l33.m1.2.2.4.1d" xref="algx2.l33.m1.2.2.4.1.cmml">⁢</mo><mi id="algx2.l33.m1.2.2.4.7" xref="algx2.l33.m1.2.2.4.7.cmml">t</mi><mo id="algx2.l33.m1.2.2.4.1e" xref="algx2.l33.m1.2.2.4.1.cmml">⁢</mo><mi id="algx2.l33.m1.2.2.4.8" xref="algx2.l33.m1.2.2.4.8.cmml">p</mi><mo id="algx2.l33.m1.2.2.4.1f" xref="algx2.l33.m1.2.2.4.1.cmml">⁢</mo><mi id="algx2.l33.m1.2.2.4.9" xref="algx2.l33.m1.2.2.4.9.cmml">u</mi><mo id="algx2.l33.m1.2.2.4.1g" xref="algx2.l33.m1.2.2.4.1.cmml">⁢</mo><mi id="algx2.l33.m1.2.2.4.10" xref="algx2.l33.m1.2.2.4.10.cmml">t</mi></mrow><mo id="algx2.l33.m1.2.2.3" stretchy="false" xref="algx2.l33.m1.2.2.3.cmml">←</mo><mrow id="algx2.l33.m1.2.2.2" xref="algx2.l33.m1.2.2.2.cmml"><mtext id="algx2.l33.m1.2.2.2.4" xref="algx2.l33.m1.2.2.2.4a.cmml">Dropout</mtext><mo id="algx2.l33.m1.2.2.2.3" xref="algx2.l33.m1.2.2.2.3.cmml">⁢</mo><mrow id="algx2.l33.m1.2.2.2.2.2" xref="algx2.l33.m1.2.2.2.2.3.cmml"><mo id="algx2.l33.m1.2.2.2.2.2.3" stretchy="false" xref="algx2.l33.m1.2.2.2.2.3.cmml">(</mo><mrow id="algx2.l33.m1.1.1.1.1.1.1" xref="algx2.l33.m1.1.1.1.1.1.1.cmml"><mi id="algx2.l33.m1.1.1.1.1.1.1.2" xref="algx2.l33.m1.1.1.1.1.1.1.2.cmml">F</mi><mo id="algx2.l33.m1.1.1.1.1.1.1.1" xref="algx2.l33.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx2.l33.m1.1.1.1.1.1.1.3" xref="algx2.l33.m1.1.1.1.1.1.1.3.cmml">F</mi><mo id="algx2.l33.m1.1.1.1.1.1.1.1a" xref="algx2.l33.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx2.l33.m1.1.1.1.1.1.1.4" xref="algx2.l33.m1.1.1.1.1.1.1.4.cmml">N</mi><mo id="algx2.l33.m1.1.1.1.1.1.1.1b" xref="algx2.l33.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx2.l33.m1.1.1.1.1.1.1.5" xref="algx2.l33.m1.1.1.1.1.1.1.5.cmml">O</mi><mo id="algx2.l33.m1.1.1.1.1.1.1.1c" xref="algx2.l33.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx2.l33.m1.1.1.1.1.1.1.6" xref="algx2.l33.m1.1.1.1.1.1.1.6.cmml">u</mi><mo id="algx2.l33.m1.1.1.1.1.1.1.1d" xref="algx2.l33.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx2.l33.m1.1.1.1.1.1.1.7" xref="algx2.l33.m1.1.1.1.1.1.1.7.cmml">t</mi><mo id="algx2.l33.m1.1.1.1.1.1.1.1e" xref="algx2.l33.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx2.l33.m1.1.1.1.1.1.1.8" xref="algx2.l33.m1.1.1.1.1.1.1.8.cmml">p</mi><mo id="algx2.l33.m1.1.1.1.1.1.1.1f" xref="algx2.l33.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx2.l33.m1.1.1.1.1.1.1.9" xref="algx2.l33.m1.1.1.1.1.1.1.9.cmml">u</mi><mo id="algx2.l33.m1.1.1.1.1.1.1.1g" xref="algx2.l33.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algx2.l33.m1.1.1.1.1.1.1.10" xref="algx2.l33.m1.1.1.1.1.1.1.10.cmml">t</mi></mrow><mo id="algx2.l33.m1.2.2.2.2.2.4" xref="algx2.l33.m1.2.2.2.2.3.cmml">,</mo><mrow id="algx2.l33.m1.2.2.2.2.2.2" xref="algx2.l33.m1.2.2.2.2.2.2.cmml"><mi id="algx2.l33.m1.2.2.2.2.2.2.2" xref="algx2.l33.m1.2.2.2.2.2.2.2.cmml">d</mi><mo id="algx2.l33.m1.2.2.2.2.2.2.1" xref="algx2.l33.m1.2.2.2.2.2.2.1.cmml">⁢</mo><mi id="algx2.l33.m1.2.2.2.2.2.2.3" xref="algx2.l33.m1.2.2.2.2.2.2.3.cmml">r</mi><mo id="algx2.l33.m1.2.2.2.2.2.2.1a" xref="algx2.l33.m1.2.2.2.2.2.2.1.cmml">⁢</mo><mi id="algx2.l33.m1.2.2.2.2.2.2.4" xref="algx2.l33.m1.2.2.2.2.2.2.4.cmml">o</mi><mo id="algx2.l33.m1.2.2.2.2.2.2.1b" xref="algx2.l33.m1.2.2.2.2.2.2.1.cmml">⁢</mo><mi id="algx2.l33.m1.2.2.2.2.2.2.5" xref="algx2.l33.m1.2.2.2.2.2.2.5.cmml">p</mi><mo id="algx2.l33.m1.2.2.2.2.2.2.1c" xref="algx2.l33.m1.2.2.2.2.2.2.1.cmml">⁢</mo><mi id="algx2.l33.m1.2.2.2.2.2.2.6" xref="algx2.l33.m1.2.2.2.2.2.2.6.cmml">o</mi><mo id="algx2.l33.m1.2.2.2.2.2.2.1d" xref="algx2.l33.m1.2.2.2.2.2.2.1.cmml">⁢</mo><mi id="algx2.l33.m1.2.2.2.2.2.2.7" xref="algx2.l33.m1.2.2.2.2.2.2.7.cmml">u</mi><mo id="algx2.l33.m1.2.2.2.2.2.2.1e" xref="algx2.l33.m1.2.2.2.2.2.2.1.cmml">⁢</mo><mi id="algx2.l33.m1.2.2.2.2.2.2.8" xref="algx2.l33.m1.2.2.2.2.2.2.8.cmml">t</mi><mo id="algx2.l33.m1.2.2.2.2.2.2.1f" xref="algx2.l33.m1.2.2.2.2.2.2.1.cmml">⁢</mo><mi id="algx2.l33.m1.2.2.2.2.2.2.9" mathvariant="normal" xref="algx2.l33.m1.2.2.2.2.2.2.9.cmml">_</mi><mo id="algx2.l33.m1.2.2.2.2.2.2.1g" xref="algx2.l33.m1.2.2.2.2.2.2.1.cmml">⁢</mo><mi id="algx2.l33.m1.2.2.2.2.2.2.10" xref="algx2.l33.m1.2.2.2.2.2.2.10.cmml">r</mi><mo id="algx2.l33.m1.2.2.2.2.2.2.1h" xref="algx2.l33.m1.2.2.2.2.2.2.1.cmml">⁢</mo><mi id="algx2.l33.m1.2.2.2.2.2.2.11" xref="algx2.l33.m1.2.2.2.2.2.2.11.cmml">a</mi><mo id="algx2.l33.m1.2.2.2.2.2.2.1i" xref="algx2.l33.m1.2.2.2.2.2.2.1.cmml">⁢</mo><mi id="algx2.l33.m1.2.2.2.2.2.2.12" xref="algx2.l33.m1.2.2.2.2.2.2.12.cmml">t</mi><mo id="algx2.l33.m1.2.2.2.2.2.2.1j" xref="algx2.l33.m1.2.2.2.2.2.2.1.cmml">⁢</mo><mi id="algx2.l33.m1.2.2.2.2.2.2.13" xref="algx2.l33.m1.2.2.2.2.2.2.13.cmml">e</mi></mrow><mo id="algx2.l33.m1.2.2.2.2.2.5" stretchy="false" xref="algx2.l33.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx2.l33.m1.2b"><apply id="algx2.l33.m1.2.2.cmml" xref="algx2.l33.m1.2.2"><ci id="algx2.l33.m1.2.2.3.cmml" xref="algx2.l33.m1.2.2.3">←</ci><apply id="algx2.l33.m1.2.2.4.cmml" xref="algx2.l33.m1.2.2.4"><times id="algx2.l33.m1.2.2.4.1.cmml" xref="algx2.l33.m1.2.2.4.1"></times><ci id="algx2.l33.m1.2.2.4.2.cmml" xref="algx2.l33.m1.2.2.4.2">𝐹</ci><ci id="algx2.l33.m1.2.2.4.3.cmml" xref="algx2.l33.m1.2.2.4.3">𝐹</ci><ci id="algx2.l33.m1.2.2.4.4.cmml" xref="algx2.l33.m1.2.2.4.4">𝑁</ci><ci id="algx2.l33.m1.2.2.4.5.cmml" xref="algx2.l33.m1.2.2.4.5">𝑂</ci><ci id="algx2.l33.m1.2.2.4.6.cmml" xref="algx2.l33.m1.2.2.4.6">𝑢</ci><ci id="algx2.l33.m1.2.2.4.7.cmml" xref="algx2.l33.m1.2.2.4.7">𝑡</ci><ci id="algx2.l33.m1.2.2.4.8.cmml" xref="algx2.l33.m1.2.2.4.8">𝑝</ci><ci id="algx2.l33.m1.2.2.4.9.cmml" xref="algx2.l33.m1.2.2.4.9">𝑢</ci><ci id="algx2.l33.m1.2.2.4.10.cmml" xref="algx2.l33.m1.2.2.4.10">𝑡</ci></apply><apply id="algx2.l33.m1.2.2.2.cmml" xref="algx2.l33.m1.2.2.2"><times id="algx2.l33.m1.2.2.2.3.cmml" xref="algx2.l33.m1.2.2.2.3"></times><ci id="algx2.l33.m1.2.2.2.4a.cmml" xref="algx2.l33.m1.2.2.2.4"><mtext id="algx2.l33.m1.2.2.2.4.cmml" xref="algx2.l33.m1.2.2.2.4">Dropout</mtext></ci><interval closure="open" id="algx2.l33.m1.2.2.2.2.3.cmml" xref="algx2.l33.m1.2.2.2.2.2"><apply id="algx2.l33.m1.1.1.1.1.1.1.cmml" xref="algx2.l33.m1.1.1.1.1.1.1"><times id="algx2.l33.m1.1.1.1.1.1.1.1.cmml" xref="algx2.l33.m1.1.1.1.1.1.1.1"></times><ci id="algx2.l33.m1.1.1.1.1.1.1.2.cmml" xref="algx2.l33.m1.1.1.1.1.1.1.2">𝐹</ci><ci id="algx2.l33.m1.1.1.1.1.1.1.3.cmml" xref="algx2.l33.m1.1.1.1.1.1.1.3">𝐹</ci><ci id="algx2.l33.m1.1.1.1.1.1.1.4.cmml" xref="algx2.l33.m1.1.1.1.1.1.1.4">𝑁</ci><ci id="algx2.l33.m1.1.1.1.1.1.1.5.cmml" xref="algx2.l33.m1.1.1.1.1.1.1.5">𝑂</ci><ci id="algx2.l33.m1.1.1.1.1.1.1.6.cmml" xref="algx2.l33.m1.1.1.1.1.1.1.6">𝑢</ci><ci id="algx2.l33.m1.1.1.1.1.1.1.7.cmml" xref="algx2.l33.m1.1.1.1.1.1.1.7">𝑡</ci><ci id="algx2.l33.m1.1.1.1.1.1.1.8.cmml" xref="algx2.l33.m1.1.1.1.1.1.1.8">𝑝</ci><ci id="algx2.l33.m1.1.1.1.1.1.1.9.cmml" xref="algx2.l33.m1.1.1.1.1.1.1.9">𝑢</ci><ci id="algx2.l33.m1.1.1.1.1.1.1.10.cmml" xref="algx2.l33.m1.1.1.1.1.1.1.10">𝑡</ci></apply><apply id="algx2.l33.m1.2.2.2.2.2.2.cmml" xref="algx2.l33.m1.2.2.2.2.2.2"><times id="algx2.l33.m1.2.2.2.2.2.2.1.cmml" xref="algx2.l33.m1.2.2.2.2.2.2.1"></times><ci id="algx2.l33.m1.2.2.2.2.2.2.2.cmml" xref="algx2.l33.m1.2.2.2.2.2.2.2">𝑑</ci><ci id="algx2.l33.m1.2.2.2.2.2.2.3.cmml" xref="algx2.l33.m1.2.2.2.2.2.2.3">𝑟</ci><ci id="algx2.l33.m1.2.2.2.2.2.2.4.cmml" xref="algx2.l33.m1.2.2.2.2.2.2.4">𝑜</ci><ci id="algx2.l33.m1.2.2.2.2.2.2.5.cmml" xref="algx2.l33.m1.2.2.2.2.2.2.5">𝑝</ci><ci id="algx2.l33.m1.2.2.2.2.2.2.6.cmml" xref="algx2.l33.m1.2.2.2.2.2.2.6">𝑜</ci><ci id="algx2.l33.m1.2.2.2.2.2.2.7.cmml" xref="algx2.l33.m1.2.2.2.2.2.2.7">𝑢</ci><ci id="algx2.l33.m1.2.2.2.2.2.2.8.cmml" xref="algx2.l33.m1.2.2.2.2.2.2.8">𝑡</ci><ci id="algx2.l33.m1.2.2.2.2.2.2.9.cmml" xref="algx2.l33.m1.2.2.2.2.2.2.9">_</ci><ci id="algx2.l33.m1.2.2.2.2.2.2.10.cmml" xref="algx2.l33.m1.2.2.2.2.2.2.10">𝑟</ci><ci id="algx2.l33.m1.2.2.2.2.2.2.11.cmml" xref="algx2.l33.m1.2.2.2.2.2.2.11">𝑎</ci><ci id="algx2.l33.m1.2.2.2.2.2.2.12.cmml" xref="algx2.l33.m1.2.2.2.2.2.2.12">𝑡</ci><ci id="algx2.l33.m1.2.2.2.2.2.2.13.cmml" xref="algx2.l33.m1.2.2.2.2.2.2.13">𝑒</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx2.l33.m1.2c">FFNOutput\leftarrow\text{Dropout}(FFNOutput,dropout\_rate)</annotation><annotation encoding="application/x-llamapun" id="algx2.l33.m1.2d">italic_F italic_F italic_N italic_O italic_u italic_t italic_p italic_u italic_t ← Dropout ( italic_F italic_F italic_N italic_O italic_u italic_t italic_p italic_u italic_t , italic_d italic_r italic_o italic_p italic_o italic_u italic_t _ italic_r italic_a italic_t italic_e )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algx2.l34">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algx2.l34.1.1.1" style="font-size:80%;">34:</span></span>  <math alttext="FeedForwardOutput\leftarrow\text{LayerNorm}(FFNOutput\cdot W_{2}+CrossModalOutput)" class="ltx_Math" display="inline" id="algx2.l34.m1.1"><semantics id="algx2.l34.m1.1a"><mrow id="algx2.l34.m1.1.1" xref="algx2.l34.m1.1.1.cmml"><mrow id="algx2.l34.m1.1.1.3" xref="algx2.l34.m1.1.1.3.cmml"><mi id="algx2.l34.m1.1.1.3.2" xref="algx2.l34.m1.1.1.3.2.cmml">F</mi><mo id="algx2.l34.m1.1.1.3.1" xref="algx2.l34.m1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l34.m1.1.1.3.3" xref="algx2.l34.m1.1.1.3.3.cmml">e</mi><mo id="algx2.l34.m1.1.1.3.1a" xref="algx2.l34.m1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l34.m1.1.1.3.4" xref="algx2.l34.m1.1.1.3.4.cmml">e</mi><mo id="algx2.l34.m1.1.1.3.1b" xref="algx2.l34.m1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l34.m1.1.1.3.5" xref="algx2.l34.m1.1.1.3.5.cmml">d</mi><mo id="algx2.l34.m1.1.1.3.1c" xref="algx2.l34.m1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l34.m1.1.1.3.6" xref="algx2.l34.m1.1.1.3.6.cmml">F</mi><mo id="algx2.l34.m1.1.1.3.1d" xref="algx2.l34.m1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l34.m1.1.1.3.7" xref="algx2.l34.m1.1.1.3.7.cmml">o</mi><mo id="algx2.l34.m1.1.1.3.1e" xref="algx2.l34.m1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l34.m1.1.1.3.8" xref="algx2.l34.m1.1.1.3.8.cmml">r</mi><mo id="algx2.l34.m1.1.1.3.1f" xref="algx2.l34.m1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l34.m1.1.1.3.9" xref="algx2.l34.m1.1.1.3.9.cmml">w</mi><mo id="algx2.l34.m1.1.1.3.1g" xref="algx2.l34.m1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l34.m1.1.1.3.10" xref="algx2.l34.m1.1.1.3.10.cmml">a</mi><mo id="algx2.l34.m1.1.1.3.1h" xref="algx2.l34.m1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l34.m1.1.1.3.11" xref="algx2.l34.m1.1.1.3.11.cmml">r</mi><mo id="algx2.l34.m1.1.1.3.1i" xref="algx2.l34.m1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l34.m1.1.1.3.12" xref="algx2.l34.m1.1.1.3.12.cmml">d</mi><mo id="algx2.l34.m1.1.1.3.1j" xref="algx2.l34.m1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l34.m1.1.1.3.13" xref="algx2.l34.m1.1.1.3.13.cmml">O</mi><mo id="algx2.l34.m1.1.1.3.1k" xref="algx2.l34.m1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l34.m1.1.1.3.14" xref="algx2.l34.m1.1.1.3.14.cmml">u</mi><mo id="algx2.l34.m1.1.1.3.1l" xref="algx2.l34.m1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l34.m1.1.1.3.15" xref="algx2.l34.m1.1.1.3.15.cmml">t</mi><mo id="algx2.l34.m1.1.1.3.1m" xref="algx2.l34.m1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l34.m1.1.1.3.16" xref="algx2.l34.m1.1.1.3.16.cmml">p</mi><mo id="algx2.l34.m1.1.1.3.1n" xref="algx2.l34.m1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l34.m1.1.1.3.17" xref="algx2.l34.m1.1.1.3.17.cmml">u</mi><mo id="algx2.l34.m1.1.1.3.1o" xref="algx2.l34.m1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l34.m1.1.1.3.18" xref="algx2.l34.m1.1.1.3.18.cmml">t</mi></mrow><mo id="algx2.l34.m1.1.1.2" stretchy="false" xref="algx2.l34.m1.1.1.2.cmml">←</mo><mrow id="algx2.l34.m1.1.1.1" xref="algx2.l34.m1.1.1.1.cmml"><mtext id="algx2.l34.m1.1.1.1.3" xref="algx2.l34.m1.1.1.1.3a.cmml">LayerNorm</mtext><mo id="algx2.l34.m1.1.1.1.2" xref="algx2.l34.m1.1.1.1.2.cmml">⁢</mo><mrow id="algx2.l34.m1.1.1.1.1.1" xref="algx2.l34.m1.1.1.1.1.1.1.cmml"><mo id="algx2.l34.m1.1.1.1.1.1.2" stretchy="false" xref="algx2.l34.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="algx2.l34.m1.1.1.1.1.1.1" xref="algx2.l34.m1.1.1.1.1.1.1.cmml"><mrow id="algx2.l34.m1.1.1.1.1.1.1.2" xref="algx2.l34.m1.1.1.1.1.1.1.2.cmml"><mrow id="algx2.l34.m1.1.1.1.1.1.1.2.2" xref="algx2.l34.m1.1.1.1.1.1.1.2.2.cmml"><mi id="algx2.l34.m1.1.1.1.1.1.1.2.2.2" xref="algx2.l34.m1.1.1.1.1.1.1.2.2.2.cmml">F</mi><mo id="algx2.l34.m1.1.1.1.1.1.1.2.2.1" xref="algx2.l34.m1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="algx2.l34.m1.1.1.1.1.1.1.2.2.3" xref="algx2.l34.m1.1.1.1.1.1.1.2.2.3.cmml">F</mi><mo id="algx2.l34.m1.1.1.1.1.1.1.2.2.1a" xref="algx2.l34.m1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="algx2.l34.m1.1.1.1.1.1.1.2.2.4" xref="algx2.l34.m1.1.1.1.1.1.1.2.2.4.cmml">N</mi><mo id="algx2.l34.m1.1.1.1.1.1.1.2.2.1b" xref="algx2.l34.m1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="algx2.l34.m1.1.1.1.1.1.1.2.2.5" xref="algx2.l34.m1.1.1.1.1.1.1.2.2.5.cmml">O</mi><mo id="algx2.l34.m1.1.1.1.1.1.1.2.2.1c" xref="algx2.l34.m1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="algx2.l34.m1.1.1.1.1.1.1.2.2.6" xref="algx2.l34.m1.1.1.1.1.1.1.2.2.6.cmml">u</mi><mo id="algx2.l34.m1.1.1.1.1.1.1.2.2.1d" xref="algx2.l34.m1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="algx2.l34.m1.1.1.1.1.1.1.2.2.7" xref="algx2.l34.m1.1.1.1.1.1.1.2.2.7.cmml">t</mi><mo id="algx2.l34.m1.1.1.1.1.1.1.2.2.1e" xref="algx2.l34.m1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="algx2.l34.m1.1.1.1.1.1.1.2.2.8" xref="algx2.l34.m1.1.1.1.1.1.1.2.2.8.cmml">p</mi><mo id="algx2.l34.m1.1.1.1.1.1.1.2.2.1f" xref="algx2.l34.m1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="algx2.l34.m1.1.1.1.1.1.1.2.2.9" xref="algx2.l34.m1.1.1.1.1.1.1.2.2.9.cmml">u</mi><mo id="algx2.l34.m1.1.1.1.1.1.1.2.2.1g" xref="algx2.l34.m1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="algx2.l34.m1.1.1.1.1.1.1.2.2.10" xref="algx2.l34.m1.1.1.1.1.1.1.2.2.10.cmml">t</mi></mrow><mo id="algx2.l34.m1.1.1.1.1.1.1.2.1" lspace="0.222em" rspace="0.222em" xref="algx2.l34.m1.1.1.1.1.1.1.2.1.cmml">⋅</mo><msub id="algx2.l34.m1.1.1.1.1.1.1.2.3" xref="algx2.l34.m1.1.1.1.1.1.1.2.3.cmml"><mi id="algx2.l34.m1.1.1.1.1.1.1.2.3.2" xref="algx2.l34.m1.1.1.1.1.1.1.2.3.2.cmml">W</mi><mn id="algx2.l34.m1.1.1.1.1.1.1.2.3.3" xref="algx2.l34.m1.1.1.1.1.1.1.2.3.3.cmml">2</mn></msub></mrow><mo id="algx2.l34.m1.1.1.1.1.1.1.1" xref="algx2.l34.m1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="algx2.l34.m1.1.1.1.1.1.1.3" xref="algx2.l34.m1.1.1.1.1.1.1.3.cmml"><mi id="algx2.l34.m1.1.1.1.1.1.1.3.2" xref="algx2.l34.m1.1.1.1.1.1.1.3.2.cmml">C</mi><mo id="algx2.l34.m1.1.1.1.1.1.1.3.1" xref="algx2.l34.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l34.m1.1.1.1.1.1.1.3.3" xref="algx2.l34.m1.1.1.1.1.1.1.3.3.cmml">r</mi><mo id="algx2.l34.m1.1.1.1.1.1.1.3.1a" xref="algx2.l34.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l34.m1.1.1.1.1.1.1.3.4" xref="algx2.l34.m1.1.1.1.1.1.1.3.4.cmml">o</mi><mo id="algx2.l34.m1.1.1.1.1.1.1.3.1b" xref="algx2.l34.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l34.m1.1.1.1.1.1.1.3.5" xref="algx2.l34.m1.1.1.1.1.1.1.3.5.cmml">s</mi><mo id="algx2.l34.m1.1.1.1.1.1.1.3.1c" xref="algx2.l34.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l34.m1.1.1.1.1.1.1.3.6" xref="algx2.l34.m1.1.1.1.1.1.1.3.6.cmml">s</mi><mo id="algx2.l34.m1.1.1.1.1.1.1.3.1d" xref="algx2.l34.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l34.m1.1.1.1.1.1.1.3.7" xref="algx2.l34.m1.1.1.1.1.1.1.3.7.cmml">M</mi><mo id="algx2.l34.m1.1.1.1.1.1.1.3.1e" xref="algx2.l34.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l34.m1.1.1.1.1.1.1.3.8" xref="algx2.l34.m1.1.1.1.1.1.1.3.8.cmml">o</mi><mo id="algx2.l34.m1.1.1.1.1.1.1.3.1f" xref="algx2.l34.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l34.m1.1.1.1.1.1.1.3.9" xref="algx2.l34.m1.1.1.1.1.1.1.3.9.cmml">d</mi><mo id="algx2.l34.m1.1.1.1.1.1.1.3.1g" xref="algx2.l34.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l34.m1.1.1.1.1.1.1.3.10" xref="algx2.l34.m1.1.1.1.1.1.1.3.10.cmml">a</mi><mo id="algx2.l34.m1.1.1.1.1.1.1.3.1h" xref="algx2.l34.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l34.m1.1.1.1.1.1.1.3.11" xref="algx2.l34.m1.1.1.1.1.1.1.3.11.cmml">l</mi><mo id="algx2.l34.m1.1.1.1.1.1.1.3.1i" xref="algx2.l34.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l34.m1.1.1.1.1.1.1.3.12" xref="algx2.l34.m1.1.1.1.1.1.1.3.12.cmml">O</mi><mo id="algx2.l34.m1.1.1.1.1.1.1.3.1j" xref="algx2.l34.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l34.m1.1.1.1.1.1.1.3.13" xref="algx2.l34.m1.1.1.1.1.1.1.3.13.cmml">u</mi><mo id="algx2.l34.m1.1.1.1.1.1.1.3.1k" xref="algx2.l34.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l34.m1.1.1.1.1.1.1.3.14" xref="algx2.l34.m1.1.1.1.1.1.1.3.14.cmml">t</mi><mo id="algx2.l34.m1.1.1.1.1.1.1.3.1l" xref="algx2.l34.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l34.m1.1.1.1.1.1.1.3.15" xref="algx2.l34.m1.1.1.1.1.1.1.3.15.cmml">p</mi><mo id="algx2.l34.m1.1.1.1.1.1.1.3.1m" xref="algx2.l34.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l34.m1.1.1.1.1.1.1.3.16" xref="algx2.l34.m1.1.1.1.1.1.1.3.16.cmml">u</mi><mo id="algx2.l34.m1.1.1.1.1.1.1.3.1n" xref="algx2.l34.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l34.m1.1.1.1.1.1.1.3.17" xref="algx2.l34.m1.1.1.1.1.1.1.3.17.cmml">t</mi></mrow></mrow><mo id="algx2.l34.m1.1.1.1.1.1.3" stretchy="false" xref="algx2.l34.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx2.l34.m1.1b"><apply id="algx2.l34.m1.1.1.cmml" xref="algx2.l34.m1.1.1"><ci id="algx2.l34.m1.1.1.2.cmml" xref="algx2.l34.m1.1.1.2">←</ci><apply id="algx2.l34.m1.1.1.3.cmml" xref="algx2.l34.m1.1.1.3"><times id="algx2.l34.m1.1.1.3.1.cmml" xref="algx2.l34.m1.1.1.3.1"></times><ci id="algx2.l34.m1.1.1.3.2.cmml" xref="algx2.l34.m1.1.1.3.2">𝐹</ci><ci id="algx2.l34.m1.1.1.3.3.cmml" xref="algx2.l34.m1.1.1.3.3">𝑒</ci><ci id="algx2.l34.m1.1.1.3.4.cmml" xref="algx2.l34.m1.1.1.3.4">𝑒</ci><ci id="algx2.l34.m1.1.1.3.5.cmml" xref="algx2.l34.m1.1.1.3.5">𝑑</ci><ci id="algx2.l34.m1.1.1.3.6.cmml" xref="algx2.l34.m1.1.1.3.6">𝐹</ci><ci id="algx2.l34.m1.1.1.3.7.cmml" xref="algx2.l34.m1.1.1.3.7">𝑜</ci><ci id="algx2.l34.m1.1.1.3.8.cmml" xref="algx2.l34.m1.1.1.3.8">𝑟</ci><ci id="algx2.l34.m1.1.1.3.9.cmml" xref="algx2.l34.m1.1.1.3.9">𝑤</ci><ci id="algx2.l34.m1.1.1.3.10.cmml" xref="algx2.l34.m1.1.1.3.10">𝑎</ci><ci id="algx2.l34.m1.1.1.3.11.cmml" xref="algx2.l34.m1.1.1.3.11">𝑟</ci><ci id="algx2.l34.m1.1.1.3.12.cmml" xref="algx2.l34.m1.1.1.3.12">𝑑</ci><ci id="algx2.l34.m1.1.1.3.13.cmml" xref="algx2.l34.m1.1.1.3.13">𝑂</ci><ci id="algx2.l34.m1.1.1.3.14.cmml" xref="algx2.l34.m1.1.1.3.14">𝑢</ci><ci id="algx2.l34.m1.1.1.3.15.cmml" xref="algx2.l34.m1.1.1.3.15">𝑡</ci><ci id="algx2.l34.m1.1.1.3.16.cmml" xref="algx2.l34.m1.1.1.3.16">𝑝</ci><ci id="algx2.l34.m1.1.1.3.17.cmml" xref="algx2.l34.m1.1.1.3.17">𝑢</ci><ci id="algx2.l34.m1.1.1.3.18.cmml" xref="algx2.l34.m1.1.1.3.18">𝑡</ci></apply><apply id="algx2.l34.m1.1.1.1.cmml" xref="algx2.l34.m1.1.1.1"><times id="algx2.l34.m1.1.1.1.2.cmml" xref="algx2.l34.m1.1.1.1.2"></times><ci id="algx2.l34.m1.1.1.1.3a.cmml" xref="algx2.l34.m1.1.1.1.3"><mtext id="algx2.l34.m1.1.1.1.3.cmml" xref="algx2.l34.m1.1.1.1.3">LayerNorm</mtext></ci><apply id="algx2.l34.m1.1.1.1.1.1.1.cmml" xref="algx2.l34.m1.1.1.1.1.1"><plus id="algx2.l34.m1.1.1.1.1.1.1.1.cmml" xref="algx2.l34.m1.1.1.1.1.1.1.1"></plus><apply id="algx2.l34.m1.1.1.1.1.1.1.2.cmml" xref="algx2.l34.m1.1.1.1.1.1.1.2"><ci id="algx2.l34.m1.1.1.1.1.1.1.2.1.cmml" xref="algx2.l34.m1.1.1.1.1.1.1.2.1">⋅</ci><apply id="algx2.l34.m1.1.1.1.1.1.1.2.2.cmml" xref="algx2.l34.m1.1.1.1.1.1.1.2.2"><times id="algx2.l34.m1.1.1.1.1.1.1.2.2.1.cmml" xref="algx2.l34.m1.1.1.1.1.1.1.2.2.1"></times><ci id="algx2.l34.m1.1.1.1.1.1.1.2.2.2.cmml" xref="algx2.l34.m1.1.1.1.1.1.1.2.2.2">𝐹</ci><ci id="algx2.l34.m1.1.1.1.1.1.1.2.2.3.cmml" xref="algx2.l34.m1.1.1.1.1.1.1.2.2.3">𝐹</ci><ci id="algx2.l34.m1.1.1.1.1.1.1.2.2.4.cmml" xref="algx2.l34.m1.1.1.1.1.1.1.2.2.4">𝑁</ci><ci id="algx2.l34.m1.1.1.1.1.1.1.2.2.5.cmml" xref="algx2.l34.m1.1.1.1.1.1.1.2.2.5">𝑂</ci><ci id="algx2.l34.m1.1.1.1.1.1.1.2.2.6.cmml" xref="algx2.l34.m1.1.1.1.1.1.1.2.2.6">𝑢</ci><ci id="algx2.l34.m1.1.1.1.1.1.1.2.2.7.cmml" xref="algx2.l34.m1.1.1.1.1.1.1.2.2.7">𝑡</ci><ci id="algx2.l34.m1.1.1.1.1.1.1.2.2.8.cmml" xref="algx2.l34.m1.1.1.1.1.1.1.2.2.8">𝑝</ci><ci id="algx2.l34.m1.1.1.1.1.1.1.2.2.9.cmml" xref="algx2.l34.m1.1.1.1.1.1.1.2.2.9">𝑢</ci><ci id="algx2.l34.m1.1.1.1.1.1.1.2.2.10.cmml" xref="algx2.l34.m1.1.1.1.1.1.1.2.2.10">𝑡</ci></apply><apply id="algx2.l34.m1.1.1.1.1.1.1.2.3.cmml" xref="algx2.l34.m1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="algx2.l34.m1.1.1.1.1.1.1.2.3.1.cmml" xref="algx2.l34.m1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="algx2.l34.m1.1.1.1.1.1.1.2.3.2.cmml" xref="algx2.l34.m1.1.1.1.1.1.1.2.3.2">𝑊</ci><cn id="algx2.l34.m1.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="algx2.l34.m1.1.1.1.1.1.1.2.3.3">2</cn></apply></apply><apply id="algx2.l34.m1.1.1.1.1.1.1.3.cmml" xref="algx2.l34.m1.1.1.1.1.1.1.3"><times id="algx2.l34.m1.1.1.1.1.1.1.3.1.cmml" xref="algx2.l34.m1.1.1.1.1.1.1.3.1"></times><ci id="algx2.l34.m1.1.1.1.1.1.1.3.2.cmml" xref="algx2.l34.m1.1.1.1.1.1.1.3.2">𝐶</ci><ci id="algx2.l34.m1.1.1.1.1.1.1.3.3.cmml" xref="algx2.l34.m1.1.1.1.1.1.1.3.3">𝑟</ci><ci id="algx2.l34.m1.1.1.1.1.1.1.3.4.cmml" xref="algx2.l34.m1.1.1.1.1.1.1.3.4">𝑜</ci><ci id="algx2.l34.m1.1.1.1.1.1.1.3.5.cmml" xref="algx2.l34.m1.1.1.1.1.1.1.3.5">𝑠</ci><ci id="algx2.l34.m1.1.1.1.1.1.1.3.6.cmml" xref="algx2.l34.m1.1.1.1.1.1.1.3.6">𝑠</ci><ci id="algx2.l34.m1.1.1.1.1.1.1.3.7.cmml" xref="algx2.l34.m1.1.1.1.1.1.1.3.7">𝑀</ci><ci id="algx2.l34.m1.1.1.1.1.1.1.3.8.cmml" xref="algx2.l34.m1.1.1.1.1.1.1.3.8">𝑜</ci><ci id="algx2.l34.m1.1.1.1.1.1.1.3.9.cmml" xref="algx2.l34.m1.1.1.1.1.1.1.3.9">𝑑</ci><ci id="algx2.l34.m1.1.1.1.1.1.1.3.10.cmml" xref="algx2.l34.m1.1.1.1.1.1.1.3.10">𝑎</ci><ci id="algx2.l34.m1.1.1.1.1.1.1.3.11.cmml" xref="algx2.l34.m1.1.1.1.1.1.1.3.11">𝑙</ci><ci id="algx2.l34.m1.1.1.1.1.1.1.3.12.cmml" xref="algx2.l34.m1.1.1.1.1.1.1.3.12">𝑂</ci><ci id="algx2.l34.m1.1.1.1.1.1.1.3.13.cmml" xref="algx2.l34.m1.1.1.1.1.1.1.3.13">𝑢</ci><ci id="algx2.l34.m1.1.1.1.1.1.1.3.14.cmml" xref="algx2.l34.m1.1.1.1.1.1.1.3.14">𝑡</ci><ci id="algx2.l34.m1.1.1.1.1.1.1.3.15.cmml" xref="algx2.l34.m1.1.1.1.1.1.1.3.15">𝑝</ci><ci id="algx2.l34.m1.1.1.1.1.1.1.3.16.cmml" xref="algx2.l34.m1.1.1.1.1.1.1.3.16">𝑢</ci><ci id="algx2.l34.m1.1.1.1.1.1.1.3.17.cmml" xref="algx2.l34.m1.1.1.1.1.1.1.3.17">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx2.l34.m1.1c">FeedForwardOutput\leftarrow\text{LayerNorm}(FFNOutput\cdot W_{2}+CrossModalOutput)</annotation><annotation encoding="application/x-llamapun" id="algx2.l34.m1.1d">italic_F italic_e italic_e italic_d italic_F italic_o italic_r italic_w italic_a italic_r italic_d italic_O italic_u italic_t italic_p italic_u italic_t ← LayerNorm ( italic_F italic_F italic_N italic_O italic_u italic_t italic_p italic_u italic_t ⋅ italic_W start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT + italic_C italic_r italic_o italic_s italic_s italic_M italic_o italic_d italic_a italic_l italic_O italic_u italic_t italic_p italic_u italic_t )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algx2.l35">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algx2.l35.1.1.1" style="font-size:80%;">35:</span></span>  // Final output after another residual connection and layer normalization

</div>
<div class="ltx_listingline" id="algx2.l36">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algx2.l36.1.1.1" style="font-size:80%;">36:</span></span>  <math alttext="Y_{\text{fused}}\leftarrow\text{LayerNorm}(FeedForwardOutput+CrossModalOutput)" class="ltx_Math" display="inline" id="algx2.l36.m1.1"><semantics id="algx2.l36.m1.1a"><mrow id="algx2.l36.m1.1.1" xref="algx2.l36.m1.1.1.cmml"><msub id="algx2.l36.m1.1.1.3" xref="algx2.l36.m1.1.1.3.cmml"><mi id="algx2.l36.m1.1.1.3.2" xref="algx2.l36.m1.1.1.3.2.cmml">Y</mi><mtext id="algx2.l36.m1.1.1.3.3" xref="algx2.l36.m1.1.1.3.3a.cmml">fused</mtext></msub><mo id="algx2.l36.m1.1.1.2" stretchy="false" xref="algx2.l36.m1.1.1.2.cmml">←</mo><mrow id="algx2.l36.m1.1.1.1" xref="algx2.l36.m1.1.1.1.cmml"><mtext id="algx2.l36.m1.1.1.1.3" xref="algx2.l36.m1.1.1.1.3a.cmml">LayerNorm</mtext><mo id="algx2.l36.m1.1.1.1.2" xref="algx2.l36.m1.1.1.1.2.cmml">⁢</mo><mrow id="algx2.l36.m1.1.1.1.1.1" xref="algx2.l36.m1.1.1.1.1.1.1.cmml"><mo id="algx2.l36.m1.1.1.1.1.1.2" stretchy="false" xref="algx2.l36.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="algx2.l36.m1.1.1.1.1.1.1" xref="algx2.l36.m1.1.1.1.1.1.1.cmml"><mrow id="algx2.l36.m1.1.1.1.1.1.1.2" xref="algx2.l36.m1.1.1.1.1.1.1.2.cmml"><mi id="algx2.l36.m1.1.1.1.1.1.1.2.2" xref="algx2.l36.m1.1.1.1.1.1.1.2.2.cmml">F</mi><mo id="algx2.l36.m1.1.1.1.1.1.1.2.1" xref="algx2.l36.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l36.m1.1.1.1.1.1.1.2.3" xref="algx2.l36.m1.1.1.1.1.1.1.2.3.cmml">e</mi><mo id="algx2.l36.m1.1.1.1.1.1.1.2.1a" xref="algx2.l36.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l36.m1.1.1.1.1.1.1.2.4" xref="algx2.l36.m1.1.1.1.1.1.1.2.4.cmml">e</mi><mo id="algx2.l36.m1.1.1.1.1.1.1.2.1b" xref="algx2.l36.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l36.m1.1.1.1.1.1.1.2.5" xref="algx2.l36.m1.1.1.1.1.1.1.2.5.cmml">d</mi><mo id="algx2.l36.m1.1.1.1.1.1.1.2.1c" xref="algx2.l36.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l36.m1.1.1.1.1.1.1.2.6" xref="algx2.l36.m1.1.1.1.1.1.1.2.6.cmml">F</mi><mo id="algx2.l36.m1.1.1.1.1.1.1.2.1d" xref="algx2.l36.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l36.m1.1.1.1.1.1.1.2.7" xref="algx2.l36.m1.1.1.1.1.1.1.2.7.cmml">o</mi><mo id="algx2.l36.m1.1.1.1.1.1.1.2.1e" xref="algx2.l36.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l36.m1.1.1.1.1.1.1.2.8" xref="algx2.l36.m1.1.1.1.1.1.1.2.8.cmml">r</mi><mo id="algx2.l36.m1.1.1.1.1.1.1.2.1f" xref="algx2.l36.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l36.m1.1.1.1.1.1.1.2.9" xref="algx2.l36.m1.1.1.1.1.1.1.2.9.cmml">w</mi><mo id="algx2.l36.m1.1.1.1.1.1.1.2.1g" xref="algx2.l36.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l36.m1.1.1.1.1.1.1.2.10" xref="algx2.l36.m1.1.1.1.1.1.1.2.10.cmml">a</mi><mo id="algx2.l36.m1.1.1.1.1.1.1.2.1h" xref="algx2.l36.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l36.m1.1.1.1.1.1.1.2.11" xref="algx2.l36.m1.1.1.1.1.1.1.2.11.cmml">r</mi><mo id="algx2.l36.m1.1.1.1.1.1.1.2.1i" xref="algx2.l36.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l36.m1.1.1.1.1.1.1.2.12" xref="algx2.l36.m1.1.1.1.1.1.1.2.12.cmml">d</mi><mo id="algx2.l36.m1.1.1.1.1.1.1.2.1j" xref="algx2.l36.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l36.m1.1.1.1.1.1.1.2.13" xref="algx2.l36.m1.1.1.1.1.1.1.2.13.cmml">O</mi><mo id="algx2.l36.m1.1.1.1.1.1.1.2.1k" xref="algx2.l36.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l36.m1.1.1.1.1.1.1.2.14" xref="algx2.l36.m1.1.1.1.1.1.1.2.14.cmml">u</mi><mo id="algx2.l36.m1.1.1.1.1.1.1.2.1l" xref="algx2.l36.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l36.m1.1.1.1.1.1.1.2.15" xref="algx2.l36.m1.1.1.1.1.1.1.2.15.cmml">t</mi><mo id="algx2.l36.m1.1.1.1.1.1.1.2.1m" xref="algx2.l36.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l36.m1.1.1.1.1.1.1.2.16" xref="algx2.l36.m1.1.1.1.1.1.1.2.16.cmml">p</mi><mo id="algx2.l36.m1.1.1.1.1.1.1.2.1n" xref="algx2.l36.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l36.m1.1.1.1.1.1.1.2.17" xref="algx2.l36.m1.1.1.1.1.1.1.2.17.cmml">u</mi><mo id="algx2.l36.m1.1.1.1.1.1.1.2.1o" xref="algx2.l36.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="algx2.l36.m1.1.1.1.1.1.1.2.18" xref="algx2.l36.m1.1.1.1.1.1.1.2.18.cmml">t</mi></mrow><mo id="algx2.l36.m1.1.1.1.1.1.1.1" xref="algx2.l36.m1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="algx2.l36.m1.1.1.1.1.1.1.3" xref="algx2.l36.m1.1.1.1.1.1.1.3.cmml"><mi id="algx2.l36.m1.1.1.1.1.1.1.3.2" xref="algx2.l36.m1.1.1.1.1.1.1.3.2.cmml">C</mi><mo id="algx2.l36.m1.1.1.1.1.1.1.3.1" xref="algx2.l36.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l36.m1.1.1.1.1.1.1.3.3" xref="algx2.l36.m1.1.1.1.1.1.1.3.3.cmml">r</mi><mo id="algx2.l36.m1.1.1.1.1.1.1.3.1a" xref="algx2.l36.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l36.m1.1.1.1.1.1.1.3.4" xref="algx2.l36.m1.1.1.1.1.1.1.3.4.cmml">o</mi><mo id="algx2.l36.m1.1.1.1.1.1.1.3.1b" xref="algx2.l36.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l36.m1.1.1.1.1.1.1.3.5" xref="algx2.l36.m1.1.1.1.1.1.1.3.5.cmml">s</mi><mo id="algx2.l36.m1.1.1.1.1.1.1.3.1c" xref="algx2.l36.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l36.m1.1.1.1.1.1.1.3.6" xref="algx2.l36.m1.1.1.1.1.1.1.3.6.cmml">s</mi><mo id="algx2.l36.m1.1.1.1.1.1.1.3.1d" xref="algx2.l36.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l36.m1.1.1.1.1.1.1.3.7" xref="algx2.l36.m1.1.1.1.1.1.1.3.7.cmml">M</mi><mo id="algx2.l36.m1.1.1.1.1.1.1.3.1e" xref="algx2.l36.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l36.m1.1.1.1.1.1.1.3.8" xref="algx2.l36.m1.1.1.1.1.1.1.3.8.cmml">o</mi><mo id="algx2.l36.m1.1.1.1.1.1.1.3.1f" xref="algx2.l36.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l36.m1.1.1.1.1.1.1.3.9" xref="algx2.l36.m1.1.1.1.1.1.1.3.9.cmml">d</mi><mo id="algx2.l36.m1.1.1.1.1.1.1.3.1g" xref="algx2.l36.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l36.m1.1.1.1.1.1.1.3.10" xref="algx2.l36.m1.1.1.1.1.1.1.3.10.cmml">a</mi><mo id="algx2.l36.m1.1.1.1.1.1.1.3.1h" xref="algx2.l36.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l36.m1.1.1.1.1.1.1.3.11" xref="algx2.l36.m1.1.1.1.1.1.1.3.11.cmml">l</mi><mo id="algx2.l36.m1.1.1.1.1.1.1.3.1i" xref="algx2.l36.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l36.m1.1.1.1.1.1.1.3.12" xref="algx2.l36.m1.1.1.1.1.1.1.3.12.cmml">O</mi><mo id="algx2.l36.m1.1.1.1.1.1.1.3.1j" xref="algx2.l36.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l36.m1.1.1.1.1.1.1.3.13" xref="algx2.l36.m1.1.1.1.1.1.1.3.13.cmml">u</mi><mo id="algx2.l36.m1.1.1.1.1.1.1.3.1k" xref="algx2.l36.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l36.m1.1.1.1.1.1.1.3.14" xref="algx2.l36.m1.1.1.1.1.1.1.3.14.cmml">t</mi><mo id="algx2.l36.m1.1.1.1.1.1.1.3.1l" xref="algx2.l36.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l36.m1.1.1.1.1.1.1.3.15" xref="algx2.l36.m1.1.1.1.1.1.1.3.15.cmml">p</mi><mo id="algx2.l36.m1.1.1.1.1.1.1.3.1m" xref="algx2.l36.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l36.m1.1.1.1.1.1.1.3.16" xref="algx2.l36.m1.1.1.1.1.1.1.3.16.cmml">u</mi><mo id="algx2.l36.m1.1.1.1.1.1.1.3.1n" xref="algx2.l36.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algx2.l36.m1.1.1.1.1.1.1.3.17" xref="algx2.l36.m1.1.1.1.1.1.1.3.17.cmml">t</mi></mrow></mrow><mo id="algx2.l36.m1.1.1.1.1.1.3" stretchy="false" xref="algx2.l36.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx2.l36.m1.1b"><apply id="algx2.l36.m1.1.1.cmml" xref="algx2.l36.m1.1.1"><ci id="algx2.l36.m1.1.1.2.cmml" xref="algx2.l36.m1.1.1.2">←</ci><apply id="algx2.l36.m1.1.1.3.cmml" xref="algx2.l36.m1.1.1.3"><csymbol cd="ambiguous" id="algx2.l36.m1.1.1.3.1.cmml" xref="algx2.l36.m1.1.1.3">subscript</csymbol><ci id="algx2.l36.m1.1.1.3.2.cmml" xref="algx2.l36.m1.1.1.3.2">𝑌</ci><ci id="algx2.l36.m1.1.1.3.3a.cmml" xref="algx2.l36.m1.1.1.3.3"><mtext id="algx2.l36.m1.1.1.3.3.cmml" mathsize="70%" xref="algx2.l36.m1.1.1.3.3">fused</mtext></ci></apply><apply id="algx2.l36.m1.1.1.1.cmml" xref="algx2.l36.m1.1.1.1"><times id="algx2.l36.m1.1.1.1.2.cmml" xref="algx2.l36.m1.1.1.1.2"></times><ci id="algx2.l36.m1.1.1.1.3a.cmml" xref="algx2.l36.m1.1.1.1.3"><mtext id="algx2.l36.m1.1.1.1.3.cmml" xref="algx2.l36.m1.1.1.1.3">LayerNorm</mtext></ci><apply id="algx2.l36.m1.1.1.1.1.1.1.cmml" xref="algx2.l36.m1.1.1.1.1.1"><plus id="algx2.l36.m1.1.1.1.1.1.1.1.cmml" xref="algx2.l36.m1.1.1.1.1.1.1.1"></plus><apply id="algx2.l36.m1.1.1.1.1.1.1.2.cmml" xref="algx2.l36.m1.1.1.1.1.1.1.2"><times id="algx2.l36.m1.1.1.1.1.1.1.2.1.cmml" xref="algx2.l36.m1.1.1.1.1.1.1.2.1"></times><ci id="algx2.l36.m1.1.1.1.1.1.1.2.2.cmml" xref="algx2.l36.m1.1.1.1.1.1.1.2.2">𝐹</ci><ci id="algx2.l36.m1.1.1.1.1.1.1.2.3.cmml" xref="algx2.l36.m1.1.1.1.1.1.1.2.3">𝑒</ci><ci id="algx2.l36.m1.1.1.1.1.1.1.2.4.cmml" xref="algx2.l36.m1.1.1.1.1.1.1.2.4">𝑒</ci><ci id="algx2.l36.m1.1.1.1.1.1.1.2.5.cmml" xref="algx2.l36.m1.1.1.1.1.1.1.2.5">𝑑</ci><ci id="algx2.l36.m1.1.1.1.1.1.1.2.6.cmml" xref="algx2.l36.m1.1.1.1.1.1.1.2.6">𝐹</ci><ci id="algx2.l36.m1.1.1.1.1.1.1.2.7.cmml" xref="algx2.l36.m1.1.1.1.1.1.1.2.7">𝑜</ci><ci id="algx2.l36.m1.1.1.1.1.1.1.2.8.cmml" xref="algx2.l36.m1.1.1.1.1.1.1.2.8">𝑟</ci><ci id="algx2.l36.m1.1.1.1.1.1.1.2.9.cmml" xref="algx2.l36.m1.1.1.1.1.1.1.2.9">𝑤</ci><ci id="algx2.l36.m1.1.1.1.1.1.1.2.10.cmml" xref="algx2.l36.m1.1.1.1.1.1.1.2.10">𝑎</ci><ci id="algx2.l36.m1.1.1.1.1.1.1.2.11.cmml" xref="algx2.l36.m1.1.1.1.1.1.1.2.11">𝑟</ci><ci id="algx2.l36.m1.1.1.1.1.1.1.2.12.cmml" xref="algx2.l36.m1.1.1.1.1.1.1.2.12">𝑑</ci><ci id="algx2.l36.m1.1.1.1.1.1.1.2.13.cmml" xref="algx2.l36.m1.1.1.1.1.1.1.2.13">𝑂</ci><ci id="algx2.l36.m1.1.1.1.1.1.1.2.14.cmml" xref="algx2.l36.m1.1.1.1.1.1.1.2.14">𝑢</ci><ci id="algx2.l36.m1.1.1.1.1.1.1.2.15.cmml" xref="algx2.l36.m1.1.1.1.1.1.1.2.15">𝑡</ci><ci id="algx2.l36.m1.1.1.1.1.1.1.2.16.cmml" xref="algx2.l36.m1.1.1.1.1.1.1.2.16">𝑝</ci><ci id="algx2.l36.m1.1.1.1.1.1.1.2.17.cmml" xref="algx2.l36.m1.1.1.1.1.1.1.2.17">𝑢</ci><ci id="algx2.l36.m1.1.1.1.1.1.1.2.18.cmml" xref="algx2.l36.m1.1.1.1.1.1.1.2.18">𝑡</ci></apply><apply id="algx2.l36.m1.1.1.1.1.1.1.3.cmml" xref="algx2.l36.m1.1.1.1.1.1.1.3"><times id="algx2.l36.m1.1.1.1.1.1.1.3.1.cmml" xref="algx2.l36.m1.1.1.1.1.1.1.3.1"></times><ci id="algx2.l36.m1.1.1.1.1.1.1.3.2.cmml" xref="algx2.l36.m1.1.1.1.1.1.1.3.2">𝐶</ci><ci id="algx2.l36.m1.1.1.1.1.1.1.3.3.cmml" xref="algx2.l36.m1.1.1.1.1.1.1.3.3">𝑟</ci><ci id="algx2.l36.m1.1.1.1.1.1.1.3.4.cmml" xref="algx2.l36.m1.1.1.1.1.1.1.3.4">𝑜</ci><ci id="algx2.l36.m1.1.1.1.1.1.1.3.5.cmml" xref="algx2.l36.m1.1.1.1.1.1.1.3.5">𝑠</ci><ci id="algx2.l36.m1.1.1.1.1.1.1.3.6.cmml" xref="algx2.l36.m1.1.1.1.1.1.1.3.6">𝑠</ci><ci id="algx2.l36.m1.1.1.1.1.1.1.3.7.cmml" xref="algx2.l36.m1.1.1.1.1.1.1.3.7">𝑀</ci><ci id="algx2.l36.m1.1.1.1.1.1.1.3.8.cmml" xref="algx2.l36.m1.1.1.1.1.1.1.3.8">𝑜</ci><ci id="algx2.l36.m1.1.1.1.1.1.1.3.9.cmml" xref="algx2.l36.m1.1.1.1.1.1.1.3.9">𝑑</ci><ci id="algx2.l36.m1.1.1.1.1.1.1.3.10.cmml" xref="algx2.l36.m1.1.1.1.1.1.1.3.10">𝑎</ci><ci id="algx2.l36.m1.1.1.1.1.1.1.3.11.cmml" xref="algx2.l36.m1.1.1.1.1.1.1.3.11">𝑙</ci><ci id="algx2.l36.m1.1.1.1.1.1.1.3.12.cmml" xref="algx2.l36.m1.1.1.1.1.1.1.3.12">𝑂</ci><ci id="algx2.l36.m1.1.1.1.1.1.1.3.13.cmml" xref="algx2.l36.m1.1.1.1.1.1.1.3.13">𝑢</ci><ci id="algx2.l36.m1.1.1.1.1.1.1.3.14.cmml" xref="algx2.l36.m1.1.1.1.1.1.1.3.14">𝑡</ci><ci id="algx2.l36.m1.1.1.1.1.1.1.3.15.cmml" xref="algx2.l36.m1.1.1.1.1.1.1.3.15">𝑝</ci><ci id="algx2.l36.m1.1.1.1.1.1.1.3.16.cmml" xref="algx2.l36.m1.1.1.1.1.1.1.3.16">𝑢</ci><ci id="algx2.l36.m1.1.1.1.1.1.1.3.17.cmml" xref="algx2.l36.m1.1.1.1.1.1.1.3.17">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx2.l36.m1.1c">Y_{\text{fused}}\leftarrow\text{LayerNorm}(FeedForwardOutput+CrossModalOutput)</annotation><annotation encoding="application/x-llamapun" id="algx2.l36.m1.1d">italic_Y start_POSTSUBSCRIPT fused end_POSTSUBSCRIPT ← LayerNorm ( italic_F italic_e italic_e italic_d italic_F italic_o italic_r italic_w italic_a italic_r italic_d italic_O italic_u italic_t italic_p italic_u italic_t + italic_C italic_r italic_o italic_s italic_s italic_M italic_o italic_d italic_a italic_l italic_O italic_u italic_t italic_p italic_u italic_t )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algx2.l37">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="algx2.l37.1.1.1" style="font-size:80%;">37:</span></span>  <span class="ltx_text ltx_font_bold" id="algx2.l37.2">return</span>  <math alttext="Y_{\text{fused}}" class="ltx_Math" display="inline" id="algx2.l37.m1.1"><semantics id="algx2.l37.m1.1a"><msub id="algx2.l37.m1.1.1" xref="algx2.l37.m1.1.1.cmml"><mi id="algx2.l37.m1.1.1.2" xref="algx2.l37.m1.1.1.2.cmml">Y</mi><mtext id="algx2.l37.m1.1.1.3" xref="algx2.l37.m1.1.1.3a.cmml">fused</mtext></msub><annotation-xml encoding="MathML-Content" id="algx2.l37.m1.1b"><apply id="algx2.l37.m1.1.1.cmml" xref="algx2.l37.m1.1.1"><csymbol cd="ambiguous" id="algx2.l37.m1.1.1.1.cmml" xref="algx2.l37.m1.1.1">subscript</csymbol><ci id="algx2.l37.m1.1.1.2.cmml" xref="algx2.l37.m1.1.1.2">𝑌</ci><ci id="algx2.l37.m1.1.1.3a.cmml" xref="algx2.l37.m1.1.1.3"><mtext id="algx2.l37.m1.1.1.3.cmml" mathsize="70%" xref="algx2.l37.m1.1.1.3">fused</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algx2.l37.m1.1c">Y_{\text{fused}}</annotation><annotation encoding="application/x-llamapun" id="algx2.l37.m1.1d">italic_Y start_POSTSUBSCRIPT fused end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
</div>
</figure>
<section class="ltx_subsubsection" id="S4.SS3.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text" id="S4.SS3.SSS1.5.1.1">IV-C</span>1 </span>Data Fusion for Encoder</h4>
<div class="ltx_para" id="S4.SS3.SSS1.p1">
<p class="ltx_p" id="S4.SS3.SSS1.p1.4">As illustrated in the purple box within the gray section of Figure <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S4.F3" title="Figure 3 ‣ IV-B Appformer Framework Overview ‣ IV Method ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_tag">3</span></a>, considering that we segment data by user, where each app sequence corresponds to a series of repetitive numbers for User IDs, we start by concatenating the user vector <span class="ltx_text ltx_markedasmath ltx_font_bold" id="S4.SS3.SSS1.p1.4.1">u</span> with the app vector <span class="ltx_text ltx_markedasmath ltx_font_bold" id="S4.SS3.SSS1.p1.4.2">a</span>, followed by a simple fusion through a linear transformation. Next, the fused vector is used as the query (Q), with the POI vector <span class="ltx_text ltx_markedasmath ltx_font_bold" id="S4.SS3.SSS1.p1.4.3">l</span> serving as both key (K) and value (V), to perform cross-modal fusion using the Cross-Modal Data Fusion Module, thereby integrating location information. Subsequently, the fused vector, now as the Q, with the time vector <span class="ltx_text ltx_markedasmath ltx_font_bold" id="S4.SS3.SSS1.p1.4.4">t</span> as both K and V, undergoes another round of cross-modal fusion with the Cross-Modal Data Fusion Module to incorporate temporal details. Then, after performing a linear transformation and positional encoding on the fused vector, it serves as the input for the encoder of the feature extraction module.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS3.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text" id="S4.SS3.SSS2.5.1.1">IV-C</span>2 </span>Data Fusion for Decoder</h4>
<div class="ltx_para" id="S4.SS3.SSS2.p1">
<p class="ltx_p" id="S4.SS3.SSS2.p1.2">As illustrated in the green box within the gray section of Figure <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S4.F3" title="Figure 3 ‣ IV-B Appformer Framework Overview ‣ IV Method ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_tag">3</span></a>, given that the Decoder of the Feature Extraction Module requires the most critical information to decode the output from the Encoder (which will be detailed in the introduction of the Feature Extraction Module), we therefore designate the app vector <span class="ltx_text ltx_markedasmath ltx_font_bold" id="S4.SS3.SSS2.p1.2.1">a</span> as Q, and the POI vector <span class="ltx_text ltx_markedasmath ltx_font_bold" id="S4.SS3.SSS2.p1.2.2">l</span> as both K and V, conducting cross-modal fusion through the Cross-Modal Data Fusion Module. We concatenate the fused vector with a zero vector, which is specifically used for storing predicted values, and then proceed with linear transformation and positional encoding, making it the input for the Decoder of the Feature Extraction Module.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S4.SS4.5.1.1">IV-D</span> </span><span class="ltx_text ltx_font_italic" id="S4.SS4.6.2">Feature Extraction Module</span>
</h3>
<figure class="ltx_table" id="S4.T4">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE IV: </span>Detailed Comparison of Feature Extraction Methods for Mobile App Prediction</figcaption>
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T4.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T4.1.1.1">
<th class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_column ltx_border_tt" id="S4.T4.1.1.1.1" style="width:56.9pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T4.1.1.1.1.1">
<span class="ltx_p" id="S4.T4.1.1.1.1.1.1">Method</span>
</span>
</th>
<th class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_column ltx_border_tt" id="S4.T4.1.1.1.2" style="width:56.9pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T4.1.1.1.2.1">
<span class="ltx_p" id="S4.T4.1.1.1.2.1.1">Year</span>
</span>
</th>
<th class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_column ltx_border_tt" id="S4.T4.1.1.1.3" style="width:128.0pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T4.1.1.1.3.1">
<span class="ltx_p" id="S4.T4.1.1.1.3.1.1">Feature Extraction Method</span>
</span>
</th>
<th class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_column ltx_border_tt" id="S4.T4.1.1.1.4" style="width:227.6pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T4.1.1.1.4.1">
<span class="ltx_p" id="S4.T4.1.1.1.4.1.1">Applicability and Limitations of Feature Extraction</span>
</span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T4.1.2.1">
<td class="ltx_td ltx_align_justify ltx_align_middle ltx_border_t" id="S4.T4.1.2.1.1" style="width:56.9pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T4.1.2.1.1.1">
<span class="ltx_p" id="S4.T4.1.2.1.1.1.1">NAP<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib50" title=""><span class="ltx_text" style="font-size:80%;">50</span></a>]</cite></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_middle ltx_border_t" id="S4.T4.1.2.1.2" style="width:56.9pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T4.1.2.1.2.1">
<span class="ltx_p" id="S4.T4.1.2.1.2.1.1">Appl. Sci 2020</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_middle ltx_border_t" id="S4.T4.1.2.1.3" style="width:128.0pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T4.1.2.1.3.1">
<span class="ltx_p" id="S4.T4.1.2.1.3.1.1">LSTMs.</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_middle ltx_border_t" id="S4.T4.1.2.1.4" style="width:227.6pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T4.1.2.1.4.1">
<span class="ltx_itemize" id="S4.I4">
<span class="ltx_item" id="S4.I4.i1" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="S4.I4.i1.p1">
<span class="ltx_p" id="S4.I4.i1.p1.1">Excel at handling sequential data.</span>
</span></span>
<span class="ltx_item" id="S4.I4.i2" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="S4.I4.i2.p1">
<span class="ltx_p" id="S4.I4.i2.p1.1">Fall short in processing multimodal data, missing complex interactions.</span>
</span></span>
<span class="ltx_item" id="S4.I4.i3" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="S4.I4.i3.p1">
<span class="ltx_p" id="S4.I4.i3.p1.1">The linear approach of LSTMs struggles to adapt to dynamic relevancies and changes in application importance within sequences.</span>
</span></span>
</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.3.2">
<td class="ltx_td ltx_align_justify ltx_align_middle" id="S4.T4.1.3.2.1" style="width:56.9pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T4.1.3.2.1.1">
<span class="ltx_p" id="S4.T4.1.3.2.1.1.1">DeepApp<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib16" title=""><span class="ltx_text" style="font-size:80%;">16</span></a>]</cite></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_middle" id="S4.T4.1.3.2.2" style="width:56.9pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T4.1.3.2.2.1">
<span class="ltx_p" id="S4.T4.1.3.2.2.1.1">ACM TIST 2020</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_middle" id="S4.T4.1.3.2.3" style="width:128.0pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T4.1.3.2.3.1">
<span class="ltx_p" id="S4.T4.1.3.2.3.1.1">Uses multiple GRUs to analyze concatenated data, aiming to understand time patterns and user behavior.</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_middle" id="S4.T4.1.3.2.4" style="width:227.6pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T4.1.3.2.4.1">
<span class="ltx_itemize" id="S4.I5">
<span class="ltx_item" id="S4.I5.i1" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="S4.I5.i1.p1">
<span class="ltx_p" id="S4.I5.i1.p1.1">More efficient and use fewer resources than LSTMs for sequential predictions.</span>
</span></span>
<span class="ltx_item" id="S4.I5.i2" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="S4.I5.i2.p1">
<span class="ltx_p" id="S4.I5.i2.p1.1">Struggle with capturing deep temporal dependencies in certain scenarios.</span>
</span></span>
<span class="ltx_item" id="S4.I5.i3" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="S4.I5.i3.p1">
<span class="ltx_p" id="S4.I5.i3.p1.1">Prone to overlooking critical spatiotemporal interaction features.</span>
</span></span>
</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.4.3">
<td class="ltx_td ltx_align_justify ltx_align_middle" id="S4.T4.1.4.3.1" style="width:56.9pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T4.1.4.3.1.1">
<span class="ltx_p" id="S4.T4.1.4.3.1.1.1">PAULCI<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib51" title=""><span class="ltx_text" style="font-size:80%;">51</span></a>]</cite></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_middle" id="S4.T4.1.4.3.2" style="width:56.9pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T4.1.4.3.2.1">
<span class="ltx_p" id="S4.T4.1.4.3.2.1.1">Comput Commun 2022</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_middle" id="S4.T4.1.4.3.3" style="width:128.0pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T4.1.4.3.3.1">
<span class="ltx_p" id="S4.T4.1.4.3.3.1.1">Combines GRU networks with an Attention Layer to selectively focus on the most informative parts of the data sequence, enhancing prediction accuracy.</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_middle" id="S4.T4.1.4.3.4" style="width:227.6pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T4.1.4.3.4.1">
<span class="ltx_itemize" id="S4.I6">
<span class="ltx_item" id="S4.I6.i1" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="S4.I6.i1.p1">
<span class="ltx_p" id="S4.I6.i1.p1.1">Simple and straightforward, easy to deploy and optimize.</span>
</span></span>
<span class="ltx_item" id="S4.I6.i2" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="S4.I6.i2.p1">
<span class="ltx_p" id="S4.I6.i2.p1.1">Applying attention mechanisms too simplistically misses key features in complex multimodal inputs.</span>
</span></span>
<span class="ltx_item" id="S4.I6.i3" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="S4.I6.i3.p1">
<span class="ltx_p" id="S4.I6.i3.p1.1">The fixed structure hampers adjustments or improvements for new requirements.</span>
</span></span>
</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.5.4">
<td class="ltx_td ltx_align_justify ltx_align_middle" id="S4.T4.1.5.4.1" style="width:56.9pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T4.1.5.4.1.1">
<span class="ltx_p" id="S4.T4.1.5.4.1.1.1">AppUsage2Vec<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib47" title=""><span class="ltx_text" style="font-size:80%;">47</span></a>]</cite></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_middle" id="S4.T4.1.5.4.2" style="width:56.9pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T4.1.5.4.2.1">
<span class="ltx_p" id="S4.T4.1.5.4.2.1.1">ICDE 2019</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_middle" id="S4.T4.1.5.4.3" style="width:128.0pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T4.1.5.4.3.1">
<span class="ltx_p" id="S4.T4.1.5.4.3.1.1">Dual Deep Neural Networks (Dual-DNNs) employ two separate DNNs to independently extract user and application features before merging them.</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_middle" id="S4.T4.1.5.4.4" style="width:227.6pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T4.1.5.4.4.1">
<span class="ltx_itemize" id="S4.I7">
<span class="ltx_item" id="S4.I7.i1" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="S4.I7.i1.p1">
<span class="ltx_p" id="S4.I7.i1.p1.1">Allows for specialized processing of user and application data.</span>
</span></span>
<span class="ltx_item" id="S4.I7.i2" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="S4.I7.i2.p1">
<span class="ltx_p" id="S4.I7.i2.p1.1">May overlook complex multimodal interactions, leading to potential loss of context and inefficiency.</span>
</span></span>
<span class="ltx_item" id="S4.I7.i3" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="S4.I7.i3.p1">
<span class="ltx_p" id="S4.I7.i3.p1.1">Dual-DNNs are modular but lack adaptability.</span>
</span></span>
</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.6.5">
<td class="ltx_td ltx_align_justify ltx_align_middle ltx_border_bb" id="S4.T4.1.6.5.1" style="width:56.9pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T4.1.6.5.1.1">
<span class="ltx_p" id="S4.T4.1.6.5.1.1.1">DUGN<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib49" title=""><span class="ltx_text" style="font-size:80%;">49</span></a>]</cite></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_middle ltx_border_bb" id="S4.T4.1.6.5.2" style="width:56.9pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T4.1.6.5.2.1">
<span class="ltx_p" id="S4.T4.1.6.5.2.1.1">IEEE TMC 2023</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_middle ltx_border_bb" id="S4.T4.1.6.5.3" style="width:128.0pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T4.1.6.5.3.1">
<span class="ltx_p" id="S4.T4.1.6.5.3.1.1">Utilizes a combination of temporal gating mechanisms, hierarchical graph attention networks, and self-attention mechanisms to deeply understand user interests and their evolution.</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_middle ltx_border_bb" id="S4.T4.1.6.5.4" style="width:227.6pt;">
<span class="ltx_inline-block ltx_align_top" id="S4.T4.1.6.5.4.1">
<span class="ltx_itemize" id="S4.I8">
<span class="ltx_item" id="S4.I8.i1" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="S4.I8.i1.p1">
<span class="ltx_p" id="S4.I8.i1.p1.1">Effectively captures user preferences.</span>
</span></span>
<span class="ltx_item" id="S4.I8.i2" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="S4.I8.i2.p1">
<span class="ltx_p" id="S4.I8.i2.p1.1">Performance relies on data quality.</span>
</span></span>
<span class="ltx_item" id="S4.I8.i3" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="S4.I8.i3.p1">
<span class="ltx_p" id="S4.I8.i3.p1.1">Adaptability is limited by fixed structure.</span>
</span></span>
<span class="ltx_item" id="S4.I8.i4" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="S4.I8.i4.p1">
<span class="ltx_p" id="S4.I8.i4.p1.1">Ignoring multimodal data can reduce accuracy.</span>
</span></span>
</span>
</span>
</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.1">After conducting an in-depth analysis of existing feature extraction methods for mobile application data (as shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S4.T4" title="TABLE IV ‣ IV-D Feature Extraction Module ‣ IV Method ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_tag">IV</span></a>), we identified limitations in their ability to maintain the richness of information in complex data environments and a lack of flexibility to adapt to new data types or evolving tasks. These limitations hindered the models’ ability to capture subtle relationships within the data, thereby constraining their predictive capabilities. To overcome these challenges and enhance predictive performance, we proposed a series of improvements, including adopting an Encoder-Decoder architecture to extract features that reflect the complex relationships within the data, introducing attention mechanisms to prioritize important features while reducing noise, and designing modular and replaceable feature extraction methods to improve model performance and adaptability. Leveraging these enhancements, we crafted an Feature Extraction Module as depicted in the yellow segment of Figure <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S4.F3" title="Figure 3 ‣ IV-B Appformer Framework Overview ‣ IV Method ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_tag">3</span></a>, adeptly tackling the previously mentioned challenges.</p>
</div>
<section class="ltx_subsubsection" id="S4.SS4.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text" id="S4.SS4.SSS1.5.1.1">IV-D</span>1 </span>Encoder and Decoder Architecture</h4>
<div class="ltx_para" id="S4.SS4.SSS1.p1">
<p class="ltx_p" id="S4.SS4.SSS1.p1.1">The Feature Extraction Module adopts the classic Encoder-Decoder architecture inspired by the Transformer architecture proposed by Vaswani et al.<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib61" title=""><span class="ltx_text" style="font-size:80%;">61</span></a>]</cite>. In this framework, the Encoder’s primary responsibility is to receive fused multi-modal data and transform it into a complex high-dimensional representation. This transformation leverages a combination of Multi-Head Self-Attention and Feed Forward networks to intricately capture the dependencies within the data. The Decoder, on the other hand, is tasked with decoding this high-dimensional representation and combining it with an additional conditional vector to produce the target sequence. The interaction between the Encoder and Decoder is facilitated through the Cross-Modal Data Fusion Module. We take the vector from the last dimension, which is specifically used for storing predicted values, and after applying a linear transformation, use it as the final output.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS4.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text" id="S4.SS4.SSS2.5.1.1">IV-D</span>2 </span>Differentiating Between Encoder and Decoder Inputs</h4>
<div class="ltx_para" id="S4.SS4.SSS2.p1">
<p class="ltx_p" id="S4.SS4.SSS2.p1.1">Given the distinct functions of the Encoder and Decoder, it is crucial to input the complete dataset into the Encoder to obtain a richer and more comprehensive feature vector. For the Decoder, selectively providing key information aids in more effective decoding, avoiding the interference of redundant information. According to the results from the Section <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S6.SS4" title="VI-D Ablation experiment of Appformer Decoder input ‣ VI Result ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">VI-D</span></span></a> providing the Decoder with a fused vector of app and POI vectors yields the best results.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS4.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text" id="S4.SS4.SSS3.5.1.1">IV-D</span>3 </span>Modular Design Analysis</h4>
<div class="ltx_para" id="S4.SS4.SSS3.p1">
<p class="ltx_p" id="S4.SS4.SSS3.p1.1">A key feature of our Feature Extraction Module is its modularity, which allows for easy swapping of its components with those from other well-known architectures. We conducted experiments by replacing corresponding parts of our Feature Extraction Module with modules from AutoFormer, FEDformer, and Quatformer. This was done to test the flexibility and potential improvements that could be achieved with our current architecture. The outcomes of this comparative analysis will be detailed in Section <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S6.SS5" title="VI-E Feature Extraction Module comparison experiment ‣ VI Result ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">VI-E</span></span></a>. This modular design not only proves the adaptability of our model but also paves the way for future enhancements by incorporating more sophisticated modules as they become available.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">V </span><span class="ltx_text ltx_font_smallcaps" id="S5.1.1">Experiments</span>
</h2>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S5.SS1.5.1.1">V-A</span> </span><span class="ltx_text ltx_font_italic" id="S5.SS1.6.2">Evaluation metrics</span>
</h3>
<div class="ltx_para" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.1">We use four distinct metrics to evaluate the effectiveness of different methods: Hit@k (Hit rate at k), MRR@k (Mean Reciprocal Rank at k), NDCG@k (Normalized Discounted Cumulative Gain at k) and F1 score with a macro setting.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S5.SS2.5.1.1">V-B</span> </span><span class="ltx_text ltx_font_italic" id="S5.SS2.6.2">Baselines</span>
</h3>
<div class="ltx_para" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.1">In our study, we conduct comparisons with several classic and advanced methods to validate the performance of our proposed framework. These methods include traditional machine learning classifiers as well as various deep learning models.</p>
</div>
<div class="ltx_para" id="S5.SS2.p2">
<p class="ltx_p" id="S5.SS2.p2.1">In our experiments, we compare our method with the traditional machine learning classifiers: random forest<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib62" title=""><span class="ltx_text" style="font-size:80%;">62</span></a>]</cite>, logistic regression<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib63" title=""><span class="ltx_text" style="font-size:80%;">63</span></a>]</cite>, XGBoost<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib64" title=""><span class="ltx_text" style="font-size:80%;">64</span></a>]</cite>. We also compare our method with the deep learning methods:</p>
</div>
<div class="ltx_para" id="S5.SS2.p3">
<p class="ltx_p" id="S5.SS2.p3.1"><span class="ltx_text ltx_font_bold" id="S5.SS2.p3.1.1">MLP (Multi-Layer Perceptron):</span> This model utilized a multi-layer perceptron with 100 neurons, employed the <math alttext="ReLU" class="ltx_Math" display="inline" id="S5.SS2.p3.1.m1.1"><semantics id="S5.SS2.p3.1.m1.1a"><mrow id="S5.SS2.p3.1.m1.1.1" xref="S5.SS2.p3.1.m1.1.1.cmml"><mi id="S5.SS2.p3.1.m1.1.1.2" xref="S5.SS2.p3.1.m1.1.1.2.cmml">R</mi><mo id="S5.SS2.p3.1.m1.1.1.1" xref="S5.SS2.p3.1.m1.1.1.1.cmml">⁢</mo><mi id="S5.SS2.p3.1.m1.1.1.3" xref="S5.SS2.p3.1.m1.1.1.3.cmml">e</mi><mo id="S5.SS2.p3.1.m1.1.1.1a" xref="S5.SS2.p3.1.m1.1.1.1.cmml">⁢</mo><mi id="S5.SS2.p3.1.m1.1.1.4" xref="S5.SS2.p3.1.m1.1.1.4.cmml">L</mi><mo id="S5.SS2.p3.1.m1.1.1.1b" xref="S5.SS2.p3.1.m1.1.1.1.cmml">⁢</mo><mi id="S5.SS2.p3.1.m1.1.1.5" xref="S5.SS2.p3.1.m1.1.1.5.cmml">U</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.1.m1.1b"><apply id="S5.SS2.p3.1.m1.1.1.cmml" xref="S5.SS2.p3.1.m1.1.1"><times id="S5.SS2.p3.1.m1.1.1.1.cmml" xref="S5.SS2.p3.1.m1.1.1.1"></times><ci id="S5.SS2.p3.1.m1.1.1.2.cmml" xref="S5.SS2.p3.1.m1.1.1.2">𝑅</ci><ci id="S5.SS2.p3.1.m1.1.1.3.cmml" xref="S5.SS2.p3.1.m1.1.1.3">𝑒</ci><ci id="S5.SS2.p3.1.m1.1.1.4.cmml" xref="S5.SS2.p3.1.m1.1.1.4">𝐿</ci><ci id="S5.SS2.p3.1.m1.1.1.5.cmml" xref="S5.SS2.p3.1.m1.1.1.5">𝑈</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.1.m1.1c">ReLU</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p3.1.m1.1d">italic_R italic_e italic_L italic_U</annotation></semantics></math> activation function, and used a softmax layer for application prediction.</p>
</div>
<div class="ltx_para" id="S5.SS2.p4">
<p class="ltx_p" id="S5.SS2.p4.1"><span class="ltx_text ltx_font_bold" id="S5.SS2.p4.1.1">LSTM (Long Short-Term Memory)<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib65" title=""><span class="ltx_text" style="font-size:80%;">65</span></a>]</cite>:</span> This model employed the LSTM architecture, capable of handling long and short sequences, and used a softmax layer for predicting the next application.</p>
</div>
<div class="ltx_para" id="S5.SS2.p5">
<p class="ltx_p" id="S5.SS2.p5.1"><span class="ltx_text ltx_font_bold" id="S5.SS2.p5.1.1">GRU (Gate Recurrent Unit)<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib66" title=""><span class="ltx_text" style="font-size:80%;">66</span></a>]</cite>:</span> Similar to LSTM, GRU could process long and short sequences and utilized a softmax layer for application predictions.</p>
</div>
<div class="ltx_para" id="S5.SS2.p6">
<p class="ltx_p" id="S5.SS2.p6.1"><span class="ltx_text ltx_font_bold" id="S5.SS2.p6.1.1">PCA(Principal Component Analysis) and LSTM<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib67" title=""><span class="ltx_text" style="font-size:80%;">67</span></a>]</cite>:</span> This method applied PCA to spatial, application, and temporal information, which was then fed into two LSTM models. Finally, a softmax layer was used for predicting the next application.</p>
</div>
<div class="ltx_para" id="S5.SS2.p7">
<p class="ltx_p" id="S5.SS2.p7.1"><span class="ltx_text ltx_font_bold" id="S5.SS2.p7.1.1">NAP(Natural App Processing)<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib50" title=""><span class="ltx_text" style="font-size:80%;">50</span></a>]</cite>:</span> The NAP framework consisted of two LSTM layers, a Dropout layer, and a softmax layer to provide application prediction.</p>
</div>
<div class="ltx_para" id="S5.SS2.p8">
<p class="ltx_p" id="S5.SS2.p8.1"><span class="ltx_text ltx_font_bold" id="S5.SS2.p8.1.1">AppUsage2Vec<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib47" title=""><span class="ltx_text" style="font-size:80%;">47</span></a>]</cite>:</span> This model represented applications, time, and users as latent vectors, employed an attention network to capture the importance of each application, and used deep neural networks for application predictions.</p>
</div>
<div class="ltx_para" id="S5.SS2.p9">
<p class="ltx_p" id="S5.SS2.p9.1"><span class="ltx_text ltx_font_bold" id="S5.SS2.p9.1.1">DeepApp<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib16" title=""><span class="ltx_text" style="font-size:80%;">16</span></a>]</cite>:</span> DeepApp utilized multitask learning, mapping time, location, and applications to embeddings. It used a combination of GRU and linear layers for application predictions, along with tasks for user identification and location prediction.</p>
</div>
<div class="ltx_para" id="S5.SS2.p10">
<p class="ltx_p" id="S5.SS2.p10.1"><span class="ltx_text ltx_font_bold" id="S5.SS2.p10.1.1">PAULCI<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib51" title=""><span class="ltx_text" style="font-size:80%;">51</span></a>]</cite>:</span> This approach focuses on capturing spatial and temporal contexts using graph embeddings and multimodal embeddings. It incorporates a GRU, attention layer, and softmax layer to predict application usage, showcasing superior performance compared to traditional methods.</p>
</div>
<div class="ltx_para" id="S5.SS2.p11">
<p class="ltx_p" id="S5.SS2.p11.1"><span class="ltx_text ltx_font_bold" id="S5.SS2.p11.1.1">DUGN<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib49" title=""><span class="ltx_text" style="font-size:80%;">49</span></a>]</cite>:</span> DUGN leverages a dynamic graph structure to capture intricate app correlations and learn user interest dynamics. It first extracts user interests from each app usage graph using a hierarchical graph attention mechanism. The model then tracks these interests over time, creating dynamic user embeddings by modeling temporal dependencies across multiple app usage graphs. Finally, it identifies current user interests within the present app usage graph, fuses multiple interests, and generates comprehensive user embeddings for future app recommendations.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S5.SS3.5.1.1">V-C</span> </span><span class="ltx_text ltx_font_italic" id="S5.SS3.6.2">Experimental setup</span>
</h3>
<section class="ltx_subsubsection" id="S5.SS3.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text" id="S5.SS3.SSS1.5.1.1">V-C</span>1 </span>Model parameter settings</h4>
<div class="ltx_para" id="S5.SS3.SSS1.p1">
<ul class="ltx_itemize" id="S5.I1">
<li class="ltx_item" id="S5.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i1.p1">
<p class="ltx_p" id="S5.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I1.i1.p1.1.1">Sequence Length Setting:</span> In determining the optimal sequence length for our model, we conducted a thorough review of existing literature in the field. Based on findings from relevant studies<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib16" title=""><span class="ltx_text" style="font-size:80%;">16</span></a>]</cite><cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib47" title=""><span class="ltx_text" style="font-size:80%;">47</span></a>]</cite><cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib51" title=""><span class="ltx_text" style="font-size:80%;">51</span></a>]</cite>, we set the parameter <math alttext="m" class="ltx_Math" display="inline" id="S5.I1.i1.p1.1.m1.1"><semantics id="S5.I1.i1.p1.1.m1.1a"><mi id="S5.I1.i1.p1.1.m1.1.1" xref="S5.I1.i1.p1.1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S5.I1.i1.p1.1.m1.1b"><ci id="S5.I1.i1.p1.1.m1.1.1.cmml" xref="S5.I1.i1.p1.1.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.I1.i1.p1.1.m1.1c">m</annotation><annotation encoding="application/x-llamapun" id="S5.I1.i1.p1.1.m1.1d">italic_m</annotation></semantics></math> in Equation <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S3.E1" title="In III-A Problem Description ‣ III Problem Description And Dataset ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_tag">1</span></a> to 4, meaning that the prediction of the next app usage is based on the information related to the most recent four apps used by the user.</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i2.p1">
<p class="ltx_p" id="S5.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I1.i2.p1.1.1">Embedding Dimensions:</span> Drawing inspiration from the work of Yin <span class="ltx_text ltx_font_italic" id="S5.I1.i2.p1.1.2">et al.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib68" title=""><span class="ltx_text" style="font-size:80%;">68</span></a>]</cite>, we tailored the embedding dimensions for user, time, and app sequences. Specifically, we set the embedding dimension for user sequences at 16, for app sequences at 64, and for each time unit at 12, which includes month, day, weekday, hour and minute.</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i3.p1">
<p class="ltx_p" id="S5.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I1.i3.p1.1.1">Configuration of Cluster Centers for POI Data:</span> We set the number of cluster centers in the K-Modes clustering algorithm for POI data clustering to 5. The specific determination of the number of cluster centers will be detailed in Section <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S6.SS6" title="VI-F Clustering experiment on the POI data ‣ VI Result ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">VI-F</span></span></a>.</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i4.p1">
<p class="ltx_p" id="S5.I1.i4.p1.5"><span class="ltx_text ltx_font_bold" id="S5.I1.i4.p1.5.1">Framework Configuration:</span> In Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#alg2" title="Algorithm 2 ‣ IV-C Multi-Modal Data Progressive Fusion Module ‣ IV Method ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_tag">2</span></a>, we configure the parameters as follows: model dimension (<math alttext="d_{\text{model}}" class="ltx_Math" display="inline" id="S5.I1.i4.p1.1.m1.1"><semantics id="S5.I1.i4.p1.1.m1.1a"><msub id="S5.I1.i4.p1.1.m1.1.1" xref="S5.I1.i4.p1.1.m1.1.1.cmml"><mi id="S5.I1.i4.p1.1.m1.1.1.2" xref="S5.I1.i4.p1.1.m1.1.1.2.cmml">d</mi><mtext id="S5.I1.i4.p1.1.m1.1.1.3" xref="S5.I1.i4.p1.1.m1.1.1.3a.cmml">model</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.I1.i4.p1.1.m1.1b"><apply id="S5.I1.i4.p1.1.m1.1.1.cmml" xref="S5.I1.i4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.I1.i4.p1.1.m1.1.1.1.cmml" xref="S5.I1.i4.p1.1.m1.1.1">subscript</csymbol><ci id="S5.I1.i4.p1.1.m1.1.1.2.cmml" xref="S5.I1.i4.p1.1.m1.1.1.2">𝑑</ci><ci id="S5.I1.i4.p1.1.m1.1.1.3a.cmml" xref="S5.I1.i4.p1.1.m1.1.1.3"><mtext id="S5.I1.i4.p1.1.m1.1.1.3.cmml" mathsize="70%" xref="S5.I1.i4.p1.1.m1.1.1.3">model</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.I1.i4.p1.1.m1.1c">d_{\text{model}}</annotation><annotation encoding="application/x-llamapun" id="S5.I1.i4.p1.1.m1.1d">italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT</annotation></semantics></math>) is set to 128, number of attention heads (<math alttext="num\_heads" class="ltx_Math" display="inline" id="S5.I1.i4.p1.2.m2.1"><semantics id="S5.I1.i4.p1.2.m2.1a"><mrow id="S5.I1.i4.p1.2.m2.1.1" xref="S5.I1.i4.p1.2.m2.1.1.cmml"><mi id="S5.I1.i4.p1.2.m2.1.1.2" xref="S5.I1.i4.p1.2.m2.1.1.2.cmml">n</mi><mo id="S5.I1.i4.p1.2.m2.1.1.1" xref="S5.I1.i4.p1.2.m2.1.1.1.cmml">⁢</mo><mi id="S5.I1.i4.p1.2.m2.1.1.3" xref="S5.I1.i4.p1.2.m2.1.1.3.cmml">u</mi><mo id="S5.I1.i4.p1.2.m2.1.1.1a" xref="S5.I1.i4.p1.2.m2.1.1.1.cmml">⁢</mo><mi id="S5.I1.i4.p1.2.m2.1.1.4" xref="S5.I1.i4.p1.2.m2.1.1.4.cmml">m</mi><mo id="S5.I1.i4.p1.2.m2.1.1.1b" xref="S5.I1.i4.p1.2.m2.1.1.1.cmml">⁢</mo><mi id="S5.I1.i4.p1.2.m2.1.1.5" mathvariant="normal" xref="S5.I1.i4.p1.2.m2.1.1.5.cmml">_</mi><mo id="S5.I1.i4.p1.2.m2.1.1.1c" xref="S5.I1.i4.p1.2.m2.1.1.1.cmml">⁢</mo><mi id="S5.I1.i4.p1.2.m2.1.1.6" xref="S5.I1.i4.p1.2.m2.1.1.6.cmml">h</mi><mo id="S5.I1.i4.p1.2.m2.1.1.1d" xref="S5.I1.i4.p1.2.m2.1.1.1.cmml">⁢</mo><mi id="S5.I1.i4.p1.2.m2.1.1.7" xref="S5.I1.i4.p1.2.m2.1.1.7.cmml">e</mi><mo id="S5.I1.i4.p1.2.m2.1.1.1e" xref="S5.I1.i4.p1.2.m2.1.1.1.cmml">⁢</mo><mi id="S5.I1.i4.p1.2.m2.1.1.8" xref="S5.I1.i4.p1.2.m2.1.1.8.cmml">a</mi><mo id="S5.I1.i4.p1.2.m2.1.1.1f" xref="S5.I1.i4.p1.2.m2.1.1.1.cmml">⁢</mo><mi id="S5.I1.i4.p1.2.m2.1.1.9" xref="S5.I1.i4.p1.2.m2.1.1.9.cmml">d</mi><mo id="S5.I1.i4.p1.2.m2.1.1.1g" xref="S5.I1.i4.p1.2.m2.1.1.1.cmml">⁢</mo><mi id="S5.I1.i4.p1.2.m2.1.1.10" xref="S5.I1.i4.p1.2.m2.1.1.10.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.I1.i4.p1.2.m2.1b"><apply id="S5.I1.i4.p1.2.m2.1.1.cmml" xref="S5.I1.i4.p1.2.m2.1.1"><times id="S5.I1.i4.p1.2.m2.1.1.1.cmml" xref="S5.I1.i4.p1.2.m2.1.1.1"></times><ci id="S5.I1.i4.p1.2.m2.1.1.2.cmml" xref="S5.I1.i4.p1.2.m2.1.1.2">𝑛</ci><ci id="S5.I1.i4.p1.2.m2.1.1.3.cmml" xref="S5.I1.i4.p1.2.m2.1.1.3">𝑢</ci><ci id="S5.I1.i4.p1.2.m2.1.1.4.cmml" xref="S5.I1.i4.p1.2.m2.1.1.4">𝑚</ci><ci id="S5.I1.i4.p1.2.m2.1.1.5.cmml" xref="S5.I1.i4.p1.2.m2.1.1.5">_</ci><ci id="S5.I1.i4.p1.2.m2.1.1.6.cmml" xref="S5.I1.i4.p1.2.m2.1.1.6">ℎ</ci><ci id="S5.I1.i4.p1.2.m2.1.1.7.cmml" xref="S5.I1.i4.p1.2.m2.1.1.7">𝑒</ci><ci id="S5.I1.i4.p1.2.m2.1.1.8.cmml" xref="S5.I1.i4.p1.2.m2.1.1.8">𝑎</ci><ci id="S5.I1.i4.p1.2.m2.1.1.9.cmml" xref="S5.I1.i4.p1.2.m2.1.1.9">𝑑</ci><ci id="S5.I1.i4.p1.2.m2.1.1.10.cmml" xref="S5.I1.i4.p1.2.m2.1.1.10">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.I1.i4.p1.2.m2.1c">num\_heads</annotation><annotation encoding="application/x-llamapun" id="S5.I1.i4.p1.2.m2.1d">italic_n italic_u italic_m _ italic_h italic_e italic_a italic_d italic_s</annotation></semantics></math>) to 8, dropout rate (<math alttext="dropout\_rate" class="ltx_Math" display="inline" id="S5.I1.i4.p1.3.m3.1"><semantics id="S5.I1.i4.p1.3.m3.1a"><mrow id="S5.I1.i4.p1.3.m3.1.1" xref="S5.I1.i4.p1.3.m3.1.1.cmml"><mi id="S5.I1.i4.p1.3.m3.1.1.2" xref="S5.I1.i4.p1.3.m3.1.1.2.cmml">d</mi><mo id="S5.I1.i4.p1.3.m3.1.1.1" xref="S5.I1.i4.p1.3.m3.1.1.1.cmml">⁢</mo><mi id="S5.I1.i4.p1.3.m3.1.1.3" xref="S5.I1.i4.p1.3.m3.1.1.3.cmml">r</mi><mo id="S5.I1.i4.p1.3.m3.1.1.1a" xref="S5.I1.i4.p1.3.m3.1.1.1.cmml">⁢</mo><mi id="S5.I1.i4.p1.3.m3.1.1.4" xref="S5.I1.i4.p1.3.m3.1.1.4.cmml">o</mi><mo id="S5.I1.i4.p1.3.m3.1.1.1b" xref="S5.I1.i4.p1.3.m3.1.1.1.cmml">⁢</mo><mi id="S5.I1.i4.p1.3.m3.1.1.5" xref="S5.I1.i4.p1.3.m3.1.1.5.cmml">p</mi><mo id="S5.I1.i4.p1.3.m3.1.1.1c" xref="S5.I1.i4.p1.3.m3.1.1.1.cmml">⁢</mo><mi id="S5.I1.i4.p1.3.m3.1.1.6" xref="S5.I1.i4.p1.3.m3.1.1.6.cmml">o</mi><mo id="S5.I1.i4.p1.3.m3.1.1.1d" xref="S5.I1.i4.p1.3.m3.1.1.1.cmml">⁢</mo><mi id="S5.I1.i4.p1.3.m3.1.1.7" xref="S5.I1.i4.p1.3.m3.1.1.7.cmml">u</mi><mo id="S5.I1.i4.p1.3.m3.1.1.1e" xref="S5.I1.i4.p1.3.m3.1.1.1.cmml">⁢</mo><mi id="S5.I1.i4.p1.3.m3.1.1.8" xref="S5.I1.i4.p1.3.m3.1.1.8.cmml">t</mi><mo id="S5.I1.i4.p1.3.m3.1.1.1f" xref="S5.I1.i4.p1.3.m3.1.1.1.cmml">⁢</mo><mi id="S5.I1.i4.p1.3.m3.1.1.9" mathvariant="normal" xref="S5.I1.i4.p1.3.m3.1.1.9.cmml">_</mi><mo id="S5.I1.i4.p1.3.m3.1.1.1g" xref="S5.I1.i4.p1.3.m3.1.1.1.cmml">⁢</mo><mi id="S5.I1.i4.p1.3.m3.1.1.10" xref="S5.I1.i4.p1.3.m3.1.1.10.cmml">r</mi><mo id="S5.I1.i4.p1.3.m3.1.1.1h" xref="S5.I1.i4.p1.3.m3.1.1.1.cmml">⁢</mo><mi id="S5.I1.i4.p1.3.m3.1.1.11" xref="S5.I1.i4.p1.3.m3.1.1.11.cmml">a</mi><mo id="S5.I1.i4.p1.3.m3.1.1.1i" xref="S5.I1.i4.p1.3.m3.1.1.1.cmml">⁢</mo><mi id="S5.I1.i4.p1.3.m3.1.1.12" xref="S5.I1.i4.p1.3.m3.1.1.12.cmml">t</mi><mo id="S5.I1.i4.p1.3.m3.1.1.1j" xref="S5.I1.i4.p1.3.m3.1.1.1.cmml">⁢</mo><mi id="S5.I1.i4.p1.3.m3.1.1.13" xref="S5.I1.i4.p1.3.m3.1.1.13.cmml">e</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.I1.i4.p1.3.m3.1b"><apply id="S5.I1.i4.p1.3.m3.1.1.cmml" xref="S5.I1.i4.p1.3.m3.1.1"><times id="S5.I1.i4.p1.3.m3.1.1.1.cmml" xref="S5.I1.i4.p1.3.m3.1.1.1"></times><ci id="S5.I1.i4.p1.3.m3.1.1.2.cmml" xref="S5.I1.i4.p1.3.m3.1.1.2">𝑑</ci><ci id="S5.I1.i4.p1.3.m3.1.1.3.cmml" xref="S5.I1.i4.p1.3.m3.1.1.3">𝑟</ci><ci id="S5.I1.i4.p1.3.m3.1.1.4.cmml" xref="S5.I1.i4.p1.3.m3.1.1.4">𝑜</ci><ci id="S5.I1.i4.p1.3.m3.1.1.5.cmml" xref="S5.I1.i4.p1.3.m3.1.1.5">𝑝</ci><ci id="S5.I1.i4.p1.3.m3.1.1.6.cmml" xref="S5.I1.i4.p1.3.m3.1.1.6">𝑜</ci><ci id="S5.I1.i4.p1.3.m3.1.1.7.cmml" xref="S5.I1.i4.p1.3.m3.1.1.7">𝑢</ci><ci id="S5.I1.i4.p1.3.m3.1.1.8.cmml" xref="S5.I1.i4.p1.3.m3.1.1.8">𝑡</ci><ci id="S5.I1.i4.p1.3.m3.1.1.9.cmml" xref="S5.I1.i4.p1.3.m3.1.1.9">_</ci><ci id="S5.I1.i4.p1.3.m3.1.1.10.cmml" xref="S5.I1.i4.p1.3.m3.1.1.10">𝑟</ci><ci id="S5.I1.i4.p1.3.m3.1.1.11.cmml" xref="S5.I1.i4.p1.3.m3.1.1.11">𝑎</ci><ci id="S5.I1.i4.p1.3.m3.1.1.12.cmml" xref="S5.I1.i4.p1.3.m3.1.1.12">𝑡</ci><ci id="S5.I1.i4.p1.3.m3.1.1.13.cmml" xref="S5.I1.i4.p1.3.m3.1.1.13">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.I1.i4.p1.3.m3.1c">dropout\_rate</annotation><annotation encoding="application/x-llamapun" id="S5.I1.i4.p1.3.m3.1d">italic_d italic_r italic_o italic_p italic_o italic_u italic_t _ italic_r italic_a italic_t italic_e</annotation></semantics></math>) to 0.05 and Feed Forward network dimension (<math alttext="d_{\text{ff}}" class="ltx_Math" display="inline" id="S5.I1.i4.p1.4.m4.1"><semantics id="S5.I1.i4.p1.4.m4.1a"><msub id="S5.I1.i4.p1.4.m4.1.1" xref="S5.I1.i4.p1.4.m4.1.1.cmml"><mi id="S5.I1.i4.p1.4.m4.1.1.2" xref="S5.I1.i4.p1.4.m4.1.1.2.cmml">d</mi><mtext id="S5.I1.i4.p1.4.m4.1.1.3" xref="S5.I1.i4.p1.4.m4.1.1.3a.cmml">ff</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.I1.i4.p1.4.m4.1b"><apply id="S5.I1.i4.p1.4.m4.1.1.cmml" xref="S5.I1.i4.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S5.I1.i4.p1.4.m4.1.1.1.cmml" xref="S5.I1.i4.p1.4.m4.1.1">subscript</csymbol><ci id="S5.I1.i4.p1.4.m4.1.1.2.cmml" xref="S5.I1.i4.p1.4.m4.1.1.2">𝑑</ci><ci id="S5.I1.i4.p1.4.m4.1.1.3a.cmml" xref="S5.I1.i4.p1.4.m4.1.1.3"><mtext id="S5.I1.i4.p1.4.m4.1.1.3.cmml" mathsize="70%" xref="S5.I1.i4.p1.4.m4.1.1.3">ff</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.I1.i4.p1.4.m4.1c">d_{\text{ff}}</annotation><annotation encoding="application/x-llamapun" id="S5.I1.i4.p1.4.m4.1d">italic_d start_POSTSUBSCRIPT ff end_POSTSUBSCRIPT</annotation></semantics></math>) to 512. Moreover, we set <math alttext="N=2" class="ltx_Math" display="inline" id="S5.I1.i4.p1.5.m5.1"><semantics id="S5.I1.i4.p1.5.m5.1a"><mrow id="S5.I1.i4.p1.5.m5.1.1" xref="S5.I1.i4.p1.5.m5.1.1.cmml"><mi id="S5.I1.i4.p1.5.m5.1.1.2" xref="S5.I1.i4.p1.5.m5.1.1.2.cmml">N</mi><mo id="S5.I1.i4.p1.5.m5.1.1.1" xref="S5.I1.i4.p1.5.m5.1.1.1.cmml">=</mo><mn id="S5.I1.i4.p1.5.m5.1.1.3" xref="S5.I1.i4.p1.5.m5.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.I1.i4.p1.5.m5.1b"><apply id="S5.I1.i4.p1.5.m5.1.1.cmml" xref="S5.I1.i4.p1.5.m5.1.1"><eq id="S5.I1.i4.p1.5.m5.1.1.1.cmml" xref="S5.I1.i4.p1.5.m5.1.1.1"></eq><ci id="S5.I1.i4.p1.5.m5.1.1.2.cmml" xref="S5.I1.i4.p1.5.m5.1.1.2">𝑁</ci><cn id="S5.I1.i4.p1.5.m5.1.1.3.cmml" type="integer" xref="S5.I1.i4.p1.5.m5.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.I1.i4.p1.5.m5.1c">N=2</annotation><annotation encoding="application/x-llamapun" id="S5.I1.i4.p1.5.m5.1d">italic_N = 2</annotation></semantics></math> in Figure <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S4.F3" title="Figure 3 ‣ IV-B Appformer Framework Overview ‣ IV Method ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_tag">3</span></a>, indicating that the Feature Extraction Module comprises 2 encoder blocks and 2 decoder blocks.</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i5.p1">
<p class="ltx_p" id="S5.I1.i5.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I1.i5.p1.1.1">Training Regimen:</span> We set the training epochs to 20, batch size to 128, and used an Adam optimizer with a learning rate of 0.001 to update model parameters. Experiments are implemented on a GPU by PyTorch.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_subsubsection" id="S5.SS3.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span class="ltx_text" id="S5.SS3.SSS2.5.1.1">V-C</span>2 </span>Dataset cleaning and partitioning</h4>
<div class="ltx_para" id="S5.SS3.SSS2.p1">
<p class="ltx_p" id="S5.SS3.SSS2.p1.1">Through literature review, we have identified the latest and optimal results on this dataset, which are presented in two papers PAULCI<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib51" title=""><span class="ltx_text" style="font-size:80%;">51</span></a>]</cite> and DUGN<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib49" title=""><span class="ltx_text" style="font-size:80%;">49</span></a>]</cite>, published in Computer Communications and IEEE Transactions on Mobile Computing, respectively. These two papers adopted different data cleaning and partitioning methods:</p>
<ul class="ltx_itemize" id="S5.I2">
<li class="ltx_item" id="S5.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I2.i1.p1">
<p class="ltx_p" id="S5.I2.i1.p1.1">Solomon et al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib51" title=""><span class="ltx_text" style="font-size:80%;">51</span></a>]</cite> (PAULCI) method aggregates records where the same user stayed at the same base station and continuously used the same application for a period exceeding one minute. Sort the records in chronological order based on their timestamp and use the first five days as the training set, the sixth day as the validation set, and the last day as the test set.</p>
</div>
</li>
<li class="ltx_item" id="S5.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I2.i2.p1">
<p class="ltx_p" id="S5.I2.i2.p1.1">Ouyang et al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib49" title=""><span class="ltx_text" style="font-size:80%;">49</span></a>]</cite> (DUGN) filters out users with less than 50 usage records, and apps with less than 5 usage records. If the time interval between two consecutive app usage records is less than 300 seconds, they are grouped into a session. App usage sessions from the first 6 consecutive days are used for training, and sessions from the last day are used for testing.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S5.SS3.SSS2.p2">
<p class="ltx_p" id="S5.SS3.SSS2.p2.1">To conduct a rigorous and effective comparison with the methods presented in these two papers, we have separately adopted these two processing approaches for comparative experiments. Moreover, given that the data cleaning and partitioning method from PAULCI<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib51" title=""><span class="ltx_text" style="font-size:80%;">51</span></a>]</cite> has been more widely adopted in app prediction research, we decided to use this method for subsequent ablation studies and comparative analyses.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">VI </span><span class="ltx_text ltx_font_smallcaps" id="S6.1.1">Result</span>
</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">In this section, we first conducted experiments comparing with baselines. Then, we performed ablation experiments on the different components of the model. Next, we compared the time encoding and fusion methods with traditional approaches. Subsequently, we replaced the components within the feature fusion module in Appformer and conducted comparative experiments. Following that, we replaced the Feature Fusion Module in Appformer and conducted a comparison experiment on the feature extraction module. Finally, we conducted clustering experiments on the POI data, including experiments to determine the number of clustering centers and selecting the best clustering method based on the number of centers.</p>
</div>
<figure class="ltx_table" id="S6.T5">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE V: </span>Performance comparison of our method with other methods based on PAULCI<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib51" title=""><span class="ltx_text" style="font-size:80%;">51</span></a>]</cite>.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<table class="ltx_tabular ltx_centering ltx_figure_panel ltx_guessed_headers ltx_align_middle" id="S6.T5.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S6.T5.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S6.T5.1.1.1.1">Methods</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T5.1.1.1.2">Hit@1</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T5.1.1.1.3">Hit@3</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T5.1.1.1.4">Hit@5</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T5.1.1.1.5">MRR<sup class="ltx_sup" id="S6.T5.1.1.1.5.1">1</sup>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T5.1.1.1.6">F1</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S6.T5.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S6.T5.1.2.1.1">Random forest<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib62" title=""><span class="ltx_text" style="font-size:80%;">62</span></a>]</cite>
</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.1.2.1.2">0.0004</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.1.2.1.3">0.0329</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.1.2.1.4">0.0642</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.1.2.1.5">0.0345</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.1.2.1.6">0.0012</td>
</tr>
<tr class="ltx_tr" id="S6.T5.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T5.1.3.2.1">Logistic regression<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib63" title=""><span class="ltx_text" style="font-size:80%;">63</span></a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S6.T5.1.3.2.2">0.0006</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.3.2.3">0.0763</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.3.2.4">0.0962</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.3.2.5">0.0528</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.3.2.6">0.0010</td>
</tr>
<tr class="ltx_tr" id="S6.T5.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T5.1.4.3.1">XGBoost<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib64" title=""><span class="ltx_text" style="font-size:80%;">64</span></a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S6.T5.1.4.3.2">0.0022</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.4.3.3">0.0206</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.4.3.4">0.0550</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.4.3.5">0.0068</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.4.3.6">0.0013</td>
</tr>
<tr class="ltx_tr" id="S6.T5.1.5.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T5.1.5.4.1">MLP</th>
<td class="ltx_td ltx_align_center" id="S6.T5.1.5.4.2">0.1156</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.5.4.3">0.2069</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.5.4.4">0.2704</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.5.4.5">0.1962</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.5.4.6">0.0085</td>
</tr>
<tr class="ltx_tr" id="S6.T5.1.6.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T5.1.6.5.1">LSTM<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib65" title=""><span class="ltx_text" style="font-size:80%;">65</span></a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S6.T5.1.6.5.2">0.1054</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.6.5.3">0.1763</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.6.5.4">0.2265</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.6.5.5">0.1735</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.6.5.6">0.0011</td>
</tr>
<tr class="ltx_tr" id="S6.T5.1.7.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T5.1.7.6.1">GRU<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib66" title=""><span class="ltx_text" style="font-size:80%;">66</span></a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S6.T5.1.7.6.2">0.1049</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.7.6.3">0.1845</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.7.6.4">0.2396</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.7.6.5">0.1773</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.7.6.6">0.0011</td>
</tr>
<tr class="ltx_tr" id="S6.T5.1.8.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T5.1.8.7.1">PCA and LSTM<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib67" title=""><span class="ltx_text" style="font-size:80%;">67</span></a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S6.T5.1.8.7.2">0.1214</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.8.7.3">0.2069</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.8.7.4">0.2599</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.8.7.5">0.1955</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.8.7.6">0.0019</td>
</tr>
<tr class="ltx_tr" id="S6.T5.1.9.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T5.1.9.8.1">NAP<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib50" title=""><span class="ltx_text" style="font-size:80%;">50</span></a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S6.T5.1.9.8.2">0.1058</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.9.8.3">0.1879</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.9.8.4">0.2416</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.9.8.5">0.1814</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.9.8.6">0.0012</td>
</tr>
<tr class="ltx_tr" id="S6.T5.1.10.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T5.1.10.9.1">AppUsage2Vec<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib47" title=""><span class="ltx_text" style="font-size:80%;">47</span></a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S6.T5.1.10.9.2">0.1830</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.10.9.3">0.3470</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.10.9.4">0.4306</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.10.9.5">0.3026</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.10.9.6">0.0040</td>
</tr>
<tr class="ltx_tr" id="S6.T5.1.11.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T5.1.11.10.1">DeepApp<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib16" title=""><span class="ltx_text" style="font-size:80%;">16</span></a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S6.T5.1.11.10.2">0.2075</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.11.10.3">0.3854</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.11.10.4">0.4819</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.11.10.5">0.3351</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.11.10.6">0.0416</td>
</tr>
<tr class="ltx_tr" id="S6.T5.1.12.11">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T5.1.12.11.1">PAULCI<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib51" title=""><span class="ltx_text" style="font-size:80%;">51</span></a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S6.T5.1.12.11.2">0.2717</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.12.11.3">0.4753</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.12.11.4">0.5732</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.12.11.5">0.4098</td>
<td class="ltx_td ltx_align_center" id="S6.T5.1.12.11.6">0.1417</td>
</tr>
<tr class="ltx_tr" id="S6.T5.1.13.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S6.T5.1.13.12.1">Appformer + K<sup class="ltx_sup" id="S6.T5.1.13.12.1.1">2</sup> + T<sup class="ltx_sup" id="S6.T5.1.13.12.1.2">3</sup>
</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T5.1.13.12.2"><span class="ltx_text ltx_font_bold" id="S6.T5.1.13.12.2.1">0.3192</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T5.1.13.12.3"><span class="ltx_text ltx_font_bold" id="S6.T5.1.13.12.3.1">0.5213</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T5.1.13.12.4"><span class="ltx_text ltx_font_bold" id="S6.T5.1.13.12.4.1">0.6105</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T5.1.13.12.5"><span class="ltx_text ltx_font_bold" id="S6.T5.1.13.12.5.1">0.4511</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T5.1.13.12.6"><span class="ltx_text ltx_font_bold" id="S6.T5.1.13.12.6.1">0.1633</span></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<ul class="ltx_itemize ltx_centering ltx_figure_panel" id="S6.I1">
<li class="ltx_item" id="S6.I1.ix1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1</span>
<div class="ltx_para" id="S6.I1.ix1.p1">
<p class="ltx_p" id="S6.I1.ix1.p1.1">The MRR represents the average reciprocal rank of the first correct answer in all results.</p>
</div>
</li>
<li class="ltx_item" id="S6.I1.ix2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2</span>
<div class="ltx_para" id="S6.I1.ix2.p1">
<p class="ltx_p" id="S6.I1.ix2.p1.1">The K is K-Modes.</p>
</div>
</li>
<li class="ltx_item" id="S6.I1.ix3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3</span>
<div class="ltx_para" id="S6.I1.ix3.p1">
<p class="ltx_p" id="S6.I1.ix3.p1.1">The T is Time encoding.</p>
</div>
</li>
</ul>
</div>
</div>
</figure>
<figure class="ltx_table" id="S6.T6">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE VI: </span>Performance comparison of our method with other methods based on DUGN<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib49" title=""><span class="ltx_text" style="font-size:80%;">49</span></a>]</cite>.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S6.T6.1" style="width:433.6pt;height:94.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-197.7pt,42.9pt) scale(0.523010267541031,0.523010267541031) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S6.T6.1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S6.T6.1.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S6.T6.1.1.1.1.1">Methods</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="5" id="S6.T6.1.1.1.1.2">Hit@k</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="5" id="S6.T6.1.1.1.1.3">NDCG@k</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="5" id="S6.T6.1.1.1.1.4">MRR@k</th>
</tr>
<tr class="ltx_tr" id="S6.T6.1.1.2.2">
<th class="ltx_td ltx_th ltx_th_row" id="S6.T6.1.1.2.2.1"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T6.1.1.2.2.2">1</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T6.1.1.2.2.3">2</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T6.1.1.2.2.4">3</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T6.1.1.2.2.5">4</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T6.1.1.2.2.6">5</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T6.1.1.2.2.7">1</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T6.1.1.2.2.8">2</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T6.1.1.2.2.9">3</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T6.1.1.2.2.10">4</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T6.1.1.2.2.11">5</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T6.1.1.2.2.12">1</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T6.1.1.2.2.13">2</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T6.1.1.2.2.14">3</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T6.1.1.2.2.15">4</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S6.T6.1.1.2.2.16">5</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S6.T6.1.1.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S6.T6.1.1.3.1.1">MRU<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib12" title=""><span class="ltx_text" style="font-size:80%;">12</span></a>]</cite>
</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T6.1.1.3.1.2">0.2398</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T6.1.1.3.1.3">0.4196</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T6.1.1.3.1.4">0.5135</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T6.1.1.3.1.5">0.5670</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T6.1.1.3.1.6">0.5938</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T6.1.1.3.1.7">0.2398</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T6.1.1.3.1.8">0.3501</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T6.1.1.3.1.9">0.3921</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T6.1.1.3.1.10">0.4163</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T6.1.1.3.1.11">0.4299</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T6.1.1.3.1.12">0.2398</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T6.1.1.3.1.13">0.3210</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T6.1.1.3.1.14">0.3522</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T6.1.1.3.1.15">0.3668</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T6.1.1.3.1.16">0.3754</td>
</tr>
<tr class="ltx_tr" id="S6.T6.1.1.4.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T6.1.1.4.2.1">MFU<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib12" title=""><span class="ltx_text" style="font-size:80%;">12</span></a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.4.2.2">0.2472</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.4.2.3">0.4205</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.4.2.4">0.5073</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.4.2.5">0.5621</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.4.2.6">0.5987</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.4.2.7">0.2472</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.4.2.8">0.3565</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.4.2.9">0.3999</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.4.2.10">0.4235</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.4.2.11">0.4377</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.4.2.12">0.2472</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.4.2.13">0.3338</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.4.2.14">0.3628</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.4.2.15">0.3765</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.4.2.16">0.3838</td>
</tr>
<tr class="ltx_tr" id="S6.T6.1.1.5.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T6.1.1.5.3.1">BPRMF<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib69" title=""><span class="ltx_text" style="font-size:80%;">69</span></a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.5.3.2">0.3293</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.5.3.3">0.4437</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.5.3.4">0.5188</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.5.3.5">0.5681</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.5.3.6">0.6077</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.5.3.7">0.3293</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.5.3.8">0.4015</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.5.3.9">0.4390</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.5.3.10">0.4602</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.5.3.11">0.4755</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.5.3.12">0.3293</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.5.3.13">0.3865</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.5.3.14">0.4115</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.5.3.15">0.4238</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.5.3.16">0.4317</td>
</tr>
<tr class="ltx_tr" id="S6.T6.1.1.6.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T6.1.1.6.4.1">GRU4Rec<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib70" title=""><span class="ltx_text" style="font-size:80%;">70</span></a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.6.4.2">0.3137</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.6.4.3">0.4493</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.6.4.4">0.5425</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.6.4.5">0.6028</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.6.4.6">0.6494</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.6.4.7">0.3137</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.6.4.8">0.3993</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.6.4.9">0.4459</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.6.4.10">0.4718</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.6.4.11">0.4899</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.6.4.12">0.3137</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.6.4.13">0.3815</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.6.4.14">0.4126</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.6.4.15">0.4277</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.6.4.16">0.4370</td>
</tr>
<tr class="ltx_tr" id="S6.T6.1.1.7.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T6.1.1.7.5.1">AppUsage2Vec<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib47" title=""><span class="ltx_text" style="font-size:80%;">47</span></a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.7.5.2">0.3333</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.7.5.3">0.4592</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.7.5.4">0.5436</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.7.5.5">0.6080</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.7.5.6">0.6560</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.7.5.7">0.3333</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.7.5.8">0.4127</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.7.5.9">0.4549</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.7.5.10">0.4827</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.7.5.11">0.5012</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.7.5.12">0.3333</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.7.5.13">0.3962</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.7.5.14">0.4244</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.7.5.15">0.4405</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.7.5.16">0.4501</td>
</tr>
<tr class="ltx_tr" id="S6.T6.1.1.8.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T6.1.1.8.6.1">SR-GNN<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib71" title=""><span class="ltx_text" style="font-size:80%;">71</span></a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.8.6.2">0.3342</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.8.6.3">0.4716</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.8.6.4">0.5563</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.8.6.5">0.6154</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.8.6.6">0.6626</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.8.6.7">0.3342</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.8.6.8">0.4209</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.8.6.9">0.4632</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.8.6.10">0.4887</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.8.6.11">0.5070</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.8.6.12">0.3342</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.8.6.13">0.4029</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.8.6.14">0.4311</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.8.6.15">0.4459</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.8.6.16">0.4554</td>
</tr>
<tr class="ltx_tr" id="S6.T6.1.1.9.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T6.1.1.9.7.1">DUGN<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib49" title=""><span class="ltx_text" style="font-size:80%;">49</span></a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.9.7.2">0.3479</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.9.7.3">0.4768</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.9.7.4">0.5593</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.9.7.5">0.6215</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.9.7.6">0.6710</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.9.7.7">0.3479</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.9.7.8">0.4292</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.9.7.9">0.4705</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.9.7.10">0.4973</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.9.7.11">0.5164</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.9.7.12">0.3479</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.9.7.13">0.4124</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.9.7.14">0.4399</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.9.7.15">0.4554</td>
<td class="ltx_td ltx_align_center" id="S6.T6.1.1.9.7.16">0.4653</td>
</tr>
<tr class="ltx_tr" id="S6.T6.1.1.10.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S6.T6.1.1.10.8.1">Appformer + K + T</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T6.1.1.10.8.2"><span class="ltx_text ltx_font_bold" id="S6.T6.1.1.10.8.2.1">0.4268</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T6.1.1.10.8.3"><span class="ltx_text ltx_font_bold" id="S6.T6.1.1.10.8.3.1">0.5550</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T6.1.1.10.8.4"><span class="ltx_text ltx_font_bold" id="S6.T6.1.1.10.8.4.1">0.6230</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T6.1.1.10.8.5"><span class="ltx_text ltx_font_bold" id="S6.T6.1.1.10.8.5.1">0.6656</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T6.1.1.10.8.6"><span class="ltx_text ltx_font_bold" id="S6.T6.1.1.10.8.6.1">0.6960</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T6.1.1.10.8.7"><span class="ltx_text ltx_font_bold" id="S6.T6.1.1.10.8.7.1">0.4268</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T6.1.1.10.8.8"><span class="ltx_text ltx_font_bold" id="S6.T6.1.1.10.8.8.1">0.5550</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T6.1.1.10.8.9"><span class="ltx_text ltx_font_bold" id="S6.T6.1.1.10.8.9.1">0.5979</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T6.1.1.10.8.10"><span class="ltx_text ltx_font_bold" id="S6.T6.1.1.10.8.10.1">0.6192</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T6.1.1.10.8.11"><span class="ltx_text ltx_font_bold" id="S6.T6.1.1.10.8.11.1">0.6323</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T6.1.1.10.8.12"><span class="ltx_text ltx_font_bold" id="S6.T6.1.1.10.8.12.1">0.4268</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T6.1.1.10.8.13"><span class="ltx_text ltx_font_bold" id="S6.T6.1.1.10.8.13.1">0.4909</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T6.1.1.10.8.14"><span class="ltx_text ltx_font_bold" id="S6.T6.1.1.10.8.14.1">0.5136</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T6.1.1.10.8.15"><span class="ltx_text ltx_font_bold" id="S6.T6.1.1.10.8.15.1">0.5242</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T6.1.1.10.8.16"><span class="ltx_text ltx_font_bold" id="S6.T6.1.1.10.8.16.1">0.5303</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<section class="ltx_subsection" id="S6.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S6.SS1.5.1.1">VI-A</span> </span><span class="ltx_text ltx_font_italic" id="S6.SS1.6.2">Comparison with baselines</span>
</h3>
<div class="ltx_para" id="S6.SS1.p1">
<p class="ltx_p" id="S6.SS1.p1.1">The comparison results of our method with PAULCI<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib51" title=""><span class="ltx_text" style="font-size:80%;">51</span></a>]</cite> are shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S6.T5" title="TABLE V ‣ VI Result ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_tag">V</span></a>, with the experimental results of other methods in the table also sourced from PAULCI. The comparison results with DUGN<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib49" title=""><span class="ltx_text" style="font-size:80%;">49</span></a>]</cite> are shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S6.T6" title="TABLE VI ‣ VI Result ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_tag">VI</span></a>, and the experimental results of other methods in that table are also derived from DUGN. Across all metrics, our method achieves SOTA performance, illustrating its effectiveness in the field of mobile app prediction.</p>
</div>
<div class="ltx_para" id="S6.SS1.p2">
<p class="ltx_p" id="S6.SS1.p2.1">The significance of user information, spatio-temporal information, and historical app sequences in mobile app prediction is self-evident. Previous research has gradually incorporated these types of data, continuously enhancing their representations. Coupled with advancements in feature extraction techniques, this has led to a steady improvement in performance metrics.</p>
</div>
<div class="ltx_para" id="S6.SS1.p3">
<p class="ltx_p" id="S6.SS1.p3.1">For instance, the PAULCI method employs graph embeddings to depict spatial context and multi-modal embeddings to represent temporal context, user identifiers, and previously utilized applications. It also uses a deep learning framework, which includes GRU, attention layers, and softmax layers, for feature extraction and prediction, yielding good results. The DUGN method utilizes a dynamic graph structure, allowing it to capture the intricate correlations between various applications and track the evolution of user interests. By integrating multiple interests, it generates comprehensive user embeddings that serve as a robust foundation for future app recommendations, leading to commendable outcomes.</p>
</div>
<div class="ltx_para" id="S6.SS1.p4">
<p class="ltx_p" id="S6.SS1.p4.1">In our research, we implemented K-Modes clustering on POI data and improved the time encoding and fusion methods to enhance the expressiveness of the fundamental data. Furthermore, our proposed Appformer uniquely merges different types of data and enhances feature extraction, thereby leading to superior results compared to the other methods.</p>
</div>
<figure class="ltx_table" id="S6.T7">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE VII: </span>Results for module ablation.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S6.T7.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S6.T7.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S6.T7.1.1.1.1">Methods</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T7.1.1.1.2">Hit@1</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T7.1.1.1.3">Hit@3</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T7.1.1.1.4">Hit@5</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T7.1.1.1.5">MRR</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T7.1.1.1.6">F1</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S6.T7.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S6.T7.1.2.1.1">Appformer</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T7.1.2.1.2">0.3110</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T7.1.2.1.3">0.5137</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T7.1.2.1.4">0.6045</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T7.1.2.1.5">0.4437</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T7.1.2.1.6">0.1543</td>
</tr>
<tr class="ltx_tr" id="S6.T7.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T7.1.3.2.1">Appformer + T</th>
<td class="ltx_td ltx_align_center" id="S6.T7.1.3.2.2">0.3173</td>
<td class="ltx_td ltx_align_center" id="S6.T7.1.3.2.3">0.5196</td>
<td class="ltx_td ltx_align_center" id="S6.T7.1.3.2.4">0.6064</td>
<td class="ltx_td ltx_align_center" id="S6.T7.1.3.2.5">0.4486</td>
<td class="ltx_td ltx_align_center" id="S6.T7.1.3.2.6">0.1608</td>
</tr>
<tr class="ltx_tr" id="S6.T7.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T7.1.4.3.1">Appformer + K</th>
<td class="ltx_td ltx_align_center" id="S6.T7.1.4.3.2">0.3171</td>
<td class="ltx_td ltx_align_center" id="S6.T7.1.4.3.3">0.5201</td>
<td class="ltx_td ltx_align_center" id="S6.T7.1.4.3.4">0.6101</td>
<td class="ltx_td ltx_align_center" id="S6.T7.1.4.3.5">0.4497</td>
<td class="ltx_td ltx_align_center" id="S6.T7.1.4.3.6">0.1620</td>
</tr>
<tr class="ltx_tr" id="S6.T7.1.5.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S6.T7.1.5.4.1">Appformer + K + T</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T7.1.5.4.2"><span class="ltx_text ltx_font_bold" id="S6.T7.1.5.4.2.1">0.3192</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T7.1.5.4.3"><span class="ltx_text ltx_font_bold" id="S6.T7.1.5.4.3.1">0.5213</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T7.1.5.4.4"><span class="ltx_text ltx_font_bold" id="S6.T7.1.5.4.4.1">0.6105</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T7.1.5.4.5"><span class="ltx_text ltx_font_bold" id="S6.T7.1.5.4.5.1">0.4511</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T7.1.5.4.6"><span class="ltx_text ltx_font_bold" id="S6.T7.1.5.4.6.1">0.1633</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_subsection" id="S6.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S6.SS2.5.1.1">VI-B</span> </span><span class="ltx_text ltx_font_italic" id="S6.SS2.6.2">Module ablation study</span>
</h3>
<div class="ltx_para" id="S6.SS2.p1">
<p class="ltx_p" id="S6.SS2.p1.1">We performed a comprehensive ablation study of our approach to scrutinize its key components. Initially, the complete model (Appformer+K+T) was employed, yielding optimal performance, refer to Table <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S6.T7" title="TABLE VII ‣ VI-A Comparison with baselines ‣ VI Result ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_tag">VII</span></a>. Subsequently, we systematically removed its components and conducted experiments under three different configurations.</p>
</div>
<div class="ltx_para" id="S6.SS2.p2">
<p class="ltx_p" id="S6.SS2.p2.1">In the first experiment (Appformer+K), we excised the handling and integration (T) of time information, which led to a performance degradation. This suggests that our handling and integration operations for time information positively contribute to the model’s overall effectiveness. In the second experiment (Appformer+T), we omitted the clustering operation (K) of the POI data, also leading to a performance degradation. This implies that the clustering operation of POI data plays a significant role in enhancing spatial information.</p>
</div>
<div class="ltx_para" id="S6.SS2.p3">
<p class="ltx_p" id="S6.SS2.p3.1">Lastly, in the third experiment (Appformer), the Appformer model still surpassed the baseline performance, even after removing these two critical components. This reaffirms the uniqueness and efficacy of the Appformer framework.</p>
</div>
<figure class="ltx_table" id="S6.T8">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE VIII: </span>Results for time encoding method comparison experiment.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S6.T8.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S6.T8.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S6.T8.1.2.1.1">Methods</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T8.1.2.1.2">Hit@1</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T8.1.2.1.3">Hit@3</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T8.1.2.1.4">Hit@5</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T8.1.2.1.5">MRR</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T8.1.2.1.6">F1</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S6.T8.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S6.T8.1.1.1">Appformer + <math alttext="\mathrm{T}_{\mathrm{1}}" class="ltx_Math" display="inline" id="S6.T8.1.1.1.m1.1"><semantics id="S6.T8.1.1.1.m1.1a"><msub id="S6.T8.1.1.1.m1.1.1" xref="S6.T8.1.1.1.m1.1.1.cmml"><mi id="S6.T8.1.1.1.m1.1.1.2" mathvariant="normal" xref="S6.T8.1.1.1.m1.1.1.2.cmml">T</mi><mn id="S6.T8.1.1.1.m1.1.1.3" xref="S6.T8.1.1.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S6.T8.1.1.1.m1.1b"><apply id="S6.T8.1.1.1.m1.1.1.cmml" xref="S6.T8.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S6.T8.1.1.1.m1.1.1.1.cmml" xref="S6.T8.1.1.1.m1.1.1">subscript</csymbol><ci id="S6.T8.1.1.1.m1.1.1.2.cmml" xref="S6.T8.1.1.1.m1.1.1.2">T</ci><cn id="S6.T8.1.1.1.m1.1.1.3.cmml" type="integer" xref="S6.T8.1.1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T8.1.1.1.m1.1c">\mathrm{T}_{\mathrm{1}}</annotation><annotation encoding="application/x-llamapun" id="S6.T8.1.1.1.m1.1d">roman_T start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math><cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib60" title=""><span class="ltx_text" style="font-size:80%;">60</span></a>]</cite>
</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T8.1.1.2">0.3057</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T8.1.1.3">0.5056</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T8.1.1.4">0.5927</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T8.1.1.5">0.4365</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T8.1.1.6">0.1492</td>
</tr>
<tr class="ltx_tr" id="S6.T8.1.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S6.T8.1.3.1.1">Appformer + T</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T8.1.3.1.2"><span class="ltx_text ltx_font_bold" id="S6.T8.1.3.1.2.1">0.3173</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T8.1.3.1.3"><span class="ltx_text ltx_font_bold" id="S6.T8.1.3.1.3.1">0.5196</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T8.1.3.1.4"><span class="ltx_text ltx_font_bold" id="S6.T8.1.3.1.4.1">0.6064</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T8.1.3.1.5"><span class="ltx_text ltx_font_bold" id="S6.T8.1.3.1.5.1">0.4486</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T8.1.3.1.6"><span class="ltx_text ltx_font_bold" id="S6.T8.1.3.1.6.1">0.1608</span></td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_table" id="S6.T9">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE IX: </span>Results for ablation experiment of Appformer Decoder input.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<table class="ltx_tabular ltx_centering ltx_figure_panel ltx_guessed_headers ltx_align_middle" id="S6.T9.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S6.T9.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S6.T9.1.1.1.1">Methods</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T9.1.1.1.2">Hit@1</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T9.1.1.1.3">Hit@3</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T9.1.1.1.4">Hit@5</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T9.1.1.1.5">MRR</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T9.1.1.1.6">F1</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S6.T9.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S6.T9.1.2.1.1">AKT<sup class="ltx_sup" id="S6.T9.1.2.1.1.1">1</sup> (Decoder(l+t+u))</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T9.1.2.1.2">0.3180</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T9.1.2.1.3">0.5207</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T9.1.2.1.4">0.6083</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T9.1.2.1.5">0.4497</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T9.1.2.1.6">0.1598</td>
</tr>
<tr class="ltx_tr" id="S6.T9.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T9.1.3.2.1">AKT(Decoder(u+t))</th>
<td class="ltx_td ltx_align_center" id="S6.T9.1.3.2.2">0.3161</td>
<td class="ltx_td ltx_align_center" id="S6.T9.1.3.2.3">0.5192</td>
<td class="ltx_td ltx_align_center" id="S6.T9.1.3.2.4">0.6075</td>
<td class="ltx_td ltx_align_center" id="S6.T9.1.3.2.5">0.4481</td>
<td class="ltx_td ltx_align_center" id="S6.T9.1.3.2.6">0.1605</td>
</tr>
<tr class="ltx_tr" id="S6.T9.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T9.1.4.3.1">AKT(Decoder(u+l))</th>
<td class="ltx_td ltx_align_center" id="S6.T9.1.4.3.2">0.3170</td>
<td class="ltx_td ltx_align_center" id="S6.T9.1.4.3.3">0.5198</td>
<td class="ltx_td ltx_align_center" id="S6.T9.1.4.3.4">0.6079</td>
<td class="ltx_td ltx_align_center" id="S6.T9.1.4.3.5">0.4490</td>
<td class="ltx_td ltx_align_center" id="S6.T9.1.4.3.6">0.1590</td>
</tr>
<tr class="ltx_tr" id="S6.T9.1.5.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T9.1.5.4.1">AKT(Decoder(t+l))</th>
<td class="ltx_td ltx_align_center" id="S6.T9.1.5.4.2">0.3186</td>
<td class="ltx_td ltx_align_center" id="S6.T9.1.5.4.3">0.5209</td>
<td class="ltx_td ltx_align_center" id="S6.T9.1.5.4.4">0.6091</td>
<td class="ltx_td ltx_align_center" id="S6.T9.1.5.4.5">0.4504</td>
<td class="ltx_td ltx_align_center" id="S6.T9.1.5.4.6">0.1629</td>
</tr>
<tr class="ltx_tr" id="S6.T9.1.6.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T9.1.6.5.1">AKT(Decoder(u))</th>
<td class="ltx_td ltx_align_center" id="S6.T9.1.6.5.2">0.3159</td>
<td class="ltx_td ltx_align_center" id="S6.T9.1.6.5.3">0.5169</td>
<td class="ltx_td ltx_align_center" id="S6.T9.1.6.5.4">0.6046</td>
<td class="ltx_td ltx_align_center" id="S6.T9.1.6.5.5">0.4471</td>
<td class="ltx_td ltx_align_center" id="S6.T9.1.6.5.6">0.1578</td>
</tr>
<tr class="ltx_tr" id="S6.T9.1.7.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T9.1.7.6.1">AKT(Decoder(t))</th>
<td class="ltx_td ltx_align_center" id="S6.T9.1.7.6.2">0.3176</td>
<td class="ltx_td ltx_align_center" id="S6.T9.1.7.6.3">0.5207</td>
<td class="ltx_td ltx_align_center" id="S6.T9.1.7.6.4">0.6089</td>
<td class="ltx_td ltx_align_center" id="S6.T9.1.7.6.5">0.4496</td>
<td class="ltx_td ltx_align_center" id="S6.T9.1.7.6.6">0.1619</td>
</tr>
<tr class="ltx_tr" id="S6.T9.1.8.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S6.T9.1.8.7.1">AKT(Decoder(l))</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T9.1.8.7.2"><span class="ltx_text ltx_font_bold" id="S6.T9.1.8.7.2.1">0.3192</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T9.1.8.7.3"><span class="ltx_text ltx_font_bold" id="S6.T9.1.8.7.3.1">0.5213</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T9.1.8.7.4"><span class="ltx_text ltx_font_bold" id="S6.T9.1.8.7.4.1">0.6105</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T9.1.8.7.5"><span class="ltx_text ltx_font_bold" id="S6.T9.1.8.7.5.1">0.4511</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T9.1.8.7.6"><span class="ltx_text ltx_font_bold" id="S6.T9.1.8.7.6.1">0.1633</span></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<ul class="ltx_itemize ltx_centering ltx_figure_panel" id="S6.I2">
<li class="ltx_item" id="S6.I2.ix1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1</span>
<div class="ltx_para" id="S6.I2.ix1.p1">
<p class="ltx_p" id="S6.I2.ix1.p1.1">The AKT is Appformer + K +T.</p>
</div>
</li>
</ul>
</div>
</div>
</figure>
</section>
<section class="ltx_subsection" id="S6.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S6.SS3.5.1.1">VI-C</span> </span><span class="ltx_text ltx_font_italic" id="S6.SS3.6.2">Time encoding comparison experiment</span>
</h3>
<div class="ltx_para" id="S6.SS3.p1">
<p class="ltx_p" id="S6.SS3.p1.1">Under the premise that all basic prediction models adopt Appformer, we conducted a comparative experiment to contrast the improved time encoding and fusion methods with the basic time encoding and addition method <math alttext="\mathrm{T}_{\mathrm{1}}" class="ltx_Math" display="inline" id="S6.SS3.p1.1.m1.1"><semantics id="S6.SS3.p1.1.m1.1a"><msub id="S6.SS3.p1.1.m1.1.1" xref="S6.SS3.p1.1.m1.1.1.cmml"><mi id="S6.SS3.p1.1.m1.1.1.2" mathvariant="normal" xref="S6.SS3.p1.1.m1.1.1.2.cmml">T</mi><mn id="S6.SS3.p1.1.m1.1.1.3" xref="S6.SS3.p1.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S6.SS3.p1.1.m1.1b"><apply id="S6.SS3.p1.1.m1.1.1.cmml" xref="S6.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S6.SS3.p1.1.m1.1.1.1.cmml" xref="S6.SS3.p1.1.m1.1.1">subscript</csymbol><ci id="S6.SS3.p1.1.m1.1.1.2.cmml" xref="S6.SS3.p1.1.m1.1.1.2">T</ci><cn id="S6.SS3.p1.1.m1.1.1.3.cmml" type="integer" xref="S6.SS3.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p1.1.m1.1c">\mathrm{T}_{\mathrm{1}}</annotation><annotation encoding="application/x-llamapun" id="S6.SS3.p1.1.m1.1d">roman_T start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math><cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib60" title=""><span class="ltx_text" style="font-size:80%;">60</span></a>]</cite>. As shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S6.T8" title="TABLE VIII ‣ VI-B Module ablation study ‣ VI Result ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_tag">VIII</span></a>, the experimental results clearly demonstrate that our proposed improved method outperforms the basic method across various metrics. This indicates that our method accurately captures the inherent patterns of time information, enabling the model to better understand the changes in users’ app usage habits over time, thereby enhancing prediction accuracy and stability.</p>
</div>
</section>
<section class="ltx_subsection" id="S6.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S6.SS4.5.1.1">VI-D</span> </span><span class="ltx_text ltx_font_italic" id="S6.SS4.6.2">Ablation experiment of Appformer Decoder input</span>
</h3>
<div class="ltx_para" id="S6.SS4.p1">
<p class="ltx_p" id="S6.SS4.p1.1">Our Appformer uses the classic Encoder-Decoder architecture in the feature extraction module, which is a common approach in time series prediction. The role of the Encoder is to transform the input sequence into a high-dimensional representation, while the Decoder decodes this high-dimensional representation and combines it with an additional conditional vector to generate the target sequence. Therefore, we feed all data into the Encoder, and the decoder only needs the appropriate data.</p>
</div>
<div class="ltx_para" id="S6.SS4.p2">
<p class="ltx_p" id="S6.SS4.p2.1">We conducted ablation experiments specifically on the input to the Decoder, with the results presented in Table <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S6.T9" title="TABLE IX ‣ VI-B Module ablation study ‣ VI Result ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_tag">IX</span></a>. The optimal results were obtained when only POI data was input into the Decoder. This is because the user sequence itself consists of repetitive numbers, and the time series changes slowly. The presence of redundant data could potentially interfere with the Decoder’s decoding operation. Hence, we consider AKT (Decoder(l)) as our optimal result. The Appformer + K + T mentioned in previous experiments refers to this AKT (Decoder(l)).</p>
</div>
<figure class="ltx_table" id="S6.T10">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE X: </span>Results for Feature Extraction Module comparison experiment.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S6.T10.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S6.T10.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S6.T10.1.1.1.1">Methods</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T10.1.1.1.2">Hit@1</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T10.1.1.1.3">Hit@3</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T10.1.1.1.4">Hit@5</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T10.1.1.1.5">MRR</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T10.1.1.1.6">F1</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S6.T10.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S6.T10.1.2.1.1">AKT(Auto<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib72" title=""><span class="ltx_text" style="font-size:80%;">72</span></a>]</cite>)</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T10.1.2.1.2">0.3084</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T10.1.2.1.3">0.5062</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T10.1.2.1.4">0.5899</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T10.1.2.1.5">0.4369</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T10.1.2.1.6">0.1574</td>
</tr>
<tr class="ltx_tr" id="S6.T10.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T10.1.3.2.1">AKT(FED<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib73" title=""><span class="ltx_text" style="font-size:80%;">73</span></a>]</cite>)</th>
<td class="ltx_td ltx_align_center" id="S6.T10.1.3.2.2">0.3096</td>
<td class="ltx_td ltx_align_center" id="S6.T10.1.3.2.3">0.5070</td>
<td class="ltx_td ltx_align_center" id="S6.T10.1.3.2.4">0.5900</td>
<td class="ltx_td ltx_align_center" id="S6.T10.1.3.2.5">0.4378</td>
<td class="ltx_td ltx_align_center" id="S6.T10.1.3.2.6">0.1588</td>
</tr>
<tr class="ltx_tr" id="S6.T10.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T10.1.4.3.1">AKT(Quat<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib74" title=""><span class="ltx_text" style="font-size:80%;">74</span></a>]</cite>)</th>
<td class="ltx_td ltx_align_center" id="S6.T10.1.4.3.2">0.1883</td>
<td class="ltx_td ltx_align_center" id="S6.T10.1.4.3.3">0.3327</td>
<td class="ltx_td ltx_align_center" id="S6.T10.1.4.3.4">0.4089</td>
<td class="ltx_td ltx_align_center" id="S6.T10.1.4.3.5">0.2947</td>
<td class="ltx_td ltx_align_center" id="S6.T10.1.4.3.6">0.0413</td>
</tr>
<tr class="ltx_tr" id="S6.T10.1.5.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S6.T10.1.5.4.1">AKT</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T10.1.5.4.2"><span class="ltx_text ltx_font_bold" id="S6.T10.1.5.4.2.1">0.3192</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T10.1.5.4.3"><span class="ltx_text ltx_font_bold" id="S6.T10.1.5.4.3.1">0.5213</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T10.1.5.4.4"><span class="ltx_text ltx_font_bold" id="S6.T10.1.5.4.4.1">0.6105</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T10.1.5.4.5"><span class="ltx_text ltx_font_bold" id="S6.T10.1.5.4.5.1">0.4511</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T10.1.5.4.6"><span class="ltx_text ltx_font_bold" id="S6.T10.1.5.4.6.1">0.1633</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_subsection" id="S6.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S6.SS5.5.1.1">VI-E</span> </span><span class="ltx_text ltx_font_italic" id="S6.SS5.6.2">Feature Extraction Module comparison experiment</span>
</h3>
<div class="ltx_para" id="S6.SS5.p1">
<p class="ltx_p" id="S6.SS5.p1.1">We selected equivalent modules from AutoFormer <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib72" title=""><span class="ltx_text" style="font-size:80%;">72</span></a>]</cite>, FEDformer <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib73" title=""><span class="ltx_text" style="font-size:80%;">73</span></a>]</cite>, and Quatformer <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#bib.bib74" title=""><span class="ltx_text" style="font-size:80%;">74</span></a>]</cite> to replace the components in the Feature Extraction Module of our Appformer, and conducted a comprehensive comparative experiment. Specifically, for AutoFormer, we introduced the series decomposition block, aiming to decompose the time series into trend-cyclical and seasonal parts. Simultaneously, we replaced the Cross-Modal Data Fusion Module with the auto-correlation mechanism. For FEDformer, we incorporated the mixture of expert decomposition block (MOEDecomp), which utilizes average filters of different sizes and data-related weights to extract multiple trend components from the input signal. Additionally, we utilized fourier enhanced block instead of the Cross-Modal Data Fusion Module. Regarding Quatformer, we employed decoupling learning-to-rotate attention to replace the Cross-Modal Data Fusion Module. This module utilizes quaternions to handle periodicity information and employs a global memory decoupling approach to handle complex periodic patterns in time series. Furthermore, we used trend normalization instead of layer normalization to normalize sequential representations in the model’s hidden layers.</p>
</div>
<div class="ltx_para" id="S6.SS5.p2">
<p class="ltx_p" id="S6.SS5.p2.1">As shown in the experimental results in Table <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S6.T10" title="TABLE X ‣ VI-D Ablation experiment of Appformer Decoder input ‣ VI Result ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_tag">X</span></a>, we carefully selected and made reasonable replacements and adjustments to these modules. However, they were primarily designed for long sequence prediction tasks. Therefore, they might not have fully adapted to the characteristics of our short sequence prediction task. This could explain why the results did not meet our expectations.</p>
</div>
<figure class="ltx_figure" id="S6.F6">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S6.F6.1" style="width:216.8pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="304" id="S6.F6.1.g1" src="extracted/5759313/different_cluster_sizes.jpeg" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Performance trends with different cluster sizes.</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S6.F6.2" style="width:216.8pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="304" id="S6.F6.2.g1" src="extracted/5759313/cluster_sizes_0-10.jpeg" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Detailed trends for cluster sizes 0-10.</figcaption>
</figure>
</div>
</div>
</figure>
<figure class="ltx_table" id="S6.T11">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE XI: </span>Results of clustering experiments with different cluster sizes.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S6.T11.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S6.T11.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S6.T11.1.1.1.1">Number of centers</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T11.1.1.1.2">Hit@1</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T11.1.1.1.3">Hit@3</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T11.1.1.1.4">Hit@5</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T11.1.1.1.5">MRR</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T11.1.1.1.6">F1</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S6.T11.1.2.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S6.T11.1.2.1.1">0</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T11.1.2.1.2">0.3110</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T11.1.2.1.3">0.5137</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T11.1.2.1.4">0.6045</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T11.1.2.1.5">0.4437</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T11.1.2.1.6">0.1543</td>
</tr>
<tr class="ltx_tr" id="S6.T11.1.3.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S6.T11.1.3.2.1">5</th>
<td class="ltx_td ltx_align_center" id="S6.T11.1.3.2.2"><span class="ltx_text ltx_font_bold" id="S6.T11.1.3.2.2.1">0.3168</span></td>
<td class="ltx_td ltx_align_center" id="S6.T11.1.3.2.3"><span class="ltx_text ltx_font_bold" id="S6.T11.1.3.2.3.1">0.5201</span></td>
<td class="ltx_td ltx_align_center" id="S6.T11.1.3.2.4"><span class="ltx_text ltx_font_bold" id="S6.T11.1.3.2.4.1">0.6097</span></td>
<td class="ltx_td ltx_align_center" id="S6.T11.1.3.2.5"><span class="ltx_text ltx_font_bold" id="S6.T11.1.3.2.5.1">0.4494</span></td>
<td class="ltx_td ltx_align_center" id="S6.T11.1.3.2.6"><span class="ltx_text ltx_font_bold" id="S6.T11.1.3.2.6.1">0.1616</span></td>
</tr>
<tr class="ltx_tr" id="S6.T11.1.4.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S6.T11.1.4.3.1">10</th>
<td class="ltx_td ltx_align_center" id="S6.T11.1.4.3.2">0.3154</td>
<td class="ltx_td ltx_align_center" id="S6.T11.1.4.3.3">0.5190</td>
<td class="ltx_td ltx_align_center" id="S6.T11.1.4.3.4">0.6078</td>
<td class="ltx_td ltx_align_center" id="S6.T11.1.4.3.5">0.4479</td>
<td class="ltx_td ltx_align_center" id="S6.T11.1.4.3.6">0.1603</td>
</tr>
<tr class="ltx_tr" id="S6.T11.1.5.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S6.T11.1.5.4.1">15</th>
<td class="ltx_td ltx_align_center" id="S6.T11.1.5.4.2">0.3161</td>
<td class="ltx_td ltx_align_center" id="S6.T11.1.5.4.3">0.5197</td>
<td class="ltx_td ltx_align_center" id="S6.T11.1.5.4.4">0.6092</td>
<td class="ltx_td ltx_align_center" id="S6.T11.1.5.4.5">0.4488</td>
<td class="ltx_td ltx_align_center" id="S6.T11.1.5.4.6">0.1602</td>
</tr>
<tr class="ltx_tr" id="S6.T11.1.6.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S6.T11.1.6.5.1">20</th>
<td class="ltx_td ltx_align_center" id="S6.T11.1.6.5.2">0.3151</td>
<td class="ltx_td ltx_align_center" id="S6.T11.1.6.5.3">0.5193</td>
<td class="ltx_td ltx_align_center" id="S6.T11.1.6.5.4">0.6076</td>
<td class="ltx_td ltx_align_center" id="S6.T11.1.6.5.5">0.4479</td>
<td class="ltx_td ltx_align_center" id="S6.T11.1.6.5.6">0.1577</td>
</tr>
<tr class="ltx_tr" id="S6.T11.1.7.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S6.T11.1.7.6.1">25</th>
<td class="ltx_td ltx_align_center" id="S6.T11.1.7.6.2">0.3151</td>
<td class="ltx_td ltx_align_center" id="S6.T11.1.7.6.3">0.5200</td>
<td class="ltx_td ltx_align_center" id="S6.T11.1.7.6.4">0.6078</td>
<td class="ltx_td ltx_align_center" id="S6.T11.1.7.6.5">0.4482</td>
<td class="ltx_td ltx_align_center" id="S6.T11.1.7.6.6">0.1599</td>
</tr>
<tr class="ltx_tr" id="S6.T11.1.8.7">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S6.T11.1.8.7.1">30</th>
<td class="ltx_td ltx_align_center" id="S6.T11.1.8.7.2">0.3153</td>
<td class="ltx_td ltx_align_center" id="S6.T11.1.8.7.3">0.5184</td>
<td class="ltx_td ltx_align_center" id="S6.T11.1.8.7.4">0.6075</td>
<td class="ltx_td ltx_align_center" id="S6.T11.1.8.7.5">0.4478</td>
<td class="ltx_td ltx_align_center" id="S6.T11.1.8.7.6">0.1598</td>
</tr>
<tr class="ltx_tr" id="S6.T11.1.9.8">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S6.T11.1.9.8.1">35</th>
<td class="ltx_td ltx_align_center" id="S6.T11.1.9.8.2">0.3138</td>
<td class="ltx_td ltx_align_center" id="S6.T11.1.9.8.3">0.5175</td>
<td class="ltx_td ltx_align_center" id="S6.T11.1.9.8.4">0.6074</td>
<td class="ltx_td ltx_align_center" id="S6.T11.1.9.8.5">0.4467</td>
<td class="ltx_td ltx_align_center" id="S6.T11.1.9.8.6">0.1583</td>
</tr>
<tr class="ltx_tr" id="S6.T11.1.10.9">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S6.T11.1.10.9.1">40</th>
<td class="ltx_td ltx_align_center" id="S6.T11.1.10.9.2">0.3127</td>
<td class="ltx_td ltx_align_center" id="S6.T11.1.10.9.3">0.5192</td>
<td class="ltx_td ltx_align_center" id="S6.T11.1.10.9.4">0.6089</td>
<td class="ltx_td ltx_align_center" id="S6.T11.1.10.9.5">0.4469</td>
<td class="ltx_td ltx_align_center" id="S6.T11.1.10.9.6">0.1599</td>
</tr>
<tr class="ltx_tr" id="S6.T11.1.11.10">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S6.T11.1.11.10.1">45</th>
<td class="ltx_td ltx_align_center" id="S6.T11.1.11.10.2">0.3145</td>
<td class="ltx_td ltx_align_center" id="S6.T11.1.11.10.3">0.5193</td>
<td class="ltx_td ltx_align_center" id="S6.T11.1.11.10.4">0.6075</td>
<td class="ltx_td ltx_align_center" id="S6.T11.1.11.10.5">0.4477</td>
<td class="ltx_td ltx_align_center" id="S6.T11.1.11.10.6">0.1588</td>
</tr>
<tr class="ltx_tr" id="S6.T11.1.12.11">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S6.T11.1.12.11.1">50</th>
<td class="ltx_td ltx_align_center" id="S6.T11.1.12.11.2">0.3145</td>
<td class="ltx_td ltx_align_center" id="S6.T11.1.12.11.3">0.5182</td>
<td class="ltx_td ltx_align_center" id="S6.T11.1.12.11.4">0.6062</td>
<td class="ltx_td ltx_align_center" id="S6.T11.1.12.11.5">0.4472</td>
<td class="ltx_td ltx_align_center" id="S6.T11.1.12.11.6">0.1598</td>
</tr>
<tr class="ltx_tr" id="S6.T11.1.13.12">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb" id="S6.T11.1.13.12.1">55</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T11.1.13.12.2">0.3135</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T11.1.13.12.3">0.5155</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T11.1.13.12.4">0.6049</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T11.1.13.12.5">0.4458</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T11.1.13.12.6">0.1574</td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_table" id="S6.T12">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE XII: </span>Experimental results for cluster size 0-10.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S6.T12.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S6.T12.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S6.T12.1.1.1.1">Number of centers</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T12.1.1.1.2">Hit@1</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T12.1.1.1.3">Hit@3</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T12.1.1.1.4">Hit@5</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T12.1.1.1.5">MRR</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T12.1.1.1.6">F1</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S6.T12.1.2.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S6.T12.1.2.1.1">1</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T12.1.2.1.2">0.3149</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T12.1.2.1.3">0.5190</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T12.1.2.1.4">0.6081</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T12.1.2.1.5">0.4479</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T12.1.2.1.6">0.1602</td>
</tr>
<tr class="ltx_tr" id="S6.T12.1.3.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S6.T12.1.3.2.1">2</th>
<td class="ltx_td ltx_align_center" id="S6.T12.1.3.2.2">0.3158</td>
<td class="ltx_td ltx_align_center" id="S6.T12.1.3.2.3">0.5204</td>
<td class="ltx_td ltx_align_center" id="S6.T12.1.3.2.4">0.6096</td>
<td class="ltx_td ltx_align_center" id="S6.T12.1.3.2.5">0.4487</td>
<td class="ltx_td ltx_align_center" id="S6.T12.1.3.2.6">0.1600</td>
</tr>
<tr class="ltx_tr" id="S6.T12.1.4.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S6.T12.1.4.3.1">3</th>
<td class="ltx_td ltx_align_center" id="S6.T12.1.4.3.2">0.3149</td>
<td class="ltx_td ltx_align_center" id="S6.T12.1.4.3.3">0.5190</td>
<td class="ltx_td ltx_align_center" id="S6.T12.1.4.3.4">0.6086</td>
<td class="ltx_td ltx_align_center" id="S6.T12.1.4.3.5">0.4479</td>
<td class="ltx_td ltx_align_center" id="S6.T12.1.4.3.6">0.1600</td>
</tr>
<tr class="ltx_tr" id="S6.T12.1.5.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S6.T12.1.5.4.1">4</th>
<td class="ltx_td ltx_align_center" id="S6.T12.1.5.4.2">0.3153</td>
<td class="ltx_td ltx_align_center" id="S6.T12.1.5.4.3">0.5192</td>
<td class="ltx_td ltx_align_center" id="S6.T12.1.5.4.4">0.6088</td>
<td class="ltx_td ltx_align_center" id="S6.T12.1.5.4.5">0.4483</td>
<td class="ltx_td ltx_align_center" id="S6.T12.1.5.4.6">0.1580</td>
</tr>
<tr class="ltx_tr" id="S6.T12.1.6.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S6.T12.1.6.5.1">5</th>
<td class="ltx_td ltx_align_center" id="S6.T12.1.6.5.2"><span class="ltx_text ltx_font_bold" id="S6.T12.1.6.5.2.1">0.3168</span></td>
<td class="ltx_td ltx_align_center" id="S6.T12.1.6.5.3"><span class="ltx_text ltx_font_bold" id="S6.T12.1.6.5.3.1">0.5201</span></td>
<td class="ltx_td ltx_align_center" id="S6.T12.1.6.5.4"><span class="ltx_text ltx_font_bold" id="S6.T12.1.6.5.4.1">0.6097</span></td>
<td class="ltx_td ltx_align_center" id="S6.T12.1.6.5.5"><span class="ltx_text ltx_font_bold" id="S6.T12.1.6.5.5.1">0.4494</span></td>
<td class="ltx_td ltx_align_center" id="S6.T12.1.6.5.6"><span class="ltx_text ltx_font_bold" id="S6.T12.1.6.5.6.1">0.1616</span></td>
</tr>
<tr class="ltx_tr" id="S6.T12.1.7.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S6.T12.1.7.6.1">6</th>
<td class="ltx_td ltx_align_center" id="S6.T12.1.7.6.2">0.3165</td>
<td class="ltx_td ltx_align_center" id="S6.T12.1.7.6.3">0.5200</td>
<td class="ltx_td ltx_align_center" id="S6.T12.1.7.6.4">0.6089</td>
<td class="ltx_td ltx_align_center" id="S6.T12.1.7.6.5">0.4491</td>
<td class="ltx_td ltx_align_center" id="S6.T12.1.7.6.6">0.1612</td>
</tr>
<tr class="ltx_tr" id="S6.T12.1.8.7">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S6.T12.1.8.7.1">7</th>
<td class="ltx_td ltx_align_center" id="S6.T12.1.8.7.2">0.3153</td>
<td class="ltx_td ltx_align_center" id="S6.T12.1.8.7.3">0.5183</td>
<td class="ltx_td ltx_align_center" id="S6.T12.1.8.7.4">0.6077</td>
<td class="ltx_td ltx_align_center" id="S6.T12.1.8.7.5">0.4477</td>
<td class="ltx_td ltx_align_center" id="S6.T12.1.8.7.6">0.1592</td>
</tr>
<tr class="ltx_tr" id="S6.T12.1.9.8">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S6.T12.1.9.8.1">8</th>
<td class="ltx_td ltx_align_center" id="S6.T12.1.9.8.2">0.3148</td>
<td class="ltx_td ltx_align_center" id="S6.T12.1.9.8.3">0.5183</td>
<td class="ltx_td ltx_align_center" id="S6.T12.1.9.8.4">0.6084</td>
<td class="ltx_td ltx_align_center" id="S6.T12.1.9.8.5">0.4476</td>
<td class="ltx_td ltx_align_center" id="S6.T12.1.9.8.6">0.1590</td>
</tr>
<tr class="ltx_tr" id="S6.T12.1.10.9">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S6.T12.1.10.9.1">9</th>
<td class="ltx_td ltx_align_center" id="S6.T12.1.10.9.2">0.3151</td>
<td class="ltx_td ltx_align_center" id="S6.T12.1.10.9.3">0.5189</td>
<td class="ltx_td ltx_align_center" id="S6.T12.1.10.9.4">0.6080</td>
<td class="ltx_td ltx_align_center" id="S6.T12.1.10.9.5">0.4478</td>
<td class="ltx_td ltx_align_center" id="S6.T12.1.10.9.6">0.1603</td>
</tr>
<tr class="ltx_tr" id="S6.T12.1.11.10">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb" id="S6.T12.1.11.10.1">10</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T12.1.11.10.2">0.3154</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T12.1.11.10.3">0.5190</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T12.1.11.10.4">0.6078</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T12.1.11.10.5">0.4479</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T12.1.11.10.6">0.1603</td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_figure" id="S6.F11">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S6.F11.1" style="width:216.8pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S6.F11.1.g1" src="extracted/5759313/KMODES.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>K-Modes Visualization.</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S6.F11.2" style="width:216.8pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S6.F11.2.g1" src="extracted/5759313/MBKM.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>Mini Batch K-Means Visualization.</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S6.F11.3" style="width:144.5pt;"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="449" id="S6.F11.3.g1" src="extracted/5759313/KMEANS.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>K-Means Visualization.</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S6.F11.4" style="width:144.5pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="449" id="S6.F11.4.g1" src="extracted/5759313/KMEANS++.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10: </span>K-Means++ Visualization.</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S6.F11.5" style="width:144.5pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="449" id="S6.F11.5.g1" src="extracted/5759313/KHM.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 11: </span>K-Harmonic Means Visualization.</figcaption>
</figure>
</div>
</div>
</figure>
</section>
<section class="ltx_subsection" id="S6.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S6.SS6.5.1.1">VI-F</span> </span><span class="ltx_text ltx_font_italic" id="S6.SS6.6.2">Clustering experiment on the POI data</span>
</h3>
<div class="ltx_para" id="S6.SS6.p1">
<p class="ltx_p" id="S6.SS6.p1.1">As outlined in Section <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S4.SS1" title="IV-A Data selection and preprocessing ‣ IV Method ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">IV-A</span></span></a>, our experimental design includes a comparison and analysis of various clustering algorithms, such as K-Means, Mini Batch K-Means, K-Means++, K-Modes, and K-Harmonic Means. The initial step involves determining the number of cluster centers, followed by evaluating the clustering methods with this established number. The necessity of this process stems from the effectiveness of clustering POI data, which guides our selection of cluster quantities and methods. Despite minor differences in performance indicators among the methods, this phase is crucial. It allows us to identify the most suitable clustering approach for our data, reinforcing the value of our methodical exploration in understanding POI data’s underlying patterns.</p>
</div>
<div class="ltx_para" id="S6.SS6.p2">
<p class="ltx_p" id="S6.SS6.p2.1"><span class="ltx_text ltx_font_bold" id="S6.SS6.p2.1.1">Determining the number of cluster centers:</span> Since other clustering algorithms are evolved or improved based on K-Means, we used the most basic K-Means algorithm in combination with Appformer for the cluster center comparison experiment.</p>
</div>
<div class="ltx_para" id="S6.SS6.p3">
<p class="ltx_p" id="S6.SS6.p3.1">The experimental results in Tables <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S6.T11" title="TABLE XI ‣ VI-E Feature Extraction Module comparison experiment ‣ VI Result ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_tag">XI</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S6.T12" title="TABLE XII ‣ VI-E Feature Extraction Module comparison experiment ‣ VI Result ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_tag">XII</span></a> are supplemented by the visualizations in Figures <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S6.F6" title="Figure 6 ‣ VI-E Feature Extraction Module comparison experiment ‣ VI Result ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_tag">6</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S6.F6" title="Figure 6 ‣ VI-E Feature Extraction Module comparison experiment ‣ VI Result ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_tag">6</span></a>. The outcomes in Tables <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S6.T11" title="TABLE XI ‣ VI-E Feature Extraction Module comparison experiment ‣ VI Result ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_tag">XI</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S6.T12" title="TABLE XII ‣ VI-E Feature Extraction Module comparison experiment ‣ VI Result ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_tag">XII</span></a> demonstrate that the optimal number of clusters for POI data, based on Hit@1, Hit@3, Hit@5, MRR, and F1 score, is 5. However, the relationship between the number of clusters and performance is not simply linear. As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S6.F6" title="Figure 6 ‣ VI-E Feature Extraction Module comparison experiment ‣ VI Result ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_tag">6</span></a>, performance generally declines as the number of clusters increases from 5 to 55, albeit with some fluctuations. Figure <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S6.F6" title="Figure 6 ‣ VI-E Feature Extraction Module comparison experiment ‣ VI Result ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_tag">6</span></a> provides a more detailed view for cluster sizes 0-10, confirming that performance peaks at 5 clusters.</p>
</div>
<div class="ltx_para" id="S6.SS6.p4">
<p class="ltx_p" id="S6.SS6.p4.1">Although the correlation between the number of clusters and performance is not very strong, these experiments empirically demonstrate that 5 serves as a balancing point, where there are enough clusters to meaningfully group similar items while avoiding excessive fragmentation. The initial performance improvement from 0 to 5 clusters illustrates the benefits of clustering, but the decline beyond 5 clusters suggests that too many clusters could be detrimental, possibly because it makes each cluster too small and too specific.</p>
</div>
<div class="ltx_para" id="S6.SS6.p5">
<p class="ltx_p" id="S6.SS6.p5.1"><span class="ltx_text ltx_font_bold" id="S6.SS6.p5.1.1">Testing different clustering methods:</span> Experimental results, as shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S6.T13" title="TABLE XIII ‣ VI-F Clustering experiment on the POI data ‣ VI Result ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_tag">XIII</span></a>, indicate that when considering three key metrics: Hit@1, MRR, and F1 score, the K-Modes algorithm demonstrates superior performance. To further understand these results, we employed Principal Component Analysis (PCA) to reduce the dimensionality of the POI vectors corresponding to base station IDs and the cluster center vectors obtained by different clustering algorithms down to two dimensions for a detailed visual analysis. The visualization figures are presented from Figures <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S6.F11" title="Figure 11 ‣ VI-E Feature Extraction Module comparison experiment ‣ VI Result ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_tag">11</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S6.F11" title="Figure 11 ‣ VI-E Feature Extraction Module comparison experiment ‣ VI Result ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_tag">11</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S6.F11" title="Figure 11 ‣ VI-E Feature Extraction Module comparison experiment ‣ VI Result ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_tag">11</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S6.F11" title="Figure 11 ‣ VI-E Feature Extraction Module comparison experiment ‣ VI Result ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_tag">11</span></a>, and <a class="ltx_ref" href="https://arxiv.org/html/2407.19414v1#S6.F11" title="Figure 11 ‣ VI-E Feature Extraction Module comparison experiment ‣ VI Result ‣ Appformer: A Novel Framework for Mobile App Usage Prediction Leveraging Progressive Multi-Modal Data Fusion and Feature Extraction"><span class="ltx_text ltx_ref_tag">11</span></a>.</p>
</div>
<div class="ltx_para" id="S6.SS6.p6">
<p class="ltx_p" id="S6.SS6.p6.1">The visual analysis revealed that some data points significantly deviate from the central region of the overall data, identified as noise points. Notably, algorithms such as K-Means, K-Means++, and K-Harmonic Means incorrectly identify these noise points as cluster centers, which is suboptimal. In contrast, the Kmodes and Mini Batch K-Means algorithms can effectively recognize and disregard these noise points, assigning them to the nearest cluster, thereby minimizing the adverse impact of noise on the clustering outcome.</p>
</div>
<div class="ltx_para" id="S6.SS6.p7">
<p class="ltx_p" id="S6.SS6.p7.1">Further examination of the distribution of cluster centers for these two algorithms shows that some cluster centers of Mini Batch K-Means are located in sparser areas of the data, while the K-Modes algorithm’s cluster centers are evenly distributed in denser data regions. Considering the magnitude difference between dense and sparse areas, this indicates that the K-Modes algorithm is more rational and effective in selecting cluster centers, ensuring that they are located in the true core areas of the data, thus enhancing the accuracy and reliability of the clustering results.</p>
</div>
<div class="ltx_para" id="S6.SS6.p8">
<p class="ltx_p" id="S6.SS6.p8.1">In summary, through the clustering analysis of POI vectors, the K-Modes algorithm exhibits significant advantages in handling noise, maintaining data centrality, and improving clustering accuracy. These findings not only validate the effectiveness of our experimental results but also provide valuable references for future clustering analyses on similar datasets.</p>
</div>
<figure class="ltx_table" id="S6.T13">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE XIII: </span>Results for different clustering methods.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_inline-block ltx_figure_panel ltx_align_center ltx_transformed_outer" id="S6.T13.1" style="width:216.8pt;height:72.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-53.9pt,17.9pt) scale(0.667734187199378,0.667734187199378) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S6.T13.1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S6.T13.1.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S6.T13.1.1.1.1.1">Methods</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T13.1.1.1.1.2">Hit@1</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T13.1.1.1.1.3">Hit@3</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T13.1.1.1.1.4">Hit@5</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T13.1.1.1.1.5">MRR</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T13.1.1.1.1.6">F1</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S6.T13.1.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S6.T13.1.1.2.1.1">A<sup class="ltx_sup" id="S6.T13.1.1.2.1.1.1">1</sup> + K-Means</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T13.1.1.2.1.2">0.3168</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T13.1.1.2.1.3">0.5201</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T13.1.1.2.1.4">0.6097</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T13.1.1.2.1.5">0.4494</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T13.1.1.2.1.6">0.1616</td>
</tr>
<tr class="ltx_tr" id="S6.T13.1.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T13.1.1.3.2.1">A + Mini Batch K-Means</th>
<td class="ltx_td ltx_align_center" id="S6.T13.1.1.3.2.2">0.3166</td>
<td class="ltx_td ltx_align_center" id="S6.T13.1.1.3.2.3">0.5194</td>
<td class="ltx_td ltx_align_center" id="S6.T13.1.1.3.2.4">0.6089</td>
<td class="ltx_td ltx_align_center" id="S6.T13.1.1.3.2.5">0.4489</td>
<td class="ltx_td ltx_align_center" id="S6.T13.1.1.3.2.6">0.1615</td>
</tr>
<tr class="ltx_tr" id="S6.T13.1.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T13.1.1.4.3.1">A + K-Means++</th>
<td class="ltx_td ltx_align_center" id="S6.T13.1.1.4.3.2">0.3164</td>
<td class="ltx_td ltx_align_center" id="S6.T13.1.1.4.3.3">0.5199</td>
<td class="ltx_td ltx_align_center" id="S6.T13.1.1.4.3.4">0.6097</td>
<td class="ltx_td ltx_align_center" id="S6.T13.1.1.4.3.5">0.4492</td>
<td class="ltx_td ltx_align_center" id="S6.T13.1.1.4.3.6">0.1613</td>
</tr>
<tr class="ltx_tr" id="S6.T13.1.1.5.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T13.1.1.5.4.1">A + K-Harmonic Means</th>
<td class="ltx_td ltx_align_center" id="S6.T13.1.1.5.4.2">0.3164</td>
<td class="ltx_td ltx_align_center" id="S6.T13.1.1.5.4.3">0.5195</td>
<td class="ltx_td ltx_align_center" id="S6.T13.1.1.5.4.4">0.6091</td>
<td class="ltx_td ltx_align_center" id="S6.T13.1.1.5.4.5">0.4491</td>
<td class="ltx_td ltx_align_center" id="S6.T13.1.1.5.4.6">0.1598</td>
</tr>
<tr class="ltx_tr" id="S6.T13.1.1.6.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S6.T13.1.1.6.5.1">A + K-Modes</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T13.1.1.6.5.2"><span class="ltx_text ltx_font_bold" id="S6.T13.1.1.6.5.2.1">0.3171</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T13.1.1.6.5.3"><span class="ltx_text ltx_font_bold" id="S6.T13.1.1.6.5.3.1">0.5201</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T13.1.1.6.5.4"><span class="ltx_text ltx_font_bold" id="S6.T13.1.1.6.5.4.1">0.6101</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T13.1.1.6.5.5"><span class="ltx_text ltx_font_bold" id="S6.T13.1.1.6.5.5.1">0.4497</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T13.1.1.6.5.6"><span class="ltx_text ltx_font_bold" id="S6.T13.1.1.6.5.6.1">0.1620</span></td>
</tr>
</tbody>
</table>
</span></div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<ul class="ltx_itemize ltx_centering ltx_figure_panel" id="S6.I3">
<li class="ltx_item" id="S6.I3.ix1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1</span>
<div class="ltx_para" id="S6.I3.ix1.p1">
<p class="ltx_p" id="S6.I3.ix1.p1.1">The A is Appformer.</p>
</div>
</li>
</ul>
</div>
</div>
</figure>
</section>
</section>
<section class="ltx_section" id="S7">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">VII </span><span class="ltx_text ltx_font_smallcaps" id="S7.1.1">Conclusion</span>
</h2>
<div class="ltx_para" id="S7.p1">
<p class="ltx_p" id="S7.p1.1">This study showcases Appformer as a novel approach for predicting mobile app usage, demonstrating its potential through innovative multi-modal data fusion, feature extraction strategies, and the use of Transformer-like architecture. Specifically, we enhanced the preprocessing of location and time data, laying a solid foundation for data fusion and feature extraction. Through rigorous experimental validation, Appformer outperforms existing methods on several predictive performance metrics, such as Hit@1, MRR, and F1 score. This highlights Appformer’s robustness and efficiency in predicting mobile app usage, showcasing its potential to improve personalized services and enhance user experience.</p>
</div>
<div class="ltx_para" id="S7.p2">
<p class="ltx_p" id="S7.p2.1">In our in-depth analysis of the Appformer approach, we identified its limitations as involving challenges in the data fusion process, constraints in feature extraction, and difficulties in model updates and maintenance. Specifically, effectively integrating multimodal data, addressing inconsistencies and conflicts within the data, and avoiding the introduction of bias or loss of important information during data fusion are key challenges. Additionally, the model may overly rely on predefined features and extraction methods, limiting its ability to explore intrinsic patterns in the data, especially when dealing with complex or unstructured data. Moreover, to adapt to the constantly evolving patterns of app usage and the emergence of new applications, the model requires regular updates. However, frequent updates may demand substantial computational resources and cause short-term fluctuations in model performance. Maintaining the model’s continuous learning and adaptation to new data patterns while avoiding the disruption of existing knowledge poses a significant challenge. These multifaceted challenges not only deepen our understanding of the limitations of the Appformer method but also point out directions for future research, namely improving the applicability, performance, and adaptability of the model in the dynamic field of app usage prediction. This ensures that it can effectively adapt to the ever-changing digital ecosystem and meet the diverse needs of users.</p>
</div>
<div class="ltx_para" id="S7.p3">
<p class="ltx_p" id="S7.p3.1">We would like to release our source code.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography" style="font-size:80%;">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib1.2.2.1" style="font-size:80%;">[1]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib1.4.1" style="font-size:80%;">
K. Akdim, L. V. Casaló, and C. Flavián, “The role of utilitarian and hedonic aspects in the continuance intention to use social mobile apps,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib1.5.2" style="font-size:80%;">Journal of Retailing and Consumer Services</em><span class="ltx_text" id="bib.bib1.6.3" style="font-size:80%;">, vol. 66, p. 102888, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib2.2.2.1" style="font-size:80%;">[2]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib2.4.1" style="font-size:80%;">
Y. Zhang, J. Liu, B. Guo, Z. Wang, Y. Liang, and Z. Yu, “App popularity prediction by incorporating time-varying hierarchical interactions,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib2.5.2" style="font-size:80%;">IEEE Transactions on Mobile Computing</em><span class="ltx_text" id="bib.bib2.6.3" style="font-size:80%;">, vol. 21, no. 5, pp. 1566–1579, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib3.2.2.1" style="font-size:80%;">[3]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib3.4.1" style="font-size:80%;">
H. Zhu, E. Chen, H. Xiong, H. Cao, and J. Tian, “Mobile app classification with enriched contextual information,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib3.5.2" style="font-size:80%;">IEEE Transactions on mobile computing</em><span class="ltx_text" id="bib.bib3.6.3" style="font-size:80%;">, vol. 13, no. 7, pp. 1550–1563, 2013.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib4.2.2.1" style="font-size:80%;">[4]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib4.4.1" style="font-size:80%;">
S. Deng, Z. Xiang, J. Taheri, M. A. Khoshkholghi, J. Yin, A. Y. Zomaya, and S. Dustdar, “Optimal application deployment in resource constrained distributed edges,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib4.5.2" style="font-size:80%;">IEEE Transactions on Mobile Computing</em><span class="ltx_text" id="bib.bib4.6.3" style="font-size:80%;">, vol. 20, no. 5, pp. 1907–1923, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib5.2.2.1" style="font-size:80%;">[5]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib5.4.1" style="font-size:80%;">
T. Li, Y. Li, M. A. Hoque, T. Xia, S. Tarkoma, and P. Hui, “To what extent we repeat ourselves? discovering daily activity patterns across mobile app usage,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib5.5.2" style="font-size:80%;">IEEE Transactions on Mobile Computing</em><span class="ltx_text" id="bib.bib5.6.3" style="font-size:80%;">, vol. 21, no. 4, pp. 1492–1507, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib6.2.2.1" style="font-size:80%;">[6]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib6.4.1" style="font-size:80%;">
Q. Xie, Q. Gong, X. He, Y. Chen, X. Wang, H. Zheng, and B. Y. Zhao, “Trimming mobile applications for bandwidth-challenged networks in developing regions,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib6.5.2" style="font-size:80%;">IEEE Transactions on Mobile Computing</em><span class="ltx_text" id="bib.bib6.6.3" style="font-size:80%;">, vol. 22, no. 1, pp. 556–573, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib7.2.2.1" style="font-size:80%;">[7]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib7.4.1" style="font-size:80%;">
T. Li, Y. Fan, Y. Li, S. Tarkoma, and P. Hui, “Understanding the long-term evolution of mobile app usage,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib7.5.2" style="font-size:80%;">IEEE Transactions on Mobile Computing</em><span class="ltx_text" id="bib.bib7.6.3" style="font-size:80%;">, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib8.2.2.1" style="font-size:80%;">[8]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib8.4.1" style="font-size:80%;">
G. Huang, M. Xu, F. X. Lin, Y. Liu, Y. Ma, S. Pushp, and X. Liu, “Shuffledog: characterizing and adapting user-perceived latency of android apps,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib8.5.2" style="font-size:80%;">IEEE Transactions on Mobile Computing</em><span class="ltx_text" id="bib.bib8.6.3" style="font-size:80%;">, vol. 16, no. 10, pp. 2913–2926, 2017.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib9.2.2.1" style="font-size:80%;">[9]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib9.4.1" style="font-size:80%;">
E. Lu and L. Zhang, “Machine learning methods for smartphone application prediction,” in </span><em class="ltx_emph ltx_font_italic" id="bib.bib9.5.2" style="font-size:80%;">2022 IEEE 31st International Symposium on Industrial Electronics (ISIE)</em><span class="ltx_text" id="bib.bib9.6.3" style="font-size:80%;">.   IEEE, 2022, pp. 1174–1179.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib10.2.2.1" style="font-size:80%;">[10]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib10.4.1" style="font-size:80%;">
N. Natarajan, D. Shin, and I. S. Dhillon, “Which app will you use next? collaborative filtering with interactional context,” in </span><em class="ltx_emph ltx_font_italic" id="bib.bib10.5.2" style="font-size:80%;">Proceedings of the 7th ACM Conference on Recommender Systems</em><span class="ltx_text" id="bib.bib10.6.3" style="font-size:80%;">, 2013, pp. 201–208.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib11.2.2.1" style="font-size:80%;">[11]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib11.4.1" style="font-size:80%;">
R. Baeza-Yates, D. Jiang, F. Silvestri, and B. Harrison, “Predicting the next app that you are going to use,” in </span><em class="ltx_emph ltx_font_italic" id="bib.bib11.5.2" style="font-size:80%;">Proceedings of the eighth ACM international conference on web search and data mining</em><span class="ltx_text" id="bib.bib11.6.3" style="font-size:80%;">, 2015, pp. 285–294.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib12.2.2.1" style="font-size:80%;">[12]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib12.4.1" style="font-size:80%;">
C. Shin, J.-H. Hong, and A. K. Dey, “Understanding and prediction of mobile application usage for smart phones,” in </span><em class="ltx_emph ltx_font_italic" id="bib.bib12.5.2" style="font-size:80%;">proceedings of the 2012 ACM conference on ubiquitous computing</em><span class="ltx_text" id="bib.bib12.6.3" style="font-size:80%;">, 2012, pp. 173–182.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib13.2.2.1" style="font-size:80%;">[13]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib13.4.1" style="font-size:80%;">
Z. Tu, Y. Li, P. Hui, L. Su, and D. Jin, “Personalized mobile app recommendation by learning user’s interest from social media,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib13.5.2" style="font-size:80%;">IEEE Transactions on Mobile Computing</em><span class="ltx_text" id="bib.bib13.6.3" style="font-size:80%;">, vol. 19, no. 11, pp. 2670–2683, 2019.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib14.2.2.1" style="font-size:80%;">[14]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib14.4.1" style="font-size:80%;">
H. Wang, Y. Li, S. Zeng, G. Wang, P. Zhang, P. Hui, and D. Jin, “Modeling spatio-temporal app usage for a large user population,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib14.5.2" style="font-size:80%;">Proceedings of the ACM on Interactive, Mobile, Wearable and Ubiquitous Technologies</em><span class="ltx_text" id="bib.bib14.6.3" style="font-size:80%;">, vol. 3, no. 1, pp. 1–23, 2019.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib15.2.2.1" style="font-size:80%;">[15]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib15.4.1" style="font-size:80%;">
M. De Nadai, A. Cardoso, A. Lima, B. Lepri, and N. Oliver, “Strategies and limitations in app usage and human mobility,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib15.5.2" style="font-size:80%;">Scientific reports</em><span class="ltx_text" id="bib.bib15.6.3" style="font-size:80%;">, vol. 9, no. 1, p. 10935, 2019.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib16.2.2.1" style="font-size:80%;">[16]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib16.4.1" style="font-size:80%;">
T. Xia, Y. Li, J. Feng, D. Jin, Q. Zhang, H. Luo, and Q. Liao, “Deepapp: Predicting personalized smartphone app usage via context-aware multi-task learning,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib16.5.2" style="font-size:80%;">ACM Transactions on Intelligent Systems and Technology (TIST)</em><span class="ltx_text" id="bib.bib16.6.3" style="font-size:80%;">, vol. 11, no. 6, pp. 1–12, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib17.2.2.1" style="font-size:80%;">[17]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib17.4.1" style="font-size:80%;">
E. Graells-Garrido, D. Caro, O. Miranda, R. Schifanella, and O. F. Peredo, “The www (and an h) of mobile application usage in the city: The what, where, when, and how,” in </span><em class="ltx_emph ltx_font_italic" id="bib.bib17.5.2" style="font-size:80%;">Companion Proceedings of the The Web Conference 2018</em><span class="ltx_text" id="bib.bib17.6.3" style="font-size:80%;">, 2018, pp. 1221–1229.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib18.2.2.1" style="font-size:80%;">[18]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib18.4.1" style="font-size:80%;">
Y. Tian, K. Zhou, and D. Pelleg, “What and how long: Prediction of mobile app engagement,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib18.5.2" style="font-size:80%;">ACM Transactions on Information Systems (TOIS)</em><span class="ltx_text" id="bib.bib18.6.3" style="font-size:80%;">, vol. 40, no. 1, pp. 1–38, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib19.2.2.1" style="font-size:80%;">[19]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib19.4.1" style="font-size:80%;">
S. Selva Birunda and R. Kanniga Devi, “A review on word embedding techniques for text classification,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib19.5.2" style="font-size:80%;">Innovative Data Communication Technologies and Application: Proceedings of ICIDCA 2020</em><span class="ltx_text" id="bib.bib19.6.3" style="font-size:80%;">, pp. 267–281, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib20.2.2.1" style="font-size:80%;">[20]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib20.4.1" style="font-size:80%;">
T. Mikolov, K. Chen, G. Corrado, and J. Dean, “Efficient estimation of word representations in vector space,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib20.5.2" style="font-size:80%;">arXiv preprint arXiv:1301.3781</em><span class="ltx_text" id="bib.bib20.6.3" style="font-size:80%;">, 2013.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib21.2.2.1" style="font-size:80%;">[21]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib21.4.1" style="font-size:80%;">
J. Pennington, R. Socher, and C. D. Manning, “Glove: Global vectors for word representation,” in </span><em class="ltx_emph ltx_font_italic" id="bib.bib21.5.2" style="font-size:80%;">Proceedings of the 2014 conference on empirical methods in natural language processing (EMNLP)</em><span class="ltx_text" id="bib.bib21.6.3" style="font-size:80%;">, 2014, pp. 1532–1543.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib22.2.2.1" style="font-size:80%;">[22]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib22.4.1" style="font-size:80%;">
A. Joulin, E. Grave, P. Bojanowski, and T. Mikolov, “Bag of tricks for efficient text classification,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib22.5.2" style="font-size:80%;">arXiv preprint arXiv:1607.01759</em><span class="ltx_text" id="bib.bib22.6.3" style="font-size:80%;">, 2016.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib23.2.2.1" style="font-size:80%;">[23]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib23.4.1" style="font-size:80%;">
Y. Li, F.-X. Wu, and A. Ngom, “A review on machine learning principles for multi-view biological data integration,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib23.5.2" style="font-size:80%;">Briefings in bioinformatics</em><span class="ltx_text" id="bib.bib23.6.3" style="font-size:80%;">, vol. 19, no. 2, pp. 325–340, 2018.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib24.2.2.1" style="font-size:80%;">[24]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib24.4.1" style="font-size:80%;">
T. Baltrušaitis, C. Ahuja, and L.-P. Morency, “Multimodal machine learning: A survey and taxonomy,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib24.5.2" style="font-size:80%;">IEEE transactions on pattern analysis and machine intelligence</em><span class="ltx_text" id="bib.bib24.6.3" style="font-size:80%;">, vol. 41, no. 2, pp. 423–443, 2018.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib25.2.2.1" style="font-size:80%;">[25]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib25.4.1" style="font-size:80%;">
U. Brefeld and T. Scheffer, “Co-em support vector learning,” in </span><em class="ltx_emph ltx_font_italic" id="bib.bib25.5.2" style="font-size:80%;">Proceedings of the twenty-first international conference on Machine learning</em><span class="ltx_text" id="bib.bib25.6.3" style="font-size:80%;">, 2004, p. 16.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib26.2.2.1" style="font-size:80%;">[26]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib26.4.1" style="font-size:80%;">
I. Muslea, S. Minton, and C. A. Knoblock, “Selective sampling with redundant views,” in </span><em class="ltx_emph ltx_font_italic" id="bib.bib26.5.2" style="font-size:80%;">AAAI/IAAI</em><span class="ltx_text" id="bib.bib26.6.3" style="font-size:80%;">, 2000, pp. 621–626.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib27.2.2.1" style="font-size:80%;">[27]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib27.4.1" style="font-size:80%;">
P. Yang, W. Gao, Q. Tan, and K.-F. Wong, “Information-theoretic multi-view domain adaptation.”   Association for Computational Linguistics, 2012.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib28.2.2.1" style="font-size:80%;">[28]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib28.4.1" style="font-size:80%;">
M. Kan, S. Shan, H. Zhang, S. Lao, and X. Chen, “Multi-view discriminant analysis,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib28.5.2" style="font-size:80%;">IEEE transactions on pattern analysis and machine intelligence</em><span class="ltx_text" id="bib.bib28.6.3" style="font-size:80%;">, vol. 38, no. 1, pp. 188–194, 2015.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib29.2.2.1" style="font-size:80%;">[29]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib29.4.1" style="font-size:80%;">
S. Sun, “Multi-view laplacian support vector machines,” in </span><em class="ltx_emph ltx_font_italic" id="bib.bib29.5.2" style="font-size:80%;">Advanced Data Mining and Applications: 7th International Conference, ADMA 2011, Beijing, China, December 17-19, 2011, Proceedings, Part II 7</em><span class="ltx_text" id="bib.bib29.6.3" style="font-size:80%;">.   Springer, 2011, pp. 209–222.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib30.2.2.1" style="font-size:80%;">[30]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib30.4.1" style="font-size:80%;">
S. Sun and G. Chao, “Multi-view maximum entropy discrimination,” in </span><em class="ltx_emph ltx_font_italic" id="bib.bib30.5.2" style="font-size:80%;">Twenty-third international joint conference on artificial intelligence</em><span class="ltx_text" id="bib.bib30.6.3" style="font-size:80%;">, 2013.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib31.2.2.1" style="font-size:80%;">[31]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib31.4.1" style="font-size:80%;">
G. Chao and S. Sun, “Consensus and complementarity based maximum entropy discrimination for multi-view classification,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib31.5.2" style="font-size:80%;">Information Sciences</em><span class="ltx_text" id="bib.bib31.6.3" style="font-size:80%;">, vol. 367, pp. 296–310, 2016.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib32.2.2.1" style="font-size:80%;">[32]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib32.4.1" style="font-size:80%;">
M. Gönen and E. Alpaydın, “Multiple kernel learning algorithms,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib32.5.2" style="font-size:80%;">The Journal of Machine Learning Research</em><span class="ltx_text" id="bib.bib32.6.3" style="font-size:80%;">, vol. 12, pp. 2211–2268, 2011.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib33.2.2.1" style="font-size:80%;">[33]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib33.4.1" style="font-size:80%;">
N. Srivastava and R. R. Salakhutdinov, “Multimodal learning with deep boltzmann machines,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib33.5.2" style="font-size:80%;">Advances in neural information processing systems</em><span class="ltx_text" id="bib.bib33.6.3" style="font-size:80%;">, vol. 25, 2012.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib34.2.2.1" style="font-size:80%;">[34]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib34.4.1" style="font-size:80%;">
H. Hu, B. Liu, B. Wang, M. Liu, and X. Wang, “Multimodal dbn for predicting high-quality answers in cqa portals,” in </span><em class="ltx_emph ltx_font_italic" id="bib.bib34.5.2" style="font-size:80%;">Proceedings of the 51st Annual Meeting of the Association for Computational Linguistics (Volume 2: Short Papers)</em><span class="ltx_text" id="bib.bib34.6.3" style="font-size:80%;">, 2013, pp. 843–847.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib35.2.2.1" style="font-size:80%;">[35]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib35.4.1" style="font-size:80%;">
W. Wang, R. Arora, K. Livescu, and J. Bilmes, “On deep multi-view representation learning,” in </span><em class="ltx_emph ltx_font_italic" id="bib.bib35.5.2" style="font-size:80%;">International conference on machine learning</em><span class="ltx_text" id="bib.bib35.6.3" style="font-size:80%;">.   PMLR, 2015, pp. 1083–1092.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib36.2.2.1" style="font-size:80%;">[36]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib36.4.1" style="font-size:80%;">
F. Feng, X. Wang, and R. Li, “Cross-modal retrieval with correspondence autoencoder,” in </span><em class="ltx_emph ltx_font_italic" id="bib.bib36.5.2" style="font-size:80%;">Proceedings of the 22nd ACM international conference on Multimedia</em><span class="ltx_text" id="bib.bib36.6.3" style="font-size:80%;">, 2014, pp. 7–16.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib37.2.2.1" style="font-size:80%;">[37]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib37.4.1" style="font-size:80%;">
G. Andrew, R. Arora, J. Bilmes, and K. Livescu, “Deep canonical correlation analysis,” in </span><em class="ltx_emph ltx_font_italic" id="bib.bib37.5.2" style="font-size:80%;">International conference on machine learning</em><span class="ltx_text" id="bib.bib37.6.3" style="font-size:80%;">.   PMLR, 2013, pp. 1247–1255.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib38.2.2.1" style="font-size:80%;">[38]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib38.4.1" style="font-size:80%;">
H. Su, S. Maji, E. Kalogerakis, and E. Learned-Miller, “Multi-view convolutional neural networks for 3d shape recognition,” in </span><em class="ltx_emph ltx_font_italic" id="bib.bib38.5.2" style="font-size:80%;">Proceedings of the IEEE international conference on computer vision</em><span class="ltx_text" id="bib.bib38.6.3" style="font-size:80%;">, 2015, pp. 945–953.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib39.2.2.1" style="font-size:80%;">[39]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib39.4.1" style="font-size:80%;">
S. Yao, S. Hu, Y. Zhao, A. Zhang, and T. Abdelzaher, “Deepsense: A unified deep learning framework for time-series mobile sensing data processing,” in </span><em class="ltx_emph ltx_font_italic" id="bib.bib39.5.2" style="font-size:80%;">Proceedings of the 26th international conference on world wide web</em><span class="ltx_text" id="bib.bib39.6.3" style="font-size:80%;">, 2017, pp. 351–360.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib40.2.2.1" style="font-size:80%;">[40]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib40.4.1" style="font-size:80%;">
S. Wang, D. Huang, Y. Wang, and Y. Tang, “2d-3d heterogeneous face recognition based on deep canonical correlation analysis,” in </span><em class="ltx_emph ltx_font_italic" id="bib.bib40.5.2" style="font-size:80%;">Biometric Recognition: 12th Chinese Conference, CCBR 2017, Shenzhen, China, October 28-29, 2017, Proceedings 12</em><span class="ltx_text" id="bib.bib40.6.3" style="font-size:80%;">.   Springer, 2017, pp. 77–85.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib41.2.2.1" style="font-size:80%;">[41]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib41.4.1" style="font-size:80%;">
Y.-H. H. Tsai, S. Bai, P. P. Liang, J. Z. Kolter, L.-P. Morency, and R. Salakhutdinov, “Multimodal transformer for unaligned multimodal language sequences,” in </span><em class="ltx_emph ltx_font_italic" id="bib.bib41.5.2" style="font-size:80%;">Proceedings of the conference. Association for Computational Linguistics. Meeting</em><span class="ltx_text" id="bib.bib41.6.3" style="font-size:80%;">, vol. 2019.   NIH Public Access, 2019, p. 6558.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib42.2.2.1" style="font-size:80%;">[42]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib42.4.1" style="font-size:80%;">
J. Yang, Y. Wang, R. Yi, Y. Zhu, A. Rehman, A. Zadeh, S. Poria, and L.-P. Morency, “Mtag: Modal-temporal attention graph for unaligned human multimodal language sequences,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib42.5.2" style="font-size:80%;">arXiv preprint arXiv:2010.11985</em><span class="ltx_text" id="bib.bib42.6.3" style="font-size:80%;">, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib43.3.2.1" style="font-size:80%;">[43]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib43.5.1" style="font-size:80%;">
J. Wang, J. Li, Y. Shi, J. Lai, and X. Tan, “Am</span><sup class="ltx_sup" id="bib.bib43.6.2"><span class="ltx_text" id="bib.bib43.6.2.1" style="font-size:80%;">3</span></sup><span class="ltx_text" id="bib.bib43.7.3" style="font-size:80%;">net: Adaptive mutual-learning-based multimodal data fusion network,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib43.8.4" style="font-size:80%;">IEEE Transactions on Circuits and Systems for Video Technology</em><span class="ltx_text" id="bib.bib43.9.5" style="font-size:80%;">, vol. 32, no. 8, pp. 5411–5426, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib44.2.2.1" style="font-size:80%;">[44]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib44.4.1" style="font-size:80%;">
M. M. Islam and T. Iqbal, “Hamlet: A hierarchical multimodal attention-based human activity recognition algorithm,” in </span><em class="ltx_emph ltx_font_italic" id="bib.bib44.5.2" style="font-size:80%;">2020 IEEE/RSJ International Conference on Intelligent Robots and Systems (IROS)</em><span class="ltx_text" id="bib.bib44.6.3" style="font-size:80%;">.   IEEE, 2020, pp. 10 285–10 292.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib45.2.2.1" style="font-size:80%;">[45]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib45.4.1" style="font-size:80%;">
T. Liang, G. Lin, L. Feng, Y. Zhang, and F. Lv, “Attention is not enough: Mitigating the distribution discrepancy in asynchronous multimodal sequence fusion,” in </span><em class="ltx_emph ltx_font_italic" id="bib.bib45.5.2" style="font-size:80%;">Proceedings of the IEEE/CVF International Conference on Computer Vision</em><span class="ltx_text" id="bib.bib45.6.3" style="font-size:80%;">, 2021, pp. 8148–8156.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib46.2.2.1" style="font-size:80%;">[46]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib46.4.1" style="font-size:80%;">
Y. Lee, S. Cho, and J. Choi, “App usage prediction for dual display device via two-phase sequence modeling,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib46.5.2" style="font-size:80%;">Pervasive and Mobile Computing</em><span class="ltx_text" id="bib.bib46.6.3" style="font-size:80%;">, vol. 58, p. 101025, 2019.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib47.2.2.1" style="font-size:80%;">[47]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib47.4.1" style="font-size:80%;">
S. Zhao, Z. Luo, Z. Jiang, H. Wang, F. Xu, S. Li, J. Yin, and G. Pan, “Appusage2vec: Modeling smartphone app usage for prediction,” in </span><em class="ltx_emph ltx_font_italic" id="bib.bib47.5.2" style="font-size:80%;">2019 IEEE 35th International Conference on Data Engineering (ICDE)</em><span class="ltx_text" id="bib.bib47.6.3" style="font-size:80%;">.   IEEE, 2019, pp. 1322–1333.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib48.2.2.1" style="font-size:80%;">[48]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib48.4.1" style="font-size:80%;">
S. Ruder, “An overview of multi-task learning in deep neural networks,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib48.5.2" style="font-size:80%;">arXiv preprint arXiv:1706.05098</em><span class="ltx_text" id="bib.bib48.6.3" style="font-size:80%;">, 2017.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib49.2.2.1" style="font-size:80%;">[49]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib49.4.1" style="font-size:80%;">
Y. Ouyang, B. Guo, Q. Wang, Y. Liang, and Z. Yu, “Learning dynamic app usage graph for next mobile app recommendation,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib49.5.2" style="font-size:80%;">IEEE Transactions on Mobile Computing</em><span class="ltx_text" id="bib.bib49.6.3" style="font-size:80%;">, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib50.2.2.1" style="font-size:80%;">[50]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib50.4.1" style="font-size:80%;">
G. S. Moreira, H. Jo, and J. Jeong, “Nap: Natural app processing for predictive user contexts in mobile smartphones,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib50.5.2" style="font-size:80%;">Applied Sciences</em><span class="ltx_text" id="bib.bib50.6.3" style="font-size:80%;">, vol. 10, no. 19, p. 6657, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib51.2.2.1" style="font-size:80%;">[51]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib51.4.1" style="font-size:80%;">
A. Solomon, B. Shapira, and L. Rokach, “Predicting application usage based on latent contextual information,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib51.5.2" style="font-size:80%;">Computer Communications</em><span class="ltx_text" id="bib.bib51.6.3" style="font-size:80%;">, vol. 192, pp. 197–209, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib52.2.2.1" style="font-size:80%;">[52]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib52.4.1" style="font-size:80%;">
Z. Shen, K. Yang, W. Du, X. Zhao, and J. Zou, “Deepapp: a deep reinforcement learning framework for mobile application usage prediction,” in </span><em class="ltx_emph ltx_font_italic" id="bib.bib52.5.2" style="font-size:80%;">Proceedings of the 17th Conference on Embedded Networked Sensor Systems</em><span class="ltx_text" id="bib.bib52.6.3" style="font-size:80%;">, 2019, pp. 153–165.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib53.2.2.1" style="font-size:80%;">[53]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib53.4.1" style="font-size:80%;">
D. Yu, Y. Li, F. Xu, P. Zhang, and V. Kostakos, “Smartphone app usage prediction using points of interest,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib53.5.2" style="font-size:80%;">Proceedings of the ACM on Interactive, Mobile, Wearable and Ubiquitous Technologies</em><span class="ltx_text" id="bib.bib53.6.3" style="font-size:80%;">, vol. 1, no. 4, pp. 1–21, 2018.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib54">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib54.2.2.1" style="font-size:80%;">[54]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib54.4.1" style="font-size:80%;">
S. Ghannay, B. Favre, Y. Esteve, and N. Camelin, “Word embedding evaluation and combination,” in </span><em class="ltx_emph ltx_font_italic" id="bib.bib54.5.2" style="font-size:80%;">Proceedings of the Tenth International Conference on Language Resources and Evaluation (LREC’16)</em><span class="ltx_text" id="bib.bib54.6.3" style="font-size:80%;">, 2016, pp. 300–305.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib55">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib55.2.2.1" style="font-size:80%;">[55]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib55.4.1" style="font-size:80%;">
M. Ahmed, R. Seraj, and S. M. S. Islam, “The k-means algorithm: A comprehensive survey and performance evaluation,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib55.5.2" style="font-size:80%;">Electronics</em><span class="ltx_text" id="bib.bib55.6.3" style="font-size:80%;">, vol. 9, no. 8, p. 1295, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib56">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib56.2.2.1" style="font-size:80%;">[56]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib56.4.1" style="font-size:80%;">
S. C. Hicks, R. Liu, Y. Ni, E. Purdom, and D. Risso, “mbkmeans: Fast clustering for single cell data using mini-batch k-means,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib56.5.2" style="font-size:80%;">PLoS computational biology</em><span class="ltx_text" id="bib.bib56.6.3" style="font-size:80%;">, vol. 17, no. 1, p. e1008625, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib57">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib57.2.2.1" style="font-size:80%;">[57]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib57.4.1" style="font-size:80%;">
H. Li and J. Wang, “Collaborative annealing power k-means++ clustering,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib57.5.2" style="font-size:80%;">Knowledge-Based Systems</em><span class="ltx_text" id="bib.bib57.6.3" style="font-size:80%;">, vol. 255, p. 109593, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib58">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib58.2.2.1" style="font-size:80%;">[58]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib58.4.1" style="font-size:80%;">
N. Sharma and N. Gaud, “K-modes clustering algorithm for categorical data,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib58.5.2" style="font-size:80%;">International Journal of Computer Applications</em><span class="ltx_text" id="bib.bib58.6.3" style="font-size:80%;">, vol. 127, no. 1, p. 46, 2015.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib59">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib59.2.2.1" style="font-size:80%;">[59]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib59.4.1" style="font-size:80%;">
A. K. Srivastava, Y. Kumar, and P. K. Singh, “Computer aided diagnostic system based on svm and k harmonic mean based attribute weighting method,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib59.5.2" style="font-size:80%;">Obesity Medicine</em><span class="ltx_text" id="bib.bib59.6.3" style="font-size:80%;">, vol. 19, p. 100270, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib60">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib60.2.2.1" style="font-size:80%;">[60]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib60.4.1" style="font-size:80%;">
H. Zhou, S. Zhang, J. Peng, S. Zhang, J. Li, H. Xiong, and W. Zhang, “Informer: Beyond efficient transformer for long sequence time-series forecasting,” in </span><em class="ltx_emph ltx_font_italic" id="bib.bib60.5.2" style="font-size:80%;">Proceedings of the AAAI conference on artificial intelligence</em><span class="ltx_text" id="bib.bib60.6.3" style="font-size:80%;">, vol. 35, no. 12, 2021, pp. 11 106–11 115.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib61">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib61.2.2.1" style="font-size:80%;">[61]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib61.4.1" style="font-size:80%;">
A. Vaswani, N. Shazeer, N. Parmar, J. Uszkoreit, L. Jones, A. N. Gomez, Ł. Kaiser, and I. Polosukhin, “Attention is all you need,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib61.5.2" style="font-size:80%;">Advances in neural information processing systems</em><span class="ltx_text" id="bib.bib61.6.3" style="font-size:80%;">, vol. 30, 2017.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib62">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib62.2.2.1" style="font-size:80%;">[62]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib62.4.1" style="font-size:80%;">
L. Breiman, “Random forests,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib62.5.2" style="font-size:80%;">Machine learning</em><span class="ltx_text" id="bib.bib62.6.3" style="font-size:80%;">, vol. 45, pp. 5–32, 2001.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib63">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib63.2.2.1" style="font-size:80%;">[63]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib63.4.1" style="font-size:80%;">
P. Werbos, “Beyond regression: New tools for prediction and analysis in the behavioral sciences,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib63.5.2" style="font-size:80%;">PhD thesis, Committee on Applied Mathematics, Harvard University, Cambridge, MA</em><span class="ltx_text" id="bib.bib63.6.3" style="font-size:80%;">, 1974.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib64">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib64.2.2.1" style="font-size:80%;">[64]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib64.4.1" style="font-size:80%;">
T. Chen and C. Guestrin, “Xgboost: A scalable tree boosting system,” in </span><em class="ltx_emph ltx_font_italic" id="bib.bib64.5.2" style="font-size:80%;">Proceedings of the 22nd acm sigkdd international conference on knowledge discovery and data mining</em><span class="ltx_text" id="bib.bib64.6.3" style="font-size:80%;">, 2016, pp. 785–794.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib65">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib65.2.2.1" style="font-size:80%;">[65]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib65.4.1" style="font-size:80%;">
S. Hochreiter and J. Schmidhuber, “Long short-term memory,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib65.5.2" style="font-size:80%;">Neural computation</em><span class="ltx_text" id="bib.bib65.6.3" style="font-size:80%;">, vol. 9, no. 8, pp. 1735–1780, 1997.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib66">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib66.2.2.1" style="font-size:80%;">[66]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib66.4.1" style="font-size:80%;">
K. Cho, B. van Merrienboer, Çaglar Gülçehre, D. Bahdanau, F. Bougares, H. Schwenk, and Y. Bengio, “Learning phrase representations using rnn encoder–decoder for statistical machine translation,” in </span><em class="ltx_emph ltx_font_italic" id="bib.bib66.5.2" style="font-size:80%;">Conference on Empirical Methods in Natural Language Processing</em><span class="ltx_text" id="bib.bib66.6.3" style="font-size:80%;">, 2014. [Online]. Available: </span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://api.semanticscholar.org/CorpusID:5590763" style="font-size:80%;" title="">https://api.semanticscholar.org/CorpusID:5590763</a><span class="ltx_text" id="bib.bib66.7.4" style="font-size:80%;">
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib67">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib67.2.2.1" style="font-size:80%;">[67]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib67.4.1" style="font-size:80%;">
S. Xu, W. Li, X. Zhang, S. Gao, T. Zhan, Y. Zhao, W.-w. Zhu, and T. Sun, “Predicting smartphone app usage with recurrent neural networks,” in </span><em class="ltx_emph ltx_font_italic" id="bib.bib67.5.2" style="font-size:80%;">Wireless Algorithms, Systems, and Applications: 13th International Conference, WASA 2018, Tianjin, China, June 20-22, 2018, Proceedings 13</em><span class="ltx_text" id="bib.bib67.6.3" style="font-size:80%;">.   Springer, 2018, pp. 532–544.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib68">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib68.2.2.1" style="font-size:80%;">[68]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib68.4.1" style="font-size:80%;">
Z. Yin and Y. Shen, “On the dimensionality of word embedding,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib68.5.2" style="font-size:80%;">Advances in neural information processing systems</em><span class="ltx_text" id="bib.bib68.6.3" style="font-size:80%;">, vol. 31, 2018.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib69">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib69.2.2.1" style="font-size:80%;">[69]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib69.4.1" style="font-size:80%;">
S. Rendle, C. Freudenthaler, Z. Gantner, and L. Schmidt-Thieme, “Bpr: Bayesian personalized ranking from implicit feedback,” in </span><em class="ltx_emph ltx_font_italic" id="bib.bib69.5.2" style="font-size:80%;">Proceedings of the Twenty-Fifth Conference on Uncertainty in Artificial Intelligence</em><span class="ltx_text" id="bib.bib69.6.3" style="font-size:80%;">, ser. UAI ’09.   Arlington, Virginia, USA: AUAI Press, 2009, p. 452–461.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib70">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib70.2.2.1" style="font-size:80%;">[70]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib70.4.1" style="font-size:80%;">
B. Hidasi, A. Karatzoglou, L. Baltrunas, and D. Tikk, “Session-based recommendations with recurrent neural networks,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib70.5.2" style="font-size:80%;">arXiv preprint arXiv:1511.06939</em><span class="ltx_text" id="bib.bib70.6.3" style="font-size:80%;">, 2015.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib71">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib71.2.2.1" style="font-size:80%;">[71]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib71.4.1" style="font-size:80%;">
S. Wu, Y. Tang, Y. Zhu, L. Wang, X. Xie, and T. Tan, “Session-based recommendation with graph neural networks,” in </span><em class="ltx_emph ltx_font_italic" id="bib.bib71.5.2" style="font-size:80%;">Proceedings of the AAAI conference on artificial intelligence</em><span class="ltx_text" id="bib.bib71.6.3" style="font-size:80%;">, vol. 33, no. 01, 2019, pp. 346–353.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib72">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib72.2.2.1" style="font-size:80%;">[72]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib72.4.1" style="font-size:80%;">
H. Wu, J. Xu, J. Wang, and M. Long, “Autoformer: Decomposition transformers with auto-correlation for long-term series forecasting,” </span><em class="ltx_emph ltx_font_italic" id="bib.bib72.5.2" style="font-size:80%;">Advances in Neural Information Processing Systems</em><span class="ltx_text" id="bib.bib72.6.3" style="font-size:80%;">, vol. 34, pp. 22 419–22 430, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib73">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib73.2.2.1" style="font-size:80%;">[73]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib73.4.1" style="font-size:80%;">
T. Zhou, Z. Ma, Q. Wen, X. Wang, L. Sun, and R. Jin, “Fedformer: Frequency enhanced decomposed transformer for long-term series forecasting,” in </span><em class="ltx_emph ltx_font_italic" id="bib.bib73.5.2" style="font-size:80%;">International Conference on Machine Learning</em><span class="ltx_text" id="bib.bib73.6.3" style="font-size:80%;">.   PMLR, 2022, pp. 27 268–27 286.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib74">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem"><span class="ltx_text" id="bib.bib74.2.2.1" style="font-size:80%;">[74]</span></span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bib74.4.1" style="font-size:80%;">
W. Chen, W. Wang, B. Peng, Q. Wen, T. Zhou, and L. Sun, “Learning to rotate: Quaternion transformer for complicated periodical time series forecasting,” in </span><em class="ltx_emph ltx_font_italic" id="bib.bib74.5.2" style="font-size:80%;">Proceedings of the 28th ACM SIGKDD Conference on Knowledge Discovery and Data Mining</em><span class="ltx_text" id="bib.bib74.6.3" style="font-size:80%;">, 2022, pp. 146–156.
</span>
</span>
</li>
</ul>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Sun Jul 28 06:22:09 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
