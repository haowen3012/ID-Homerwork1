<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>MEDFuse: Multimodal EHR Data Fusion with Masked Lab-Test Modeling and Large Language Models</title>
<!--Generated on Wed Jul 17 04:10:40 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="Computer-aided Diagnosis; Large Language Model Fine-tuning; Electronic Health Records" lang="en" name="keywords"/>
<base href="/html/2407.12309v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2407.12309v1#S1" title="In MEDFuse: Multimodal EHR Data Fusion with Masked Lab-Test Modeling and Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2407.12309v1#S2" title="In MEDFuse: Multimodal EHR Data Fusion with Masked Lab-Test Modeling and Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.12309v1#S2.SS1" title="In 2. Related work ‣ MEDFuse: Multimodal EHR Data Fusion with Masked Lab-Test Modeling and Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>EHR For Multi-Label Disease Prediction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.12309v1#S2.SS2" title="In 2. Related work ‣ MEDFuse: Multimodal EHR Data Fusion with Masked Lab-Test Modeling and Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Extraction of Clinical Relevant Information from Multimodal EHR</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2407.12309v1#S3" title="In MEDFuse: Multimodal EHR Data Fusion with Masked Lab-Test Modeling and Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Method</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.12309v1#S3.SS1" title="In 3. Method ‣ MEDFuse: Multimodal EHR Data Fusion with Masked Lab-Test Modeling and Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Overview</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2407.12309v1#S3.SS2" title="In 3. Method ‣ MEDFuse: Multimodal EHR Data Fusion with Masked Lab-Test Modeling and Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Multimodal Embedding Extraction</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.12309v1#S3.SS2.SSS1" title="In 3.2 Multimodal Embedding Extraction ‣ 3. Method ‣ MEDFuse: Multimodal EHR Data Fusion with Masked Lab-Test Modeling and Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.1 </span><span class="ltx_text ltx_font_bold">Fine-tuning LLMs on Unstructured Text</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.12309v1#S3.SS2.SSS2" title="In 3.2 Multimodal Embedding Extraction ‣ 3. Method ‣ MEDFuse: Multimodal EHR Data Fusion with Masked Lab-Test Modeling and Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.2 </span><span class="ltx_text ltx_font_bold">Masked Lab-Test Modeling</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.12309v1#S3.SS3" title="In 3. Method ‣ MEDFuse: Multimodal EHR Data Fusion with Masked Lab-Test Modeling and Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Disentangled Transformer Module</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2407.12309v1#S4" title="In MEDFuse: Multimodal EHR Data Fusion with Masked Lab-Test Modeling and Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>EXPERIMENTS</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.12309v1#S4.SS1" title="In 4. EXPERIMENTS ‣ MEDFuse: Multimodal EHR Data Fusion with Masked Lab-Test Modeling and Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Datasets and Metrics</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.12309v1#S4.SS2" title="In 4. EXPERIMENTS ‣ MEDFuse: Multimodal EHR Data Fusion with Masked Lab-Test Modeling and Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Experimental Results</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.12309v1#S4.SS3" title="In 4. EXPERIMENTS ‣ MEDFuse: Multimodal EHR Data Fusion with Masked Lab-Test Modeling and Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Ablation Study</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2407.12309v1#S5" title="In MEDFuse: Multimodal EHR Data Fusion with Masked Lab-Test Modeling and Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusion</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_leqno">
<h1 class="ltx_title ltx_title_document">MEDFuse: Multimodal EHR Data Fusion with Masked Lab-Test Modeling and Large Language Models</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Thao Minh Nguyen Phan
</span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Cong-Tinh Dao
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id1.1.id1">National Yang Ming Chiao Tung University</span><span class="ltx_text ltx_affiliation_city" id="id2.2.id2">Hsinchu</span><span class="ltx_text ltx_affiliation_country" id="id3.3.id3">Taiwan</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:pnmthaoct,%20dcongtinh@gmail.com">pnmthaoct, dcongtinh@gmail.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Chenwei Wu
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id4.1.id1">University of Michigan</span><span class="ltx_text ltx_affiliation_state" id="id5.2.id2">Michigan</span><span class="ltx_text ltx_affiliation_country" id="id6.3.id3">USA</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:chenweiw@umich.edu">chenweiw@umich.edu</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Jian-Zhe Wang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id7.1.id1">National Yang Ming Chiao Tung University</span><span class="ltx_text ltx_affiliation_city" id="id8.2.id2">Hsinchu</span><span class="ltx_text ltx_affiliation_country" id="id9.3.id3">Taiwan</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:jzwang.cs09@nycu.edu.tw">jzwang.cs09@nycu.edu.tw</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Shun Liu
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id10.1.id1">Shanghai University of Finance and Ecomonics</span><span class="ltx_text ltx_affiliation_city" id="id11.2.id2">Shanghai</span><span class="ltx_text ltx_affiliation_country" id="id12.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:kevinliuleo@gmail.com">kevinliuleo@gmail.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Jun-En Ding
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id13.1.id1">Stevens Institute of Technology Hoboken</span><span class="ltx_text ltx_affiliation_state" id="id14.2.id2">New Jersey</span><span class="ltx_text ltx_affiliation_country" id="id15.3.id3">USA</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:jding17@stevens.edu">jding17@stevens.edu</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">David Restrepo
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id16.1.id1">Massachusetts Institute of Technology</span><span class="ltx_text ltx_affiliation_state" id="id17.2.id2">Massachusetts</span><span class="ltx_text ltx_affiliation_country" id="id18.3.id3">USA</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:davidres@mit.edu">davidres@mit.edu</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Feng Liu
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id19.1.id1">Stevens Institute of Technology Hoboken</span><span class="ltx_text ltx_affiliation_state" id="id20.2.id2">New Jersey</span><span class="ltx_text ltx_affiliation_country" id="id21.3.id3">USA</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:fliu22@stevens.edu">fliu22@stevens.edu</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Fang-Ming Hung
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id22.1.id1">Far Eastern Memorial Hospital</span><span class="ltx_text ltx_affiliation_city" id="id23.2.id2">New Taipei</span><span class="ltx_text ltx_affiliation_country" id="id24.3.id3">Taiwan</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:philip@mail.femh.org.tw">philip@mail.femh.org.tw</a>
</span></span></span>
<span class="ltx_author_before"> and </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Wen-Chih Peng
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id25.1.id1">National Yang Ming Chiao Tung University</span><span class="ltx_text ltx_affiliation_city" id="id26.2.id2">Hsinchu</span><span class="ltx_text ltx_affiliation_country" id="id27.3.id3">Taiwan</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:wcpengcs@nycu.edu.tw">wcpengcs@nycu.edu.tw</a>
</span></span></span>
</div>
<div class="ltx_dates">(2024; 20 February 2024; 12 March 2024; 5 June 2024)</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6>
<p class="ltx_p" id="id28.id1">Electronic health records (EHRs) are multimodal by nature, consisting of structured tabular features like lab tests and unstructured clinical notes. In real-life clinical practice, doctors use complementary multimodal EHR data sources to get a clearer picture of patients’ health and support clinical decision-making. However, most EHR predictive models do not reflect these procedures, as they either focus on a single modality or overlook the inter-modality interactions/redundancy. In this work, we propose <span class="ltx_text ltx_font_bold" id="id28.id1.1">MEDFuse</span>, a <span class="ltx_text ltx_font_bold" id="id28.id1.2">M</span>ultimodal <span class="ltx_text ltx_font_bold" id="id28.id1.3">E</span>HR <span class="ltx_text ltx_font_bold" id="id28.id1.4">D</span>ata <span class="ltx_text ltx_font_bold" id="id28.id1.5">F</span>usion framework that incorporates masked lab-test modeling and large language models (LLMs) to effectively integrate structured and unstructured medical data. MEDFuse leverages multimodal embeddings extracted from two sources: LLMs fine-tuned on free clinical text and masked tabular transformers trained on structured lab test results. We design a disentangled transformer module, optimized by a mutual information loss to 1) decouple modality-specific and modality-shared information and 2) extract useful joint representation from the noise and redundancy present in clinical notes. Through comprehensive validation on the public MIMIC-III dataset and the in-house FEMH dataset, MEDFuse demonstrates great potential in advancing clinical predictions, achieving over 90% F1 score in the 10-disease multi-label classification task.</p>
</div>
<div class="ltx_keywords">Computer-aided Diagnosis; Large Language Model Fine-tuning; Electronic Health Records
</div>
<span class="ltx_note ltx_note_frontmatter ltx_role_copyright" id="id1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">copyright: </span>acmlicensed</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_journalyear" id="id2"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journalyear: </span>2024</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_doi" id="id3"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">doi: </span>XXXXXXX.XXXXXXX</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_conference" id="id4"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">conference: </span>Make sure to enter the correct
conference title from your rights confirmation email; June 03–05,
2018; Woodstock, NY</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_isbn" id="id5"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">isbn: </span>978-1-4503-XXXX-X/18/06</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id6"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Applied computing Health care information systems</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id7"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Computing methodologies Artificial intelligence</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id8"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Information systems  Data mining</span></span></span>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1. </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Electronic Health Records (EHRs) are widely adopted in healthcare, documenting a wealth of heterogeneous patient data comprised of tabular records and unstructured clinical notes. Tabular records encompass essential medical concepts such as diagnoses, medications, and laboratory test results, providing a structured overview of a patient’s health. In contrast, clinical notes are extensive, free-text documents written by healthcare providers, offering a more detailed and nuanced account of the patient’s history, clinical findings, and progress. The vast volume and diversity of multimodal data within EHRs present a unique opportunity for deep learning technologies to improve the prediction and management of diseases <cite class="ltx_cite ltx_citemacro_citep">(Ding et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.12309v1#bib.bib12" title="">2024</a>; Restrepo et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.12309v1#bib.bib28" title="">2024</a>)</cite>.
Nevertheless, the heterogeneous nature and large quantity of redundancy in multimodal EHR inputs pose significant challenges for medical AI practitioners to effectively distill and fuse clinically meaningful information for disease prediction.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">The primary question at hand is: <span class="ltx_text ltx_font_italic" id="S1.p2.1.1">can we effectively obtain and integrate useful representations for different EHR modalities to improve clinical predictions?</span> Current research in deep EHR modeling <cite class="ltx_cite ltx_citemacro_citep">(Luo et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.12309v1#bib.bib25" title="">2020</a>; Ma et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.12309v1#bib.bib26" title="">2017</a>)</cite> often focuses on single data modalities, often neglecting the integration of significant insights from unstructured medical notes and lab tests. This oversight can limit the model from learning a more comprehensive view of patient health conditions. Lab tests consist of high-dimensional, usually discrete tabular data; however, the conventional approach models structured EHR data as numerical vectors, overlooking complex interactions between
individual variables and does not consider their interactions <cite class="ltx_cite ltx_citemacro_citep">(Choi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.12309v1#bib.bib10" title="">2016</a>; Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.12309v1#bib.bib21" title="">2020</a>; Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.12309v1#bib.bib34" title="">2020</a>; Luo et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.12309v1#bib.bib25" title="">2020</a>; Ma et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.12309v1#bib.bib26" title="">2017</a>)</cite>. More recent work has moved towards deep learning architectures like Bert and LLMs. LLMs fine-tuned on clinical data have shown promise in unstructured clinical notes in understanding tasks like answering medical questions and making few-shot predictions <cite class="ltx_cite ltx_citemacro_citep">(Thirunavukarasu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.12309v1#bib.bib31" title="">2023</a>)</cite>. However, there is a large body of evidence showing that LLMs are still having a hard time capturing the nuances of numerical lab test data and are underperforming
on tabular prediction tasks <cite class="ltx_cite ltx_citemacro_citep">(Grinsztajn et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.12309v1#bib.bib14" title="">2022</a>; Bellamy et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.12309v1#bib.bib4" title="">2023</a>; Hegselmann et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.12309v1#bib.bib16" title="">2023</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Another significant challenge in fusing information from different types of EHR data is <span class="ltx_text ltx_font_italic" id="S1.p3.1.1">How do we distill the overlapping clinically important features from both modalities?</span> The information contained within different modalities can be categorized as either modality-specific or modality-shared <cite class="ltx_cite ltx_citemacro_citep">(Liang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.12309v1#bib.bib22" title="">2023</a>)</cite>. For example, a patient’s dietary habits would be considered information specific to the clinical notes modality; hypertension record and lab test value would be regarded as modality-shared information. Existing efforts like multimodal EHR contrastive learning <cite class="ltx_cite ltx_citemacro_citep">(Cai et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.12309v1#bib.bib6" title="">2024</a>)</cite> have primarily focused on integrating the modality-shared information by emphasizing the inherent consistency through alignment techniques. However, this approach often leads to the common information dominating the alignment and integration process, resulting in the distinctive perspectives offered by each modality being disregarded. Lab tests and clinical notes also possess highly different noise-to-information ratios, making it hard to distill useful joint
representation from the noises and redundancy present in EHR. Therefore, there is an urgent need for methods to extract the diverse yet collaborative perspectives both modalities offer for informing therapeutic decision-making.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">In this work, we propose MEDFuse, a novel Multimodal EHR Data Fusion diagnostic model consisting of modality-specific embedding extractors followed by a disentangled transformer for multimodal fusion. Our model integrates embeddings between fine-tuned LLMs on unstructured clinical text and masked lab-test modeling models pre-trained on structured laboratory results. We further utilize a disentangled transformer optimized by mutual information loss to decouple modality-specific and modality-common information and learn meaningful joint representations for downstream prediction tasks. The key contributions of our work are as follows:</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We propose a novel diagnostic model integrating structured lab test data and unstructured clinical notes, utilizing embeddings from fine-tuned LLMs and Masked Lab-Test Modeling, enhancing understanding of diverse clinical information.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">We improved joint patient representation by incorporating a disentangled transformer module to effectively separate and integrate modality-specific and shared information, leading to better prediction outcomes across multiple diseases.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">We conducted empirical evaluations to illustrate our model’s effectiveness through EHR datasets on various metrics.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2. </span>Related work</h2>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_runin ltx_font_bold ltx_title_subsection" style="font-size:144%;">2.1   EHR For Multi-Label Disease Prediction</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">Most recent works in medical Multi-Label Text Classification (MLTC) entirely rely on medical texts. For instance, Kim et al. <cite class="ltx_cite ltx_citemacro_citep">(Chen, <a class="ltx_ref" href="https://arxiv.org/html/2407.12309v1#bib.bib8" title="">2015</a>)</cite> introduced a convolutional attention network designed to extract meaningful document representations across varying text lengths. Recent developments in LLMs, such as those discussed by Luo et al. (2022) and Elliot et al. <cite class="ltx_cite ltx_citemacro_citep">(Bolton et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.12309v1#bib.bib5" title="">2024</a>)</cite>, utilize extensive data from medical literature for domain-specific tasks such as natural language inferencing. Additionally, some studies have employed graph neural networks (GNNs) to organize sequences from Electronic Medical Records (EMR) into hierarchical graphs <cite class="ltx_cite ltx_citemacro_citep">(Wu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.12309v1#bib.bib33" title="">2021</a>)</cite>, or to integrate entity relationships from text using attention mechanisms in neural networks <cite class="ltx_cite ltx_citemacro_citep">(Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.12309v1#bib.bib7" title="">2019</a>; Dun et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.12309v1#bib.bib13" title="">2021</a>)</cite>. Nevertheless, many of these studies overlook the potential advantages of integrating medical expert knowledge from official guidelines and critical blood tests. A combined approach that harnesses both unstructured and structured data could offer extra help to offset issues like label and data scarcity in the medical domain.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_runin ltx_font_bold ltx_title_subsection" style="font-size:144%;">2.2   Extraction of Clinical Relevant Information from Multimodal EHR</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">Recent work has leveraged self-supervised learning methods, like contrastive pretraining of clinical notes <cite class="ltx_cite ltx_citemacro_citep">(Cai et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.12309v1#bib.bib6" title="">2024</a>)</cite> and prompt-based large language modeling <cite class="ltx_cite ltx_citemacro_citep">(Ding et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.12309v1#bib.bib12" title="">2024</a>; Hegselmann et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.12309v1#bib.bib16" title="">2023</a>)</cite>, to facilitate multimodal learning of EHR data. The former encourages the alignment between paired patient data via contrastive loss, and the latter usually directly converts the structured data into text by prompt templates and feeds it into LLMs. However, if the data fusion process focuses solely on aligning the common information, such as diabetes history (text) and blood glucose levels (lab), the rich, modality-specific insights like exercise habits may be overlooked. This can limit understanding of the patient’s health and impact predictive models and clinical decisions. Therefore, it is essential to develop multimodal EHR data fusion techniques that can effectively capture and integrate both modality-specific and modality-shared information.</p>
</div>
<figure class="ltx_figure" id="S2.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="206" id="S2.F1.g1" src="extracted/5736690/images/model.png" width="419"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1. </span>The proposed model architecture.</figcaption>
</figure>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3. </span>Method</h2>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_runin ltx_font_bold ltx_title_subsection" style="font-size:144%;">3.1   Overview</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">Given the clinical notes and lab tests of the patient’s current and historical visits, MEDFuse integrates clinical notes and lab test data to create a comprehensive patient representation for accurate multi-disease prediction. Firstly, as illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2407.12309v1#S2.F1" title="Figure 1 ‣ 2.2 Extraction of Clinical Relevant Information from Multimodal EHR ‣ 2. Related work ‣ MEDFuse: Multimodal EHR Data Fusion with Masked Lab-Test Modeling and Large Language Models"><span class="ltx_text ltx_ref_tag">1</span></a>, in the Multimodal Embedding Extraction stage, textual data from clinical notes, including detailed patient information and medical history, are filtered and structured. Simultaneously, abnormal numerical data from various lab tests, such as triglyceride levels, HDL cholesterol, ALT (SGPT), and glucose levels, are extracted and formatted into textual data by prompt templates. The filtered clinical text is then processed by fine-tuned LLMs to generate embeddings that capture its semantic meaning. In parallel, the raw structured tabular data are processed using a domain-specific masked lab-test model to create embeddings representing the quantitative lab data. The two embeddings are then passed through the disentangled transformer module for multimodal fusion and final disease prediction.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_runin ltx_font_bold ltx_title_subsection" style="font-size:144%;">3.2   Multimodal Embedding Extraction</h3>
<section class="ltx_subsubsection" id="S3.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.1. </span><span class="ltx_text ltx_font_bold" id="S3.SS2.SSS1.1.1">Fine-tuning LLMs on Unstructured Text</span>
</h4>
<div class="ltx_para" id="S3.SS2.SSS1.p1">
<p class="ltx_p" id="S3.SS2.SSS1.p1.1">Clinical notes, comprising diverse fields derived from physicians’ diagnoses, form the textual component of the dataset. We filtered the text by Chief Complaint, Present Illness, Medical History, and Medication on Admission. These specific fields are crucial for accurately predicting a patient’s disease. To integrate this tabular data with the textual clinical notes, we converted the tabular data into a textual format, a process referred to as tabular feature extraction. This method involves extracting abnormal lab test results and formatting them into a text template — “These are abnormal results recorded: ITEMID ¡ITEMID¿: ¡VALUE¿ ¡VALUEUOM¿; ITEMID ¡ITEMID¿: ¡VALUE¿ ¡VALUEUOM¿; …;”. Here, ¡ITEMID¿ refers to the specific lab test names, ¡VALUE¿ indicates the test values, and ¡VALUEUOM¿ denotes the units of measure for the test values.</p>
</div>
<div class="ltx_para" id="S3.SS2.SSS1.p2">
<p class="ltx_p" id="S3.SS2.SSS1.p2.1">Inspired by the recent success of fine-tuning the language models <cite class="ltx_cite ltx_citemacro_citep">(Devlin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.12309v1#bib.bib11" title="">2018</a>; Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.12309v1#bib.bib24" title="">2019</a>)</cite> for classification purposes, we fine-tuned various LLMs for disease prediction. Our best-performing backbone is the publicly accessible Medical-Llama3-8B model <cite class="ltx_cite ltx_citemacro_citep">(ruslanmv, <a class="ltx_ref" href="https://arxiv.org/html/2407.12309v1#bib.bib29" title="">2024</a>)</cite>, which is fine-tuned from Meta-Llama-3-8B <cite class="ltx_cite ltx_citemacro_citep">(AI@Meta, <a class="ltx_ref" href="https://arxiv.org/html/2407.12309v1#bib.bib3" title="">2024b</a>)</cite>. It is trained on a comprehensive medical chatbot dataset and optimized for addressing health-related inquiries. We extracted latent vector representations from the final layer of the Llama decoder, which was originally engineered for autoregressive prediction of subsequent tokens. These extracted vectors were subsequently processed through feed-forward neural layers, effectively transforming them into a label space. The output from these transformations, in the form of logits, was then utilized to perform discriminative classification based on labels. This method aims to harness the latent embedding of LLMs to achieve targeted, efficient task adaptation.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.2. </span><span class="ltx_text ltx_font_bold" id="S3.SS2.SSS2.1.1">Masked Lab-Test Modeling</span>
</h4>
<div class="ltx_para" id="S3.SS2.SSS2.p1">
<p class="ltx_p" id="S3.SS2.SSS2.p1.2">The Masked Lab-Test Modeling (MLTM) module extends the Masked Autoencoders (MAE) <cite class="ltx_cite ltx_citemacro_citep">(He et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.12309v1#bib.bib15" title="">2022</a>; Song et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.12309v1#bib.bib30" title="">2023</a>; Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.12309v1#bib.bib9" title="">2024</a>)</cite> framework to reconstruct masked components based on observed components in EHR data. MLTM consists of a encoder that maps observed values to their representations and a decoder that reconstructs the masked values from the latent representations. To account for the inherent incompleteness in the imputation task, MLTM employs an additional masking approach in the training to make sure a uniform 75% value is masked out. The encoder applies a learnable linear encoding function <math alttext="wx+b" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.1.m1.1"><semantics id="S3.SS2.SSS2.p1.1.m1.1a"><mrow id="S3.SS2.SSS2.p1.1.m1.1.1" xref="S3.SS2.SSS2.p1.1.m1.1.1.cmml"><mrow id="S3.SS2.SSS2.p1.1.m1.1.1.2" xref="S3.SS2.SSS2.p1.1.m1.1.1.2.cmml"><mi id="S3.SS2.SSS2.p1.1.m1.1.1.2.2" xref="S3.SS2.SSS2.p1.1.m1.1.1.2.2.cmml">w</mi><mo id="S3.SS2.SSS2.p1.1.m1.1.1.2.1" xref="S3.SS2.SSS2.p1.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S3.SS2.SSS2.p1.1.m1.1.1.2.3" xref="S3.SS2.SSS2.p1.1.m1.1.1.2.3.cmml">x</mi></mrow><mo id="S3.SS2.SSS2.p1.1.m1.1.1.1" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.cmml">+</mo><mi id="S3.SS2.SSS2.p1.1.m1.1.1.3" xref="S3.SS2.SSS2.p1.1.m1.1.1.3.cmml">b</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.1.m1.1b"><apply id="S3.SS2.SSS2.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1"><plus id="S3.SS2.SSS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1.1"></plus><apply id="S3.SS2.SSS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1.2"><times id="S3.SS2.SSS2.p1.1.m1.1.1.2.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1.2.1"></times><ci id="S3.SS2.SSS2.p1.1.m1.1.1.2.2.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1.2.2">𝑤</ci><ci id="S3.SS2.SSS2.p1.1.m1.1.1.2.3.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1.2.3">𝑥</ci></apply><ci id="S3.SS2.SSS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.1.m1.1c">wx+b</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.1.m1.1d">italic_w italic_x + italic_b</annotation></semantics></math> to each unmasked <math alttext="x" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.2.m2.1"><semantics id="S3.SS2.SSS2.p1.2.m2.1a"><mi id="S3.SS2.SSS2.p1.2.m2.1.1" xref="S3.SS2.SSS2.p1.2.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.2.m2.1b"><ci id="S3.SS2.SSS2.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.2.m2.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.2.m2.1d">italic_x</annotation></semantics></math> and passes through a transformer architecture, while the decoder operates on the embeddings of both observed and masked values. Positional encoding is added to the embeddings to preserve the lab test positions. The reconstruction loss is defined as the mean square error between the reconstructed and original values on the re-masked and unmasked sets. MLTM is designed with an asymmetric architecture, using a deep encoder and a shallow decoder to extract useful lab-test representations.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_runin ltx_font_bold ltx_title_subsection" style="font-size:144%;">3.3   Disentangled Transformer Module</h3>
<figure class="ltx_table" id="S3.T1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1. </span>Training and Validation Performance Comparison of Various Models on the MIMIC-III Dataset.</figcaption>
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S3.T1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T1.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t" id="S3.T1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.1.1.1">Model</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T1.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.1.2.1">Precision</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T1.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.1.3.1">Recall</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T1.1.1.1.4"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.1.4.1">F1 macro</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T1.1.1.1.5"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.1.5.1">F1 weighted</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T1.1.1.1.6"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.1.6.1">Accuracy</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T1.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T1.1.2.1.1">Bert</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.2.1.2">0.8333 / 0.6790</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.2.1.3">0.2000 / 0.2000</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.2.1.4">0.1818 / 0.1618</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.2.1.5">0.3686 / 0.3162</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.2.1.6">0.6515 / 0.2692</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T1.1.3.2.1">LoRA Mistral-7B-v0.1</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.3.2.2">0.8759 / 0.8616</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.3.2.3">0.8459 / 0.8289</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.3.2.4">0.8449 / 0.8274</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.3.2.5">0.9007 / 0.8886</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.3.2.6">0.9089 / 0.8974</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T1.1.4.3.1">LoRA Llama-2-7B-hf</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.4.3.2">0.8828 / 0.8585</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.4.3.3">0.8592 / 0.8364</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.4.3.4">0.8559 / 0.8301</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.4.3.5">0.9097 / 0.8924</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.4.3.6">0.9168 / 0.9004</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.5.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T1.1.5.4.1">LoRA Meta-Llama2-13B</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.5.4.2">0.9153 / 0.8732</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.5.4.3">0.8852 / 0.8430</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.5.4.4">0.8874 / 0.8414</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.5.4.5">0.9297 / 0.8990</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.5.4.6">0.9363 / 0.9071</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.6.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T1.1.6.5.1">LoRA Meta-Llama3-8B</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.6.5.2">0.8899 / 0.8667</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.6.5.3">0.8569 / 0.8306</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.6.5.4">0.8579 / 0.8305</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.6.5.5">0.9121 / 0.8935</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.6.5.6">0.9211 / 0.9040</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.7.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T1.1.7.6.1">LoRA Medical-Llama3-8B</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.7.6.2">0.9283 / 0.8807</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.7.6.3">0.9008 / 0.8474</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.7.6.4">0.9026 / 0.8466</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.7.6.5">0.9367 / 0.9003</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.7.6.6">0.9417 / 0.9068</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.8.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_t" id="S3.T1.1.8.7.1"><span class="ltx_text ltx_font_bold" id="S3.T1.1.8.7.1.1">MEDFuse</span></th>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S3.T1.1.8.7.2"><span class="ltx_text ltx_font_bold" id="S3.T1.1.8.7.2.1">0.9375 / 0.9025</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S3.T1.1.8.7.3"><span class="ltx_text ltx_font_bold" id="S3.T1.1.8.7.3.1">0.9217 / 0.8534</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S3.T1.1.8.7.4"><span class="ltx_text ltx_font_bold" id="S3.T1.1.8.7.4.1">0.9216 / 0.8615</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S3.T1.1.8.7.5"><span class="ltx_text ltx_font_bold" id="S3.T1.1.8.7.5.1">0.9462 / 0.9103</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S3.T1.1.8.7.6"><span class="ltx_text ltx_font_bold" id="S3.T1.1.8.7.6.1">0.9535 / 0.9122</span></td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_table" id="S3.T2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2. </span>Training and Validation Performance on the FEMH Dataset.</figcaption>
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S3.T2.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T2.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t" id="S3.T2.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.1.1.1">Model</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T2.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.1.2.1">Precision</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T2.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.1.3.1">Recall</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T2.1.1.1.4"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.1.4.1">F1 macro</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T2.1.1.1.5"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.1.5.1">F1 weighted</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T2.1.1.1.6"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.1.6.1">Accuracy</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T2.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T2.1.2.1.1">LoRA Medical-Llama3-8B</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.2.1.2">0.8702 / 0.8691</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.2.1.3">0.8496 / 0.8478</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.2.1.4">0.8453 / 0.8435</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.2.1.5">0.9182 / 0.9167</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.2.1.6">0.9267 / 0.9252</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_t" id="S3.T2.1.3.2.1"><span class="ltx_text ltx_font_bold" id="S3.T2.1.3.2.1.1">MEDFuse</span></th>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S3.T2.1.3.2.2"><span class="ltx_text ltx_font_bold" id="S3.T2.1.3.2.2.1">0.8839 / 0.8823</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S3.T2.1.3.2.3"><span class="ltx_text ltx_font_bold" id="S3.T2.1.3.2.3.1">0.8707 / 0.8670</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S3.T2.1.3.2.4"><span class="ltx_text ltx_font_bold" id="S3.T2.1.3.2.4.1">0.8637 / 0.8607</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S3.T2.1.3.2.5"><span class="ltx_text ltx_font_bold" id="S3.T2.1.3.2.5.1">0.9260 / 0.9243</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S3.T2.1.3.2.6"><span class="ltx_text ltx_font_bold" id="S3.T2.1.3.2.6.1">0.9311 / 0.9296</span></td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_table" id="S3.T3">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 3. </span>Ablation Study on Training and Validation Performance on the MIMIC-III Dataset.</figcaption>
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S3.T3.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T3.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t" id="S3.T3.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.1.1.1">Model</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T3.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.1.2.1">Precision</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T3.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.1.3.1">Recall</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T3.1.1.1.4"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.1.4.1">F1 macro</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T3.1.1.1.5"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.1.5.1">F1 weighted</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T3.1.1.1.6"><span class="ltx_text ltx_font_bold" id="S3.T3.1.1.1.6.1">Accuracy</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T3.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T3.1.2.1.1">MEDFuse w/o (MLTM &amp; LABTEXT)</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.2.1.2">0.8882 / 0.8580</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.2.1.3">0.8663 / 0.8406</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.2.1.4">0.8620 / 0.8321</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.2.1.5">0.9100 / 0.8901</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.2.1.6">0.9148 / 0.8955</td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T3.1.3.2.1">MEDFuse w/o (MLTM &amp; TEXT)</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.3.2.2">0.6553 / 0.6224</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.3.2.3">0.6461 / 0.6203</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.3.2.4">0.6282 / 0.5980</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.3.2.5">0.7869 / 0.7627</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.3.2.6">0.8239 / 0.8008</td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T3.1.4.3.1">MEDFuse w/o TEXT</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.4.3.2">0.7730 / 0.7666</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.4.3.3">0.7912 / 0.7923</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.4.3.4">0.7600 / 0.7573</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.4.3.5">0.8331 / 0.8230</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.4.3.6">0.8331 / 0.8271</td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.5.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T3.1.5.4.1">MEDFuse w/o Disentangled Transformer</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.5.4.2">0.9330 / 0.8974</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.5.4.3">0.9164 / 0.8483</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.5.4.4">0.9162 / 0.8564</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.5.4.5">0.9417 / 0.9074</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.5.4.6">0.9489 / 0.9082</td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.6.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_t" id="S3.T3.1.6.5.1"><span class="ltx_text ltx_font_bold" id="S3.T3.1.6.5.1.1">MEDFuse</span></th>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S3.T3.1.6.5.2"><span class="ltx_text ltx_font_bold" id="S3.T3.1.6.5.2.1">0.9375 / 0.9025</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S3.T3.1.6.5.3"><span class="ltx_text ltx_font_bold" id="S3.T3.1.6.5.3.1">0.9217 / 0.8534</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S3.T3.1.6.5.4"><span class="ltx_text ltx_font_bold" id="S3.T3.1.6.5.4.1">0.9216 / 0.8615</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S3.T3.1.6.5.5"><span class="ltx_text ltx_font_bold" id="S3.T3.1.6.5.5.1">0.9462 / 0.9103</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S3.T3.1.6.5.6"><span class="ltx_text ltx_font_bold" id="S3.T3.1.6.5.6.1">0.9535 / 0.9122</span></td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.14">Initially, features from each modality are multiplied by the Kronecker product to approximate a joint distribution, <math alttext="C=A\bigotimes B\in\mathbb{R}^{(m\times(a)\times(b))}" class="ltx_Math" display="inline" id="S3.SS3.p1.1.m1.3"><semantics id="S3.SS3.p1.1.m1.3a"><mrow id="S3.SS3.p1.1.m1.3.4" xref="S3.SS3.p1.1.m1.3.4.cmml"><mi id="S3.SS3.p1.1.m1.3.4.2" xref="S3.SS3.p1.1.m1.3.4.2.cmml">C</mi><mo id="S3.SS3.p1.1.m1.3.4.3" xref="S3.SS3.p1.1.m1.3.4.3.cmml">=</mo><mrow id="S3.SS3.p1.1.m1.3.4.4" xref="S3.SS3.p1.1.m1.3.4.4.cmml"><mi id="S3.SS3.p1.1.m1.3.4.4.2" xref="S3.SS3.p1.1.m1.3.4.4.2.cmml">A</mi><mo id="S3.SS3.p1.1.m1.3.4.4.1" xref="S3.SS3.p1.1.m1.3.4.4.1.cmml">⁢</mo><mrow id="S3.SS3.p1.1.m1.3.4.4.3" xref="S3.SS3.p1.1.m1.3.4.4.3.cmml"><mo id="S3.SS3.p1.1.m1.3.4.4.3.1" xref="S3.SS3.p1.1.m1.3.4.4.3.1.cmml">⨂</mo><mi id="S3.SS3.p1.1.m1.3.4.4.3.2" xref="S3.SS3.p1.1.m1.3.4.4.3.2.cmml">B</mi></mrow></mrow><mo id="S3.SS3.p1.1.m1.3.4.5" xref="S3.SS3.p1.1.m1.3.4.5.cmml">∈</mo><msup id="S3.SS3.p1.1.m1.3.4.6" xref="S3.SS3.p1.1.m1.3.4.6.cmml"><mi id="S3.SS3.p1.1.m1.3.4.6.2" xref="S3.SS3.p1.1.m1.3.4.6.2.cmml">ℝ</mi><mrow id="S3.SS3.p1.1.m1.3.3.3.3" xref="S3.SS3.p1.1.m1.3.3.3.3.1.cmml"><mo id="S3.SS3.p1.1.m1.3.3.3.3.2" stretchy="false" xref="S3.SS3.p1.1.m1.3.3.3.3.1.cmml">(</mo><mrow id="S3.SS3.p1.1.m1.3.3.3.3.1" xref="S3.SS3.p1.1.m1.3.3.3.3.1.cmml"><mi id="S3.SS3.p1.1.m1.3.3.3.3.1.2" xref="S3.SS3.p1.1.m1.3.3.3.3.1.2.cmml">m</mi><mo id="S3.SS3.p1.1.m1.3.3.3.3.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.p1.1.m1.3.3.3.3.1.1.cmml">×</mo><mrow id="S3.SS3.p1.1.m1.3.3.3.3.1.3.2" xref="S3.SS3.p1.1.m1.3.3.3.3.1.cmml"><mo id="S3.SS3.p1.1.m1.3.3.3.3.1.3.2.1" stretchy="false" xref="S3.SS3.p1.1.m1.3.3.3.3.1.cmml">(</mo><mi id="S3.SS3.p1.1.m1.1.1.1.1" xref="S3.SS3.p1.1.m1.1.1.1.1.cmml">a</mi><mo id="S3.SS3.p1.1.m1.3.3.3.3.1.3.2.2" rspace="0.055em" stretchy="false" xref="S3.SS3.p1.1.m1.3.3.3.3.1.cmml">)</mo></mrow><mo id="S3.SS3.p1.1.m1.3.3.3.3.1.1a" rspace="0.222em" xref="S3.SS3.p1.1.m1.3.3.3.3.1.1.cmml">×</mo><mrow id="S3.SS3.p1.1.m1.3.3.3.3.1.4.2" xref="S3.SS3.p1.1.m1.3.3.3.3.1.cmml"><mo id="S3.SS3.p1.1.m1.3.3.3.3.1.4.2.1" stretchy="false" xref="S3.SS3.p1.1.m1.3.3.3.3.1.cmml">(</mo><mi id="S3.SS3.p1.1.m1.2.2.2.2" xref="S3.SS3.p1.1.m1.2.2.2.2.cmml">b</mi><mo id="S3.SS3.p1.1.m1.3.3.3.3.1.4.2.2" stretchy="false" xref="S3.SS3.p1.1.m1.3.3.3.3.1.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p1.1.m1.3.3.3.3.3" stretchy="false" xref="S3.SS3.p1.1.m1.3.3.3.3.1.cmml">)</mo></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.3b"><apply id="S3.SS3.p1.1.m1.3.4.cmml" xref="S3.SS3.p1.1.m1.3.4"><and id="S3.SS3.p1.1.m1.3.4a.cmml" xref="S3.SS3.p1.1.m1.3.4"></and><apply id="S3.SS3.p1.1.m1.3.4b.cmml" xref="S3.SS3.p1.1.m1.3.4"><eq id="S3.SS3.p1.1.m1.3.4.3.cmml" xref="S3.SS3.p1.1.m1.3.4.3"></eq><ci id="S3.SS3.p1.1.m1.3.4.2.cmml" xref="S3.SS3.p1.1.m1.3.4.2">𝐶</ci><apply id="S3.SS3.p1.1.m1.3.4.4.cmml" xref="S3.SS3.p1.1.m1.3.4.4"><times id="S3.SS3.p1.1.m1.3.4.4.1.cmml" xref="S3.SS3.p1.1.m1.3.4.4.1"></times><ci id="S3.SS3.p1.1.m1.3.4.4.2.cmml" xref="S3.SS3.p1.1.m1.3.4.4.2">𝐴</ci><apply id="S3.SS3.p1.1.m1.3.4.4.3.cmml" xref="S3.SS3.p1.1.m1.3.4.4.3"><csymbol cd="latexml" id="S3.SS3.p1.1.m1.3.4.4.3.1.cmml" xref="S3.SS3.p1.1.m1.3.4.4.3.1">tensor-product</csymbol><ci id="S3.SS3.p1.1.m1.3.4.4.3.2.cmml" xref="S3.SS3.p1.1.m1.3.4.4.3.2">𝐵</ci></apply></apply></apply><apply id="S3.SS3.p1.1.m1.3.4c.cmml" xref="S3.SS3.p1.1.m1.3.4"><in id="S3.SS3.p1.1.m1.3.4.5.cmml" xref="S3.SS3.p1.1.m1.3.4.5"></in><share href="https://arxiv.org/html/2407.12309v1#S3.SS3.p1.1.m1.3.4.4.cmml" id="S3.SS3.p1.1.m1.3.4d.cmml" xref="S3.SS3.p1.1.m1.3.4"></share><apply id="S3.SS3.p1.1.m1.3.4.6.cmml" xref="S3.SS3.p1.1.m1.3.4.6"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.3.4.6.1.cmml" xref="S3.SS3.p1.1.m1.3.4.6">superscript</csymbol><ci id="S3.SS3.p1.1.m1.3.4.6.2.cmml" xref="S3.SS3.p1.1.m1.3.4.6.2">ℝ</ci><apply id="S3.SS3.p1.1.m1.3.3.3.3.1.cmml" xref="S3.SS3.p1.1.m1.3.3.3.3"><times id="S3.SS3.p1.1.m1.3.3.3.3.1.1.cmml" xref="S3.SS3.p1.1.m1.3.3.3.3.1.1"></times><ci id="S3.SS3.p1.1.m1.3.3.3.3.1.2.cmml" xref="S3.SS3.p1.1.m1.3.3.3.3.1.2">𝑚</ci><ci id="S3.SS3.p1.1.m1.1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1.1.1">𝑎</ci><ci id="S3.SS3.p1.1.m1.2.2.2.2.cmml" xref="S3.SS3.p1.1.m1.2.2.2.2">𝑏</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.3c">C=A\bigotimes B\in\mathbb{R}^{(m\times(a)\times(b))}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.1.m1.3d">italic_C = italic_A ⨂ italic_B ∈ blackboard_R start_POSTSUPERSCRIPT ( italic_m × ( italic_a ) × ( italic_b ) ) end_POSTSUPERSCRIPT</annotation></semantics></math>, effectively capturing the pairwise interactions. Self-attention is applied to <math alttext="Z_{a}" class="ltx_Math" display="inline" id="S3.SS3.p1.2.m2.1"><semantics id="S3.SS3.p1.2.m2.1a"><msub id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml"><mi id="S3.SS3.p1.2.m2.1.1.2" xref="S3.SS3.p1.2.m2.1.1.2.cmml">Z</mi><mi id="S3.SS3.p1.2.m2.1.1.3" xref="S3.SS3.p1.2.m2.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><apply id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.1.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p1.2.m2.1.1.2.cmml" xref="S3.SS3.p1.2.m2.1.1.2">𝑍</ci><ci id="S3.SS3.p1.2.m2.1.1.3.cmml" xref="S3.SS3.p1.2.m2.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">Z_{a}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.2.m2.1d">italic_Z start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="Z_{b}" class="ltx_Math" display="inline" id="S3.SS3.p1.3.m3.1"><semantics id="S3.SS3.p1.3.m3.1a"><msub id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml"><mi id="S3.SS3.p1.3.m3.1.1.2" xref="S3.SS3.p1.3.m3.1.1.2.cmml">Z</mi><mi id="S3.SS3.p1.3.m3.1.1.3" xref="S3.SS3.p1.3.m3.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><apply id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.3.m3.1.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.p1.3.m3.1.1.2.cmml" xref="S3.SS3.p1.3.m3.1.1.2">𝑍</ci><ci id="S3.SS3.p1.3.m3.1.1.3.cmml" xref="S3.SS3.p1.3.m3.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">Z_{b}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.3.m3.1d">italic_Z start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT</annotation></semantics></math> to obtain <math alttext="S_{a}" class="ltx_Math" display="inline" id="S3.SS3.p1.4.m4.1"><semantics id="S3.SS3.p1.4.m4.1a"><msub id="S3.SS3.p1.4.m4.1.1" xref="S3.SS3.p1.4.m4.1.1.cmml"><mi id="S3.SS3.p1.4.m4.1.1.2" xref="S3.SS3.p1.4.m4.1.1.2.cmml">S</mi><mi id="S3.SS3.p1.4.m4.1.1.3" xref="S3.SS3.p1.4.m4.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m4.1b"><apply id="S3.SS3.p1.4.m4.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m4.1.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.p1.4.m4.1.1.2.cmml" xref="S3.SS3.p1.4.m4.1.1.2">𝑆</ci><ci id="S3.SS3.p1.4.m4.1.1.3.cmml" xref="S3.SS3.p1.4.m4.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m4.1c">S_{a}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.4.m4.1d">italic_S start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="S_{b}" class="ltx_Math" display="inline" id="S3.SS3.p1.5.m5.1"><semantics id="S3.SS3.p1.5.m5.1a"><msub id="S3.SS3.p1.5.m5.1.1" xref="S3.SS3.p1.5.m5.1.1.cmml"><mi id="S3.SS3.p1.5.m5.1.1.2" xref="S3.SS3.p1.5.m5.1.1.2.cmml">S</mi><mi id="S3.SS3.p1.5.m5.1.1.3" xref="S3.SS3.p1.5.m5.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.5.m5.1b"><apply id="S3.SS3.p1.5.m5.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m5.1.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS3.p1.5.m5.1.1.2.cmml" xref="S3.SS3.p1.5.m5.1.1.2">𝑆</ci><ci id="S3.SS3.p1.5.m5.1.1.3.cmml" xref="S3.SS3.p1.5.m5.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.5.m5.1c">S_{b}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.5.m5.1d">italic_S start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT</annotation></semantics></math>, controlling the expressivity of each modality and preventing noisy features. Subsequently, the common information of the joint distribution is extracted via cross attention of <math alttext="Q_{c}" class="ltx_Math" display="inline" id="S3.SS3.p1.6.m6.1"><semantics id="S3.SS3.p1.6.m6.1a"><msub id="S3.SS3.p1.6.m6.1.1" xref="S3.SS3.p1.6.m6.1.1.cmml"><mi id="S3.SS3.p1.6.m6.1.1.2" xref="S3.SS3.p1.6.m6.1.1.2.cmml">Q</mi><mi id="S3.SS3.p1.6.m6.1.1.3" xref="S3.SS3.p1.6.m6.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.6.m6.1b"><apply id="S3.SS3.p1.6.m6.1.1.cmml" xref="S3.SS3.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.6.m6.1.1.1.cmml" xref="S3.SS3.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS3.p1.6.m6.1.1.2.cmml" xref="S3.SS3.p1.6.m6.1.1.2">𝑄</ci><ci id="S3.SS3.p1.6.m6.1.1.3.cmml" xref="S3.SS3.p1.6.m6.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.6.m6.1c">Q_{c}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.6.m6.1d">italic_Q start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="K_{c}+K_{a}+K_{b}" class="ltx_Math" display="inline" id="S3.SS3.p1.7.m7.1"><semantics id="S3.SS3.p1.7.m7.1a"><mrow id="S3.SS3.p1.7.m7.1.1" xref="S3.SS3.p1.7.m7.1.1.cmml"><msub id="S3.SS3.p1.7.m7.1.1.2" xref="S3.SS3.p1.7.m7.1.1.2.cmml"><mi id="S3.SS3.p1.7.m7.1.1.2.2" xref="S3.SS3.p1.7.m7.1.1.2.2.cmml">K</mi><mi id="S3.SS3.p1.7.m7.1.1.2.3" xref="S3.SS3.p1.7.m7.1.1.2.3.cmml">c</mi></msub><mo id="S3.SS3.p1.7.m7.1.1.1" xref="S3.SS3.p1.7.m7.1.1.1.cmml">+</mo><msub id="S3.SS3.p1.7.m7.1.1.3" xref="S3.SS3.p1.7.m7.1.1.3.cmml"><mi id="S3.SS3.p1.7.m7.1.1.3.2" xref="S3.SS3.p1.7.m7.1.1.3.2.cmml">K</mi><mi id="S3.SS3.p1.7.m7.1.1.3.3" xref="S3.SS3.p1.7.m7.1.1.3.3.cmml">a</mi></msub><mo id="S3.SS3.p1.7.m7.1.1.1a" xref="S3.SS3.p1.7.m7.1.1.1.cmml">+</mo><msub id="S3.SS3.p1.7.m7.1.1.4" xref="S3.SS3.p1.7.m7.1.1.4.cmml"><mi id="S3.SS3.p1.7.m7.1.1.4.2" xref="S3.SS3.p1.7.m7.1.1.4.2.cmml">K</mi><mi id="S3.SS3.p1.7.m7.1.1.4.3" xref="S3.SS3.p1.7.m7.1.1.4.3.cmml">b</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.7.m7.1b"><apply id="S3.SS3.p1.7.m7.1.1.cmml" xref="S3.SS3.p1.7.m7.1.1"><plus id="S3.SS3.p1.7.m7.1.1.1.cmml" xref="S3.SS3.p1.7.m7.1.1.1"></plus><apply id="S3.SS3.p1.7.m7.1.1.2.cmml" xref="S3.SS3.p1.7.m7.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.7.m7.1.1.2.1.cmml" xref="S3.SS3.p1.7.m7.1.1.2">subscript</csymbol><ci id="S3.SS3.p1.7.m7.1.1.2.2.cmml" xref="S3.SS3.p1.7.m7.1.1.2.2">𝐾</ci><ci id="S3.SS3.p1.7.m7.1.1.2.3.cmml" xref="S3.SS3.p1.7.m7.1.1.2.3">𝑐</ci></apply><apply id="S3.SS3.p1.7.m7.1.1.3.cmml" xref="S3.SS3.p1.7.m7.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.7.m7.1.1.3.1.cmml" xref="S3.SS3.p1.7.m7.1.1.3">subscript</csymbol><ci id="S3.SS3.p1.7.m7.1.1.3.2.cmml" xref="S3.SS3.p1.7.m7.1.1.3.2">𝐾</ci><ci id="S3.SS3.p1.7.m7.1.1.3.3.cmml" xref="S3.SS3.p1.7.m7.1.1.3.3">𝑎</ci></apply><apply id="S3.SS3.p1.7.m7.1.1.4.cmml" xref="S3.SS3.p1.7.m7.1.1.4"><csymbol cd="ambiguous" id="S3.SS3.p1.7.m7.1.1.4.1.cmml" xref="S3.SS3.p1.7.m7.1.1.4">subscript</csymbol><ci id="S3.SS3.p1.7.m7.1.1.4.2.cmml" xref="S3.SS3.p1.7.m7.1.1.4.2">𝐾</ci><ci id="S3.SS3.p1.7.m7.1.1.4.3.cmml" xref="S3.SS3.p1.7.m7.1.1.4.3">𝑏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.7.m7.1c">K_{c}+K_{a}+K_{b}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.7.m7.1d">italic_K start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT + italic_K start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT + italic_K start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="V_{c}+V_{a}+V_{b}" class="ltx_Math" display="inline" id="S3.SS3.p1.8.m8.1"><semantics id="S3.SS3.p1.8.m8.1a"><mrow id="S3.SS3.p1.8.m8.1.1" xref="S3.SS3.p1.8.m8.1.1.cmml"><msub id="S3.SS3.p1.8.m8.1.1.2" xref="S3.SS3.p1.8.m8.1.1.2.cmml"><mi id="S3.SS3.p1.8.m8.1.1.2.2" xref="S3.SS3.p1.8.m8.1.1.2.2.cmml">V</mi><mi id="S3.SS3.p1.8.m8.1.1.2.3" xref="S3.SS3.p1.8.m8.1.1.2.3.cmml">c</mi></msub><mo id="S3.SS3.p1.8.m8.1.1.1" xref="S3.SS3.p1.8.m8.1.1.1.cmml">+</mo><msub id="S3.SS3.p1.8.m8.1.1.3" xref="S3.SS3.p1.8.m8.1.1.3.cmml"><mi id="S3.SS3.p1.8.m8.1.1.3.2" xref="S3.SS3.p1.8.m8.1.1.3.2.cmml">V</mi><mi id="S3.SS3.p1.8.m8.1.1.3.3" xref="S3.SS3.p1.8.m8.1.1.3.3.cmml">a</mi></msub><mo id="S3.SS3.p1.8.m8.1.1.1a" xref="S3.SS3.p1.8.m8.1.1.1.cmml">+</mo><msub id="S3.SS3.p1.8.m8.1.1.4" xref="S3.SS3.p1.8.m8.1.1.4.cmml"><mi id="S3.SS3.p1.8.m8.1.1.4.2" xref="S3.SS3.p1.8.m8.1.1.4.2.cmml">V</mi><mi id="S3.SS3.p1.8.m8.1.1.4.3" xref="S3.SS3.p1.8.m8.1.1.4.3.cmml">b</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.8.m8.1b"><apply id="S3.SS3.p1.8.m8.1.1.cmml" xref="S3.SS3.p1.8.m8.1.1"><plus id="S3.SS3.p1.8.m8.1.1.1.cmml" xref="S3.SS3.p1.8.m8.1.1.1"></plus><apply id="S3.SS3.p1.8.m8.1.1.2.cmml" xref="S3.SS3.p1.8.m8.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.8.m8.1.1.2.1.cmml" xref="S3.SS3.p1.8.m8.1.1.2">subscript</csymbol><ci id="S3.SS3.p1.8.m8.1.1.2.2.cmml" xref="S3.SS3.p1.8.m8.1.1.2.2">𝑉</ci><ci id="S3.SS3.p1.8.m8.1.1.2.3.cmml" xref="S3.SS3.p1.8.m8.1.1.2.3">𝑐</ci></apply><apply id="S3.SS3.p1.8.m8.1.1.3.cmml" xref="S3.SS3.p1.8.m8.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.8.m8.1.1.3.1.cmml" xref="S3.SS3.p1.8.m8.1.1.3">subscript</csymbol><ci id="S3.SS3.p1.8.m8.1.1.3.2.cmml" xref="S3.SS3.p1.8.m8.1.1.3.2">𝑉</ci><ci id="S3.SS3.p1.8.m8.1.1.3.3.cmml" xref="S3.SS3.p1.8.m8.1.1.3.3">𝑎</ci></apply><apply id="S3.SS3.p1.8.m8.1.1.4.cmml" xref="S3.SS3.p1.8.m8.1.1.4"><csymbol cd="ambiguous" id="S3.SS3.p1.8.m8.1.1.4.1.cmml" xref="S3.SS3.p1.8.m8.1.1.4">subscript</csymbol><ci id="S3.SS3.p1.8.m8.1.1.4.2.cmml" xref="S3.SS3.p1.8.m8.1.1.4.2">𝑉</ci><ci id="S3.SS3.p1.8.m8.1.1.4.3.cmml" xref="S3.SS3.p1.8.m8.1.1.4.3">𝑏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.8.m8.1c">V_{c}+V_{a}+V_{b}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.8.m8.1d">italic_V start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT + italic_V start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT + italic_V start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT</annotation></semantics></math> to model modality-common features <math alttext="S_{c}" class="ltx_Math" display="inline" id="S3.SS3.p1.9.m9.1"><semantics id="S3.SS3.p1.9.m9.1a"><msub id="S3.SS3.p1.9.m9.1.1" xref="S3.SS3.p1.9.m9.1.1.cmml"><mi id="S3.SS3.p1.9.m9.1.1.2" xref="S3.SS3.p1.9.m9.1.1.2.cmml">S</mi><mi id="S3.SS3.p1.9.m9.1.1.3" xref="S3.SS3.p1.9.m9.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.9.m9.1b"><apply id="S3.SS3.p1.9.m9.1.1.cmml" xref="S3.SS3.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.9.m9.1.1.1.cmml" xref="S3.SS3.p1.9.m9.1.1">subscript</csymbol><ci id="S3.SS3.p1.9.m9.1.1.2.cmml" xref="S3.SS3.p1.9.m9.1.1.2">𝑆</ci><ci id="S3.SS3.p1.9.m9.1.1.3.cmml" xref="S3.SS3.p1.9.m9.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.9.m9.1c">S_{c}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.9.m9.1d">italic_S start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math>. To preserve modality-specific information, we minimize the Mutual Information (MI) loss between concatenated <math alttext="S_{a}+S_{b}" class="ltx_Math" display="inline" id="S3.SS3.p1.10.m10.1"><semantics id="S3.SS3.p1.10.m10.1a"><mrow id="S3.SS3.p1.10.m10.1.1" xref="S3.SS3.p1.10.m10.1.1.cmml"><msub id="S3.SS3.p1.10.m10.1.1.2" xref="S3.SS3.p1.10.m10.1.1.2.cmml"><mi id="S3.SS3.p1.10.m10.1.1.2.2" xref="S3.SS3.p1.10.m10.1.1.2.2.cmml">S</mi><mi id="S3.SS3.p1.10.m10.1.1.2.3" xref="S3.SS3.p1.10.m10.1.1.2.3.cmml">a</mi></msub><mo id="S3.SS3.p1.10.m10.1.1.1" xref="S3.SS3.p1.10.m10.1.1.1.cmml">+</mo><msub id="S3.SS3.p1.10.m10.1.1.3" xref="S3.SS3.p1.10.m10.1.1.3.cmml"><mi id="S3.SS3.p1.10.m10.1.1.3.2" xref="S3.SS3.p1.10.m10.1.1.3.2.cmml">S</mi><mi id="S3.SS3.p1.10.m10.1.1.3.3" xref="S3.SS3.p1.10.m10.1.1.3.3.cmml">b</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.10.m10.1b"><apply id="S3.SS3.p1.10.m10.1.1.cmml" xref="S3.SS3.p1.10.m10.1.1"><plus id="S3.SS3.p1.10.m10.1.1.1.cmml" xref="S3.SS3.p1.10.m10.1.1.1"></plus><apply id="S3.SS3.p1.10.m10.1.1.2.cmml" xref="S3.SS3.p1.10.m10.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.10.m10.1.1.2.1.cmml" xref="S3.SS3.p1.10.m10.1.1.2">subscript</csymbol><ci id="S3.SS3.p1.10.m10.1.1.2.2.cmml" xref="S3.SS3.p1.10.m10.1.1.2.2">𝑆</ci><ci id="S3.SS3.p1.10.m10.1.1.2.3.cmml" xref="S3.SS3.p1.10.m10.1.1.2.3">𝑎</ci></apply><apply id="S3.SS3.p1.10.m10.1.1.3.cmml" xref="S3.SS3.p1.10.m10.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.10.m10.1.1.3.1.cmml" xref="S3.SS3.p1.10.m10.1.1.3">subscript</csymbol><ci id="S3.SS3.p1.10.m10.1.1.3.2.cmml" xref="S3.SS3.p1.10.m10.1.1.3.2">𝑆</ci><ci id="S3.SS3.p1.10.m10.1.1.3.3.cmml" xref="S3.SS3.p1.10.m10.1.1.3.3">𝑏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.10.m10.1c">S_{a}+S_{b}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.10.m10.1d">italic_S start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT + italic_S start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="S_{c}" class="ltx_Math" display="inline" id="S3.SS3.p1.11.m11.1"><semantics id="S3.SS3.p1.11.m11.1a"><msub id="S3.SS3.p1.11.m11.1.1" xref="S3.SS3.p1.11.m11.1.1.cmml"><mi id="S3.SS3.p1.11.m11.1.1.2" xref="S3.SS3.p1.11.m11.1.1.2.cmml">S</mi><mi id="S3.SS3.p1.11.m11.1.1.3" xref="S3.SS3.p1.11.m11.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.11.m11.1b"><apply id="S3.SS3.p1.11.m11.1.1.cmml" xref="S3.SS3.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.11.m11.1.1.1.cmml" xref="S3.SS3.p1.11.m11.1.1">subscript</csymbol><ci id="S3.SS3.p1.11.m11.1.1.2.cmml" xref="S3.SS3.p1.11.m11.1.1.2">𝑆</ci><ci id="S3.SS3.p1.11.m11.1.1.3.cmml" xref="S3.SS3.p1.11.m11.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.11.m11.1c">S_{c}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.11.m11.1d">italic_S start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math>. As the computation of mutual information is intractable, we calculate a variational upper bound called contrastive log-ratio upper bound (vCLUB) as an MI estimator to achieve MI minimization. Given two variables <math alttext="a" class="ltx_Math" display="inline" id="S3.SS3.p1.12.m12.1"><semantics id="S3.SS3.p1.12.m12.1a"><mi id="S3.SS3.p1.12.m12.1.1" xref="S3.SS3.p1.12.m12.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.12.m12.1b"><ci id="S3.SS3.p1.12.m12.1.1.cmml" xref="S3.SS3.p1.12.m12.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.12.m12.1c">a</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.12.m12.1d">italic_a</annotation></semantics></math> and <math alttext="b" class="ltx_Math" display="inline" id="S3.SS3.p1.13.m13.1"><semantics id="S3.SS3.p1.13.m13.1a"><mi id="S3.SS3.p1.13.m13.1.1" xref="S3.SS3.p1.13.m13.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.13.m13.1b"><ci id="S3.SS3.p1.13.m13.1.1.cmml" xref="S3.SS3.p1.13.m13.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.13.m13.1c">b</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.13.m13.1d">italic_b</annotation></semantics></math>, the <math alttext="L_{v}^{CLUB}(a,b)" class="ltx_Math" display="inline" id="S3.SS3.p1.14.m14.2"><semantics id="S3.SS3.p1.14.m14.2a"><mrow id="S3.SS3.p1.14.m14.2.3" xref="S3.SS3.p1.14.m14.2.3.cmml"><msubsup id="S3.SS3.p1.14.m14.2.3.2" xref="S3.SS3.p1.14.m14.2.3.2.cmml"><mi id="S3.SS3.p1.14.m14.2.3.2.2.2" xref="S3.SS3.p1.14.m14.2.3.2.2.2.cmml">L</mi><mi id="S3.SS3.p1.14.m14.2.3.2.2.3" xref="S3.SS3.p1.14.m14.2.3.2.2.3.cmml">v</mi><mrow id="S3.SS3.p1.14.m14.2.3.2.3" xref="S3.SS3.p1.14.m14.2.3.2.3.cmml"><mi id="S3.SS3.p1.14.m14.2.3.2.3.2" xref="S3.SS3.p1.14.m14.2.3.2.3.2.cmml">C</mi><mo id="S3.SS3.p1.14.m14.2.3.2.3.1" xref="S3.SS3.p1.14.m14.2.3.2.3.1.cmml">⁢</mo><mi id="S3.SS3.p1.14.m14.2.3.2.3.3" xref="S3.SS3.p1.14.m14.2.3.2.3.3.cmml">L</mi><mo id="S3.SS3.p1.14.m14.2.3.2.3.1a" xref="S3.SS3.p1.14.m14.2.3.2.3.1.cmml">⁢</mo><mi id="S3.SS3.p1.14.m14.2.3.2.3.4" xref="S3.SS3.p1.14.m14.2.3.2.3.4.cmml">U</mi><mo id="S3.SS3.p1.14.m14.2.3.2.3.1b" xref="S3.SS3.p1.14.m14.2.3.2.3.1.cmml">⁢</mo><mi id="S3.SS3.p1.14.m14.2.3.2.3.5" xref="S3.SS3.p1.14.m14.2.3.2.3.5.cmml">B</mi></mrow></msubsup><mo id="S3.SS3.p1.14.m14.2.3.1" xref="S3.SS3.p1.14.m14.2.3.1.cmml">⁢</mo><mrow id="S3.SS3.p1.14.m14.2.3.3.2" xref="S3.SS3.p1.14.m14.2.3.3.1.cmml"><mo id="S3.SS3.p1.14.m14.2.3.3.2.1" stretchy="false" xref="S3.SS3.p1.14.m14.2.3.3.1.cmml">(</mo><mi id="S3.SS3.p1.14.m14.1.1" xref="S3.SS3.p1.14.m14.1.1.cmml">a</mi><mo id="S3.SS3.p1.14.m14.2.3.3.2.2" xref="S3.SS3.p1.14.m14.2.3.3.1.cmml">,</mo><mi id="S3.SS3.p1.14.m14.2.2" xref="S3.SS3.p1.14.m14.2.2.cmml">b</mi><mo id="S3.SS3.p1.14.m14.2.3.3.2.3" stretchy="false" xref="S3.SS3.p1.14.m14.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.14.m14.2b"><apply id="S3.SS3.p1.14.m14.2.3.cmml" xref="S3.SS3.p1.14.m14.2.3"><times id="S3.SS3.p1.14.m14.2.3.1.cmml" xref="S3.SS3.p1.14.m14.2.3.1"></times><apply id="S3.SS3.p1.14.m14.2.3.2.cmml" xref="S3.SS3.p1.14.m14.2.3.2"><csymbol cd="ambiguous" id="S3.SS3.p1.14.m14.2.3.2.1.cmml" xref="S3.SS3.p1.14.m14.2.3.2">superscript</csymbol><apply id="S3.SS3.p1.14.m14.2.3.2.2.cmml" xref="S3.SS3.p1.14.m14.2.3.2"><csymbol cd="ambiguous" id="S3.SS3.p1.14.m14.2.3.2.2.1.cmml" xref="S3.SS3.p1.14.m14.2.3.2">subscript</csymbol><ci id="S3.SS3.p1.14.m14.2.3.2.2.2.cmml" xref="S3.SS3.p1.14.m14.2.3.2.2.2">𝐿</ci><ci id="S3.SS3.p1.14.m14.2.3.2.2.3.cmml" xref="S3.SS3.p1.14.m14.2.3.2.2.3">𝑣</ci></apply><apply id="S3.SS3.p1.14.m14.2.3.2.3.cmml" xref="S3.SS3.p1.14.m14.2.3.2.3"><times id="S3.SS3.p1.14.m14.2.3.2.3.1.cmml" xref="S3.SS3.p1.14.m14.2.3.2.3.1"></times><ci id="S3.SS3.p1.14.m14.2.3.2.3.2.cmml" xref="S3.SS3.p1.14.m14.2.3.2.3.2">𝐶</ci><ci id="S3.SS3.p1.14.m14.2.3.2.3.3.cmml" xref="S3.SS3.p1.14.m14.2.3.2.3.3">𝐿</ci><ci id="S3.SS3.p1.14.m14.2.3.2.3.4.cmml" xref="S3.SS3.p1.14.m14.2.3.2.3.4">𝑈</ci><ci id="S3.SS3.p1.14.m14.2.3.2.3.5.cmml" xref="S3.SS3.p1.14.m14.2.3.2.3.5">𝐵</ci></apply></apply><interval closure="open" id="S3.SS3.p1.14.m14.2.3.3.1.cmml" xref="S3.SS3.p1.14.m14.2.3.3.2"><ci id="S3.SS3.p1.14.m14.1.1.cmml" xref="S3.SS3.p1.14.m14.1.1">𝑎</ci><ci id="S3.SS3.p1.14.m14.2.2.cmml" xref="S3.SS3.p1.14.m14.2.2">𝑏</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.14.m14.2c">L_{v}^{CLUB}(a,b)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.14.m14.2d">italic_L start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_C italic_L italic_U italic_B end_POSTSUPERSCRIPT ( italic_a , italic_b )</annotation></semantics></math> is calculated as follows <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.12309v1#bib.bib35" title="">2024</a>)</cite>:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S5.EGx1">
<tbody id="S3.Ex1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle L_{v}^{CLUB}(a,b)" class="ltx_Math" display="inline" id="S3.Ex1.m1.2"><semantics id="S3.Ex1.m1.2a"><mrow id="S3.Ex1.m1.2.3" xref="S3.Ex1.m1.2.3.cmml"><msubsup id="S3.Ex1.m1.2.3.2" xref="S3.Ex1.m1.2.3.2.cmml"><mi id="S3.Ex1.m1.2.3.2.2.2" xref="S3.Ex1.m1.2.3.2.2.2.cmml">L</mi><mi id="S3.Ex1.m1.2.3.2.2.3" xref="S3.Ex1.m1.2.3.2.2.3.cmml">v</mi><mrow id="S3.Ex1.m1.2.3.2.3" xref="S3.Ex1.m1.2.3.2.3.cmml"><mi id="S3.Ex1.m1.2.3.2.3.2" xref="S3.Ex1.m1.2.3.2.3.2.cmml">C</mi><mo id="S3.Ex1.m1.2.3.2.3.1" xref="S3.Ex1.m1.2.3.2.3.1.cmml">⁢</mo><mi id="S3.Ex1.m1.2.3.2.3.3" xref="S3.Ex1.m1.2.3.2.3.3.cmml">L</mi><mo id="S3.Ex1.m1.2.3.2.3.1a" xref="S3.Ex1.m1.2.3.2.3.1.cmml">⁢</mo><mi id="S3.Ex1.m1.2.3.2.3.4" xref="S3.Ex1.m1.2.3.2.3.4.cmml">U</mi><mo id="S3.Ex1.m1.2.3.2.3.1b" xref="S3.Ex1.m1.2.3.2.3.1.cmml">⁢</mo><mi id="S3.Ex1.m1.2.3.2.3.5" xref="S3.Ex1.m1.2.3.2.3.5.cmml">B</mi></mrow></msubsup><mo id="S3.Ex1.m1.2.3.1" xref="S3.Ex1.m1.2.3.1.cmml">⁢</mo><mrow id="S3.Ex1.m1.2.3.3.2" xref="S3.Ex1.m1.2.3.3.1.cmml"><mo id="S3.Ex1.m1.2.3.3.2.1" stretchy="false" xref="S3.Ex1.m1.2.3.3.1.cmml">(</mo><mi id="S3.Ex1.m1.1.1" xref="S3.Ex1.m1.1.1.cmml">a</mi><mo id="S3.Ex1.m1.2.3.3.2.2" xref="S3.Ex1.m1.2.3.3.1.cmml">,</mo><mi id="S3.Ex1.m1.2.2" xref="S3.Ex1.m1.2.2.cmml">b</mi><mo id="S3.Ex1.m1.2.3.3.2.3" stretchy="false" xref="S3.Ex1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.2b"><apply id="S3.Ex1.m1.2.3.cmml" xref="S3.Ex1.m1.2.3"><times id="S3.Ex1.m1.2.3.1.cmml" xref="S3.Ex1.m1.2.3.1"></times><apply id="S3.Ex1.m1.2.3.2.cmml" xref="S3.Ex1.m1.2.3.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.2.3.2.1.cmml" xref="S3.Ex1.m1.2.3.2">superscript</csymbol><apply id="S3.Ex1.m1.2.3.2.2.cmml" xref="S3.Ex1.m1.2.3.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.2.3.2.2.1.cmml" xref="S3.Ex1.m1.2.3.2">subscript</csymbol><ci id="S3.Ex1.m1.2.3.2.2.2.cmml" xref="S3.Ex1.m1.2.3.2.2.2">𝐿</ci><ci id="S3.Ex1.m1.2.3.2.2.3.cmml" xref="S3.Ex1.m1.2.3.2.2.3">𝑣</ci></apply><apply id="S3.Ex1.m1.2.3.2.3.cmml" xref="S3.Ex1.m1.2.3.2.3"><times id="S3.Ex1.m1.2.3.2.3.1.cmml" xref="S3.Ex1.m1.2.3.2.3.1"></times><ci id="S3.Ex1.m1.2.3.2.3.2.cmml" xref="S3.Ex1.m1.2.3.2.3.2">𝐶</ci><ci id="S3.Ex1.m1.2.3.2.3.3.cmml" xref="S3.Ex1.m1.2.3.2.3.3">𝐿</ci><ci id="S3.Ex1.m1.2.3.2.3.4.cmml" xref="S3.Ex1.m1.2.3.2.3.4">𝑈</ci><ci id="S3.Ex1.m1.2.3.2.3.5.cmml" xref="S3.Ex1.m1.2.3.2.3.5">𝐵</ci></apply></apply><interval closure="open" id="S3.Ex1.m1.2.3.3.1.cmml" xref="S3.Ex1.m1.2.3.3.2"><ci id="S3.Ex1.m1.1.1.cmml" xref="S3.Ex1.m1.1.1">𝑎</ci><ci id="S3.Ex1.m1.2.2.cmml" xref="S3.Ex1.m1.2.2">𝑏</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.2c">\displaystyle L_{v}^{CLUB}(a,b)</annotation><annotation encoding="application/x-llamapun" id="S3.Ex1.m1.2d">italic_L start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_C italic_L italic_U italic_B end_POSTSUPERSCRIPT ( italic_a , italic_b )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathbb{E}_{p}(a,b)\left[\log q_{\theta}(b|a)\right]-\mathbb{E}_%
{p}(a)\mathbb{E}_{p}(b)\left[\log q_{\theta}(b|a)\right]" class="ltx_Math" display="inline" id="S3.Ex1.m2.6"><semantics id="S3.Ex1.m2.6a"><mrow id="S3.Ex1.m2.6.6" xref="S3.Ex1.m2.6.6.cmml"><mi id="S3.Ex1.m2.6.6.4" xref="S3.Ex1.m2.6.6.4.cmml"></mi><mo id="S3.Ex1.m2.6.6.3" xref="S3.Ex1.m2.6.6.3.cmml">=</mo><mrow id="S3.Ex1.m2.6.6.2" xref="S3.Ex1.m2.6.6.2.cmml"><mrow id="S3.Ex1.m2.5.5.1.1" xref="S3.Ex1.m2.5.5.1.1.cmml"><msub id="S3.Ex1.m2.5.5.1.1.3" xref="S3.Ex1.m2.5.5.1.1.3.cmml"><mi id="S3.Ex1.m2.5.5.1.1.3.2" xref="S3.Ex1.m2.5.5.1.1.3.2.cmml">𝔼</mi><mi id="S3.Ex1.m2.5.5.1.1.3.3" xref="S3.Ex1.m2.5.5.1.1.3.3.cmml">p</mi></msub><mo id="S3.Ex1.m2.5.5.1.1.2" xref="S3.Ex1.m2.5.5.1.1.2.cmml">⁢</mo><mrow id="S3.Ex1.m2.5.5.1.1.4.2" xref="S3.Ex1.m2.5.5.1.1.4.1.cmml"><mo id="S3.Ex1.m2.5.5.1.1.4.2.1" stretchy="false" xref="S3.Ex1.m2.5.5.1.1.4.1.cmml">(</mo><mi id="S3.Ex1.m2.1.1" xref="S3.Ex1.m2.1.1.cmml">a</mi><mo id="S3.Ex1.m2.5.5.1.1.4.2.2" xref="S3.Ex1.m2.5.5.1.1.4.1.cmml">,</mo><mi id="S3.Ex1.m2.2.2" xref="S3.Ex1.m2.2.2.cmml">b</mi><mo id="S3.Ex1.m2.5.5.1.1.4.2.3" stretchy="false" xref="S3.Ex1.m2.5.5.1.1.4.1.cmml">)</mo></mrow><mo id="S3.Ex1.m2.5.5.1.1.2a" xref="S3.Ex1.m2.5.5.1.1.2.cmml">⁢</mo><mrow id="S3.Ex1.m2.5.5.1.1.1.1" xref="S3.Ex1.m2.5.5.1.1.1.2.cmml"><mo id="S3.Ex1.m2.5.5.1.1.1.1.2" xref="S3.Ex1.m2.5.5.1.1.1.2.1.cmml">[</mo><mrow id="S3.Ex1.m2.5.5.1.1.1.1.1" xref="S3.Ex1.m2.5.5.1.1.1.1.1.cmml"><mrow id="S3.Ex1.m2.5.5.1.1.1.1.1.3" xref="S3.Ex1.m2.5.5.1.1.1.1.1.3.cmml"><mi id="S3.Ex1.m2.5.5.1.1.1.1.1.3.1" xref="S3.Ex1.m2.5.5.1.1.1.1.1.3.1.cmml">log</mi><mo id="S3.Ex1.m2.5.5.1.1.1.1.1.3a" lspace="0.167em" xref="S3.Ex1.m2.5.5.1.1.1.1.1.3.cmml">⁡</mo><msub id="S3.Ex1.m2.5.5.1.1.1.1.1.3.2" xref="S3.Ex1.m2.5.5.1.1.1.1.1.3.2.cmml"><mi id="S3.Ex1.m2.5.5.1.1.1.1.1.3.2.2" xref="S3.Ex1.m2.5.5.1.1.1.1.1.3.2.2.cmml">q</mi><mi id="S3.Ex1.m2.5.5.1.1.1.1.1.3.2.3" xref="S3.Ex1.m2.5.5.1.1.1.1.1.3.2.3.cmml">θ</mi></msub></mrow><mo id="S3.Ex1.m2.5.5.1.1.1.1.1.2" xref="S3.Ex1.m2.5.5.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex1.m2.5.5.1.1.1.1.1.1.1" xref="S3.Ex1.m2.5.5.1.1.1.1.1.1.1.1.cmml"><mo id="S3.Ex1.m2.5.5.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.Ex1.m2.5.5.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex1.m2.5.5.1.1.1.1.1.1.1.1" xref="S3.Ex1.m2.5.5.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex1.m2.5.5.1.1.1.1.1.1.1.1.2" xref="S3.Ex1.m2.5.5.1.1.1.1.1.1.1.1.2.cmml">b</mi><mo fence="false" id="S3.Ex1.m2.5.5.1.1.1.1.1.1.1.1.1" xref="S3.Ex1.m2.5.5.1.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.Ex1.m2.5.5.1.1.1.1.1.1.1.1.3" xref="S3.Ex1.m2.5.5.1.1.1.1.1.1.1.1.3.cmml">a</mi></mrow><mo id="S3.Ex1.m2.5.5.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.Ex1.m2.5.5.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex1.m2.5.5.1.1.1.1.3" xref="S3.Ex1.m2.5.5.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S3.Ex1.m2.6.6.2.3" xref="S3.Ex1.m2.6.6.2.3.cmml">−</mo><mrow id="S3.Ex1.m2.6.6.2.2" xref="S3.Ex1.m2.6.6.2.2.cmml"><msub id="S3.Ex1.m2.6.6.2.2.3" xref="S3.Ex1.m2.6.6.2.2.3.cmml"><mi id="S3.Ex1.m2.6.6.2.2.3.2" xref="S3.Ex1.m2.6.6.2.2.3.2.cmml">𝔼</mi><mi id="S3.Ex1.m2.6.6.2.2.3.3" xref="S3.Ex1.m2.6.6.2.2.3.3.cmml">p</mi></msub><mo id="S3.Ex1.m2.6.6.2.2.2" xref="S3.Ex1.m2.6.6.2.2.2.cmml">⁢</mo><mrow id="S3.Ex1.m2.6.6.2.2.4.2" xref="S3.Ex1.m2.6.6.2.2.cmml"><mo id="S3.Ex1.m2.6.6.2.2.4.2.1" stretchy="false" xref="S3.Ex1.m2.6.6.2.2.cmml">(</mo><mi id="S3.Ex1.m2.3.3" xref="S3.Ex1.m2.3.3.cmml">a</mi><mo id="S3.Ex1.m2.6.6.2.2.4.2.2" stretchy="false" xref="S3.Ex1.m2.6.6.2.2.cmml">)</mo></mrow><mo id="S3.Ex1.m2.6.6.2.2.2a" xref="S3.Ex1.m2.6.6.2.2.2.cmml">⁢</mo><msub id="S3.Ex1.m2.6.6.2.2.5" xref="S3.Ex1.m2.6.6.2.2.5.cmml"><mi id="S3.Ex1.m2.6.6.2.2.5.2" xref="S3.Ex1.m2.6.6.2.2.5.2.cmml">𝔼</mi><mi id="S3.Ex1.m2.6.6.2.2.5.3" xref="S3.Ex1.m2.6.6.2.2.5.3.cmml">p</mi></msub><mo id="S3.Ex1.m2.6.6.2.2.2b" xref="S3.Ex1.m2.6.6.2.2.2.cmml">⁢</mo><mrow id="S3.Ex1.m2.6.6.2.2.6.2" xref="S3.Ex1.m2.6.6.2.2.cmml"><mo id="S3.Ex1.m2.6.6.2.2.6.2.1" stretchy="false" xref="S3.Ex1.m2.6.6.2.2.cmml">(</mo><mi id="S3.Ex1.m2.4.4" xref="S3.Ex1.m2.4.4.cmml">b</mi><mo id="S3.Ex1.m2.6.6.2.2.6.2.2" stretchy="false" xref="S3.Ex1.m2.6.6.2.2.cmml">)</mo></mrow><mo id="S3.Ex1.m2.6.6.2.2.2c" xref="S3.Ex1.m2.6.6.2.2.2.cmml">⁢</mo><mrow id="S3.Ex1.m2.6.6.2.2.1.1" xref="S3.Ex1.m2.6.6.2.2.1.2.cmml"><mo id="S3.Ex1.m2.6.6.2.2.1.1.2" xref="S3.Ex1.m2.6.6.2.2.1.2.1.cmml">[</mo><mrow id="S3.Ex1.m2.6.6.2.2.1.1.1" xref="S3.Ex1.m2.6.6.2.2.1.1.1.cmml"><mrow id="S3.Ex1.m2.6.6.2.2.1.1.1.3" xref="S3.Ex1.m2.6.6.2.2.1.1.1.3.cmml"><mi id="S3.Ex1.m2.6.6.2.2.1.1.1.3.1" xref="S3.Ex1.m2.6.6.2.2.1.1.1.3.1.cmml">log</mi><mo id="S3.Ex1.m2.6.6.2.2.1.1.1.3a" lspace="0.167em" xref="S3.Ex1.m2.6.6.2.2.1.1.1.3.cmml">⁡</mo><msub id="S3.Ex1.m2.6.6.2.2.1.1.1.3.2" xref="S3.Ex1.m2.6.6.2.2.1.1.1.3.2.cmml"><mi id="S3.Ex1.m2.6.6.2.2.1.1.1.3.2.2" xref="S3.Ex1.m2.6.6.2.2.1.1.1.3.2.2.cmml">q</mi><mi id="S3.Ex1.m2.6.6.2.2.1.1.1.3.2.3" xref="S3.Ex1.m2.6.6.2.2.1.1.1.3.2.3.cmml">θ</mi></msub></mrow><mo id="S3.Ex1.m2.6.6.2.2.1.1.1.2" xref="S3.Ex1.m2.6.6.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex1.m2.6.6.2.2.1.1.1.1.1" xref="S3.Ex1.m2.6.6.2.2.1.1.1.1.1.1.cmml"><mo id="S3.Ex1.m2.6.6.2.2.1.1.1.1.1.2" stretchy="false" xref="S3.Ex1.m2.6.6.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex1.m2.6.6.2.2.1.1.1.1.1.1" xref="S3.Ex1.m2.6.6.2.2.1.1.1.1.1.1.cmml"><mi id="S3.Ex1.m2.6.6.2.2.1.1.1.1.1.1.2" xref="S3.Ex1.m2.6.6.2.2.1.1.1.1.1.1.2.cmml">b</mi><mo fence="false" id="S3.Ex1.m2.6.6.2.2.1.1.1.1.1.1.1" xref="S3.Ex1.m2.6.6.2.2.1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.Ex1.m2.6.6.2.2.1.1.1.1.1.1.3" xref="S3.Ex1.m2.6.6.2.2.1.1.1.1.1.1.3.cmml">a</mi></mrow><mo id="S3.Ex1.m2.6.6.2.2.1.1.1.1.1.3" stretchy="false" xref="S3.Ex1.m2.6.6.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex1.m2.6.6.2.2.1.1.3" xref="S3.Ex1.m2.6.6.2.2.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m2.6b"><apply id="S3.Ex1.m2.6.6.cmml" xref="S3.Ex1.m2.6.6"><eq id="S3.Ex1.m2.6.6.3.cmml" xref="S3.Ex1.m2.6.6.3"></eq><csymbol cd="latexml" id="S3.Ex1.m2.6.6.4.cmml" xref="S3.Ex1.m2.6.6.4">absent</csymbol><apply id="S3.Ex1.m2.6.6.2.cmml" xref="S3.Ex1.m2.6.6.2"><minus id="S3.Ex1.m2.6.6.2.3.cmml" xref="S3.Ex1.m2.6.6.2.3"></minus><apply id="S3.Ex1.m2.5.5.1.1.cmml" xref="S3.Ex1.m2.5.5.1.1"><times id="S3.Ex1.m2.5.5.1.1.2.cmml" xref="S3.Ex1.m2.5.5.1.1.2"></times><apply id="S3.Ex1.m2.5.5.1.1.3.cmml" xref="S3.Ex1.m2.5.5.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1.m2.5.5.1.1.3.1.cmml" xref="S3.Ex1.m2.5.5.1.1.3">subscript</csymbol><ci id="S3.Ex1.m2.5.5.1.1.3.2.cmml" xref="S3.Ex1.m2.5.5.1.1.3.2">𝔼</ci><ci id="S3.Ex1.m2.5.5.1.1.3.3.cmml" xref="S3.Ex1.m2.5.5.1.1.3.3">𝑝</ci></apply><interval closure="open" id="S3.Ex1.m2.5.5.1.1.4.1.cmml" xref="S3.Ex1.m2.5.5.1.1.4.2"><ci id="S3.Ex1.m2.1.1.cmml" xref="S3.Ex1.m2.1.1">𝑎</ci><ci id="S3.Ex1.m2.2.2.cmml" xref="S3.Ex1.m2.2.2">𝑏</ci></interval><apply id="S3.Ex1.m2.5.5.1.1.1.2.cmml" xref="S3.Ex1.m2.5.5.1.1.1.1"><csymbol cd="latexml" id="S3.Ex1.m2.5.5.1.1.1.2.1.cmml" xref="S3.Ex1.m2.5.5.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.Ex1.m2.5.5.1.1.1.1.1.cmml" xref="S3.Ex1.m2.5.5.1.1.1.1.1"><times id="S3.Ex1.m2.5.5.1.1.1.1.1.2.cmml" xref="S3.Ex1.m2.5.5.1.1.1.1.1.2"></times><apply id="S3.Ex1.m2.5.5.1.1.1.1.1.3.cmml" xref="S3.Ex1.m2.5.5.1.1.1.1.1.3"><log id="S3.Ex1.m2.5.5.1.1.1.1.1.3.1.cmml" xref="S3.Ex1.m2.5.5.1.1.1.1.1.3.1"></log><apply id="S3.Ex1.m2.5.5.1.1.1.1.1.3.2.cmml" xref="S3.Ex1.m2.5.5.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.Ex1.m2.5.5.1.1.1.1.1.3.2.1.cmml" xref="S3.Ex1.m2.5.5.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.Ex1.m2.5.5.1.1.1.1.1.3.2.2.cmml" xref="S3.Ex1.m2.5.5.1.1.1.1.1.3.2.2">𝑞</ci><ci id="S3.Ex1.m2.5.5.1.1.1.1.1.3.2.3.cmml" xref="S3.Ex1.m2.5.5.1.1.1.1.1.3.2.3">𝜃</ci></apply></apply><apply id="S3.Ex1.m2.5.5.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m2.5.5.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.Ex1.m2.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m2.5.5.1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.Ex1.m2.5.5.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m2.5.5.1.1.1.1.1.1.1.1.2">𝑏</ci><ci id="S3.Ex1.m2.5.5.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex1.m2.5.5.1.1.1.1.1.1.1.1.3">𝑎</ci></apply></apply></apply></apply><apply id="S3.Ex1.m2.6.6.2.2.cmml" xref="S3.Ex1.m2.6.6.2.2"><times id="S3.Ex1.m2.6.6.2.2.2.cmml" xref="S3.Ex1.m2.6.6.2.2.2"></times><apply id="S3.Ex1.m2.6.6.2.2.3.cmml" xref="S3.Ex1.m2.6.6.2.2.3"><csymbol cd="ambiguous" id="S3.Ex1.m2.6.6.2.2.3.1.cmml" xref="S3.Ex1.m2.6.6.2.2.3">subscript</csymbol><ci id="S3.Ex1.m2.6.6.2.2.3.2.cmml" xref="S3.Ex1.m2.6.6.2.2.3.2">𝔼</ci><ci id="S3.Ex1.m2.6.6.2.2.3.3.cmml" xref="S3.Ex1.m2.6.6.2.2.3.3">𝑝</ci></apply><ci id="S3.Ex1.m2.3.3.cmml" xref="S3.Ex1.m2.3.3">𝑎</ci><apply id="S3.Ex1.m2.6.6.2.2.5.cmml" xref="S3.Ex1.m2.6.6.2.2.5"><csymbol cd="ambiguous" id="S3.Ex1.m2.6.6.2.2.5.1.cmml" xref="S3.Ex1.m2.6.6.2.2.5">subscript</csymbol><ci id="S3.Ex1.m2.6.6.2.2.5.2.cmml" xref="S3.Ex1.m2.6.6.2.2.5.2">𝔼</ci><ci id="S3.Ex1.m2.6.6.2.2.5.3.cmml" xref="S3.Ex1.m2.6.6.2.2.5.3">𝑝</ci></apply><ci id="S3.Ex1.m2.4.4.cmml" xref="S3.Ex1.m2.4.4">𝑏</ci><apply id="S3.Ex1.m2.6.6.2.2.1.2.cmml" xref="S3.Ex1.m2.6.6.2.2.1.1"><csymbol cd="latexml" id="S3.Ex1.m2.6.6.2.2.1.2.1.cmml" xref="S3.Ex1.m2.6.6.2.2.1.1.2">delimited-[]</csymbol><apply id="S3.Ex1.m2.6.6.2.2.1.1.1.cmml" xref="S3.Ex1.m2.6.6.2.2.1.1.1"><times id="S3.Ex1.m2.6.6.2.2.1.1.1.2.cmml" xref="S3.Ex1.m2.6.6.2.2.1.1.1.2"></times><apply id="S3.Ex1.m2.6.6.2.2.1.1.1.3.cmml" xref="S3.Ex1.m2.6.6.2.2.1.1.1.3"><log id="S3.Ex1.m2.6.6.2.2.1.1.1.3.1.cmml" xref="S3.Ex1.m2.6.6.2.2.1.1.1.3.1"></log><apply id="S3.Ex1.m2.6.6.2.2.1.1.1.3.2.cmml" xref="S3.Ex1.m2.6.6.2.2.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.Ex1.m2.6.6.2.2.1.1.1.3.2.1.cmml" xref="S3.Ex1.m2.6.6.2.2.1.1.1.3.2">subscript</csymbol><ci id="S3.Ex1.m2.6.6.2.2.1.1.1.3.2.2.cmml" xref="S3.Ex1.m2.6.6.2.2.1.1.1.3.2.2">𝑞</ci><ci id="S3.Ex1.m2.6.6.2.2.1.1.1.3.2.3.cmml" xref="S3.Ex1.m2.6.6.2.2.1.1.1.3.2.3">𝜃</ci></apply></apply><apply id="S3.Ex1.m2.6.6.2.2.1.1.1.1.1.1.cmml" xref="S3.Ex1.m2.6.6.2.2.1.1.1.1.1"><csymbol cd="latexml" id="S3.Ex1.m2.6.6.2.2.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m2.6.6.2.2.1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.Ex1.m2.6.6.2.2.1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m2.6.6.2.2.1.1.1.1.1.1.2">𝑏</ci><ci id="S3.Ex1.m2.6.6.2.2.1.1.1.1.1.1.3.cmml" xref="S3.Ex1.m2.6.6.2.2.1.1.1.1.1.1.3">𝑎</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m2.6c">\displaystyle=\mathbb{E}_{p}(a,b)\left[\log q_{\theta}(b|a)\right]-\mathbb{E}_%
{p}(a)\mathbb{E}_{p}(b)\left[\log q_{\theta}(b|a)\right]</annotation><annotation encoding="application/x-llamapun" id="S3.Ex1.m2.6d">= blackboard_E start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_a , italic_b ) [ roman_log italic_q start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_b | italic_a ) ] - blackboard_E start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_a ) blackboard_E start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ( italic_b ) [ roman_log italic_q start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_b | italic_a ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(1)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{1}{N^{2}}\sum_{i=1}^{N}\sum_{j=1}^{N}\left[\log q_{\theta}%
(b_{i}|a_{i})-\log q_{\theta}(b_{j}|a_{i})\right]" class="ltx_Math" display="inline" id="S3.E1.m1.1"><semantics id="S3.E1.m1.1a"><mrow id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml"><mi id="S3.E1.m1.1.1.3" xref="S3.E1.m1.1.1.3.cmml"></mi><mo id="S3.E1.m1.1.1.2" xref="S3.E1.m1.1.1.2.cmml">=</mo><mrow id="S3.E1.m1.1.1.1" xref="S3.E1.m1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E1.m1.1.1.1.3" xref="S3.E1.m1.1.1.1.3.cmml"><mfrac id="S3.E1.m1.1.1.1.3a" xref="S3.E1.m1.1.1.1.3.cmml"><mn id="S3.E1.m1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.3.2.cmml">1</mn><msup id="S3.E1.m1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.3.3.cmml"><mi id="S3.E1.m1.1.1.1.3.3.2" xref="S3.E1.m1.1.1.1.3.3.2.cmml">N</mi><mn id="S3.E1.m1.1.1.1.3.3.3" xref="S3.E1.m1.1.1.1.3.3.3.cmml">2</mn></msup></mfrac></mstyle><mo id="S3.E1.m1.1.1.1.2" xref="S3.E1.m1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E1.m1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.2.cmml"><munderover id="S3.E1.m1.1.1.1.1.2a" xref="S3.E1.m1.1.1.1.1.2.cmml"><mo id="S3.E1.m1.1.1.1.1.2.2.2" movablelimits="false" xref="S3.E1.m1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E1.m1.1.1.1.1.2.2.3" xref="S3.E1.m1.1.1.1.1.2.2.3.cmml"><mi id="S3.E1.m1.1.1.1.1.2.2.3.2" xref="S3.E1.m1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.E1.m1.1.1.1.1.2.2.3.1" xref="S3.E1.m1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E1.m1.1.1.1.1.2.2.3.3" xref="S3.E1.m1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E1.m1.1.1.1.1.2.3" xref="S3.E1.m1.1.1.1.1.2.3.cmml">N</mi></munderover></mstyle><mrow id="S3.E1.m1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E1.m1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.2.cmml"><munderover id="S3.E1.m1.1.1.1.1.1.2a" xref="S3.E1.m1.1.1.1.1.1.2.cmml"><mo id="S3.E1.m1.1.1.1.1.1.2.2.2" movablelimits="false" xref="S3.E1.m1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E1.m1.1.1.1.1.1.2.2.3" xref="S3.E1.m1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.2.2.3.2" xref="S3.E1.m1.1.1.1.1.1.2.2.3.2.cmml">j</mi><mo id="S3.E1.m1.1.1.1.1.1.2.2.3.1" xref="S3.E1.m1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E1.m1.1.1.1.1.1.2.2.3.3" xref="S3.E1.m1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E1.m1.1.1.1.1.1.2.3" xref="S3.E1.m1.1.1.1.1.1.2.3.cmml">N</mi></munderover></mstyle><mrow id="S3.E1.m1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.2.cmml"><mo id="S3.E1.m1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.1.cmml">log</mi><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3a" lspace="0.167em" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.cmml">⁡</mo><msub id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">q</mi><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.2.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">θ</mi></msub></mrow><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">b</mi><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo fence="false" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">a</mi><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.cmml">−</mo><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.cmml"><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1.2.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.2.3.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.3.1.cmml">log</mi><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.2.3a" lspace="0.167em" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.3.cmml">⁡</mo><msub id="S3.E1.m1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.3.2.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.2.3.2.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.3.2.2.cmml">q</mi><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.2.3.2.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.3.2.3.cmml">θ</mi></msub></mrow><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.2.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.cmml">⁢</mo><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1.2.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.1.1.1.cmml"><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.2.1.1.2" stretchy="false" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1.2.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.1.1.1.cmml"><msub id="S3.E1.m1.1.1.1.1.1.1.1.1.2.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.1.1.1.2.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.2.1.1.1.2.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.1.1.1.2.2.cmml">b</mi><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.2.1.1.1.2.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.1.1.1.2.3.cmml">j</mi></msub><mo fence="false" id="S3.E1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.cmml">|</mo><msub id="S3.E1.m1.1.1.1.1.1.1.1.1.2.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.1.1.1.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.2.1.1.1.3.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.1.1.1.3.2.cmml">a</mi><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.2.1.1.1.3.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.2.1.1.3" stretchy="false" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E1.m1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.1b"><apply id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1"><eq id="S3.E1.m1.1.1.2.cmml" xref="S3.E1.m1.1.1.2"></eq><csymbol cd="latexml" id="S3.E1.m1.1.1.3.cmml" xref="S3.E1.m1.1.1.3">absent</csymbol><apply id="S3.E1.m1.1.1.1.cmml" xref="S3.E1.m1.1.1.1"><times id="S3.E1.m1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.2"></times><apply id="S3.E1.m1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.3"><divide id="S3.E1.m1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.3"></divide><cn id="S3.E1.m1.1.1.1.3.2.cmml" type="integer" xref="S3.E1.m1.1.1.1.3.2">1</cn><apply id="S3.E1.m1.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.3.3.1.cmml" xref="S3.E1.m1.1.1.1.3.3">superscript</csymbol><ci id="S3.E1.m1.1.1.1.3.3.2.cmml" xref="S3.E1.m1.1.1.1.3.3.2">𝑁</ci><cn id="S3.E1.m1.1.1.1.3.3.3.cmml" type="integer" xref="S3.E1.m1.1.1.1.3.3.3">2</cn></apply></apply><apply id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1"><apply id="S3.E1.m1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.2">superscript</csymbol><apply id="S3.E1.m1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.2.2.1.cmml" xref="S3.E1.m1.1.1.1.1.2">subscript</csymbol><sum id="S3.E1.m1.1.1.1.1.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2"></sum><apply id="S3.E1.m1.1.1.1.1.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.3"><eq id="S3.E1.m1.1.1.1.1.2.2.3.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.3.1"></eq><ci id="S3.E1.m1.1.1.1.1.2.2.3.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.3.2">𝑖</ci><cn id="S3.E1.m1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.E1.m1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E1.m1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.1.1.1.1.2.3">𝑁</ci></apply><apply id="S3.E1.m1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1"><apply id="S3.E1.m1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E1.m1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.2.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.2">subscript</csymbol><sum id="S3.E1.m1.1.1.1.1.1.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.2.2.2"></sum><apply id="S3.E1.m1.1.1.1.1.1.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.2.2.3"><eq id="S3.E1.m1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.2.2.3.1"></eq><ci id="S3.E1.m1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.2.2.3.2">𝑗</ci><cn id="S3.E1.m1.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.E1.m1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E1.m1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.2.3">𝑁</ci></apply><apply id="S3.E1.m1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1"><minus id="S3.E1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3"></minus><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1"><times id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3"><log id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.1"></log><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.2.2">𝑞</ci><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.2.3">𝜃</ci></apply></apply><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑏</ci><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑎</ci><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2"><times id="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.2"></times><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.3"><log id="S3.E1.m1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.3.1"></log><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.3.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.2.3.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.3.2">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.2.3.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.3.2.2">𝑞</ci><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.2.3.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.3.2.3">𝜃</ci></apply></apply><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.1.1"><csymbol cd="latexml" id="S3.E1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.1.1.1.1">conditional</csymbol><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.2.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.1.1.1.2">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.2.1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.1.1.1.2.2">𝑏</ci><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.2.1.1.1.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.1.1.1.2.3">𝑗</ci></apply><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.2.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.2.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.1.1.1.3.2">𝑎</ci><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.2.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.1c">\displaystyle=\frac{1}{N^{2}}\sum_{i=1}^{N}\sum_{j=1}^{N}\left[\log q_{\theta}%
(b_{i}|a_{i})-\log q_{\theta}(b_{j}|a_{i})\right]</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.1d">= divide start_ARG 1 end_ARG start_ARG italic_N start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT [ roman_log italic_q start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_b start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) - roman_log italic_q start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_b start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT | italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.4">We employ an MLP <math alttext="q_{\theta}(b|a)" class="ltx_Math" display="inline" id="S3.SS3.p2.1.m1.1"><semantics id="S3.SS3.p2.1.m1.1a"><mrow id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml"><msub id="S3.SS3.p2.1.m1.1.1.3" xref="S3.SS3.p2.1.m1.1.1.3.cmml"><mi id="S3.SS3.p2.1.m1.1.1.3.2" xref="S3.SS3.p2.1.m1.1.1.3.2.cmml">q</mi><mi id="S3.SS3.p2.1.m1.1.1.3.3" xref="S3.SS3.p2.1.m1.1.1.3.3.cmml">θ</mi></msub><mo id="S3.SS3.p2.1.m1.1.1.2" xref="S3.SS3.p2.1.m1.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.p2.1.m1.1.1.1.1" xref="S3.SS3.p2.1.m1.1.1.1.1.1.cmml"><mo id="S3.SS3.p2.1.m1.1.1.1.1.2" stretchy="false" xref="S3.SS3.p2.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.p2.1.m1.1.1.1.1.1" xref="S3.SS3.p2.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS3.p2.1.m1.1.1.1.1.1.2" xref="S3.SS3.p2.1.m1.1.1.1.1.1.2.cmml">b</mi><mo fence="false" id="S3.SS3.p2.1.m1.1.1.1.1.1.1" xref="S3.SS3.p2.1.m1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.SS3.p2.1.m1.1.1.1.1.1.3" xref="S3.SS3.p2.1.m1.1.1.1.1.1.3.cmml">a</mi></mrow><mo id="S3.SS3.p2.1.m1.1.1.1.1.3" stretchy="false" xref="S3.SS3.p2.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><apply id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1"><times id="S3.SS3.p2.1.m1.1.1.2.cmml" xref="S3.SS3.p2.1.m1.1.1.2"></times><apply id="S3.SS3.p2.1.m1.1.1.3.cmml" xref="S3.SS3.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.1.1.3.1.cmml" xref="S3.SS3.p2.1.m1.1.1.3">subscript</csymbol><ci id="S3.SS3.p2.1.m1.1.1.3.2.cmml" xref="S3.SS3.p2.1.m1.1.1.3.2">𝑞</ci><ci id="S3.SS3.p2.1.m1.1.1.3.3.cmml" xref="S3.SS3.p2.1.m1.1.1.3.3">𝜃</ci></apply><apply id="S3.SS3.p2.1.m1.1.1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1.1.1"><csymbol cd="latexml" id="S3.SS3.p2.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS3.p2.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS3.p2.1.m1.1.1.1.1.1.2">𝑏</ci><ci id="S3.SS3.p2.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS3.p2.1.m1.1.1.1.1.1.3">𝑎</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">q_{\theta}(b|a)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.1.m1.1d">italic_q start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_b | italic_a )</annotation></semantics></math> to provide a variational approximation of <math alttext="q_{\theta}(b|a)" class="ltx_Math" display="inline" id="S3.SS3.p2.2.m2.1"><semantics id="S3.SS3.p2.2.m2.1a"><mrow id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml"><msub id="S3.SS3.p2.2.m2.1.1.3" xref="S3.SS3.p2.2.m2.1.1.3.cmml"><mi id="S3.SS3.p2.2.m2.1.1.3.2" xref="S3.SS3.p2.2.m2.1.1.3.2.cmml">q</mi><mi id="S3.SS3.p2.2.m2.1.1.3.3" xref="S3.SS3.p2.2.m2.1.1.3.3.cmml">θ</mi></msub><mo id="S3.SS3.p2.2.m2.1.1.2" xref="S3.SS3.p2.2.m2.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.p2.2.m2.1.1.1.1" xref="S3.SS3.p2.2.m2.1.1.1.1.1.cmml"><mo id="S3.SS3.p2.2.m2.1.1.1.1.2" stretchy="false" xref="S3.SS3.p2.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.p2.2.m2.1.1.1.1.1" xref="S3.SS3.p2.2.m2.1.1.1.1.1.cmml"><mi id="S3.SS3.p2.2.m2.1.1.1.1.1.2" xref="S3.SS3.p2.2.m2.1.1.1.1.1.2.cmml">b</mi><mo fence="false" id="S3.SS3.p2.2.m2.1.1.1.1.1.1" xref="S3.SS3.p2.2.m2.1.1.1.1.1.1.cmml">|</mo><mi id="S3.SS3.p2.2.m2.1.1.1.1.1.3" xref="S3.SS3.p2.2.m2.1.1.1.1.1.3.cmml">a</mi></mrow><mo id="S3.SS3.p2.2.m2.1.1.1.1.3" stretchy="false" xref="S3.SS3.p2.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><apply id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1"><times id="S3.SS3.p2.2.m2.1.1.2.cmml" xref="S3.SS3.p2.2.m2.1.1.2"></times><apply id="S3.SS3.p2.2.m2.1.1.3.cmml" xref="S3.SS3.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.1.1.3.1.cmml" xref="S3.SS3.p2.2.m2.1.1.3">subscript</csymbol><ci id="S3.SS3.p2.2.m2.1.1.3.2.cmml" xref="S3.SS3.p2.2.m2.1.1.3.2">𝑞</ci><ci id="S3.SS3.p2.2.m2.1.1.3.3.cmml" xref="S3.SS3.p2.2.m2.1.1.3.3">𝜃</ci></apply><apply id="S3.SS3.p2.2.m2.1.1.1.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1.1.1"><csymbol cd="latexml" id="S3.SS3.p2.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS3.p2.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS3.p2.2.m2.1.1.1.1.1.2">𝑏</ci><ci id="S3.SS3.p2.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS3.p2.2.m2.1.1.1.1.1.3">𝑎</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">q_{\theta}(b|a)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.2.m2.1d">italic_q start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_b | italic_a )</annotation></semantics></math>, which can be optimized by maximizing the log-likelihood <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.12309v1#bib.bib35" title="">2024</a>)</cite>:
<math alttext="L_{\text{estimator}}(a,b)=\frac{1}{N}\sum_{i=1}^{N}\log q_{\theta}(b_{i}|a_{i})" class="ltx_Math" display="inline" id="S3.SS3.p2.3.m3.3"><semantics id="S3.SS3.p2.3.m3.3a"><mrow id="S3.SS3.p2.3.m3.3.3" xref="S3.SS3.p2.3.m3.3.3.cmml"><mrow id="S3.SS3.p2.3.m3.3.3.3" xref="S3.SS3.p2.3.m3.3.3.3.cmml"><msub id="S3.SS3.p2.3.m3.3.3.3.2" xref="S3.SS3.p2.3.m3.3.3.3.2.cmml"><mi id="S3.SS3.p2.3.m3.3.3.3.2.2" xref="S3.SS3.p2.3.m3.3.3.3.2.2.cmml">L</mi><mtext id="S3.SS3.p2.3.m3.3.3.3.2.3" xref="S3.SS3.p2.3.m3.3.3.3.2.3a.cmml">estimator</mtext></msub><mo id="S3.SS3.p2.3.m3.3.3.3.1" xref="S3.SS3.p2.3.m3.3.3.3.1.cmml">⁢</mo><mrow id="S3.SS3.p2.3.m3.3.3.3.3.2" xref="S3.SS3.p2.3.m3.3.3.3.3.1.cmml"><mo id="S3.SS3.p2.3.m3.3.3.3.3.2.1" stretchy="false" xref="S3.SS3.p2.3.m3.3.3.3.3.1.cmml">(</mo><mi id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml">a</mi><mo id="S3.SS3.p2.3.m3.3.3.3.3.2.2" xref="S3.SS3.p2.3.m3.3.3.3.3.1.cmml">,</mo><mi id="S3.SS3.p2.3.m3.2.2" xref="S3.SS3.p2.3.m3.2.2.cmml">b</mi><mo id="S3.SS3.p2.3.m3.3.3.3.3.2.3" stretchy="false" xref="S3.SS3.p2.3.m3.3.3.3.3.1.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p2.3.m3.3.3.2" xref="S3.SS3.p2.3.m3.3.3.2.cmml">=</mo><mrow id="S3.SS3.p2.3.m3.3.3.1" xref="S3.SS3.p2.3.m3.3.3.1.cmml"><mfrac id="S3.SS3.p2.3.m3.3.3.1.3" xref="S3.SS3.p2.3.m3.3.3.1.3.cmml"><mn id="S3.SS3.p2.3.m3.3.3.1.3.2" xref="S3.SS3.p2.3.m3.3.3.1.3.2.cmml">1</mn><mi id="S3.SS3.p2.3.m3.3.3.1.3.3" xref="S3.SS3.p2.3.m3.3.3.1.3.3.cmml">N</mi></mfrac><mo id="S3.SS3.p2.3.m3.3.3.1.2" xref="S3.SS3.p2.3.m3.3.3.1.2.cmml">⁢</mo><mrow id="S3.SS3.p2.3.m3.3.3.1.1" xref="S3.SS3.p2.3.m3.3.3.1.1.cmml"><msubsup id="S3.SS3.p2.3.m3.3.3.1.1.2" xref="S3.SS3.p2.3.m3.3.3.1.1.2.cmml"><mo id="S3.SS3.p2.3.m3.3.3.1.1.2.2.2" xref="S3.SS3.p2.3.m3.3.3.1.1.2.2.2.cmml">∑</mo><mrow id="S3.SS3.p2.3.m3.3.3.1.1.2.2.3" xref="S3.SS3.p2.3.m3.3.3.1.1.2.2.3.cmml"><mi id="S3.SS3.p2.3.m3.3.3.1.1.2.2.3.2" xref="S3.SS3.p2.3.m3.3.3.1.1.2.2.3.2.cmml">i</mi><mo id="S3.SS3.p2.3.m3.3.3.1.1.2.2.3.1" xref="S3.SS3.p2.3.m3.3.3.1.1.2.2.3.1.cmml">=</mo><mn id="S3.SS3.p2.3.m3.3.3.1.1.2.2.3.3" xref="S3.SS3.p2.3.m3.3.3.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.SS3.p2.3.m3.3.3.1.1.2.3" xref="S3.SS3.p2.3.m3.3.3.1.1.2.3.cmml">N</mi></msubsup><mrow id="S3.SS3.p2.3.m3.3.3.1.1.1" xref="S3.SS3.p2.3.m3.3.3.1.1.1.cmml"><mrow id="S3.SS3.p2.3.m3.3.3.1.1.1.3" xref="S3.SS3.p2.3.m3.3.3.1.1.1.3.cmml"><mi id="S3.SS3.p2.3.m3.3.3.1.1.1.3.1" xref="S3.SS3.p2.3.m3.3.3.1.1.1.3.1.cmml">log</mi><mo id="S3.SS3.p2.3.m3.3.3.1.1.1.3a" lspace="0.167em" xref="S3.SS3.p2.3.m3.3.3.1.1.1.3.cmml">⁡</mo><msub id="S3.SS3.p2.3.m3.3.3.1.1.1.3.2" xref="S3.SS3.p2.3.m3.3.3.1.1.1.3.2.cmml"><mi id="S3.SS3.p2.3.m3.3.3.1.1.1.3.2.2" xref="S3.SS3.p2.3.m3.3.3.1.1.1.3.2.2.cmml">q</mi><mi id="S3.SS3.p2.3.m3.3.3.1.1.1.3.2.3" xref="S3.SS3.p2.3.m3.3.3.1.1.1.3.2.3.cmml">θ</mi></msub></mrow><mo id="S3.SS3.p2.3.m3.3.3.1.1.1.2" xref="S3.SS3.p2.3.m3.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.p2.3.m3.3.3.1.1.1.1.1" xref="S3.SS3.p2.3.m3.3.3.1.1.1.1.1.1.cmml"><mo id="S3.SS3.p2.3.m3.3.3.1.1.1.1.1.2" stretchy="false" xref="S3.SS3.p2.3.m3.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.p2.3.m3.3.3.1.1.1.1.1.1" xref="S3.SS3.p2.3.m3.3.3.1.1.1.1.1.1.cmml"><msub id="S3.SS3.p2.3.m3.3.3.1.1.1.1.1.1.2" xref="S3.SS3.p2.3.m3.3.3.1.1.1.1.1.1.2.cmml"><mi id="S3.SS3.p2.3.m3.3.3.1.1.1.1.1.1.2.2" xref="S3.SS3.p2.3.m3.3.3.1.1.1.1.1.1.2.2.cmml">b</mi><mi id="S3.SS3.p2.3.m3.3.3.1.1.1.1.1.1.2.3" xref="S3.SS3.p2.3.m3.3.3.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo fence="false" id="S3.SS3.p2.3.m3.3.3.1.1.1.1.1.1.1" xref="S3.SS3.p2.3.m3.3.3.1.1.1.1.1.1.1.cmml">|</mo><msub id="S3.SS3.p2.3.m3.3.3.1.1.1.1.1.1.3" xref="S3.SS3.p2.3.m3.3.3.1.1.1.1.1.1.3.cmml"><mi id="S3.SS3.p2.3.m3.3.3.1.1.1.1.1.1.3.2" xref="S3.SS3.p2.3.m3.3.3.1.1.1.1.1.1.3.2.cmml">a</mi><mi id="S3.SS3.p2.3.m3.3.3.1.1.1.1.1.1.3.3" xref="S3.SS3.p2.3.m3.3.3.1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S3.SS3.p2.3.m3.3.3.1.1.1.1.1.3" stretchy="false" xref="S3.SS3.p2.3.m3.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.3b"><apply id="S3.SS3.p2.3.m3.3.3.cmml" xref="S3.SS3.p2.3.m3.3.3"><eq id="S3.SS3.p2.3.m3.3.3.2.cmml" xref="S3.SS3.p2.3.m3.3.3.2"></eq><apply id="S3.SS3.p2.3.m3.3.3.3.cmml" xref="S3.SS3.p2.3.m3.3.3.3"><times id="S3.SS3.p2.3.m3.3.3.3.1.cmml" xref="S3.SS3.p2.3.m3.3.3.3.1"></times><apply id="S3.SS3.p2.3.m3.3.3.3.2.cmml" xref="S3.SS3.p2.3.m3.3.3.3.2"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.3.3.3.2.1.cmml" xref="S3.SS3.p2.3.m3.3.3.3.2">subscript</csymbol><ci id="S3.SS3.p2.3.m3.3.3.3.2.2.cmml" xref="S3.SS3.p2.3.m3.3.3.3.2.2">𝐿</ci><ci id="S3.SS3.p2.3.m3.3.3.3.2.3a.cmml" xref="S3.SS3.p2.3.m3.3.3.3.2.3"><mtext id="S3.SS3.p2.3.m3.3.3.3.2.3.cmml" mathsize="70%" xref="S3.SS3.p2.3.m3.3.3.3.2.3">estimator</mtext></ci></apply><interval closure="open" id="S3.SS3.p2.3.m3.3.3.3.3.1.cmml" xref="S3.SS3.p2.3.m3.3.3.3.3.2"><ci id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1">𝑎</ci><ci id="S3.SS3.p2.3.m3.2.2.cmml" xref="S3.SS3.p2.3.m3.2.2">𝑏</ci></interval></apply><apply id="S3.SS3.p2.3.m3.3.3.1.cmml" xref="S3.SS3.p2.3.m3.3.3.1"><times id="S3.SS3.p2.3.m3.3.3.1.2.cmml" xref="S3.SS3.p2.3.m3.3.3.1.2"></times><apply id="S3.SS3.p2.3.m3.3.3.1.3.cmml" xref="S3.SS3.p2.3.m3.3.3.1.3"><divide id="S3.SS3.p2.3.m3.3.3.1.3.1.cmml" xref="S3.SS3.p2.3.m3.3.3.1.3"></divide><cn id="S3.SS3.p2.3.m3.3.3.1.3.2.cmml" type="integer" xref="S3.SS3.p2.3.m3.3.3.1.3.2">1</cn><ci id="S3.SS3.p2.3.m3.3.3.1.3.3.cmml" xref="S3.SS3.p2.3.m3.3.3.1.3.3">𝑁</ci></apply><apply id="S3.SS3.p2.3.m3.3.3.1.1.cmml" xref="S3.SS3.p2.3.m3.3.3.1.1"><apply id="S3.SS3.p2.3.m3.3.3.1.1.2.cmml" xref="S3.SS3.p2.3.m3.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.3.3.1.1.2.1.cmml" xref="S3.SS3.p2.3.m3.3.3.1.1.2">superscript</csymbol><apply id="S3.SS3.p2.3.m3.3.3.1.1.2.2.cmml" xref="S3.SS3.p2.3.m3.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.3.3.1.1.2.2.1.cmml" xref="S3.SS3.p2.3.m3.3.3.1.1.2">subscript</csymbol><sum id="S3.SS3.p2.3.m3.3.3.1.1.2.2.2.cmml" xref="S3.SS3.p2.3.m3.3.3.1.1.2.2.2"></sum><apply id="S3.SS3.p2.3.m3.3.3.1.1.2.2.3.cmml" xref="S3.SS3.p2.3.m3.3.3.1.1.2.2.3"><eq id="S3.SS3.p2.3.m3.3.3.1.1.2.2.3.1.cmml" xref="S3.SS3.p2.3.m3.3.3.1.1.2.2.3.1"></eq><ci id="S3.SS3.p2.3.m3.3.3.1.1.2.2.3.2.cmml" xref="S3.SS3.p2.3.m3.3.3.1.1.2.2.3.2">𝑖</ci><cn id="S3.SS3.p2.3.m3.3.3.1.1.2.2.3.3.cmml" type="integer" xref="S3.SS3.p2.3.m3.3.3.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.SS3.p2.3.m3.3.3.1.1.2.3.cmml" xref="S3.SS3.p2.3.m3.3.3.1.1.2.3">𝑁</ci></apply><apply id="S3.SS3.p2.3.m3.3.3.1.1.1.cmml" xref="S3.SS3.p2.3.m3.3.3.1.1.1"><times id="S3.SS3.p2.3.m3.3.3.1.1.1.2.cmml" xref="S3.SS3.p2.3.m3.3.3.1.1.1.2"></times><apply id="S3.SS3.p2.3.m3.3.3.1.1.1.3.cmml" xref="S3.SS3.p2.3.m3.3.3.1.1.1.3"><log id="S3.SS3.p2.3.m3.3.3.1.1.1.3.1.cmml" xref="S3.SS3.p2.3.m3.3.3.1.1.1.3.1"></log><apply id="S3.SS3.p2.3.m3.3.3.1.1.1.3.2.cmml" xref="S3.SS3.p2.3.m3.3.3.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.3.3.1.1.1.3.2.1.cmml" xref="S3.SS3.p2.3.m3.3.3.1.1.1.3.2">subscript</csymbol><ci id="S3.SS3.p2.3.m3.3.3.1.1.1.3.2.2.cmml" xref="S3.SS3.p2.3.m3.3.3.1.1.1.3.2.2">𝑞</ci><ci id="S3.SS3.p2.3.m3.3.3.1.1.1.3.2.3.cmml" xref="S3.SS3.p2.3.m3.3.3.1.1.1.3.2.3">𝜃</ci></apply></apply><apply id="S3.SS3.p2.3.m3.3.3.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.3.m3.3.3.1.1.1.1.1"><csymbol cd="latexml" id="S3.SS3.p2.3.m3.3.3.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.3.m3.3.3.1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.SS3.p2.3.m3.3.3.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p2.3.m3.3.3.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.3.3.1.1.1.1.1.1.2.1.cmml" xref="S3.SS3.p2.3.m3.3.3.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS3.p2.3.m3.3.3.1.1.1.1.1.1.2.2.cmml" xref="S3.SS3.p2.3.m3.3.3.1.1.1.1.1.1.2.2">𝑏</ci><ci id="S3.SS3.p2.3.m3.3.3.1.1.1.1.1.1.2.3.cmml" xref="S3.SS3.p2.3.m3.3.3.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.SS3.p2.3.m3.3.3.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p2.3.m3.3.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.3.3.1.1.1.1.1.1.3.1.cmml" xref="S3.SS3.p2.3.m3.3.3.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS3.p2.3.m3.3.3.1.1.1.1.1.1.3.2.cmml" xref="S3.SS3.p2.3.m3.3.3.1.1.1.1.1.1.3.2">𝑎</ci><ci id="S3.SS3.p2.3.m3.3.3.1.1.1.1.1.1.3.3.cmml" xref="S3.SS3.p2.3.m3.3.3.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.3c">L_{\text{estimator}}(a,b)=\frac{1}{N}\sum_{i=1}^{N}\log q_{\theta}(b_{i}|a_{i})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.3.m3.3d">italic_L start_POSTSUBSCRIPT estimator end_POSTSUBSCRIPT ( italic_a , italic_b ) = divide start_ARG 1 end_ARG start_ARG italic_N end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT roman_log italic_q start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_b start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math>. The MI Loss is then calculated as:
<math alttext="\text{MI Loss}=L_{v}^{CLUB}(S_{a}+S_{b})+L_{\text{estimator}}(S_{a}+S_{b},S_{c})" class="ltx_Math" display="inline" id="S3.SS3.p2.4.m4.3"><semantics id="S3.SS3.p2.4.m4.3a"><mrow id="S3.SS3.p2.4.m4.3.3" xref="S3.SS3.p2.4.m4.3.3.cmml"><mtext id="S3.SS3.p2.4.m4.3.3.5" xref="S3.SS3.p2.4.m4.3.3.5a.cmml">MI Loss</mtext><mo id="S3.SS3.p2.4.m4.3.3.4" xref="S3.SS3.p2.4.m4.3.3.4.cmml">=</mo><mrow id="S3.SS3.p2.4.m4.3.3.3" xref="S3.SS3.p2.4.m4.3.3.3.cmml"><mrow id="S3.SS3.p2.4.m4.1.1.1.1" xref="S3.SS3.p2.4.m4.1.1.1.1.cmml"><msubsup id="S3.SS3.p2.4.m4.1.1.1.1.3" xref="S3.SS3.p2.4.m4.1.1.1.1.3.cmml"><mi id="S3.SS3.p2.4.m4.1.1.1.1.3.2.2" xref="S3.SS3.p2.4.m4.1.1.1.1.3.2.2.cmml">L</mi><mi id="S3.SS3.p2.4.m4.1.1.1.1.3.2.3" xref="S3.SS3.p2.4.m4.1.1.1.1.3.2.3.cmml">v</mi><mrow id="S3.SS3.p2.4.m4.1.1.1.1.3.3" xref="S3.SS3.p2.4.m4.1.1.1.1.3.3.cmml"><mi id="S3.SS3.p2.4.m4.1.1.1.1.3.3.2" xref="S3.SS3.p2.4.m4.1.1.1.1.3.3.2.cmml">C</mi><mo id="S3.SS3.p2.4.m4.1.1.1.1.3.3.1" xref="S3.SS3.p2.4.m4.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.SS3.p2.4.m4.1.1.1.1.3.3.3" xref="S3.SS3.p2.4.m4.1.1.1.1.3.3.3.cmml">L</mi><mo id="S3.SS3.p2.4.m4.1.1.1.1.3.3.1a" xref="S3.SS3.p2.4.m4.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.SS3.p2.4.m4.1.1.1.1.3.3.4" xref="S3.SS3.p2.4.m4.1.1.1.1.3.3.4.cmml">U</mi><mo id="S3.SS3.p2.4.m4.1.1.1.1.3.3.1b" xref="S3.SS3.p2.4.m4.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.SS3.p2.4.m4.1.1.1.1.3.3.5" xref="S3.SS3.p2.4.m4.1.1.1.1.3.3.5.cmml">B</mi></mrow></msubsup><mo id="S3.SS3.p2.4.m4.1.1.1.1.2" xref="S3.SS3.p2.4.m4.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.p2.4.m4.1.1.1.1.1.1" xref="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.cmml"><mo id="S3.SS3.p2.4.m4.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.p2.4.m4.1.1.1.1.1.1.1" xref="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.cmml"><msub id="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.2" xref="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.2.cmml"><mi id="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.2.2" xref="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.2.2.cmml">S</mi><mi id="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.2.3" xref="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.2.3.cmml">a</mi></msub><mo id="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.1" xref="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.3" xref="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.3.cmml"><mi id="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.3.2" xref="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.3.2.cmml">S</mi><mi id="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.3.3" xref="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.3.3.cmml">b</mi></msub></mrow><mo id="S3.SS3.p2.4.m4.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p2.4.m4.3.3.3.4" xref="S3.SS3.p2.4.m4.3.3.3.4.cmml">+</mo><mrow id="S3.SS3.p2.4.m4.3.3.3.3" xref="S3.SS3.p2.4.m4.3.3.3.3.cmml"><msub id="S3.SS3.p2.4.m4.3.3.3.3.4" xref="S3.SS3.p2.4.m4.3.3.3.3.4.cmml"><mi id="S3.SS3.p2.4.m4.3.3.3.3.4.2" xref="S3.SS3.p2.4.m4.3.3.3.3.4.2.cmml">L</mi><mtext id="S3.SS3.p2.4.m4.3.3.3.3.4.3" xref="S3.SS3.p2.4.m4.3.3.3.3.4.3a.cmml">estimator</mtext></msub><mo id="S3.SS3.p2.4.m4.3.3.3.3.3" xref="S3.SS3.p2.4.m4.3.3.3.3.3.cmml">⁢</mo><mrow id="S3.SS3.p2.4.m4.3.3.3.3.2.2" xref="S3.SS3.p2.4.m4.3.3.3.3.2.3.cmml"><mo id="S3.SS3.p2.4.m4.3.3.3.3.2.2.3" stretchy="false" xref="S3.SS3.p2.4.m4.3.3.3.3.2.3.cmml">(</mo><mrow id="S3.SS3.p2.4.m4.2.2.2.2.1.1.1" xref="S3.SS3.p2.4.m4.2.2.2.2.1.1.1.cmml"><msub id="S3.SS3.p2.4.m4.2.2.2.2.1.1.1.2" xref="S3.SS3.p2.4.m4.2.2.2.2.1.1.1.2.cmml"><mi id="S3.SS3.p2.4.m4.2.2.2.2.1.1.1.2.2" xref="S3.SS3.p2.4.m4.2.2.2.2.1.1.1.2.2.cmml">S</mi><mi id="S3.SS3.p2.4.m4.2.2.2.2.1.1.1.2.3" xref="S3.SS3.p2.4.m4.2.2.2.2.1.1.1.2.3.cmml">a</mi></msub><mo id="S3.SS3.p2.4.m4.2.2.2.2.1.1.1.1" xref="S3.SS3.p2.4.m4.2.2.2.2.1.1.1.1.cmml">+</mo><msub id="S3.SS3.p2.4.m4.2.2.2.2.1.1.1.3" xref="S3.SS3.p2.4.m4.2.2.2.2.1.1.1.3.cmml"><mi id="S3.SS3.p2.4.m4.2.2.2.2.1.1.1.3.2" xref="S3.SS3.p2.4.m4.2.2.2.2.1.1.1.3.2.cmml">S</mi><mi id="S3.SS3.p2.4.m4.2.2.2.2.1.1.1.3.3" xref="S3.SS3.p2.4.m4.2.2.2.2.1.1.1.3.3.cmml">b</mi></msub></mrow><mo id="S3.SS3.p2.4.m4.3.3.3.3.2.2.4" xref="S3.SS3.p2.4.m4.3.3.3.3.2.3.cmml">,</mo><msub id="S3.SS3.p2.4.m4.3.3.3.3.2.2.2" xref="S3.SS3.p2.4.m4.3.3.3.3.2.2.2.cmml"><mi id="S3.SS3.p2.4.m4.3.3.3.3.2.2.2.2" xref="S3.SS3.p2.4.m4.3.3.3.3.2.2.2.2.cmml">S</mi><mi id="S3.SS3.p2.4.m4.3.3.3.3.2.2.2.3" xref="S3.SS3.p2.4.m4.3.3.3.3.2.2.2.3.cmml">c</mi></msub><mo id="S3.SS3.p2.4.m4.3.3.3.3.2.2.5" stretchy="false" xref="S3.SS3.p2.4.m4.3.3.3.3.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m4.3b"><apply id="S3.SS3.p2.4.m4.3.3.cmml" xref="S3.SS3.p2.4.m4.3.3"><eq id="S3.SS3.p2.4.m4.3.3.4.cmml" xref="S3.SS3.p2.4.m4.3.3.4"></eq><ci id="S3.SS3.p2.4.m4.3.3.5a.cmml" xref="S3.SS3.p2.4.m4.3.3.5"><mtext id="S3.SS3.p2.4.m4.3.3.5.cmml" xref="S3.SS3.p2.4.m4.3.3.5">MI Loss</mtext></ci><apply id="S3.SS3.p2.4.m4.3.3.3.cmml" xref="S3.SS3.p2.4.m4.3.3.3"><plus id="S3.SS3.p2.4.m4.3.3.3.4.cmml" xref="S3.SS3.p2.4.m4.3.3.3.4"></plus><apply id="S3.SS3.p2.4.m4.1.1.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1.1.1"><times id="S3.SS3.p2.4.m4.1.1.1.1.2.cmml" xref="S3.SS3.p2.4.m4.1.1.1.1.2"></times><apply id="S3.SS3.p2.4.m4.1.1.1.1.3.cmml" xref="S3.SS3.p2.4.m4.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m4.1.1.1.1.3.1.cmml" xref="S3.SS3.p2.4.m4.1.1.1.1.3">superscript</csymbol><apply id="S3.SS3.p2.4.m4.1.1.1.1.3.2.cmml" xref="S3.SS3.p2.4.m4.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m4.1.1.1.1.3.2.1.cmml" xref="S3.SS3.p2.4.m4.1.1.1.1.3">subscript</csymbol><ci id="S3.SS3.p2.4.m4.1.1.1.1.3.2.2.cmml" xref="S3.SS3.p2.4.m4.1.1.1.1.3.2.2">𝐿</ci><ci id="S3.SS3.p2.4.m4.1.1.1.1.3.2.3.cmml" xref="S3.SS3.p2.4.m4.1.1.1.1.3.2.3">𝑣</ci></apply><apply id="S3.SS3.p2.4.m4.1.1.1.1.3.3.cmml" xref="S3.SS3.p2.4.m4.1.1.1.1.3.3"><times id="S3.SS3.p2.4.m4.1.1.1.1.3.3.1.cmml" xref="S3.SS3.p2.4.m4.1.1.1.1.3.3.1"></times><ci id="S3.SS3.p2.4.m4.1.1.1.1.3.3.2.cmml" xref="S3.SS3.p2.4.m4.1.1.1.1.3.3.2">𝐶</ci><ci id="S3.SS3.p2.4.m4.1.1.1.1.3.3.3.cmml" xref="S3.SS3.p2.4.m4.1.1.1.1.3.3.3">𝐿</ci><ci id="S3.SS3.p2.4.m4.1.1.1.1.3.3.4.cmml" xref="S3.SS3.p2.4.m4.1.1.1.1.3.3.4">𝑈</ci><ci id="S3.SS3.p2.4.m4.1.1.1.1.3.3.5.cmml" xref="S3.SS3.p2.4.m4.1.1.1.1.3.3.5">𝐵</ci></apply></apply><apply id="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1.1.1.1.1"><plus id="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.1"></plus><apply id="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.2.2">𝑆</ci><ci id="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.2.3.cmml" xref="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.2.3">𝑎</ci></apply><apply id="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.3.1.cmml" xref="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.3.2.cmml" xref="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.3.2">𝑆</ci><ci id="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.3.3.cmml" xref="S3.SS3.p2.4.m4.1.1.1.1.1.1.1.3.3">𝑏</ci></apply></apply></apply><apply id="S3.SS3.p2.4.m4.3.3.3.3.cmml" xref="S3.SS3.p2.4.m4.3.3.3.3"><times id="S3.SS3.p2.4.m4.3.3.3.3.3.cmml" xref="S3.SS3.p2.4.m4.3.3.3.3.3"></times><apply id="S3.SS3.p2.4.m4.3.3.3.3.4.cmml" xref="S3.SS3.p2.4.m4.3.3.3.3.4"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m4.3.3.3.3.4.1.cmml" xref="S3.SS3.p2.4.m4.3.3.3.3.4">subscript</csymbol><ci id="S3.SS3.p2.4.m4.3.3.3.3.4.2.cmml" xref="S3.SS3.p2.4.m4.3.3.3.3.4.2">𝐿</ci><ci id="S3.SS3.p2.4.m4.3.3.3.3.4.3a.cmml" xref="S3.SS3.p2.4.m4.3.3.3.3.4.3"><mtext id="S3.SS3.p2.4.m4.3.3.3.3.4.3.cmml" mathsize="70%" xref="S3.SS3.p2.4.m4.3.3.3.3.4.3">estimator</mtext></ci></apply><interval closure="open" id="S3.SS3.p2.4.m4.3.3.3.3.2.3.cmml" xref="S3.SS3.p2.4.m4.3.3.3.3.2.2"><apply id="S3.SS3.p2.4.m4.2.2.2.2.1.1.1.cmml" xref="S3.SS3.p2.4.m4.2.2.2.2.1.1.1"><plus id="S3.SS3.p2.4.m4.2.2.2.2.1.1.1.1.cmml" xref="S3.SS3.p2.4.m4.2.2.2.2.1.1.1.1"></plus><apply id="S3.SS3.p2.4.m4.2.2.2.2.1.1.1.2.cmml" xref="S3.SS3.p2.4.m4.2.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m4.2.2.2.2.1.1.1.2.1.cmml" xref="S3.SS3.p2.4.m4.2.2.2.2.1.1.1.2">subscript</csymbol><ci id="S3.SS3.p2.4.m4.2.2.2.2.1.1.1.2.2.cmml" xref="S3.SS3.p2.4.m4.2.2.2.2.1.1.1.2.2">𝑆</ci><ci id="S3.SS3.p2.4.m4.2.2.2.2.1.1.1.2.3.cmml" xref="S3.SS3.p2.4.m4.2.2.2.2.1.1.1.2.3">𝑎</ci></apply><apply id="S3.SS3.p2.4.m4.2.2.2.2.1.1.1.3.cmml" xref="S3.SS3.p2.4.m4.2.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m4.2.2.2.2.1.1.1.3.1.cmml" xref="S3.SS3.p2.4.m4.2.2.2.2.1.1.1.3">subscript</csymbol><ci id="S3.SS3.p2.4.m4.2.2.2.2.1.1.1.3.2.cmml" xref="S3.SS3.p2.4.m4.2.2.2.2.1.1.1.3.2">𝑆</ci><ci id="S3.SS3.p2.4.m4.2.2.2.2.1.1.1.3.3.cmml" xref="S3.SS3.p2.4.m4.2.2.2.2.1.1.1.3.3">𝑏</ci></apply></apply><apply id="S3.SS3.p2.4.m4.3.3.3.3.2.2.2.cmml" xref="S3.SS3.p2.4.m4.3.3.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m4.3.3.3.3.2.2.2.1.cmml" xref="S3.SS3.p2.4.m4.3.3.3.3.2.2.2">subscript</csymbol><ci id="S3.SS3.p2.4.m4.3.3.3.3.2.2.2.2.cmml" xref="S3.SS3.p2.4.m4.3.3.3.3.2.2.2.2">𝑆</ci><ci id="S3.SS3.p2.4.m4.3.3.3.3.2.2.2.3.cmml" xref="S3.SS3.p2.4.m4.3.3.3.3.2.2.2.3">𝑐</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m4.3c">\text{MI Loss}=L_{v}^{CLUB}(S_{a}+S_{b})+L_{\text{estimator}}(S_{a}+S_{b},S_{c})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.4.m4.3d">MI Loss = italic_L start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_C italic_L italic_U italic_B end_POSTSUPERSCRIPT ( italic_S start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT + italic_S start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT ) + italic_L start_POSTSUBSCRIPT estimator end_POSTSUBSCRIPT ( italic_S start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT + italic_S start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT , italic_S start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT )</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS3.p3">
<p class="ltx_p" id="S3.SS3.p3.9">After optimizing the mutual information between the modality-specific information and the modality-common information, we utilize dense fusion <cite class="ltx_cite ltx_citemacro_citep">(Holste et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.12309v1#bib.bib17" title="">2023</a>)</cite> to enable denser interaction between modalities. Instead of directly connecting a prediction classifier on top of the fused representation <math alttext="S_{c}" class="ltx_Math" display="inline" id="S3.SS3.p3.1.m1.1"><semantics id="S3.SS3.p3.1.m1.1a"><msub id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml"><mi id="S3.SS3.p3.1.m1.1.1.2" xref="S3.SS3.p3.1.m1.1.1.2.cmml">S</mi><mi id="S3.SS3.p3.1.m1.1.1.3" xref="S3.SS3.p3.1.m1.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.1b"><apply id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.1.m1.1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p3.1.m1.1.1.2.cmml" xref="S3.SS3.p3.1.m1.1.1.2">𝑆</ci><ci id="S3.SS3.p3.1.m1.1.1.3.cmml" xref="S3.SS3.p3.1.m1.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.1c">S_{c}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.1.m1.1d">italic_S start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math>, we learn deeper representations of the clinical notes and lab test features and add skip connections to concatenate with the fused representation, forming a final fused embedding:
<math alttext="h_{a}=f_{a}(S_{a})\text{ and }h_{b}=f_{b}(S_{b})" class="ltx_Math" display="inline" id="S3.SS3.p3.2.m2.2"><semantics id="S3.SS3.p3.2.m2.2a"><mrow id="S3.SS3.p3.2.m2.2.2" xref="S3.SS3.p3.2.m2.2.2.cmml"><msub id="S3.SS3.p3.2.m2.2.2.4" xref="S3.SS3.p3.2.m2.2.2.4.cmml"><mi id="S3.SS3.p3.2.m2.2.2.4.2" xref="S3.SS3.p3.2.m2.2.2.4.2.cmml">h</mi><mi id="S3.SS3.p3.2.m2.2.2.4.3" xref="S3.SS3.p3.2.m2.2.2.4.3.cmml">a</mi></msub><mo id="S3.SS3.p3.2.m2.2.2.5" xref="S3.SS3.p3.2.m2.2.2.5.cmml">=</mo><mrow id="S3.SS3.p3.2.m2.1.1.1" xref="S3.SS3.p3.2.m2.1.1.1.cmml"><msub id="S3.SS3.p3.2.m2.1.1.1.3" xref="S3.SS3.p3.2.m2.1.1.1.3.cmml"><mi id="S3.SS3.p3.2.m2.1.1.1.3.2" xref="S3.SS3.p3.2.m2.1.1.1.3.2.cmml">f</mi><mi id="S3.SS3.p3.2.m2.1.1.1.3.3" xref="S3.SS3.p3.2.m2.1.1.1.3.3.cmml">a</mi></msub><mo id="S3.SS3.p3.2.m2.1.1.1.2" xref="S3.SS3.p3.2.m2.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.p3.2.m2.1.1.1.1.1" xref="S3.SS3.p3.2.m2.1.1.1.1.1.1.cmml"><mo id="S3.SS3.p3.2.m2.1.1.1.1.1.2" stretchy="false" xref="S3.SS3.p3.2.m2.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS3.p3.2.m2.1.1.1.1.1.1" xref="S3.SS3.p3.2.m2.1.1.1.1.1.1.cmml"><mi id="S3.SS3.p3.2.m2.1.1.1.1.1.1.2" xref="S3.SS3.p3.2.m2.1.1.1.1.1.1.2.cmml">S</mi><mi id="S3.SS3.p3.2.m2.1.1.1.1.1.1.3" xref="S3.SS3.p3.2.m2.1.1.1.1.1.1.3.cmml">a</mi></msub><mo id="S3.SS3.p3.2.m2.1.1.1.1.1.3" stretchy="false" xref="S3.SS3.p3.2.m2.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.SS3.p3.2.m2.1.1.1.2a" xref="S3.SS3.p3.2.m2.1.1.1.2.cmml">⁢</mo><mtext id="S3.SS3.p3.2.m2.1.1.1.4" xref="S3.SS3.p3.2.m2.1.1.1.4a.cmml"> and </mtext><mo id="S3.SS3.p3.2.m2.1.1.1.2b" xref="S3.SS3.p3.2.m2.1.1.1.2.cmml">⁢</mo><msub id="S3.SS3.p3.2.m2.1.1.1.5" xref="S3.SS3.p3.2.m2.1.1.1.5.cmml"><mi id="S3.SS3.p3.2.m2.1.1.1.5.2" xref="S3.SS3.p3.2.m2.1.1.1.5.2.cmml">h</mi><mi id="S3.SS3.p3.2.m2.1.1.1.5.3" xref="S3.SS3.p3.2.m2.1.1.1.5.3.cmml">b</mi></msub></mrow><mo id="S3.SS3.p3.2.m2.2.2.6" xref="S3.SS3.p3.2.m2.2.2.6.cmml">=</mo><mrow id="S3.SS3.p3.2.m2.2.2.2" xref="S3.SS3.p3.2.m2.2.2.2.cmml"><msub id="S3.SS3.p3.2.m2.2.2.2.3" xref="S3.SS3.p3.2.m2.2.2.2.3.cmml"><mi id="S3.SS3.p3.2.m2.2.2.2.3.2" xref="S3.SS3.p3.2.m2.2.2.2.3.2.cmml">f</mi><mi id="S3.SS3.p3.2.m2.2.2.2.3.3" xref="S3.SS3.p3.2.m2.2.2.2.3.3.cmml">b</mi></msub><mo id="S3.SS3.p3.2.m2.2.2.2.2" xref="S3.SS3.p3.2.m2.2.2.2.2.cmml">⁢</mo><mrow id="S3.SS3.p3.2.m2.2.2.2.1.1" xref="S3.SS3.p3.2.m2.2.2.2.1.1.1.cmml"><mo id="S3.SS3.p3.2.m2.2.2.2.1.1.2" stretchy="false" xref="S3.SS3.p3.2.m2.2.2.2.1.1.1.cmml">(</mo><msub id="S3.SS3.p3.2.m2.2.2.2.1.1.1" xref="S3.SS3.p3.2.m2.2.2.2.1.1.1.cmml"><mi id="S3.SS3.p3.2.m2.2.2.2.1.1.1.2" xref="S3.SS3.p3.2.m2.2.2.2.1.1.1.2.cmml">S</mi><mi id="S3.SS3.p3.2.m2.2.2.2.1.1.1.3" xref="S3.SS3.p3.2.m2.2.2.2.1.1.1.3.cmml">b</mi></msub><mo id="S3.SS3.p3.2.m2.2.2.2.1.1.3" stretchy="false" xref="S3.SS3.p3.2.m2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m2.2b"><apply id="S3.SS3.p3.2.m2.2.2.cmml" xref="S3.SS3.p3.2.m2.2.2"><and id="S3.SS3.p3.2.m2.2.2a.cmml" xref="S3.SS3.p3.2.m2.2.2"></and><apply id="S3.SS3.p3.2.m2.2.2b.cmml" xref="S3.SS3.p3.2.m2.2.2"><eq id="S3.SS3.p3.2.m2.2.2.5.cmml" xref="S3.SS3.p3.2.m2.2.2.5"></eq><apply id="S3.SS3.p3.2.m2.2.2.4.cmml" xref="S3.SS3.p3.2.m2.2.2.4"><csymbol cd="ambiguous" id="S3.SS3.p3.2.m2.2.2.4.1.cmml" xref="S3.SS3.p3.2.m2.2.2.4">subscript</csymbol><ci id="S3.SS3.p3.2.m2.2.2.4.2.cmml" xref="S3.SS3.p3.2.m2.2.2.4.2">ℎ</ci><ci id="S3.SS3.p3.2.m2.2.2.4.3.cmml" xref="S3.SS3.p3.2.m2.2.2.4.3">𝑎</ci></apply><apply id="S3.SS3.p3.2.m2.1.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1.1"><times id="S3.SS3.p3.2.m2.1.1.1.2.cmml" xref="S3.SS3.p3.2.m2.1.1.1.2"></times><apply id="S3.SS3.p3.2.m2.1.1.1.3.cmml" xref="S3.SS3.p3.2.m2.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p3.2.m2.1.1.1.3.1.cmml" xref="S3.SS3.p3.2.m2.1.1.1.3">subscript</csymbol><ci id="S3.SS3.p3.2.m2.1.1.1.3.2.cmml" xref="S3.SS3.p3.2.m2.1.1.1.3.2">𝑓</ci><ci id="S3.SS3.p3.2.m2.1.1.1.3.3.cmml" xref="S3.SS3.p3.2.m2.1.1.1.3.3">𝑎</ci></apply><apply id="S3.SS3.p3.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.2.m2.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p3.2.m2.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p3.2.m2.1.1.1.1.1.1.2">𝑆</ci><ci id="S3.SS3.p3.2.m2.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p3.2.m2.1.1.1.1.1.1.3">𝑎</ci></apply><ci id="S3.SS3.p3.2.m2.1.1.1.4a.cmml" xref="S3.SS3.p3.2.m2.1.1.1.4"><mtext id="S3.SS3.p3.2.m2.1.1.1.4.cmml" xref="S3.SS3.p3.2.m2.1.1.1.4"> and </mtext></ci><apply id="S3.SS3.p3.2.m2.1.1.1.5.cmml" xref="S3.SS3.p3.2.m2.1.1.1.5"><csymbol cd="ambiguous" id="S3.SS3.p3.2.m2.1.1.1.5.1.cmml" xref="S3.SS3.p3.2.m2.1.1.1.5">subscript</csymbol><ci id="S3.SS3.p3.2.m2.1.1.1.5.2.cmml" xref="S3.SS3.p3.2.m2.1.1.1.5.2">ℎ</ci><ci id="S3.SS3.p3.2.m2.1.1.1.5.3.cmml" xref="S3.SS3.p3.2.m2.1.1.1.5.3">𝑏</ci></apply></apply></apply><apply id="S3.SS3.p3.2.m2.2.2c.cmml" xref="S3.SS3.p3.2.m2.2.2"><eq id="S3.SS3.p3.2.m2.2.2.6.cmml" xref="S3.SS3.p3.2.m2.2.2.6"></eq><share href="https://arxiv.org/html/2407.12309v1#S3.SS3.p3.2.m2.1.1.1.cmml" id="S3.SS3.p3.2.m2.2.2d.cmml" xref="S3.SS3.p3.2.m2.2.2"></share><apply id="S3.SS3.p3.2.m2.2.2.2.cmml" xref="S3.SS3.p3.2.m2.2.2.2"><times id="S3.SS3.p3.2.m2.2.2.2.2.cmml" xref="S3.SS3.p3.2.m2.2.2.2.2"></times><apply id="S3.SS3.p3.2.m2.2.2.2.3.cmml" xref="S3.SS3.p3.2.m2.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS3.p3.2.m2.2.2.2.3.1.cmml" xref="S3.SS3.p3.2.m2.2.2.2.3">subscript</csymbol><ci id="S3.SS3.p3.2.m2.2.2.2.3.2.cmml" xref="S3.SS3.p3.2.m2.2.2.2.3.2">𝑓</ci><ci id="S3.SS3.p3.2.m2.2.2.2.3.3.cmml" xref="S3.SS3.p3.2.m2.2.2.2.3.3">𝑏</ci></apply><apply id="S3.SS3.p3.2.m2.2.2.2.1.1.1.cmml" xref="S3.SS3.p3.2.m2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.2.m2.2.2.2.1.1.1.1.cmml" xref="S3.SS3.p3.2.m2.2.2.2.1.1">subscript</csymbol><ci id="S3.SS3.p3.2.m2.2.2.2.1.1.1.2.cmml" xref="S3.SS3.p3.2.m2.2.2.2.1.1.1.2">𝑆</ci><ci id="S3.SS3.p3.2.m2.2.2.2.1.1.1.3.cmml" xref="S3.SS3.p3.2.m2.2.2.2.1.1.1.3">𝑏</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.2.m2.2c">h_{a}=f_{a}(S_{a})\text{ and }h_{b}=f_{b}(S_{b})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.2.m2.2d">italic_h start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT = italic_f start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT ( italic_S start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT ) and italic_h start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT = italic_f start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT ( italic_S start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT )</annotation></semantics></math>
where <math alttext="f_{a}" class="ltx_Math" display="inline" id="S3.SS3.p3.3.m3.1"><semantics id="S3.SS3.p3.3.m3.1a"><msub id="S3.SS3.p3.3.m3.1.1" xref="S3.SS3.p3.3.m3.1.1.cmml"><mi id="S3.SS3.p3.3.m3.1.1.2" xref="S3.SS3.p3.3.m3.1.1.2.cmml">f</mi><mi id="S3.SS3.p3.3.m3.1.1.3" xref="S3.SS3.p3.3.m3.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.3.m3.1b"><apply id="S3.SS3.p3.3.m3.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.3.m3.1.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.p3.3.m3.1.1.2.cmml" xref="S3.SS3.p3.3.m3.1.1.2">𝑓</ci><ci id="S3.SS3.p3.3.m3.1.1.3.cmml" xref="S3.SS3.p3.3.m3.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.3.m3.1c">f_{a}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.3.m3.1d">italic_f start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="f_{b}" class="ltx_Math" display="inline" id="S3.SS3.p3.4.m4.1"><semantics id="S3.SS3.p3.4.m4.1a"><msub id="S3.SS3.p3.4.m4.1.1" xref="S3.SS3.p3.4.m4.1.1.cmml"><mi id="S3.SS3.p3.4.m4.1.1.2" xref="S3.SS3.p3.4.m4.1.1.2.cmml">f</mi><mi id="S3.SS3.p3.4.m4.1.1.3" xref="S3.SS3.p3.4.m4.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.4.m4.1b"><apply id="S3.SS3.p3.4.m4.1.1.cmml" xref="S3.SS3.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.4.m4.1.1.1.cmml" xref="S3.SS3.p3.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.p3.4.m4.1.1.2.cmml" xref="S3.SS3.p3.4.m4.1.1.2">𝑓</ci><ci id="S3.SS3.p3.4.m4.1.1.3.cmml" xref="S3.SS3.p3.4.m4.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.4.m4.1c">f_{b}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.4.m4.1d">italic_f start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT</annotation></semantics></math> are fully-connected layers. This final representation not only aggregates the modality-specific features but also incorporates the modality-common representation from the previous stage of the network:
<math alttext="h_{final}=concat(h_{a},S_{c},h_{b})" class="ltx_Math" display="inline" id="S3.SS3.p3.5.m5.3"><semantics id="S3.SS3.p3.5.m5.3a"><mrow id="S3.SS3.p3.5.m5.3.3" xref="S3.SS3.p3.5.m5.3.3.cmml"><msub id="S3.SS3.p3.5.m5.3.3.5" xref="S3.SS3.p3.5.m5.3.3.5.cmml"><mi id="S3.SS3.p3.5.m5.3.3.5.2" xref="S3.SS3.p3.5.m5.3.3.5.2.cmml">h</mi><mrow id="S3.SS3.p3.5.m5.3.3.5.3" xref="S3.SS3.p3.5.m5.3.3.5.3.cmml"><mi id="S3.SS3.p3.5.m5.3.3.5.3.2" xref="S3.SS3.p3.5.m5.3.3.5.3.2.cmml">f</mi><mo id="S3.SS3.p3.5.m5.3.3.5.3.1" xref="S3.SS3.p3.5.m5.3.3.5.3.1.cmml">⁢</mo><mi id="S3.SS3.p3.5.m5.3.3.5.3.3" xref="S3.SS3.p3.5.m5.3.3.5.3.3.cmml">i</mi><mo id="S3.SS3.p3.5.m5.3.3.5.3.1a" xref="S3.SS3.p3.5.m5.3.3.5.3.1.cmml">⁢</mo><mi id="S3.SS3.p3.5.m5.3.3.5.3.4" xref="S3.SS3.p3.5.m5.3.3.5.3.4.cmml">n</mi><mo id="S3.SS3.p3.5.m5.3.3.5.3.1b" xref="S3.SS3.p3.5.m5.3.3.5.3.1.cmml">⁢</mo><mi id="S3.SS3.p3.5.m5.3.3.5.3.5" xref="S3.SS3.p3.5.m5.3.3.5.3.5.cmml">a</mi><mo id="S3.SS3.p3.5.m5.3.3.5.3.1c" xref="S3.SS3.p3.5.m5.3.3.5.3.1.cmml">⁢</mo><mi id="S3.SS3.p3.5.m5.3.3.5.3.6" xref="S3.SS3.p3.5.m5.3.3.5.3.6.cmml">l</mi></mrow></msub><mo id="S3.SS3.p3.5.m5.3.3.4" xref="S3.SS3.p3.5.m5.3.3.4.cmml">=</mo><mrow id="S3.SS3.p3.5.m5.3.3.3" xref="S3.SS3.p3.5.m5.3.3.3.cmml"><mi id="S3.SS3.p3.5.m5.3.3.3.5" xref="S3.SS3.p3.5.m5.3.3.3.5.cmml">c</mi><mo id="S3.SS3.p3.5.m5.3.3.3.4" xref="S3.SS3.p3.5.m5.3.3.3.4.cmml">⁢</mo><mi id="S3.SS3.p3.5.m5.3.3.3.6" xref="S3.SS3.p3.5.m5.3.3.3.6.cmml">o</mi><mo id="S3.SS3.p3.5.m5.3.3.3.4a" xref="S3.SS3.p3.5.m5.3.3.3.4.cmml">⁢</mo><mi id="S3.SS3.p3.5.m5.3.3.3.7" xref="S3.SS3.p3.5.m5.3.3.3.7.cmml">n</mi><mo id="S3.SS3.p3.5.m5.3.3.3.4b" xref="S3.SS3.p3.5.m5.3.3.3.4.cmml">⁢</mo><mi id="S3.SS3.p3.5.m5.3.3.3.8" xref="S3.SS3.p3.5.m5.3.3.3.8.cmml">c</mi><mo id="S3.SS3.p3.5.m5.3.3.3.4c" xref="S3.SS3.p3.5.m5.3.3.3.4.cmml">⁢</mo><mi id="S3.SS3.p3.5.m5.3.3.3.9" xref="S3.SS3.p3.5.m5.3.3.3.9.cmml">a</mi><mo id="S3.SS3.p3.5.m5.3.3.3.4d" xref="S3.SS3.p3.5.m5.3.3.3.4.cmml">⁢</mo><mi id="S3.SS3.p3.5.m5.3.3.3.10" xref="S3.SS3.p3.5.m5.3.3.3.10.cmml">t</mi><mo id="S3.SS3.p3.5.m5.3.3.3.4e" xref="S3.SS3.p3.5.m5.3.3.3.4.cmml">⁢</mo><mrow id="S3.SS3.p3.5.m5.3.3.3.3.3" xref="S3.SS3.p3.5.m5.3.3.3.3.4.cmml"><mo id="S3.SS3.p3.5.m5.3.3.3.3.3.4" stretchy="false" xref="S3.SS3.p3.5.m5.3.3.3.3.4.cmml">(</mo><msub id="S3.SS3.p3.5.m5.1.1.1.1.1.1" xref="S3.SS3.p3.5.m5.1.1.1.1.1.1.cmml"><mi id="S3.SS3.p3.5.m5.1.1.1.1.1.1.2" xref="S3.SS3.p3.5.m5.1.1.1.1.1.1.2.cmml">h</mi><mi id="S3.SS3.p3.5.m5.1.1.1.1.1.1.3" xref="S3.SS3.p3.5.m5.1.1.1.1.1.1.3.cmml">a</mi></msub><mo id="S3.SS3.p3.5.m5.3.3.3.3.3.5" xref="S3.SS3.p3.5.m5.3.3.3.3.4.cmml">,</mo><msub id="S3.SS3.p3.5.m5.2.2.2.2.2.2" xref="S3.SS3.p3.5.m5.2.2.2.2.2.2.cmml"><mi id="S3.SS3.p3.5.m5.2.2.2.2.2.2.2" xref="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.cmml">S</mi><mi id="S3.SS3.p3.5.m5.2.2.2.2.2.2.3" xref="S3.SS3.p3.5.m5.2.2.2.2.2.2.3.cmml">c</mi></msub><mo id="S3.SS3.p3.5.m5.3.3.3.3.3.6" xref="S3.SS3.p3.5.m5.3.3.3.3.4.cmml">,</mo><msub id="S3.SS3.p3.5.m5.3.3.3.3.3.3" xref="S3.SS3.p3.5.m5.3.3.3.3.3.3.cmml"><mi id="S3.SS3.p3.5.m5.3.3.3.3.3.3.2" xref="S3.SS3.p3.5.m5.3.3.3.3.3.3.2.cmml">h</mi><mi id="S3.SS3.p3.5.m5.3.3.3.3.3.3.3" xref="S3.SS3.p3.5.m5.3.3.3.3.3.3.3.cmml">b</mi></msub><mo id="S3.SS3.p3.5.m5.3.3.3.3.3.7" stretchy="false" xref="S3.SS3.p3.5.m5.3.3.3.3.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.5.m5.3b"><apply id="S3.SS3.p3.5.m5.3.3.cmml" xref="S3.SS3.p3.5.m5.3.3"><eq id="S3.SS3.p3.5.m5.3.3.4.cmml" xref="S3.SS3.p3.5.m5.3.3.4"></eq><apply id="S3.SS3.p3.5.m5.3.3.5.cmml" xref="S3.SS3.p3.5.m5.3.3.5"><csymbol cd="ambiguous" id="S3.SS3.p3.5.m5.3.3.5.1.cmml" xref="S3.SS3.p3.5.m5.3.3.5">subscript</csymbol><ci id="S3.SS3.p3.5.m5.3.3.5.2.cmml" xref="S3.SS3.p3.5.m5.3.3.5.2">ℎ</ci><apply id="S3.SS3.p3.5.m5.3.3.5.3.cmml" xref="S3.SS3.p3.5.m5.3.3.5.3"><times id="S3.SS3.p3.5.m5.3.3.5.3.1.cmml" xref="S3.SS3.p3.5.m5.3.3.5.3.1"></times><ci id="S3.SS3.p3.5.m5.3.3.5.3.2.cmml" xref="S3.SS3.p3.5.m5.3.3.5.3.2">𝑓</ci><ci id="S3.SS3.p3.5.m5.3.3.5.3.3.cmml" xref="S3.SS3.p3.5.m5.3.3.5.3.3">𝑖</ci><ci id="S3.SS3.p3.5.m5.3.3.5.3.4.cmml" xref="S3.SS3.p3.5.m5.3.3.5.3.4">𝑛</ci><ci id="S3.SS3.p3.5.m5.3.3.5.3.5.cmml" xref="S3.SS3.p3.5.m5.3.3.5.3.5">𝑎</ci><ci id="S3.SS3.p3.5.m5.3.3.5.3.6.cmml" xref="S3.SS3.p3.5.m5.3.3.5.3.6">𝑙</ci></apply></apply><apply id="S3.SS3.p3.5.m5.3.3.3.cmml" xref="S3.SS3.p3.5.m5.3.3.3"><times id="S3.SS3.p3.5.m5.3.3.3.4.cmml" xref="S3.SS3.p3.5.m5.3.3.3.4"></times><ci id="S3.SS3.p3.5.m5.3.3.3.5.cmml" xref="S3.SS3.p3.5.m5.3.3.3.5">𝑐</ci><ci id="S3.SS3.p3.5.m5.3.3.3.6.cmml" xref="S3.SS3.p3.5.m5.3.3.3.6">𝑜</ci><ci id="S3.SS3.p3.5.m5.3.3.3.7.cmml" xref="S3.SS3.p3.5.m5.3.3.3.7">𝑛</ci><ci id="S3.SS3.p3.5.m5.3.3.3.8.cmml" xref="S3.SS3.p3.5.m5.3.3.3.8">𝑐</ci><ci id="S3.SS3.p3.5.m5.3.3.3.9.cmml" xref="S3.SS3.p3.5.m5.3.3.3.9">𝑎</ci><ci id="S3.SS3.p3.5.m5.3.3.3.10.cmml" xref="S3.SS3.p3.5.m5.3.3.3.10">𝑡</ci><vector id="S3.SS3.p3.5.m5.3.3.3.3.4.cmml" xref="S3.SS3.p3.5.m5.3.3.3.3.3"><apply id="S3.SS3.p3.5.m5.1.1.1.1.1.1.cmml" xref="S3.SS3.p3.5.m5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.5.m5.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p3.5.m5.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p3.5.m5.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p3.5.m5.1.1.1.1.1.1.2">ℎ</ci><ci id="S3.SS3.p3.5.m5.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p3.5.m5.1.1.1.1.1.1.3">𝑎</ci></apply><apply id="S3.SS3.p3.5.m5.2.2.2.2.2.2.cmml" xref="S3.SS3.p3.5.m5.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p3.5.m5.2.2.2.2.2.2.1.cmml" xref="S3.SS3.p3.5.m5.2.2.2.2.2.2">subscript</csymbol><ci id="S3.SS3.p3.5.m5.2.2.2.2.2.2.2.cmml" xref="S3.SS3.p3.5.m5.2.2.2.2.2.2.2">𝑆</ci><ci id="S3.SS3.p3.5.m5.2.2.2.2.2.2.3.cmml" xref="S3.SS3.p3.5.m5.2.2.2.2.2.2.3">𝑐</ci></apply><apply id="S3.SS3.p3.5.m5.3.3.3.3.3.3.cmml" xref="S3.SS3.p3.5.m5.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p3.5.m5.3.3.3.3.3.3.1.cmml" xref="S3.SS3.p3.5.m5.3.3.3.3.3.3">subscript</csymbol><ci id="S3.SS3.p3.5.m5.3.3.3.3.3.3.2.cmml" xref="S3.SS3.p3.5.m5.3.3.3.3.3.3.2">ℎ</ci><ci id="S3.SS3.p3.5.m5.3.3.3.3.3.3.3.cmml" xref="S3.SS3.p3.5.m5.3.3.3.3.3.3.3">𝑏</ci></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.5.m5.3c">h_{final}=concat(h_{a},S_{c},h_{b})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.5.m5.3d">italic_h start_POSTSUBSCRIPT italic_f italic_i italic_n italic_a italic_l end_POSTSUBSCRIPT = italic_c italic_o italic_n italic_c italic_a italic_t ( italic_h start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT , italic_S start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT , italic_h start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT )</annotation></semantics></math>.
Finally, a dense block <math alttext="g" class="ltx_Math" display="inline" id="S3.SS3.p3.6.m6.1"><semantics id="S3.SS3.p3.6.m6.1a"><mi id="S3.SS3.p3.6.m6.1.1" xref="S3.SS3.p3.6.m6.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.6.m6.1b"><ci id="S3.SS3.p3.6.m6.1.1.cmml" xref="S3.SS3.p3.6.m6.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.6.m6.1c">g</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.6.m6.1d">italic_g</annotation></semantics></math> is used to generate <math alttext="y=g(h_{final})" class="ltx_Math" display="inline" id="S3.SS3.p3.7.m7.1"><semantics id="S3.SS3.p3.7.m7.1a"><mrow id="S3.SS3.p3.7.m7.1.1" xref="S3.SS3.p3.7.m7.1.1.cmml"><mi id="S3.SS3.p3.7.m7.1.1.3" xref="S3.SS3.p3.7.m7.1.1.3.cmml">y</mi><mo id="S3.SS3.p3.7.m7.1.1.2" xref="S3.SS3.p3.7.m7.1.1.2.cmml">=</mo><mrow id="S3.SS3.p3.7.m7.1.1.1" xref="S3.SS3.p3.7.m7.1.1.1.cmml"><mi id="S3.SS3.p3.7.m7.1.1.1.3" xref="S3.SS3.p3.7.m7.1.1.1.3.cmml">g</mi><mo id="S3.SS3.p3.7.m7.1.1.1.2" xref="S3.SS3.p3.7.m7.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.p3.7.m7.1.1.1.1.1" xref="S3.SS3.p3.7.m7.1.1.1.1.1.1.cmml"><mo id="S3.SS3.p3.7.m7.1.1.1.1.1.2" stretchy="false" xref="S3.SS3.p3.7.m7.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS3.p3.7.m7.1.1.1.1.1.1" xref="S3.SS3.p3.7.m7.1.1.1.1.1.1.cmml"><mi id="S3.SS3.p3.7.m7.1.1.1.1.1.1.2" xref="S3.SS3.p3.7.m7.1.1.1.1.1.1.2.cmml">h</mi><mrow id="S3.SS3.p3.7.m7.1.1.1.1.1.1.3" xref="S3.SS3.p3.7.m7.1.1.1.1.1.1.3.cmml"><mi id="S3.SS3.p3.7.m7.1.1.1.1.1.1.3.2" xref="S3.SS3.p3.7.m7.1.1.1.1.1.1.3.2.cmml">f</mi><mo id="S3.SS3.p3.7.m7.1.1.1.1.1.1.3.1" xref="S3.SS3.p3.7.m7.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p3.7.m7.1.1.1.1.1.1.3.3" xref="S3.SS3.p3.7.m7.1.1.1.1.1.1.3.3.cmml">i</mi><mo id="S3.SS3.p3.7.m7.1.1.1.1.1.1.3.1a" xref="S3.SS3.p3.7.m7.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p3.7.m7.1.1.1.1.1.1.3.4" xref="S3.SS3.p3.7.m7.1.1.1.1.1.1.3.4.cmml">n</mi><mo id="S3.SS3.p3.7.m7.1.1.1.1.1.1.3.1b" xref="S3.SS3.p3.7.m7.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p3.7.m7.1.1.1.1.1.1.3.5" xref="S3.SS3.p3.7.m7.1.1.1.1.1.1.3.5.cmml">a</mi><mo id="S3.SS3.p3.7.m7.1.1.1.1.1.1.3.1c" xref="S3.SS3.p3.7.m7.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p3.7.m7.1.1.1.1.1.1.3.6" xref="S3.SS3.p3.7.m7.1.1.1.1.1.1.3.6.cmml">l</mi></mrow></msub><mo id="S3.SS3.p3.7.m7.1.1.1.1.1.3" stretchy="false" xref="S3.SS3.p3.7.m7.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.7.m7.1b"><apply id="S3.SS3.p3.7.m7.1.1.cmml" xref="S3.SS3.p3.7.m7.1.1"><eq id="S3.SS3.p3.7.m7.1.1.2.cmml" xref="S3.SS3.p3.7.m7.1.1.2"></eq><ci id="S3.SS3.p3.7.m7.1.1.3.cmml" xref="S3.SS3.p3.7.m7.1.1.3">𝑦</ci><apply id="S3.SS3.p3.7.m7.1.1.1.cmml" xref="S3.SS3.p3.7.m7.1.1.1"><times id="S3.SS3.p3.7.m7.1.1.1.2.cmml" xref="S3.SS3.p3.7.m7.1.1.1.2"></times><ci id="S3.SS3.p3.7.m7.1.1.1.3.cmml" xref="S3.SS3.p3.7.m7.1.1.1.3">𝑔</ci><apply id="S3.SS3.p3.7.m7.1.1.1.1.1.1.cmml" xref="S3.SS3.p3.7.m7.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.7.m7.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p3.7.m7.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p3.7.m7.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p3.7.m7.1.1.1.1.1.1.2">ℎ</ci><apply id="S3.SS3.p3.7.m7.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p3.7.m7.1.1.1.1.1.1.3"><times id="S3.SS3.p3.7.m7.1.1.1.1.1.1.3.1.cmml" xref="S3.SS3.p3.7.m7.1.1.1.1.1.1.3.1"></times><ci id="S3.SS3.p3.7.m7.1.1.1.1.1.1.3.2.cmml" xref="S3.SS3.p3.7.m7.1.1.1.1.1.1.3.2">𝑓</ci><ci id="S3.SS3.p3.7.m7.1.1.1.1.1.1.3.3.cmml" xref="S3.SS3.p3.7.m7.1.1.1.1.1.1.3.3">𝑖</ci><ci id="S3.SS3.p3.7.m7.1.1.1.1.1.1.3.4.cmml" xref="S3.SS3.p3.7.m7.1.1.1.1.1.1.3.4">𝑛</ci><ci id="S3.SS3.p3.7.m7.1.1.1.1.1.1.3.5.cmml" xref="S3.SS3.p3.7.m7.1.1.1.1.1.1.3.5">𝑎</ci><ci id="S3.SS3.p3.7.m7.1.1.1.1.1.1.3.6.cmml" xref="S3.SS3.p3.7.m7.1.1.1.1.1.1.3.6">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.7.m7.1c">y=g(h_{final})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.7.m7.1d">italic_y = italic_g ( italic_h start_POSTSUBSCRIPT italic_f italic_i italic_n italic_a italic_l end_POSTSUBSCRIPT )</annotation></semantics></math>, and the model is trained by optimizing the prediction loss (focal loss for multilabel prediction). This allows for dense interaction of features from each modality, aggregating information across different stages of the network. The final loss optimizes a combination of the prediction objective and the mutual information loss, controlled by a hyperparameter <math alttext="\lambda" class="ltx_Math" display="inline" id="S3.SS3.p3.8.m8.1"><semantics id="S3.SS3.p3.8.m8.1a"><mi id="S3.SS3.p3.8.m8.1.1" xref="S3.SS3.p3.8.m8.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.8.m8.1b"><ci id="S3.SS3.p3.8.m8.1.1.cmml" xref="S3.SS3.p3.8.m8.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.8.m8.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.8.m8.1d">italic_λ</annotation></semantics></math> with a value range of [0,1]. In this case, we choose a value of 0.1.
<math alttext="\text{Loss}_{\text{final}}=L_{\text{objective}}(g(h_{\text{final}}))+\lambda*%
\text{MI}(\text{concat}(S_{a},S_{b}),S_{c})" class="ltx_Math" display="inline" id="S3.SS3.p3.9.m9.3"><semantics id="S3.SS3.p3.9.m9.3a"><mrow id="S3.SS3.p3.9.m9.3.3" xref="S3.SS3.p3.9.m9.3.3.cmml"><msub id="S3.SS3.p3.9.m9.3.3.5" xref="S3.SS3.p3.9.m9.3.3.5.cmml"><mtext id="S3.SS3.p3.9.m9.3.3.5.2" xref="S3.SS3.p3.9.m9.3.3.5.2a.cmml">Loss</mtext><mtext id="S3.SS3.p3.9.m9.3.3.5.3" xref="S3.SS3.p3.9.m9.3.3.5.3a.cmml">final</mtext></msub><mo id="S3.SS3.p3.9.m9.3.3.4" xref="S3.SS3.p3.9.m9.3.3.4.cmml">=</mo><mrow id="S3.SS3.p3.9.m9.3.3.3" xref="S3.SS3.p3.9.m9.3.3.3.cmml"><mrow id="S3.SS3.p3.9.m9.1.1.1.1" xref="S3.SS3.p3.9.m9.1.1.1.1.cmml"><msub id="S3.SS3.p3.9.m9.1.1.1.1.3" xref="S3.SS3.p3.9.m9.1.1.1.1.3.cmml"><mi id="S3.SS3.p3.9.m9.1.1.1.1.3.2" xref="S3.SS3.p3.9.m9.1.1.1.1.3.2.cmml">L</mi><mtext id="S3.SS3.p3.9.m9.1.1.1.1.3.3" xref="S3.SS3.p3.9.m9.1.1.1.1.3.3a.cmml">objective</mtext></msub><mo id="S3.SS3.p3.9.m9.1.1.1.1.2" xref="S3.SS3.p3.9.m9.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.p3.9.m9.1.1.1.1.1.1" xref="S3.SS3.p3.9.m9.1.1.1.1.1.1.1.cmml"><mo id="S3.SS3.p3.9.m9.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS3.p3.9.m9.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.p3.9.m9.1.1.1.1.1.1.1" xref="S3.SS3.p3.9.m9.1.1.1.1.1.1.1.cmml"><mi id="S3.SS3.p3.9.m9.1.1.1.1.1.1.1.3" xref="S3.SS3.p3.9.m9.1.1.1.1.1.1.1.3.cmml">g</mi><mo id="S3.SS3.p3.9.m9.1.1.1.1.1.1.1.2" xref="S3.SS3.p3.9.m9.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.p3.9.m9.1.1.1.1.1.1.1.1.1" xref="S3.SS3.p3.9.m9.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.SS3.p3.9.m9.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS3.p3.9.m9.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS3.p3.9.m9.1.1.1.1.1.1.1.1.1.1" xref="S3.SS3.p3.9.m9.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS3.p3.9.m9.1.1.1.1.1.1.1.1.1.1.2" xref="S3.SS3.p3.9.m9.1.1.1.1.1.1.1.1.1.1.2.cmml">h</mi><mtext id="S3.SS3.p3.9.m9.1.1.1.1.1.1.1.1.1.1.3" xref="S3.SS3.p3.9.m9.1.1.1.1.1.1.1.1.1.1.3a.cmml">final</mtext></msub><mo id="S3.SS3.p3.9.m9.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS3.p3.9.m9.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p3.9.m9.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS3.p3.9.m9.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p3.9.m9.3.3.3.4" xref="S3.SS3.p3.9.m9.3.3.3.4.cmml">+</mo><mrow id="S3.SS3.p3.9.m9.3.3.3.3" xref="S3.SS3.p3.9.m9.3.3.3.3.cmml"><mrow id="S3.SS3.p3.9.m9.3.3.3.3.4" xref="S3.SS3.p3.9.m9.3.3.3.3.4.cmml"><mi id="S3.SS3.p3.9.m9.3.3.3.3.4.2" xref="S3.SS3.p3.9.m9.3.3.3.3.4.2.cmml">λ</mi><mo id="S3.SS3.p3.9.m9.3.3.3.3.4.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.p3.9.m9.3.3.3.3.4.1.cmml">∗</mo><mtext id="S3.SS3.p3.9.m9.3.3.3.3.4.3" xref="S3.SS3.p3.9.m9.3.3.3.3.4.3a.cmml">MI</mtext></mrow><mo id="S3.SS3.p3.9.m9.3.3.3.3.3" xref="S3.SS3.p3.9.m9.3.3.3.3.3.cmml">⁢</mo><mrow id="S3.SS3.p3.9.m9.3.3.3.3.2.2" xref="S3.SS3.p3.9.m9.3.3.3.3.2.3.cmml"><mo id="S3.SS3.p3.9.m9.3.3.3.3.2.2.3" stretchy="false" xref="S3.SS3.p3.9.m9.3.3.3.3.2.3.cmml">(</mo><mrow id="S3.SS3.p3.9.m9.2.2.2.2.1.1.1" xref="S3.SS3.p3.9.m9.2.2.2.2.1.1.1.cmml"><mtext id="S3.SS3.p3.9.m9.2.2.2.2.1.1.1.4" xref="S3.SS3.p3.9.m9.2.2.2.2.1.1.1.4a.cmml">concat</mtext><mo id="S3.SS3.p3.9.m9.2.2.2.2.1.1.1.3" xref="S3.SS3.p3.9.m9.2.2.2.2.1.1.1.3.cmml">⁢</mo><mrow id="S3.SS3.p3.9.m9.2.2.2.2.1.1.1.2.2" xref="S3.SS3.p3.9.m9.2.2.2.2.1.1.1.2.3.cmml"><mo id="S3.SS3.p3.9.m9.2.2.2.2.1.1.1.2.2.3" stretchy="false" xref="S3.SS3.p3.9.m9.2.2.2.2.1.1.1.2.3.cmml">(</mo><msub id="S3.SS3.p3.9.m9.2.2.2.2.1.1.1.1.1.1" xref="S3.SS3.p3.9.m9.2.2.2.2.1.1.1.1.1.1.cmml"><mi id="S3.SS3.p3.9.m9.2.2.2.2.1.1.1.1.1.1.2" xref="S3.SS3.p3.9.m9.2.2.2.2.1.1.1.1.1.1.2.cmml">S</mi><mi id="S3.SS3.p3.9.m9.2.2.2.2.1.1.1.1.1.1.3" xref="S3.SS3.p3.9.m9.2.2.2.2.1.1.1.1.1.1.3.cmml">a</mi></msub><mo id="S3.SS3.p3.9.m9.2.2.2.2.1.1.1.2.2.4" xref="S3.SS3.p3.9.m9.2.2.2.2.1.1.1.2.3.cmml">,</mo><msub id="S3.SS3.p3.9.m9.2.2.2.2.1.1.1.2.2.2" xref="S3.SS3.p3.9.m9.2.2.2.2.1.1.1.2.2.2.cmml"><mi id="S3.SS3.p3.9.m9.2.2.2.2.1.1.1.2.2.2.2" xref="S3.SS3.p3.9.m9.2.2.2.2.1.1.1.2.2.2.2.cmml">S</mi><mi id="S3.SS3.p3.9.m9.2.2.2.2.1.1.1.2.2.2.3" xref="S3.SS3.p3.9.m9.2.2.2.2.1.1.1.2.2.2.3.cmml">b</mi></msub><mo id="S3.SS3.p3.9.m9.2.2.2.2.1.1.1.2.2.5" stretchy="false" xref="S3.SS3.p3.9.m9.2.2.2.2.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p3.9.m9.3.3.3.3.2.2.4" xref="S3.SS3.p3.9.m9.3.3.3.3.2.3.cmml">,</mo><msub id="S3.SS3.p3.9.m9.3.3.3.3.2.2.2" xref="S3.SS3.p3.9.m9.3.3.3.3.2.2.2.cmml"><mi id="S3.SS3.p3.9.m9.3.3.3.3.2.2.2.2" xref="S3.SS3.p3.9.m9.3.3.3.3.2.2.2.2.cmml">S</mi><mi id="S3.SS3.p3.9.m9.3.3.3.3.2.2.2.3" xref="S3.SS3.p3.9.m9.3.3.3.3.2.2.2.3.cmml">c</mi></msub><mo id="S3.SS3.p3.9.m9.3.3.3.3.2.2.5" stretchy="false" xref="S3.SS3.p3.9.m9.3.3.3.3.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.9.m9.3b"><apply id="S3.SS3.p3.9.m9.3.3.cmml" xref="S3.SS3.p3.9.m9.3.3"><eq id="S3.SS3.p3.9.m9.3.3.4.cmml" xref="S3.SS3.p3.9.m9.3.3.4"></eq><apply id="S3.SS3.p3.9.m9.3.3.5.cmml" xref="S3.SS3.p3.9.m9.3.3.5"><csymbol cd="ambiguous" id="S3.SS3.p3.9.m9.3.3.5.1.cmml" xref="S3.SS3.p3.9.m9.3.3.5">subscript</csymbol><ci id="S3.SS3.p3.9.m9.3.3.5.2a.cmml" xref="S3.SS3.p3.9.m9.3.3.5.2"><mtext id="S3.SS3.p3.9.m9.3.3.5.2.cmml" xref="S3.SS3.p3.9.m9.3.3.5.2">Loss</mtext></ci><ci id="S3.SS3.p3.9.m9.3.3.5.3a.cmml" xref="S3.SS3.p3.9.m9.3.3.5.3"><mtext id="S3.SS3.p3.9.m9.3.3.5.3.cmml" mathsize="70%" xref="S3.SS3.p3.9.m9.3.3.5.3">final</mtext></ci></apply><apply id="S3.SS3.p3.9.m9.3.3.3.cmml" xref="S3.SS3.p3.9.m9.3.3.3"><plus id="S3.SS3.p3.9.m9.3.3.3.4.cmml" xref="S3.SS3.p3.9.m9.3.3.3.4"></plus><apply id="S3.SS3.p3.9.m9.1.1.1.1.cmml" xref="S3.SS3.p3.9.m9.1.1.1.1"><times id="S3.SS3.p3.9.m9.1.1.1.1.2.cmml" xref="S3.SS3.p3.9.m9.1.1.1.1.2"></times><apply id="S3.SS3.p3.9.m9.1.1.1.1.3.cmml" xref="S3.SS3.p3.9.m9.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p3.9.m9.1.1.1.1.3.1.cmml" xref="S3.SS3.p3.9.m9.1.1.1.1.3">subscript</csymbol><ci id="S3.SS3.p3.9.m9.1.1.1.1.3.2.cmml" xref="S3.SS3.p3.9.m9.1.1.1.1.3.2">𝐿</ci><ci id="S3.SS3.p3.9.m9.1.1.1.1.3.3a.cmml" xref="S3.SS3.p3.9.m9.1.1.1.1.3.3"><mtext id="S3.SS3.p3.9.m9.1.1.1.1.3.3.cmml" mathsize="70%" xref="S3.SS3.p3.9.m9.1.1.1.1.3.3">objective</mtext></ci></apply><apply id="S3.SS3.p3.9.m9.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p3.9.m9.1.1.1.1.1.1"><times id="S3.SS3.p3.9.m9.1.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p3.9.m9.1.1.1.1.1.1.1.2"></times><ci id="S3.SS3.p3.9.m9.1.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p3.9.m9.1.1.1.1.1.1.1.3">𝑔</ci><apply id="S3.SS3.p3.9.m9.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p3.9.m9.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.9.m9.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p3.9.m9.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p3.9.m9.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p3.9.m9.1.1.1.1.1.1.1.1.1.1.2">ℎ</ci><ci id="S3.SS3.p3.9.m9.1.1.1.1.1.1.1.1.1.1.3a.cmml" xref="S3.SS3.p3.9.m9.1.1.1.1.1.1.1.1.1.1.3"><mtext id="S3.SS3.p3.9.m9.1.1.1.1.1.1.1.1.1.1.3.cmml" mathsize="70%" xref="S3.SS3.p3.9.m9.1.1.1.1.1.1.1.1.1.1.3">final</mtext></ci></apply></apply></apply><apply id="S3.SS3.p3.9.m9.3.3.3.3.cmml" xref="S3.SS3.p3.9.m9.3.3.3.3"><times id="S3.SS3.p3.9.m9.3.3.3.3.3.cmml" xref="S3.SS3.p3.9.m9.3.3.3.3.3"></times><apply id="S3.SS3.p3.9.m9.3.3.3.3.4.cmml" xref="S3.SS3.p3.9.m9.3.3.3.3.4"><times id="S3.SS3.p3.9.m9.3.3.3.3.4.1.cmml" xref="S3.SS3.p3.9.m9.3.3.3.3.4.1"></times><ci id="S3.SS3.p3.9.m9.3.3.3.3.4.2.cmml" xref="S3.SS3.p3.9.m9.3.3.3.3.4.2">𝜆</ci><ci id="S3.SS3.p3.9.m9.3.3.3.3.4.3a.cmml" xref="S3.SS3.p3.9.m9.3.3.3.3.4.3"><mtext id="S3.SS3.p3.9.m9.3.3.3.3.4.3.cmml" xref="S3.SS3.p3.9.m9.3.3.3.3.4.3">MI</mtext></ci></apply><interval closure="open" id="S3.SS3.p3.9.m9.3.3.3.3.2.3.cmml" xref="S3.SS3.p3.9.m9.3.3.3.3.2.2"><apply id="S3.SS3.p3.9.m9.2.2.2.2.1.1.1.cmml" xref="S3.SS3.p3.9.m9.2.2.2.2.1.1.1"><times id="S3.SS3.p3.9.m9.2.2.2.2.1.1.1.3.cmml" xref="S3.SS3.p3.9.m9.2.2.2.2.1.1.1.3"></times><ci id="S3.SS3.p3.9.m9.2.2.2.2.1.1.1.4a.cmml" xref="S3.SS3.p3.9.m9.2.2.2.2.1.1.1.4"><mtext id="S3.SS3.p3.9.m9.2.2.2.2.1.1.1.4.cmml" xref="S3.SS3.p3.9.m9.2.2.2.2.1.1.1.4">concat</mtext></ci><interval closure="open" id="S3.SS3.p3.9.m9.2.2.2.2.1.1.1.2.3.cmml" xref="S3.SS3.p3.9.m9.2.2.2.2.1.1.1.2.2"><apply id="S3.SS3.p3.9.m9.2.2.2.2.1.1.1.1.1.1.cmml" xref="S3.SS3.p3.9.m9.2.2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.9.m9.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p3.9.m9.2.2.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p3.9.m9.2.2.2.2.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p3.9.m9.2.2.2.2.1.1.1.1.1.1.2">𝑆</ci><ci id="S3.SS3.p3.9.m9.2.2.2.2.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p3.9.m9.2.2.2.2.1.1.1.1.1.1.3">𝑎</ci></apply><apply id="S3.SS3.p3.9.m9.2.2.2.2.1.1.1.2.2.2.cmml" xref="S3.SS3.p3.9.m9.2.2.2.2.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p3.9.m9.2.2.2.2.1.1.1.2.2.2.1.cmml" xref="S3.SS3.p3.9.m9.2.2.2.2.1.1.1.2.2.2">subscript</csymbol><ci id="S3.SS3.p3.9.m9.2.2.2.2.1.1.1.2.2.2.2.cmml" xref="S3.SS3.p3.9.m9.2.2.2.2.1.1.1.2.2.2.2">𝑆</ci><ci id="S3.SS3.p3.9.m9.2.2.2.2.1.1.1.2.2.2.3.cmml" xref="S3.SS3.p3.9.m9.2.2.2.2.1.1.1.2.2.2.3">𝑏</ci></apply></interval></apply><apply id="S3.SS3.p3.9.m9.3.3.3.3.2.2.2.cmml" xref="S3.SS3.p3.9.m9.3.3.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p3.9.m9.3.3.3.3.2.2.2.1.cmml" xref="S3.SS3.p3.9.m9.3.3.3.3.2.2.2">subscript</csymbol><ci id="S3.SS3.p3.9.m9.3.3.3.3.2.2.2.2.cmml" xref="S3.SS3.p3.9.m9.3.3.3.3.2.2.2.2">𝑆</ci><ci id="S3.SS3.p3.9.m9.3.3.3.3.2.2.2.3.cmml" xref="S3.SS3.p3.9.m9.3.3.3.3.2.2.2.3">𝑐</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.9.m9.3c">\text{Loss}_{\text{final}}=L_{\text{objective}}(g(h_{\text{final}}))+\lambda*%
\text{MI}(\text{concat}(S_{a},S_{b}),S_{c})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.9.m9.3d">Loss start_POSTSUBSCRIPT final end_POSTSUBSCRIPT = italic_L start_POSTSUBSCRIPT objective end_POSTSUBSCRIPT ( italic_g ( italic_h start_POSTSUBSCRIPT final end_POSTSUBSCRIPT ) ) + italic_λ ∗ MI ( concat ( italic_S start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT , italic_S start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT ) , italic_S start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT )</annotation></semantics></math></p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4. </span>EXPERIMENTS</h2>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_runin ltx_font_bold ltx_title_subsection" style="font-size:144%;">4.1   Datasets and Metrics</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">To evaluate the performance of the methods under comparison, we employed two real-world EHR datasets: MIMIC-III <cite class="ltx_cite ltx_citemacro_citep">(Johnson et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.12309v1#bib.bib20" title="">2016</a>)</cite> and FEMH. We collected five years of EHRs from the Far Eastern Memorial Hospital (FEMH) in Taiwan from 2017 to 2021. The dataset includes 1,420,596 clinical notes, 387,392 lab results, and over 1,505 lab test items. The FEMH Research Ethics Review Committee <span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>https://www.femhirb.org/</span></span></span> approved the study, and all data were de-identified. We selected patients with at least two recorded visits from each dataset.</p>
</div>
<div class="ltx_para" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.1">For the multi-label classification task in MIMIC-III, we identified the top 10 most prevalent conditions: “Hypertension, uncomplicated”, “Cardiac arrhythmias”, “Fluid and electrolyte disorders”, “Congestive heart failure”, “Diabetes w/o chronic complications”, “Chronic pulmonary disease”, “Valvular disease”, “Renal failure”, “Hypertension, complicated”, and “Other neurological disorders”. In the FEMH dataset, the top 10 most common diseases include “Hypertension”, “Diabetes”, “Heart disease”, “Cancer”, “Cerebrovascular Disease”, “Kidney Disease”, “Liver Disease”, “Asthma”, “Hyperlipidemia”, and “Lung Disease”. We applied several established multi-label classification metrics to assess model performance such as Macro-average and weighted-average F1-Scores, precision, recall, and accuracy on the test dataset <cite class="ltx_cite ltx_citemacro_citep">(Lipton et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.12309v1#bib.bib23" title="">2014</a>; Hossin and Sulaiman, <a class="ltx_ref" href="https://arxiv.org/html/2407.12309v1#bib.bib18" title="">2015</a>; Palacio-Niño and Berzal, <a class="ltx_ref" href="https://arxiv.org/html/2407.12309v1#bib.bib27" title="">2019</a>)</cite>.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_runin ltx_font_bold ltx_title_subsection" style="font-size:144%;">4.2   Experimental Results</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2407.12309v1#S3.T1" title="Table 1 ‣ 3.3 Disentangled Transformer Module ‣ 3. Method ‣ MEDFuse: Multimodal EHR Data Fusion with Masked Lab-Test Modeling and Large Language Models"><span class="ltx_text ltx_ref_tag">1</span></a> and Table <a class="ltx_ref" href="https://arxiv.org/html/2407.12309v1#S3.T2" title="Table 2 ‣ 3.3 Disentangled Transformer Module ‣ 3. Method ‣ MEDFuse: Multimodal EHR Data Fusion with Masked Lab-Test Modeling and Large Language Models"><span class="ltx_text ltx_ref_tag">2</span></a> illustrate the training and validation performance of various models, highlighting the effectiveness of our proposed method on the MIMIC-III and FEMH datasets, respectively. In Table <a class="ltx_ref" href="https://arxiv.org/html/2407.12309v1#S3.T1" title="Table 1 ‣ 3.3 Disentangled Transformer Module ‣ 3. Method ‣ MEDFuse: Multimodal EHR Data Fusion with Masked Lab-Test Modeling and Large Language Models"><span class="ltx_text ltx_ref_tag">1</span></a>, our approach outperforms baseline models such as Bert <cite class="ltx_cite ltx_citemacro_citep">(Devlin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.12309v1#bib.bib11" title="">2018</a>)</cite>, Mistral-7B-v0.1 <cite class="ltx_cite ltx_citemacro_citep">(Jiang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.12309v1#bib.bib19" title="">2023</a>)</cite>, Llama-2-7B-hf <cite class="ltx_cite ltx_citemacro_citep">(Touvron et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.12309v1#bib.bib32" title="">2023</a>)</cite>, Meta-Llama2-13B <cite class="ltx_cite ltx_citemacro_citep">(AI@Meta, <a class="ltx_ref" href="https://arxiv.org/html/2407.12309v1#bib.bib2" title="">2024a</a>)</cite>, Meta-Llama3-8B <cite class="ltx_cite ltx_citemacro_citep">(AI@Meta, <a class="ltx_ref" href="https://arxiv.org/html/2407.12309v1#bib.bib3" title="">2024b</a>)</cite>, and Medical-Llama3-8B <cite class="ltx_cite ltx_citemacro_citep">(ruslanmv, <a class="ltx_ref" href="https://arxiv.org/html/2407.12309v1#bib.bib29" title="">2024</a>)</cite> across all key metrics. Specifically, MEDFuse shows significant improvements over the best-performing LoRA fine-tuned LLM, Medical-Llama3-8B. On the test set, our model performs 1.49% better in macro F1 score, and similar trends are observed in other metrics. Table <a class="ltx_ref" href="https://arxiv.org/html/2407.12309v1#S3.T2" title="Table 2 ‣ 3.3 Disentangled Transformer Module ‣ 3. Method ‣ MEDFuse: Multimodal EHR Data Fusion with Masked Lab-Test Modeling and Large Language Models"><span class="ltx_text ltx_ref_tag">2</span></a> shows MEDFuse consistently outperforms Medical-Llama3-8B on the FEMH dataset. For example, training and validation in precision is a 1.53% increase, in the recall is a 2.07% increase, the training accuracy is 0.9311 (0.55% increase), and validation accuracy is 0.9296 (0.41% increase). These results validate the robustness and generalizability of our approach, underscoring its potential for accurate and reliable clinical predictions across diverse datasets.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_runin ltx_font_bold ltx_title_subsection" style="font-size:144%;">4.3   Ablation Study</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">We conducted an ablation study to examine the contributions of various components in our proposed method, which integrates Medical-Llama3 with a transformer module, utilizing lab tests (LABTEXT) and clinical notes (TEXT). The results highlight clear performance contrast when any component is omitted. Removing both the transformer and LABTEXT results in a 4.81% drop in training precision and a 4.40% decrease in validation precision. The most substantial performance reduction occurs when both the transformer and TEXT are excluded, leading to a 29.76% decrease in training precision and a 30.66% decrease in validation precision. This underscores the indispensable role of TEXT and the transformer in our method. Even when only TEXT is removed, performance significantly deteriorates, with a 17.14% decline in training precision and a 14.60% decline in validation precision. These findings illustrate that each component contributes significantly to the model’s overall efficacy. Our full model, combining LLMs and MLTM, demonstrates the highest performance, with a training accuracy of 0.9535 and a validation accuracy of 0.9122.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5. </span>Conclusion</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">In conclusion, we have presented a novel multi-disease diagnostic model that integrates multimodal data, closely mirroring real-life clinical decision-making. By combining fine-tuned LLMs with domain-specific transformers, we achieved enhanced synthesis of structured and unstructured medical data. Using a disentangled transformer further refined this integration, significantly improving disease prediction accuracy. Our experimental results across two practical EHR datasets demonstrated the proposed model’s robustness and effectiveness. In future work, we aim to extend our model to cover more complex and rare diseases, enhance its interpretability for clinical use, and evaluate its performance on larger, more varied datasets. We will also explore the integration of real-time and other data modalities <cite class="ltx_cite ltx_citemacro_citep">(Zheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2407.12309v1#bib.bib36" title="">2021</a>)</cite> to further align our model with dynamic clinical environments.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">AI@Meta (2024a)</span>
<span class="ltx_bibblock">
AI@Meta. 2024a.

</span>
<span class="ltx_bibblock">Llama 2 Model Card.

</span>
<span class="ltx_bibblock">(2024).

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://huggingface.co/meta-llama/Llama-2-13b" title="">https://huggingface.co/meta-llama/Llama-2-13b</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">AI@Meta (2024b)</span>
<span class="ltx_bibblock">
AI@Meta. 2024b.

</span>
<span class="ltx_bibblock">Llama 3 Model Card.

</span>
<span class="ltx_bibblock">(2024).

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/meta-llama/llama3/blob/main/MODEL_CARD.md" title="">https://github.com/meta-llama/llama3/blob/main/MODEL_CARD.md</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bellamy et al<span class="ltx_text" id="bib.bib4.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
David R Bellamy, Bhawesh Kumar, Cindy Wang, and Andrew Beam. 2023.

</span>
<span class="ltx_bibblock">Labrador: Exploring the Limits of Masked Language Modeling for Laboratory Data.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib4.3.1">arXiv preprint arXiv:2312.11502</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bolton et al<span class="ltx_text" id="bib.bib5.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Elliot Bolton, Abhinav Venigalla, Michihiro Yasunaga, David Hall, Betty Xiong, Tony Lee, Roxana Daneshjou, Jonathan Frankle, Percy Liang, Michael Carbin, et al<span class="ltx_text" id="bib.bib5.3.1">.</span> 2024.

</span>
<span class="ltx_bibblock">BioMedLM: A 2.7 B Parameter Language Model Trained On Biomedical Text.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib5.4.1">arXiv preprint arXiv:2403.18421</em> (2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cai et al<span class="ltx_text" id="bib.bib6.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Tianxi Cai, Feiqing Huang, Ryumei Nakada, Linjun Zhang, and Doudou Zhou. 2024.

</span>
<span class="ltx_bibblock">Contrastive Learning on Multimodal Analysis of Electronic Health Records.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.3.1">arXiv preprint arXiv:2403.14926</em> (2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al<span class="ltx_text" id="bib.bib7.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Jindong Chen, Yizhou Hu, Jingping Liu, Yanghua Xiao, and Haiyun Jiang. 2019.

</span>
<span class="ltx_bibblock">Deep short text classification with knowledge powered attention. In <em class="ltx_emph ltx_font_italic" id="bib.bib7.3.1">Proceedings of the AAAI conference on artificial intelligence</em>, Vol. 33. 6252–6259.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen (2015)</span>
<span class="ltx_bibblock">
Yahui Chen. 2015.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">Convolutional neural network for sentence classification</em>.

</span>
<span class="ltx_bibblock">Master’s thesis. University of Waterloo.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al<span class="ltx_text" id="bib.bib9.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Yinda Chen, Haoyuan Shi, Xiaoyu Liu, Te Shi, Ruobing Zhang, Dong Liu, Zhiwei Xiong, and Feng Wu. 2024.

</span>
<span class="ltx_bibblock">TokenUnify: Scalable Autoregressive Visual Pre-training with Mixture Token Prediction.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib9.3.1">arXiv preprint arXiv:2405.16847</em> (2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Choi et al<span class="ltx_text" id="bib.bib10.2.2.1">.</span> (2016)</span>
<span class="ltx_bibblock">
Edward Choi, Mohammad Taha Bahadori, Jimeng Sun, Joshua Kulas, Andy Schuetz, and Walter Stewart. 2016.

</span>
<span class="ltx_bibblock">Retain: An interpretable predictive model for healthcare using reverse time attention mechanism.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.3.1">Advances in neural information processing systems</em> 29 (2016).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Devlin et al<span class="ltx_text" id="bib.bib11.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Jacob Devlin, Ming-Wei Chang, Kenton Lee, and Kristina Toutanova. 2018.

</span>
<span class="ltx_bibblock">Bert: Pre-training of deep bidirectional transformers for language understanding.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.3.1">arXiv preprint arXiv:1810.04805</em> (2018).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ding et al<span class="ltx_text" id="bib.bib12.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Jun-En Ding, Nguyen Minh Thao Phan, Wen-Chih Peng, Jian-Zhe Wang, Chun-Cheng Chug, Min-Chen Hsieh, Yun-Chien Tseng, Ling Chen, Dongsheng Luo, Chenwei Wu, et al<span class="ltx_text" id="bib.bib12.3.1">.</span> 2024.

</span>
<span class="ltx_bibblock">Large Language Multimodal Models for New-Onset Type 2 Diabetes Prediction using Five-Year Cohort Electronic Health Records.

</span>
<span class="ltx_bibblock">(2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dun et al<span class="ltx_text" id="bib.bib13.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Yaqian Dun, Kefei Tu, Chen Chen, Chunyan Hou, and Xiaojie Yuan. 2021.

</span>
<span class="ltx_bibblock">Kan: Knowledge-aware attention network for fake news detection. In <em class="ltx_emph ltx_font_italic" id="bib.bib13.3.1">Proceedings of the AAAI conference on artificial intelligence</em>, Vol. 35. 81–89.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Grinsztajn et al<span class="ltx_text" id="bib.bib14.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Léo Grinsztajn, Edouard Oyallon, and Gaël Varoquaux. 2022.

</span>
<span class="ltx_bibblock">Why do tree-based models still outperform deep learning on typical tabular data?

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib14.3.1">Advances in neural information processing systems</em> 35 (2022), 507–520.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al<span class="ltx_text" id="bib.bib15.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Kaiming He, Xinlei Chen, Saining Xie, Yanghao Li, Piotr Dollár, and Ross Girshick. 2022.

</span>
<span class="ltx_bibblock">Masked autoencoders are scalable vision learners. In <em class="ltx_emph ltx_font_italic" id="bib.bib15.3.1">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</em>. 16000–16009.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hegselmann et al<span class="ltx_text" id="bib.bib16.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Stefan Hegselmann, Alejandro Buendia, Hunter Lang, Monica Agrawal, Xiaoyi Jiang, and David Sontag. 2023.

</span>
<span class="ltx_bibblock">Tabllm: Few-shot classification of tabular data with large language models. In <em class="ltx_emph ltx_font_italic" id="bib.bib16.3.1">International Conference on Artificial Intelligence and Statistics</em>. PMLR, 5549–5581.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Holste et al<span class="ltx_text" id="bib.bib17.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Gregory Holste, Douwe van der Wal, Hans Pinckaers, Rikiya Yamashita, Akinori Mitani, and Andre Esteva. 2023.

</span>
<span class="ltx_bibblock">Improved Multimodal Fusion for Small Datasets with Auxiliary Supervision. In <em class="ltx_emph ltx_font_italic" id="bib.bib17.3.1">2023 IEEE 20th International Symposium on Biomedical Imaging (ISBI)</em>. IEEE, 1–5.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hossin and Sulaiman (2015)</span>
<span class="ltx_bibblock">
Mohammad Hossin and Md Nasir Sulaiman. 2015.

</span>
<span class="ltx_bibblock">A review on evaluation metrics for data classification evaluations.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">International journal of data mining &amp; knowledge management process</em> 5, 2 (2015), 1.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang et al<span class="ltx_text" id="bib.bib19.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Albert Q Jiang, Alexandre Sablayrolles, Arthur Mensch, Chris Bamford, Devendra Singh Chaplot, Diego de las Casas, Florian Bressand, Gianna Lengyel, Guillaume Lample, Lucile Saulnier, et al<span class="ltx_text" id="bib.bib19.3.1">.</span> 2023.

</span>
<span class="ltx_bibblock">Mistral 7B.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.4.1">arXiv preprint arXiv:2310.06825</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Johnson et al<span class="ltx_text" id="bib.bib20.2.2.1">.</span> (2016)</span>
<span class="ltx_bibblock">
Alistair EW Johnson, Tom J Pollard, Lu Shen, Li-wei H Lehman, Mengling Feng, Mohammad Ghassemi, Benjamin Moody, Peter Szolovits, Leo Anthony Celi, and Roger G Mark. 2016.

</span>
<span class="ltx_bibblock">MIMIC-III, a freely accessible critical care database.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib20.3.1">Scientific data</em> 3, 1 (2016), 1–9.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span class="ltx_text" id="bib.bib21.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Yikuan Li, Shishir Rao, José Roberto Ayala Solares, Abdelaali Hassaine, Rema Ramakrishnan, Dexter Canoy, Yajie Zhu, Kazem Rahimi, and Gholamreza Salimi-Khorshidi. 2020.

</span>
<span class="ltx_bibblock">BEHRT: transformer for electronic health records.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib21.3.1">Scientific reports</em> 10, 1 (2020), 7155.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liang et al<span class="ltx_text" id="bib.bib22.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Paul Pu Liang, Yun Cheng, Xiang Fan, Chun Kai Ling, Suzanne Nie, Richard Chen, Zihao Deng, Faisal Mahmood, Ruslan Salakhutdinov, and Louis-Philippe Morency. 2023.

</span>
<span class="ltx_bibblock">Quantifying &amp; modeling feature interactions: An information decomposition framework.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib22.3.1">arXiv e-prints</em> (2023), arXiv–2302.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lipton et al<span class="ltx_text" id="bib.bib23.2.2.1">.</span> (2014)</span>
<span class="ltx_bibblock">
Zachary C Lipton, Charles Elkan, and Balakrishnan Naryanaswamy. 2014.

</span>
<span class="ltx_bibblock">Optimal thresholding of classifiers to maximize F1 measure. In <em class="ltx_emph ltx_font_italic" id="bib.bib23.3.1">Machine Learning and Knowledge Discovery in Databases: European Conference, ECML PKDD 2014, Nancy, France, September 15-19, 2014. Proceedings, Part II 14</em>. Springer, 225–239.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al<span class="ltx_text" id="bib.bib24.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Yinhan Liu, Myle Ott, Naman Goyal, Jingfei Du, Mandar Joshi, Danqi Chen, Omer Levy, Mike Lewis, Luke Zettlemoyer, and Veselin Stoyanov. 2019.

</span>
<span class="ltx_bibblock">Roberta: A robustly optimized bert pretraining approach.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib24.3.1">arXiv preprint arXiv:1907.11692</em> (2019).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Luo et al<span class="ltx_text" id="bib.bib25.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Junyu Luo, Muchao Ye, Cao Xiao, and Fenglong Ma. 2020.

</span>
<span class="ltx_bibblock">Hitanet: Hierarchical time-aware attention networks for risk prediction on electronic health records. In <em class="ltx_emph ltx_font_italic" id="bib.bib25.3.1">Proceedings of the 26th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining</em>. 647–656.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ma et al<span class="ltx_text" id="bib.bib26.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Fenglong Ma, Radha Chitta, Jing Zhou, Quanzeng You, Tong Sun, and Jing Gao. 2017.

</span>
<span class="ltx_bibblock">Dipole: Diagnosis prediction in healthcare via attention-based bidirectional recurrent neural networks. In <em class="ltx_emph ltx_font_italic" id="bib.bib26.3.1">Proceedings of the 23rd ACM SIGKDD international conference on knowledge discovery and data mining</em>. 1903–1911.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Palacio-Niño and Berzal (2019)</span>
<span class="ltx_bibblock">
Julio-Omar Palacio-Niño and Fernando Berzal. 2019.

</span>
<span class="ltx_bibblock">Evaluation metrics for unsupervised learning algorithms.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">arXiv preprint arXiv:1905.05667</em> (2019).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Restrepo et al<span class="ltx_text" id="bib.bib28.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
David Restrepo, Chenwei Wu, Constanza Vásquez-Venegas, Luis Filipe Nakayama, Leo Anthony Celi, and Diego M López. 2024.

</span>
<span class="ltx_bibblock">DF-DM: A foundational process model for multimodal data fusion in the artificial intelligence era.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib28.3.1">arXiv preprint arXiv:2404.12278</em> (2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">ruslanmv (2024)</span>
<span class="ltx_bibblock">
ruslanmv. 2024.

</span>
<span class="ltx_bibblock">Medical-Llama3-8B-16bit: Fine-Tuned Llama3 for Medical Q&amp;A.

</span>
<span class="ltx_bibblock">(2024).

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://huggingface.co/ruslanmv/Medical-Llama3-8B" title="">https://huggingface.co/ruslanmv/Medical-Llama3-8B</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Song et al<span class="ltx_text" id="bib.bib30.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Xingchen Song, Di Wu, Binbin Zhang, Zhendong Peng, Bo Dang, Fuping Pan, and Zhiyong Wu. 2023.

</span>
<span class="ltx_bibblock">Zeroprompt: Streaming acoustic encoders are zero-shot masked lms.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib30.3.1">arXiv preprint arXiv:2305.10649</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Thirunavukarasu et al<span class="ltx_text" id="bib.bib31.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Arun James Thirunavukarasu, Darren Shu Jeng Ting, Kabilan Elangovan, Laura Gutierrez, Ting Fang Tan, and Daniel Shu Wei Ting. 2023.

</span>
<span class="ltx_bibblock">Large language models in medicine.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib31.3.1">Nature medicine</em> 29, 8 (2023), 1930–1940.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et al<span class="ltx_text" id="bib.bib32.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Hugo Touvron, Louis Martin, Kevin Stone, Peter Albert, Amjad Almahairi, Yasmine Babaei, Nikolay Bashlykov, Soumya Batra, Prajjwal Bhargava, Shruti Bhosale, et al<span class="ltx_text" id="bib.bib32.3.1">.</span> 2023.

</span>
<span class="ltx_bibblock">Llama 2: Open foundation and fine-tuned chat models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib32.4.1">arXiv preprint arXiv:2307.09288</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al<span class="ltx_text" id="bib.bib33.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Haoran Wu, Wei Chen, Shuang Xu, and Bo Xu. 2021.

</span>
<span class="ltx_bibblock">Counterfactual supporting facts extraction for explainable medical record based diagnosis with graph network. In <em class="ltx_emph ltx_font_italic" id="bib.bib33.3.1">Proceedings of the 2021 conference of the north American chapter of the association for computational linguistics: human language technologies</em>. 1942–1955.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al<span class="ltx_text" id="bib.bib34.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Xianli Zhang, Buyue Qian, Shilei Cao, Yang Li, Hang Chen, Yefeng Zheng, and Ian Davidson. 2020.

</span>
<span class="ltx_bibblock">INPREM: An interpretable and trustworthy predictive model for healthcare. In <em class="ltx_emph ltx_font_italic" id="bib.bib34.3.1">Proceedings of the 26th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining</em>. 450–460.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al<span class="ltx_text" id="bib.bib35.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Yilan Zhang, Yingxue Xu, Jianqi Chen, Fengying Xie, and Hao Chen. 2024.

</span>
<span class="ltx_bibblock">Prototypical Information Bottlenecking and Disentangling for Multimodal Cancer Survival Prediction.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib35.3.1">arXiv preprint arXiv:2401.01646</em> (2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zheng et al<span class="ltx_text" id="bib.bib36.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Lijuan Zheng, Zihan Wang, Junqiang Liang, Shifan Luo, and Senping Tian. 2021.

</span>
<span class="ltx_bibblock">Effective compression and classification of ECG arrhythmia by singular value decomposition.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib36.3.1">Biomedical Engineering Advances</em> 2 (2021), 100013.

</span>
<span class="ltx_bibblock">
</span>
</li>
</ul>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Wed Jul 17 04:10:40 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
