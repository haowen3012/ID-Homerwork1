<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>CodeGRAG: Bridging the Gap between Natural Language and Programming Language via Graphical Retrieval Augmented Generation</title>
<!--Generated on Wed Oct  2 14:35:11 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2405.02355v2/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#S1" title="In CodeGRAG: Bridging the Gap between Natural Language and Programming Language via Graphical Retrieval Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#S2" title="In CodeGRAG: Bridging the Gap between Natural Language and Programming Language via Graphical Retrieval Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Methodology</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#S2.SS1" title="In 2 Methodology ‣ CodeGRAG: Bridging the Gap between Natural Language and Programming Language via Graphical Retrieval Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Overview</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#S2.SS2" title="In 2 Methodology ‣ CodeGRAG: Bridging the Gap between Natural Language and Programming Language via Graphical Retrieval Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Graphical Knowledge Base Preparation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#S2.SS3" title="In 2 Methodology ‣ CodeGRAG: Bridging the Gap between Natural Language and Programming Language via Graphical Retrieval Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3 </span>Knowledge Querying</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#S2.SS3.SSS1" title="In 2.3 Knowledge Querying ‣ 2 Methodology ‣ CodeGRAG: Bridging the Gap between Natural Language and Programming Language via Graphical Retrieval Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3.1 </span>Query Extractor</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#S2.SS3.SSS2" title="In 2.3 Knowledge Querying ‣ 2 Methodology ‣ CodeGRAG: Bridging the Gap between Natural Language and Programming Language via Graphical Retrieval Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3.2 </span>Retriever</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#S2.SS4" title="In 2 Methodology ‣ CodeGRAG: Bridging the Gap between Natural Language and Programming Language via Graphical Retrieval Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.4 </span>Graphical Knowledge Augmented Generation</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#S2.SS4.SSS1" title="In 2.4 Graphical Knowledge Augmented Generation ‣ 2 Methodology ‣ CodeGRAG: Bridging the Gap between Natural Language and Programming Language via Graphical Retrieval Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.4.1 </span>Hard Meta-Graph Prompt</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#S2.SS4.SSS2" title="In 2.4 Graphical Knowledge Augmented Generation ‣ 2 Methodology ‣ CodeGRAG: Bridging the Gap between Natural Language and Programming Language via Graphical Retrieval Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.4.2 </span>Soft Prompting with the Expert</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#S3" title="In CodeGRAG: Bridging the Gap between Natural Language and Programming Language via Graphical Retrieval Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#S3.SS1" title="In 3 Experiments ‣ CodeGRAG: Bridging the Gap between Natural Language and Programming Language via Graphical Retrieval Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Setup</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#S3.SS2" title="In 3 Experiments ‣ CodeGRAG: Bridging the Gap between Natural Language and Programming Language via Graphical Retrieval Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Main Results</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#S3.SS3" title="In 3 Experiments ‣ CodeGRAG: Bridging the Gap between Natural Language and Programming Language via Graphical Retrieval Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Impacts of the pretraining objectives for the expert GNN (<span class="ltx_text ltx_font_bold">RQ4</span>)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#S3.SS4" title="In 3 Experiments ‣ CodeGRAG: Bridging the Gap between Natural Language and Programming Language via Graphical Retrieval Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4 </span>Impacts of the Components of the Graphical View (<span class="ltx_text ltx_font_bold">RQ5</span>)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#S3.SS5" title="In 3 Experiments ‣ CodeGRAG: Bridging the Gap between Natural Language and Programming Language via Graphical Retrieval Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.5 </span>Compatibility Discussion of the Graphical Views(<span class="ltx_text ltx_font_bold">RQ6</span>)</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#S4" title="In CodeGRAG: Bridging the Gap between Natural Language and Programming Language via Graphical Retrieval Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Related Work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#S5" title="In CodeGRAG: Bridging the Gap between Natural Language and Programming Language via Graphical Retrieval Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#A1" title="In CodeGRAG: Bridging the Gap between Natural Language and Programming Language via Graphical Retrieval Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Appendix</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">CodeGRAG: Bridging the Gap between Natural Language and Programming Language via Graphical Retrieval Augmented Generation</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Kounianhua Du<sup class="ltx_sup" id="id13.13.id1">1</sup>, Jizheng Chen<sup class="ltx_sup" id="id14.14.id2">1</sup>, Renting Rui<sup class="ltx_sup" id="id15.15.id3">1</sup>, Huacan Chai<sup class="ltx_sup" id="id16.16.id4">1</sup>, Lingyue Fu<sup class="ltx_sup" id="id17.17.id5">1</sup>, 
<br class="ltx_break"/><span class="ltx_text ltx_font_bold" id="id11.11.6">Wei Xia<sup class="ltx_sup" id="id11.11.6.1"><span class="ltx_text ltx_font_medium" id="id11.11.6.1.1">2</span></sup>, Yasheng Wang<sup class="ltx_sup" id="id11.11.6.2"><span class="ltx_text ltx_font_medium" id="id11.11.6.2.1">2</span></sup>, Ruiming Tang<sup class="ltx_sup" id="id11.11.6.3"><span class="ltx_text ltx_font_medium" id="id11.11.6.3.1">2</span></sup>, Yong Yu<sup class="ltx_sup" id="id11.11.6.4"><span class="ltx_text ltx_font_medium" id="id11.11.6.4.1">1</span></sup>, Weinan Zhang<sup class="ltx_sup" id="id11.11.6.5"><span class="ltx_text ltx_font_medium" id="id11.11.6.5.1">1</span></sup>
<br class="ltx_break"/><sup class="ltx_sup" id="id11.11.6.6"><span class="ltx_text ltx_font_medium" id="id11.11.6.6.1">1</span></sup></span>Shanghai Jiao Tong University, <sup class="ltx_sup" id="id18.18.id6">2</sup> Huawei Noah’s Ark Lab 
<br class="ltx_break"/>Shanghai, China
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id19.19.id7">{kounianhuadu, wnzhang}@sjtu.edu.cn</span>
</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id20.id1">Utilizing large language models to generate codes has shown promising meaning in software development revolution. Despite the intelligence shown by the general large language models, their specificity in code generation can still be improved due to the syntactic gap and mismatched vocabulary existing among natural language and different programming languages. In this paper, we propose CodeGRAG, a Graphical Retrieval Augmented Code Generation framework to enhance the performance of LLMs. CodeGRAG builds the graphical view of code blocks based on the control flow and data flow of them to fill the gap between programming languages and natural language, which can facilitate natural language based LLMs for better understanding of code syntax and serve as a bridge among different programming languages. To take the extracted structural knowledge into the foundation models, we propose 1) a hard meta-graph prompt template to transform the challenging graphical representation into informative knowledge for tuning-free models and 2) a soft prompting technique that injects the domain knowledge of programming languages into the model parameters via finetuning the models with the help of a pretrained GNN expert model. Various experiments and ablations are done on four datasets including both the C++ and python languages to validate the hard meta-graph prompt, the soft prompting technique, and the effectiveness of the objectives for pretrained GNN expert.
CodeGRAG improves the code generation ability of LLMs and can even offer performance gain for cross-lingual code generation. The implementation is available at https://anonymous.4open.science/r/Code-5970/ .</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para ltx_noindent" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">In recent years, large language models (LLMs) <cite class="ltx_cite ltx_citemacro_citep">(Achiam et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#bib.bib1" title="">2023</a>; Touvron et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#bib.bib28" title="">2023a</a>)</cite> have shown great impact in various domains. Automated code generation emerges as a captivating frontier <cite class="ltx_cite ltx_citemacro_citep">(Zheng et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#bib.bib32" title="">2023</a>; Roziere et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#bib.bib25" title="">2023</a>; Shen et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#bib.bib26" title="">2023</a>)</cite>, promising to revolutionize software development by enabling machines to write and optimize code with minimal human intervention.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">However, syntactic gap and mismatched vocabulary among natural language (NL) and programming languages (PL) exist, hindering LLM’s performance on code generation. As illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ CodeGRAG: Bridging the Gap between Natural Language and Programming Language via Graphical Retrieval Augmented Generation"><span class="ltx_text ltx_ref_tag">1</span></a>, programming language (marked in blue) contains special tokens such as “int” or “++” that natural language (marked in yellow) doesn’t possess, leading to vocabulary mismatch. Besides, the relations between tokens in programming languages are often structural, e.g., the complex branching and jumps, whereas natural language is arranged simply in sequential manner, leading to syntactic gap. For example, in the control flow graph of the raw code (marked in pink), two “if” blocks (marked in purple) are adjacent and are executed sequentially under certain condition, but they appear to be intervaled in raw textual code.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">As discussed above, the innate structures of programming languages are different from that of the sequential-based natural language. The challenges of enhancing a general-purposed large language models for code-related tasks can be summarized into two folds.</p>
</div>
<figure class="ltx_figure ltx_align_floatright" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="560" id="S1.F1.g1" src="x1.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Illustration of the gap between the programming language and the natural language.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S1.p4">
<p class="ltx_p" id="S1.p4.1"><span class="ltx_text ltx_font_bold" id="S1.p4.1.1">(C1)</span> How to solve the gap between different languages and better interpret the inherent logic of code blocks. Code, unlike natural language, possesses a well-defined structure that governs its syntax and semantics. This structure provides valuable information about the relationships between different parts of the code, the flow of execution, and the overall organization of the functions <cite class="ltx_cite ltx_citemacro_cite">Jiang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#bib.bib18" title="">2021</a>); Guo et al. (<a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#bib.bib14" title="">2020</a>)</cite>. General-purpose LLMs regard a code block as a sequence of tokens. By ignoring the inherent structure of codes, they miss out on essential cues that could help them better understand and generate code. In addition, the multi-lingual code generation abilities of LLMs is challenging due to the gap among different programming languages.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p5">
<p class="ltx_p" id="S1.p5.1"><span class="ltx_text ltx_font_bold" id="S1.p5.1.1">(C2)</span> How to inject the innate knowledge of programming languages into general purpose large language models for enhancement. Despite the well representation of the programming knowledge, the ways to inject the knowledge into the NL-based foundation models is also challenging. The structural representation of codes could be hard to understand, which
poses a challenge to the capability of the foundation models.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">To solve the above challenges, we propose CodeGRAG, a graphical retrieval augmented generation framework for code generation. For <span class="ltx_text ltx_font_bold" id="S1.p6.1.1">(C1)</span>, we propose to interpret the code blocks using the composed graph based on the data-flow and control-flow of the code block, which extracts both the semantic level and the logical level information of the code. The composed graphical view could 1) better capture the innate structural knowledge of codes for NL-based language models to understand and 2) model the innate function of code blocks that bridging different programming languages. For <span class="ltx_text ltx_font_bold" id="S1.p6.1.2">(C2)</span>, we propose a meta-graph prompting technique for tuning-free models and a soft-prompting technique for tuned models. The meta-graph prompt summarizes the overall information of the extracted graphical view and transforms the challenging and noisy graphical representation into informative knowledge. The soft-prompting technique deals with the graphical view of codes with a pretrained GNN expert network and inject the processed knowledge embedding into the parameters of the general-purpose foundation models with the help of supervised finetuning.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p7">
<p class="ltx_p" id="S1.p7.1">The main contributions of the paper can be summarized as follows:</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i1.p1.1.1">Novel GraphRAG framework for code generation.</span> We propose CodeGRAG that bridges the gap among natural language and programming languages, transfers knowledge among different programming languages, and enhances the ability of LLMs for code generation. CodeGRAG requires only one calling of LLMs and can offer multi-lingual enhancement.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i2.p1.1.1">Effective graphical view to inform and stimulate the structural programming knowledge of LLMs.</span> We propose an effective graphical view to purify the semantic and logic knowledge from the code space, which offers more useful information than the raw code block and can summarize the cross-lingual knowledge.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i3.p1.1.1">Effective soft prompting technique to preserve the programming domain knowledge and inject it into LLMs parameters.</span> We propose an effective soft prompting technique, which injects the domain knowledge of programming languages into the model parameters via finetuning LLMs with the assistance of a pretrained GNN expert model.
</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Methodology</h2>
<figure class="ltx_figure" id="S2.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="431" id="S2.F2.g1" src="x2.png" width="761"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Overview of CodeGRAG. <span class="ltx_text ltx_font_bold" id="S2.F2.3.1">(Top) Knowledge Preparation.</span> We extract the control flow and data flow of each external code block and compose them using the read-write signal to obtain the semantic and logical expression of each code block, which is then abstracted into graphical view as hard knowledge document and embedded into GraphEmb as soft knowledge document. The GraphEmb is encoded by a pretrained GNN expert model constrained by the alignment and structure preserving objectives. <span class="ltx_text ltx_font_bold" id="S2.F2.4.2">(Bottem) Retrieval Augmented Generation.</span> We extract query from the task input and retrieve from the external corpus. For tuning free models, we use the hard graphical view to stimulate the structural programming knowledge of LLMs for enhanced generation. For tunable models, we use the soft GraphEmb and inject the programming domain knowledge into LLMs parameters via finetuning them with the GNN expert signals. The expert signals informed LLMs can then produce enhanced generation.
</figcaption>
</figure>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Overview</h3>
<div class="ltx_para ltx_noindent" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">In this paper, we leverage both generative models and retrieval models to produce results that are both coherent and informed by the expert graphical knowledge of programming language.
The overall process of CodeGRAG is illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#S2.F2" title="Figure 2 ‣ 2 Methodology ‣ CodeGRAG: Bridging the Gap between Natural Language and Programming Language via Graphical Retrieval Augmented Generation"><span class="ltx_text ltx_ref_tag">2</span></a>, which mainly consists of three stages: graphical knowledge base preparation, knowledge querying, and graphical knowledge augmented generation.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Graphical Knowledge Base Preparation</h3>
<div class="ltx_para ltx_noindent" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">In this section, we discuss how to extract informative graphical views for code blocks.
We analyze the syntax and control information of code blocks and extract their graphical views to better represent the codes. This process can be formulated as, <math alttext="\forall c_{i}\in D_{\text{pool}}" class="ltx_Math" display="inline" id="S2.SS2.p1.1.m1.1"><semantics id="S2.SS2.p1.1.m1.1a"><mrow id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml"><mrow id="S2.SS2.p1.1.m1.1.1.2" xref="S2.SS2.p1.1.m1.1.1.2.cmml"><mo id="S2.SS2.p1.1.m1.1.1.2.1" rspace="0.167em" xref="S2.SS2.p1.1.m1.1.1.2.1.cmml">∀</mo><msub id="S2.SS2.p1.1.m1.1.1.2.2" xref="S2.SS2.p1.1.m1.1.1.2.2.cmml"><mi id="S2.SS2.p1.1.m1.1.1.2.2.2" xref="S2.SS2.p1.1.m1.1.1.2.2.2.cmml">c</mi><mi id="S2.SS2.p1.1.m1.1.1.2.2.3" xref="S2.SS2.p1.1.m1.1.1.2.2.3.cmml">i</mi></msub></mrow><mo id="S2.SS2.p1.1.m1.1.1.1" xref="S2.SS2.p1.1.m1.1.1.1.cmml">∈</mo><msub id="S2.SS2.p1.1.m1.1.1.3" xref="S2.SS2.p1.1.m1.1.1.3.cmml"><mi id="S2.SS2.p1.1.m1.1.1.3.2" xref="S2.SS2.p1.1.m1.1.1.3.2.cmml">D</mi><mtext id="S2.SS2.p1.1.m1.1.1.3.3" xref="S2.SS2.p1.1.m1.1.1.3.3a.cmml">pool</mtext></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.1b"><apply id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1"><in id="S2.SS2.p1.1.m1.1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1.1"></in><apply id="S2.SS2.p1.1.m1.1.1.2.cmml" xref="S2.SS2.p1.1.m1.1.1.2"><csymbol cd="latexml" id="S2.SS2.p1.1.m1.1.1.2.1.cmml" xref="S2.SS2.p1.1.m1.1.1.2.1">for-all</csymbol><apply id="S2.SS2.p1.1.m1.1.1.2.2.cmml" xref="S2.SS2.p1.1.m1.1.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.1.m1.1.1.2.2.1.cmml" xref="S2.SS2.p1.1.m1.1.1.2.2">subscript</csymbol><ci id="S2.SS2.p1.1.m1.1.1.2.2.2.cmml" xref="S2.SS2.p1.1.m1.1.1.2.2.2">𝑐</ci><ci id="S2.SS2.p1.1.m1.1.1.2.2.3.cmml" xref="S2.SS2.p1.1.m1.1.1.2.2.3">𝑖</ci></apply></apply><apply id="S2.SS2.p1.1.m1.1.1.3.cmml" xref="S2.SS2.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p1.1.m1.1.1.3.1.cmml" xref="S2.SS2.p1.1.m1.1.1.3">subscript</csymbol><ci id="S2.SS2.p1.1.m1.1.1.3.2.cmml" xref="S2.SS2.p1.1.m1.1.1.3.2">𝐷</ci><ci id="S2.SS2.p1.1.m1.1.1.3.3a.cmml" xref="S2.SS2.p1.1.m1.1.1.3.3"><mtext id="S2.SS2.p1.1.m1.1.1.3.3.cmml" mathsize="70%" xref="S2.SS2.p1.1.m1.1.1.3.3">pool</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.1c">\forall c_{i}\in D_{\text{pool}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.1.m1.1d">∀ italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ italic_D start_POSTSUBSCRIPT pool end_POSTSUBSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx1">
<tbody id="S2.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle g_{i}\xleftarrow{}\text{GraphExtractor}(c_{i})," class="ltx_Math" display="inline" id="S2.E1.m1.1"><semantics id="S2.E1.m1.1a"><mrow id="S2.E1.m1.1.1.1" xref="S2.E1.m1.1.1.1.1.cmml"><mrow id="S2.E1.m1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.cmml"><msub id="S2.E1.m1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.3.cmml"><mi id="S2.E1.m1.1.1.1.1.3.2" xref="S2.E1.m1.1.1.1.1.3.2.cmml">g</mi><mi id="S2.E1.m1.1.1.1.1.3.3" xref="S2.E1.m1.1.1.1.1.3.3.cmml">i</mi></msub><mover accent="true" id="S2.E1.m1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.2.cmml"><mo id="S2.E1.m1.1.1.1.1.2.2" stretchy="false" xref="S2.E1.m1.1.1.1.1.2.2.cmml">←</mo><mi id="S2.E1.m1.1.1.1.1.2.1" xref="S2.E1.m1.1.1.1.1.2.1.cmml"></mi></mover><mrow id="S2.E1.m1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.cmml"><mtext id="S2.E1.m1.1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.1.3a.cmml">GraphExtractor</mtext><mo id="S2.E1.m1.1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E1.m1.1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E1.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E1.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.E1.m1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.1.1.1.1.2.cmml">c</mi><mi id="S2.E1.m1.1.1.1.1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.E1.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E1.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E1.m1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.1b"><apply id="S2.E1.m1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1"><apply id="S2.E1.m1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.2"><csymbol cd="latexml" id="S2.E1.m1.1.1.1.1.2.1.cmml" xref="S2.E1.m1.1.1.1.1.2.1">absent</csymbol><ci id="S2.E1.m1.1.1.1.1.2.2.cmml" xref="S2.E1.m1.1.1.1.1.2.2">←</ci></apply><apply id="S2.E1.m1.1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.1.1.1.1.3">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.1.1.1.1.3.2">𝑔</ci><ci id="S2.E1.m1.1.1.1.1.3.3.cmml" xref="S2.E1.m1.1.1.1.1.3.3">𝑖</ci></apply><apply id="S2.E1.m1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1"><times id="S2.E1.m1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.1.2"></times><ci id="S2.E1.m1.1.1.1.1.1.3a.cmml" xref="S2.E1.m1.1.1.1.1.1.3"><mtext id="S2.E1.m1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.1.3">GraphExtractor</mtext></ci><apply id="S2.E1.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.2">𝑐</ci><ci id="S2.E1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.1c">\displaystyle g_{i}\xleftarrow{}\text{GraphExtractor}(c_{i}),</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.1d">italic_g start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_ARROW start_OVERACCENT end_OVERACCENT ← end_ARROW GraphExtractor ( italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
<tbody id="S2.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\text{KB.append}(\langle c_{i},g_{i}\rangle)," class="ltx_Math" display="inline" id="S2.E2.m1.1"><semantics id="S2.E2.m1.1a"><mrow id="S2.E2.m1.1.1.1" xref="S2.E2.m1.1.1.1.1.cmml"><mrow id="S2.E2.m1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.cmml"><mtext id="S2.E2.m1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.3a.cmml">KB.append</mtext><mo id="S2.E2.m1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E2.m1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.cmml"><mo id="S2.E2.m1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E2.m1.1.1.1.1.cmml">(</mo><mrow id="S2.E2.m1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.1.1.1.3.cmml"><mo id="S2.E2.m1.1.1.1.1.1.1.1.2.3" stretchy="false" xref="S2.E2.m1.1.1.1.1.1.1.1.3.cmml">⟨</mo><msub id="S2.E2.m1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E2.m1.1.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.cmml">c</mi><mi id="S2.E2.m1.1.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.E2.m1.1.1.1.1.1.1.1.2.4" xref="S2.E2.m1.1.1.1.1.1.1.1.3.cmml">,</mo><msub id="S2.E2.m1.1.1.1.1.1.1.1.2.2" xref="S2.E2.m1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S2.E2.m1.1.1.1.1.1.1.1.2.2.2" xref="S2.E2.m1.1.1.1.1.1.1.1.2.2.2.cmml">g</mi><mi id="S2.E2.m1.1.1.1.1.1.1.1.2.2.3" xref="S2.E2.m1.1.1.1.1.1.1.1.2.2.3.cmml">i</mi></msub><mo id="S2.E2.m1.1.1.1.1.1.1.1.2.5" stretchy="false" xref="S2.E2.m1.1.1.1.1.1.1.1.3.cmml">⟩</mo></mrow><mo id="S2.E2.m1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E2.m1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.1b"><apply id="S2.E2.m1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1"><times id="S2.E2.m1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.2"></times><ci id="S2.E2.m1.1.1.1.1.3a.cmml" xref="S2.E2.m1.1.1.1.1.3"><mtext id="S2.E2.m1.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.3">KB.append</mtext></ci><list id="S2.E2.m1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.2"><apply id="S2.E2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.2">𝑐</ci><ci id="S2.E2.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S2.E2.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.2.2.2">𝑔</ci><ci id="S2.E2.m1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.1c">\displaystyle\text{KB.append}(\langle c_{i},g_{i}\rangle),</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.1d">KB.append ( ⟨ italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_g start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ⟩ ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS2.p1.3">where <math alttext="c_{i}" class="ltx_Math" display="inline" id="S2.SS2.p1.2.m1.1"><semantics id="S2.SS2.p1.2.m1.1a"><msub id="S2.SS2.p1.2.m1.1.1" xref="S2.SS2.p1.2.m1.1.1.cmml"><mi id="S2.SS2.p1.2.m1.1.1.2" xref="S2.SS2.p1.2.m1.1.1.2.cmml">c</mi><mi id="S2.SS2.p1.2.m1.1.1.3" xref="S2.SS2.p1.2.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.2.m1.1b"><apply id="S2.SS2.p1.2.m1.1.1.cmml" xref="S2.SS2.p1.2.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.2.m1.1.1.1.cmml" xref="S2.SS2.p1.2.m1.1.1">subscript</csymbol><ci id="S2.SS2.p1.2.m1.1.1.2.cmml" xref="S2.SS2.p1.2.m1.1.1.2">𝑐</ci><ci id="S2.SS2.p1.2.m1.1.1.3.cmml" xref="S2.SS2.p1.2.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.2.m1.1c">c_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.2.m1.1d">italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is the raw code block and <math alttext="g_{i}" class="ltx_Math" display="inline" id="S2.SS2.p1.3.m2.1"><semantics id="S2.SS2.p1.3.m2.1a"><msub id="S2.SS2.p1.3.m2.1.1" xref="S2.SS2.p1.3.m2.1.1.cmml"><mi id="S2.SS2.p1.3.m2.1.1.2" xref="S2.SS2.p1.3.m2.1.1.2.cmml">g</mi><mi id="S2.SS2.p1.3.m2.1.1.3" xref="S2.SS2.p1.3.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.3.m2.1b"><apply id="S2.SS2.p1.3.m2.1.1.cmml" xref="S2.SS2.p1.3.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.3.m2.1.1.1.cmml" xref="S2.SS2.p1.3.m2.1.1">subscript</csymbol><ci id="S2.SS2.p1.3.m2.1.1.2.cmml" xref="S2.SS2.p1.3.m2.1.1.2">𝑔</ci><ci id="S2.SS2.p1.3.m2.1.1.3.cmml" xref="S2.SS2.p1.3.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.3.m2.1c">g_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.3.m2.1d">italic_g start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is the corresponding extracted graphical view.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS2.p2">
<p class="ltx_p" id="S2.SS2.p2.1">To capture both the semantic and the logical information, we propose to combine the data flow graph <cite class="ltx_cite ltx_citemacro_citep">(Aho et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#bib.bib2" title="">2006</a>)</cite> and the control flow graph <cite class="ltx_cite ltx_citemacro_citep">(Allen, <a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#bib.bib4" title="">1970</a>)</cite> with the read-write signals <cite class="ltx_cite ltx_citemacro_citep">(Long et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#bib.bib20" title="">2022</a>)</cite> to represent the code blocks, both of them are constructed on the base of the abstract syntax tree.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS2.p3">
<p class="ltx_p" id="S2.SS2.p3.1"><span class="ltx_text ltx_font_bold" id="S2.SS2.p3.1.1">Abstract Syntax Tree (AST).</span> An abstract syntax tree (AST) is a tree data structure that represents the abstract syntactic structure of source code. An AST is constructed by a parser, which reads the source code and creates a tree of nodes. Each node in the tree represents a syntactic construct in the source code, such as a statement, an expression, or a declaration. ASTs are used in a variety of compiler construction and program analysis tasks, including: parsing, type checking, optimization, and program analysis. ASTs have good compactness and can represent the structure of the source code in a clear and concise way.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS2.p4">
<p class="ltx_p" id="S2.SS2.p4.1"><span class="ltx_text ltx_font_bold" id="S2.SS2.p4.1.1">Data Flow Graph (DFG).</span> The data flow graph (DFG) is a graphical representation of the flow of data dependencies within a program. It is a directed graph that models how data is transformed and propagated through different parts of a program. In DFG,
nodes are operands and edges indicate data flows.
Two types of edges are considered: 1) operation edges that
connect the nodes to be operated and the nodes that receive the operation results; 2) function edges that indicate data flows for function calls and returns. These edges connect nodes, including non-temporary operands and temporary operands, which refer to variables and constants that explicitly exist in the source code, and variables existing only in execution, respectively.</p>
</div>
<figure class="ltx_figure" id="S2.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="249" id="S2.F3.g1" src="x3.png" width="761"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Illustration of the extracted composed syntax graph from the code block. The arrows in the bottom part indicate the names of different edges, which are extracted based on the ASTs.
</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S2.SS2.p5">
<p class="ltx_p" id="S2.SS2.p5.1"><span class="ltx_text ltx_font_bold" id="S2.SS2.p5.1.1">Control Flow Graph (CFG).</span> The control flow graph (CFG) is a graphical representation of the flow of control or the sequence of execution within a program. It is a directed graph that models the control relationships between different parts of a program. Based on compiler principles,
we slightly adjust the design of CFG to better capture the key information of the program. Nodes in CFG are operations
in the source code, including standard operations, function
calls and returns. Edges indicate the execution order of operations.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS2.p6">
<p class="ltx_p" id="S2.SS2.p6.1"><span class="ltx_text ltx_font_bold" id="S2.SS2.p6.1.1">Composed Syntax Graph.</span> A composed syntax graph composes the data flow graph and the control flow graph with the read-write flow existing in the code blocks. An illustration of the extracted composed syntax graph is displayed in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#S2.F3" title="Figure 3 ‣ 2.2 Graphical Knowledge Base Preparation ‣ 2 Methodology ‣ CodeGRAG: Bridging the Gap between Natural Language and Programming Language via Graphical Retrieval Augmented Generation"><span class="ltx_text ltx_ref_tag">3</span></a>. Different edge types along with their concrete names are given in colors. As for the node names, the middle figure displays the concrete types of nodes (operands) and the right figure displays the properties of nodes.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS2.p7">
<p class="ltx_p" id="S2.SS2.p7.1">An illustration of the composed graphical view is given in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#S2.F3" title="Figure 3 ‣ 2.2 Graphical Knowledge Base Preparation ‣ 2 Methodology ‣ CodeGRAG: Bridging the Gap between Natural Language and Programming Language via Graphical Retrieval Augmented Generation"><span class="ltx_text ltx_ref_tag">3</span></a>.
After obtaining the composed syntax graphs for code blocks in the retrieval pool, we use them to inform the general-purpose LLMs to bridge the gap between NL and PLs, where both the semantic level and the logic level information are preserved.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Knowledge Querying</h3>
<div class="ltx_para ltx_noindent" id="S2.SS3.p1">
<p class="ltx_p" id="S2.SS3.p1.4">Given a target problem to be completed, we generate informative query of it and use it to retrieve graphical knowledge from the constructed knowledge base. The process can be formulated as:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx2">
<tbody id="S2.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle q\xleftarrow{}\text{QueryExtractor}(p)," class="ltx_Math" display="inline" id="S2.E3.m1.2"><semantics id="S2.E3.m1.2a"><mrow id="S2.E3.m1.2.2.1" xref="S2.E3.m1.2.2.1.1.cmml"><mrow id="S2.E3.m1.2.2.1.1" xref="S2.E3.m1.2.2.1.1.cmml"><mi id="S2.E3.m1.2.2.1.1.2" xref="S2.E3.m1.2.2.1.1.2.cmml">q</mi><mover accent="true" id="S2.E3.m1.2.2.1.1.1" xref="S2.E3.m1.2.2.1.1.1.cmml"><mo id="S2.E3.m1.2.2.1.1.1.2" stretchy="false" xref="S2.E3.m1.2.2.1.1.1.2.cmml">←</mo><mi id="S2.E3.m1.2.2.1.1.1.1" xref="S2.E3.m1.2.2.1.1.1.1.cmml"></mi></mover><mrow id="S2.E3.m1.2.2.1.1.3" xref="S2.E3.m1.2.2.1.1.3.cmml"><mtext id="S2.E3.m1.2.2.1.1.3.2" xref="S2.E3.m1.2.2.1.1.3.2a.cmml">QueryExtractor</mtext><mo id="S2.E3.m1.2.2.1.1.3.1" xref="S2.E3.m1.2.2.1.1.3.1.cmml">⁢</mo><mrow id="S2.E3.m1.2.2.1.1.3.3.2" xref="S2.E3.m1.2.2.1.1.3.cmml"><mo id="S2.E3.m1.2.2.1.1.3.3.2.1" stretchy="false" xref="S2.E3.m1.2.2.1.1.3.cmml">(</mo><mi id="S2.E3.m1.1.1" xref="S2.E3.m1.1.1.cmml">p</mi><mo id="S2.E3.m1.2.2.1.1.3.3.2.2" stretchy="false" xref="S2.E3.m1.2.2.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E3.m1.2.2.1.2" xref="S2.E3.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.2b"><apply id="S2.E3.m1.2.2.1.1.cmml" xref="S2.E3.m1.2.2.1"><apply id="S2.E3.m1.2.2.1.1.1.cmml" xref="S2.E3.m1.2.2.1.1.1"><csymbol cd="latexml" id="S2.E3.m1.2.2.1.1.1.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1">absent</csymbol><ci id="S2.E3.m1.2.2.1.1.1.2.cmml" xref="S2.E3.m1.2.2.1.1.1.2">←</ci></apply><ci id="S2.E3.m1.2.2.1.1.2.cmml" xref="S2.E3.m1.2.2.1.1.2">𝑞</ci><apply id="S2.E3.m1.2.2.1.1.3.cmml" xref="S2.E3.m1.2.2.1.1.3"><times id="S2.E3.m1.2.2.1.1.3.1.cmml" xref="S2.E3.m1.2.2.1.1.3.1"></times><ci id="S2.E3.m1.2.2.1.1.3.2a.cmml" xref="S2.E3.m1.2.2.1.1.3.2"><mtext id="S2.E3.m1.2.2.1.1.3.2.cmml" xref="S2.E3.m1.2.2.1.1.3.2">QueryExtractor</mtext></ci><ci id="S2.E3.m1.1.1.cmml" xref="S2.E3.m1.1.1">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.2c">\displaystyle q\xleftarrow{}\text{QueryExtractor}(p),</annotation><annotation encoding="application/x-llamapun" id="S2.E3.m1.2d">italic_q start_ARROW start_OVERACCENT end_OVERACCENT ← end_ARROW QueryExtractor ( italic_p ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
<tbody id="S2.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle i\xleftarrow{\text{Top-1}}\text{Retriever}(q,KB)," class="ltx_Math" display="inline" id="S2.E4.m1.2"><semantics id="S2.E4.m1.2a"><mrow id="S2.E4.m1.2.2.1" xref="S2.E4.m1.2.2.1.1.cmml"><mrow id="S2.E4.m1.2.2.1.1" xref="S2.E4.m1.2.2.1.1.cmml"><mi id="S2.E4.m1.2.2.1.1.3" xref="S2.E4.m1.2.2.1.1.3.cmml">i</mi><mover accent="true" id="S2.E4.m1.2.2.1.1.2" xref="S2.E4.m1.2.2.1.1.2.cmml"><mo id="S2.E4.m1.2.2.1.1.2.2" stretchy="false" xref="S2.E4.m1.2.2.1.1.2.2.cmml">←</mo><mtext id="S2.E4.m1.2.2.1.1.2.1" xref="S2.E4.m1.2.2.1.1.2.1a.cmml">Top-1</mtext></mover><mrow id="S2.E4.m1.2.2.1.1.1" xref="S2.E4.m1.2.2.1.1.1.cmml"><mtext id="S2.E4.m1.2.2.1.1.1.3" xref="S2.E4.m1.2.2.1.1.1.3a.cmml">Retriever</mtext><mo id="S2.E4.m1.2.2.1.1.1.2" xref="S2.E4.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S2.E4.m1.2.2.1.1.1.1.1" xref="S2.E4.m1.2.2.1.1.1.1.2.cmml"><mo id="S2.E4.m1.2.2.1.1.1.1.1.2" stretchy="false" xref="S2.E4.m1.2.2.1.1.1.1.2.cmml">(</mo><mi id="S2.E4.m1.1.1" xref="S2.E4.m1.1.1.cmml">q</mi><mo id="S2.E4.m1.2.2.1.1.1.1.1.3" xref="S2.E4.m1.2.2.1.1.1.1.2.cmml">,</mo><mrow id="S2.E4.m1.2.2.1.1.1.1.1.1" xref="S2.E4.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S2.E4.m1.2.2.1.1.1.1.1.1.2" xref="S2.E4.m1.2.2.1.1.1.1.1.1.2.cmml">K</mi><mo id="S2.E4.m1.2.2.1.1.1.1.1.1.1" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S2.E4.m1.2.2.1.1.1.1.1.1.3" xref="S2.E4.m1.2.2.1.1.1.1.1.1.3.cmml">B</mi></mrow><mo id="S2.E4.m1.2.2.1.1.1.1.1.4" stretchy="false" xref="S2.E4.m1.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E4.m1.2.2.1.2" xref="S2.E4.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m1.2b"><apply id="S2.E4.m1.2.2.1.1.cmml" xref="S2.E4.m1.2.2.1"><apply id="S2.E4.m1.2.2.1.1.2.cmml" xref="S2.E4.m1.2.2.1.1.2"><ci id="S2.E4.m1.2.2.1.1.2.1a.cmml" xref="S2.E4.m1.2.2.1.1.2.1"><mtext id="S2.E4.m1.2.2.1.1.2.1.cmml" xref="S2.E4.m1.2.2.1.1.2.1">Top-1</mtext></ci><ci id="S2.E4.m1.2.2.1.1.2.2.cmml" xref="S2.E4.m1.2.2.1.1.2.2">←</ci></apply><ci id="S2.E4.m1.2.2.1.1.3.cmml" xref="S2.E4.m1.2.2.1.1.3">𝑖</ci><apply id="S2.E4.m1.2.2.1.1.1.cmml" xref="S2.E4.m1.2.2.1.1.1"><times id="S2.E4.m1.2.2.1.1.1.2.cmml" xref="S2.E4.m1.2.2.1.1.1.2"></times><ci id="S2.E4.m1.2.2.1.1.1.3a.cmml" xref="S2.E4.m1.2.2.1.1.1.3"><mtext id="S2.E4.m1.2.2.1.1.1.3.cmml" xref="S2.E4.m1.2.2.1.1.1.3">Retriever</mtext></ci><interval closure="open" id="S2.E4.m1.2.2.1.1.1.1.2.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1"><ci id="S2.E4.m1.1.1.cmml" xref="S2.E4.m1.1.1">𝑞</ci><apply id="S2.E4.m1.2.2.1.1.1.1.1.1.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1.1"><times id="S2.E4.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1"></times><ci id="S2.E4.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1.1.2">𝐾</ci><ci id="S2.E4.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1.1.3">𝐵</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.2c">\displaystyle i\xleftarrow{\text{Top-1}}\text{Retriever}(q,KB),</annotation><annotation encoding="application/x-llamapun" id="S2.E4.m1.2d">italic_i start_ARROW overTop-1 ← end_ARROW Retriever ( italic_q , italic_K italic_B ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS3.p1.3">where <math alttext="q" class="ltx_Math" display="inline" id="S2.SS3.p1.1.m1.1"><semantics id="S2.SS3.p1.1.m1.1a"><mi id="S2.SS3.p1.1.m1.1.1" xref="S2.SS3.p1.1.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.1.m1.1b"><ci id="S2.SS3.p1.1.m1.1.1.cmml" xref="S2.SS3.p1.1.m1.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.1.m1.1c">q</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.1.m1.1d">italic_q</annotation></semantics></math> denotes the query content, <math alttext="p" class="ltx_Math" display="inline" id="S2.SS3.p1.2.m2.1"><semantics id="S2.SS3.p1.2.m2.1a"><mi id="S2.SS3.p1.2.m2.1.1" xref="S2.SS3.p1.2.m2.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.2.m2.1b"><ci id="S2.SS3.p1.2.m2.1.1.cmml" xref="S2.SS3.p1.2.m2.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.2.m2.1c">p</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.2.m2.1d">italic_p</annotation></semantics></math> denotes the target problem, and <math alttext="i" class="ltx_Math" display="inline" id="S2.SS3.p1.3.m3.1"><semantics id="S2.SS3.p1.3.m3.1a"><mi id="S2.SS3.p1.3.m3.1.1" xref="S2.SS3.p1.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.3.m3.1b"><ci id="S2.SS3.p1.3.m3.1.1.cmml" xref="S2.SS3.p1.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.3.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.3.m3.1d">italic_i</annotation></semantics></math> is the returned index of the Top-1 relevant content stored in the constructed knowledge base.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS3.p2">
<p class="ltx_p" id="S2.SS3.p2.1">The main problems of the retrieval lie in: 1) how to design the informative query content and 2) how to align the different modalities.</p>
</div>
<section class="ltx_subsubsection" id="S2.SS3.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.3.1 </span>Query Extractor</h4>
<div class="ltx_para ltx_noindent" id="S2.SS3.SSS1.p1">
<p class="ltx_p" id="S2.SS3.SSS1.p1.1">Since the styles of different code problems can diversify, the query content of the retrieval process matters. We consider the following contents: 1) Problem description, which describes the task to be completed by the target function code. Potential ambiguity and style diversity may exist among different problems set, which lead to a decrease in retrieval accuracy. 2) Function declaration, which gives the function name and the input variables.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS3.SSS1.p2">
<p class="ltx_p" id="S2.SS3.SSS1.p2.1">Before knowledge querying, we first extract the problem description of each task to reduce the ambiguity and then concatenate it with the function declaration to serve as the query content, where the functionality and input format of the expected code block are contained.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S2.SS3.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.3.2 </span>Retriever</h4>
<div class="ltx_para ltx_noindent" id="S2.SS3.SSS2.p1">
<p class="ltx_p" id="S2.SS3.SSS2.p1.4">The query of the retrieval includes problem description <math alttext="Q_{p}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p1.1.m1.1"><semantics id="S2.SS3.SSS2.p1.1.m1.1a"><msub id="S2.SS3.SSS2.p1.1.m1.1.1" xref="S2.SS3.SSS2.p1.1.m1.1.1.cmml"><mi id="S2.SS3.SSS2.p1.1.m1.1.1.2" xref="S2.SS3.SSS2.p1.1.m1.1.1.2.cmml">Q</mi><mi id="S2.SS3.SSS2.p1.1.m1.1.1.3" xref="S2.SS3.SSS2.p1.1.m1.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p1.1.m1.1b"><apply id="S2.SS3.SSS2.p1.1.m1.1.1.cmml" xref="S2.SS3.SSS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p1.1.m1.1.1.1.cmml" xref="S2.SS3.SSS2.p1.1.m1.1.1">subscript</csymbol><ci id="S2.SS3.SSS2.p1.1.m1.1.1.2.cmml" xref="S2.SS3.SSS2.p1.1.m1.1.1.2">𝑄</ci><ci id="S2.SS3.SSS2.p1.1.m1.1.1.3.cmml" xref="S2.SS3.SSS2.p1.1.m1.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p1.1.m1.1c">Q_{p}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p1.1.m1.1d">italic_Q start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math> and function description <math alttext="Q_{c}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p1.2.m2.1"><semantics id="S2.SS3.SSS2.p1.2.m2.1a"><msub id="S2.SS3.SSS2.p1.2.m2.1.1" xref="S2.SS3.SSS2.p1.2.m2.1.1.cmml"><mi id="S2.SS3.SSS2.p1.2.m2.1.1.2" xref="S2.SS3.SSS2.p1.2.m2.1.1.2.cmml">Q</mi><mi id="S2.SS3.SSS2.p1.2.m2.1.1.3" xref="S2.SS3.SSS2.p1.2.m2.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p1.2.m2.1b"><apply id="S2.SS3.SSS2.p1.2.m2.1.1.cmml" xref="S2.SS3.SSS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p1.2.m2.1.1.1.cmml" xref="S2.SS3.SSS2.p1.2.m2.1.1">subscript</csymbol><ci id="S2.SS3.SSS2.p1.2.m2.1.1.2.cmml" xref="S2.SS3.SSS2.p1.2.m2.1.1.2">𝑄</ci><ci id="S2.SS3.SSS2.p1.2.m2.1.1.3.cmml" xref="S2.SS3.SSS2.p1.2.m2.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p1.2.m2.1c">Q_{c}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p1.2.m2.1d">italic_Q start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math>, while each content of the retrieval pool includes raw code block <math alttext="V_{c}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p1.3.m3.1"><semantics id="S2.SS3.SSS2.p1.3.m3.1a"><msub id="S2.SS3.SSS2.p1.3.m3.1.1" xref="S2.SS3.SSS2.p1.3.m3.1.1.cmml"><mi id="S2.SS3.SSS2.p1.3.m3.1.1.2" xref="S2.SS3.SSS2.p1.3.m3.1.1.2.cmml">V</mi><mi id="S2.SS3.SSS2.p1.3.m3.1.1.3" xref="S2.SS3.SSS2.p1.3.m3.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p1.3.m3.1b"><apply id="S2.SS3.SSS2.p1.3.m3.1.1.cmml" xref="S2.SS3.SSS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p1.3.m3.1.1.1.cmml" xref="S2.SS3.SSS2.p1.3.m3.1.1">subscript</csymbol><ci id="S2.SS3.SSS2.p1.3.m3.1.1.2.cmml" xref="S2.SS3.SSS2.p1.3.m3.1.1.2">𝑉</ci><ci id="S2.SS3.SSS2.p1.3.m3.1.1.3.cmml" xref="S2.SS3.SSS2.p1.3.m3.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p1.3.m3.1c">V_{c}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p1.3.m3.1d">italic_V start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> and its graphical view <math alttext="V_{g}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p1.4.m4.1"><semantics id="S2.SS3.SSS2.p1.4.m4.1a"><msub id="S2.SS3.SSS2.p1.4.m4.1.1" xref="S2.SS3.SSS2.p1.4.m4.1.1.cmml"><mi id="S2.SS3.SSS2.p1.4.m4.1.1.2" xref="S2.SS3.SSS2.p1.4.m4.1.1.2.cmml">V</mi><mi id="S2.SS3.SSS2.p1.4.m4.1.1.3" xref="S2.SS3.SSS2.p1.4.m4.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p1.4.m4.1b"><apply id="S2.SS3.SSS2.p1.4.m4.1.1.cmml" xref="S2.SS3.SSS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p1.4.m4.1.1.1.cmml" xref="S2.SS3.SSS2.p1.4.m4.1.1">subscript</csymbol><ci id="S2.SS3.SSS2.p1.4.m4.1.1.2.cmml" xref="S2.SS3.SSS2.p1.4.m4.1.1.2">𝑉</ci><ci id="S2.SS3.SSS2.p1.4.m4.1.1.3.cmml" xref="S2.SS3.SSS2.p1.4.m4.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p1.4.m4.1c">V_{g}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p1.4.m4.1d">italic_V start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS3.SSS2.p2">
<p class="ltx_p" id="S2.SS3.SSS2.p2.1">To expressively represent the components, we use the encoder <math alttext="\phi(\cdot)" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p2.1.m1.1"><semantics id="S2.SS3.SSS2.p2.1.m1.1a"><mrow id="S2.SS3.SSS2.p2.1.m1.1.2" xref="S2.SS3.SSS2.p2.1.m1.1.2.cmml"><mi id="S2.SS3.SSS2.p2.1.m1.1.2.2" xref="S2.SS3.SSS2.p2.1.m1.1.2.2.cmml">ϕ</mi><mo id="S2.SS3.SSS2.p2.1.m1.1.2.1" xref="S2.SS3.SSS2.p2.1.m1.1.2.1.cmml">⁢</mo><mrow id="S2.SS3.SSS2.p2.1.m1.1.2.3.2" xref="S2.SS3.SSS2.p2.1.m1.1.2.cmml"><mo id="S2.SS3.SSS2.p2.1.m1.1.2.3.2.1" stretchy="false" xref="S2.SS3.SSS2.p2.1.m1.1.2.cmml">(</mo><mo id="S2.SS3.SSS2.p2.1.m1.1.1" lspace="0em" rspace="0em" xref="S2.SS3.SSS2.p2.1.m1.1.1.cmml">⋅</mo><mo id="S2.SS3.SSS2.p2.1.m1.1.2.3.2.2" stretchy="false" xref="S2.SS3.SSS2.p2.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p2.1.m1.1b"><apply id="S2.SS3.SSS2.p2.1.m1.1.2.cmml" xref="S2.SS3.SSS2.p2.1.m1.1.2"><times id="S2.SS3.SSS2.p2.1.m1.1.2.1.cmml" xref="S2.SS3.SSS2.p2.1.m1.1.2.1"></times><ci id="S2.SS3.SSS2.p2.1.m1.1.2.2.cmml" xref="S2.SS3.SSS2.p2.1.m1.1.2.2">italic-ϕ</ci><ci id="S2.SS3.SSS2.p2.1.m1.1.1.cmml" xref="S2.SS3.SSS2.p2.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p2.1.m1.1c">\phi(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p2.1.m1.1d">italic_ϕ ( ⋅ )</annotation></semantics></math> of the pretrained NL2Code model to represent the problem description and code snippets. The retrieval function is:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx3">
<tbody id="S2.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{h^{V}}" class="ltx_Math" display="inline" id="S2.E5.m1.1"><semantics id="S2.E5.m1.1a"><msup id="S2.E5.m1.1.1" xref="S2.E5.m1.1.1.cmml"><mi id="S2.E5.m1.1.1.2" xref="S2.E5.m1.1.1.2.cmml">𝐡</mi><mi id="S2.E5.m1.1.1.3" xref="S2.E5.m1.1.1.3.cmml">𝐕</mi></msup><annotation-xml encoding="MathML-Content" id="S2.E5.m1.1b"><apply id="S2.E5.m1.1.1.cmml" xref="S2.E5.m1.1.1"><csymbol cd="ambiguous" id="S2.E5.m1.1.1.1.cmml" xref="S2.E5.m1.1.1">superscript</csymbol><ci id="S2.E5.m1.1.1.2.cmml" xref="S2.E5.m1.1.1.2">𝐡</ci><ci id="S2.E5.m1.1.1.3.cmml" xref="S2.E5.m1.1.1.3">𝐕</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5.m1.1c">\displaystyle\mathbf{h^{V}}</annotation><annotation encoding="application/x-llamapun" id="S2.E5.m1.1d">bold_h start_POSTSUPERSCRIPT bold_V end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\phi(V_{c}\|V_{g})," class="ltx_Math" display="inline" id="S2.E5.m2.1"><semantics id="S2.E5.m2.1a"><mrow id="S2.E5.m2.1.1.1" xref="S2.E5.m2.1.1.1.1.cmml"><mrow id="S2.E5.m2.1.1.1.1" xref="S2.E5.m2.1.1.1.1.cmml"><mi id="S2.E5.m2.1.1.1.1.3" xref="S2.E5.m2.1.1.1.1.3.cmml"></mi><mo id="S2.E5.m2.1.1.1.1.2" xref="S2.E5.m2.1.1.1.1.2.cmml">=</mo><mrow id="S2.E5.m2.1.1.1.1.1" xref="S2.E5.m2.1.1.1.1.1.cmml"><mi id="S2.E5.m2.1.1.1.1.1.3" xref="S2.E5.m2.1.1.1.1.1.3.cmml">ϕ</mi><mo id="S2.E5.m2.1.1.1.1.1.2" xref="S2.E5.m2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E5.m2.1.1.1.1.1.1.1" xref="S2.E5.m2.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E5.m2.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E5.m2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E5.m2.1.1.1.1.1.1.1.1" xref="S2.E5.m2.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E5.m2.1.1.1.1.1.1.1.1.2" xref="S2.E5.m2.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E5.m2.1.1.1.1.1.1.1.1.2.2" xref="S2.E5.m2.1.1.1.1.1.1.1.1.2.2.cmml">V</mi><mi id="S2.E5.m2.1.1.1.1.1.1.1.1.2.3" xref="S2.E5.m2.1.1.1.1.1.1.1.1.2.3.cmml">c</mi></msub><mo id="S2.E5.m2.1.1.1.1.1.1.1.1.1" xref="S2.E5.m2.1.1.1.1.1.1.1.1.1.cmml">∥</mo><msub id="S2.E5.m2.1.1.1.1.1.1.1.1.3" xref="S2.E5.m2.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E5.m2.1.1.1.1.1.1.1.1.3.2" xref="S2.E5.m2.1.1.1.1.1.1.1.1.3.2.cmml">V</mi><mi id="S2.E5.m2.1.1.1.1.1.1.1.1.3.3" xref="S2.E5.m2.1.1.1.1.1.1.1.1.3.3.cmml">g</mi></msub></mrow><mo id="S2.E5.m2.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E5.m2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E5.m2.1.1.1.2" xref="S2.E5.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E5.m2.1b"><apply id="S2.E5.m2.1.1.1.1.cmml" xref="S2.E5.m2.1.1.1"><eq id="S2.E5.m2.1.1.1.1.2.cmml" xref="S2.E5.m2.1.1.1.1.2"></eq><csymbol cd="latexml" id="S2.E5.m2.1.1.1.1.3.cmml" xref="S2.E5.m2.1.1.1.1.3">absent</csymbol><apply id="S2.E5.m2.1.1.1.1.1.cmml" xref="S2.E5.m2.1.1.1.1.1"><times id="S2.E5.m2.1.1.1.1.1.2.cmml" xref="S2.E5.m2.1.1.1.1.1.2"></times><ci id="S2.E5.m2.1.1.1.1.1.3.cmml" xref="S2.E5.m2.1.1.1.1.1.3">italic-ϕ</ci><apply id="S2.E5.m2.1.1.1.1.1.1.1.1.cmml" xref="S2.E5.m2.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E5.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E5.m2.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S2.E5.m2.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E5.m2.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E5.m2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E5.m2.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E5.m2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E5.m2.1.1.1.1.1.1.1.1.2.2">𝑉</ci><ci id="S2.E5.m2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E5.m2.1.1.1.1.1.1.1.1.2.3">𝑐</ci></apply><apply id="S2.E5.m2.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E5.m2.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E5.m2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E5.m2.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E5.m2.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E5.m2.1.1.1.1.1.1.1.1.3.2">𝑉</ci><ci id="S2.E5.m2.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E5.m2.1.1.1.1.1.1.1.1.3.3">𝑔</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5.m2.1c">\displaystyle=\phi(V_{c}\|V_{g}),</annotation><annotation encoding="application/x-llamapun" id="S2.E5.m2.1d">= italic_ϕ ( italic_V start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ∥ italic_V start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
<tbody id="S2.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{h^{Q}}" class="ltx_Math" display="inline" id="S2.E6.m1.1"><semantics id="S2.E6.m1.1a"><msup id="S2.E6.m1.1.1" xref="S2.E6.m1.1.1.cmml"><mi id="S2.E6.m1.1.1.2" xref="S2.E6.m1.1.1.2.cmml">𝐡</mi><mi id="S2.E6.m1.1.1.3" xref="S2.E6.m1.1.1.3.cmml">𝐐</mi></msup><annotation-xml encoding="MathML-Content" id="S2.E6.m1.1b"><apply id="S2.E6.m1.1.1.cmml" xref="S2.E6.m1.1.1"><csymbol cd="ambiguous" id="S2.E6.m1.1.1.1.cmml" xref="S2.E6.m1.1.1">superscript</csymbol><ci id="S2.E6.m1.1.1.2.cmml" xref="S2.E6.m1.1.1.2">𝐡</ci><ci id="S2.E6.m1.1.1.3.cmml" xref="S2.E6.m1.1.1.3">𝐐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E6.m1.1c">\displaystyle\mathbf{h^{Q}}</annotation><annotation encoding="application/x-llamapun" id="S2.E6.m1.1d">bold_h start_POSTSUPERSCRIPT bold_Q end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\phi(Q_{p}\|Q_{c})," class="ltx_Math" display="inline" id="S2.E6.m2.1"><semantics id="S2.E6.m2.1a"><mrow id="S2.E6.m2.1.1.1" xref="S2.E6.m2.1.1.1.1.cmml"><mrow id="S2.E6.m2.1.1.1.1" xref="S2.E6.m2.1.1.1.1.cmml"><mi id="S2.E6.m2.1.1.1.1.3" xref="S2.E6.m2.1.1.1.1.3.cmml"></mi><mo id="S2.E6.m2.1.1.1.1.2" xref="S2.E6.m2.1.1.1.1.2.cmml">=</mo><mrow id="S2.E6.m2.1.1.1.1.1" xref="S2.E6.m2.1.1.1.1.1.cmml"><mi id="S2.E6.m2.1.1.1.1.1.3" xref="S2.E6.m2.1.1.1.1.1.3.cmml">ϕ</mi><mo id="S2.E6.m2.1.1.1.1.1.2" xref="S2.E6.m2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E6.m2.1.1.1.1.1.1.1" xref="S2.E6.m2.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E6.m2.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E6.m2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E6.m2.1.1.1.1.1.1.1.1" xref="S2.E6.m2.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E6.m2.1.1.1.1.1.1.1.1.2" xref="S2.E6.m2.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E6.m2.1.1.1.1.1.1.1.1.2.2" xref="S2.E6.m2.1.1.1.1.1.1.1.1.2.2.cmml">Q</mi><mi id="S2.E6.m2.1.1.1.1.1.1.1.1.2.3" xref="S2.E6.m2.1.1.1.1.1.1.1.1.2.3.cmml">p</mi></msub><mo id="S2.E6.m2.1.1.1.1.1.1.1.1.1" xref="S2.E6.m2.1.1.1.1.1.1.1.1.1.cmml">∥</mo><msub id="S2.E6.m2.1.1.1.1.1.1.1.1.3" xref="S2.E6.m2.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E6.m2.1.1.1.1.1.1.1.1.3.2" xref="S2.E6.m2.1.1.1.1.1.1.1.1.3.2.cmml">Q</mi><mi id="S2.E6.m2.1.1.1.1.1.1.1.1.3.3" xref="S2.E6.m2.1.1.1.1.1.1.1.1.3.3.cmml">c</mi></msub></mrow><mo id="S2.E6.m2.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E6.m2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E6.m2.1.1.1.2" xref="S2.E6.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E6.m2.1b"><apply id="S2.E6.m2.1.1.1.1.cmml" xref="S2.E6.m2.1.1.1"><eq id="S2.E6.m2.1.1.1.1.2.cmml" xref="S2.E6.m2.1.1.1.1.2"></eq><csymbol cd="latexml" id="S2.E6.m2.1.1.1.1.3.cmml" xref="S2.E6.m2.1.1.1.1.3">absent</csymbol><apply id="S2.E6.m2.1.1.1.1.1.cmml" xref="S2.E6.m2.1.1.1.1.1"><times id="S2.E6.m2.1.1.1.1.1.2.cmml" xref="S2.E6.m2.1.1.1.1.1.2"></times><ci id="S2.E6.m2.1.1.1.1.1.3.cmml" xref="S2.E6.m2.1.1.1.1.1.3">italic-ϕ</ci><apply id="S2.E6.m2.1.1.1.1.1.1.1.1.cmml" xref="S2.E6.m2.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E6.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E6.m2.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S2.E6.m2.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E6.m2.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E6.m2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E6.m2.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E6.m2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E6.m2.1.1.1.1.1.1.1.1.2.2">𝑄</ci><ci id="S2.E6.m2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E6.m2.1.1.1.1.1.1.1.1.2.3">𝑝</ci></apply><apply id="S2.E6.m2.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E6.m2.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E6.m2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E6.m2.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E6.m2.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E6.m2.1.1.1.1.1.1.1.1.3.2">𝑄</ci><ci id="S2.E6.m2.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E6.m2.1.1.1.1.1.1.1.1.3.3">𝑐</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E6.m2.1c">\displaystyle=\phi(Q_{p}\|Q_{c}),</annotation><annotation encoding="application/x-llamapun" id="S2.E6.m2.1d">= italic_ϕ ( italic_Q start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ∥ italic_Q start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
<tbody id="S2.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span class="ltx_text ltx_markedasmath" id="S2.E7.2.1.1.1">Distance</span></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=1-\frac{\mathbf{\mathbf{h^{Q}}\cdot\mathbf{h^{V}}}}{\|\mathbf{h^%
{Q}}\|\cdot\|\mathbf{h^{V}}\|}." class="ltx_Math" display="inline" id="S2.E7.m2.3"><semantics id="S2.E7.m2.3a"><mrow id="S2.E7.m2.3.3.1" xref="S2.E7.m2.3.3.1.1.cmml"><mrow id="S2.E7.m2.3.3.1.1" xref="S2.E7.m2.3.3.1.1.cmml"><mi id="S2.E7.m2.3.3.1.1.2" xref="S2.E7.m2.3.3.1.1.2.cmml"></mi><mo id="S2.E7.m2.3.3.1.1.1" xref="S2.E7.m2.3.3.1.1.1.cmml">=</mo><mrow id="S2.E7.m2.3.3.1.1.3" xref="S2.E7.m2.3.3.1.1.3.cmml"><mn id="S2.E7.m2.3.3.1.1.3.2" xref="S2.E7.m2.3.3.1.1.3.2.cmml">1</mn><mo id="S2.E7.m2.3.3.1.1.3.1" xref="S2.E7.m2.3.3.1.1.3.1.cmml">−</mo><mstyle displaystyle="true" id="S2.E7.m2.2.2" xref="S2.E7.m2.2.2.cmml"><mfrac id="S2.E7.m2.2.2a" xref="S2.E7.m2.2.2.cmml"><mrow id="S2.E7.m2.2.2.4" xref="S2.E7.m2.2.2.4.cmml"><msup id="S2.E7.m2.2.2.4.2" xref="S2.E7.m2.2.2.4.2.cmml"><mi id="S2.E7.m2.2.2.4.2.2" xref="S2.E7.m2.2.2.4.2.2.cmml">𝐡</mi><mi id="S2.E7.m2.2.2.4.2.3" xref="S2.E7.m2.2.2.4.2.3.cmml">𝐐</mi></msup><mo id="S2.E7.m2.2.2.4.1" lspace="0.222em" rspace="0.222em" xref="S2.E7.m2.2.2.4.1.cmml">⋅</mo><msup id="S2.E7.m2.2.2.4.3" xref="S2.E7.m2.2.2.4.3.cmml"><mi id="S2.E7.m2.2.2.4.3.2" xref="S2.E7.m2.2.2.4.3.2.cmml">𝐡</mi><mi id="S2.E7.m2.2.2.4.3.3" xref="S2.E7.m2.2.2.4.3.3.cmml">𝐕</mi></msup></mrow><mrow id="S2.E7.m2.2.2.2" xref="S2.E7.m2.2.2.2.cmml"><mrow id="S2.E7.m2.1.1.1.1.1" xref="S2.E7.m2.1.1.1.1.2.cmml"><mo id="S2.E7.m2.1.1.1.1.1.2" stretchy="false" xref="S2.E7.m2.1.1.1.1.2.1.cmml">‖</mo><msup id="S2.E7.m2.1.1.1.1.1.1" xref="S2.E7.m2.1.1.1.1.1.1.cmml"><mi id="S2.E7.m2.1.1.1.1.1.1.2" xref="S2.E7.m2.1.1.1.1.1.1.2.cmml">𝐡</mi><mi id="S2.E7.m2.1.1.1.1.1.1.3" xref="S2.E7.m2.1.1.1.1.1.1.3.cmml">𝐐</mi></msup><mo id="S2.E7.m2.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S2.E7.m2.1.1.1.1.2.1.cmml">‖</mo></mrow><mo id="S2.E7.m2.2.2.2.3" rspace="0.222em" xref="S2.E7.m2.2.2.2.3.cmml">⋅</mo><mrow id="S2.E7.m2.2.2.2.2.1" xref="S2.E7.m2.2.2.2.2.2.cmml"><mo id="S2.E7.m2.2.2.2.2.1.2" stretchy="false" xref="S2.E7.m2.2.2.2.2.2.1.cmml">‖</mo><msup id="S2.E7.m2.2.2.2.2.1.1" xref="S2.E7.m2.2.2.2.2.1.1.cmml"><mi id="S2.E7.m2.2.2.2.2.1.1.2" xref="S2.E7.m2.2.2.2.2.1.1.2.cmml">𝐡</mi><mi id="S2.E7.m2.2.2.2.2.1.1.3" xref="S2.E7.m2.2.2.2.2.1.1.3.cmml">𝐕</mi></msup><mo id="S2.E7.m2.2.2.2.2.1.3" stretchy="false" xref="S2.E7.m2.2.2.2.2.2.1.cmml">‖</mo></mrow></mrow></mfrac></mstyle></mrow></mrow><mo id="S2.E7.m2.3.3.1.2" lspace="0em" xref="S2.E7.m2.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E7.m2.3b"><apply id="S2.E7.m2.3.3.1.1.cmml" xref="S2.E7.m2.3.3.1"><eq id="S2.E7.m2.3.3.1.1.1.cmml" xref="S2.E7.m2.3.3.1.1.1"></eq><csymbol cd="latexml" id="S2.E7.m2.3.3.1.1.2.cmml" xref="S2.E7.m2.3.3.1.1.2">absent</csymbol><apply id="S2.E7.m2.3.3.1.1.3.cmml" xref="S2.E7.m2.3.3.1.1.3"><minus id="S2.E7.m2.3.3.1.1.3.1.cmml" xref="S2.E7.m2.3.3.1.1.3.1"></minus><cn id="S2.E7.m2.3.3.1.1.3.2.cmml" type="integer" xref="S2.E7.m2.3.3.1.1.3.2">1</cn><apply id="S2.E7.m2.2.2.cmml" xref="S2.E7.m2.2.2"><divide id="S2.E7.m2.2.2.3.cmml" xref="S2.E7.m2.2.2"></divide><apply id="S2.E7.m2.2.2.4.cmml" xref="S2.E7.m2.2.2.4"><ci id="S2.E7.m2.2.2.4.1.cmml" xref="S2.E7.m2.2.2.4.1">⋅</ci><apply id="S2.E7.m2.2.2.4.2.cmml" xref="S2.E7.m2.2.2.4.2"><csymbol cd="ambiguous" id="S2.E7.m2.2.2.4.2.1.cmml" xref="S2.E7.m2.2.2.4.2">superscript</csymbol><ci id="S2.E7.m2.2.2.4.2.2.cmml" xref="S2.E7.m2.2.2.4.2.2">𝐡</ci><ci id="S2.E7.m2.2.2.4.2.3.cmml" xref="S2.E7.m2.2.2.4.2.3">𝐐</ci></apply><apply id="S2.E7.m2.2.2.4.3.cmml" xref="S2.E7.m2.2.2.4.3"><csymbol cd="ambiguous" id="S2.E7.m2.2.2.4.3.1.cmml" xref="S2.E7.m2.2.2.4.3">superscript</csymbol><ci id="S2.E7.m2.2.2.4.3.2.cmml" xref="S2.E7.m2.2.2.4.3.2">𝐡</ci><ci id="S2.E7.m2.2.2.4.3.3.cmml" xref="S2.E7.m2.2.2.4.3.3">𝐕</ci></apply></apply><apply id="S2.E7.m2.2.2.2.cmml" xref="S2.E7.m2.2.2.2"><ci id="S2.E7.m2.2.2.2.3.cmml" xref="S2.E7.m2.2.2.2.3">⋅</ci><apply id="S2.E7.m2.1.1.1.1.2.cmml" xref="S2.E7.m2.1.1.1.1.1"><csymbol cd="latexml" id="S2.E7.m2.1.1.1.1.2.1.cmml" xref="S2.E7.m2.1.1.1.1.1.2">norm</csymbol><apply id="S2.E7.m2.1.1.1.1.1.1.cmml" xref="S2.E7.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E7.m2.1.1.1.1.1.1.1.cmml" xref="S2.E7.m2.1.1.1.1.1.1">superscript</csymbol><ci id="S2.E7.m2.1.1.1.1.1.1.2.cmml" xref="S2.E7.m2.1.1.1.1.1.1.2">𝐡</ci><ci id="S2.E7.m2.1.1.1.1.1.1.3.cmml" xref="S2.E7.m2.1.1.1.1.1.1.3">𝐐</ci></apply></apply><apply id="S2.E7.m2.2.2.2.2.2.cmml" xref="S2.E7.m2.2.2.2.2.1"><csymbol cd="latexml" id="S2.E7.m2.2.2.2.2.2.1.cmml" xref="S2.E7.m2.2.2.2.2.1.2">norm</csymbol><apply id="S2.E7.m2.2.2.2.2.1.1.cmml" xref="S2.E7.m2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S2.E7.m2.2.2.2.2.1.1.1.cmml" xref="S2.E7.m2.2.2.2.2.1.1">superscript</csymbol><ci id="S2.E7.m2.2.2.2.2.1.1.2.cmml" xref="S2.E7.m2.2.2.2.2.1.1.2">𝐡</ci><ci id="S2.E7.m2.2.2.2.2.1.1.3.cmml" xref="S2.E7.m2.2.2.2.2.1.1.3">𝐕</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E7.m2.3c">\displaystyle=1-\frac{\mathbf{\mathbf{h^{Q}}\cdot\mathbf{h^{V}}}}{\|\mathbf{h^%
{Q}}\|\cdot\|\mathbf{h^{V}}\|}.</annotation><annotation encoding="application/x-llamapun" id="S2.E7.m2.3d">= 1 - divide start_ARG bold_h start_POSTSUPERSCRIPT bold_Q end_POSTSUPERSCRIPT ⋅ bold_h start_POSTSUPERSCRIPT bold_V end_POSTSUPERSCRIPT end_ARG start_ARG ∥ bold_h start_POSTSUPERSCRIPT bold_Q end_POSTSUPERSCRIPT ∥ ⋅ ∥ bold_h start_POSTSUPERSCRIPT bold_V end_POSTSUPERSCRIPT ∥ end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
</div>
</section>
</section>
<section class="ltx_subsection" id="S2.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.4 </span>Graphical Knowledge Augmented Generation</h3>
<div class="ltx_para ltx_noindent" id="S2.SS4.p1">
<p class="ltx_p" id="S2.SS4.p1.1">After we obtain the returned graphical view, we inject it to the foundation LLMs for graphical knowledge augmented generation. Since the graphical view is hard to understand, we propose 1) a meta-graph template to transform the graphical view into informative knowledge for tuning-free model and 2) a soft prompting technique to tune the foundation models for their better understanding of the graphical views with the assistance of an expert GNN model.</p>
</div>
<section class="ltx_subsubsection" id="S2.SS4.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.4.1 </span>Hard Meta-Graph Prompt</h4>
<div class="ltx_para ltx_noindent" id="S2.SS4.SSS1.p1">
<p class="ltx_p" id="S2.SS4.SSS1.p1.1">The original graphical view of a code block could contain hundreds of nodes and edges. A full description of it could cost a overly long context, along with the understanding challenge posed by the long edge lists. Therefore, we propose to use a meta-graph template to abstract the information of the graphical view. The abstracted meta-graph consists of the canonical edge types and node types, which describes the basic topology of the graphical view <cite class="ltx_cite ltx_citemacro_citep">(Sun &amp; Han, <a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#bib.bib27" title="">2013</a>)</cite>, with the textual features obtained from the ASTs contained in the node and edge features.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS4.SSS1.p2">
<p class="ltx_p" id="S2.SS4.SSS1.p2.1">Then we use the meta-graph template to transform the retrieved graphical view into digestable knowledge and insert it into the final prompt for generation. As illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#S2.F5" title="Figure 5 ‣ 2.4.1 Hard Meta-Graph Prompt ‣ 2.4 Graphical Knowledge Augmented Generation ‣ 2 Methodology ‣ CodeGRAG: Bridging the Gap between Natural Language and Programming Language via Graphical Retrieval Augmented Generation"><span class="ltx_text ltx_ref_tag">5</span></a>, the final prompt consists of three components: the system prompt illustrated in the blue part, the retrieved knowledge and hints illustrated in the green part, and the problem (including task description, function declaration, etc.) illustrated in the yellow part. The three parts are concatenated to be fed into LLMs for knowledge augmented generation.</p>
</div>
<figure class="ltx_figure" id="S2.F5">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_bottom" id="S2.F5.1" style="width:178.9pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="704" id="S2.F5.1.g1" src="x4.png" width="760"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Hard meta-graph prompt.</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_bottom" id="S2.F5.2" style="width:178.9pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="707" id="S2.F5.2.g1" src="x5.png" width="762"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Soft prompting.</figcaption>
</figure>
</div>
</div>
</figure>
</section>
<section class="ltx_subsubsection" id="S2.SS4.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.4.2 </span>Soft Prompting with the Expert</h4>
<div class="ltx_para ltx_noindent" id="S2.SS4.SSS2.p1">
<p class="ltx_p" id="S2.SS4.SSS2.p1.1">Directly hard prompt to the LLMs poses a challenge to the digesting capability of the backbone LLMs, which could fail under the case where the backbone LLMs cannot well understand the graph components.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS4.SSS2.p2">
<p class="ltx_p" id="S2.SS4.SSS2.p2.1">To compress the graphical knowledge into model parameters and help the backbone LLMs to better understand the programming language, we propose a soft prompting technique. The overall procedure can summarized into
expert encoding of graphical views, finetuning with the expert signal, and inference.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS4.SSS2.p3">
<p class="ltx_p" id="S2.SS4.SSS2.p3.3"><span class="ltx_text ltx_font_bold" id="S2.SS4.SSS2.p3.3.1">Expert Encoding of Graphical Views.</span>
We design a graph neural network to preserve the semantic and logical information of code blocks. The representation of each node <math alttext="\mathbf{n}_{i}^{(0)}" class="ltx_Math" display="inline" id="S2.SS4.SSS2.p3.1.m1.1"><semantics id="S2.SS4.SSS2.p3.1.m1.1a"><msubsup id="S2.SS4.SSS2.p3.1.m1.1.2" xref="S2.SS4.SSS2.p3.1.m1.1.2.cmml"><mi id="S2.SS4.SSS2.p3.1.m1.1.2.2.2" xref="S2.SS4.SSS2.p3.1.m1.1.2.2.2.cmml">𝐧</mi><mi id="S2.SS4.SSS2.p3.1.m1.1.2.2.3" xref="S2.SS4.SSS2.p3.1.m1.1.2.2.3.cmml">i</mi><mrow id="S2.SS4.SSS2.p3.1.m1.1.1.1.3" xref="S2.SS4.SSS2.p3.1.m1.1.2.cmml"><mo id="S2.SS4.SSS2.p3.1.m1.1.1.1.3.1" stretchy="false" xref="S2.SS4.SSS2.p3.1.m1.1.2.cmml">(</mo><mn id="S2.SS4.SSS2.p3.1.m1.1.1.1.1" xref="S2.SS4.SSS2.p3.1.m1.1.1.1.1.cmml">0</mn><mo id="S2.SS4.SSS2.p3.1.m1.1.1.1.3.2" stretchy="false" xref="S2.SS4.SSS2.p3.1.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS2.p3.1.m1.1b"><apply id="S2.SS4.SSS2.p3.1.m1.1.2.cmml" xref="S2.SS4.SSS2.p3.1.m1.1.2"><csymbol cd="ambiguous" id="S2.SS4.SSS2.p3.1.m1.1.2.1.cmml" xref="S2.SS4.SSS2.p3.1.m1.1.2">superscript</csymbol><apply id="S2.SS4.SSS2.p3.1.m1.1.2.2.cmml" xref="S2.SS4.SSS2.p3.1.m1.1.2"><csymbol cd="ambiguous" id="S2.SS4.SSS2.p3.1.m1.1.2.2.1.cmml" xref="S2.SS4.SSS2.p3.1.m1.1.2">subscript</csymbol><ci id="S2.SS4.SSS2.p3.1.m1.1.2.2.2.cmml" xref="S2.SS4.SSS2.p3.1.m1.1.2.2.2">𝐧</ci><ci id="S2.SS4.SSS2.p3.1.m1.1.2.2.3.cmml" xref="S2.SS4.SSS2.p3.1.m1.1.2.2.3">𝑖</ci></apply><cn id="S2.SS4.SSS2.p3.1.m1.1.1.1.1.cmml" type="integer" xref="S2.SS4.SSS2.p3.1.m1.1.1.1.1">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS2.p3.1.m1.1c">\mathbf{n}_{i}^{(0)}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS2.p3.1.m1.1d">bold_n start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 0 ) end_POSTSUPERSCRIPT</annotation></semantics></math> and edge <math alttext="\mathbf{e}_{i}^{(0)}" class="ltx_Math" display="inline" id="S2.SS4.SSS2.p3.2.m2.1"><semantics id="S2.SS4.SSS2.p3.2.m2.1a"><msubsup id="S2.SS4.SSS2.p3.2.m2.1.2" xref="S2.SS4.SSS2.p3.2.m2.1.2.cmml"><mi id="S2.SS4.SSS2.p3.2.m2.1.2.2.2" xref="S2.SS4.SSS2.p3.2.m2.1.2.2.2.cmml">𝐞</mi><mi id="S2.SS4.SSS2.p3.2.m2.1.2.2.3" xref="S2.SS4.SSS2.p3.2.m2.1.2.2.3.cmml">i</mi><mrow id="S2.SS4.SSS2.p3.2.m2.1.1.1.3" xref="S2.SS4.SSS2.p3.2.m2.1.2.cmml"><mo id="S2.SS4.SSS2.p3.2.m2.1.1.1.3.1" stretchy="false" xref="S2.SS4.SSS2.p3.2.m2.1.2.cmml">(</mo><mn id="S2.SS4.SSS2.p3.2.m2.1.1.1.1" xref="S2.SS4.SSS2.p3.2.m2.1.1.1.1.cmml">0</mn><mo id="S2.SS4.SSS2.p3.2.m2.1.1.1.3.2" stretchy="false" xref="S2.SS4.SSS2.p3.2.m2.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS2.p3.2.m2.1b"><apply id="S2.SS4.SSS2.p3.2.m2.1.2.cmml" xref="S2.SS4.SSS2.p3.2.m2.1.2"><csymbol cd="ambiguous" id="S2.SS4.SSS2.p3.2.m2.1.2.1.cmml" xref="S2.SS4.SSS2.p3.2.m2.1.2">superscript</csymbol><apply id="S2.SS4.SSS2.p3.2.m2.1.2.2.cmml" xref="S2.SS4.SSS2.p3.2.m2.1.2"><csymbol cd="ambiguous" id="S2.SS4.SSS2.p3.2.m2.1.2.2.1.cmml" xref="S2.SS4.SSS2.p3.2.m2.1.2">subscript</csymbol><ci id="S2.SS4.SSS2.p3.2.m2.1.2.2.2.cmml" xref="S2.SS4.SSS2.p3.2.m2.1.2.2.2">𝐞</ci><ci id="S2.SS4.SSS2.p3.2.m2.1.2.2.3.cmml" xref="S2.SS4.SSS2.p3.2.m2.1.2.2.3">𝑖</ci></apply><cn id="S2.SS4.SSS2.p3.2.m2.1.1.1.1.cmml" type="integer" xref="S2.SS4.SSS2.p3.2.m2.1.1.1.1">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS2.p3.2.m2.1c">\mathbf{e}_{i}^{(0)}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS2.p3.2.m2.1d">bold_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 0 ) end_POSTSUPERSCRIPT</annotation></semantics></math> are first initialized with vectors corresponding to the node text and edge text encoded by <math alttext="\phi_{1}" class="ltx_Math" display="inline" id="S2.SS4.SSS2.p3.3.m3.1"><semantics id="S2.SS4.SSS2.p3.3.m3.1a"><msub id="S2.SS4.SSS2.p3.3.m3.1.1" xref="S2.SS4.SSS2.p3.3.m3.1.1.cmml"><mi id="S2.SS4.SSS2.p3.3.m3.1.1.2" xref="S2.SS4.SSS2.p3.3.m3.1.1.2.cmml">ϕ</mi><mn id="S2.SS4.SSS2.p3.3.m3.1.1.3" xref="S2.SS4.SSS2.p3.3.m3.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.SSS2.p3.3.m3.1b"><apply id="S2.SS4.SSS2.p3.3.m3.1.1.cmml" xref="S2.SS4.SSS2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS4.SSS2.p3.3.m3.1.1.1.cmml" xref="S2.SS4.SSS2.p3.3.m3.1.1">subscript</csymbol><ci id="S2.SS4.SSS2.p3.3.m3.1.1.2.cmml" xref="S2.SS4.SSS2.p3.3.m3.1.1.2">italic-ϕ</ci><cn id="S2.SS4.SSS2.p3.3.m3.1.1.3.cmml" type="integer" xref="S2.SS4.SSS2.p3.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.SSS2.p3.3.m3.1c">\phi_{1}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.SSS2.p3.3.m3.1d">italic_ϕ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>.
A message passing process is first conducted to fuse the semantic and structural information into each node representation.</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx4">
<tbody id="S2.E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{m}_{ij}^{(l)}=\mathbf{W}^{(l)}" class="ltx_Math" display="inline" id="S2.E8.m1.2"><semantics id="S2.E8.m1.2a"><mrow id="S2.E8.m1.2.3" xref="S2.E8.m1.2.3.cmml"><msubsup id="S2.E8.m1.2.3.2" xref="S2.E8.m1.2.3.2.cmml"><mi id="S2.E8.m1.2.3.2.2.2" xref="S2.E8.m1.2.3.2.2.2.cmml">𝐦</mi><mrow id="S2.E8.m1.2.3.2.2.3" xref="S2.E8.m1.2.3.2.2.3.cmml"><mi id="S2.E8.m1.2.3.2.2.3.2" xref="S2.E8.m1.2.3.2.2.3.2.cmml">i</mi><mo id="S2.E8.m1.2.3.2.2.3.1" xref="S2.E8.m1.2.3.2.2.3.1.cmml">⁢</mo><mi id="S2.E8.m1.2.3.2.2.3.3" xref="S2.E8.m1.2.3.2.2.3.3.cmml">j</mi></mrow><mrow id="S2.E8.m1.1.1.1.3" xref="S2.E8.m1.2.3.2.cmml"><mo id="S2.E8.m1.1.1.1.3.1" stretchy="false" xref="S2.E8.m1.2.3.2.cmml">(</mo><mi id="S2.E8.m1.1.1.1.1" xref="S2.E8.m1.1.1.1.1.cmml">l</mi><mo id="S2.E8.m1.1.1.1.3.2" stretchy="false" xref="S2.E8.m1.2.3.2.cmml">)</mo></mrow></msubsup><mo id="S2.E8.m1.2.3.1" xref="S2.E8.m1.2.3.1.cmml">=</mo><msup id="S2.E8.m1.2.3.3" xref="S2.E8.m1.2.3.3.cmml"><mi id="S2.E8.m1.2.3.3.2" xref="S2.E8.m1.2.3.3.2.cmml">𝐖</mi><mrow id="S2.E8.m1.2.2.1.3" xref="S2.E8.m1.2.3.3.cmml"><mo id="S2.E8.m1.2.2.1.3.1" stretchy="false" xref="S2.E8.m1.2.3.3.cmml">(</mo><mi id="S2.E8.m1.2.2.1.1" xref="S2.E8.m1.2.2.1.1.cmml">l</mi><mo id="S2.E8.m1.2.2.1.3.2" stretchy="false" xref="S2.E8.m1.2.3.3.cmml">)</mo></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.E8.m1.2b"><apply id="S2.E8.m1.2.3.cmml" xref="S2.E8.m1.2.3"><eq id="S2.E8.m1.2.3.1.cmml" xref="S2.E8.m1.2.3.1"></eq><apply id="S2.E8.m1.2.3.2.cmml" xref="S2.E8.m1.2.3.2"><csymbol cd="ambiguous" id="S2.E8.m1.2.3.2.1.cmml" xref="S2.E8.m1.2.3.2">superscript</csymbol><apply id="S2.E8.m1.2.3.2.2.cmml" xref="S2.E8.m1.2.3.2"><csymbol cd="ambiguous" id="S2.E8.m1.2.3.2.2.1.cmml" xref="S2.E8.m1.2.3.2">subscript</csymbol><ci id="S2.E8.m1.2.3.2.2.2.cmml" xref="S2.E8.m1.2.3.2.2.2">𝐦</ci><apply id="S2.E8.m1.2.3.2.2.3.cmml" xref="S2.E8.m1.2.3.2.2.3"><times id="S2.E8.m1.2.3.2.2.3.1.cmml" xref="S2.E8.m1.2.3.2.2.3.1"></times><ci id="S2.E8.m1.2.3.2.2.3.2.cmml" xref="S2.E8.m1.2.3.2.2.3.2">𝑖</ci><ci id="S2.E8.m1.2.3.2.2.3.3.cmml" xref="S2.E8.m1.2.3.2.2.3.3">𝑗</ci></apply></apply><ci id="S2.E8.m1.1.1.1.1.cmml" xref="S2.E8.m1.1.1.1.1">𝑙</ci></apply><apply id="S2.E8.m1.2.3.3.cmml" xref="S2.E8.m1.2.3.3"><csymbol cd="ambiguous" id="S2.E8.m1.2.3.3.1.cmml" xref="S2.E8.m1.2.3.3">superscript</csymbol><ci id="S2.E8.m1.2.3.3.2.cmml" xref="S2.E8.m1.2.3.3.2">𝐖</ci><ci id="S2.E8.m1.2.2.1.1.cmml" xref="S2.E8.m1.2.2.1.1">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E8.m1.2c">\displaystyle\mathbf{m}_{ij}^{(l)}=\mathbf{W}^{(l)}</annotation><annotation encoding="application/x-llamapun" id="S2.E8.m1.2d">bold_m start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT = bold_W start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle(\mathbf{n}_{i}^{(l-1)}\|\mathbf{e}_{ij}^{(l-1)})," class="ltx_Math" display="inline" id="S2.E8.m2.3"><semantics id="S2.E8.m2.3a"><mrow id="S2.E8.m2.3.3.1"><mrow id="S2.E8.m2.3.3.1.1.1" xref="S2.E8.m2.3.3.1.1.1.1.cmml"><mo id="S2.E8.m2.3.3.1.1.1.2" stretchy="false" xref="S2.E8.m2.3.3.1.1.1.1.cmml">(</mo><mrow id="S2.E8.m2.3.3.1.1.1.1" xref="S2.E8.m2.3.3.1.1.1.1.cmml"><msubsup id="S2.E8.m2.3.3.1.1.1.1.2" xref="S2.E8.m2.3.3.1.1.1.1.2.cmml"><mi id="S2.E8.m2.3.3.1.1.1.1.2.2.2" xref="S2.E8.m2.3.3.1.1.1.1.2.2.2.cmml">𝐧</mi><mi id="S2.E8.m2.3.3.1.1.1.1.2.2.3" xref="S2.E8.m2.3.3.1.1.1.1.2.2.3.cmml">i</mi><mrow id="S2.E8.m2.1.1.1.1" xref="S2.E8.m2.1.1.1.1.1.cmml"><mo id="S2.E8.m2.1.1.1.1.2" stretchy="false" xref="S2.E8.m2.1.1.1.1.1.cmml">(</mo><mrow id="S2.E8.m2.1.1.1.1.1" xref="S2.E8.m2.1.1.1.1.1.cmml"><mi id="S2.E8.m2.1.1.1.1.1.2" xref="S2.E8.m2.1.1.1.1.1.2.cmml">l</mi><mo id="S2.E8.m2.1.1.1.1.1.1" xref="S2.E8.m2.1.1.1.1.1.1.cmml">−</mo><mn id="S2.E8.m2.1.1.1.1.1.3" xref="S2.E8.m2.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S2.E8.m2.1.1.1.1.3" stretchy="false" xref="S2.E8.m2.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S2.E8.m2.3.3.1.1.1.1.1" xref="S2.E8.m2.3.3.1.1.1.1.1.cmml">∥</mo><msubsup id="S2.E8.m2.3.3.1.1.1.1.3" xref="S2.E8.m2.3.3.1.1.1.1.3.cmml"><mi id="S2.E8.m2.3.3.1.1.1.1.3.2.2" xref="S2.E8.m2.3.3.1.1.1.1.3.2.2.cmml">𝐞</mi><mrow id="S2.E8.m2.3.3.1.1.1.1.3.2.3" xref="S2.E8.m2.3.3.1.1.1.1.3.2.3.cmml"><mi id="S2.E8.m2.3.3.1.1.1.1.3.2.3.2" xref="S2.E8.m2.3.3.1.1.1.1.3.2.3.2.cmml">i</mi><mo id="S2.E8.m2.3.3.1.1.1.1.3.2.3.1" xref="S2.E8.m2.3.3.1.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S2.E8.m2.3.3.1.1.1.1.3.2.3.3" xref="S2.E8.m2.3.3.1.1.1.1.3.2.3.3.cmml">j</mi></mrow><mrow id="S2.E8.m2.2.2.1.1" xref="S2.E8.m2.2.2.1.1.1.cmml"><mo id="S2.E8.m2.2.2.1.1.2" stretchy="false" xref="S2.E8.m2.2.2.1.1.1.cmml">(</mo><mrow id="S2.E8.m2.2.2.1.1.1" xref="S2.E8.m2.2.2.1.1.1.cmml"><mi id="S2.E8.m2.2.2.1.1.1.2" xref="S2.E8.m2.2.2.1.1.1.2.cmml">l</mi><mo id="S2.E8.m2.2.2.1.1.1.1" xref="S2.E8.m2.2.2.1.1.1.1.cmml">−</mo><mn id="S2.E8.m2.2.2.1.1.1.3" xref="S2.E8.m2.2.2.1.1.1.3.cmml">1</mn></mrow><mo id="S2.E8.m2.2.2.1.1.3" stretchy="false" xref="S2.E8.m2.2.2.1.1.1.cmml">)</mo></mrow></msubsup></mrow><mo id="S2.E8.m2.3.3.1.1.1.3" stretchy="false" xref="S2.E8.m2.3.3.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E8.m2.3.3.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E8.m2.3b"><apply id="S2.E8.m2.3.3.1.1.1.1.cmml" xref="S2.E8.m2.3.3.1.1.1"><csymbol cd="latexml" id="S2.E8.m2.3.3.1.1.1.1.1.cmml" xref="S2.E8.m2.3.3.1.1.1.1.1">conditional</csymbol><apply id="S2.E8.m2.3.3.1.1.1.1.2.cmml" xref="S2.E8.m2.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E8.m2.3.3.1.1.1.1.2.1.cmml" xref="S2.E8.m2.3.3.1.1.1.1.2">superscript</csymbol><apply id="S2.E8.m2.3.3.1.1.1.1.2.2.cmml" xref="S2.E8.m2.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E8.m2.3.3.1.1.1.1.2.2.1.cmml" xref="S2.E8.m2.3.3.1.1.1.1.2">subscript</csymbol><ci id="S2.E8.m2.3.3.1.1.1.1.2.2.2.cmml" xref="S2.E8.m2.3.3.1.1.1.1.2.2.2">𝐧</ci><ci id="S2.E8.m2.3.3.1.1.1.1.2.2.3.cmml" xref="S2.E8.m2.3.3.1.1.1.1.2.2.3">𝑖</ci></apply><apply id="S2.E8.m2.1.1.1.1.1.cmml" xref="S2.E8.m2.1.1.1.1"><minus id="S2.E8.m2.1.1.1.1.1.1.cmml" xref="S2.E8.m2.1.1.1.1.1.1"></minus><ci id="S2.E8.m2.1.1.1.1.1.2.cmml" xref="S2.E8.m2.1.1.1.1.1.2">𝑙</ci><cn id="S2.E8.m2.1.1.1.1.1.3.cmml" type="integer" xref="S2.E8.m2.1.1.1.1.1.3">1</cn></apply></apply><apply id="S2.E8.m2.3.3.1.1.1.1.3.cmml" xref="S2.E8.m2.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E8.m2.3.3.1.1.1.1.3.1.cmml" xref="S2.E8.m2.3.3.1.1.1.1.3">superscript</csymbol><apply id="S2.E8.m2.3.3.1.1.1.1.3.2.cmml" xref="S2.E8.m2.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E8.m2.3.3.1.1.1.1.3.2.1.cmml" xref="S2.E8.m2.3.3.1.1.1.1.3">subscript</csymbol><ci id="S2.E8.m2.3.3.1.1.1.1.3.2.2.cmml" xref="S2.E8.m2.3.3.1.1.1.1.3.2.2">𝐞</ci><apply id="S2.E8.m2.3.3.1.1.1.1.3.2.3.cmml" xref="S2.E8.m2.3.3.1.1.1.1.3.2.3"><times id="S2.E8.m2.3.3.1.1.1.1.3.2.3.1.cmml" xref="S2.E8.m2.3.3.1.1.1.1.3.2.3.1"></times><ci id="S2.E8.m2.3.3.1.1.1.1.3.2.3.2.cmml" xref="S2.E8.m2.3.3.1.1.1.1.3.2.3.2">𝑖</ci><ci id="S2.E8.m2.3.3.1.1.1.1.3.2.3.3.cmml" xref="S2.E8.m2.3.3.1.1.1.1.3.2.3.3">𝑗</ci></apply></apply><apply id="S2.E8.m2.2.2.1.1.1.cmml" xref="S2.E8.m2.2.2.1.1"><minus id="S2.E8.m2.2.2.1.1.1.1.cmml" xref="S2.E8.m2.2.2.1.1.1.1"></minus><ci id="S2.E8.m2.2.2.1.1.1.2.cmml" xref="S2.E8.m2.2.2.1.1.1.2">𝑙</ci><cn id="S2.E8.m2.2.2.1.1.1.3.cmml" type="integer" xref="S2.E8.m2.2.2.1.1.1.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E8.m2.3c">\displaystyle(\mathbf{n}_{i}^{(l-1)}\|\mathbf{e}_{ij}^{(l-1)}),</annotation><annotation encoding="application/x-llamapun" id="S2.E8.m2.3d">( bold_n start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l - 1 ) end_POSTSUPERSCRIPT ∥ bold_e start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l - 1 ) end_POSTSUPERSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
<tbody id="S2.E9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle Q_{j}^{(l)}=" class="ltx_Math" display="inline" id="S2.E9.m1.1"><semantics id="S2.E9.m1.1a"><mrow id="S2.E9.m1.1.2" xref="S2.E9.m1.1.2.cmml"><msubsup id="S2.E9.m1.1.2.2" xref="S2.E9.m1.1.2.2.cmml"><mi id="S2.E9.m1.1.2.2.2.2" xref="S2.E9.m1.1.2.2.2.2.cmml">Q</mi><mi id="S2.E9.m1.1.2.2.2.3" xref="S2.E9.m1.1.2.2.2.3.cmml">j</mi><mrow id="S2.E9.m1.1.1.1.3" xref="S2.E9.m1.1.2.2.cmml"><mo id="S2.E9.m1.1.1.1.3.1" stretchy="false" xref="S2.E9.m1.1.2.2.cmml">(</mo><mi id="S2.E9.m1.1.1.1.1" xref="S2.E9.m1.1.1.1.1.cmml">l</mi><mo id="S2.E9.m1.1.1.1.3.2" stretchy="false" xref="S2.E9.m1.1.2.2.cmml">)</mo></mrow></msubsup><mo id="S2.E9.m1.1.2.1" xref="S2.E9.m1.1.2.1.cmml">=</mo><mi id="S2.E9.m1.1.2.3" xref="S2.E9.m1.1.2.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S2.E9.m1.1b"><apply id="S2.E9.m1.1.2.cmml" xref="S2.E9.m1.1.2"><eq id="S2.E9.m1.1.2.1.cmml" xref="S2.E9.m1.1.2.1"></eq><apply id="S2.E9.m1.1.2.2.cmml" xref="S2.E9.m1.1.2.2"><csymbol cd="ambiguous" id="S2.E9.m1.1.2.2.1.cmml" xref="S2.E9.m1.1.2.2">superscript</csymbol><apply id="S2.E9.m1.1.2.2.2.cmml" xref="S2.E9.m1.1.2.2"><csymbol cd="ambiguous" id="S2.E9.m1.1.2.2.2.1.cmml" xref="S2.E9.m1.1.2.2">subscript</csymbol><ci id="S2.E9.m1.1.2.2.2.2.cmml" xref="S2.E9.m1.1.2.2.2.2">𝑄</ci><ci id="S2.E9.m1.1.2.2.2.3.cmml" xref="S2.E9.m1.1.2.2.2.3">𝑗</ci></apply><ci id="S2.E9.m1.1.1.1.1.cmml" xref="S2.E9.m1.1.1.1.1">𝑙</ci></apply><csymbol cd="latexml" id="S2.E9.m1.1.2.3.cmml" xref="S2.E9.m1.1.2.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E9.m1.1c">\displaystyle Q_{j}^{(l)}=</annotation><annotation encoding="application/x-llamapun" id="S2.E9.m1.1d">italic_Q start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT =</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\mathbf{W_{Q}}^{(l)}\mathbf{n}_{j}^{(l-1)}," class="ltx_Math" display="inline" id="S2.E9.m2.3"><semantics id="S2.E9.m2.3a"><mrow id="S2.E9.m2.3.3.1" xref="S2.E9.m2.3.3.1.1.cmml"><mrow id="S2.E9.m2.3.3.1.1" xref="S2.E9.m2.3.3.1.1.cmml"><mmultiscripts id="S2.E9.m2.3.3.1.1.2" xref="S2.E9.m2.3.3.1.1.2.cmml"><mi id="S2.E9.m2.3.3.1.1.2.2.2" xref="S2.E9.m2.3.3.1.1.2.2.2.cmml">𝐖</mi><mi id="S2.E9.m2.3.3.1.1.2.2.3" xref="S2.E9.m2.3.3.1.1.2.2.3.cmml">𝐐</mi><mrow id="S2.E9.m2.3.3.1.1.2a" xref="S2.E9.m2.3.3.1.1.2.cmml"></mrow><mrow id="S2.E9.m2.3.3.1.1.2b" xref="S2.E9.m2.3.3.1.1.2.cmml"></mrow><mrow id="S2.E9.m2.1.1.1.3" xref="S2.E9.m2.3.3.1.1.2.cmml"><mo id="S2.E9.m2.1.1.1.3.1" stretchy="false" xref="S2.E9.m2.3.3.1.1.2.cmml">(</mo><mi id="S2.E9.m2.1.1.1.1" xref="S2.E9.m2.1.1.1.1.cmml">l</mi><mo id="S2.E9.m2.1.1.1.3.2" stretchy="false" xref="S2.E9.m2.3.3.1.1.2.cmml">)</mo></mrow></mmultiscripts><mo id="S2.E9.m2.3.3.1.1.1" xref="S2.E9.m2.3.3.1.1.1.cmml">⁢</mo><msubsup id="S2.E9.m2.3.3.1.1.3" xref="S2.E9.m2.3.3.1.1.3.cmml"><mi id="S2.E9.m2.3.3.1.1.3.2.2" xref="S2.E9.m2.3.3.1.1.3.2.2.cmml">𝐧</mi><mi id="S2.E9.m2.3.3.1.1.3.2.3" xref="S2.E9.m2.3.3.1.1.3.2.3.cmml">j</mi><mrow id="S2.E9.m2.2.2.1.1" xref="S2.E9.m2.2.2.1.1.1.cmml"><mo id="S2.E9.m2.2.2.1.1.2" stretchy="false" xref="S2.E9.m2.2.2.1.1.1.cmml">(</mo><mrow id="S2.E9.m2.2.2.1.1.1" xref="S2.E9.m2.2.2.1.1.1.cmml"><mi id="S2.E9.m2.2.2.1.1.1.2" xref="S2.E9.m2.2.2.1.1.1.2.cmml">l</mi><mo id="S2.E9.m2.2.2.1.1.1.1" xref="S2.E9.m2.2.2.1.1.1.1.cmml">−</mo><mn id="S2.E9.m2.2.2.1.1.1.3" xref="S2.E9.m2.2.2.1.1.1.3.cmml">1</mn></mrow><mo id="S2.E9.m2.2.2.1.1.3" stretchy="false" xref="S2.E9.m2.2.2.1.1.1.cmml">)</mo></mrow></msubsup></mrow><mo id="S2.E9.m2.3.3.1.2" xref="S2.E9.m2.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E9.m2.3b"><apply id="S2.E9.m2.3.3.1.1.cmml" xref="S2.E9.m2.3.3.1"><times id="S2.E9.m2.3.3.1.1.1.cmml" xref="S2.E9.m2.3.3.1.1.1"></times><apply id="S2.E9.m2.3.3.1.1.2.cmml" xref="S2.E9.m2.3.3.1.1.2"><csymbol cd="ambiguous" id="S2.E9.m2.3.3.1.1.2.1.cmml" xref="S2.E9.m2.3.3.1.1.2">superscript</csymbol><apply id="S2.E9.m2.3.3.1.1.2.2.cmml" xref="S2.E9.m2.3.3.1.1.2"><csymbol cd="ambiguous" id="S2.E9.m2.3.3.1.1.2.2.1.cmml" xref="S2.E9.m2.3.3.1.1.2">subscript</csymbol><ci id="S2.E9.m2.3.3.1.1.2.2.2.cmml" xref="S2.E9.m2.3.3.1.1.2.2.2">𝐖</ci><ci id="S2.E9.m2.3.3.1.1.2.2.3.cmml" xref="S2.E9.m2.3.3.1.1.2.2.3">𝐐</ci></apply><ci id="S2.E9.m2.1.1.1.1.cmml" xref="S2.E9.m2.1.1.1.1">𝑙</ci></apply><apply id="S2.E9.m2.3.3.1.1.3.cmml" xref="S2.E9.m2.3.3.1.1.3"><csymbol cd="ambiguous" id="S2.E9.m2.3.3.1.1.3.1.cmml" xref="S2.E9.m2.3.3.1.1.3">superscript</csymbol><apply id="S2.E9.m2.3.3.1.1.3.2.cmml" xref="S2.E9.m2.3.3.1.1.3"><csymbol cd="ambiguous" id="S2.E9.m2.3.3.1.1.3.2.1.cmml" xref="S2.E9.m2.3.3.1.1.3">subscript</csymbol><ci id="S2.E9.m2.3.3.1.1.3.2.2.cmml" xref="S2.E9.m2.3.3.1.1.3.2.2">𝐧</ci><ci id="S2.E9.m2.3.3.1.1.3.2.3.cmml" xref="S2.E9.m2.3.3.1.1.3.2.3">𝑗</ci></apply><apply id="S2.E9.m2.2.2.1.1.1.cmml" xref="S2.E9.m2.2.2.1.1"><minus id="S2.E9.m2.2.2.1.1.1.1.cmml" xref="S2.E9.m2.2.2.1.1.1.1"></minus><ci id="S2.E9.m2.2.2.1.1.1.2.cmml" xref="S2.E9.m2.2.2.1.1.1.2">𝑙</ci><cn id="S2.E9.m2.2.2.1.1.1.3.cmml" type="integer" xref="S2.E9.m2.2.2.1.1.1.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E9.m2.3c">\displaystyle\mathbf{W_{Q}}^{(l)}\mathbf{n}_{j}^{(l-1)},</annotation><annotation encoding="application/x-llamapun" id="S2.E9.m2.3d">bold_W start_POSTSUBSCRIPT bold_Q end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT bold_n start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l - 1 ) end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
<tbody id="S2.E10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{K}_{ij}^{(l)}=\mathbf{W_{K}}^{(l)}m_{ij}^{(l)}," class="ltx_Math" display="inline" id="S2.E10.m1.4"><semantics id="S2.E10.m1.4a"><mrow id="S2.E10.m1.4.4.1" xref="S2.E10.m1.4.4.1.1.cmml"><mrow id="S2.E10.m1.4.4.1.1" xref="S2.E10.m1.4.4.1.1.cmml"><msubsup id="S2.E10.m1.4.4.1.1.2" xref="S2.E10.m1.4.4.1.1.2.cmml"><mi id="S2.E10.m1.4.4.1.1.2.2.2" xref="S2.E10.m1.4.4.1.1.2.2.2.cmml">𝐊</mi><mrow id="S2.E10.m1.4.4.1.1.2.2.3" xref="S2.E10.m1.4.4.1.1.2.2.3.cmml"><mi id="S2.E10.m1.4.4.1.1.2.2.3.2" xref="S2.E10.m1.4.4.1.1.2.2.3.2.cmml">i</mi><mo id="S2.E10.m1.4.4.1.1.2.2.3.1" xref="S2.E10.m1.4.4.1.1.2.2.3.1.cmml">⁢</mo><mi id="S2.E10.m1.4.4.1.1.2.2.3.3" xref="S2.E10.m1.4.4.1.1.2.2.3.3.cmml">j</mi></mrow><mrow id="S2.E10.m1.1.1.1.3" xref="S2.E10.m1.4.4.1.1.2.cmml"><mo id="S2.E10.m1.1.1.1.3.1" stretchy="false" xref="S2.E10.m1.4.4.1.1.2.cmml">(</mo><mi id="S2.E10.m1.1.1.1.1" xref="S2.E10.m1.1.1.1.1.cmml">l</mi><mo id="S2.E10.m1.1.1.1.3.2" stretchy="false" xref="S2.E10.m1.4.4.1.1.2.cmml">)</mo></mrow></msubsup><mo id="S2.E10.m1.4.4.1.1.1" xref="S2.E10.m1.4.4.1.1.1.cmml">=</mo><mrow id="S2.E10.m1.4.4.1.1.3" xref="S2.E10.m1.4.4.1.1.3.cmml"><mmultiscripts id="S2.E10.m1.4.4.1.1.3.2" xref="S2.E10.m1.4.4.1.1.3.2.cmml"><mi id="S2.E10.m1.4.4.1.1.3.2.2.2" xref="S2.E10.m1.4.4.1.1.3.2.2.2.cmml">𝐖</mi><mi id="S2.E10.m1.4.4.1.1.3.2.2.3" xref="S2.E10.m1.4.4.1.1.3.2.2.3.cmml">𝐊</mi><mrow id="S2.E10.m1.4.4.1.1.3.2a" xref="S2.E10.m1.4.4.1.1.3.2.cmml"></mrow><mrow id="S2.E10.m1.4.4.1.1.3.2b" xref="S2.E10.m1.4.4.1.1.3.2.cmml"></mrow><mrow id="S2.E10.m1.2.2.1.3" xref="S2.E10.m1.4.4.1.1.3.2.cmml"><mo id="S2.E10.m1.2.2.1.3.1" stretchy="false" xref="S2.E10.m1.4.4.1.1.3.2.cmml">(</mo><mi id="S2.E10.m1.2.2.1.1" xref="S2.E10.m1.2.2.1.1.cmml">l</mi><mo id="S2.E10.m1.2.2.1.3.2" stretchy="false" xref="S2.E10.m1.4.4.1.1.3.2.cmml">)</mo></mrow></mmultiscripts><mo id="S2.E10.m1.4.4.1.1.3.1" xref="S2.E10.m1.4.4.1.1.3.1.cmml">⁢</mo><msubsup id="S2.E10.m1.4.4.1.1.3.3" xref="S2.E10.m1.4.4.1.1.3.3.cmml"><mi id="S2.E10.m1.4.4.1.1.3.3.2.2" xref="S2.E10.m1.4.4.1.1.3.3.2.2.cmml">m</mi><mrow id="S2.E10.m1.4.4.1.1.3.3.2.3" xref="S2.E10.m1.4.4.1.1.3.3.2.3.cmml"><mi id="S2.E10.m1.4.4.1.1.3.3.2.3.2" xref="S2.E10.m1.4.4.1.1.3.3.2.3.2.cmml">i</mi><mo id="S2.E10.m1.4.4.1.1.3.3.2.3.1" xref="S2.E10.m1.4.4.1.1.3.3.2.3.1.cmml">⁢</mo><mi id="S2.E10.m1.4.4.1.1.3.3.2.3.3" xref="S2.E10.m1.4.4.1.1.3.3.2.3.3.cmml">j</mi></mrow><mrow id="S2.E10.m1.3.3.1.3" xref="S2.E10.m1.4.4.1.1.3.3.cmml"><mo id="S2.E10.m1.3.3.1.3.1" stretchy="false" xref="S2.E10.m1.4.4.1.1.3.3.cmml">(</mo><mi id="S2.E10.m1.3.3.1.1" xref="S2.E10.m1.3.3.1.1.cmml">l</mi><mo id="S2.E10.m1.3.3.1.3.2" stretchy="false" xref="S2.E10.m1.4.4.1.1.3.3.cmml">)</mo></mrow></msubsup></mrow></mrow><mo id="S2.E10.m1.4.4.1.2" xref="S2.E10.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E10.m1.4b"><apply id="S2.E10.m1.4.4.1.1.cmml" xref="S2.E10.m1.4.4.1"><eq id="S2.E10.m1.4.4.1.1.1.cmml" xref="S2.E10.m1.4.4.1.1.1"></eq><apply id="S2.E10.m1.4.4.1.1.2.cmml" xref="S2.E10.m1.4.4.1.1.2"><csymbol cd="ambiguous" id="S2.E10.m1.4.4.1.1.2.1.cmml" xref="S2.E10.m1.4.4.1.1.2">superscript</csymbol><apply id="S2.E10.m1.4.4.1.1.2.2.cmml" xref="S2.E10.m1.4.4.1.1.2"><csymbol cd="ambiguous" id="S2.E10.m1.4.4.1.1.2.2.1.cmml" xref="S2.E10.m1.4.4.1.1.2">subscript</csymbol><ci id="S2.E10.m1.4.4.1.1.2.2.2.cmml" xref="S2.E10.m1.4.4.1.1.2.2.2">𝐊</ci><apply id="S2.E10.m1.4.4.1.1.2.2.3.cmml" xref="S2.E10.m1.4.4.1.1.2.2.3"><times id="S2.E10.m1.4.4.1.1.2.2.3.1.cmml" xref="S2.E10.m1.4.4.1.1.2.2.3.1"></times><ci id="S2.E10.m1.4.4.1.1.2.2.3.2.cmml" xref="S2.E10.m1.4.4.1.1.2.2.3.2">𝑖</ci><ci id="S2.E10.m1.4.4.1.1.2.2.3.3.cmml" xref="S2.E10.m1.4.4.1.1.2.2.3.3">𝑗</ci></apply></apply><ci id="S2.E10.m1.1.1.1.1.cmml" xref="S2.E10.m1.1.1.1.1">𝑙</ci></apply><apply id="S2.E10.m1.4.4.1.1.3.cmml" xref="S2.E10.m1.4.4.1.1.3"><times id="S2.E10.m1.4.4.1.1.3.1.cmml" xref="S2.E10.m1.4.4.1.1.3.1"></times><apply id="S2.E10.m1.4.4.1.1.3.2.cmml" xref="S2.E10.m1.4.4.1.1.3.2"><csymbol cd="ambiguous" id="S2.E10.m1.4.4.1.1.3.2.1.cmml" xref="S2.E10.m1.4.4.1.1.3.2">superscript</csymbol><apply id="S2.E10.m1.4.4.1.1.3.2.2.cmml" xref="S2.E10.m1.4.4.1.1.3.2"><csymbol cd="ambiguous" id="S2.E10.m1.4.4.1.1.3.2.2.1.cmml" xref="S2.E10.m1.4.4.1.1.3.2">subscript</csymbol><ci id="S2.E10.m1.4.4.1.1.3.2.2.2.cmml" xref="S2.E10.m1.4.4.1.1.3.2.2.2">𝐖</ci><ci id="S2.E10.m1.4.4.1.1.3.2.2.3.cmml" xref="S2.E10.m1.4.4.1.1.3.2.2.3">𝐊</ci></apply><ci id="S2.E10.m1.2.2.1.1.cmml" xref="S2.E10.m1.2.2.1.1">𝑙</ci></apply><apply id="S2.E10.m1.4.4.1.1.3.3.cmml" xref="S2.E10.m1.4.4.1.1.3.3"><csymbol cd="ambiguous" id="S2.E10.m1.4.4.1.1.3.3.1.cmml" xref="S2.E10.m1.4.4.1.1.3.3">superscript</csymbol><apply id="S2.E10.m1.4.4.1.1.3.3.2.cmml" xref="S2.E10.m1.4.4.1.1.3.3"><csymbol cd="ambiguous" id="S2.E10.m1.4.4.1.1.3.3.2.1.cmml" xref="S2.E10.m1.4.4.1.1.3.3">subscript</csymbol><ci id="S2.E10.m1.4.4.1.1.3.3.2.2.cmml" xref="S2.E10.m1.4.4.1.1.3.3.2.2">𝑚</ci><apply id="S2.E10.m1.4.4.1.1.3.3.2.3.cmml" xref="S2.E10.m1.4.4.1.1.3.3.2.3"><times id="S2.E10.m1.4.4.1.1.3.3.2.3.1.cmml" xref="S2.E10.m1.4.4.1.1.3.3.2.3.1"></times><ci id="S2.E10.m1.4.4.1.1.3.3.2.3.2.cmml" xref="S2.E10.m1.4.4.1.1.3.3.2.3.2">𝑖</ci><ci id="S2.E10.m1.4.4.1.1.3.3.2.3.3.cmml" xref="S2.E10.m1.4.4.1.1.3.3.2.3.3">𝑗</ci></apply></apply><ci id="S2.E10.m1.3.3.1.1.cmml" xref="S2.E10.m1.3.3.1.1">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E10.m1.4c">\displaystyle\mathbf{K}_{ij}^{(l)}=\mathbf{W_{K}}^{(l)}m_{ij}^{(l)},</annotation><annotation encoding="application/x-llamapun" id="S2.E10.m1.4d">bold_K start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT = bold_W start_POSTSUBSCRIPT bold_K end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT italic_m start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\text{\quad}\mathbf{V}_{ij}^{(l)}=\mathbf{W_{V}}^{(l)}\mathbf{m}_%
{ij}^{(l)}," class="ltx_Math" display="inline" id="S2.E10.m2.4"><semantics id="S2.E10.m2.4a"><mrow id="S2.E10.m2.4.4.1" xref="S2.E10.m2.4.4.1.1.cmml"><mrow id="S2.E10.m2.4.4.1.1" xref="S2.E10.m2.4.4.1.1.cmml"><mrow id="S2.E10.m2.4.4.1.1.2" xref="S2.E10.m2.4.4.1.1.2.cmml"><mtext id="S2.E10.m2.4.4.1.1.2.2" xref="S2.E10.m2.4.4.1.1.2.2a.cmml"> </mtext><mo id="S2.E10.m2.4.4.1.1.2.1" xref="S2.E10.m2.4.4.1.1.2.1.cmml">⁢</mo><msubsup id="S2.E10.m2.4.4.1.1.2.3" xref="S2.E10.m2.4.4.1.1.2.3.cmml"><mi id="S2.E10.m2.4.4.1.1.2.3.2.2" xref="S2.E10.m2.4.4.1.1.2.3.2.2.cmml">𝐕</mi><mrow id="S2.E10.m2.4.4.1.1.2.3.2.3" xref="S2.E10.m2.4.4.1.1.2.3.2.3.cmml"><mi id="S2.E10.m2.4.4.1.1.2.3.2.3.2" xref="S2.E10.m2.4.4.1.1.2.3.2.3.2.cmml">i</mi><mo id="S2.E10.m2.4.4.1.1.2.3.2.3.1" xref="S2.E10.m2.4.4.1.1.2.3.2.3.1.cmml">⁢</mo><mi id="S2.E10.m2.4.4.1.1.2.3.2.3.3" xref="S2.E10.m2.4.4.1.1.2.3.2.3.3.cmml">j</mi></mrow><mrow id="S2.E10.m2.1.1.1.3" xref="S2.E10.m2.4.4.1.1.2.3.cmml"><mo id="S2.E10.m2.1.1.1.3.1" stretchy="false" xref="S2.E10.m2.4.4.1.1.2.3.cmml">(</mo><mi id="S2.E10.m2.1.1.1.1" xref="S2.E10.m2.1.1.1.1.cmml">l</mi><mo id="S2.E10.m2.1.1.1.3.2" stretchy="false" xref="S2.E10.m2.4.4.1.1.2.3.cmml">)</mo></mrow></msubsup></mrow><mo id="S2.E10.m2.4.4.1.1.1" xref="S2.E10.m2.4.4.1.1.1.cmml">=</mo><mrow id="S2.E10.m2.4.4.1.1.3" xref="S2.E10.m2.4.4.1.1.3.cmml"><mmultiscripts id="S2.E10.m2.4.4.1.1.3.2" xref="S2.E10.m2.4.4.1.1.3.2.cmml"><mi id="S2.E10.m2.4.4.1.1.3.2.2.2" xref="S2.E10.m2.4.4.1.1.3.2.2.2.cmml">𝐖</mi><mi id="S2.E10.m2.4.4.1.1.3.2.2.3" xref="S2.E10.m2.4.4.1.1.3.2.2.3.cmml">𝐕</mi><mrow id="S2.E10.m2.4.4.1.1.3.2a" xref="S2.E10.m2.4.4.1.1.3.2.cmml"></mrow><mrow id="S2.E10.m2.4.4.1.1.3.2b" xref="S2.E10.m2.4.4.1.1.3.2.cmml"></mrow><mrow id="S2.E10.m2.2.2.1.3" xref="S2.E10.m2.4.4.1.1.3.2.cmml"><mo id="S2.E10.m2.2.2.1.3.1" stretchy="false" xref="S2.E10.m2.4.4.1.1.3.2.cmml">(</mo><mi id="S2.E10.m2.2.2.1.1" xref="S2.E10.m2.2.2.1.1.cmml">l</mi><mo id="S2.E10.m2.2.2.1.3.2" stretchy="false" xref="S2.E10.m2.4.4.1.1.3.2.cmml">)</mo></mrow></mmultiscripts><mo id="S2.E10.m2.4.4.1.1.3.1" xref="S2.E10.m2.4.4.1.1.3.1.cmml">⁢</mo><msubsup id="S2.E10.m2.4.4.1.1.3.3" xref="S2.E10.m2.4.4.1.1.3.3.cmml"><mi id="S2.E10.m2.4.4.1.1.3.3.2.2" xref="S2.E10.m2.4.4.1.1.3.3.2.2.cmml">𝐦</mi><mrow id="S2.E10.m2.4.4.1.1.3.3.2.3" xref="S2.E10.m2.4.4.1.1.3.3.2.3.cmml"><mi id="S2.E10.m2.4.4.1.1.3.3.2.3.2" xref="S2.E10.m2.4.4.1.1.3.3.2.3.2.cmml">i</mi><mo id="S2.E10.m2.4.4.1.1.3.3.2.3.1" xref="S2.E10.m2.4.4.1.1.3.3.2.3.1.cmml">⁢</mo><mi id="S2.E10.m2.4.4.1.1.3.3.2.3.3" xref="S2.E10.m2.4.4.1.1.3.3.2.3.3.cmml">j</mi></mrow><mrow id="S2.E10.m2.3.3.1.3" xref="S2.E10.m2.4.4.1.1.3.3.cmml"><mo id="S2.E10.m2.3.3.1.3.1" stretchy="false" xref="S2.E10.m2.4.4.1.1.3.3.cmml">(</mo><mi id="S2.E10.m2.3.3.1.1" xref="S2.E10.m2.3.3.1.1.cmml">l</mi><mo id="S2.E10.m2.3.3.1.3.2" stretchy="false" xref="S2.E10.m2.4.4.1.1.3.3.cmml">)</mo></mrow></msubsup></mrow></mrow><mo id="S2.E10.m2.4.4.1.2" xref="S2.E10.m2.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E10.m2.4b"><apply id="S2.E10.m2.4.4.1.1.cmml" xref="S2.E10.m2.4.4.1"><eq id="S2.E10.m2.4.4.1.1.1.cmml" xref="S2.E10.m2.4.4.1.1.1"></eq><apply id="S2.E10.m2.4.4.1.1.2.cmml" xref="S2.E10.m2.4.4.1.1.2"><times id="S2.E10.m2.4.4.1.1.2.1.cmml" xref="S2.E10.m2.4.4.1.1.2.1"></times><ci id="S2.E10.m2.4.4.1.1.2.2a.cmml" xref="S2.E10.m2.4.4.1.1.2.2"><mtext id="S2.E10.m2.4.4.1.1.2.2.cmml" xref="S2.E10.m2.4.4.1.1.2.2"> </mtext></ci><apply id="S2.E10.m2.4.4.1.1.2.3.cmml" xref="S2.E10.m2.4.4.1.1.2.3"><csymbol cd="ambiguous" id="S2.E10.m2.4.4.1.1.2.3.1.cmml" xref="S2.E10.m2.4.4.1.1.2.3">superscript</csymbol><apply id="S2.E10.m2.4.4.1.1.2.3.2.cmml" xref="S2.E10.m2.4.4.1.1.2.3"><csymbol cd="ambiguous" id="S2.E10.m2.4.4.1.1.2.3.2.1.cmml" xref="S2.E10.m2.4.4.1.1.2.3">subscript</csymbol><ci id="S2.E10.m2.4.4.1.1.2.3.2.2.cmml" xref="S2.E10.m2.4.4.1.1.2.3.2.2">𝐕</ci><apply id="S2.E10.m2.4.4.1.1.2.3.2.3.cmml" xref="S2.E10.m2.4.4.1.1.2.3.2.3"><times id="S2.E10.m2.4.4.1.1.2.3.2.3.1.cmml" xref="S2.E10.m2.4.4.1.1.2.3.2.3.1"></times><ci id="S2.E10.m2.4.4.1.1.2.3.2.3.2.cmml" xref="S2.E10.m2.4.4.1.1.2.3.2.3.2">𝑖</ci><ci id="S2.E10.m2.4.4.1.1.2.3.2.3.3.cmml" xref="S2.E10.m2.4.4.1.1.2.3.2.3.3">𝑗</ci></apply></apply><ci id="S2.E10.m2.1.1.1.1.cmml" xref="S2.E10.m2.1.1.1.1">𝑙</ci></apply></apply><apply id="S2.E10.m2.4.4.1.1.3.cmml" xref="S2.E10.m2.4.4.1.1.3"><times id="S2.E10.m2.4.4.1.1.3.1.cmml" xref="S2.E10.m2.4.4.1.1.3.1"></times><apply id="S2.E10.m2.4.4.1.1.3.2.cmml" xref="S2.E10.m2.4.4.1.1.3.2"><csymbol cd="ambiguous" id="S2.E10.m2.4.4.1.1.3.2.1.cmml" xref="S2.E10.m2.4.4.1.1.3.2">superscript</csymbol><apply id="S2.E10.m2.4.4.1.1.3.2.2.cmml" xref="S2.E10.m2.4.4.1.1.3.2"><csymbol cd="ambiguous" id="S2.E10.m2.4.4.1.1.3.2.2.1.cmml" xref="S2.E10.m2.4.4.1.1.3.2">subscript</csymbol><ci id="S2.E10.m2.4.4.1.1.3.2.2.2.cmml" xref="S2.E10.m2.4.4.1.1.3.2.2.2">𝐖</ci><ci id="S2.E10.m2.4.4.1.1.3.2.2.3.cmml" xref="S2.E10.m2.4.4.1.1.3.2.2.3">𝐕</ci></apply><ci id="S2.E10.m2.2.2.1.1.cmml" xref="S2.E10.m2.2.2.1.1">𝑙</ci></apply><apply id="S2.E10.m2.4.4.1.1.3.3.cmml" xref="S2.E10.m2.4.4.1.1.3.3"><csymbol cd="ambiguous" id="S2.E10.m2.4.4.1.1.3.3.1.cmml" xref="S2.E10.m2.4.4.1.1.3.3">superscript</csymbol><apply id="S2.E10.m2.4.4.1.1.3.3.2.cmml" xref="S2.E10.m2.4.4.1.1.3.3"><csymbol cd="ambiguous" id="S2.E10.m2.4.4.1.1.3.3.2.1.cmml" xref="S2.E10.m2.4.4.1.1.3.3">subscript</csymbol><ci id="S2.E10.m2.4.4.1.1.3.3.2.2.cmml" xref="S2.E10.m2.4.4.1.1.3.3.2.2">𝐦</ci><apply id="S2.E10.m2.4.4.1.1.3.3.2.3.cmml" xref="S2.E10.m2.4.4.1.1.3.3.2.3"><times id="S2.E10.m2.4.4.1.1.3.3.2.3.1.cmml" xref="S2.E10.m2.4.4.1.1.3.3.2.3.1"></times><ci id="S2.E10.m2.4.4.1.1.3.3.2.3.2.cmml" xref="S2.E10.m2.4.4.1.1.3.3.2.3.2">𝑖</ci><ci id="S2.E10.m2.4.4.1.1.3.3.2.3.3.cmml" xref="S2.E10.m2.4.4.1.1.3.3.2.3.3">𝑗</ci></apply></apply><ci id="S2.E10.m2.3.3.1.1.cmml" xref="S2.E10.m2.3.3.1.1">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E10.m2.4c">\displaystyle\text{\quad}\mathbf{V}_{ij}^{(l)}=\mathbf{W_{V}}^{(l)}\mathbf{m}_%
{ij}^{(l)},</annotation><annotation encoding="application/x-llamapun" id="S2.E10.m2.4d">bold_V start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT = bold_W start_POSTSUBSCRIPT bold_V end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT bold_m start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
<tbody id="S2.E11"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle a_{ij}^{(l)}=\text{softmax}" class="ltx_Math" display="inline" id="S2.E11.m1.1"><semantics id="S2.E11.m1.1a"><mrow id="S2.E11.m1.1.2" xref="S2.E11.m1.1.2.cmml"><msubsup id="S2.E11.m1.1.2.2" xref="S2.E11.m1.1.2.2.cmml"><mi id="S2.E11.m1.1.2.2.2.2" xref="S2.E11.m1.1.2.2.2.2.cmml">a</mi><mrow id="S2.E11.m1.1.2.2.2.3" xref="S2.E11.m1.1.2.2.2.3.cmml"><mi id="S2.E11.m1.1.2.2.2.3.2" xref="S2.E11.m1.1.2.2.2.3.2.cmml">i</mi><mo id="S2.E11.m1.1.2.2.2.3.1" xref="S2.E11.m1.1.2.2.2.3.1.cmml">⁢</mo><mi id="S2.E11.m1.1.2.2.2.3.3" xref="S2.E11.m1.1.2.2.2.3.3.cmml">j</mi></mrow><mrow id="S2.E11.m1.1.1.1.3" xref="S2.E11.m1.1.2.2.cmml"><mo id="S2.E11.m1.1.1.1.3.1" stretchy="false" xref="S2.E11.m1.1.2.2.cmml">(</mo><mi id="S2.E11.m1.1.1.1.1" xref="S2.E11.m1.1.1.1.1.cmml">l</mi><mo id="S2.E11.m1.1.1.1.3.2" stretchy="false" xref="S2.E11.m1.1.2.2.cmml">)</mo></mrow></msubsup><mo id="S2.E11.m1.1.2.1" xref="S2.E11.m1.1.2.1.cmml">=</mo><mtext id="S2.E11.m1.1.2.3" xref="S2.E11.m1.1.2.3a.cmml">softmax</mtext></mrow><annotation-xml encoding="MathML-Content" id="S2.E11.m1.1b"><apply id="S2.E11.m1.1.2.cmml" xref="S2.E11.m1.1.2"><eq id="S2.E11.m1.1.2.1.cmml" xref="S2.E11.m1.1.2.1"></eq><apply id="S2.E11.m1.1.2.2.cmml" xref="S2.E11.m1.1.2.2"><csymbol cd="ambiguous" id="S2.E11.m1.1.2.2.1.cmml" xref="S2.E11.m1.1.2.2">superscript</csymbol><apply id="S2.E11.m1.1.2.2.2.cmml" xref="S2.E11.m1.1.2.2"><csymbol cd="ambiguous" id="S2.E11.m1.1.2.2.2.1.cmml" xref="S2.E11.m1.1.2.2">subscript</csymbol><ci id="S2.E11.m1.1.2.2.2.2.cmml" xref="S2.E11.m1.1.2.2.2.2">𝑎</ci><apply id="S2.E11.m1.1.2.2.2.3.cmml" xref="S2.E11.m1.1.2.2.2.3"><times id="S2.E11.m1.1.2.2.2.3.1.cmml" xref="S2.E11.m1.1.2.2.2.3.1"></times><ci id="S2.E11.m1.1.2.2.2.3.2.cmml" xref="S2.E11.m1.1.2.2.2.3.2">𝑖</ci><ci id="S2.E11.m1.1.2.2.2.3.3.cmml" xref="S2.E11.m1.1.2.2.2.3.3">𝑗</ci></apply></apply><ci id="S2.E11.m1.1.1.1.1.cmml" xref="S2.E11.m1.1.1.1.1">𝑙</ci></apply><ci id="S2.E11.m1.1.2.3a.cmml" xref="S2.E11.m1.1.2.3"><mtext id="S2.E11.m1.1.2.3.cmml" xref="S2.E11.m1.1.2.3">softmax</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E11.m1.1c">\displaystyle a_{ij}^{(l)}=\text{softmax}</annotation><annotation encoding="application/x-llamapun" id="S2.E11.m1.1d">italic_a start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT = softmax</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="{}_{i\in N(j)}\mathbf{(Q}_{j}^{(l)}\mathbf{K}_{ij}^{(l)})," class="ltx_math_unparsed" display="inline" id="S2.E11.m2.3"><semantics id="S2.E11.m2.3a"><mrow id="S2.E11.m2.3b"><mmultiscripts id="S2.E11.m2.3.4"><mrow id="S2.E11.m2.3.4.2"><mo id="S2.E11.m2.3.4.2.1" stretchy="false">(</mo><msubsup id="S2.E11.m2.3.4.2.2"><mi id="S2.E11.m2.3.4.2.2.2.2">𝐐</mi><mi id="S2.E11.m2.3.4.2.2.2.3">j</mi><mrow id="S2.E11.m2.2.2.1.3"><mo id="S2.E11.m2.2.2.1.3.1" stretchy="false">(</mo><mi id="S2.E11.m2.2.2.1.1">l</mi><mo id="S2.E11.m2.2.2.1.3.2" stretchy="false">)</mo></mrow></msubsup><msubsup id="S2.E11.m2.3.4.2.3"><mi id="S2.E11.m2.3.4.2.3.2.2">𝐊</mi><mrow id="S2.E11.m2.3.4.2.3.2.3"><mi id="S2.E11.m2.3.4.2.3.2.3.2">i</mi><mo id="S2.E11.m2.3.4.2.3.2.3.1">⁢</mo><mi id="S2.E11.m2.3.4.2.3.2.3.3">j</mi></mrow><mrow id="S2.E11.m2.3.3.1.3"><mo id="S2.E11.m2.3.3.1.3.1" stretchy="false">(</mo><mi id="S2.E11.m2.3.3.1.1">l</mi><mo id="S2.E11.m2.3.3.1.3.2" stretchy="false">)</mo></mrow></msubsup><mo id="S2.E11.m2.3.4.2.4" stretchy="false">)</mo></mrow><mprescripts id="S2.E11.m2.3.4a"></mprescripts><mrow id="S2.E11.m2.1.1.1"><mi id="S2.E11.m2.1.1.1.3">i</mi><mo id="S2.E11.m2.1.1.1.2">∈</mo><mrow id="S2.E11.m2.1.1.1.4"><mi id="S2.E11.m2.1.1.1.4.2">N</mi><mo id="S2.E11.m2.1.1.1.4.1">⁢</mo><mrow id="S2.E11.m2.1.1.1.4.3.2"><mo id="S2.E11.m2.1.1.1.4.3.2.1" stretchy="false">(</mo><mi id="S2.E11.m2.1.1.1.1">j</mi><mo id="S2.E11.m2.1.1.1.4.3.2.2" stretchy="false">)</mo></mrow></mrow></mrow><mrow id="S2.E11.m2.3.4b"></mrow></mmultiscripts><mo id="S2.E11.m2.3.5">,</mo></mrow><annotation encoding="application/x-tex" id="S2.E11.m2.3c">{}_{i\in N(j)}\mathbf{(Q}_{j}^{(l)}\mathbf{K}_{ij}^{(l)}),</annotation><annotation encoding="application/x-llamapun" id="S2.E11.m2.3d">start_FLOATSUBSCRIPT italic_i ∈ italic_N ( italic_j ) end_FLOATSUBSCRIPT ( bold_Q start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT bold_K start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
<tbody id="S2.E12"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{n}_{j}^{(l)}=\sum_{i\in N(j)}" class="ltx_Math" display="inline" id="S2.E12.m1.2"><semantics id="S2.E12.m1.2a"><mrow id="S2.E12.m1.2.3" xref="S2.E12.m1.2.3.cmml"><msubsup id="S2.E12.m1.2.3.2" xref="S2.E12.m1.2.3.2.cmml"><mi id="S2.E12.m1.2.3.2.2.2" xref="S2.E12.m1.2.3.2.2.2.cmml">𝐧</mi><mi id="S2.E12.m1.2.3.2.2.3" xref="S2.E12.m1.2.3.2.2.3.cmml">j</mi><mrow id="S2.E12.m1.1.1.1.3" xref="S2.E12.m1.2.3.2.cmml"><mo id="S2.E12.m1.1.1.1.3.1" stretchy="false" xref="S2.E12.m1.2.3.2.cmml">(</mo><mi id="S2.E12.m1.1.1.1.1" xref="S2.E12.m1.1.1.1.1.cmml">l</mi><mo id="S2.E12.m1.1.1.1.3.2" stretchy="false" xref="S2.E12.m1.2.3.2.cmml">)</mo></mrow></msubsup><mo id="S2.E12.m1.2.3.1" xref="S2.E12.m1.2.3.1.cmml">=</mo><mstyle displaystyle="true" id="S2.E12.m1.2.3.3" xref="S2.E12.m1.2.3.3.cmml"><munder id="S2.E12.m1.2.3.3a" xref="S2.E12.m1.2.3.3.cmml"><mo id="S2.E12.m1.2.3.3.2" movablelimits="false" xref="S2.E12.m1.2.3.3.2.cmml">∑</mo><mrow id="S2.E12.m1.2.2.1" xref="S2.E12.m1.2.2.1.cmml"><mi id="S2.E12.m1.2.2.1.3" xref="S2.E12.m1.2.2.1.3.cmml">i</mi><mo id="S2.E12.m1.2.2.1.2" xref="S2.E12.m1.2.2.1.2.cmml">∈</mo><mrow id="S2.E12.m1.2.2.1.4" xref="S2.E12.m1.2.2.1.4.cmml"><mi id="S2.E12.m1.2.2.1.4.2" xref="S2.E12.m1.2.2.1.4.2.cmml">N</mi><mo id="S2.E12.m1.2.2.1.4.1" xref="S2.E12.m1.2.2.1.4.1.cmml">⁢</mo><mrow id="S2.E12.m1.2.2.1.4.3.2" xref="S2.E12.m1.2.2.1.4.cmml"><mo id="S2.E12.m1.2.2.1.4.3.2.1" stretchy="false" xref="S2.E12.m1.2.2.1.4.cmml">(</mo><mi id="S2.E12.m1.2.2.1.1" xref="S2.E12.m1.2.2.1.1.cmml">j</mi><mo id="S2.E12.m1.2.2.1.4.3.2.2" stretchy="false" xref="S2.E12.m1.2.2.1.4.cmml">)</mo></mrow></mrow></mrow></munder></mstyle></mrow><annotation-xml encoding="MathML-Content" id="S2.E12.m1.2b"><apply id="S2.E12.m1.2.3.cmml" xref="S2.E12.m1.2.3"><eq id="S2.E12.m1.2.3.1.cmml" xref="S2.E12.m1.2.3.1"></eq><apply id="S2.E12.m1.2.3.2.cmml" xref="S2.E12.m1.2.3.2"><csymbol cd="ambiguous" id="S2.E12.m1.2.3.2.1.cmml" xref="S2.E12.m1.2.3.2">superscript</csymbol><apply id="S2.E12.m1.2.3.2.2.cmml" xref="S2.E12.m1.2.3.2"><csymbol cd="ambiguous" id="S2.E12.m1.2.3.2.2.1.cmml" xref="S2.E12.m1.2.3.2">subscript</csymbol><ci id="S2.E12.m1.2.3.2.2.2.cmml" xref="S2.E12.m1.2.3.2.2.2">𝐧</ci><ci id="S2.E12.m1.2.3.2.2.3.cmml" xref="S2.E12.m1.2.3.2.2.3">𝑗</ci></apply><ci id="S2.E12.m1.1.1.1.1.cmml" xref="S2.E12.m1.1.1.1.1">𝑙</ci></apply><apply id="S2.E12.m1.2.3.3.cmml" xref="S2.E12.m1.2.3.3"><csymbol cd="ambiguous" id="S2.E12.m1.2.3.3.1.cmml" xref="S2.E12.m1.2.3.3">subscript</csymbol><sum id="S2.E12.m1.2.3.3.2.cmml" xref="S2.E12.m1.2.3.3.2"></sum><apply id="S2.E12.m1.2.2.1.cmml" xref="S2.E12.m1.2.2.1"><in id="S2.E12.m1.2.2.1.2.cmml" xref="S2.E12.m1.2.2.1.2"></in><ci id="S2.E12.m1.2.2.1.3.cmml" xref="S2.E12.m1.2.2.1.3">𝑖</ci><apply id="S2.E12.m1.2.2.1.4.cmml" xref="S2.E12.m1.2.2.1.4"><times id="S2.E12.m1.2.2.1.4.1.cmml" xref="S2.E12.m1.2.2.1.4.1"></times><ci id="S2.E12.m1.2.2.1.4.2.cmml" xref="S2.E12.m1.2.2.1.4.2">𝑁</ci><ci id="S2.E12.m1.2.2.1.1.cmml" xref="S2.E12.m1.2.2.1.1">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E12.m1.2c">\displaystyle\mathbf{n}_{j}^{(l)}=\sum_{i\in N(j)}</annotation><annotation encoding="application/x-llamapun" id="S2.E12.m1.2d">bold_n start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT = ∑ start_POSTSUBSCRIPT italic_i ∈ italic_N ( italic_j ) end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle a_{ij}^{(l)}\mathbf{V}_{ij}^{(l)}." class="ltx_Math" display="inline" id="S2.E12.m2.3"><semantics id="S2.E12.m2.3a"><mrow id="S2.E12.m2.3.3.1" xref="S2.E12.m2.3.3.1.1.cmml"><mrow id="S2.E12.m2.3.3.1.1" xref="S2.E12.m2.3.3.1.1.cmml"><msubsup id="S2.E12.m2.3.3.1.1.2" xref="S2.E12.m2.3.3.1.1.2.cmml"><mi id="S2.E12.m2.3.3.1.1.2.2.2" xref="S2.E12.m2.3.3.1.1.2.2.2.cmml">a</mi><mrow id="S2.E12.m2.3.3.1.1.2.2.3" xref="S2.E12.m2.3.3.1.1.2.2.3.cmml"><mi id="S2.E12.m2.3.3.1.1.2.2.3.2" xref="S2.E12.m2.3.3.1.1.2.2.3.2.cmml">i</mi><mo id="S2.E12.m2.3.3.1.1.2.2.3.1" xref="S2.E12.m2.3.3.1.1.2.2.3.1.cmml">⁢</mo><mi id="S2.E12.m2.3.3.1.1.2.2.3.3" xref="S2.E12.m2.3.3.1.1.2.2.3.3.cmml">j</mi></mrow><mrow id="S2.E12.m2.1.1.1.3" xref="S2.E12.m2.3.3.1.1.2.cmml"><mo id="S2.E12.m2.1.1.1.3.1" stretchy="false" xref="S2.E12.m2.3.3.1.1.2.cmml">(</mo><mi id="S2.E12.m2.1.1.1.1" xref="S2.E12.m2.1.1.1.1.cmml">l</mi><mo id="S2.E12.m2.1.1.1.3.2" stretchy="false" xref="S2.E12.m2.3.3.1.1.2.cmml">)</mo></mrow></msubsup><mo id="S2.E12.m2.3.3.1.1.1" xref="S2.E12.m2.3.3.1.1.1.cmml">⁢</mo><msubsup id="S2.E12.m2.3.3.1.1.3" xref="S2.E12.m2.3.3.1.1.3.cmml"><mi id="S2.E12.m2.3.3.1.1.3.2.2" xref="S2.E12.m2.3.3.1.1.3.2.2.cmml">𝐕</mi><mrow id="S2.E12.m2.3.3.1.1.3.2.3" xref="S2.E12.m2.3.3.1.1.3.2.3.cmml"><mi id="S2.E12.m2.3.3.1.1.3.2.3.2" xref="S2.E12.m2.3.3.1.1.3.2.3.2.cmml">i</mi><mo id="S2.E12.m2.3.3.1.1.3.2.3.1" xref="S2.E12.m2.3.3.1.1.3.2.3.1.cmml">⁢</mo><mi id="S2.E12.m2.3.3.1.1.3.2.3.3" xref="S2.E12.m2.3.3.1.1.3.2.3.3.cmml">j</mi></mrow><mrow id="S2.E12.m2.2.2.1.3" xref="S2.E12.m2.3.3.1.1.3.cmml"><mo id="S2.E12.m2.2.2.1.3.1" stretchy="false" xref="S2.E12.m2.3.3.1.1.3.cmml">(</mo><mi id="S2.E12.m2.2.2.1.1" xref="S2.E12.m2.2.2.1.1.cmml">l</mi><mo id="S2.E12.m2.2.2.1.3.2" stretchy="false" xref="S2.E12.m2.3.3.1.1.3.cmml">)</mo></mrow></msubsup></mrow><mo id="S2.E12.m2.3.3.1.2" lspace="0em" xref="S2.E12.m2.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E12.m2.3b"><apply id="S2.E12.m2.3.3.1.1.cmml" xref="S2.E12.m2.3.3.1"><times id="S2.E12.m2.3.3.1.1.1.cmml" xref="S2.E12.m2.3.3.1.1.1"></times><apply id="S2.E12.m2.3.3.1.1.2.cmml" xref="S2.E12.m2.3.3.1.1.2"><csymbol cd="ambiguous" id="S2.E12.m2.3.3.1.1.2.1.cmml" xref="S2.E12.m2.3.3.1.1.2">superscript</csymbol><apply id="S2.E12.m2.3.3.1.1.2.2.cmml" xref="S2.E12.m2.3.3.1.1.2"><csymbol cd="ambiguous" id="S2.E12.m2.3.3.1.1.2.2.1.cmml" xref="S2.E12.m2.3.3.1.1.2">subscript</csymbol><ci id="S2.E12.m2.3.3.1.1.2.2.2.cmml" xref="S2.E12.m2.3.3.1.1.2.2.2">𝑎</ci><apply id="S2.E12.m2.3.3.1.1.2.2.3.cmml" xref="S2.E12.m2.3.3.1.1.2.2.3"><times id="S2.E12.m2.3.3.1.1.2.2.3.1.cmml" xref="S2.E12.m2.3.3.1.1.2.2.3.1"></times><ci id="S2.E12.m2.3.3.1.1.2.2.3.2.cmml" xref="S2.E12.m2.3.3.1.1.2.2.3.2">𝑖</ci><ci id="S2.E12.m2.3.3.1.1.2.2.3.3.cmml" xref="S2.E12.m2.3.3.1.1.2.2.3.3">𝑗</ci></apply></apply><ci id="S2.E12.m2.1.1.1.1.cmml" xref="S2.E12.m2.1.1.1.1">𝑙</ci></apply><apply id="S2.E12.m2.3.3.1.1.3.cmml" xref="S2.E12.m2.3.3.1.1.3"><csymbol cd="ambiguous" id="S2.E12.m2.3.3.1.1.3.1.cmml" xref="S2.E12.m2.3.3.1.1.3">superscript</csymbol><apply id="S2.E12.m2.3.3.1.1.3.2.cmml" xref="S2.E12.m2.3.3.1.1.3"><csymbol cd="ambiguous" id="S2.E12.m2.3.3.1.1.3.2.1.cmml" xref="S2.E12.m2.3.3.1.1.3">subscript</csymbol><ci id="S2.E12.m2.3.3.1.1.3.2.2.cmml" xref="S2.E12.m2.3.3.1.1.3.2.2">𝐕</ci><apply id="S2.E12.m2.3.3.1.1.3.2.3.cmml" xref="S2.E12.m2.3.3.1.1.3.2.3"><times id="S2.E12.m2.3.3.1.1.3.2.3.1.cmml" xref="S2.E12.m2.3.3.1.1.3.2.3.1"></times><ci id="S2.E12.m2.3.3.1.1.3.2.3.2.cmml" xref="S2.E12.m2.3.3.1.1.3.2.3.2">𝑖</ci><ci id="S2.E12.m2.3.3.1.1.3.2.3.3.cmml" xref="S2.E12.m2.3.3.1.1.3.2.3.3">𝑗</ci></apply></apply><ci id="S2.E12.m2.2.2.1.1.cmml" xref="S2.E12.m2.2.2.1.1">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E12.m2.3c">\displaystyle a_{ij}^{(l)}\mathbf{V}_{ij}^{(l)}.</annotation><annotation encoding="application/x-llamapun" id="S2.E12.m2.3d">italic_a start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT bold_V start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS4.SSS2.p4">
<p class="ltx_p" id="S2.SS4.SSS2.p4.1">A global attention-based readout is then applied to obtain the graph representation:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E13">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{g}=\sum_{i}\text{softmax}(f_{\text{gate}}(\mathbf{n}_{i}^{L}))f_{\text%
{feat}}(\mathbf{n}_{i}^{L})." class="ltx_Math" display="block" id="S2.E13.m1.1"><semantics id="S2.E13.m1.1a"><mrow id="S2.E13.m1.1.1.1" xref="S2.E13.m1.1.1.1.1.cmml"><mrow id="S2.E13.m1.1.1.1.1" xref="S2.E13.m1.1.1.1.1.cmml"><mi id="S2.E13.m1.1.1.1.1.4" xref="S2.E13.m1.1.1.1.1.4.cmml">𝐠</mi><mo id="S2.E13.m1.1.1.1.1.3" rspace="0.111em" xref="S2.E13.m1.1.1.1.1.3.cmml">=</mo><mrow id="S2.E13.m1.1.1.1.1.2" xref="S2.E13.m1.1.1.1.1.2.cmml"><munder id="S2.E13.m1.1.1.1.1.2.3" xref="S2.E13.m1.1.1.1.1.2.3.cmml"><mo id="S2.E13.m1.1.1.1.1.2.3.2" movablelimits="false" xref="S2.E13.m1.1.1.1.1.2.3.2.cmml">∑</mo><mi id="S2.E13.m1.1.1.1.1.2.3.3" xref="S2.E13.m1.1.1.1.1.2.3.3.cmml">i</mi></munder><mrow id="S2.E13.m1.1.1.1.1.2.2" xref="S2.E13.m1.1.1.1.1.2.2.cmml"><mtext id="S2.E13.m1.1.1.1.1.2.2.4" xref="S2.E13.m1.1.1.1.1.2.2.4a.cmml">softmax</mtext><mo id="S2.E13.m1.1.1.1.1.2.2.3" xref="S2.E13.m1.1.1.1.1.2.2.3.cmml">⁢</mo><mrow id="S2.E13.m1.1.1.1.1.1.1.1.1" xref="S2.E13.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E13.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E13.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E13.m1.1.1.1.1.1.1.1.1.1" xref="S2.E13.m1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E13.m1.1.1.1.1.1.1.1.1.1.3" xref="S2.E13.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E13.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E13.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">f</mi><mtext id="S2.E13.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S2.E13.m1.1.1.1.1.1.1.1.1.1.3.3a.cmml">gate</mtext></msub><mo id="S2.E13.m1.1.1.1.1.1.1.1.1.1.2" xref="S2.E13.m1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E13.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E13.m1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S2.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐧</mi><mi id="S2.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S2.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="S2.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">L</mi></msubsup><mo id="S2.E13.m1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E13.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E13.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E13.m1.1.1.1.1.2.2.3a" xref="S2.E13.m1.1.1.1.1.2.2.3.cmml">⁢</mo><msub id="S2.E13.m1.1.1.1.1.2.2.5" xref="S2.E13.m1.1.1.1.1.2.2.5.cmml"><mi id="S2.E13.m1.1.1.1.1.2.2.5.2" xref="S2.E13.m1.1.1.1.1.2.2.5.2.cmml">f</mi><mtext id="S2.E13.m1.1.1.1.1.2.2.5.3" xref="S2.E13.m1.1.1.1.1.2.2.5.3a.cmml">feat</mtext></msub><mo id="S2.E13.m1.1.1.1.1.2.2.3b" xref="S2.E13.m1.1.1.1.1.2.2.3.cmml">⁢</mo><mrow id="S2.E13.m1.1.1.1.1.2.2.2.1" xref="S2.E13.m1.1.1.1.1.2.2.2.1.1.cmml"><mo id="S2.E13.m1.1.1.1.1.2.2.2.1.2" stretchy="false" xref="S2.E13.m1.1.1.1.1.2.2.2.1.1.cmml">(</mo><msubsup id="S2.E13.m1.1.1.1.1.2.2.2.1.1" xref="S2.E13.m1.1.1.1.1.2.2.2.1.1.cmml"><mi id="S2.E13.m1.1.1.1.1.2.2.2.1.1.2.2" xref="S2.E13.m1.1.1.1.1.2.2.2.1.1.2.2.cmml">𝐧</mi><mi id="S2.E13.m1.1.1.1.1.2.2.2.1.1.2.3" xref="S2.E13.m1.1.1.1.1.2.2.2.1.1.2.3.cmml">i</mi><mi id="S2.E13.m1.1.1.1.1.2.2.2.1.1.3" xref="S2.E13.m1.1.1.1.1.2.2.2.1.1.3.cmml">L</mi></msubsup><mo id="S2.E13.m1.1.1.1.1.2.2.2.1.3" stretchy="false" xref="S2.E13.m1.1.1.1.1.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.E13.m1.1.1.1.2" lspace="0em" xref="S2.E13.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E13.m1.1b"><apply id="S2.E13.m1.1.1.1.1.cmml" xref="S2.E13.m1.1.1.1"><eq id="S2.E13.m1.1.1.1.1.3.cmml" xref="S2.E13.m1.1.1.1.1.3"></eq><ci id="S2.E13.m1.1.1.1.1.4.cmml" xref="S2.E13.m1.1.1.1.1.4">𝐠</ci><apply id="S2.E13.m1.1.1.1.1.2.cmml" xref="S2.E13.m1.1.1.1.1.2"><apply id="S2.E13.m1.1.1.1.1.2.3.cmml" xref="S2.E13.m1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E13.m1.1.1.1.1.2.3.1.cmml" xref="S2.E13.m1.1.1.1.1.2.3">subscript</csymbol><sum id="S2.E13.m1.1.1.1.1.2.3.2.cmml" xref="S2.E13.m1.1.1.1.1.2.3.2"></sum><ci id="S2.E13.m1.1.1.1.1.2.3.3.cmml" xref="S2.E13.m1.1.1.1.1.2.3.3">𝑖</ci></apply><apply id="S2.E13.m1.1.1.1.1.2.2.cmml" xref="S2.E13.m1.1.1.1.1.2.2"><times id="S2.E13.m1.1.1.1.1.2.2.3.cmml" xref="S2.E13.m1.1.1.1.1.2.2.3"></times><ci id="S2.E13.m1.1.1.1.1.2.2.4a.cmml" xref="S2.E13.m1.1.1.1.1.2.2.4"><mtext id="S2.E13.m1.1.1.1.1.2.2.4.cmml" xref="S2.E13.m1.1.1.1.1.2.2.4">softmax</mtext></ci><apply id="S2.E13.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E13.m1.1.1.1.1.1.1.1.1"><times id="S2.E13.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E13.m1.1.1.1.1.1.1.1.1.1.2"></times><apply id="S2.E13.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E13.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E13.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E13.m1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E13.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E13.m1.1.1.1.1.1.1.1.1.1.3.2">𝑓</ci><ci id="S2.E13.m1.1.1.1.1.1.1.1.1.1.3.3a.cmml" xref="S2.E13.m1.1.1.1.1.1.1.1.1.1.3.3"><mtext id="S2.E13.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" mathsize="70%" xref="S2.E13.m1.1.1.1.1.1.1.1.1.1.3.3">gate</mtext></ci></apply><apply id="S2.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E13.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E13.m1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E13.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E13.m1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝐧</ci><ci id="S2.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S2.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E13.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝐿</ci></apply></apply><apply id="S2.E13.m1.1.1.1.1.2.2.5.cmml" xref="S2.E13.m1.1.1.1.1.2.2.5"><csymbol cd="ambiguous" id="S2.E13.m1.1.1.1.1.2.2.5.1.cmml" xref="S2.E13.m1.1.1.1.1.2.2.5">subscript</csymbol><ci id="S2.E13.m1.1.1.1.1.2.2.5.2.cmml" xref="S2.E13.m1.1.1.1.1.2.2.5.2">𝑓</ci><ci id="S2.E13.m1.1.1.1.1.2.2.5.3a.cmml" xref="S2.E13.m1.1.1.1.1.2.2.5.3"><mtext id="S2.E13.m1.1.1.1.1.2.2.5.3.cmml" mathsize="70%" xref="S2.E13.m1.1.1.1.1.2.2.5.3">feat</mtext></ci></apply><apply id="S2.E13.m1.1.1.1.1.2.2.2.1.1.cmml" xref="S2.E13.m1.1.1.1.1.2.2.2.1"><csymbol cd="ambiguous" id="S2.E13.m1.1.1.1.1.2.2.2.1.1.1.cmml" xref="S2.E13.m1.1.1.1.1.2.2.2.1">superscript</csymbol><apply id="S2.E13.m1.1.1.1.1.2.2.2.1.1.2.cmml" xref="S2.E13.m1.1.1.1.1.2.2.2.1"><csymbol cd="ambiguous" id="S2.E13.m1.1.1.1.1.2.2.2.1.1.2.1.cmml" xref="S2.E13.m1.1.1.1.1.2.2.2.1">subscript</csymbol><ci id="S2.E13.m1.1.1.1.1.2.2.2.1.1.2.2.cmml" xref="S2.E13.m1.1.1.1.1.2.2.2.1.1.2.2">𝐧</ci><ci id="S2.E13.m1.1.1.1.1.2.2.2.1.1.2.3.cmml" xref="S2.E13.m1.1.1.1.1.2.2.2.1.1.2.3">𝑖</ci></apply><ci id="S2.E13.m1.1.1.1.1.2.2.2.1.1.3.cmml" xref="S2.E13.m1.1.1.1.1.2.2.2.1.1.3">𝐿</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E13.m1.1c">\mathbf{g}=\sum_{i}\text{softmax}(f_{\text{gate}}(\mathbf{n}_{i}^{L}))f_{\text%
{feat}}(\mathbf{n}_{i}^{L}).</annotation><annotation encoding="application/x-llamapun" id="S2.E13.m1.1d">bold_g = ∑ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT softmax ( italic_f start_POSTSUBSCRIPT gate end_POSTSUBSCRIPT ( bold_n start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT ) ) italic_f start_POSTSUBSCRIPT feat end_POSTSUBSCRIPT ( bold_n start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS4.SSS2.p5">
<p class="ltx_p" id="S2.SS4.SSS2.p5.1">The expert encoding network is optimized via the contrastive learning based self-supervised training, which includes the intra-modality contrastive learning and inter-modality contrastive learning. The intra-modality constrastive learning serves for preserving the modality information, while the inter-modality contrastive learning serves for modality alignment.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS4.SSS2.p6">
<ul class="ltx_itemize" id="S2.I1">
<li class="ltx_item" id="S2.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="S2.I1.i1.p1">
<p class="ltx_p" id="S2.I1.i1.p1.2"><span class="ltx_text ltx_font_bold" id="S2.I1.i1.p1.2.1">Alignment Contrastive Learning.</span>
There are two types of alignment to be ensured: 1) NL-Code (NC) alignment and 2) Code-Graph (CG) alignment.
We define the positive pairs for NC alignment purpose as <math alttext="\mathcal{I}^{+}_{NC}=\{\langle\mathbf{h}_{i}^{V},\mathbf{h}_{i}^{Q}\rangle|i%
\in D_{\text{train}}\}" class="ltx_Math" display="inline" id="S2.I1.i1.p1.1.m1.2"><semantics id="S2.I1.i1.p1.1.m1.2a"><mrow id="S2.I1.i1.p1.1.m1.2.2" xref="S2.I1.i1.p1.1.m1.2.2.cmml"><msubsup id="S2.I1.i1.p1.1.m1.2.2.4" xref="S2.I1.i1.p1.1.m1.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.I1.i1.p1.1.m1.2.2.4.2.2" xref="S2.I1.i1.p1.1.m1.2.2.4.2.2.cmml">ℐ</mi><mrow id="S2.I1.i1.p1.1.m1.2.2.4.3" xref="S2.I1.i1.p1.1.m1.2.2.4.3.cmml"><mi id="S2.I1.i1.p1.1.m1.2.2.4.3.2" xref="S2.I1.i1.p1.1.m1.2.2.4.3.2.cmml">N</mi><mo id="S2.I1.i1.p1.1.m1.2.2.4.3.1" xref="S2.I1.i1.p1.1.m1.2.2.4.3.1.cmml">⁢</mo><mi id="S2.I1.i1.p1.1.m1.2.2.4.3.3" xref="S2.I1.i1.p1.1.m1.2.2.4.3.3.cmml">C</mi></mrow><mo id="S2.I1.i1.p1.1.m1.2.2.4.2.3" xref="S2.I1.i1.p1.1.m1.2.2.4.2.3.cmml">+</mo></msubsup><mo id="S2.I1.i1.p1.1.m1.2.2.3" xref="S2.I1.i1.p1.1.m1.2.2.3.cmml">=</mo><mrow id="S2.I1.i1.p1.1.m1.2.2.2.2" xref="S2.I1.i1.p1.1.m1.2.2.2.3.cmml"><mo id="S2.I1.i1.p1.1.m1.2.2.2.2.3" stretchy="false" xref="S2.I1.i1.p1.1.m1.2.2.2.3.1.cmml">{</mo><mrow id="S2.I1.i1.p1.1.m1.1.1.1.1.1.2" xref="S2.I1.i1.p1.1.m1.1.1.1.1.1.3.cmml"><mo id="S2.I1.i1.p1.1.m1.1.1.1.1.1.2.3" stretchy="false" xref="S2.I1.i1.p1.1.m1.1.1.1.1.1.3.cmml">⟨</mo><msubsup id="S2.I1.i1.p1.1.m1.1.1.1.1.1.1.1" xref="S2.I1.i1.p1.1.m1.1.1.1.1.1.1.1.cmml"><mi id="S2.I1.i1.p1.1.m1.1.1.1.1.1.1.1.2.2" xref="S2.I1.i1.p1.1.m1.1.1.1.1.1.1.1.2.2.cmml">𝐡</mi><mi id="S2.I1.i1.p1.1.m1.1.1.1.1.1.1.1.2.3" xref="S2.I1.i1.p1.1.m1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="S2.I1.i1.p1.1.m1.1.1.1.1.1.1.1.3" xref="S2.I1.i1.p1.1.m1.1.1.1.1.1.1.1.3.cmml">V</mi></msubsup><mo id="S2.I1.i1.p1.1.m1.1.1.1.1.1.2.4" xref="S2.I1.i1.p1.1.m1.1.1.1.1.1.3.cmml">,</mo><msubsup id="S2.I1.i1.p1.1.m1.1.1.1.1.1.2.2" xref="S2.I1.i1.p1.1.m1.1.1.1.1.1.2.2.cmml"><mi id="S2.I1.i1.p1.1.m1.1.1.1.1.1.2.2.2.2" xref="S2.I1.i1.p1.1.m1.1.1.1.1.1.2.2.2.2.cmml">𝐡</mi><mi id="S2.I1.i1.p1.1.m1.1.1.1.1.1.2.2.2.3" xref="S2.I1.i1.p1.1.m1.1.1.1.1.1.2.2.2.3.cmml">i</mi><mi id="S2.I1.i1.p1.1.m1.1.1.1.1.1.2.2.3" xref="S2.I1.i1.p1.1.m1.1.1.1.1.1.2.2.3.cmml">Q</mi></msubsup><mo id="S2.I1.i1.p1.1.m1.1.1.1.1.1.2.5" stretchy="false" xref="S2.I1.i1.p1.1.m1.1.1.1.1.1.3.cmml">⟩</mo></mrow><mo id="S2.I1.i1.p1.1.m1.2.2.2.2.4" lspace="0em" rspace="0em" xref="S2.I1.i1.p1.1.m1.2.2.2.3.1.cmml">|</mo><mrow id="S2.I1.i1.p1.1.m1.2.2.2.2.2" xref="S2.I1.i1.p1.1.m1.2.2.2.2.2.cmml"><mi id="S2.I1.i1.p1.1.m1.2.2.2.2.2.2" xref="S2.I1.i1.p1.1.m1.2.2.2.2.2.2.cmml">i</mi><mo id="S2.I1.i1.p1.1.m1.2.2.2.2.2.1" xref="S2.I1.i1.p1.1.m1.2.2.2.2.2.1.cmml">∈</mo><msub id="S2.I1.i1.p1.1.m1.2.2.2.2.2.3" xref="S2.I1.i1.p1.1.m1.2.2.2.2.2.3.cmml"><mi id="S2.I1.i1.p1.1.m1.2.2.2.2.2.3.2" xref="S2.I1.i1.p1.1.m1.2.2.2.2.2.3.2.cmml">D</mi><mtext id="S2.I1.i1.p1.1.m1.2.2.2.2.2.3.3" xref="S2.I1.i1.p1.1.m1.2.2.2.2.2.3.3a.cmml">train</mtext></msub></mrow><mo id="S2.I1.i1.p1.1.m1.2.2.2.2.5" stretchy="false" xref="S2.I1.i1.p1.1.m1.2.2.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i1.p1.1.m1.2b"><apply id="S2.I1.i1.p1.1.m1.2.2.cmml" xref="S2.I1.i1.p1.1.m1.2.2"><eq id="S2.I1.i1.p1.1.m1.2.2.3.cmml" xref="S2.I1.i1.p1.1.m1.2.2.3"></eq><apply id="S2.I1.i1.p1.1.m1.2.2.4.cmml" xref="S2.I1.i1.p1.1.m1.2.2.4"><csymbol cd="ambiguous" id="S2.I1.i1.p1.1.m1.2.2.4.1.cmml" xref="S2.I1.i1.p1.1.m1.2.2.4">subscript</csymbol><apply id="S2.I1.i1.p1.1.m1.2.2.4.2.cmml" xref="S2.I1.i1.p1.1.m1.2.2.4"><csymbol cd="ambiguous" id="S2.I1.i1.p1.1.m1.2.2.4.2.1.cmml" xref="S2.I1.i1.p1.1.m1.2.2.4">superscript</csymbol><ci id="S2.I1.i1.p1.1.m1.2.2.4.2.2.cmml" xref="S2.I1.i1.p1.1.m1.2.2.4.2.2">ℐ</ci><plus id="S2.I1.i1.p1.1.m1.2.2.4.2.3.cmml" xref="S2.I1.i1.p1.1.m1.2.2.4.2.3"></plus></apply><apply id="S2.I1.i1.p1.1.m1.2.2.4.3.cmml" xref="S2.I1.i1.p1.1.m1.2.2.4.3"><times id="S2.I1.i1.p1.1.m1.2.2.4.3.1.cmml" xref="S2.I1.i1.p1.1.m1.2.2.4.3.1"></times><ci id="S2.I1.i1.p1.1.m1.2.2.4.3.2.cmml" xref="S2.I1.i1.p1.1.m1.2.2.4.3.2">𝑁</ci><ci id="S2.I1.i1.p1.1.m1.2.2.4.3.3.cmml" xref="S2.I1.i1.p1.1.m1.2.2.4.3.3">𝐶</ci></apply></apply><apply id="S2.I1.i1.p1.1.m1.2.2.2.3.cmml" xref="S2.I1.i1.p1.1.m1.2.2.2.2"><csymbol cd="latexml" id="S2.I1.i1.p1.1.m1.2.2.2.3.1.cmml" xref="S2.I1.i1.p1.1.m1.2.2.2.2.3">conditional-set</csymbol><list id="S2.I1.i1.p1.1.m1.1.1.1.1.1.3.cmml" xref="S2.I1.i1.p1.1.m1.1.1.1.1.1.2"><apply id="S2.I1.i1.p1.1.m1.1.1.1.1.1.1.1.cmml" xref="S2.I1.i1.p1.1.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.I1.i1.p1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.I1.i1.p1.1.m1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.I1.i1.p1.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S2.I1.i1.p1.1.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.I1.i1.p1.1.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.I1.i1.p1.1.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.I1.i1.p1.1.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.I1.i1.p1.1.m1.1.1.1.1.1.1.1.2.2">𝐡</ci><ci id="S2.I1.i1.p1.1.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.I1.i1.p1.1.m1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S2.I1.i1.p1.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S2.I1.i1.p1.1.m1.1.1.1.1.1.1.1.3">𝑉</ci></apply><apply id="S2.I1.i1.p1.1.m1.1.1.1.1.1.2.2.cmml" xref="S2.I1.i1.p1.1.m1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.I1.i1.p1.1.m1.1.1.1.1.1.2.2.1.cmml" xref="S2.I1.i1.p1.1.m1.1.1.1.1.1.2.2">superscript</csymbol><apply id="S2.I1.i1.p1.1.m1.1.1.1.1.1.2.2.2.cmml" xref="S2.I1.i1.p1.1.m1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.I1.i1.p1.1.m1.1.1.1.1.1.2.2.2.1.cmml" xref="S2.I1.i1.p1.1.m1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S2.I1.i1.p1.1.m1.1.1.1.1.1.2.2.2.2.cmml" xref="S2.I1.i1.p1.1.m1.1.1.1.1.1.2.2.2.2">𝐡</ci><ci id="S2.I1.i1.p1.1.m1.1.1.1.1.1.2.2.2.3.cmml" xref="S2.I1.i1.p1.1.m1.1.1.1.1.1.2.2.2.3">𝑖</ci></apply><ci id="S2.I1.i1.p1.1.m1.1.1.1.1.1.2.2.3.cmml" xref="S2.I1.i1.p1.1.m1.1.1.1.1.1.2.2.3">𝑄</ci></apply></list><apply id="S2.I1.i1.p1.1.m1.2.2.2.2.2.cmml" xref="S2.I1.i1.p1.1.m1.2.2.2.2.2"><in id="S2.I1.i1.p1.1.m1.2.2.2.2.2.1.cmml" xref="S2.I1.i1.p1.1.m1.2.2.2.2.2.1"></in><ci id="S2.I1.i1.p1.1.m1.2.2.2.2.2.2.cmml" xref="S2.I1.i1.p1.1.m1.2.2.2.2.2.2">𝑖</ci><apply id="S2.I1.i1.p1.1.m1.2.2.2.2.2.3.cmml" xref="S2.I1.i1.p1.1.m1.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.I1.i1.p1.1.m1.2.2.2.2.2.3.1.cmml" xref="S2.I1.i1.p1.1.m1.2.2.2.2.2.3">subscript</csymbol><ci id="S2.I1.i1.p1.1.m1.2.2.2.2.2.3.2.cmml" xref="S2.I1.i1.p1.1.m1.2.2.2.2.2.3.2">𝐷</ci><ci id="S2.I1.i1.p1.1.m1.2.2.2.2.2.3.3a.cmml" xref="S2.I1.i1.p1.1.m1.2.2.2.2.2.3.3"><mtext id="S2.I1.i1.p1.1.m1.2.2.2.2.2.3.3.cmml" mathsize="70%" xref="S2.I1.i1.p1.1.m1.2.2.2.2.2.3.3">train</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.p1.1.m1.2c">\mathcal{I}^{+}_{NC}=\{\langle\mathbf{h}_{i}^{V},\mathbf{h}_{i}^{Q}\rangle|i%
\in D_{\text{train}}\}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i1.p1.1.m1.2d">caligraphic_I start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_N italic_C end_POSTSUBSCRIPT = { ⟨ bold_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_V end_POSTSUPERSCRIPT , bold_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_Q end_POSTSUPERSCRIPT ⟩ | italic_i ∈ italic_D start_POSTSUBSCRIPT train end_POSTSUBSCRIPT }</annotation></semantics></math> and define the negative pairs for NC alignment purpose as <math alttext="\mathcal{I}^{-}_{NC}=\{\langle\mathbf{h}_{i}^{V},\mathbf{h}_{j}^{Q}\rangle|i%
\neq j,i\in D_{\text{train}},j\in D_{\text{train}}\}." class="ltx_Math" display="inline" id="S2.I1.i1.p1.2.m2.1"><semantics id="S2.I1.i1.p1.2.m2.1a"><mrow id="S2.I1.i1.p1.2.m2.1.1.1" xref="S2.I1.i1.p1.2.m2.1.1.1.1.cmml"><mrow id="S2.I1.i1.p1.2.m2.1.1.1.1" xref="S2.I1.i1.p1.2.m2.1.1.1.1.cmml"><msubsup id="S2.I1.i1.p1.2.m2.1.1.1.1.4" xref="S2.I1.i1.p1.2.m2.1.1.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.I1.i1.p1.2.m2.1.1.1.1.4.2.2" xref="S2.I1.i1.p1.2.m2.1.1.1.1.4.2.2.cmml">ℐ</mi><mrow id="S2.I1.i1.p1.2.m2.1.1.1.1.4.3" xref="S2.I1.i1.p1.2.m2.1.1.1.1.4.3.cmml"><mi id="S2.I1.i1.p1.2.m2.1.1.1.1.4.3.2" xref="S2.I1.i1.p1.2.m2.1.1.1.1.4.3.2.cmml">N</mi><mo id="S2.I1.i1.p1.2.m2.1.1.1.1.4.3.1" xref="S2.I1.i1.p1.2.m2.1.1.1.1.4.3.1.cmml">⁢</mo><mi id="S2.I1.i1.p1.2.m2.1.1.1.1.4.3.3" xref="S2.I1.i1.p1.2.m2.1.1.1.1.4.3.3.cmml">C</mi></mrow><mo id="S2.I1.i1.p1.2.m2.1.1.1.1.4.2.3" xref="S2.I1.i1.p1.2.m2.1.1.1.1.4.2.3.cmml">−</mo></msubsup><mo id="S2.I1.i1.p1.2.m2.1.1.1.1.3" xref="S2.I1.i1.p1.2.m2.1.1.1.1.3.cmml">=</mo><mrow id="S2.I1.i1.p1.2.m2.1.1.1.1.2.2" xref="S2.I1.i1.p1.2.m2.1.1.1.1.2.3.cmml"><mo id="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.3" stretchy="false" xref="S2.I1.i1.p1.2.m2.1.1.1.1.2.3.1.cmml">{</mo><mrow id="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.2" xref="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.3.cmml"><mo id="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.2.3" stretchy="false" xref="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.3.cmml">⟨</mo><msubsup id="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.1.1" xref="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.1.1.2.2" xref="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐡</mi><mi id="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.1.1.2.3" xref="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.1.1.3" xref="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.1.1.3.cmml">V</mi></msubsup><mo id="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.2.4" xref="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.3.cmml">,</mo><msubsup id="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.2.2" xref="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.2.2.cmml"><mi id="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.2.2.2.2" xref="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.2.2.2.2.cmml">𝐡</mi><mi id="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.2.2.2.3" xref="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.2.2.2.3.cmml">j</mi><mi id="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.2.2.3" xref="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.2.2.3.cmml">Q</mi></msubsup><mo id="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.2.5" stretchy="false" xref="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.3.cmml">⟩</mo></mrow><mo id="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.4" lspace="0em" rspace="0em" xref="S2.I1.i1.p1.2.m2.1.1.1.1.2.3.1.cmml">|</mo><mrow id="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2" xref="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.3.cmml"><mrow id="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.1.1" xref="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.1.1.cmml"><mi id="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.1.1.2" xref="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.1.1.2.cmml">i</mi><mo id="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.1.1.1" xref="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.1.1.1.cmml">≠</mo><mi id="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.1.1.3" xref="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.1.1.3.cmml">j</mi></mrow><mo id="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.3" xref="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.3a.cmml">,</mo><mrow id="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.2.2" xref="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.2.3.cmml"><mrow id="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.2.1.1" xref="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.2.1.1.cmml"><mi id="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.2.1.1.2" xref="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.2.1.1.2.cmml">i</mi><mo id="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.2.1.1.1" xref="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.2.1.1.1.cmml">∈</mo><msub id="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.2.1.1.3" xref="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.2.1.1.3.cmml"><mi id="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.2.1.1.3.2" xref="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.2.1.1.3.2.cmml">D</mi><mtext id="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.2.1.1.3.3" xref="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.2.1.1.3.3a.cmml">train</mtext></msub></mrow><mo id="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.2.2.3" xref="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.2.3a.cmml">,</mo><mrow id="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.2.2.2" xref="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.2.2.2.cmml"><mi id="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.2.2.2.2" xref="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.2.2.2.2.cmml">j</mi><mo id="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.2.2.2.1" xref="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.2.2.2.1.cmml">∈</mo><msub id="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.2.2.2.3" xref="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.2.2.2.3.cmml"><mi id="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.2.2.2.3.2" xref="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.2.2.2.3.2.cmml">D</mi><mtext id="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.2.2.2.3.3" xref="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.2.2.2.3.3a.cmml">train</mtext></msub></mrow></mrow></mrow><mo id="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.5" stretchy="false" xref="S2.I1.i1.p1.2.m2.1.1.1.1.2.3.1.cmml">}</mo></mrow></mrow><mo id="S2.I1.i1.p1.2.m2.1.1.1.2" lspace="0em" xref="S2.I1.i1.p1.2.m2.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i1.p1.2.m2.1b"><apply id="S2.I1.i1.p1.2.m2.1.1.1.1.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1"><eq id="S2.I1.i1.p1.2.m2.1.1.1.1.3.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.1.3"></eq><apply id="S2.I1.i1.p1.2.m2.1.1.1.1.4.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.I1.i1.p1.2.m2.1.1.1.1.4.1.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.1.4">subscript</csymbol><apply id="S2.I1.i1.p1.2.m2.1.1.1.1.4.2.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.I1.i1.p1.2.m2.1.1.1.1.4.2.1.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.1.4">superscript</csymbol><ci id="S2.I1.i1.p1.2.m2.1.1.1.1.4.2.2.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.1.4.2.2">ℐ</ci><minus id="S2.I1.i1.p1.2.m2.1.1.1.1.4.2.3.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.1.4.2.3"></minus></apply><apply id="S2.I1.i1.p1.2.m2.1.1.1.1.4.3.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.1.4.3"><times id="S2.I1.i1.p1.2.m2.1.1.1.1.4.3.1.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.1.4.3.1"></times><ci id="S2.I1.i1.p1.2.m2.1.1.1.1.4.3.2.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.1.4.3.2">𝑁</ci><ci id="S2.I1.i1.p1.2.m2.1.1.1.1.4.3.3.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.1.4.3.3">𝐶</ci></apply></apply><apply id="S2.I1.i1.p1.2.m2.1.1.1.1.2.3.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.1.2.2"><csymbol cd="latexml" id="S2.I1.i1.p1.2.m2.1.1.1.1.2.3.1.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.3">conditional-set</csymbol><list id="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.3.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.2"><apply id="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.1.1.2.2">𝐡</ci><ci id="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.1.1.3">𝑉</ci></apply><apply id="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.2.2.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.2.2.1.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.2.2">superscript</csymbol><apply id="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.2.2.2.2">𝐡</ci><ci id="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.2.2.2.3">𝑗</ci></apply><ci id="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.2.2.3.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.2.2.3">𝑄</ci></apply></list><apply id="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.3.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.3a.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.3">formulae-sequence</csymbol><apply id="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.1.1.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.1.1"><neq id="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.1.1.1.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.1.1.1"></neq><ci id="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.1.1.2.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.1.1.2">𝑖</ci><ci id="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.1.1.3.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.1.1.3">𝑗</ci></apply><apply id="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.2.3.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.2.3a.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.2.1.1.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.2.1.1"><in id="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.2.1.1.1.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.2.1.1.1"></in><ci id="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.2.1.1.2.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.2.1.1.2">𝑖</ci><apply id="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.2.1.1.3.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.2.1.1.3.1.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.2.1.1.3">subscript</csymbol><ci id="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.2.1.1.3.2.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.2.1.1.3.2">𝐷</ci><ci id="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.2.1.1.3.3a.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.2.1.1.3.3"><mtext id="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.2.1.1.3.3.cmml" mathsize="70%" xref="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.2.1.1.3.3">train</mtext></ci></apply></apply><apply id="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.2.2.2.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.2.2.2"><in id="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.2.2.2.1.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.2.2.2.1"></in><ci id="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.2.2.2.2.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.2.2.2.2">𝑗</ci><apply id="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.2.2.2.3.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.2.2.2.3.1.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.2.2.2.3">subscript</csymbol><ci id="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.2.2.2.3.2.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.2.2.2.3.2">𝐷</ci><ci id="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.2.2.2.3.3a.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.2.2.2.3.3"><mtext id="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.2.2.2.3.3.cmml" mathsize="70%" xref="S2.I1.i1.p1.2.m2.1.1.1.1.2.2.2.2.2.2.2.3.3">train</mtext></ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.p1.2.m2.1c">\mathcal{I}^{-}_{NC}=\{\langle\mathbf{h}_{i}^{V},\mathbf{h}_{j}^{Q}\rangle|i%
\neq j,i\in D_{\text{train}},j\in D_{\text{train}}\}.</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i1.p1.2.m2.1d">caligraphic_I start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_N italic_C end_POSTSUBSCRIPT = { ⟨ bold_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_V end_POSTSUPERSCRIPT , bold_h start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_Q end_POSTSUPERSCRIPT ⟩ | italic_i ≠ italic_j , italic_i ∈ italic_D start_POSTSUBSCRIPT train end_POSTSUBSCRIPT , italic_j ∈ italic_D start_POSTSUBSCRIPT train end_POSTSUBSCRIPT } .</annotation></semantics></math></p>
</div>
<div class="ltx_para ltx_noindent" id="S2.I1.i1.p2">
<p class="ltx_p" id="S2.I1.i1.p2.2">And we define the positive pairs for CG alignment purpose as <math alttext="\mathcal{I}^{+}_{CG}=\{\langle\phi_{1}(c_{i}),\phi_{2}(g_{i})\rangle|i\in D_{%
\text{train}}\}" class="ltx_Math" display="inline" id="S2.I1.i1.p2.1.m1.2"><semantics id="S2.I1.i1.p2.1.m1.2a"><mrow id="S2.I1.i1.p2.1.m1.2.2" xref="S2.I1.i1.p2.1.m1.2.2.cmml"><msubsup id="S2.I1.i1.p2.1.m1.2.2.4" xref="S2.I1.i1.p2.1.m1.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.I1.i1.p2.1.m1.2.2.4.2.2" xref="S2.I1.i1.p2.1.m1.2.2.4.2.2.cmml">ℐ</mi><mrow id="S2.I1.i1.p2.1.m1.2.2.4.3" xref="S2.I1.i1.p2.1.m1.2.2.4.3.cmml"><mi id="S2.I1.i1.p2.1.m1.2.2.4.3.2" xref="S2.I1.i1.p2.1.m1.2.2.4.3.2.cmml">C</mi><mo id="S2.I1.i1.p2.1.m1.2.2.4.3.1" xref="S2.I1.i1.p2.1.m1.2.2.4.3.1.cmml">⁢</mo><mi id="S2.I1.i1.p2.1.m1.2.2.4.3.3" xref="S2.I1.i1.p2.1.m1.2.2.4.3.3.cmml">G</mi></mrow><mo id="S2.I1.i1.p2.1.m1.2.2.4.2.3" xref="S2.I1.i1.p2.1.m1.2.2.4.2.3.cmml">+</mo></msubsup><mo id="S2.I1.i1.p2.1.m1.2.2.3" xref="S2.I1.i1.p2.1.m1.2.2.3.cmml">=</mo><mrow id="S2.I1.i1.p2.1.m1.2.2.2.2" xref="S2.I1.i1.p2.1.m1.2.2.2.3.cmml"><mo id="S2.I1.i1.p2.1.m1.2.2.2.2.3" stretchy="false" xref="S2.I1.i1.p2.1.m1.2.2.2.3.1.cmml">{</mo><mrow id="S2.I1.i1.p2.1.m1.1.1.1.1.1.2" xref="S2.I1.i1.p2.1.m1.1.1.1.1.1.3.cmml"><mo id="S2.I1.i1.p2.1.m1.1.1.1.1.1.2.3" stretchy="false" xref="S2.I1.i1.p2.1.m1.1.1.1.1.1.3.cmml">⟨</mo><mrow id="S2.I1.i1.p2.1.m1.1.1.1.1.1.1.1" xref="S2.I1.i1.p2.1.m1.1.1.1.1.1.1.1.cmml"><msub id="S2.I1.i1.p2.1.m1.1.1.1.1.1.1.1.3" xref="S2.I1.i1.p2.1.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.I1.i1.p2.1.m1.1.1.1.1.1.1.1.3.2" xref="S2.I1.i1.p2.1.m1.1.1.1.1.1.1.1.3.2.cmml">ϕ</mi><mn id="S2.I1.i1.p2.1.m1.1.1.1.1.1.1.1.3.3" xref="S2.I1.i1.p2.1.m1.1.1.1.1.1.1.1.3.3.cmml">1</mn></msub><mo id="S2.I1.i1.p2.1.m1.1.1.1.1.1.1.1.2" xref="S2.I1.i1.p2.1.m1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.I1.i1.p2.1.m1.1.1.1.1.1.1.1.1.1" xref="S2.I1.i1.p2.1.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.I1.i1.p2.1.m1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.I1.i1.p2.1.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.I1.i1.p2.1.m1.1.1.1.1.1.1.1.1.1.1" xref="S2.I1.i1.p2.1.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.I1.i1.p2.1.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.I1.i1.p2.1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">c</mi><mi id="S2.I1.i1.p2.1.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.I1.i1.p2.1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.I1.i1.p2.1.m1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.I1.i1.p2.1.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.I1.i1.p2.1.m1.1.1.1.1.1.2.4" xref="S2.I1.i1.p2.1.m1.1.1.1.1.1.3.cmml">,</mo><mrow id="S2.I1.i1.p2.1.m1.1.1.1.1.1.2.2" xref="S2.I1.i1.p2.1.m1.1.1.1.1.1.2.2.cmml"><msub id="S2.I1.i1.p2.1.m1.1.1.1.1.1.2.2.3" xref="S2.I1.i1.p2.1.m1.1.1.1.1.1.2.2.3.cmml"><mi id="S2.I1.i1.p2.1.m1.1.1.1.1.1.2.2.3.2" xref="S2.I1.i1.p2.1.m1.1.1.1.1.1.2.2.3.2.cmml">ϕ</mi><mn id="S2.I1.i1.p2.1.m1.1.1.1.1.1.2.2.3.3" xref="S2.I1.i1.p2.1.m1.1.1.1.1.1.2.2.3.3.cmml">2</mn></msub><mo id="S2.I1.i1.p2.1.m1.1.1.1.1.1.2.2.2" xref="S2.I1.i1.p2.1.m1.1.1.1.1.1.2.2.2.cmml">⁢</mo><mrow id="S2.I1.i1.p2.1.m1.1.1.1.1.1.2.2.1.1" xref="S2.I1.i1.p2.1.m1.1.1.1.1.1.2.2.1.1.1.cmml"><mo id="S2.I1.i1.p2.1.m1.1.1.1.1.1.2.2.1.1.2" stretchy="false" xref="S2.I1.i1.p2.1.m1.1.1.1.1.1.2.2.1.1.1.cmml">(</mo><msub id="S2.I1.i1.p2.1.m1.1.1.1.1.1.2.2.1.1.1" xref="S2.I1.i1.p2.1.m1.1.1.1.1.1.2.2.1.1.1.cmml"><mi id="S2.I1.i1.p2.1.m1.1.1.1.1.1.2.2.1.1.1.2" xref="S2.I1.i1.p2.1.m1.1.1.1.1.1.2.2.1.1.1.2.cmml">g</mi><mi id="S2.I1.i1.p2.1.m1.1.1.1.1.1.2.2.1.1.1.3" xref="S2.I1.i1.p2.1.m1.1.1.1.1.1.2.2.1.1.1.3.cmml">i</mi></msub><mo id="S2.I1.i1.p2.1.m1.1.1.1.1.1.2.2.1.1.3" stretchy="false" xref="S2.I1.i1.p2.1.m1.1.1.1.1.1.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.I1.i1.p2.1.m1.1.1.1.1.1.2.5" stretchy="false" xref="S2.I1.i1.p2.1.m1.1.1.1.1.1.3.cmml">⟩</mo></mrow><mo id="S2.I1.i1.p2.1.m1.2.2.2.2.4" lspace="0em" rspace="0em" xref="S2.I1.i1.p2.1.m1.2.2.2.3.1.cmml">|</mo><mrow id="S2.I1.i1.p2.1.m1.2.2.2.2.2" xref="S2.I1.i1.p2.1.m1.2.2.2.2.2.cmml"><mi id="S2.I1.i1.p2.1.m1.2.2.2.2.2.2" xref="S2.I1.i1.p2.1.m1.2.2.2.2.2.2.cmml">i</mi><mo id="S2.I1.i1.p2.1.m1.2.2.2.2.2.1" xref="S2.I1.i1.p2.1.m1.2.2.2.2.2.1.cmml">∈</mo><msub id="S2.I1.i1.p2.1.m1.2.2.2.2.2.3" xref="S2.I1.i1.p2.1.m1.2.2.2.2.2.3.cmml"><mi id="S2.I1.i1.p2.1.m1.2.2.2.2.2.3.2" xref="S2.I1.i1.p2.1.m1.2.2.2.2.2.3.2.cmml">D</mi><mtext id="S2.I1.i1.p2.1.m1.2.2.2.2.2.3.3" xref="S2.I1.i1.p2.1.m1.2.2.2.2.2.3.3a.cmml">train</mtext></msub></mrow><mo id="S2.I1.i1.p2.1.m1.2.2.2.2.5" stretchy="false" xref="S2.I1.i1.p2.1.m1.2.2.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i1.p2.1.m1.2b"><apply id="S2.I1.i1.p2.1.m1.2.2.cmml" xref="S2.I1.i1.p2.1.m1.2.2"><eq id="S2.I1.i1.p2.1.m1.2.2.3.cmml" xref="S2.I1.i1.p2.1.m1.2.2.3"></eq><apply id="S2.I1.i1.p2.1.m1.2.2.4.cmml" xref="S2.I1.i1.p2.1.m1.2.2.4"><csymbol cd="ambiguous" id="S2.I1.i1.p2.1.m1.2.2.4.1.cmml" xref="S2.I1.i1.p2.1.m1.2.2.4">subscript</csymbol><apply id="S2.I1.i1.p2.1.m1.2.2.4.2.cmml" xref="S2.I1.i1.p2.1.m1.2.2.4"><csymbol cd="ambiguous" id="S2.I1.i1.p2.1.m1.2.2.4.2.1.cmml" xref="S2.I1.i1.p2.1.m1.2.2.4">superscript</csymbol><ci id="S2.I1.i1.p2.1.m1.2.2.4.2.2.cmml" xref="S2.I1.i1.p2.1.m1.2.2.4.2.2">ℐ</ci><plus id="S2.I1.i1.p2.1.m1.2.2.4.2.3.cmml" xref="S2.I1.i1.p2.1.m1.2.2.4.2.3"></plus></apply><apply id="S2.I1.i1.p2.1.m1.2.2.4.3.cmml" xref="S2.I1.i1.p2.1.m1.2.2.4.3"><times id="S2.I1.i1.p2.1.m1.2.2.4.3.1.cmml" xref="S2.I1.i1.p2.1.m1.2.2.4.3.1"></times><ci id="S2.I1.i1.p2.1.m1.2.2.4.3.2.cmml" xref="S2.I1.i1.p2.1.m1.2.2.4.3.2">𝐶</ci><ci id="S2.I1.i1.p2.1.m1.2.2.4.3.3.cmml" xref="S2.I1.i1.p2.1.m1.2.2.4.3.3">𝐺</ci></apply></apply><apply id="S2.I1.i1.p2.1.m1.2.2.2.3.cmml" xref="S2.I1.i1.p2.1.m1.2.2.2.2"><csymbol cd="latexml" id="S2.I1.i1.p2.1.m1.2.2.2.3.1.cmml" xref="S2.I1.i1.p2.1.m1.2.2.2.2.3">conditional-set</csymbol><list id="S2.I1.i1.p2.1.m1.1.1.1.1.1.3.cmml" xref="S2.I1.i1.p2.1.m1.1.1.1.1.1.2"><apply id="S2.I1.i1.p2.1.m1.1.1.1.1.1.1.1.cmml" xref="S2.I1.i1.p2.1.m1.1.1.1.1.1.1.1"><times id="S2.I1.i1.p2.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S2.I1.i1.p2.1.m1.1.1.1.1.1.1.1.2"></times><apply id="S2.I1.i1.p2.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S2.I1.i1.p2.1.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.I1.i1.p2.1.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.I1.i1.p2.1.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.I1.i1.p2.1.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.I1.i1.p2.1.m1.1.1.1.1.1.1.1.3.2">italic-ϕ</ci><cn id="S2.I1.i1.p2.1.m1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S2.I1.i1.p2.1.m1.1.1.1.1.1.1.1.3.3">1</cn></apply><apply id="S2.I1.i1.p2.1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.I1.i1.p2.1.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.I1.i1.p2.1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.I1.i1.p2.1.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.I1.i1.p2.1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.I1.i1.p2.1.m1.1.1.1.1.1.1.1.1.1.1.2">𝑐</ci><ci id="S2.I1.i1.p2.1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.I1.i1.p2.1.m1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S2.I1.i1.p2.1.m1.1.1.1.1.1.2.2.cmml" xref="S2.I1.i1.p2.1.m1.1.1.1.1.1.2.2"><times id="S2.I1.i1.p2.1.m1.1.1.1.1.1.2.2.2.cmml" xref="S2.I1.i1.p2.1.m1.1.1.1.1.1.2.2.2"></times><apply id="S2.I1.i1.p2.1.m1.1.1.1.1.1.2.2.3.cmml" xref="S2.I1.i1.p2.1.m1.1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S2.I1.i1.p2.1.m1.1.1.1.1.1.2.2.3.1.cmml" xref="S2.I1.i1.p2.1.m1.1.1.1.1.1.2.2.3">subscript</csymbol><ci id="S2.I1.i1.p2.1.m1.1.1.1.1.1.2.2.3.2.cmml" xref="S2.I1.i1.p2.1.m1.1.1.1.1.1.2.2.3.2">italic-ϕ</ci><cn id="S2.I1.i1.p2.1.m1.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S2.I1.i1.p2.1.m1.1.1.1.1.1.2.2.3.3">2</cn></apply><apply id="S2.I1.i1.p2.1.m1.1.1.1.1.1.2.2.1.1.1.cmml" xref="S2.I1.i1.p2.1.m1.1.1.1.1.1.2.2.1.1"><csymbol cd="ambiguous" id="S2.I1.i1.p2.1.m1.1.1.1.1.1.2.2.1.1.1.1.cmml" xref="S2.I1.i1.p2.1.m1.1.1.1.1.1.2.2.1.1">subscript</csymbol><ci id="S2.I1.i1.p2.1.m1.1.1.1.1.1.2.2.1.1.1.2.cmml" xref="S2.I1.i1.p2.1.m1.1.1.1.1.1.2.2.1.1.1.2">𝑔</ci><ci id="S2.I1.i1.p2.1.m1.1.1.1.1.1.2.2.1.1.1.3.cmml" xref="S2.I1.i1.p2.1.m1.1.1.1.1.1.2.2.1.1.1.3">𝑖</ci></apply></apply></list><apply id="S2.I1.i1.p2.1.m1.2.2.2.2.2.cmml" xref="S2.I1.i1.p2.1.m1.2.2.2.2.2"><in id="S2.I1.i1.p2.1.m1.2.2.2.2.2.1.cmml" xref="S2.I1.i1.p2.1.m1.2.2.2.2.2.1"></in><ci id="S2.I1.i1.p2.1.m1.2.2.2.2.2.2.cmml" xref="S2.I1.i1.p2.1.m1.2.2.2.2.2.2">𝑖</ci><apply id="S2.I1.i1.p2.1.m1.2.2.2.2.2.3.cmml" xref="S2.I1.i1.p2.1.m1.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.I1.i1.p2.1.m1.2.2.2.2.2.3.1.cmml" xref="S2.I1.i1.p2.1.m1.2.2.2.2.2.3">subscript</csymbol><ci id="S2.I1.i1.p2.1.m1.2.2.2.2.2.3.2.cmml" xref="S2.I1.i1.p2.1.m1.2.2.2.2.2.3.2">𝐷</ci><ci id="S2.I1.i1.p2.1.m1.2.2.2.2.2.3.3a.cmml" xref="S2.I1.i1.p2.1.m1.2.2.2.2.2.3.3"><mtext id="S2.I1.i1.p2.1.m1.2.2.2.2.2.3.3.cmml" mathsize="70%" xref="S2.I1.i1.p2.1.m1.2.2.2.2.2.3.3">train</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.p2.1.m1.2c">\mathcal{I}^{+}_{CG}=\{\langle\phi_{1}(c_{i}),\phi_{2}(g_{i})\rangle|i\in D_{%
\text{train}}\}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i1.p2.1.m1.2d">caligraphic_I start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_C italic_G end_POSTSUBSCRIPT = { ⟨ italic_ϕ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) , italic_ϕ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( italic_g start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ⟩ | italic_i ∈ italic_D start_POSTSUBSCRIPT train end_POSTSUBSCRIPT }</annotation></semantics></math> and define the negative pairs for CG alignment purpose as <math alttext="\mathcal{I}^{-}_{CG}=\{\langle\phi_{1}(c_{i}),\phi_{2}(g_{j})\rangle|i\neq j,i%
\in D_{\text{train}},j\in D_{\text{train}}\}." class="ltx_Math" display="inline" id="S2.I1.i1.p2.2.m2.1"><semantics id="S2.I1.i1.p2.2.m2.1a"><mrow id="S2.I1.i1.p2.2.m2.1.1.1" xref="S2.I1.i1.p2.2.m2.1.1.1.1.cmml"><mrow id="S2.I1.i1.p2.2.m2.1.1.1.1" xref="S2.I1.i1.p2.2.m2.1.1.1.1.cmml"><msubsup id="S2.I1.i1.p2.2.m2.1.1.1.1.4" xref="S2.I1.i1.p2.2.m2.1.1.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.I1.i1.p2.2.m2.1.1.1.1.4.2.2" xref="S2.I1.i1.p2.2.m2.1.1.1.1.4.2.2.cmml">ℐ</mi><mrow id="S2.I1.i1.p2.2.m2.1.1.1.1.4.3" xref="S2.I1.i1.p2.2.m2.1.1.1.1.4.3.cmml"><mi id="S2.I1.i1.p2.2.m2.1.1.1.1.4.3.2" xref="S2.I1.i1.p2.2.m2.1.1.1.1.4.3.2.cmml">C</mi><mo id="S2.I1.i1.p2.2.m2.1.1.1.1.4.3.1" xref="S2.I1.i1.p2.2.m2.1.1.1.1.4.3.1.cmml">⁢</mo><mi id="S2.I1.i1.p2.2.m2.1.1.1.1.4.3.3" xref="S2.I1.i1.p2.2.m2.1.1.1.1.4.3.3.cmml">G</mi></mrow><mo id="S2.I1.i1.p2.2.m2.1.1.1.1.4.2.3" xref="S2.I1.i1.p2.2.m2.1.1.1.1.4.2.3.cmml">−</mo></msubsup><mo id="S2.I1.i1.p2.2.m2.1.1.1.1.3" xref="S2.I1.i1.p2.2.m2.1.1.1.1.3.cmml">=</mo><mrow id="S2.I1.i1.p2.2.m2.1.1.1.1.2.2" xref="S2.I1.i1.p2.2.m2.1.1.1.1.2.3.cmml"><mo id="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.3" stretchy="false" xref="S2.I1.i1.p2.2.m2.1.1.1.1.2.3.1.cmml">{</mo><mrow id="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.2" xref="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.3.cmml"><mo id="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.2.3" stretchy="false" xref="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.3.cmml">⟨</mo><mrow id="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.1.1" xref="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.1.1.cmml"><msub id="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.1.1.3" xref="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.1.1.3.2" xref="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.1.1.3.2.cmml">ϕ</mi><mn id="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.1.1.3.3" xref="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></msub><mo id="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.1.1.2" xref="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.1.1.1.1" xref="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">c</mi><mi id="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.2.4" xref="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.3.cmml">,</mo><mrow id="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.2.2" xref="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.2.2.cmml"><msub id="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.2.2.3" xref="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.2.2.3.2" xref="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.2.2.3.2.cmml">ϕ</mi><mn id="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.2.2.3.3" xref="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.2.2.3.3.cmml">2</mn></msub><mo id="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.2.2.2" xref="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.2.2.2.cmml">⁢</mo><mrow id="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.2.2.1.1" xref="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.2.2.1.1.1.cmml"><mo id="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.2.2.1.1.2" stretchy="false" xref="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.2.2.1.1.1.cmml">(</mo><msub id="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.2.2.1.1.1" xref="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.2.2.1.1.1.cmml"><mi id="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.2.2.1.1.1.2" xref="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.2.2.1.1.1.2.cmml">g</mi><mi id="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.2.2.1.1.1.3" xref="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.2.2.1.1.1.3.cmml">j</mi></msub><mo id="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.2.2.1.1.3" stretchy="false" xref="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.2.5" stretchy="false" xref="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.3.cmml">⟩</mo></mrow><mo id="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.4" lspace="0em" rspace="0em" xref="S2.I1.i1.p2.2.m2.1.1.1.1.2.3.1.cmml">|</mo><mrow id="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2" xref="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.3.cmml"><mrow id="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.1.1" xref="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.1.1.cmml"><mi id="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.1.1.2" xref="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.1.1.2.cmml">i</mi><mo id="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.1.1.1" xref="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.1.1.1.cmml">≠</mo><mi id="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.1.1.3" xref="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.1.1.3.cmml">j</mi></mrow><mo id="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.3" xref="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.3a.cmml">,</mo><mrow id="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.2.2" xref="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.2.3.cmml"><mrow id="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.2.1.1" xref="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.2.1.1.cmml"><mi id="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.2.1.1.2" xref="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.2.1.1.2.cmml">i</mi><mo id="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.2.1.1.1" xref="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.2.1.1.1.cmml">∈</mo><msub id="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.2.1.1.3" xref="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.2.1.1.3.cmml"><mi id="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.2.1.1.3.2" xref="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.2.1.1.3.2.cmml">D</mi><mtext id="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.2.1.1.3.3" xref="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.2.1.1.3.3a.cmml">train</mtext></msub></mrow><mo id="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.2.2.3" xref="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.2.3a.cmml">,</mo><mrow id="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.2.2.2" xref="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.2.2.2.cmml"><mi id="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.2.2.2.2" xref="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.2.2.2.2.cmml">j</mi><mo id="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.2.2.2.1" xref="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.2.2.2.1.cmml">∈</mo><msub id="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.2.2.2.3" xref="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.2.2.2.3.cmml"><mi id="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.2.2.2.3.2" xref="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.2.2.2.3.2.cmml">D</mi><mtext id="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.2.2.2.3.3" xref="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.2.2.2.3.3a.cmml">train</mtext></msub></mrow></mrow></mrow><mo id="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.5" stretchy="false" xref="S2.I1.i1.p2.2.m2.1.1.1.1.2.3.1.cmml">}</mo></mrow></mrow><mo id="S2.I1.i1.p2.2.m2.1.1.1.2" lspace="0em" xref="S2.I1.i1.p2.2.m2.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i1.p2.2.m2.1b"><apply id="S2.I1.i1.p2.2.m2.1.1.1.1.cmml" xref="S2.I1.i1.p2.2.m2.1.1.1"><eq id="S2.I1.i1.p2.2.m2.1.1.1.1.3.cmml" xref="S2.I1.i1.p2.2.m2.1.1.1.1.3"></eq><apply id="S2.I1.i1.p2.2.m2.1.1.1.1.4.cmml" xref="S2.I1.i1.p2.2.m2.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.I1.i1.p2.2.m2.1.1.1.1.4.1.cmml" xref="S2.I1.i1.p2.2.m2.1.1.1.1.4">subscript</csymbol><apply id="S2.I1.i1.p2.2.m2.1.1.1.1.4.2.cmml" xref="S2.I1.i1.p2.2.m2.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.I1.i1.p2.2.m2.1.1.1.1.4.2.1.cmml" xref="S2.I1.i1.p2.2.m2.1.1.1.1.4">superscript</csymbol><ci id="S2.I1.i1.p2.2.m2.1.1.1.1.4.2.2.cmml" xref="S2.I1.i1.p2.2.m2.1.1.1.1.4.2.2">ℐ</ci><minus id="S2.I1.i1.p2.2.m2.1.1.1.1.4.2.3.cmml" xref="S2.I1.i1.p2.2.m2.1.1.1.1.4.2.3"></minus></apply><apply id="S2.I1.i1.p2.2.m2.1.1.1.1.4.3.cmml" xref="S2.I1.i1.p2.2.m2.1.1.1.1.4.3"><times id="S2.I1.i1.p2.2.m2.1.1.1.1.4.3.1.cmml" xref="S2.I1.i1.p2.2.m2.1.1.1.1.4.3.1"></times><ci id="S2.I1.i1.p2.2.m2.1.1.1.1.4.3.2.cmml" xref="S2.I1.i1.p2.2.m2.1.1.1.1.4.3.2">𝐶</ci><ci id="S2.I1.i1.p2.2.m2.1.1.1.1.4.3.3.cmml" xref="S2.I1.i1.p2.2.m2.1.1.1.1.4.3.3">𝐺</ci></apply></apply><apply id="S2.I1.i1.p2.2.m2.1.1.1.1.2.3.cmml" xref="S2.I1.i1.p2.2.m2.1.1.1.1.2.2"><csymbol cd="latexml" id="S2.I1.i1.p2.2.m2.1.1.1.1.2.3.1.cmml" xref="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.3">conditional-set</csymbol><list id="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.3.cmml" xref="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.2"><apply id="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.1.1"><times id="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.1.1.2"></times><apply id="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.1.1.3.2">italic-ϕ</ci><cn id="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.1.1.3.3">1</cn></apply><apply id="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑐</ci><ci id="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.2.2.cmml" xref="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.2.2"><times id="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.2.2.2"></times><apply id="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.2.2.3.cmml" xref="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.2.2.3">subscript</csymbol><ci id="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.2.2.3.2">italic-ϕ</ci><cn id="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.2.2.3.3">2</cn></apply><apply id="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.2.2.1.1.1.cmml" xref="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.2.2.1.1"><csymbol cd="ambiguous" id="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.2.2.1.1.1.1.cmml" xref="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.2.2.1.1">subscript</csymbol><ci id="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.2.2.1.1.1.2.cmml" xref="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.2.2.1.1.1.2">𝑔</ci><ci id="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.2.2.1.1.1.3.cmml" xref="S2.I1.i1.p2.2.m2.1.1.1.1.1.1.1.2.2.1.1.1.3">𝑗</ci></apply></apply></list><apply id="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.3.cmml" xref="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.3a.cmml" xref="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.3">formulae-sequence</csymbol><apply id="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.1.1.cmml" xref="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.1.1"><neq id="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.1.1.1.cmml" xref="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.1.1.1"></neq><ci id="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.1.1.2.cmml" xref="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.1.1.2">𝑖</ci><ci id="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.1.1.3.cmml" xref="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.1.1.3">𝑗</ci></apply><apply id="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.2.3.cmml" xref="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.2.3a.cmml" xref="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.2.1.1.cmml" xref="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.2.1.1"><in id="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.2.1.1.1.cmml" xref="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.2.1.1.1"></in><ci id="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.2.1.1.2.cmml" xref="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.2.1.1.2">𝑖</ci><apply id="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.2.1.1.3.cmml" xref="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.2.1.1.3.1.cmml" xref="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.2.1.1.3">subscript</csymbol><ci id="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.2.1.1.3.2.cmml" xref="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.2.1.1.3.2">𝐷</ci><ci id="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.2.1.1.3.3a.cmml" xref="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.2.1.1.3.3"><mtext id="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.2.1.1.3.3.cmml" mathsize="70%" xref="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.2.1.1.3.3">train</mtext></ci></apply></apply><apply id="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.2.2.2.cmml" xref="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.2.2.2"><in id="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.2.2.2.1.cmml" xref="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.2.2.2.1"></in><ci id="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.2.2.2.2.cmml" xref="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.2.2.2.2">𝑗</ci><apply id="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.2.2.2.3.cmml" xref="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.2.2.2.3.1.cmml" xref="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.2.2.2.3">subscript</csymbol><ci id="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.2.2.2.3.2.cmml" xref="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.2.2.2.3.2">𝐷</ci><ci id="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.2.2.2.3.3a.cmml" xref="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.2.2.2.3.3"><mtext id="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.2.2.2.3.3.cmml" mathsize="70%" xref="S2.I1.i1.p2.2.m2.1.1.1.1.2.2.2.2.2.2.2.3.3">train</mtext></ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.p2.2.m2.1c">\mathcal{I}^{-}_{CG}=\{\langle\phi_{1}(c_{i}),\phi_{2}(g_{j})\rangle|i\neq j,i%
\in D_{\text{train}},j\in D_{\text{train}}\}.</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i1.p2.2.m2.1d">caligraphic_I start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_C italic_G end_POSTSUBSCRIPT = { ⟨ italic_ϕ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) , italic_ϕ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( italic_g start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ⟩ | italic_i ≠ italic_j , italic_i ∈ italic_D start_POSTSUBSCRIPT train end_POSTSUBSCRIPT , italic_j ∈ italic_D start_POSTSUBSCRIPT train end_POSTSUBSCRIPT } .</annotation></semantics></math></p>
</div>
</li>
<li class="ltx_item" id="S2.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="S2.I1.i2.p1">
<p class="ltx_p" id="S2.I1.i2.p1.4"><span class="ltx_text ltx_font_bold" id="S2.I1.i2.p1.4.1">Structure Preserving Contrastive Learning.</span>
To preserve the structural information of the graphical views, we perform intra-modality contrastive learning among the graphical views and their corrupted views. Concretely, we corrupt each of the graphical view <math alttext="g_{i}" class="ltx_Math" display="inline" id="S2.I1.i2.p1.1.m1.1"><semantics id="S2.I1.i2.p1.1.m1.1a"><msub id="S2.I1.i2.p1.1.m1.1.1" xref="S2.I1.i2.p1.1.m1.1.1.cmml"><mi id="S2.I1.i2.p1.1.m1.1.1.2" xref="S2.I1.i2.p1.1.m1.1.1.2.cmml">g</mi><mi id="S2.I1.i2.p1.1.m1.1.1.3" xref="S2.I1.i2.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.1.m1.1b"><apply id="S2.I1.i2.p1.1.m1.1.1.cmml" xref="S2.I1.i2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.I1.i2.p1.1.m1.1.1.1.cmml" xref="S2.I1.i2.p1.1.m1.1.1">subscript</csymbol><ci id="S2.I1.i2.p1.1.m1.1.1.2.cmml" xref="S2.I1.i2.p1.1.m1.1.1.2">𝑔</ci><ci id="S2.I1.i2.p1.1.m1.1.1.3.cmml" xref="S2.I1.i2.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.1.m1.1c">g_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.1.m1.1d">italic_g start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> with the edge dropping operation to obtain its corrupted view <math alttext="g_{i}^{\prime}" class="ltx_Math" display="inline" id="S2.I1.i2.p1.2.m2.1"><semantics id="S2.I1.i2.p1.2.m2.1a"><msubsup id="S2.I1.i2.p1.2.m2.1.1" xref="S2.I1.i2.p1.2.m2.1.1.cmml"><mi id="S2.I1.i2.p1.2.m2.1.1.2.2" xref="S2.I1.i2.p1.2.m2.1.1.2.2.cmml">g</mi><mi id="S2.I1.i2.p1.2.m2.1.1.2.3" xref="S2.I1.i2.p1.2.m2.1.1.2.3.cmml">i</mi><mo id="S2.I1.i2.p1.2.m2.1.1.3" xref="S2.I1.i2.p1.2.m2.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.2.m2.1b"><apply id="S2.I1.i2.p1.2.m2.1.1.cmml" xref="S2.I1.i2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.I1.i2.p1.2.m2.1.1.1.cmml" xref="S2.I1.i2.p1.2.m2.1.1">superscript</csymbol><apply id="S2.I1.i2.p1.2.m2.1.1.2.cmml" xref="S2.I1.i2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.I1.i2.p1.2.m2.1.1.2.1.cmml" xref="S2.I1.i2.p1.2.m2.1.1">subscript</csymbol><ci id="S2.I1.i2.p1.2.m2.1.1.2.2.cmml" xref="S2.I1.i2.p1.2.m2.1.1.2.2">𝑔</ci><ci id="S2.I1.i2.p1.2.m2.1.1.2.3.cmml" xref="S2.I1.i2.p1.2.m2.1.1.2.3">𝑖</ci></apply><ci id="S2.I1.i2.p1.2.m2.1.1.3.cmml" xref="S2.I1.i2.p1.2.m2.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.2.m2.1c">g_{i}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.2.m2.1d">italic_g start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>. The positive pairs for structure-preserving purpose are then designed as <math alttext="\mathcal{I}^{+}_{\text{preserve}}=\{\langle\phi_{2}(g_{i}),\phi_{2}(g_{i}^{%
\prime})\rangle|i\in D_{\text{train}}\}" class="ltx_Math" display="inline" id="S2.I1.i2.p1.3.m3.2"><semantics id="S2.I1.i2.p1.3.m3.2a"><mrow id="S2.I1.i2.p1.3.m3.2.2" xref="S2.I1.i2.p1.3.m3.2.2.cmml"><msubsup id="S2.I1.i2.p1.3.m3.2.2.4" xref="S2.I1.i2.p1.3.m3.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.I1.i2.p1.3.m3.2.2.4.2.2" xref="S2.I1.i2.p1.3.m3.2.2.4.2.2.cmml">ℐ</mi><mtext id="S2.I1.i2.p1.3.m3.2.2.4.3" xref="S2.I1.i2.p1.3.m3.2.2.4.3a.cmml">preserve</mtext><mo id="S2.I1.i2.p1.3.m3.2.2.4.2.3" xref="S2.I1.i2.p1.3.m3.2.2.4.2.3.cmml">+</mo></msubsup><mo id="S2.I1.i2.p1.3.m3.2.2.3" xref="S2.I1.i2.p1.3.m3.2.2.3.cmml">=</mo><mrow id="S2.I1.i2.p1.3.m3.2.2.2.2" xref="S2.I1.i2.p1.3.m3.2.2.2.3.cmml"><mo id="S2.I1.i2.p1.3.m3.2.2.2.2.3" stretchy="false" xref="S2.I1.i2.p1.3.m3.2.2.2.3.1.cmml">{</mo><mrow id="S2.I1.i2.p1.3.m3.1.1.1.1.1.2" xref="S2.I1.i2.p1.3.m3.1.1.1.1.1.3.cmml"><mo id="S2.I1.i2.p1.3.m3.1.1.1.1.1.2.3" stretchy="false" xref="S2.I1.i2.p1.3.m3.1.1.1.1.1.3.cmml">⟨</mo><mrow id="S2.I1.i2.p1.3.m3.1.1.1.1.1.1.1" xref="S2.I1.i2.p1.3.m3.1.1.1.1.1.1.1.cmml"><msub id="S2.I1.i2.p1.3.m3.1.1.1.1.1.1.1.3" xref="S2.I1.i2.p1.3.m3.1.1.1.1.1.1.1.3.cmml"><mi id="S2.I1.i2.p1.3.m3.1.1.1.1.1.1.1.3.2" xref="S2.I1.i2.p1.3.m3.1.1.1.1.1.1.1.3.2.cmml">ϕ</mi><mn id="S2.I1.i2.p1.3.m3.1.1.1.1.1.1.1.3.3" xref="S2.I1.i2.p1.3.m3.1.1.1.1.1.1.1.3.3.cmml">2</mn></msub><mo id="S2.I1.i2.p1.3.m3.1.1.1.1.1.1.1.2" xref="S2.I1.i2.p1.3.m3.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.I1.i2.p1.3.m3.1.1.1.1.1.1.1.1.1" xref="S2.I1.i2.p1.3.m3.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.I1.i2.p1.3.m3.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.I1.i2.p1.3.m3.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.I1.i2.p1.3.m3.1.1.1.1.1.1.1.1.1.1" xref="S2.I1.i2.p1.3.m3.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.I1.i2.p1.3.m3.1.1.1.1.1.1.1.1.1.1.2" xref="S2.I1.i2.p1.3.m3.1.1.1.1.1.1.1.1.1.1.2.cmml">g</mi><mi id="S2.I1.i2.p1.3.m3.1.1.1.1.1.1.1.1.1.1.3" xref="S2.I1.i2.p1.3.m3.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.I1.i2.p1.3.m3.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.I1.i2.p1.3.m3.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.I1.i2.p1.3.m3.1.1.1.1.1.2.4" xref="S2.I1.i2.p1.3.m3.1.1.1.1.1.3.cmml">,</mo><mrow id="S2.I1.i2.p1.3.m3.1.1.1.1.1.2.2" xref="S2.I1.i2.p1.3.m3.1.1.1.1.1.2.2.cmml"><msub id="S2.I1.i2.p1.3.m3.1.1.1.1.1.2.2.3" xref="S2.I1.i2.p1.3.m3.1.1.1.1.1.2.2.3.cmml"><mi id="S2.I1.i2.p1.3.m3.1.1.1.1.1.2.2.3.2" xref="S2.I1.i2.p1.3.m3.1.1.1.1.1.2.2.3.2.cmml">ϕ</mi><mn id="S2.I1.i2.p1.3.m3.1.1.1.1.1.2.2.3.3" xref="S2.I1.i2.p1.3.m3.1.1.1.1.1.2.2.3.3.cmml">2</mn></msub><mo id="S2.I1.i2.p1.3.m3.1.1.1.1.1.2.2.2" xref="S2.I1.i2.p1.3.m3.1.1.1.1.1.2.2.2.cmml">⁢</mo><mrow id="S2.I1.i2.p1.3.m3.1.1.1.1.1.2.2.1.1" xref="S2.I1.i2.p1.3.m3.1.1.1.1.1.2.2.1.1.1.cmml"><mo id="S2.I1.i2.p1.3.m3.1.1.1.1.1.2.2.1.1.2" stretchy="false" xref="S2.I1.i2.p1.3.m3.1.1.1.1.1.2.2.1.1.1.cmml">(</mo><msubsup id="S2.I1.i2.p1.3.m3.1.1.1.1.1.2.2.1.1.1" xref="S2.I1.i2.p1.3.m3.1.1.1.1.1.2.2.1.1.1.cmml"><mi id="S2.I1.i2.p1.3.m3.1.1.1.1.1.2.2.1.1.1.2.2" xref="S2.I1.i2.p1.3.m3.1.1.1.1.1.2.2.1.1.1.2.2.cmml">g</mi><mi id="S2.I1.i2.p1.3.m3.1.1.1.1.1.2.2.1.1.1.2.3" xref="S2.I1.i2.p1.3.m3.1.1.1.1.1.2.2.1.1.1.2.3.cmml">i</mi><mo id="S2.I1.i2.p1.3.m3.1.1.1.1.1.2.2.1.1.1.3" xref="S2.I1.i2.p1.3.m3.1.1.1.1.1.2.2.1.1.1.3.cmml">′</mo></msubsup><mo id="S2.I1.i2.p1.3.m3.1.1.1.1.1.2.2.1.1.3" stretchy="false" xref="S2.I1.i2.p1.3.m3.1.1.1.1.1.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.I1.i2.p1.3.m3.1.1.1.1.1.2.5" stretchy="false" xref="S2.I1.i2.p1.3.m3.1.1.1.1.1.3.cmml">⟩</mo></mrow><mo id="S2.I1.i2.p1.3.m3.2.2.2.2.4" lspace="0em" rspace="0em" xref="S2.I1.i2.p1.3.m3.2.2.2.3.1.cmml">|</mo><mrow id="S2.I1.i2.p1.3.m3.2.2.2.2.2" xref="S2.I1.i2.p1.3.m3.2.2.2.2.2.cmml"><mi id="S2.I1.i2.p1.3.m3.2.2.2.2.2.2" xref="S2.I1.i2.p1.3.m3.2.2.2.2.2.2.cmml">i</mi><mo id="S2.I1.i2.p1.3.m3.2.2.2.2.2.1" xref="S2.I1.i2.p1.3.m3.2.2.2.2.2.1.cmml">∈</mo><msub id="S2.I1.i2.p1.3.m3.2.2.2.2.2.3" xref="S2.I1.i2.p1.3.m3.2.2.2.2.2.3.cmml"><mi id="S2.I1.i2.p1.3.m3.2.2.2.2.2.3.2" xref="S2.I1.i2.p1.3.m3.2.2.2.2.2.3.2.cmml">D</mi><mtext id="S2.I1.i2.p1.3.m3.2.2.2.2.2.3.3" xref="S2.I1.i2.p1.3.m3.2.2.2.2.2.3.3a.cmml">train</mtext></msub></mrow><mo id="S2.I1.i2.p1.3.m3.2.2.2.2.5" stretchy="false" xref="S2.I1.i2.p1.3.m3.2.2.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.3.m3.2b"><apply id="S2.I1.i2.p1.3.m3.2.2.cmml" xref="S2.I1.i2.p1.3.m3.2.2"><eq id="S2.I1.i2.p1.3.m3.2.2.3.cmml" xref="S2.I1.i2.p1.3.m3.2.2.3"></eq><apply id="S2.I1.i2.p1.3.m3.2.2.4.cmml" xref="S2.I1.i2.p1.3.m3.2.2.4"><csymbol cd="ambiguous" id="S2.I1.i2.p1.3.m3.2.2.4.1.cmml" xref="S2.I1.i2.p1.3.m3.2.2.4">subscript</csymbol><apply id="S2.I1.i2.p1.3.m3.2.2.4.2.cmml" xref="S2.I1.i2.p1.3.m3.2.2.4"><csymbol cd="ambiguous" id="S2.I1.i2.p1.3.m3.2.2.4.2.1.cmml" xref="S2.I1.i2.p1.3.m3.2.2.4">superscript</csymbol><ci id="S2.I1.i2.p1.3.m3.2.2.4.2.2.cmml" xref="S2.I1.i2.p1.3.m3.2.2.4.2.2">ℐ</ci><plus id="S2.I1.i2.p1.3.m3.2.2.4.2.3.cmml" xref="S2.I1.i2.p1.3.m3.2.2.4.2.3"></plus></apply><ci id="S2.I1.i2.p1.3.m3.2.2.4.3a.cmml" xref="S2.I1.i2.p1.3.m3.2.2.4.3"><mtext id="S2.I1.i2.p1.3.m3.2.2.4.3.cmml" mathsize="70%" xref="S2.I1.i2.p1.3.m3.2.2.4.3">preserve</mtext></ci></apply><apply id="S2.I1.i2.p1.3.m3.2.2.2.3.cmml" xref="S2.I1.i2.p1.3.m3.2.2.2.2"><csymbol cd="latexml" id="S2.I1.i2.p1.3.m3.2.2.2.3.1.cmml" xref="S2.I1.i2.p1.3.m3.2.2.2.2.3">conditional-set</csymbol><list id="S2.I1.i2.p1.3.m3.1.1.1.1.1.3.cmml" xref="S2.I1.i2.p1.3.m3.1.1.1.1.1.2"><apply id="S2.I1.i2.p1.3.m3.1.1.1.1.1.1.1.cmml" xref="S2.I1.i2.p1.3.m3.1.1.1.1.1.1.1"><times id="S2.I1.i2.p1.3.m3.1.1.1.1.1.1.1.2.cmml" xref="S2.I1.i2.p1.3.m3.1.1.1.1.1.1.1.2"></times><apply id="S2.I1.i2.p1.3.m3.1.1.1.1.1.1.1.3.cmml" xref="S2.I1.i2.p1.3.m3.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.I1.i2.p1.3.m3.1.1.1.1.1.1.1.3.1.cmml" xref="S2.I1.i2.p1.3.m3.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.I1.i2.p1.3.m3.1.1.1.1.1.1.1.3.2.cmml" xref="S2.I1.i2.p1.3.m3.1.1.1.1.1.1.1.3.2">italic-ϕ</ci><cn id="S2.I1.i2.p1.3.m3.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S2.I1.i2.p1.3.m3.1.1.1.1.1.1.1.3.3">2</cn></apply><apply id="S2.I1.i2.p1.3.m3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.I1.i2.p1.3.m3.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.I1.i2.p1.3.m3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.I1.i2.p1.3.m3.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.I1.i2.p1.3.m3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.I1.i2.p1.3.m3.1.1.1.1.1.1.1.1.1.1.2">𝑔</ci><ci id="S2.I1.i2.p1.3.m3.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.I1.i2.p1.3.m3.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S2.I1.i2.p1.3.m3.1.1.1.1.1.2.2.cmml" xref="S2.I1.i2.p1.3.m3.1.1.1.1.1.2.2"><times id="S2.I1.i2.p1.3.m3.1.1.1.1.1.2.2.2.cmml" xref="S2.I1.i2.p1.3.m3.1.1.1.1.1.2.2.2"></times><apply id="S2.I1.i2.p1.3.m3.1.1.1.1.1.2.2.3.cmml" xref="S2.I1.i2.p1.3.m3.1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S2.I1.i2.p1.3.m3.1.1.1.1.1.2.2.3.1.cmml" xref="S2.I1.i2.p1.3.m3.1.1.1.1.1.2.2.3">subscript</csymbol><ci id="S2.I1.i2.p1.3.m3.1.1.1.1.1.2.2.3.2.cmml" xref="S2.I1.i2.p1.3.m3.1.1.1.1.1.2.2.3.2">italic-ϕ</ci><cn id="S2.I1.i2.p1.3.m3.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S2.I1.i2.p1.3.m3.1.1.1.1.1.2.2.3.3">2</cn></apply><apply id="S2.I1.i2.p1.3.m3.1.1.1.1.1.2.2.1.1.1.cmml" xref="S2.I1.i2.p1.3.m3.1.1.1.1.1.2.2.1.1"><csymbol cd="ambiguous" id="S2.I1.i2.p1.3.m3.1.1.1.1.1.2.2.1.1.1.1.cmml" xref="S2.I1.i2.p1.3.m3.1.1.1.1.1.2.2.1.1">superscript</csymbol><apply id="S2.I1.i2.p1.3.m3.1.1.1.1.1.2.2.1.1.1.2.cmml" xref="S2.I1.i2.p1.3.m3.1.1.1.1.1.2.2.1.1"><csymbol cd="ambiguous" id="S2.I1.i2.p1.3.m3.1.1.1.1.1.2.2.1.1.1.2.1.cmml" xref="S2.I1.i2.p1.3.m3.1.1.1.1.1.2.2.1.1">subscript</csymbol><ci id="S2.I1.i2.p1.3.m3.1.1.1.1.1.2.2.1.1.1.2.2.cmml" xref="S2.I1.i2.p1.3.m3.1.1.1.1.1.2.2.1.1.1.2.2">𝑔</ci><ci id="S2.I1.i2.p1.3.m3.1.1.1.1.1.2.2.1.1.1.2.3.cmml" xref="S2.I1.i2.p1.3.m3.1.1.1.1.1.2.2.1.1.1.2.3">𝑖</ci></apply><ci id="S2.I1.i2.p1.3.m3.1.1.1.1.1.2.2.1.1.1.3.cmml" xref="S2.I1.i2.p1.3.m3.1.1.1.1.1.2.2.1.1.1.3">′</ci></apply></apply></list><apply id="S2.I1.i2.p1.3.m3.2.2.2.2.2.cmml" xref="S2.I1.i2.p1.3.m3.2.2.2.2.2"><in id="S2.I1.i2.p1.3.m3.2.2.2.2.2.1.cmml" xref="S2.I1.i2.p1.3.m3.2.2.2.2.2.1"></in><ci id="S2.I1.i2.p1.3.m3.2.2.2.2.2.2.cmml" xref="S2.I1.i2.p1.3.m3.2.2.2.2.2.2">𝑖</ci><apply id="S2.I1.i2.p1.3.m3.2.2.2.2.2.3.cmml" xref="S2.I1.i2.p1.3.m3.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.I1.i2.p1.3.m3.2.2.2.2.2.3.1.cmml" xref="S2.I1.i2.p1.3.m3.2.2.2.2.2.3">subscript</csymbol><ci id="S2.I1.i2.p1.3.m3.2.2.2.2.2.3.2.cmml" xref="S2.I1.i2.p1.3.m3.2.2.2.2.2.3.2">𝐷</ci><ci id="S2.I1.i2.p1.3.m3.2.2.2.2.2.3.3a.cmml" xref="S2.I1.i2.p1.3.m3.2.2.2.2.2.3.3"><mtext id="S2.I1.i2.p1.3.m3.2.2.2.2.2.3.3.cmml" mathsize="70%" xref="S2.I1.i2.p1.3.m3.2.2.2.2.2.3.3">train</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.3.m3.2c">\mathcal{I}^{+}_{\text{preserve}}=\{\langle\phi_{2}(g_{i}),\phi_{2}(g_{i}^{%
\prime})\rangle|i\in D_{\text{train}}\}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.3.m3.2d">caligraphic_I start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT start_POSTSUBSCRIPT preserve end_POSTSUBSCRIPT = { ⟨ italic_ϕ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( italic_g start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) , italic_ϕ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( italic_g start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) ⟩ | italic_i ∈ italic_D start_POSTSUBSCRIPT train end_POSTSUBSCRIPT }</annotation></semantics></math>. The negative pairs for structure preserving purpose are designed as <math alttext="\mathcal{I}^{-}_{\text{preserve}}=\{\langle\phi_{2}(g_{i}),\phi_{2}(g_{j}^{%
\prime})\rangle|i\neq j,i\in D_{\text{train}},j\in D_{\text{train}}\}" class="ltx_Math" display="inline" id="S2.I1.i2.p1.4.m4.2"><semantics id="S2.I1.i2.p1.4.m4.2a"><mrow id="S2.I1.i2.p1.4.m4.2.2" xref="S2.I1.i2.p1.4.m4.2.2.cmml"><msubsup id="S2.I1.i2.p1.4.m4.2.2.4" xref="S2.I1.i2.p1.4.m4.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.I1.i2.p1.4.m4.2.2.4.2.2" xref="S2.I1.i2.p1.4.m4.2.2.4.2.2.cmml">ℐ</mi><mtext id="S2.I1.i2.p1.4.m4.2.2.4.3" xref="S2.I1.i2.p1.4.m4.2.2.4.3a.cmml">preserve</mtext><mo id="S2.I1.i2.p1.4.m4.2.2.4.2.3" xref="S2.I1.i2.p1.4.m4.2.2.4.2.3.cmml">−</mo></msubsup><mo id="S2.I1.i2.p1.4.m4.2.2.3" xref="S2.I1.i2.p1.4.m4.2.2.3.cmml">=</mo><mrow id="S2.I1.i2.p1.4.m4.2.2.2.2" xref="S2.I1.i2.p1.4.m4.2.2.2.3.cmml"><mo id="S2.I1.i2.p1.4.m4.2.2.2.2.3" stretchy="false" xref="S2.I1.i2.p1.4.m4.2.2.2.3.1.cmml">{</mo><mrow id="S2.I1.i2.p1.4.m4.1.1.1.1.1.2" xref="S2.I1.i2.p1.4.m4.1.1.1.1.1.3.cmml"><mo id="S2.I1.i2.p1.4.m4.1.1.1.1.1.2.3" stretchy="false" xref="S2.I1.i2.p1.4.m4.1.1.1.1.1.3.cmml">⟨</mo><mrow id="S2.I1.i2.p1.4.m4.1.1.1.1.1.1.1" xref="S2.I1.i2.p1.4.m4.1.1.1.1.1.1.1.cmml"><msub id="S2.I1.i2.p1.4.m4.1.1.1.1.1.1.1.3" xref="S2.I1.i2.p1.4.m4.1.1.1.1.1.1.1.3.cmml"><mi id="S2.I1.i2.p1.4.m4.1.1.1.1.1.1.1.3.2" xref="S2.I1.i2.p1.4.m4.1.1.1.1.1.1.1.3.2.cmml">ϕ</mi><mn id="S2.I1.i2.p1.4.m4.1.1.1.1.1.1.1.3.3" xref="S2.I1.i2.p1.4.m4.1.1.1.1.1.1.1.3.3.cmml">2</mn></msub><mo id="S2.I1.i2.p1.4.m4.1.1.1.1.1.1.1.2" xref="S2.I1.i2.p1.4.m4.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.I1.i2.p1.4.m4.1.1.1.1.1.1.1.1.1" xref="S2.I1.i2.p1.4.m4.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.I1.i2.p1.4.m4.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.I1.i2.p1.4.m4.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.I1.i2.p1.4.m4.1.1.1.1.1.1.1.1.1.1" xref="S2.I1.i2.p1.4.m4.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.I1.i2.p1.4.m4.1.1.1.1.1.1.1.1.1.1.2" xref="S2.I1.i2.p1.4.m4.1.1.1.1.1.1.1.1.1.1.2.cmml">g</mi><mi id="S2.I1.i2.p1.4.m4.1.1.1.1.1.1.1.1.1.1.3" xref="S2.I1.i2.p1.4.m4.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.I1.i2.p1.4.m4.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.I1.i2.p1.4.m4.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.I1.i2.p1.4.m4.1.1.1.1.1.2.4" xref="S2.I1.i2.p1.4.m4.1.1.1.1.1.3.cmml">,</mo><mrow id="S2.I1.i2.p1.4.m4.1.1.1.1.1.2.2" xref="S2.I1.i2.p1.4.m4.1.1.1.1.1.2.2.cmml"><msub id="S2.I1.i2.p1.4.m4.1.1.1.1.1.2.2.3" xref="S2.I1.i2.p1.4.m4.1.1.1.1.1.2.2.3.cmml"><mi id="S2.I1.i2.p1.4.m4.1.1.1.1.1.2.2.3.2" xref="S2.I1.i2.p1.4.m4.1.1.1.1.1.2.2.3.2.cmml">ϕ</mi><mn id="S2.I1.i2.p1.4.m4.1.1.1.1.1.2.2.3.3" xref="S2.I1.i2.p1.4.m4.1.1.1.1.1.2.2.3.3.cmml">2</mn></msub><mo id="S2.I1.i2.p1.4.m4.1.1.1.1.1.2.2.2" xref="S2.I1.i2.p1.4.m4.1.1.1.1.1.2.2.2.cmml">⁢</mo><mrow id="S2.I1.i2.p1.4.m4.1.1.1.1.1.2.2.1.1" xref="S2.I1.i2.p1.4.m4.1.1.1.1.1.2.2.1.1.1.cmml"><mo id="S2.I1.i2.p1.4.m4.1.1.1.1.1.2.2.1.1.2" stretchy="false" xref="S2.I1.i2.p1.4.m4.1.1.1.1.1.2.2.1.1.1.cmml">(</mo><msubsup id="S2.I1.i2.p1.4.m4.1.1.1.1.1.2.2.1.1.1" xref="S2.I1.i2.p1.4.m4.1.1.1.1.1.2.2.1.1.1.cmml"><mi id="S2.I1.i2.p1.4.m4.1.1.1.1.1.2.2.1.1.1.2.2" xref="S2.I1.i2.p1.4.m4.1.1.1.1.1.2.2.1.1.1.2.2.cmml">g</mi><mi id="S2.I1.i2.p1.4.m4.1.1.1.1.1.2.2.1.1.1.2.3" xref="S2.I1.i2.p1.4.m4.1.1.1.1.1.2.2.1.1.1.2.3.cmml">j</mi><mo id="S2.I1.i2.p1.4.m4.1.1.1.1.1.2.2.1.1.1.3" xref="S2.I1.i2.p1.4.m4.1.1.1.1.1.2.2.1.1.1.3.cmml">′</mo></msubsup><mo id="S2.I1.i2.p1.4.m4.1.1.1.1.1.2.2.1.1.3" stretchy="false" xref="S2.I1.i2.p1.4.m4.1.1.1.1.1.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.I1.i2.p1.4.m4.1.1.1.1.1.2.5" stretchy="false" xref="S2.I1.i2.p1.4.m4.1.1.1.1.1.3.cmml">⟩</mo></mrow><mo id="S2.I1.i2.p1.4.m4.2.2.2.2.4" lspace="0em" rspace="0em" xref="S2.I1.i2.p1.4.m4.2.2.2.3.1.cmml">|</mo><mrow id="S2.I1.i2.p1.4.m4.2.2.2.2.2.2" xref="S2.I1.i2.p1.4.m4.2.2.2.2.2.3.cmml"><mrow id="S2.I1.i2.p1.4.m4.2.2.2.2.2.1.1" xref="S2.I1.i2.p1.4.m4.2.2.2.2.2.1.1.cmml"><mi id="S2.I1.i2.p1.4.m4.2.2.2.2.2.1.1.2" xref="S2.I1.i2.p1.4.m4.2.2.2.2.2.1.1.2.cmml">i</mi><mo id="S2.I1.i2.p1.4.m4.2.2.2.2.2.1.1.1" xref="S2.I1.i2.p1.4.m4.2.2.2.2.2.1.1.1.cmml">≠</mo><mi id="S2.I1.i2.p1.4.m4.2.2.2.2.2.1.1.3" xref="S2.I1.i2.p1.4.m4.2.2.2.2.2.1.1.3.cmml">j</mi></mrow><mo id="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.3" xref="S2.I1.i2.p1.4.m4.2.2.2.2.2.3a.cmml">,</mo><mrow id="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.2.2" xref="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.2.3.cmml"><mrow id="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.2.1.1" xref="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.2.1.1.cmml"><mi id="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.2.1.1.2" xref="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.2.1.1.2.cmml">i</mi><mo id="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.2.1.1.1" xref="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.2.1.1.1.cmml">∈</mo><msub id="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.2.1.1.3" xref="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.2.1.1.3.cmml"><mi id="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.2.1.1.3.2" xref="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.2.1.1.3.2.cmml">D</mi><mtext id="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.2.1.1.3.3" xref="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.2.1.1.3.3a.cmml">train</mtext></msub></mrow><mo id="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.2.2.3" xref="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.2.3a.cmml">,</mo><mrow id="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.2.2.2" xref="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.2.2.2.cmml"><mi id="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.2.2.2.2" xref="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.2.2.2.2.cmml">j</mi><mo id="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.2.2.2.1" xref="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.2.2.2.1.cmml">∈</mo><msub id="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.2.2.2.3" xref="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.2.2.2.3.cmml"><mi id="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.2.2.2.3.2" xref="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.2.2.2.3.2.cmml">D</mi><mtext id="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.2.2.2.3.3" xref="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.2.2.2.3.3a.cmml">train</mtext></msub></mrow></mrow></mrow><mo id="S2.I1.i2.p1.4.m4.2.2.2.2.5" stretchy="false" xref="S2.I1.i2.p1.4.m4.2.2.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.4.m4.2b"><apply id="S2.I1.i2.p1.4.m4.2.2.cmml" xref="S2.I1.i2.p1.4.m4.2.2"><eq id="S2.I1.i2.p1.4.m4.2.2.3.cmml" xref="S2.I1.i2.p1.4.m4.2.2.3"></eq><apply id="S2.I1.i2.p1.4.m4.2.2.4.cmml" xref="S2.I1.i2.p1.4.m4.2.2.4"><csymbol cd="ambiguous" id="S2.I1.i2.p1.4.m4.2.2.4.1.cmml" xref="S2.I1.i2.p1.4.m4.2.2.4">subscript</csymbol><apply id="S2.I1.i2.p1.4.m4.2.2.4.2.cmml" xref="S2.I1.i2.p1.4.m4.2.2.4"><csymbol cd="ambiguous" id="S2.I1.i2.p1.4.m4.2.2.4.2.1.cmml" xref="S2.I1.i2.p1.4.m4.2.2.4">superscript</csymbol><ci id="S2.I1.i2.p1.4.m4.2.2.4.2.2.cmml" xref="S2.I1.i2.p1.4.m4.2.2.4.2.2">ℐ</ci><minus id="S2.I1.i2.p1.4.m4.2.2.4.2.3.cmml" xref="S2.I1.i2.p1.4.m4.2.2.4.2.3"></minus></apply><ci id="S2.I1.i2.p1.4.m4.2.2.4.3a.cmml" xref="S2.I1.i2.p1.4.m4.2.2.4.3"><mtext id="S2.I1.i2.p1.4.m4.2.2.4.3.cmml" mathsize="70%" xref="S2.I1.i2.p1.4.m4.2.2.4.3">preserve</mtext></ci></apply><apply id="S2.I1.i2.p1.4.m4.2.2.2.3.cmml" xref="S2.I1.i2.p1.4.m4.2.2.2.2"><csymbol cd="latexml" id="S2.I1.i2.p1.4.m4.2.2.2.3.1.cmml" xref="S2.I1.i2.p1.4.m4.2.2.2.2.3">conditional-set</csymbol><list id="S2.I1.i2.p1.4.m4.1.1.1.1.1.3.cmml" xref="S2.I1.i2.p1.4.m4.1.1.1.1.1.2"><apply id="S2.I1.i2.p1.4.m4.1.1.1.1.1.1.1.cmml" xref="S2.I1.i2.p1.4.m4.1.1.1.1.1.1.1"><times id="S2.I1.i2.p1.4.m4.1.1.1.1.1.1.1.2.cmml" xref="S2.I1.i2.p1.4.m4.1.1.1.1.1.1.1.2"></times><apply id="S2.I1.i2.p1.4.m4.1.1.1.1.1.1.1.3.cmml" xref="S2.I1.i2.p1.4.m4.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.I1.i2.p1.4.m4.1.1.1.1.1.1.1.3.1.cmml" xref="S2.I1.i2.p1.4.m4.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.I1.i2.p1.4.m4.1.1.1.1.1.1.1.3.2.cmml" xref="S2.I1.i2.p1.4.m4.1.1.1.1.1.1.1.3.2">italic-ϕ</ci><cn id="S2.I1.i2.p1.4.m4.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S2.I1.i2.p1.4.m4.1.1.1.1.1.1.1.3.3">2</cn></apply><apply id="S2.I1.i2.p1.4.m4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.I1.i2.p1.4.m4.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.I1.i2.p1.4.m4.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.I1.i2.p1.4.m4.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.I1.i2.p1.4.m4.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.I1.i2.p1.4.m4.1.1.1.1.1.1.1.1.1.1.2">𝑔</ci><ci id="S2.I1.i2.p1.4.m4.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.I1.i2.p1.4.m4.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S2.I1.i2.p1.4.m4.1.1.1.1.1.2.2.cmml" xref="S2.I1.i2.p1.4.m4.1.1.1.1.1.2.2"><times id="S2.I1.i2.p1.4.m4.1.1.1.1.1.2.2.2.cmml" xref="S2.I1.i2.p1.4.m4.1.1.1.1.1.2.2.2"></times><apply id="S2.I1.i2.p1.4.m4.1.1.1.1.1.2.2.3.cmml" xref="S2.I1.i2.p1.4.m4.1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S2.I1.i2.p1.4.m4.1.1.1.1.1.2.2.3.1.cmml" xref="S2.I1.i2.p1.4.m4.1.1.1.1.1.2.2.3">subscript</csymbol><ci id="S2.I1.i2.p1.4.m4.1.1.1.1.1.2.2.3.2.cmml" xref="S2.I1.i2.p1.4.m4.1.1.1.1.1.2.2.3.2">italic-ϕ</ci><cn id="S2.I1.i2.p1.4.m4.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S2.I1.i2.p1.4.m4.1.1.1.1.1.2.2.3.3">2</cn></apply><apply id="S2.I1.i2.p1.4.m4.1.1.1.1.1.2.2.1.1.1.cmml" xref="S2.I1.i2.p1.4.m4.1.1.1.1.1.2.2.1.1"><csymbol cd="ambiguous" id="S2.I1.i2.p1.4.m4.1.1.1.1.1.2.2.1.1.1.1.cmml" xref="S2.I1.i2.p1.4.m4.1.1.1.1.1.2.2.1.1">superscript</csymbol><apply id="S2.I1.i2.p1.4.m4.1.1.1.1.1.2.2.1.1.1.2.cmml" xref="S2.I1.i2.p1.4.m4.1.1.1.1.1.2.2.1.1"><csymbol cd="ambiguous" id="S2.I1.i2.p1.4.m4.1.1.1.1.1.2.2.1.1.1.2.1.cmml" xref="S2.I1.i2.p1.4.m4.1.1.1.1.1.2.2.1.1">subscript</csymbol><ci id="S2.I1.i2.p1.4.m4.1.1.1.1.1.2.2.1.1.1.2.2.cmml" xref="S2.I1.i2.p1.4.m4.1.1.1.1.1.2.2.1.1.1.2.2">𝑔</ci><ci id="S2.I1.i2.p1.4.m4.1.1.1.1.1.2.2.1.1.1.2.3.cmml" xref="S2.I1.i2.p1.4.m4.1.1.1.1.1.2.2.1.1.1.2.3">𝑗</ci></apply><ci id="S2.I1.i2.p1.4.m4.1.1.1.1.1.2.2.1.1.1.3.cmml" xref="S2.I1.i2.p1.4.m4.1.1.1.1.1.2.2.1.1.1.3">′</ci></apply></apply></list><apply id="S2.I1.i2.p1.4.m4.2.2.2.2.2.3.cmml" xref="S2.I1.i2.p1.4.m4.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.I1.i2.p1.4.m4.2.2.2.2.2.3a.cmml" xref="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="S2.I1.i2.p1.4.m4.2.2.2.2.2.1.1.cmml" xref="S2.I1.i2.p1.4.m4.2.2.2.2.2.1.1"><neq id="S2.I1.i2.p1.4.m4.2.2.2.2.2.1.1.1.cmml" xref="S2.I1.i2.p1.4.m4.2.2.2.2.2.1.1.1"></neq><ci id="S2.I1.i2.p1.4.m4.2.2.2.2.2.1.1.2.cmml" xref="S2.I1.i2.p1.4.m4.2.2.2.2.2.1.1.2">𝑖</ci><ci id="S2.I1.i2.p1.4.m4.2.2.2.2.2.1.1.3.cmml" xref="S2.I1.i2.p1.4.m4.2.2.2.2.2.1.1.3">𝑗</ci></apply><apply id="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.2.3.cmml" xref="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.2.3a.cmml" xref="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.2.1.1.cmml" xref="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.2.1.1"><in id="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.2.1.1.1.cmml" xref="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.2.1.1.1"></in><ci id="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.2.1.1.2.cmml" xref="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.2.1.1.2">𝑖</ci><apply id="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.2.1.1.3.cmml" xref="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.2.1.1.3.1.cmml" xref="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.2.1.1.3">subscript</csymbol><ci id="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.2.1.1.3.2.cmml" xref="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.2.1.1.3.2">𝐷</ci><ci id="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.2.1.1.3.3a.cmml" xref="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.2.1.1.3.3"><mtext id="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.2.1.1.3.3.cmml" mathsize="70%" xref="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.2.1.1.3.3">train</mtext></ci></apply></apply><apply id="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.2.2.2.cmml" xref="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.2.2.2"><in id="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.2.2.2.1.cmml" xref="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.2.2.2.1"></in><ci id="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.2.2.2.2.cmml" xref="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.2.2.2.2">𝑗</ci><apply id="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.2.2.2.3.cmml" xref="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.2.2.2.3.1.cmml" xref="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.2.2.2.3">subscript</csymbol><ci id="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.2.2.2.3.2.cmml" xref="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.2.2.2.3.2">𝐷</ci><ci id="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.2.2.2.3.3a.cmml" xref="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.2.2.2.3.3"><mtext id="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.2.2.2.3.3.cmml" mathsize="70%" xref="S2.I1.i2.p1.4.m4.2.2.2.2.2.2.2.2.2.3.3">train</mtext></ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.4.m4.2c">\mathcal{I}^{-}_{\text{preserve}}=\{\langle\phi_{2}(g_{i}),\phi_{2}(g_{j}^{%
\prime})\rangle|i\neq j,i\in D_{\text{train}},j\in D_{\text{train}}\}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.4.m4.2d">caligraphic_I start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT start_POSTSUBSCRIPT preserve end_POSTSUBSCRIPT = { ⟨ italic_ϕ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( italic_g start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) , italic_ϕ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( italic_g start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) ⟩ | italic_i ≠ italic_j , italic_i ∈ italic_D start_POSTSUBSCRIPT train end_POSTSUBSCRIPT , italic_j ∈ italic_D start_POSTSUBSCRIPT train end_POSTSUBSCRIPT }</annotation></semantics></math>.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS4.SSS2.p7">
<p class="ltx_p" id="S2.SS4.SSS2.p7.1"><span class="ltx_text ltx_font_bold" id="S2.SS4.SSS2.p7.1.1">Finetuning with the Expert Soft Signal.</span>
To help the backbone LLMs to digest the graphical views, we tune the LLMs with the expert soft signal using supervised finetuning. The prompt for finetuning consists of the system prompt, retrieved knowledge where the expert encoded graphical view is contained using a token embedding, and task prompt, which is illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#S2.F5" title="Figure 5 ‣ 2.4.1 Hard Meta-Graph Prompt ‣ 2.4 Graphical Knowledge Augmented Generation ‣ 2 Methodology ‣ CodeGRAG: Bridging the Gap between Natural Language and Programming Language via Graphical Retrieval Augmented Generation"><span class="ltx_text ltx_ref_tag">5</span></a>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS4.SSS2.p8">
<p class="ltx_p" id="S2.SS4.SSS2.p8.1"><span class="ltx_text ltx_font_bold" id="S2.SS4.SSS2.p8.1.1">Inference.</span>
After the finetuning stage, we used the tuned models to generate codes using the soft prompting template as illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#S2.F5" title="Figure 5 ‣ 2.4.1 Hard Meta-Graph Prompt ‣ 2.4 Graphical Knowledge Augmented Generation ‣ 2 Methodology ‣ CodeGRAG: Bridging the Gap between Natural Language and Programming Language via Graphical Retrieval Augmented Generation"><span class="ltx_text ltx_ref_tag">5</span></a>.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Experiments</h2>
<div class="ltx_para ltx_noindent" id="S3.p1">
<ul class="ltx_itemize" id="S3.I1">
<li class="ltx_item" id="S3.I1.ix1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span class="ltx_text ltx_font_bold" id="S3.I1.ix1.1.1.1">RQ1</span></span>
<div class="ltx_para" id="S3.I1.ix1.p1">
<p class="ltx_p" id="S3.I1.ix1.p1.1">Does the proposed CodeGRAG offer performance gain against the base model?</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.ix2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span class="ltx_text ltx_font_bold" id="S3.I1.ix2.1.1.1">RQ2</span></span>
<div class="ltx_para" id="S3.I1.ix2.p1">
<p class="ltx_p" id="S3.I1.ix2.p1.1">Does the proposed graph view abstract more informative knowledge compared with the raw code block?</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.ix3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span class="ltx_text ltx_font_bold" id="S3.I1.ix3.1.1.1">RQ3</span></span>
<div class="ltx_para" id="S3.I1.ix3.p1">
<p class="ltx_p" id="S3.I1.ix3.p1.1">Can soft prompting enhance the capability of the backbone LLMs? Does finetuning with the soft prompting outperforms the simple supervised finetuning?</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.ix4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span class="ltx_text ltx_font_bold" id="S3.I1.ix4.1.1.1">RQ4</span></span>
<div class="ltx_para" id="S3.I1.ix4.p1">
<p class="ltx_p" id="S3.I1.ix4.p1.1">Are the proposed pretraining objectives for the GNN expert effective?</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.ix5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span class="ltx_text ltx_font_bold" id="S3.I1.ix5.1.1.1">RQ5</span></span>
<div class="ltx_para" id="S3.I1.ix5.p1">
<p class="ltx_p" id="S3.I1.ix5.p1.1">What is the impact of each of the components of the graphical view?</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.ix6" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span class="ltx_text ltx_font_bold" id="S3.I1.ix6.1.1.1">RQ6</span></span>
<div class="ltx_para ltx_noindent" id="S3.I1.ix6.p1">
<p class="ltx_p" id="S3.I1.ix6.p1.1">How is the compatibility of the graphical view?</p>
</div>
</li>
</ul>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Setup</h3>
<div class="ltx_para ltx_noindent" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">In this paper, we evaluate CodeGRAG with the widely used HumanEval-X <cite class="ltx_cite ltx_citemacro_citep">(Zheng et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#bib.bib32" title="">2023</a>)</cite> dataset, which is a multi-lingual code benchmark and CodeForce dataset in which we collect real-world programming problems from codeforces<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>https://codeforces.com/</span></span></span> website. For CodeForce dataset we include problems categorized by different difficulty levels corresponding to the website and select <math alttext="469" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><mn id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">469</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><cn id="S3.SS1.p1.1.m1.1.1.cmml" type="integer" xref="S3.SS1.p1.1.m1.1.1">469</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">469</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">469</annotation></semantics></math> problems of difficulty level A for testing. We use greedy decoding strategy to do the generation. The evaluation metric is Pass@1.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.1">For the size of retrieval pool, we use 11,913 C++ code snippets and 2,359 python code snippets. Due to the limited access, we do not use a large retrieval corpus for our experiment, which can be enlarged by other people for better performance. We also attach the graph extraction codes for both languages and all other expeirment codes here: https://anonymous.4open.science/r/Code-5970/</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p3">
<p class="ltx_p" id="S3.SS1.p3.1">For the fintuning details, the learning rate and weight decay for the expert GNN training is 0.001 and 1e-5, repectively. We apply 8-bit quantization and use LoRA for parameter-efficient fine-tuning. The rank of the low-rank matrices in LoRA is uniformly set to 8, alpha set to 16, and dropout is set to 0.05. The LoRA modules are uniformly applied to the Q and V parameter matrices of the attention modules in each layer of the LLM. All the three models are optimized using the AdamW optimizer. For the CodeContest dataset, totally 10609 datapoints are used, and for APPS dataset, 8691 data samples are used to train the model.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Main Results</h3>
<div class="ltx_para ltx_noindent" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">The main results are summarized in Table <a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#S3.T1" title="Table 1 ‣ 3.2 Main Results ‣ 3 Experiments ‣ CodeGRAG: Bridging the Gap between Natural Language and Programming Language via Graphical Retrieval Augmented Generation"><span class="ltx_text ltx_ref_tag">1</span></a> and Table <a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#S3.T2" title="Table 2 ‣ 3.2 Main Results ‣ 3 Experiments ‣ CodeGRAG: Bridging the Gap between Natural Language and Programming Language via Graphical Retrieval Augmented Generation"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<figure class="ltx_table" id="S3.T1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Results of Hard Meta-Graph Prompt on Humaneval-X. (Pass@1)</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S3.T1.1" style="width:429.3pt;height:151.1pt;vertical-align:-0.8pt;"><span class="ltx_transformed_inner" style="transform:translate(-68.1pt,23.8pt) scale(0.759106570489471,0.759106570489471) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S3.T1.1.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T1.1.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T1.1.1.1.1.1">Model</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.1.1.2">Retrieved Knowledge</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.1.1.3">C++</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.1.1.4">Python</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.1.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T1.1.1.2.2.1" rowspan="5"><span class="ltx_text" id="S3.T1.1.1.2.2.1.1">GPT-3.5-Turbo</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.2.2.2">N/A</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.2.2.3">57.93</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.2.2.4">71.95</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.1.3.3">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.3.3.1">Code Block <cite class="ltx_cite ltx_citemacro_citep">(Nashid et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#bib.bib23" title="">2023</a>; Lu et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#bib.bib21" title="">2022</a>)</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.3.3.2">60.37</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.3.3.3">72.56</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.1.4.4">
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.4.4.1">Meta-Graph</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.4.4.2"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.4.4.2.1">62.20</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.4.4.3"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.4.4.3.1">72.56</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.1.5.5">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.5.5.1">(Multi-Lingual) Code-Block <cite class="ltx_cite ltx_citemacro_citep">(Nashid et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#bib.bib23" title="">2023</a>; Lu et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#bib.bib21" title="">2022</a>)</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.5.5.2">62.20</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.5.5.3">70.12</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.1.6.6">
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.6.6.1">(Multi-Lingual) Meta-Graph</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.6.6.2"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.6.6.2.1">64.02</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.6.6.3"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.6.6.3.1">77.44</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.1.7.7">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r ltx_border_t" id="S3.T1.1.1.7.7.1" rowspan="5"><span class="ltx_text" id="S3.T1.1.1.7.7.1.1">GPT-4omini</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.7.7.2">N/A</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.7.7.3">65.24</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.7.7.4">78.66</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.1.8.8">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.8.8.1">Code Block <cite class="ltx_cite ltx_citemacro_citep">(Nashid et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#bib.bib23" title="">2023</a>; Lu et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#bib.bib21" title="">2022</a>)</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.8.8.2">65.24</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.8.8.3">78.66</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.1.9.9">
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.9.9.1">Meta-Graph</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.9.9.2"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.9.9.2.1">65.85</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.1.9.9.3"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.9.9.3.1">79.88</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.1.10.10">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.10.10.1">(Multi-Lingual) Code-Block <cite class="ltx_cite ltx_citemacro_citep">(Nashid et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#bib.bib23" title="">2023</a>; Lu et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#bib.bib21" title="">2022</a>)</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.10.10.2">65.85</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.10.10.3">79.27</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.1.11.11">
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T1.1.1.11.11.1">(Multi-Lingual) Meta-Graph</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T1.1.1.11.11.2"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.11.11.2.1">67.07</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T1.1.1.11.11.3"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.11.11.3.1">80.49</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure class="ltx_table" id="S3.T2">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Results of Soft Prompting. (Pass@1)</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S3.T2.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T2.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S3.T2.1.1.1.1">Model</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S3.T2.1.1.1.2">Finetune</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T2.1.1.1.3">CodeForce (C++)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T2.1.1.1.4">APPS (Python)</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T2.1.2.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T2.1.2.1.1" rowspan="3"><span class="ltx_text" id="S3.T2.1.2.1.1.1">Gemma 7b</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T2.1.2.1.2">N/A</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.2.1.3">12.83</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.2.1.4">5.09</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.3.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T2.1.3.2.1">SFT</th>
<td class="ltx_td ltx_align_center" id="S3.T2.1.3.2.2">14.76</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.3.2.3">21.09</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.4.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T2.1.4.3.1">Soft Prompting</th>
<td class="ltx_td ltx_align_center" id="S3.T2.1.4.3.2">19.13</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.4.3.3">26.15</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.5.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T2.1.5.4.1" rowspan="3"><span class="ltx_text" id="S3.T2.1.5.4.1.1">Llama2 13b</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T2.1.5.4.2">N/A</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.5.4.3">9.61</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.5.4.4">7.29</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.6.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T2.1.6.5.1">SFT</th>
<td class="ltx_td ltx_align_center" id="S3.T2.1.6.5.2">11.88</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.6.5.3">12.06</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.7.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T2.1.7.6.1">Soft Prompting</th>
<td class="ltx_td ltx_align_center" id="S3.T2.1.7.6.2">13.62</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.7.6.3">12.74</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.8.7">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r ltx_border_t" id="S3.T2.1.8.7.1" rowspan="3"><span class="ltx_text" id="S3.T2.1.8.7.1.1">CodeLlama 7b</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T2.1.8.7.2">N/A</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.8.7.3">5.20</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.8.7.4">24.41</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.9.8">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T2.1.9.8.1">SFT</th>
<td class="ltx_td ltx_align_center" id="S3.T2.1.9.8.2">9.87</td>
<td class="ltx_td ltx_align_center" id="S3.T2.1.9.8.3">26.15</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.10.9">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r" id="S3.T2.1.10.9.1">Soft Prompting</th>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T2.1.10.9.2">11.09</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T2.1.10.9.3">30.26</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para ltx_noindent" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.1">From the results, we can draw the following conclusions:</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p3">
<p class="ltx_p" id="S3.SS2.p3.1"><span class="ltx_text ltx_font_bold" id="S3.SS2.p3.1.1">RQ1.</span> The proposed CodeGRAG could offer performance gain against the base model, which validates the effectiveness of the proposed graphical retrieval augmented generation for code generation framework.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p4">
<p class="ltx_p" id="S3.SS2.p4.1"><span class="ltx_text ltx_font_bold" id="S3.SS2.p4.1.1">RQ2.</span> The model informed by the meta-graph (CodeGRAG) could beat model informed by the raw code block. From the results, we can see that the proposed graph view could summarize the useful structural syntax information and filter out the noises, which could offer more informative knowledge hints than the raw code block. In addition, inserting the intermediate representations of codes into the prompt can stimulate the corresponding programming knowledge of LLMs.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p5">
<p class="ltx_p" id="S3.SS2.p5.1"><span class="ltx_text ltx_font_bold" id="S3.SS2.p5.1.1">RQ3.</span> From Table <a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#S3.T2" title="Table 2 ‣ 3.2 Main Results ‣ 3 Experiments ‣ CodeGRAG: Bridging the Gap between Natural Language and Programming Language via Graphical Retrieval Augmented Generation"><span class="ltx_text ltx_ref_tag">2</span></a>, we can see that finetuning with the expert soft prompting could offer more performance gain than that brought by simple supervised finetuning. This validates the effectiveness of the designed pretraining expert network and the technique of finetuning with soft prompting, which injects the programming domain knowledge into the LLMs parameters and inform the models with the structural information for gap filling.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Impacts of the pretraining objectives for the expert GNN (<span class="ltx_text ltx_font_bold" id="S3.SS3.1.1">RQ4</span>)</h3>
<div class="ltx_para ltx_noindent" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">To study the effectiveness of the proposed pretraining objectives for the expert GNN, we remove each objective to yield different expert GNNs. The results are in Table <a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#S3.T3" title="Table 3 ‣ 3.3 Impacts of the pretraining objectives for the expert GNN (RQ4) ‣ 3 Experiments ‣ CodeGRAG: Bridging the Gap between Natural Language and Programming Language via Graphical Retrieval Augmented Generation"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
<figure class="ltx_table" id="S3.T3">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Ablation studies on the GNN pretraining losses.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S3.T3.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T3.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S3.T3.1.1.1.1">Model</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S3.T3.1.1.1.2">Finetune</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T3.1.1.1.3">CodeForce (C++)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T3.1.1.1.4">APPS (Python)</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T3.1.2.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T3.1.2.1.1" rowspan="3"><span class="ltx_text" id="S3.T3.1.2.1.1.1">Gemma 7b</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T3.1.2.1.2">Soft Prompting</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.2.1.3">19.13</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.2.1.4">26.15</td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.3.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T3.1.3.2.1">w/o Alignment</th>
<td class="ltx_td ltx_align_center" id="S3.T3.1.3.2.2">7.88</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.3.2.3">28.58</td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.4.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T3.1.4.3.1">w/o Structure-Preserving</th>
<td class="ltx_td ltx_align_center" id="S3.T3.1.4.3.2">11.70</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.4.3.3">21.50</td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.5.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T3.1.5.4.1" rowspan="3"><span class="ltx_text" id="S3.T3.1.5.4.1.1">Llama2 13b</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T3.1.5.4.2">Soft Prompting</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.5.4.3">13.62</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.5.4.4">12.74</td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.6.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T3.1.6.5.1">w/o Alignment</th>
<td class="ltx_td ltx_align_center" id="S3.T3.1.6.5.2">11.79</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.6.5.3">10.76</td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.7.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T3.1.7.6.1">w/o Structure-Preserving</th>
<td class="ltx_td ltx_align_center" id="S3.T3.1.7.6.2">5.50</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.7.6.3">11.09</td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.8.7">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r ltx_border_t" id="S3.T3.1.8.7.1" rowspan="3"><span class="ltx_text" id="S3.T3.1.8.7.1.1">CodeLlama 7b</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T3.1.8.7.2">Soft Prompting</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.8.7.3">11.09</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.1.8.7.4">30.26</td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.9.8">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S3.T3.1.9.8.1">w/o Alignment</th>
<td class="ltx_td ltx_align_center" id="S3.T3.1.9.8.2">10.92</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.9.8.3">29.45</td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.10.9">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r" id="S3.T3.1.10.9.1">w/o Structure-Preserving</th>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T3.1.10.9.2">10.66</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S3.T3.1.10.9.3">26.59</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para ltx_noindent" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.1">From the results, we could see that both the Alignment and the Structure Preserving contribute to the expressiveness of the expert GNN model. The alignment pretraining objective helps to promote the alignment among natural language, programming language, and their graphical views. The structure preserving objective helps to preserve the innate data-flows and control-flows information of code blocks. The two objectives collaborate with each other to yield expressive programming domain knowledge GNN expert model, which encodes external programming knowledge and injects the knowledge into LLMs parameters.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Impacts of the Components of the Graphical View (<span class="ltx_text ltx_font_bold" id="S3.SS4.1.1">RQ5</span>)</h3>
<div class="ltx_para ltx_noindent" id="S3.SS4.p1">
<p class="ltx_p" id="S3.SS4.p1.1">In this section, we adjust the inputs of the graphical components to the LLMs. Concretely, we study the information contained in node names, edge names, and the topological structure. The results are presented in Table <a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#S3.T4" title="Table 4 ‣ 3.4 Impacts of the Components of the Graphical View (RQ5) ‣ 3 Experiments ‣ CodeGRAG: Bridging the Gap between Natural Language and Programming Language via Graphical Retrieval Augmented Generation"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<figure class="ltx_table" id="S3.T4">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>The impacts of the graph components. </figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S3.T4.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T4.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T4.1.1.1.1">Datasets</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T4.1.1.1.2">Python</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T4.1.1.1.3">C++</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T4.1.2.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.1.2.1.1">Edge Type Only</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.1.2.1.2">73.78</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.1.2.1.3">61.59</td>
</tr>
<tr class="ltx_tr" id="S3.T4.1.3.2">
<td class="ltx_td ltx_align_center" id="S3.T4.1.3.2.1">Edge Type + Node Name</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.3.2.2">75.00</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.3.2.3">59.76</td>
</tr>
<tr class="ltx_tr" id="S3.T4.1.4.3">
<td class="ltx_td ltx_align_center" id="S3.T4.1.4.3.1">Edge Type + Node Type</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.4.3.2">75.61</td>
<td class="ltx_td ltx_align_center" id="S3.T4.1.4.3.3">59.15</td>
</tr>
<tr class="ltx_tr" id="S3.T4.1.5.4">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T4.1.5.4.1">Edge Type + Topological</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T4.1.5.4.2">77.44</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T4.1.5.4.3">64.02</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para ltx_noindent" id="S3.SS4.p2">
<p class="ltx_p" id="S3.SS4.p2.1">The edge type refers to the type of flows between operands (child, read, write, etc.), the node type refers to the type of operands (DeclStmt, temp, etc.), the node name refers to the name of the intermediate variables, and the topological information refers to the statistics of the concrete numbers of different types of edges. From the results, we can observe that 1) the edge features matter the most in constructing the structural view of code blocks for enhancement, 2) the type of nodes expresses the most in representing operands information, and 3) the overall structure of the graphical view also gives additional information.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.5 </span>Compatibility Discussion of the Graphical Views(<span class="ltx_text ltx_font_bold" id="S3.SS5.1.1">RQ6</span>)</h3>
<div class="ltx_para ltx_noindent" id="S3.SS5.p1">
<p class="ltx_p" id="S3.SS5.p1.1">Despite the effectiveness of the proposed graphical views to represent the code blocks, the flexibility and convenience of applying the graphical views extraction process is important for wider application of the proposed method. In this section, we discuss the compatibility of CodeGRAG.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS5.p2">
<p class="ltx_p" id="S3.SS5.p2.1">First of all, the extraction process of all the graphical views are front-end. Therefore, this extraction process applies to a wide range of code, even error code. One could also use convenient tools to reformulate the code and improve the pass rate of the extraction process.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS5.p3">
<p class="ltx_p" id="S3.SS5.p3.1">In addition, we give the ratio of generated results that can pass the graphical views extraction process, which is denoted by Extraction Rate.
The Pass@1 and the Extraction Rate of the generated results passing the graphical extraction process are given in Table <a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#S3.T5" title="Table 5 ‣ 3.5 Compatibility Discussion of the Graphical Views(RQ6) ‣ 3 Experiments ‣ CodeGRAG: Bridging the Gap between Natural Language and Programming Language via Graphical Retrieval Augmented Generation"><span class="ltx_text ltx_ref_tag">5</span></a>.</p>
</div>
<figure class="ltx_table" id="S3.T5">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5: </span>The extraction rate of the generated results passing the graphical extraction process. </figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S3.T5.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T5.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T5.1.1.1.1">Generated Codes</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T5.1.1.1.2">Pass@1</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T5.1.1.1.3">Extraction Rate</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T5.1.2.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.2.1.1">(C++) Code-RAG</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.2.1.2">62.20</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.1.2.1.3">92.07</td>
</tr>
<tr class="ltx_tr" id="S3.T5.1.3.2">
<td class="ltx_td ltx_align_center" id="S3.T5.1.3.2.1">(C++) CodeGRAG</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.3.2.2">64.02</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.3.2.3">92.68</td>
</tr>
<tr class="ltx_tr" id="S3.T5.1.4.3">
<td class="ltx_td ltx_align_center" id="S3.T5.1.4.3.1">(Python) Code-RAG</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.4.3.2">71.95</td>
<td class="ltx_td ltx_align_center" id="S3.T5.1.4.3.3">91.46</td>
</tr>
<tr class="ltx_tr" id="S3.T5.1.5.4">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T5.1.5.4.1">(Python) CodeGRAG</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T5.1.5.4.2">77.44</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T5.1.5.4.3">96.95</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para ltx_noindent" id="S3.SS5.p4">
<p class="ltx_p" id="S3.SS5.p4.1">From the results, we could see that the extraction rates are high for codes to pass the graphical views extraction process, even under the situation where the Pass@1 ratios of the generated results are low. This indicates that the application range of the proposed method is wide. In addition, as the code RAG also offers performance gains, one could use multiple views as the retrieval knowledge.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Related Work</h2>
<div class="ltx_para ltx_noindent" id="S4.p1">
<p class="ltx_p" id="S4.p1.1"><span class="ltx_text ltx_font_bold" id="S4.p1.1.1">LLMs for NL2Code.</span> The evolution of the Natural Language to Code translation (NL2Code) task has been significantly influenced by the development of large language models (LLMs). Initially, general LLMs like GPT-J <cite class="ltx_cite ltx_citemacro_citep">(Radford et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#bib.bib24" title="">2023</a>)</cite>, GPT-NeoX <cite class="ltx_cite ltx_citemacro_citep">(Black et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#bib.bib7" title="">2022</a>)</cite>, and LLaMA <cite class="ltx_cite ltx_citemacro_citep">(Touvron et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#bib.bib28" title="">2023a</a>)</cite>, despite not being specifically tailored for code generation, showed notable NL2Code capabilities due to their training on datasets containing extensive code data like the Pile <cite class="ltx_cite ltx_citemacro_citep">(Gao et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#bib.bib12" title="">2020</a>)</cite> and ROOTS <cite class="ltx_cite ltx_citemacro_citep">(Laurençon et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#bib.bib19" title="">2022</a>)</cite>. To further enhance these capabilities, additional pretraining specifically focused on code has been employed. PaLM-Coder, an adaptation of the PaLM model <cite class="ltx_cite ltx_citemacro_citep">(Chowdhery et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#bib.bib9" title="">2023</a>)</cite>, underwent further training on an extra 7.8 billion code tokens, significantly improving its performance in code-related tasks. Similarly, Code LLaMA <cite class="ltx_cite ltx_citemacro_citep">(Roziere et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#bib.bib25" title="">2023</a>)</cite> represents an advancement of LLaMA2 <cite class="ltx_cite ltx_citemacro_citep">(Touvron et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#bib.bib29" title="">2023b</a>)</cite>, benefiting from extended training on over 500 billion code tokens, leading to marked improvements over previous models in both code generation and understanding. These developments underscore the potential of adapting generalist LLMs to specific domains like NL2Code through targeted training, leading to more effective and efficient code translation solutions.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.p2">
<p class="ltx_p" id="S4.p2.1"><span class="ltx_text ltx_font_bold" id="S4.p2.1.1">Code Search.</span> The code search methods can be summarized into three folds. Early methods utilizes sparse search to match the query and codes <cite class="ltx_cite ltx_citemacro_citep">(Hill et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#bib.bib17" title="">2011</a>; Yang &amp; Huang, <a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#bib.bib31" title="">2017</a>)</cite>, which suffers from mismatched vocabulary due to the gap between natural language and codes. Neural methods <cite class="ltx_cite ltx_citemacro_citep">(Cambronero et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#bib.bib8" title="">2019</a>; Gu et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#bib.bib13" title="">2021</a>)</cite> then focus on mapping the query and codes into a joint representation space for more accurate retrieval. With the success of pretrained language models, many methods propose to use pretraining tasks to improve the code understanding abilities and align different language spaces. For example, CodeBERT <cite class="ltx_cite ltx_citemacro_citep">(Feng et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#bib.bib11" title="">2020</a>)</cite> is pretrained on NL-PL pairs of 6 programming languages with the masked language modeling and replaced token detection task. CodeT5 <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#bib.bib30" title="">2021</a>)</cite> supports both code-related understanding and generation tasks through bimodal dual generation. UniXcoder <cite class="ltx_cite ltx_citemacro_citep">(Guo et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#bib.bib15" title="">2022</a>)</cite> integrates the aforementioned pretraining tasks, which is a unified cross-modal pre-trained model. As retrieval augmented generation (RAG) shows its significance in promoting the quality of LLMs generation, works in code RAG start to accumulate. <cite class="ltx_cite ltx_citemacro_cite">Nashid et al. (<a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#bib.bib23" title="">2023</a>); Lu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#bib.bib21" title="">2022</a>)</cite> utilize the code blocks as the retrieved knowledge to inform the LLMs with similar code blocks for enhancement. <cite class="ltx_cite ltx_citemacro_cite">Zhou et al. (<a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#bib.bib33" title="">2022</a>)</cite> uses the programming related document to serve as the retrieval content, injecting auxiliary external programming knowledge into the LLMs generation.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.p3">
<p class="ltx_p" id="S4.p3.1"><span class="ltx_text ltx_font_bold" id="S4.p3.1.1">Code Representation.</span>
Early methods regard code snippets as sequences of tokens, assuming the adjacent tokens will have strong correlations. This line of methods <cite class="ltx_cite ltx_citemacro_citep">(Harer et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#bib.bib16" title="">2018</a>; Ben-Nun et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#bib.bib6" title="">2018</a>; Feng et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#bib.bib11" title="">2020</a>; Ciniselli et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#bib.bib10" title="">2021</a>)</cite> take programming languages as the same with the natural language, using language models to encode the code snippets too. However, this ignoring of the inherent structure of codes leads to a loss of expressiveness. Methods that take the structural information of codes into consideration then emerge. <cite class="ltx_cite ltx_citemacro_citet">Mou et al. (<a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#bib.bib22" title="">2016</a>)</cite> used convolution networks over the abstract syntax tree (AST) extracted from codes. <cite class="ltx_cite ltx_citemacro_citet">Alon et al. (<a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#bib.bib5" title="">2019</a>)</cite> encoded paths sampled from the AST to represent codes. Further exploration into the graphical representation of codes <cite class="ltx_cite ltx_citemacro_citep">(Allamanis et al., <a class="ltx_ref" href="https://arxiv.org/html/2405.02355v2#bib.bib3" title="">2017</a>)</cite> is conducted to better encode the structures of codes, where more intermediate states of the codes are considered.</p>
</div>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>
<div class="ltx_para ltx_noindent" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">Despite the expanding role of LLMs in code generation, there are inherent challenges pertaining to their understanding of code syntax and their multi-lingual code generation capabilities.
This paper introduces the Syntax Graph Retrieval Augmented Code Generation (CodeGRAG) to enhance LLMs for single round and cross-lingual code generation. CodeGRAG extracts and summarizes data flow and control flow information from codes, effectively bridging the gap between programming language and natural language. By integrating external structural knowledge, CodeGRAG enhances LLMs’ comprehension of code syntax and empowers them to generate complex and multi-lingual code with improved accuracy and fluency.</p>
</div>
<section class="ltx_subsubsection" id="S5.SS0.SSSx1">
<h4 class="ltx_title ltx_title_subsubsection">Author Contributions</h4>
<div class="ltx_para ltx_noindent" id="S5.SS0.SSSx1.p1">
<p class="ltx_p" id="S5.SS0.SSSx1.p1.1">If you’d like to, you may include a section for author contributions as is done
in many journals. This is optional and at the discretion of the authors.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S5.SS0.SSSx2">
<h4 class="ltx_title ltx_title_subsubsection">Acknowledgments</h4>
<div class="ltx_para ltx_noindent" id="S5.SS0.SSSx2.p1">
<p class="ltx_p" id="S5.SS0.SSSx2.p1.1">Use unnumbered third level headings for the acknowledgments. All
acknowledgments, including those to funding agencies, go at the end of the paper.</p>
</div>
</section>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Achiam et al. (2023)</span>
<span class="ltx_bibblock">
Josh Achiam, Steven Adler, Sandhini Agarwal, Lama Ahmad, Ilge Akkaya, Florencia Leoni Aleman, Diogo Almeida, Janko Altenschmidt, Sam Altman, Shyamal Anadkat, et al.

</span>
<span class="ltx_bibblock">Gpt-4 technical report.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">arXiv preprint arXiv:2303.08774</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Aho et al. (2006)</span>
<span class="ltx_bibblock">
Alfred V Aho, Monica S Lam, Ravi Sethi, and Jeffrey D Ullman.

</span>
<span class="ltx_bibblock">Compilers: Principles techniques and tools. 2007.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">Google Scholar Google Scholar Digital Library Digital Library</em>, 2006.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Allamanis et al. (2017)</span>
<span class="ltx_bibblock">
Miltiadis Allamanis, Marc Brockschmidt, and Mahmoud Khademi.

</span>
<span class="ltx_bibblock">Learning to represent programs with graphs.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">arXiv preprint arXiv:1711.00740</em>, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Allen (1970)</span>
<span class="ltx_bibblock">
Frances E Allen.

</span>
<span class="ltx_bibblock">Control flow analysis.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">ACM Sigplan Notices</em>, 5(7):1–19, 1970.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Alon et al. (2019)</span>
<span class="ltx_bibblock">
Uri Alon, Meital Zilberstein, Omer Levy, and Eran Yahav.

</span>
<span class="ltx_bibblock">code2vec: Learning distributed representations of code.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">Proceedings of the ACM on Programming Languages</em>, 3(POPL):1–29, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ben-Nun et al. (2018)</span>
<span class="ltx_bibblock">
Tal Ben-Nun, Alice Shoshana Jakobovits, and Torsten Hoefler.

</span>
<span class="ltx_bibblock">Neural code comprehension: A learnable representation of code semantics.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">Advances in Neural Information Processing Systems</em>, 31, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Black et al. (2022)</span>
<span class="ltx_bibblock">
Sid Black, Stella Biderman, Eric Hallahan, Quentin Anthony, Leo Gao, Laurence Golding, Horace He, Connor Leahy, Kyle McDonell, Jason Phang, et al.

</span>
<span class="ltx_bibblock">Gpt-neox-20b: An open-source autoregressive language model.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">arXiv preprint arXiv:2204.06745</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cambronero et al. (2019)</span>
<span class="ltx_bibblock">
Jose Cambronero, Hongyu Li, Seohyun Kim, Koushik Sen, and Satish Chandra.

</span>
<span class="ltx_bibblock">When deep learning met code search.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">Proceedings of the 2019 27th ACM Joint Meeting on European Software Engineering Conference and Symposium on the Foundations of Software Engineering</em>, pp.  964–974, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chowdhery et al. (2023)</span>
<span class="ltx_bibblock">
Aakanksha Chowdhery, Sharan Narang, Jacob Devlin, Maarten Bosma, Gaurav Mishra, Adam Roberts, Paul Barham, Hyung Won Chung, Charles Sutton, Sebastian Gehrmann, et al.

</span>
<span class="ltx_bibblock">Palm: Scaling language modeling with pathways.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">Journal of Machine Learning Research</em>, 24(240):1–113, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ciniselli et al. (2021)</span>
<span class="ltx_bibblock">
Matteo Ciniselli, Nathan Cooper, Luca Pascarella, Denys Poshyvanyk, Massimiliano Di Penta, and Gabriele Bavota.

</span>
<span class="ltx_bibblock">An empirical study on the usage of bert models for code completion.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">2021 IEEE/ACM 18th International Conference on Mining Software Repositories (MSR)</em>, pp.  108–119. IEEE, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Feng et al. (2020)</span>
<span class="ltx_bibblock">
Zhangyin Feng, Daya Guo, Duyu Tang, Nan Duan, Xiaocheng Feng, Ming Gong, Linjun Shou, Bing Qin, Ting Liu, Daxin Jiang, et al.

</span>
<span class="ltx_bibblock">Codebert: A pre-trained model for programming and natural languages.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">arXiv preprint arXiv:2002.08155</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gao et al. (2020)</span>
<span class="ltx_bibblock">
Leo Gao, Stella Biderman, Sid Black, Laurence Golding, Travis Hoppe, Charles Foster, Jason Phang, Horace He, Anish Thite, Noa Nabeshima, et al.

</span>
<span class="ltx_bibblock">The pile: An 800gb dataset of diverse text for language modeling.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">arXiv preprint arXiv:2101.00027</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gu et al. (2021)</span>
<span class="ltx_bibblock">
Jian Gu, Zimin Chen, and Martin Monperrus.

</span>
<span class="ltx_bibblock">Multimodal representation for neural code search.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">2021 IEEE International Conference on Software Maintenance and Evolution (ICSME)</em>, pp.  483–494. IEEE, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et al. (2020)</span>
<span class="ltx_bibblock">
Daya Guo, Shuo Ren, Shuai Lu, Zhangyin Feng, Duyu Tang, Shujie Liu, Long Zhou, Nan Duan, Alexey Svyatkovskiy, Shengyu Fu, et al.

</span>
<span class="ltx_bibblock">Graphcodebert: Pre-training code representations with data flow.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">arXiv preprint arXiv:2009.08366</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et al. (2022)</span>
<span class="ltx_bibblock">
Daya Guo, Shuai Lu, Nan Duan, Yanlin Wang, Ming Zhou, and Jian Yin.

</span>
<span class="ltx_bibblock">Unixcoder: Unified cross-modal pre-training for code representation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">arXiv preprint arXiv:2203.03850</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Harer et al. (2018)</span>
<span class="ltx_bibblock">
Jacob A Harer, Louis Y Kim, Rebecca L Russell, Onur Ozdemir, Leonard R Kosta, Akshay Rangamani, Lei H Hamilton, Gabriel I Centeno, Jonathan R Key, Paul M Ellingwood, et al.

</span>
<span class="ltx_bibblock">Automated software vulnerability detection with machine learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">arXiv preprint arXiv:1803.04497</em>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hill et al. (2011)</span>
<span class="ltx_bibblock">
Emily Hill, Lori Pollock, and K Vijay-Shanker.

</span>
<span class="ltx_bibblock">Improving source code search with natural language phrasal representations of method signatures.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">2011 26th IEEE/ACM International Conference on Automated Software Engineering (ASE 2011)</em>, pp.  524–527. IEEE, 2011.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang et al. (2021)</span>
<span class="ltx_bibblock">
Xue Jiang, Zhuoran Zheng, Chen Lyu, Liang Li, and Lei Lyu.

</span>
<span class="ltx_bibblock">Treebert: A tree-based pre-trained model for programming language.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">Uncertainty in Artificial Intelligence</em>, pp.  54–63. PMLR, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Laurençon et al. (2022)</span>
<span class="ltx_bibblock">
Hugo Laurençon, Lucile Saulnier, Thomas Wang, Christopher Akiki, Albert Villanova del Moral, Teven Le Scao, Leandro Von Werra, Chenghao Mou, Eduardo González Ponferrada, Huu Nguyen, et al.

</span>
<span class="ltx_bibblock">The bigscience roots corpus: A 1.6 tb composite multilingual dataset.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">Advances in Neural Information Processing Systems</em>, 35:31809–31826, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Long et al. (2022)</span>
<span class="ltx_bibblock">
Ting Long, Yutong Xie, Xianyu Chen, Weinan Zhang, Qinxiang Cao, and Yong Yu.

</span>
<span class="ltx_bibblock">Multi-view graph representation for programming language processing: An investigation into algorithm detection.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">Proceedings of the AAAI Conference on Artificial Intelligence</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lu et al. (2022)</span>
<span class="ltx_bibblock">
Shuai Lu, Nan Duan, Hojae Han, Daya Guo, Seung-won Hwang, and Alexey Svyatkovskiy.

</span>
<span class="ltx_bibblock">Reacc: A retrieval-augmented code completion framework.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">arXiv preprint arXiv:2203.07722</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mou et al. (2016)</span>
<span class="ltx_bibblock">
Lili Mou, Ge Li, Lu Zhang, Tao Wang, and Zhi Jin.

</span>
<span class="ltx_bibblock">Convolutional neural networks over tree structures for programming language processing.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">Proceedings of the AAAI conference on artificial intelligence</em>, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nashid et al. (2023)</span>
<span class="ltx_bibblock">
Noor Nashid, Mifta Sintaha, and Ali Mesbah.

</span>
<span class="ltx_bibblock">Retrieval-based prompt selection for code-related few-shot learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">2023 IEEE/ACM 45th International Conference on Software Engineering (ICSE)</em>, pp.  2450–2462. IEEE, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Radford et al. (2023)</span>
<span class="ltx_bibblock">
Alec Radford, Jong Wook Kim, Tao Xu, Greg Brockman, Christine McLeavey, and Ilya Sutskever.

</span>
<span class="ltx_bibblock">Robust speech recognition via large-scale weak supervision.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">International Conference on Machine Learning</em>, pp.  28492–28518. PMLR, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Roziere et al. (2023)</span>
<span class="ltx_bibblock">
Baptiste Roziere, Jonas Gehring, Fabian Gloeckle, Sten Sootla, Itai Gat, Xiaoqing Ellen Tan, Yossi Adi, Jingyu Liu, Tal Remez, Jérémy Rapin, et al.

</span>
<span class="ltx_bibblock">Code llama: Open foundation models for code.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">arXiv preprint arXiv:2308.12950</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shen et al. (2023)</span>
<span class="ltx_bibblock">
Bo Shen, Jiaxin Zhang, Taihong Chen, Daoguang Zan, Bing Geng, An Fu, Muhan Zeng, Ailun Yu, Jichuan Ji, Jingyang Zhao, et al.

</span>
<span class="ltx_bibblock">Pangu-coder2: Boosting large language models for code with ranking feedback.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">arXiv preprint arXiv:2307.14936</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun &amp; Han (2013)</span>
<span class="ltx_bibblock">
Yizhou Sun and Jiawei Han.

</span>
<span class="ltx_bibblock">Mining heterogeneous information networks: a structural analysis approach.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">ACM SIGKDD explorations newsletter</em>, 14(2):20–28, 2013.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et al. (2023a)</span>
<span class="ltx_bibblock">
Hugo Touvron, Thibaut Lavril, Gautier Izacard, Xavier Martinet, Marie-Anne Lachaux, Timothée Lacroix, Baptiste Rozière, Naman Goyal, Eric Hambro, Faisal Azhar, et al.

</span>
<span class="ltx_bibblock">Llama: Open and efficient foundation language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">arXiv preprint arXiv:2302.13971</em>, 2023a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et al. (2023b)</span>
<span class="ltx_bibblock">
Hugo Touvron, Louis Martin, Kevin Stone, Peter Albert, Amjad Almahairi, Yasmine Babaei, Nikolay Bashlykov, Soumya Batra, Prajjwal Bhargava, Shruti Bhosale, et al.

</span>
<span class="ltx_bibblock">Llama 2: Open foundation and fine-tuned chat models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">arXiv preprint arXiv:2307.09288</em>, 2023b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2021)</span>
<span class="ltx_bibblock">
Yue Wang, Weishi Wang, Shafiq Joty, and Steven CH Hoi.

</span>
<span class="ltx_bibblock">Codet5: Identifier-aware unified pre-trained encoder-decoder models for code understanding and generation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">arXiv preprint arXiv:2109.00859</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang &amp; Huang (2017)</span>
<span class="ltx_bibblock">
Yangrui Yang and Qing Huang.

</span>
<span class="ltx_bibblock">Iecs: Intent-enforced code search via extended boolean model.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">Journal of Intelligent &amp; Fuzzy Systems</em>, 33(4):2565–2576, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zheng et al. (2023)</span>
<span class="ltx_bibblock">
Qinkai Zheng, Xiao Xia, Xu Zou, Yuxiao Dong, Shan Wang, Yufei Xue, Zihan Wang, Lei Shen, Andi Wang, Yang Li, et al.

</span>
<span class="ltx_bibblock">Codegeex: A pre-trained model for code generation with multilingual evaluations on humaneval-x.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">arXiv preprint arXiv:2303.17568</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al. (2022)</span>
<span class="ltx_bibblock">
Shuyan Zhou, Uri Alon, Frank F Xu, Zhiruo Wang, Zhengbao Jiang, and Graham Neubig.

</span>
<span class="ltx_bibblock">Docprompting: Generating code by retrieving the docs.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">arXiv preprint arXiv:2207.05987</em>, 2022.

</span>
</li>
</ul>
</section>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Appendix</h2>
<div class="ltx_para ltx_noindent" id="A1.p1">
<p class="ltx_p" id="A1.p1.1">You may include other additional sections here.</p>
</div>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Wed Oct  2 14:35:11 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
