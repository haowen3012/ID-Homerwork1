<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation</title>
<!--Generated on Wed Jun 19 06:05:58 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2406.13249v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#S1" title="In R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#S2" title="In R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Works</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#S2.SS1" title="In 2 Related Works ‣ R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Retrieval Augmented Generation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#S2.SS2" title="In 2 Related Works ‣ R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Enhanced RAG</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#S3" title="In R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>R<sup class="ltx_sup">2</sup>AG</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#S3.SS1" title="In 3 R2AG ‣ R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Problem Formulation and Overview</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#S3.SS2" title="In 3 R2AG ‣ R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Retrieval Feature Extraction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#S3.SS3" title="In 3 R2AG ‣ R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>R<sup class="ltx_sup">2</sup>-Former</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#S3.SS4" title="In 3 R2AG ‣ R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4 </span>Retrieval-Aware Prompting</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#S3.SS5" title="In 3 R2AG ‣ R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.5 </span>Training Strategy</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#S4" title="In R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#S4.SS1" title="In 4 Experiments ‣ R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Datasets and Metrics</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#S4.SS2" title="In 4 Experiments ‣ R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Baselines</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#S4.SS3" title="In 4 Experiments ‣ R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Main Results</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#S4.SS4" title="In 4 Experiments ‣ R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Ablation Studies</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#S4.SS5" title="In 4 Experiments ‣ R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.5 </span>Discussions</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#S4.SS5.SSS0.Px1" title="In 4.5 Discussions ‣ 4 Experiments ‣ R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_title">The Impact of Performance of Retrievers and LLMs.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#S4.SS5.SSS0.Px2" title="In 4.5 Discussions ‣ 4 Experiments ‣ R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_title">The Effect of Retrieval Information.</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#S5" title="In R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusion and Future Work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#A1" title="In R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Retrieval Feature Extraction Details</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#A2" title="In R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Prompt Templates</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#A3" title="In R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C </span>R<sup class="ltx_sup">2</sup>AG Algorithm</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#A4" title="In R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D </span>Dataset Introduction</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#A4.SS0.SSS0.Px1" title="In Appendix D Dataset Introduction ‣ R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_title">Natural Questions (NQ)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#A4.SS0.SSS0.Px2" title="In Appendix D Dataset Introduction ‣ R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_title">HotpotQA</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#A4.SS0.SSS0.Px3" title="In Appendix D Dataset Introduction ‣ R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_title">MuSiQue</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#A4.SS0.SSS0.Px4" title="In Appendix D Dataset Introduction ‣ R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_title">2WikiMultiHopQA (2Wiki)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#A4.SS0.SSS0.Px5" title="In Appendix D Dataset Introduction ‣ R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_title">DuReader</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#A5" title="In R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">E </span>Implementation Details</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#A6" title="In R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">F </span>Further Discussion</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#A6.SS0.SSS0.Px1" title="In Appendix F Further Discussion ‣ R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_title">Different Document Number</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#A6.SS0.SSS0.Px2" title="In Appendix F Further Discussion ‣ R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_title">Efficiency of R<sup class="ltx_sup">2</sup>AG</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#A7" title="In R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">G </span>Case Studies</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document">
<h1 class="ltx_title ltx_title_document">R<sup class="ltx_sup" id="id7.id1">2</sup>AG: Incorporating Retrieval Information into Retrieval Augmented Generation</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
<span class="ltx_text ltx_font_bold" id="id8.1.id1">Fuda Ye<sup class="ltx_sup" id="id8.1.id1.1">1</sup></span>,
<span class="ltx_text ltx_font_bold" id="id9.2.id2">Shuangyin Li<sup class="ltx_sup" id="id9.2.id2.1">1,</sup></span>,
<span class="ltx_text ltx_font_bold" id="id10.3.id3">Yongqi Zhang<sup class="ltx_sup" id="id10.3.id3.1">2</sup></span>,
<span class="ltx_text ltx_font_bold" id="id11.4.id4">Lei Chen<sup class="ltx_sup" id="id11.4.id4.1">2,3</sup>
<br class="ltx_break"/>
<br class="ltx_break"/><sup class="ltx_sup" id="id11.4.id4.2"><span class="ltx_text ltx_font_medium" id="id11.4.id4.2.1">1</span></sup></span>South China Normal University
<br class="ltx_break"/><sup class="ltx_sup" id="id12.5.id5">2</sup>The Hong Kong University of Science and Technology (Guangzhou)
<br class="ltx_break"/><sup class="ltx_sup" id="id13.6.id6">3</sup>The Hong Kong University of Science and Technology
<br class="ltx_break"/>
<a class="ltx_ref ltx_href" href="mailto:fudayip@m.scnu.edu.cn" title="">fudayip@m.scnu.edu.cn</a>, <a class="ltx_ref ltx_href" href="mailto:shuangyinli@scnu.edu.cn" title="">shuangyinli@scnu.edu.cn</a>, <a class="ltx_ref ltx_href" href="mailto:yongqizhang@hkust-gz.edu.cn" title="">yongqizhang@hkust-gz.edu.cn</a>, <a class="ltx_ref ltx_href" href="mailto:leichen@cse.ust.hk" title="">leichen@cse.ust.hk</a>
</span><span class="ltx_author_notes"><span class="ltx_text ltx_font_bold" id="id14.7.id1">Corresponding author. The source code is available at </span><a class="ltx_ref ltx_url ltx_font_typewriter ltx_font_bold" href="https://github.com/yefd/RRAG.git" title="">https://github.com/yefd/RRAG.git</a><span class="ltx_text ltx_font_bold" id="id15.8.id2">.</span></span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id6.5">Retrieval augmented generation (RAG) has been applied in many scenarios to augment large language models (LLMs) with external documents provided by retrievers. However, a semantic gap exists between LLMs and retrievers due to differences in their training objectives and architectures. This misalignment forces LLMs to passively accept the documents provided by the retrievers, leading to incomprehension in the generation process, where the LLMs are burdened with the task of distinguishing these documents using their inherent knowledge. This paper proposes R<sup class="ltx_sup" id="id6.5.1">2</sup>AG, a novel enhanced RAG framework to fill this gap by incorporating <span class="ltx_text ltx_font_bold" id="id6.5.2">R</span>etrieval information into <span class="ltx_text ltx_font_bold" id="id6.5.3">R</span>etrieval <span class="ltx_text ltx_font_bold" id="id6.5.4">A</span>ugmented <span class="ltx_text ltx_font_bold" id="id6.5.5">G</span>eneration. Specifically, R<sup class="ltx_sup" id="id6.5.6">2</sup>AG utilizes the nuanced features from the retrievers and employs a R<sup class="ltx_sup" id="id6.5.7">2</sup>-Former to capture retrieval information. Then, a retrieval-aware prompting strategy is designed to integrate retrieval information into LLMs’ generation. Notably, R<sup class="ltx_sup" id="id6.5.8">2</sup>AG suits low-source scenarios where LLMs and retrievers are frozen. Extensive experiments across five datasets validate the effectiveness, robustness, and efficiency of R<sup class="ltx_sup" id="id6.5.9">2</sup>AG. Our analysis reveals that retrieval information serves as an anchor to aid LLMs in the generation process, thereby filling the semantic gap.</p>
</div>
<div class="ltx_para ltx_noindent" id="p1">
<div class="ltx_block ltx_align_bottom" id="p1.1">
<p class="ltx_p" id="p1.1.1"><span class="ltx_text ltx_font_bold" id="p1.1.1.1">R<sup class="ltx_sup" id="p1.1.1.1.1"><span class="ltx_text ltx_font_medium" id="p1.1.1.1.1.1">2</span></sup>AG: Incorporating Retrieval Information into Retrieval Augmented Generation</span></p>
<br class="ltx_break ltx_centering"/>
<p class="ltx_p ltx_align_center" id="p1.1.2" style="width:433.6pt;"><span class="ltx_text ltx_inline-block" id="p1.1.2.1" style="width:0.0pt;">
<span class="ltx_tabular ltx_align_top" id="p1.1.2.1.1">
<span class="ltx_tr" id="p1.1.2.1.1.1">
<span class="ltx_td ltx_align_center" id="p1.1.2.1.1.1.1"><span class="ltx_text ltx_font_bold" id="p1.1.2.1.1.1.1.1">
Fuda Ye<sup class="ltx_sup" id="p1.1.2.1.1.1.1.1.1">1</sup>,
Shuangyin Li<sup class="ltx_sup" id="p1.1.2.1.1.1.1.1.2">1,<span class="ltx_note ltx_role_thanks" id="p1.1.2.1.1.1.1.1.2.1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">thanks: </span>Corresponding author. The source code is available at <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/yefd/RRAG.git" title="">https://github.com/yefd/RRAG.git</a>.</span></span></span></sup>,
Yongqi Zhang<sup class="ltx_sup" id="p1.1.2.1.1.1.1.1.3">2</sup>,
Lei Chen<sup class="ltx_sup" id="p1.1.2.1.1.1.1.1.4">2,3</sup></span></span></span>
<span class="ltx_tr" id="p1.1.2.1.1.2">
<span class="ltx_td ltx_align_center" id="p1.1.2.1.1.2.1"><sup class="ltx_sup" id="p1.1.2.1.1.2.1.1">1</sup>South China Normal University</span></span>
<span class="ltx_tr" id="p1.1.2.1.1.3">
<span class="ltx_td ltx_align_center" id="p1.1.2.1.1.3.1"><sup class="ltx_sup" id="p1.1.2.1.1.3.1.1">2</sup>The Hong Kong University of Science and Technology (Guangzhou)</span></span>
<span class="ltx_tr" id="p1.1.2.1.1.4">
<span class="ltx_td ltx_align_center" id="p1.1.2.1.1.4.1"><sup class="ltx_sup" id="p1.1.2.1.1.4.1.1">3</sup>The Hong Kong University of Science and Technology</span></span>
<span class="ltx_tr" id="p1.1.2.1.1.5">
<span class="ltx_td ltx_align_center" id="p1.1.2.1.1.5.1">
<a class="ltx_ref ltx_href" href="mailto:fudayip@m.scnu.edu.cn" title="">fudayip@m.scnu.edu.cn</a>, <a class="ltx_ref ltx_href" href="mailto:shuangyinli@scnu.edu.cn" title="">shuangyinli@scnu.edu.cn</a>, <a class="ltx_ref ltx_href" href="mailto:yongqizhang@hkust-gz.edu.cn" title="">yongqizhang@hkust-gz.edu.cn</a>, <a class="ltx_ref ltx_href" href="mailto:leichen@cse.ust.hk" title="">leichen@cse.ust.hk</a></span></span>
</span></span></p>
<br class="ltx_break ltx_centering"/>
</div>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="616" id="S1.F1.g1" src="x1.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>A comparison between RAG and R<sup class="ltx_sup" id="S1.F1.10.1">2</sup>AG. R<sup class="ltx_sup" id="S1.F1.11.2">2</sup>AG employs a trainable R<sup class="ltx_sup" id="S1.F1.12.3">2</sup>-Former to bridge the semantic gap between retrievers and LLMs. Optionally, LLMs can be fine-tuned to understand the retrieval information further.</figcaption>
</figure>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Retrieval augmented generation (RAG) <cite class="ltx_cite ltx_citemacro_cite">Lewis et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib22" title="">2020</a>)</cite> significantly enhances the capabilities of large language models (LLMs) by integrating external, non-parametric knowledge provided by retrievers. In RAG framework, the retriever locates and looks up useful documents based on a given query, and then the LLM interacts with these retrieved results to generate a response. The coordination of retrieval and generation achieves impressive performance without additional training. Especially in domain-specific and knowledge-intensive tasks, RAG offers real-time knowledge with high interpretability to LLMs, effectively mitigating the hallucination problem <cite class="ltx_cite ltx_citemacro_cite">Mallen et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib29" title="">2023</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">However, there exists a semantic gap between retrievers and LLMs due to their vastly different training objectives and architectures <cite class="ltx_cite ltx_citemacro_cite">BehnamGhader et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib6" title="">2022</a>)</cite>. Specifically, retrievers, typically encoder architecture, are designed to retrieve the most relevant documents for a query <cite class="ltx_cite ltx_citemacro_cite">Zhu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib53" title="">2023b</a>)</cite>. Conversely, LLMs, generally decoder architecture, are expected to answer questions based on their inherent knowledge or given documents. However, the interaction between retrievers and LLMs in RAG primarily relies on simple text concatenation <cite class="ltx_cite ltx_citemacro_cite">BehnamGhader et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib6" title="">2022</a>)</cite>. This poor communication strategy will lead to several challenges for LLMs.
<span class="ltx_text ltx_font_bold" id="S1.p2.1.1">Externally</span>,
it is hard for LLMs to utilize more information from retrievers in separate processes. In RAG, the retrieved documents that only preserve sequential relationships
are unidirectionally delivered to LLMs, and LLMs do not fully understand why retrievers provide the documents.
Particularly, low-quality documents inevitably appear in retrieved results <cite class="ltx_cite ltx_citemacro_cite">Barnett et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib5" title="">2024</a>)</cite>, but LLMs have to accept this noise passively.
<span class="ltx_text ltx_font_bold" id="S1.p2.1.2">Internally</span>,
it is hard for LLMs to handle all of the retrieved documents with their inherent knowledge. LLMs must process all the results and assess which documents are important, impacting their ability to generate accurate answers <cite class="ltx_cite ltx_citemacro_cite">Wu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib40" title="">2024</a>)</cite>. Moreover, LLMs face the lost-in-middle problem in overly long documents <cite class="ltx_cite ltx_citemacro_cite">Liu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib27" title="">2023</a>)</cite>, leading to further misunderstanding.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Unfortunately, existing enhanced RAG methods, including pre-processing approaches <cite class="ltx_cite ltx_citemacro_cite">Izacard et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib15" title="">2022</a>); Yan et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib44" title="">2024</a>); Asai et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib2" title="">2023</a>); Ke et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib18" title="">2024</a>)</cite> and compression-based approaches <cite class="ltx_cite ltx_citemacro_cite">Yan et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib44" title="">2024</a>); Xu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib42" title="">2023</a>); Jiang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib16" title="">2023</a>)</cite>, do not recognize this semantic gap between retrievers and LLMs. They remain to treat retrieval and generation as separate processes and directly add processed or compressed documents into the inputs for LLMs. These strategies ignore the semantic connections necessary for deeper comprehension, which may lead to potentially misleading LLMs even with perfect retrievers.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">To address these challenges, it is essential to bridge the semantic gap between retrievers and LLMs.
As previously mentioned, retrievers can provide high-quality semantic representations that can be beneficial for catching nuanced differences among documents <cite class="ltx_cite ltx_citemacro_cite">Zhao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib50" title="">2022</a>)</cite>. Thus, our intuition is to exploit these semantic representations as additional knowledge, empower LLMs to gain a deeper comprehension of the retrieved documents, and thereby generate more accurate responses.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.8">This paper proposes a cost-effective enhanced RAG framework to incorporate <span class="ltx_text ltx_font_bold" id="S1.p5.8.1">R</span>etrieval information into <span class="ltx_text ltx_font_bold" id="S1.p5.8.2">R</span>etrieval <span class="ltx_text ltx_font_bold" id="S1.p5.8.3">A</span>rgumented <span class="ltx_text ltx_font_bold" id="S1.p5.8.4">G</span>eneration (named R<sup class="ltx_sup" id="S1.p5.8.5">2</sup>AG), enhancing LLMs’ perception of the key information among retrieved documents.
Specifically, R<sup class="ltx_sup" id="S1.p5.8.6">2</sup>AG adopts an input processing pipeline that transforms semantic representations from a retriever into unified retrieval features.
Then, a trainable R<sup class="ltx_sup" id="S1.p5.8.7">2</sup>-Former is employed to capture essential retrieval information. As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_tag">1</span></a>, R<sup class="ltx_sup" id="S1.p5.8.8">2</sup>-Former is a pluggable and lightweight model placed between the retriever and the LLM.
Finally, through a retrieval-aware prompting strategy, the LLM receives additional embeddings that contain retrieval information. This strategy aligns the knowledge from retrievers with LLMs without changing the content and order of retrieved documents, thereby relieving information loss.
R<sup class="ltx_sup" id="S1.p5.8.9">2</sup>AG offers the flexibility to fine-tune R<sup class="ltx_sup" id="S1.p5.8.10">2</sup>-Former alone or both with LLMs. Thus, in R<sup class="ltx_sup" id="S1.p5.8.11">2</sup>AG framework, both retrievers and LLMs can be frozen to save computational costs, making R<sup class="ltx_sup" id="S1.p5.8.12">2</sup>AG suitable for scenarios with limited resources.
Overall, our contributions are summarized as follows:</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.2">We propose R<sup class="ltx_sup" id="S1.I1.i1.p1.2.1">2</sup>AG, an enhanced RAG framework, to incorporate retrieval information into retrieval augmented generation. Notably, R<sup class="ltx_sup" id="S1.I1.i1.p1.2.2">2</sup>AG is compatible with low-source scenarios where retrievers and LLMs are frozen.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.2">We design a lightweight model, R<sup class="ltx_sup" id="S1.I1.i2.p1.2.1">2</sup>-Former, to bridge the semantic gap between retrievers and LLMs. R<sup class="ltx_sup" id="S1.I1.i2.p1.2.2">2</sup>-Former can be seamlessly integrated into existing RAG frameworks using open-source LLMs.
</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">We introduce a retrieval-aware prompting strategy to inject retrieval information into the input embeddings, enhancing LLMs’ ability to understand relationships among documents without much increase in complexity.</p>
</div>
</li>
</ul>
<p class="ltx_p" id="S1.p5.10">Experimental results demonstrate the superior performance and robustness of R<sup class="ltx_sup" id="S1.p5.10.1">2</sup>AG in various scenarios. Our analysis shows that R<sup class="ltx_sup" id="S1.p5.10.2">2</sup>AG increases latency by only 0.8% during inference. Furthermore, it demonstrates that retrieval information anchors LLMs to understand retrieved documents and enhances their generation capabilities.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Works</h2>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Retrieval Augmented Generation</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">Despite being trained on vast corpora, LLMs still struggle with hallucinations and updated knowledge in knowledge-sensitive tasks <cite class="ltx_cite ltx_citemacro_cite">Zhao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib51" title="">2023</a>)</cite>. RAG <cite class="ltx_cite ltx_citemacro_cite">Lewis et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib22" title="">2020</a>)</cite> is regarded as an efficient solution to these issues by combining a retrieval component with LLMs. In detail, documents gathered by retrievers are bound with the original query and placed into the inputs of LLMs to produce final responses. RAG allows LLMs to access vast, up-to-date data in a flexible way, leading to better performance. Benefiting from the progress of multi-modal alignment techniques <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib25" title="">2023b</a>); Zhu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib52" title="">2023a</a>)</cite>, the idea of RAG has been extended to various domains with modality-specific retrievers, including audios <cite class="ltx_cite ltx_citemacro_cite">Koizumi et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib20" title="">2020</a>)</cite>, images <cite class="ltx_cite ltx_citemacro_cite">Yasunaga et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib46" title="">2023</a>)</cite>, knowledge graphs <cite class="ltx_cite ltx_citemacro_cite">He et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib12" title="">2024</a>)</cite>, and so on. Despite its rapid growth, RAG suffers several limitations, such as sensitivity to retrieval results, increased complexity, and a semantic gap between retrievers and LLMs <cite class="ltx_cite ltx_citemacro_cite">Kandpal et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib17" title="">2022</a>); Zhao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib49" title="">2024</a>)</cite>.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Enhanced RAG</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">Recent works develop many enhanced approaches based on the standard RAG framework. To directly improve the effectiveness of RAG, REPLUG <cite class="ltx_cite ltx_citemacro_cite">Shi et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib34" title="">2023</a>)</cite> and Atlas <cite class="ltx_cite ltx_citemacro_cite">Izacard et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib15" title="">2022</a>)</cite> leverage the LLM to provide a supervisory signal for training a better retriever.
However, the noise will inevitably appear in retrieval results <cite class="ltx_cite ltx_citemacro_cite">Barnett et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib5" title="">2024</a>)</cite>.
Recent studies focus on pre-processing the retrieved documents before providing them to LLMs. Techniques such as truncation and selection are effective methods to enhance the quality of ranking lists without modifying the content of documents <cite class="ltx_cite ltx_citemacro_cite">Gao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib10" title="">2023</a>); Xu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib43" title="">2024</a>)</cite>. CRAG <cite class="ltx_cite ltx_citemacro_cite">Yan et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib44" title="">2024</a>)</cite> trains a lightweight retrieval evaluator to exclude irrelevant documents. BGM <cite class="ltx_cite ltx_citemacro_cite">Ke et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib18" title="">2024</a>)</cite> is proposed to meet the preference of LLMs by training a bridge model to re-rank and select the documents. Some studies aim to train small LMs to compress the retrieval documents, thus decreasing complexity or reducing noise. <cite class="ltx_cite ltx_citemacro_citet">Jiang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib16" title="">2023</a>)</cite> propose LongLLMLingua to detect and remove unimportant tokens. RECOMP <cite class="ltx_cite ltx_citemacro_cite">Xu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib42" title="">2023</a>)</cite> adopts two compressors to select and summarize the retrieved documents. However, the pre-processing methods introduce additional computational costs during inference and may lead to the loss of essential information.</p>
</div>
<div class="ltx_para" id="S2.SS2.p2">
<p class="ltx_p" id="S2.SS2.p2.1">Notably, the above methods target providing higher-quality retrieval results to LLMs and actually treat retrieval and generation as two distinct processes. This separation fails to bridge the semantic gap between retrievers and LLMs fully.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>R<sup class="ltx_sup" id="S3.2.1">2</sup>AG</h2>
<figure class="ltx_figure" id="S3.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="273" id="S3.F2.g1" src="x2.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>An illustration of R<sup class="ltx_sup" id="S3.F2.10.1">2</sup>AG. The R<sup class="ltx_sup" id="S3.F2.11.2">2</sup>-Former is designed to extract retrieval features, acting as an information bottleneck between retrievers and LLMs. Through the retrieval-aware prompting strategy, the retrieval information serves as an anchor to guide LLMs during generation. <span class="ltx_text ltx_font_typewriter" id="S3.F2.12.3">‘‘Emb’’</span> is short for embedding, <span class="ltx_text ltx_font_typewriter" id="S3.F2.13.4">‘‘PE’’</span> stands for positional embeddings, and <span class="ltx_text ltx_font_typewriter" id="S3.F2.14.5">‘‘&lt;R&gt;’’</span> denotes the placeholder for retrieval information.</figcaption>
</figure>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Problem Formulation and Overview</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.5">RAG involves the task that aims to prompt an LLM to generate answers based on a query and documents returned by a retriever. Formally, given a query <math alttext="q" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><mi id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">q</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">italic_q</annotation></semantics></math> and a list of documents <math alttext="\mathcal{D}{=}\{d_{1},d_{2},\cdots,d_{k}\}" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.4"><semantics id="S3.SS1.p1.2.m2.4a"><mrow id="S3.SS1.p1.2.m2.4.4" xref="S3.SS1.p1.2.m2.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.2.m2.4.4.5" xref="S3.SS1.p1.2.m2.4.4.5.cmml">𝒟</mi><mo id="S3.SS1.p1.2.m2.4.4.4" xref="S3.SS1.p1.2.m2.4.4.4.cmml">=</mo><mrow id="S3.SS1.p1.2.m2.4.4.3.3" xref="S3.SS1.p1.2.m2.4.4.3.4.cmml"><mo id="S3.SS1.p1.2.m2.4.4.3.3.4" stretchy="false" xref="S3.SS1.p1.2.m2.4.4.3.4.cmml">{</mo><msub id="S3.SS1.p1.2.m2.2.2.1.1.1" xref="S3.SS1.p1.2.m2.2.2.1.1.1.cmml"><mi id="S3.SS1.p1.2.m2.2.2.1.1.1.2" xref="S3.SS1.p1.2.m2.2.2.1.1.1.2.cmml">d</mi><mn id="S3.SS1.p1.2.m2.2.2.1.1.1.3" xref="S3.SS1.p1.2.m2.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.2.m2.4.4.3.3.5" xref="S3.SS1.p1.2.m2.4.4.3.4.cmml">,</mo><msub id="S3.SS1.p1.2.m2.3.3.2.2.2" xref="S3.SS1.p1.2.m2.3.3.2.2.2.cmml"><mi id="S3.SS1.p1.2.m2.3.3.2.2.2.2" xref="S3.SS1.p1.2.m2.3.3.2.2.2.2.cmml">d</mi><mn id="S3.SS1.p1.2.m2.3.3.2.2.2.3" xref="S3.SS1.p1.2.m2.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS1.p1.2.m2.4.4.3.3.6" xref="S3.SS1.p1.2.m2.4.4.3.4.cmml">,</mo><mi id="S3.SS1.p1.2.m2.1.1" mathvariant="normal" xref="S3.SS1.p1.2.m2.1.1.cmml">⋯</mi><mo id="S3.SS1.p1.2.m2.4.4.3.3.7" xref="S3.SS1.p1.2.m2.4.4.3.4.cmml">,</mo><msub id="S3.SS1.p1.2.m2.4.4.3.3.3" xref="S3.SS1.p1.2.m2.4.4.3.3.3.cmml"><mi id="S3.SS1.p1.2.m2.4.4.3.3.3.2" xref="S3.SS1.p1.2.m2.4.4.3.3.3.2.cmml">d</mi><mi id="S3.SS1.p1.2.m2.4.4.3.3.3.3" xref="S3.SS1.p1.2.m2.4.4.3.3.3.3.cmml">k</mi></msub><mo id="S3.SS1.p1.2.m2.4.4.3.3.8" stretchy="false" xref="S3.SS1.p1.2.m2.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.4b"><apply id="S3.SS1.p1.2.m2.4.4.cmml" xref="S3.SS1.p1.2.m2.4.4"><eq id="S3.SS1.p1.2.m2.4.4.4.cmml" xref="S3.SS1.p1.2.m2.4.4.4"></eq><ci id="S3.SS1.p1.2.m2.4.4.5.cmml" xref="S3.SS1.p1.2.m2.4.4.5">𝒟</ci><set id="S3.SS1.p1.2.m2.4.4.3.4.cmml" xref="S3.SS1.p1.2.m2.4.4.3.3"><apply id="S3.SS1.p1.2.m2.2.2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.m2.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1.2">𝑑</ci><cn id="S3.SS1.p1.2.m2.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS1.p1.2.m2.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS1.p1.2.m2.3.3.2.2.2.cmml" xref="S3.SS1.p1.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.3.3.2.2.2.1.cmml" xref="S3.SS1.p1.2.m2.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.2.m2.3.3.2.2.2.2.cmml" xref="S3.SS1.p1.2.m2.3.3.2.2.2.2">𝑑</ci><cn id="S3.SS1.p1.2.m2.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS1.p1.2.m2.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">⋯</ci><apply id="S3.SS1.p1.2.m2.4.4.3.3.3.cmml" xref="S3.SS1.p1.2.m2.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.4.4.3.3.3.1.cmml" xref="S3.SS1.p1.2.m2.4.4.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.2.m2.4.4.3.3.3.2.cmml" xref="S3.SS1.p1.2.m2.4.4.3.3.3.2">𝑑</ci><ci id="S3.SS1.p1.2.m2.4.4.3.3.3.3.cmml" xref="S3.SS1.p1.2.m2.4.4.3.3.3.3">𝑘</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.4c">\mathcal{D}{=}\{d_{1},d_{2},\cdots,d_{k}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.4d">caligraphic_D = { italic_d start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_d start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT }</annotation></semantics></math> in preference order ranked by the retriever <math alttext="f_{\mathbf{R}}" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.1"><semantics id="S3.SS1.p1.3.m3.1a"><msub id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml"><mi id="S3.SS1.p1.3.m3.1.1.2" xref="S3.SS1.p1.3.m3.1.1.2.cmml">f</mi><mi id="S3.SS1.p1.3.m3.1.1.3" xref="S3.SS1.p1.3.m3.1.1.3.cmml">𝐑</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><apply id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2">𝑓</ci><ci id="S3.SS1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3">𝐑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">f_{\mathbf{R}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.1d">italic_f start_POSTSUBSCRIPT bold_R end_POSTSUBSCRIPT</annotation></semantics></math>, the LLM, a generator <math alttext="f_{\mathbf{G}}" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m4.1"><semantics id="S3.SS1.p1.4.m4.1a"><msub id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml"><mi id="S3.SS1.p1.4.m4.1.1.2" xref="S3.SS1.p1.4.m4.1.1.2.cmml">f</mi><mi id="S3.SS1.p1.4.m4.1.1.3" xref="S3.SS1.p1.4.m4.1.1.3.cmml">𝐆</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><apply id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.p1.4.m4.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.2">𝑓</ci><ci id="S3.SS1.p1.4.m4.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.3">𝐆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">f_{\mathbf{G}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m4.1d">italic_f start_POSTSUBSCRIPT bold_G end_POSTSUBSCRIPT</annotation></semantics></math>, is expected to generate the output <math alttext="\hat{y}" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m5.1"><semantics id="S3.SS1.p1.5.m5.1a"><mover accent="true" id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml"><mi id="S3.SS1.p1.5.m5.1.1.2" xref="S3.SS1.p1.5.m5.1.1.2.cmml">y</mi><mo id="S3.SS1.p1.5.m5.1.1.1" xref="S3.SS1.p1.5.m5.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><apply id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1"><ci id="S3.SS1.p1.5.m5.1.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1.1">^</ci><ci id="S3.SS1.p1.5.m5.1.1.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">\hat{y}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m5.1d">over^ start_ARG italic_y end_ARG</annotation></semantics></math>. The pipeline can be expressed as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{y}=f_{\mathbf{G}}\left(\text{P}\left(q,\mathcal{D}\right)\right)\text{,}" class="ltx_Math" display="block" id="S3.E1.m1.3"><semantics id="S3.E1.m1.3a"><mrow id="S3.E1.m1.3.3" xref="S3.E1.m1.3.3.cmml"><mover accent="true" id="S3.E1.m1.3.3.3" xref="S3.E1.m1.3.3.3.cmml"><mi id="S3.E1.m1.3.3.3.2" xref="S3.E1.m1.3.3.3.2.cmml">y</mi><mo id="S3.E1.m1.3.3.3.1" xref="S3.E1.m1.3.3.3.1.cmml">^</mo></mover><mo id="S3.E1.m1.3.3.2" xref="S3.E1.m1.3.3.2.cmml">=</mo><mrow id="S3.E1.m1.3.3.1" xref="S3.E1.m1.3.3.1.cmml"><msub id="S3.E1.m1.3.3.1.3" xref="S3.E1.m1.3.3.1.3.cmml"><mi id="S3.E1.m1.3.3.1.3.2" xref="S3.E1.m1.3.3.1.3.2.cmml">f</mi><mi id="S3.E1.m1.3.3.1.3.3" xref="S3.E1.m1.3.3.1.3.3.cmml">𝐆</mi></msub><mo id="S3.E1.m1.3.3.1.2" xref="S3.E1.m1.3.3.1.2.cmml">⁢</mo><mrow id="S3.E1.m1.3.3.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.cmml"><mo id="S3.E1.m1.3.3.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.3.3.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.cmml"><mtext id="S3.E1.m1.3.3.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.2a.cmml">P</mtext><mo id="S3.E1.m1.3.3.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.3.2" xref="S3.E1.m1.3.3.1.1.1.1.3.1.cmml"><mo id="S3.E1.m1.3.3.1.1.1.1.3.2.1" xref="S3.E1.m1.3.3.1.1.1.1.3.1.cmml">(</mo><mi id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">q</mi><mo id="S3.E1.m1.3.3.1.1.1.1.3.2.2" xref="S3.E1.m1.3.3.1.1.1.1.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml">𝒟</mi><mo id="S3.E1.m1.3.3.1.1.1.1.3.2.3" xref="S3.E1.m1.3.3.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.3.3.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E1.m1.3.3.1.2a" xref="S3.E1.m1.3.3.1.2.cmml">⁢</mo><mtext id="S3.E1.m1.3.3.1.4" xref="S3.E1.m1.3.3.1.4a.cmml">,</mtext></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.3b"><apply id="S3.E1.m1.3.3.cmml" xref="S3.E1.m1.3.3"><eq id="S3.E1.m1.3.3.2.cmml" xref="S3.E1.m1.3.3.2"></eq><apply id="S3.E1.m1.3.3.3.cmml" xref="S3.E1.m1.3.3.3"><ci id="S3.E1.m1.3.3.3.1.cmml" xref="S3.E1.m1.3.3.3.1">^</ci><ci id="S3.E1.m1.3.3.3.2.cmml" xref="S3.E1.m1.3.3.3.2">𝑦</ci></apply><apply id="S3.E1.m1.3.3.1.cmml" xref="S3.E1.m1.3.3.1"><times id="S3.E1.m1.3.3.1.2.cmml" xref="S3.E1.m1.3.3.1.2"></times><apply id="S3.E1.m1.3.3.1.3.cmml" xref="S3.E1.m1.3.3.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.3.1.cmml" xref="S3.E1.m1.3.3.1.3">subscript</csymbol><ci id="S3.E1.m1.3.3.1.3.2.cmml" xref="S3.E1.m1.3.3.1.3.2">𝑓</ci><ci id="S3.E1.m1.3.3.1.3.3.cmml" xref="S3.E1.m1.3.3.1.3.3">𝐆</ci></apply><apply id="S3.E1.m1.3.3.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1"><times id="S3.E1.m1.3.3.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1"></times><ci id="S3.E1.m1.3.3.1.1.1.1.2a.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2"><mtext id="S3.E1.m1.3.3.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2">P</mtext></ci><interval closure="open" id="S3.E1.m1.3.3.1.1.1.1.3.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3.2"><ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">𝑞</ci><ci id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2">𝒟</ci></interval></apply><ci id="S3.E1.m1.3.3.1.4a.cmml" xref="S3.E1.m1.3.3.1.4"><mtext id="S3.E1.m1.3.3.1.4.cmml" xref="S3.E1.m1.3.3.1.4">,</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.3c">\hat{y}=f_{\mathbf{G}}\left(\text{P}\left(q,\mathcal{D}\right)\right)\text{,}</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.3d">over^ start_ARG italic_y end_ARG = italic_f start_POSTSUBSCRIPT bold_G end_POSTSUBSCRIPT ( P ( italic_q , caligraphic_D ) ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p1.6">where <span class="ltx_text ltx_markedasmath" id="S3.SS1.p1.6.1">P</span> is a predefined prompt template. It shows the retrievers and LLMs are couple in a simplistic prompt-based method, which will lead to miscommunication and the semantic gap.</p>
</div>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.5">Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#S3.F2" title="Figure 2 ‣ 3 R2AG ‣ R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_tag">2</span></a> illustrates the overall framework of R<sup class="ltx_sup" id="S3.SS1.p2.5.1">2</sup>AG. Initially, given a query and retrieved documents, R<sup class="ltx_sup" id="S3.SS1.p2.5.2">2</sup>AG processes representations modeled by a retriever into unified-format features. These list-wise features consider nuanced relationships both between the query and documents and among the documents themselves. Then, a R<sup class="ltx_sup" id="S3.SS1.p2.5.3">2</sup>-Former is designed to capture retrieval information for LLM usage. It allows unified features to interact with each other via self-attention mechanism, enabling it to understand complex dependencies. To integrate retrieval information into the LLM’s generation process, R<sup class="ltx_sup" id="S3.SS1.p2.5.4">2</sup>AG adopts a retrieval-aware prompting strategy to insert the retrieval information into the LLM’s input embedding space without causing information loss or increasing much complexity. Besides, R<sup class="ltx_sup" id="S3.SS1.p2.5.5">2</sup>AG is flexible to be applied in low-source scenarios where LLMs are frozen.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Retrieval Feature Extraction</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.6">Before generation, it is necessary to obtain high-quality retrieval features. In R<sup class="ltx_sup" id="S3.SS2.p1.6.1">2</sup>AG, we first get semantic representations from the retriever <math alttext="f_{R}" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.1"><semantics id="S3.SS2.p1.2.m2.1a"><msub id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><mi id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml">f</mi><mi id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml">R</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2">𝑓</ci><ci id="S3.SS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3">𝑅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">f_{R}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.1d">italic_f start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT</annotation></semantics></math>. Formally, a query <math alttext="q" class="ltx_Math" display="inline" id="S3.SS2.p1.3.m3.1"><semantics id="S3.SS2.p1.3.m3.1a"><mi id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><ci id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">q</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.3.m3.1d">italic_q</annotation></semantics></math> and document <math alttext="d" class="ltx_Math" display="inline" id="S3.SS2.p1.4.m4.1"><semantics id="S3.SS2.p1.4.m4.1a"><mi id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><ci id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">d</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.4.m4.1d">italic_d</annotation></semantics></math> are encoded into representations as <math alttext="\mathbf{x}^{q}{=}f_{\mathbf{R}}(q)" class="ltx_Math" display="inline" id="S3.SS2.p1.5.m5.1"><semantics id="S3.SS2.p1.5.m5.1a"><mrow id="S3.SS2.p1.5.m5.1.2" xref="S3.SS2.p1.5.m5.1.2.cmml"><msup id="S3.SS2.p1.5.m5.1.2.2" xref="S3.SS2.p1.5.m5.1.2.2.cmml"><mi id="S3.SS2.p1.5.m5.1.2.2.2" xref="S3.SS2.p1.5.m5.1.2.2.2.cmml">𝐱</mi><mi id="S3.SS2.p1.5.m5.1.2.2.3" xref="S3.SS2.p1.5.m5.1.2.2.3.cmml">q</mi></msup><mo id="S3.SS2.p1.5.m5.1.2.1" xref="S3.SS2.p1.5.m5.1.2.1.cmml">=</mo><mrow id="S3.SS2.p1.5.m5.1.2.3" xref="S3.SS2.p1.5.m5.1.2.3.cmml"><msub id="S3.SS2.p1.5.m5.1.2.3.2" xref="S3.SS2.p1.5.m5.1.2.3.2.cmml"><mi id="S3.SS2.p1.5.m5.1.2.3.2.2" xref="S3.SS2.p1.5.m5.1.2.3.2.2.cmml">f</mi><mi id="S3.SS2.p1.5.m5.1.2.3.2.3" xref="S3.SS2.p1.5.m5.1.2.3.2.3.cmml">𝐑</mi></msub><mo id="S3.SS2.p1.5.m5.1.2.3.1" xref="S3.SS2.p1.5.m5.1.2.3.1.cmml">⁢</mo><mrow id="S3.SS2.p1.5.m5.1.2.3.3.2" xref="S3.SS2.p1.5.m5.1.2.3.cmml"><mo id="S3.SS2.p1.5.m5.1.2.3.3.2.1" stretchy="false" xref="S3.SS2.p1.5.m5.1.2.3.cmml">(</mo><mi id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml">q</mi><mo id="S3.SS2.p1.5.m5.1.2.3.3.2.2" stretchy="false" xref="S3.SS2.p1.5.m5.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><apply id="S3.SS2.p1.5.m5.1.2.cmml" xref="S3.SS2.p1.5.m5.1.2"><eq id="S3.SS2.p1.5.m5.1.2.1.cmml" xref="S3.SS2.p1.5.m5.1.2.1"></eq><apply id="S3.SS2.p1.5.m5.1.2.2.cmml" xref="S3.SS2.p1.5.m5.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.1.2.2.1.cmml" xref="S3.SS2.p1.5.m5.1.2.2">superscript</csymbol><ci id="S3.SS2.p1.5.m5.1.2.2.2.cmml" xref="S3.SS2.p1.5.m5.1.2.2.2">𝐱</ci><ci id="S3.SS2.p1.5.m5.1.2.2.3.cmml" xref="S3.SS2.p1.5.m5.1.2.2.3">𝑞</ci></apply><apply id="S3.SS2.p1.5.m5.1.2.3.cmml" xref="S3.SS2.p1.5.m5.1.2.3"><times id="S3.SS2.p1.5.m5.1.2.3.1.cmml" xref="S3.SS2.p1.5.m5.1.2.3.1"></times><apply id="S3.SS2.p1.5.m5.1.2.3.2.cmml" xref="S3.SS2.p1.5.m5.1.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.1.2.3.2.1.cmml" xref="S3.SS2.p1.5.m5.1.2.3.2">subscript</csymbol><ci id="S3.SS2.p1.5.m5.1.2.3.2.2.cmml" xref="S3.SS2.p1.5.m5.1.2.3.2.2">𝑓</ci><ci id="S3.SS2.p1.5.m5.1.2.3.2.3.cmml" xref="S3.SS2.p1.5.m5.1.2.3.2.3">𝐑</ci></apply><ci id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">\mathbf{x}^{q}{=}f_{\mathbf{R}}(q)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.5.m5.1d">bold_x start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT = italic_f start_POSTSUBSCRIPT bold_R end_POSTSUBSCRIPT ( italic_q )</annotation></semantics></math> and <math alttext="\mathbf{x}^{d}{=}f_{\mathbf{R}}(d)" class="ltx_Math" display="inline" id="S3.SS2.p1.6.m6.1"><semantics id="S3.SS2.p1.6.m6.1a"><mrow id="S3.SS2.p1.6.m6.1.2" xref="S3.SS2.p1.6.m6.1.2.cmml"><msup id="S3.SS2.p1.6.m6.1.2.2" xref="S3.SS2.p1.6.m6.1.2.2.cmml"><mi id="S3.SS2.p1.6.m6.1.2.2.2" xref="S3.SS2.p1.6.m6.1.2.2.2.cmml">𝐱</mi><mi id="S3.SS2.p1.6.m6.1.2.2.3" xref="S3.SS2.p1.6.m6.1.2.2.3.cmml">d</mi></msup><mo id="S3.SS2.p1.6.m6.1.2.1" xref="S3.SS2.p1.6.m6.1.2.1.cmml">=</mo><mrow id="S3.SS2.p1.6.m6.1.2.3" xref="S3.SS2.p1.6.m6.1.2.3.cmml"><msub id="S3.SS2.p1.6.m6.1.2.3.2" xref="S3.SS2.p1.6.m6.1.2.3.2.cmml"><mi id="S3.SS2.p1.6.m6.1.2.3.2.2" xref="S3.SS2.p1.6.m6.1.2.3.2.2.cmml">f</mi><mi id="S3.SS2.p1.6.m6.1.2.3.2.3" xref="S3.SS2.p1.6.m6.1.2.3.2.3.cmml">𝐑</mi></msub><mo id="S3.SS2.p1.6.m6.1.2.3.1" xref="S3.SS2.p1.6.m6.1.2.3.1.cmml">⁢</mo><mrow id="S3.SS2.p1.6.m6.1.2.3.3.2" xref="S3.SS2.p1.6.m6.1.2.3.cmml"><mo id="S3.SS2.p1.6.m6.1.2.3.3.2.1" stretchy="false" xref="S3.SS2.p1.6.m6.1.2.3.cmml">(</mo><mi id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml">d</mi><mo id="S3.SS2.p1.6.m6.1.2.3.3.2.2" stretchy="false" xref="S3.SS2.p1.6.m6.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.1b"><apply id="S3.SS2.p1.6.m6.1.2.cmml" xref="S3.SS2.p1.6.m6.1.2"><eq id="S3.SS2.p1.6.m6.1.2.1.cmml" xref="S3.SS2.p1.6.m6.1.2.1"></eq><apply id="S3.SS2.p1.6.m6.1.2.2.cmml" xref="S3.SS2.p1.6.m6.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.1.2.2.1.cmml" xref="S3.SS2.p1.6.m6.1.2.2">superscript</csymbol><ci id="S3.SS2.p1.6.m6.1.2.2.2.cmml" xref="S3.SS2.p1.6.m6.1.2.2.2">𝐱</ci><ci id="S3.SS2.p1.6.m6.1.2.2.3.cmml" xref="S3.SS2.p1.6.m6.1.2.2.3">𝑑</ci></apply><apply id="S3.SS2.p1.6.m6.1.2.3.cmml" xref="S3.SS2.p1.6.m6.1.2.3"><times id="S3.SS2.p1.6.m6.1.2.3.1.cmml" xref="S3.SS2.p1.6.m6.1.2.3.1"></times><apply id="S3.SS2.p1.6.m6.1.2.3.2.cmml" xref="S3.SS2.p1.6.m6.1.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.1.2.3.2.1.cmml" xref="S3.SS2.p1.6.m6.1.2.3.2">subscript</csymbol><ci id="S3.SS2.p1.6.m6.1.2.3.2.2.cmml" xref="S3.SS2.p1.6.m6.1.2.3.2.2">𝑓</ci><ci id="S3.SS2.p1.6.m6.1.2.3.2.3.cmml" xref="S3.SS2.p1.6.m6.1.2.3.2.3">𝐑</ci></apply><ci id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.1c">\mathbf{x}^{d}{=}f_{\mathbf{R}}(d)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.6.m6.1d">bold_x start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT = italic_f start_POSTSUBSCRIPT bold_R end_POSTSUBSCRIPT ( italic_d )</annotation></semantics></math>, respectively. However, these representations can not be directly used because a single representation can not capture interactive features for LLM’s generation. Moreover, to suit various retrievers, it is intuitive to transform representations in different spaces into unified format features.</p>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.3">Inspired by works in retrieval downstream tasks <cite class="ltx_cite ltx_citemacro_cite">Ma et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib28" title="">2022</a>); Ye and Li (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib47" title="">2024</a>)</cite>, we align these representations into retrieval features by computing relevance, precedent similarity, and neighbor similarity scores. Specifically, these scores are calculated by a similarity function such as dot product or cosine similarity. The relevance score <math alttext="r_{i}" class="ltx_Math" display="inline" id="S3.SS2.p2.1.m1.1"><semantics id="S3.SS2.p2.1.m1.1a"><msub id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><mi id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2.cmml">r</mi><mi id="S3.SS2.p2.1.m1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2">𝑟</ci><ci id="S3.SS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">r_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.1.m1.1d">italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is between the query and the <math alttext="i" class="ltx_Math" display="inline" id="S3.SS2.p2.2.m2.1"><semantics id="S3.SS2.p2.2.m2.1a"><mi id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><ci id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.2.m2.1d">italic_i</annotation></semantics></math>-th document and is also used to sort the documents. The precedent and neighbor similarity scores are computed between the <math alttext="i" class="ltx_Math" display="inline" id="S3.SS2.p2.3.m3.1"><semantics id="S3.SS2.p2.3.m3.1a"><mi id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><ci id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.3.m3.1d">italic_i</annotation></semantics></math>-th document representation and its precedent-weighted and adjacent representations, respectively. Detailed formulations are provided in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#A1" title="Appendix A Retrieval Feature Extraction Details ‣ R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_tag">A</span></a>.</p>
</div>
<div class="ltx_para" id="S3.SS2.p3">
<p class="ltx_p" id="S3.SS2.p3.3">Finally, three features are concatenated as input: <math alttext="\text{input}_{i}{=}\{r_{i},\gamma_{i},\zeta_{i}\}" class="ltx_Math" display="inline" id="S3.SS2.p3.1.m1.3"><semantics id="S3.SS2.p3.1.m1.3a"><mrow id="S3.SS2.p3.1.m1.3.3" xref="S3.SS2.p3.1.m1.3.3.cmml"><msub id="S3.SS2.p3.1.m1.3.3.5" xref="S3.SS2.p3.1.m1.3.3.5.cmml"><mtext id="S3.SS2.p3.1.m1.3.3.5.2" xref="S3.SS2.p3.1.m1.3.3.5.2a.cmml">input</mtext><mi id="S3.SS2.p3.1.m1.3.3.5.3" xref="S3.SS2.p3.1.m1.3.3.5.3.cmml">i</mi></msub><mo id="S3.SS2.p3.1.m1.3.3.4" xref="S3.SS2.p3.1.m1.3.3.4.cmml">=</mo><mrow id="S3.SS2.p3.1.m1.3.3.3.3" xref="S3.SS2.p3.1.m1.3.3.3.4.cmml"><mo id="S3.SS2.p3.1.m1.3.3.3.3.4" stretchy="false" xref="S3.SS2.p3.1.m1.3.3.3.4.cmml">{</mo><msub id="S3.SS2.p3.1.m1.1.1.1.1.1" xref="S3.SS2.p3.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS2.p3.1.m1.1.1.1.1.1.2" xref="S3.SS2.p3.1.m1.1.1.1.1.1.2.cmml">r</mi><mi id="S3.SS2.p3.1.m1.1.1.1.1.1.3" xref="S3.SS2.p3.1.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS2.p3.1.m1.3.3.3.3.5" xref="S3.SS2.p3.1.m1.3.3.3.4.cmml">,</mo><msub id="S3.SS2.p3.1.m1.2.2.2.2.2" xref="S3.SS2.p3.1.m1.2.2.2.2.2.cmml"><mi id="S3.SS2.p3.1.m1.2.2.2.2.2.2" xref="S3.SS2.p3.1.m1.2.2.2.2.2.2.cmml">γ</mi><mi id="S3.SS2.p3.1.m1.2.2.2.2.2.3" xref="S3.SS2.p3.1.m1.2.2.2.2.2.3.cmml">i</mi></msub><mo id="S3.SS2.p3.1.m1.3.3.3.3.6" xref="S3.SS2.p3.1.m1.3.3.3.4.cmml">,</mo><msub id="S3.SS2.p3.1.m1.3.3.3.3.3" xref="S3.SS2.p3.1.m1.3.3.3.3.3.cmml"><mi id="S3.SS2.p3.1.m1.3.3.3.3.3.2" xref="S3.SS2.p3.1.m1.3.3.3.3.3.2.cmml">ζ</mi><mi id="S3.SS2.p3.1.m1.3.3.3.3.3.3" xref="S3.SS2.p3.1.m1.3.3.3.3.3.3.cmml">i</mi></msub><mo id="S3.SS2.p3.1.m1.3.3.3.3.7" stretchy="false" xref="S3.SS2.p3.1.m1.3.3.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.3b"><apply id="S3.SS2.p3.1.m1.3.3.cmml" xref="S3.SS2.p3.1.m1.3.3"><eq id="S3.SS2.p3.1.m1.3.3.4.cmml" xref="S3.SS2.p3.1.m1.3.3.4"></eq><apply id="S3.SS2.p3.1.m1.3.3.5.cmml" xref="S3.SS2.p3.1.m1.3.3.5"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.3.3.5.1.cmml" xref="S3.SS2.p3.1.m1.3.3.5">subscript</csymbol><ci id="S3.SS2.p3.1.m1.3.3.5.2a.cmml" xref="S3.SS2.p3.1.m1.3.3.5.2"><mtext id="S3.SS2.p3.1.m1.3.3.5.2.cmml" xref="S3.SS2.p3.1.m1.3.3.5.2">input</mtext></ci><ci id="S3.SS2.p3.1.m1.3.3.5.3.cmml" xref="S3.SS2.p3.1.m1.3.3.5.3">𝑖</ci></apply><set id="S3.SS2.p3.1.m1.3.3.3.4.cmml" xref="S3.SS2.p3.1.m1.3.3.3.3"><apply id="S3.SS2.p3.1.m1.1.1.1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p3.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS2.p3.1.m1.1.1.1.1.1.2">𝑟</ci><ci id="S3.SS2.p3.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS2.p3.1.m1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS2.p3.1.m1.2.2.2.2.2.cmml" xref="S3.SS2.p3.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.2.2.2.2.2.1.cmml" xref="S3.SS2.p3.1.m1.2.2.2.2.2">subscript</csymbol><ci id="S3.SS2.p3.1.m1.2.2.2.2.2.2.cmml" xref="S3.SS2.p3.1.m1.2.2.2.2.2.2">𝛾</ci><ci id="S3.SS2.p3.1.m1.2.2.2.2.2.3.cmml" xref="S3.SS2.p3.1.m1.2.2.2.2.2.3">𝑖</ci></apply><apply id="S3.SS2.p3.1.m1.3.3.3.3.3.cmml" xref="S3.SS2.p3.1.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.3.3.3.3.3.1.cmml" xref="S3.SS2.p3.1.m1.3.3.3.3.3">subscript</csymbol><ci id="S3.SS2.p3.1.m1.3.3.3.3.3.2.cmml" xref="S3.SS2.p3.1.m1.3.3.3.3.3.2">𝜁</ci><ci id="S3.SS2.p3.1.m1.3.3.3.3.3.3.cmml" xref="S3.SS2.p3.1.m1.3.3.3.3.3.3">𝑖</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.3c">\text{input}_{i}{=}\{r_{i},\gamma_{i},\zeta_{i}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.1.m1.3d">input start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = { italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_γ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_ζ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT }</annotation></semantics></math>, representing relevance, precedent similarity, and neighbor similarity. Then, the feature list <math alttext="\{\text{input}_{i}\}_{i=1}^{k}" class="ltx_Math" display="inline" id="S3.SS2.p3.2.m2.1"><semantics id="S3.SS2.p3.2.m2.1a"><msubsup id="S3.SS2.p3.2.m2.1.1" xref="S3.SS2.p3.2.m2.1.1.cmml"><mrow id="S3.SS2.p3.2.m2.1.1.1.1.1" xref="S3.SS2.p3.2.m2.1.1.1.1.2.cmml"><mo id="S3.SS2.p3.2.m2.1.1.1.1.1.2" stretchy="false" xref="S3.SS2.p3.2.m2.1.1.1.1.2.cmml">{</mo><msub id="S3.SS2.p3.2.m2.1.1.1.1.1.1" xref="S3.SS2.p3.2.m2.1.1.1.1.1.1.cmml"><mtext id="S3.SS2.p3.2.m2.1.1.1.1.1.1.2" xref="S3.SS2.p3.2.m2.1.1.1.1.1.1.2a.cmml">input</mtext><mi id="S3.SS2.p3.2.m2.1.1.1.1.1.1.3" xref="S3.SS2.p3.2.m2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS2.p3.2.m2.1.1.1.1.1.3" stretchy="false" xref="S3.SS2.p3.2.m2.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS2.p3.2.m2.1.1.1.3" xref="S3.SS2.p3.2.m2.1.1.1.3.cmml"><mi id="S3.SS2.p3.2.m2.1.1.1.3.2" xref="S3.SS2.p3.2.m2.1.1.1.3.2.cmml">i</mi><mo id="S3.SS2.p3.2.m2.1.1.1.3.1" xref="S3.SS2.p3.2.m2.1.1.1.3.1.cmml">=</mo><mn id="S3.SS2.p3.2.m2.1.1.1.3.3" xref="S3.SS2.p3.2.m2.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.SS2.p3.2.m2.1.1.3" xref="S3.SS2.p3.2.m2.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.1b"><apply id="S3.SS2.p3.2.m2.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.2.m2.1.1.2.cmml" xref="S3.SS2.p3.2.m2.1.1">superscript</csymbol><apply id="S3.SS2.p3.2.m2.1.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.2.m2.1.1.1.2.cmml" xref="S3.SS2.p3.2.m2.1.1">subscript</csymbol><set id="S3.SS2.p3.2.m2.1.1.1.1.2.cmml" xref="S3.SS2.p3.2.m2.1.1.1.1.1"><apply id="S3.SS2.p3.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.2.m2.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p3.2.m2.1.1.1.1.1.1.2a.cmml" xref="S3.SS2.p3.2.m2.1.1.1.1.1.1.2"><mtext id="S3.SS2.p3.2.m2.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p3.2.m2.1.1.1.1.1.1.2">input</mtext></ci><ci id="S3.SS2.p3.2.m2.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p3.2.m2.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S3.SS2.p3.2.m2.1.1.1.3.cmml" xref="S3.SS2.p3.2.m2.1.1.1.3"><eq id="S3.SS2.p3.2.m2.1.1.1.3.1.cmml" xref="S3.SS2.p3.2.m2.1.1.1.3.1"></eq><ci id="S3.SS2.p3.2.m2.1.1.1.3.2.cmml" xref="S3.SS2.p3.2.m2.1.1.1.3.2">𝑖</ci><cn id="S3.SS2.p3.2.m2.1.1.1.3.3.cmml" type="integer" xref="S3.SS2.p3.2.m2.1.1.1.3.3">1</cn></apply></apply><ci id="S3.SS2.p3.2.m2.1.1.3.cmml" xref="S3.SS2.p3.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.1c">\{\text{input}_{i}\}_{i=1}^{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.2.m2.1d">{ input start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT</annotation></semantics></math> is then fed into R<sup class="ltx_sup" id="S3.SS2.p3.3.1">2</sup>-Former to further exploit retrieval information.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>R<sup class="ltx_sup" id="S3.SS3.2.1">2</sup>-Former</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.2">Inspired by <cite class="ltx_cite ltx_citemacro_citet">Li et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib25" title="">2023b</a>)</cite>, we propose the R<sup class="ltx_sup" id="S3.SS3.p1.2.1">2</sup>-Former as the trainable module that bridges between retrievers and LLMs. As shown in the right side of Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#S3.F2" title="Figure 2 ‣ 3 R2AG ‣ R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_tag">2</span></a>, R<sup class="ltx_sup" id="S3.SS3.p1.2.2">2</sup>-Former is a pluggable Transformer-based model that accepts list-wise features as inputs and outputs retrieval information.</p>
</div>
<div class="ltx_para" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.1">To better comprehend list-wise features from retrievers, we employ an input embedding layer to linearly transform input features into a higher dimension space. Positional embeddings are then added before attention encoding to maintain sequence awareness. Then, a Transformer <cite class="ltx_cite ltx_citemacro_cite">Vaswani et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib37" title="">2017</a>)</cite> encoder is utilized to exploit the input sequences, which uses a self-attention mask where each position’s feature can attend to other positions. Formally, for an input list <math alttext="\{\text{input}_{i}\}_{i=1}^{k}" class="ltx_Math" display="inline" id="S3.SS3.p2.1.m1.1"><semantics id="S3.SS3.p2.1.m1.1a"><msubsup id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml"><mrow id="S3.SS3.p2.1.m1.1.1.1.1.1" xref="S3.SS3.p2.1.m1.1.1.1.1.2.cmml"><mo id="S3.SS3.p2.1.m1.1.1.1.1.1.2" stretchy="false" xref="S3.SS3.p2.1.m1.1.1.1.1.2.cmml">{</mo><msub id="S3.SS3.p2.1.m1.1.1.1.1.1.1" xref="S3.SS3.p2.1.m1.1.1.1.1.1.1.cmml"><mtext id="S3.SS3.p2.1.m1.1.1.1.1.1.1.2" xref="S3.SS3.p2.1.m1.1.1.1.1.1.1.2a.cmml">input</mtext><mi id="S3.SS3.p2.1.m1.1.1.1.1.1.1.3" xref="S3.SS3.p2.1.m1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS3.p2.1.m1.1.1.1.1.1.3" stretchy="false" xref="S3.SS3.p2.1.m1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS3.p2.1.m1.1.1.1.3" xref="S3.SS3.p2.1.m1.1.1.1.3.cmml"><mi id="S3.SS3.p2.1.m1.1.1.1.3.2" xref="S3.SS3.p2.1.m1.1.1.1.3.2.cmml">i</mi><mo id="S3.SS3.p2.1.m1.1.1.1.3.1" xref="S3.SS3.p2.1.m1.1.1.1.3.1.cmml">=</mo><mn id="S3.SS3.p2.1.m1.1.1.1.3.3" xref="S3.SS3.p2.1.m1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.SS3.p2.1.m1.1.1.3" xref="S3.SS3.p2.1.m1.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><apply id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.1.1.2.cmml" xref="S3.SS3.p2.1.m1.1.1">superscript</csymbol><apply id="S3.SS3.p2.1.m1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.1.1.1.2.cmml" xref="S3.SS3.p2.1.m1.1.1">subscript</csymbol><set id="S3.SS3.p2.1.m1.1.1.1.1.2.cmml" xref="S3.SS3.p2.1.m1.1.1.1.1.1"><apply id="S3.SS3.p2.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p2.1.m1.1.1.1.1.1.1.2a.cmml" xref="S3.SS3.p2.1.m1.1.1.1.1.1.1.2"><mtext id="S3.SS3.p2.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p2.1.m1.1.1.1.1.1.1.2">input</mtext></ci><ci id="S3.SS3.p2.1.m1.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p2.1.m1.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S3.SS3.p2.1.m1.1.1.1.3.cmml" xref="S3.SS3.p2.1.m1.1.1.1.3"><eq id="S3.SS3.p2.1.m1.1.1.1.3.1.cmml" xref="S3.SS3.p2.1.m1.1.1.1.3.1"></eq><ci id="S3.SS3.p2.1.m1.1.1.1.3.2.cmml" xref="S3.SS3.p2.1.m1.1.1.1.3.2">𝑖</ci><cn id="S3.SS3.p2.1.m1.1.1.1.3.3.cmml" type="integer" xref="S3.SS3.p2.1.m1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.SS3.p2.1.m1.1.1.3.cmml" xref="S3.SS3.p2.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">\{\text{input}_{i}\}_{i=1}^{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.1.m1.1d">{ input start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT</annotation></semantics></math>, the process is formulated by:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{H}=f_{att}\left[f_{\rightarrow h_{1}}\left({\left\{\text{input}_{i}%
\right\}_{i=1}^{k}}\right)\text{+}\mathbf{p}\right]," class="ltx_Math" display="block" id="S3.E2.m1.1"><semantics id="S3.E2.m1.1a"><mrow id="S3.E2.m1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml"><mrow id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml"><mi id="S3.E2.m1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.3.cmml">𝐇</mi><mo id="S3.E2.m1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E2.m1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.cmml"><msub id="S3.E2.m1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.1.1.1.1.1.3.2" xref="S3.E2.m1.1.1.1.1.1.3.2.cmml">f</mi><mrow id="S3.E2.m1.1.1.1.1.1.3.3" xref="S3.E2.m1.1.1.1.1.1.3.3.cmml"><mi id="S3.E2.m1.1.1.1.1.1.3.3.2" xref="S3.E2.m1.1.1.1.1.1.3.3.2.cmml">a</mi><mo id="S3.E2.m1.1.1.1.1.1.3.3.1" xref="S3.E2.m1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.E2.m1.1.1.1.1.1.3.3.3" xref="S3.E2.m1.1.1.1.1.1.3.3.3.cmml">t</mi><mo id="S3.E2.m1.1.1.1.1.1.3.3.1a" xref="S3.E2.m1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.E2.m1.1.1.1.1.1.3.3.4" xref="S3.E2.m1.1.1.1.1.1.3.3.4.cmml">t</mi></mrow></msub><mo id="S3.E2.m1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E2.m1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.2.cmml"><mo id="S3.E2.m1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.E2.m1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E2.m1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.3.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.3.2.cmml">f</mi><mrow id="S3.E2.m1.1.1.1.1.1.1.1.1.3.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.3.3.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.3.3.2.cmml"></mi><mo id="S3.E2.m1.1.1.1.1.1.1.1.1.3.3.1" stretchy="false" xref="S3.E2.m1.1.1.1.1.1.1.1.1.3.3.1.cmml">→</mo><msub id="S3.E2.m1.1.1.1.1.1.1.1.1.3.3.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.3.3.3.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.3.3.3.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.3.3.3.2.cmml">h</mi><mn id="S3.E2.m1.1.1.1.1.1.1.1.1.3.3.3.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.3.3.3.3.cmml">1</mn></msub></mrow></msub><mo id="S3.E2.m1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">{</mo><msub id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mtext id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2a.cmml">input</mtext><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">=</mo><mn id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">k</mi></msubsup><mo id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E2.m1.1.1.1.1.1.1.1.1.2a" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mtext id="S3.E2.m1.1.1.1.1.1.1.1.1.4" xref="S3.E2.m1.1.1.1.1.1.1.1.1.4a.cmml">+</mtext><mo id="S3.E2.m1.1.1.1.1.1.1.1.1.2b" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.5" xref="S3.E2.m1.1.1.1.1.1.1.1.1.5.cmml">𝐩</mi></mrow><mo id="S3.E2.m1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S3.E2.m1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.1b"><apply id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1"><eq id="S3.E2.m1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.2"></eq><ci id="S3.E2.m1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.3">𝐇</ci><apply id="S3.E2.m1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1"><times id="S3.E2.m1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.2"></times><apply id="S3.E2.m1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.1.1.1.1.1.3.2">𝑓</ci><apply id="S3.E2.m1.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.1.1.1.1.1.3.3"><times id="S3.E2.m1.1.1.1.1.1.3.3.1.cmml" xref="S3.E2.m1.1.1.1.1.1.3.3.1"></times><ci id="S3.E2.m1.1.1.1.1.1.3.3.2.cmml" xref="S3.E2.m1.1.1.1.1.1.3.3.2">𝑎</ci><ci id="S3.E2.m1.1.1.1.1.1.3.3.3.cmml" xref="S3.E2.m1.1.1.1.1.1.3.3.3">𝑡</ci><ci id="S3.E2.m1.1.1.1.1.1.3.3.4.cmml" xref="S3.E2.m1.1.1.1.1.1.3.3.4">𝑡</ci></apply></apply><apply id="S3.E2.m1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E2.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1"><times id="S3.E2.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.3.2">𝑓</ci><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.3.3"><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.3.3.1">→</ci><csymbol cd="latexml" id="S3.E2.m1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.3.3.2">absent</csymbol><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.1.3.3.3.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.3.3.3.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.3.3.3.2">ℎ</ci><cn id="S3.E2.m1.1.1.1.1.1.1.1.1.3.3.3.3.cmml" type="integer" xref="S3.E2.m1.1.1.1.1.1.1.1.1.3.3.3.3">1</cn></apply></apply></apply><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><set id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2a.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2"><mtext id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">input</mtext></ci><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3"><eq id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1"></eq><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑖</ci><cn id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.4a.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.4"><mtext id="S3.E2.m1.1.1.1.1.1.1.1.1.4.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.4">+</mtext></ci><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.5.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.5">𝐩</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.1c">\mathbf{H}=f_{att}\left[f_{\rightarrow h_{1}}\left({\left\{\text{input}_{i}%
\right\}_{i=1}^{k}}\right)\text{+}\mathbf{p}\right],</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.1d">bold_H = italic_f start_POSTSUBSCRIPT italic_a italic_t italic_t end_POSTSUBSCRIPT [ italic_f start_POSTSUBSCRIPT → italic_h start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( { input start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT ) + bold_p ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p2.6">where <math alttext="f_{att}" class="ltx_Math" display="inline" id="S3.SS3.p2.2.m1.1"><semantics id="S3.SS3.p2.2.m1.1a"><msub id="S3.SS3.p2.2.m1.1.1" xref="S3.SS3.p2.2.m1.1.1.cmml"><mi id="S3.SS3.p2.2.m1.1.1.2" xref="S3.SS3.p2.2.m1.1.1.2.cmml">f</mi><mrow id="S3.SS3.p2.2.m1.1.1.3" xref="S3.SS3.p2.2.m1.1.1.3.cmml"><mi id="S3.SS3.p2.2.m1.1.1.3.2" xref="S3.SS3.p2.2.m1.1.1.3.2.cmml">a</mi><mo id="S3.SS3.p2.2.m1.1.1.3.1" xref="S3.SS3.p2.2.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p2.2.m1.1.1.3.3" xref="S3.SS3.p2.2.m1.1.1.3.3.cmml">t</mi><mo id="S3.SS3.p2.2.m1.1.1.3.1a" xref="S3.SS3.p2.2.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p2.2.m1.1.1.3.4" xref="S3.SS3.p2.2.m1.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m1.1b"><apply id="S3.SS3.p2.2.m1.1.1.cmml" xref="S3.SS3.p2.2.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m1.1.1.1.cmml" xref="S3.SS3.p2.2.m1.1.1">subscript</csymbol><ci id="S3.SS3.p2.2.m1.1.1.2.cmml" xref="S3.SS3.p2.2.m1.1.1.2">𝑓</ci><apply id="S3.SS3.p2.2.m1.1.1.3.cmml" xref="S3.SS3.p2.2.m1.1.1.3"><times id="S3.SS3.p2.2.m1.1.1.3.1.cmml" xref="S3.SS3.p2.2.m1.1.1.3.1"></times><ci id="S3.SS3.p2.2.m1.1.1.3.2.cmml" xref="S3.SS3.p2.2.m1.1.1.3.2">𝑎</ci><ci id="S3.SS3.p2.2.m1.1.1.3.3.cmml" xref="S3.SS3.p2.2.m1.1.1.3.3">𝑡</ci><ci id="S3.SS3.p2.2.m1.1.1.3.4.cmml" xref="S3.SS3.p2.2.m1.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m1.1c">f_{att}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.2.m1.1d">italic_f start_POSTSUBSCRIPT italic_a italic_t italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is the Transformer encoder with <math alttext="h_{1}" class="ltx_Math" display="inline" id="S3.SS3.p2.3.m2.1"><semantics id="S3.SS3.p2.3.m2.1a"><msub id="S3.SS3.p2.3.m2.1.1" xref="S3.SS3.p2.3.m2.1.1.cmml"><mi id="S3.SS3.p2.3.m2.1.1.2" xref="S3.SS3.p2.3.m2.1.1.2.cmml">h</mi><mn id="S3.SS3.p2.3.m2.1.1.3" xref="S3.SS3.p2.3.m2.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m2.1b"><apply id="S3.SS3.p2.3.m2.1.1.cmml" xref="S3.SS3.p2.3.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m2.1.1.1.cmml" xref="S3.SS3.p2.3.m2.1.1">subscript</csymbol><ci id="S3.SS3.p2.3.m2.1.1.2.cmml" xref="S3.SS3.p2.3.m2.1.1.2">ℎ</ci><cn id="S3.SS3.p2.3.m2.1.1.3.cmml" type="integer" xref="S3.SS3.p2.3.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m2.1c">h_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.3.m2.1d">italic_h start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> hidden dimension, <math alttext="f_{\rightarrow h_{1}}" class="ltx_Math" display="inline" id="S3.SS3.p2.4.m3.1"><semantics id="S3.SS3.p2.4.m3.1a"><msub id="S3.SS3.p2.4.m3.1.1" xref="S3.SS3.p2.4.m3.1.1.cmml"><mi id="S3.SS3.p2.4.m3.1.1.2" xref="S3.SS3.p2.4.m3.1.1.2.cmml">f</mi><mrow id="S3.SS3.p2.4.m3.1.1.3" xref="S3.SS3.p2.4.m3.1.1.3.cmml"><mi id="S3.SS3.p2.4.m3.1.1.3.2" xref="S3.SS3.p2.4.m3.1.1.3.2.cmml"></mi><mo id="S3.SS3.p2.4.m3.1.1.3.1" stretchy="false" xref="S3.SS3.p2.4.m3.1.1.3.1.cmml">→</mo><msub id="S3.SS3.p2.4.m3.1.1.3.3" xref="S3.SS3.p2.4.m3.1.1.3.3.cmml"><mi id="S3.SS3.p2.4.m3.1.1.3.3.2" xref="S3.SS3.p2.4.m3.1.1.3.3.2.cmml">h</mi><mn id="S3.SS3.p2.4.m3.1.1.3.3.3" xref="S3.SS3.p2.4.m3.1.1.3.3.3.cmml">1</mn></msub></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m3.1b"><apply id="S3.SS3.p2.4.m3.1.1.cmml" xref="S3.SS3.p2.4.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m3.1.1.1.cmml" xref="S3.SS3.p2.4.m3.1.1">subscript</csymbol><ci id="S3.SS3.p2.4.m3.1.1.2.cmml" xref="S3.SS3.p2.4.m3.1.1.2">𝑓</ci><apply id="S3.SS3.p2.4.m3.1.1.3.cmml" xref="S3.SS3.p2.4.m3.1.1.3"><ci id="S3.SS3.p2.4.m3.1.1.3.1.cmml" xref="S3.SS3.p2.4.m3.1.1.3.1">→</ci><csymbol cd="latexml" id="S3.SS3.p2.4.m3.1.1.3.2.cmml" xref="S3.SS3.p2.4.m3.1.1.3.2">absent</csymbol><apply id="S3.SS3.p2.4.m3.1.1.3.3.cmml" xref="S3.SS3.p2.4.m3.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m3.1.1.3.3.1.cmml" xref="S3.SS3.p2.4.m3.1.1.3.3">subscript</csymbol><ci id="S3.SS3.p2.4.m3.1.1.3.3.2.cmml" xref="S3.SS3.p2.4.m3.1.1.3.3.2">ℎ</ci><cn id="S3.SS3.p2.4.m3.1.1.3.3.3.cmml" type="integer" xref="S3.SS3.p2.4.m3.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m3.1c">f_{\rightarrow h_{1}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.4.m3.1d">italic_f start_POSTSUBSCRIPT → italic_h start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> is a linear mapping layer, and <math alttext="\mathbf{p}\in\mathbb{R}^{k\times h_{1}}" class="ltx_Math" display="inline" id="S3.SS3.p2.5.m4.1"><semantics id="S3.SS3.p2.5.m4.1a"><mrow id="S3.SS3.p2.5.m4.1.1" xref="S3.SS3.p2.5.m4.1.1.cmml"><mi id="S3.SS3.p2.5.m4.1.1.2" xref="S3.SS3.p2.5.m4.1.1.2.cmml">𝐩</mi><mo id="S3.SS3.p2.5.m4.1.1.1" xref="S3.SS3.p2.5.m4.1.1.1.cmml">∈</mo><msup id="S3.SS3.p2.5.m4.1.1.3" xref="S3.SS3.p2.5.m4.1.1.3.cmml"><mi id="S3.SS3.p2.5.m4.1.1.3.2" xref="S3.SS3.p2.5.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.p2.5.m4.1.1.3.3" xref="S3.SS3.p2.5.m4.1.1.3.3.cmml"><mi id="S3.SS3.p2.5.m4.1.1.3.3.2" xref="S3.SS3.p2.5.m4.1.1.3.3.2.cmml">k</mi><mo id="S3.SS3.p2.5.m4.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.p2.5.m4.1.1.3.3.1.cmml">×</mo><msub id="S3.SS3.p2.5.m4.1.1.3.3.3" xref="S3.SS3.p2.5.m4.1.1.3.3.3.cmml"><mi id="S3.SS3.p2.5.m4.1.1.3.3.3.2" xref="S3.SS3.p2.5.m4.1.1.3.3.3.2.cmml">h</mi><mn id="S3.SS3.p2.5.m4.1.1.3.3.3.3" xref="S3.SS3.p2.5.m4.1.1.3.3.3.3.cmml">1</mn></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.5.m4.1b"><apply id="S3.SS3.p2.5.m4.1.1.cmml" xref="S3.SS3.p2.5.m4.1.1"><in id="S3.SS3.p2.5.m4.1.1.1.cmml" xref="S3.SS3.p2.5.m4.1.1.1"></in><ci id="S3.SS3.p2.5.m4.1.1.2.cmml" xref="S3.SS3.p2.5.m4.1.1.2">𝐩</ci><apply id="S3.SS3.p2.5.m4.1.1.3.cmml" xref="S3.SS3.p2.5.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m4.1.1.3.1.cmml" xref="S3.SS3.p2.5.m4.1.1.3">superscript</csymbol><ci id="S3.SS3.p2.5.m4.1.1.3.2.cmml" xref="S3.SS3.p2.5.m4.1.1.3.2">ℝ</ci><apply id="S3.SS3.p2.5.m4.1.1.3.3.cmml" xref="S3.SS3.p2.5.m4.1.1.3.3"><times id="S3.SS3.p2.5.m4.1.1.3.3.1.cmml" xref="S3.SS3.p2.5.m4.1.1.3.3.1"></times><ci id="S3.SS3.p2.5.m4.1.1.3.3.2.cmml" xref="S3.SS3.p2.5.m4.1.1.3.3.2">𝑘</ci><apply id="S3.SS3.p2.5.m4.1.1.3.3.3.cmml" xref="S3.SS3.p2.5.m4.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m4.1.1.3.3.3.1.cmml" xref="S3.SS3.p2.5.m4.1.1.3.3.3">subscript</csymbol><ci id="S3.SS3.p2.5.m4.1.1.3.3.3.2.cmml" xref="S3.SS3.p2.5.m4.1.1.3.3.3.2">ℎ</ci><cn id="S3.SS3.p2.5.m4.1.1.3.3.3.3.cmml" type="integer" xref="S3.SS3.p2.5.m4.1.1.3.3.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.5.m4.1c">\mathbf{p}\in\mathbb{R}^{k\times h_{1}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.5.m4.1d">bold_p ∈ blackboard_R start_POSTSUPERSCRIPT italic_k × italic_h start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> represents trainable positional embeddings. The output embeddings <math alttext="\mathbf{H}\in\mathbb{R}^{k\times{h_{1}}}" class="ltx_Math" display="inline" id="S3.SS3.p2.6.m5.1"><semantics id="S3.SS3.p2.6.m5.1a"><mrow id="S3.SS3.p2.6.m5.1.1" xref="S3.SS3.p2.6.m5.1.1.cmml"><mi id="S3.SS3.p2.6.m5.1.1.2" xref="S3.SS3.p2.6.m5.1.1.2.cmml">𝐇</mi><mo id="S3.SS3.p2.6.m5.1.1.1" xref="S3.SS3.p2.6.m5.1.1.1.cmml">∈</mo><msup id="S3.SS3.p2.6.m5.1.1.3" xref="S3.SS3.p2.6.m5.1.1.3.cmml"><mi id="S3.SS3.p2.6.m5.1.1.3.2" xref="S3.SS3.p2.6.m5.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.p2.6.m5.1.1.3.3" xref="S3.SS3.p2.6.m5.1.1.3.3.cmml"><mi id="S3.SS3.p2.6.m5.1.1.3.3.2" xref="S3.SS3.p2.6.m5.1.1.3.3.2.cmml">k</mi><mo id="S3.SS3.p2.6.m5.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.p2.6.m5.1.1.3.3.1.cmml">×</mo><msub id="S3.SS3.p2.6.m5.1.1.3.3.3" xref="S3.SS3.p2.6.m5.1.1.3.3.3.cmml"><mi id="S3.SS3.p2.6.m5.1.1.3.3.3.2" xref="S3.SS3.p2.6.m5.1.1.3.3.3.2.cmml">h</mi><mn id="S3.SS3.p2.6.m5.1.1.3.3.3.3" xref="S3.SS3.p2.6.m5.1.1.3.3.3.3.cmml">1</mn></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.6.m5.1b"><apply id="S3.SS3.p2.6.m5.1.1.cmml" xref="S3.SS3.p2.6.m5.1.1"><in id="S3.SS3.p2.6.m5.1.1.1.cmml" xref="S3.SS3.p2.6.m5.1.1.1"></in><ci id="S3.SS3.p2.6.m5.1.1.2.cmml" xref="S3.SS3.p2.6.m5.1.1.2">𝐇</ci><apply id="S3.SS3.p2.6.m5.1.1.3.cmml" xref="S3.SS3.p2.6.m5.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.6.m5.1.1.3.1.cmml" xref="S3.SS3.p2.6.m5.1.1.3">superscript</csymbol><ci id="S3.SS3.p2.6.m5.1.1.3.2.cmml" xref="S3.SS3.p2.6.m5.1.1.3.2">ℝ</ci><apply id="S3.SS3.p2.6.m5.1.1.3.3.cmml" xref="S3.SS3.p2.6.m5.1.1.3.3"><times id="S3.SS3.p2.6.m5.1.1.3.3.1.cmml" xref="S3.SS3.p2.6.m5.1.1.3.3.1"></times><ci id="S3.SS3.p2.6.m5.1.1.3.3.2.cmml" xref="S3.SS3.p2.6.m5.1.1.3.3.2">𝑘</ci><apply id="S3.SS3.p2.6.m5.1.1.3.3.3.cmml" xref="S3.SS3.p2.6.m5.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p2.6.m5.1.1.3.3.3.1.cmml" xref="S3.SS3.p2.6.m5.1.1.3.3.3">subscript</csymbol><ci id="S3.SS3.p2.6.m5.1.1.3.3.3.2.cmml" xref="S3.SS3.p2.6.m5.1.1.3.3.3.2">ℎ</ci><cn id="S3.SS3.p2.6.m5.1.1.3.3.3.3.cmml" type="integer" xref="S3.SS3.p2.6.m5.1.1.3.3.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.6.m5.1c">\mathbf{H}\in\mathbb{R}^{k\times{h_{1}}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.6.m5.1d">bold_H ∈ blackboard_R start_POSTSUPERSCRIPT italic_k × italic_h start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> thus contain the deeper retrieval information and will be delivered to the LLM’s generation.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Retrieval-Aware Prompting</h3>
<div class="ltx_para" id="S3.SS4.p1">
<p class="ltx_p" id="S3.SS4.p1.1">In the generation process, it is crucial for the LLM to utilize the retrieval information effectively. As shown in the upper part of Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#S3.F2" title="Figure 2 ‣ 3 R2AG ‣ R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_tag">2</span></a>, we introduce a retrieval-aware prompting strategy that injects the retrieval information extracted by R<sup class="ltx_sup" id="S3.SS4.p1.1.1">2</sup>-Former into the LLM’s generation process.</p>
</div>
<div class="ltx_para" id="S3.SS4.p2">
<p class="ltx_p" id="S3.SS4.p2.3">First, we employ a projection layer to linearly transform the retrieval information into the same dimension as the token embedding layer of the LLM. Formally, this is represented as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{E}^{R}=f_{\rightarrow h_{2}}(\mathbf{H})=\{\mathbf{e}_{i}^{R}\}_{i=1}^%
{k}," class="ltx_Math" display="block" id="S3.E3.m1.2"><semantics id="S3.E3.m1.2a"><mrow id="S3.E3.m1.2.2.1" xref="S3.E3.m1.2.2.1.1.cmml"><mrow id="S3.E3.m1.2.2.1.1" xref="S3.E3.m1.2.2.1.1.cmml"><msup id="S3.E3.m1.2.2.1.1.3" xref="S3.E3.m1.2.2.1.1.3.cmml"><mi id="S3.E3.m1.2.2.1.1.3.2" xref="S3.E3.m1.2.2.1.1.3.2.cmml">𝐄</mi><mi id="S3.E3.m1.2.2.1.1.3.3" xref="S3.E3.m1.2.2.1.1.3.3.cmml">R</mi></msup><mo id="S3.E3.m1.2.2.1.1.4" xref="S3.E3.m1.2.2.1.1.4.cmml">=</mo><mrow id="S3.E3.m1.2.2.1.1.5" xref="S3.E3.m1.2.2.1.1.5.cmml"><msub id="S3.E3.m1.2.2.1.1.5.2" xref="S3.E3.m1.2.2.1.1.5.2.cmml"><mi id="S3.E3.m1.2.2.1.1.5.2.2" xref="S3.E3.m1.2.2.1.1.5.2.2.cmml">f</mi><mrow id="S3.E3.m1.2.2.1.1.5.2.3" xref="S3.E3.m1.2.2.1.1.5.2.3.cmml"><mi id="S3.E3.m1.2.2.1.1.5.2.3.2" xref="S3.E3.m1.2.2.1.1.5.2.3.2.cmml"></mi><mo id="S3.E3.m1.2.2.1.1.5.2.3.1" stretchy="false" xref="S3.E3.m1.2.2.1.1.5.2.3.1.cmml">→</mo><msub id="S3.E3.m1.2.2.1.1.5.2.3.3" xref="S3.E3.m1.2.2.1.1.5.2.3.3.cmml"><mi id="S3.E3.m1.2.2.1.1.5.2.3.3.2" xref="S3.E3.m1.2.2.1.1.5.2.3.3.2.cmml">h</mi><mn id="S3.E3.m1.2.2.1.1.5.2.3.3.3" xref="S3.E3.m1.2.2.1.1.5.2.3.3.3.cmml">2</mn></msub></mrow></msub><mo id="S3.E3.m1.2.2.1.1.5.1" xref="S3.E3.m1.2.2.1.1.5.1.cmml">⁢</mo><mrow id="S3.E3.m1.2.2.1.1.5.3.2" xref="S3.E3.m1.2.2.1.1.5.cmml"><mo id="S3.E3.m1.2.2.1.1.5.3.2.1" stretchy="false" xref="S3.E3.m1.2.2.1.1.5.cmml">(</mo><mi id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml">𝐇</mi><mo id="S3.E3.m1.2.2.1.1.5.3.2.2" stretchy="false" xref="S3.E3.m1.2.2.1.1.5.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.2.2.1.1.6" xref="S3.E3.m1.2.2.1.1.6.cmml">=</mo><msubsup id="S3.E3.m1.2.2.1.1.1" xref="S3.E3.m1.2.2.1.1.1.cmml"><mrow id="S3.E3.m1.2.2.1.1.1.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.1.2.cmml"><mo id="S3.E3.m1.2.2.1.1.1.1.1.1.2" stretchy="false" xref="S3.E3.m1.2.2.1.1.1.1.1.2.cmml">{</mo><msubsup id="S3.E3.m1.2.2.1.1.1.1.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.2.2.1.1.1.1.1.1.1.2.2" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.2.2.cmml">𝐞</mi><mi id="S3.E3.m1.2.2.1.1.1.1.1.1.1.2.3" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="S3.E3.m1.2.2.1.1.1.1.1.1.1.3" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.3.cmml">R</mi></msubsup><mo id="S3.E3.m1.2.2.1.1.1.1.1.1.3" stretchy="false" xref="S3.E3.m1.2.2.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.E3.m1.2.2.1.1.1.1.3" xref="S3.E3.m1.2.2.1.1.1.1.3.cmml"><mi id="S3.E3.m1.2.2.1.1.1.1.3.2" xref="S3.E3.m1.2.2.1.1.1.1.3.2.cmml">i</mi><mo id="S3.E3.m1.2.2.1.1.1.1.3.1" xref="S3.E3.m1.2.2.1.1.1.1.3.1.cmml">=</mo><mn id="S3.E3.m1.2.2.1.1.1.1.3.3" xref="S3.E3.m1.2.2.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.E3.m1.2.2.1.1.1.3" xref="S3.E3.m1.2.2.1.1.1.3.cmml">k</mi></msubsup></mrow><mo id="S3.E3.m1.2.2.1.2" xref="S3.E3.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.2b"><apply id="S3.E3.m1.2.2.1.1.cmml" xref="S3.E3.m1.2.2.1"><and id="S3.E3.m1.2.2.1.1a.cmml" xref="S3.E3.m1.2.2.1"></and><apply id="S3.E3.m1.2.2.1.1b.cmml" xref="S3.E3.m1.2.2.1"><eq id="S3.E3.m1.2.2.1.1.4.cmml" xref="S3.E3.m1.2.2.1.1.4"></eq><apply id="S3.E3.m1.2.2.1.1.3.cmml" xref="S3.E3.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.3.1.cmml" xref="S3.E3.m1.2.2.1.1.3">superscript</csymbol><ci id="S3.E3.m1.2.2.1.1.3.2.cmml" xref="S3.E3.m1.2.2.1.1.3.2">𝐄</ci><ci id="S3.E3.m1.2.2.1.1.3.3.cmml" xref="S3.E3.m1.2.2.1.1.3.3">𝑅</ci></apply><apply id="S3.E3.m1.2.2.1.1.5.cmml" xref="S3.E3.m1.2.2.1.1.5"><times id="S3.E3.m1.2.2.1.1.5.1.cmml" xref="S3.E3.m1.2.2.1.1.5.1"></times><apply id="S3.E3.m1.2.2.1.1.5.2.cmml" xref="S3.E3.m1.2.2.1.1.5.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.5.2.1.cmml" xref="S3.E3.m1.2.2.1.1.5.2">subscript</csymbol><ci id="S3.E3.m1.2.2.1.1.5.2.2.cmml" xref="S3.E3.m1.2.2.1.1.5.2.2">𝑓</ci><apply id="S3.E3.m1.2.2.1.1.5.2.3.cmml" xref="S3.E3.m1.2.2.1.1.5.2.3"><ci id="S3.E3.m1.2.2.1.1.5.2.3.1.cmml" xref="S3.E3.m1.2.2.1.1.5.2.3.1">→</ci><csymbol cd="latexml" id="S3.E3.m1.2.2.1.1.5.2.3.2.cmml" xref="S3.E3.m1.2.2.1.1.5.2.3.2">absent</csymbol><apply id="S3.E3.m1.2.2.1.1.5.2.3.3.cmml" xref="S3.E3.m1.2.2.1.1.5.2.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.5.2.3.3.1.cmml" xref="S3.E3.m1.2.2.1.1.5.2.3.3">subscript</csymbol><ci id="S3.E3.m1.2.2.1.1.5.2.3.3.2.cmml" xref="S3.E3.m1.2.2.1.1.5.2.3.3.2">ℎ</ci><cn id="S3.E3.m1.2.2.1.1.5.2.3.3.3.cmml" type="integer" xref="S3.E3.m1.2.2.1.1.5.2.3.3.3">2</cn></apply></apply></apply><ci id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1">𝐇</ci></apply></apply><apply id="S3.E3.m1.2.2.1.1c.cmml" xref="S3.E3.m1.2.2.1"><eq id="S3.E3.m1.2.2.1.1.6.cmml" xref="S3.E3.m1.2.2.1.1.6"></eq><share href="https://arxiv.org/html/2406.13249v1#S3.E3.m1.2.2.1.1.5.cmml" id="S3.E3.m1.2.2.1.1d.cmml" xref="S3.E3.m1.2.2.1"></share><apply id="S3.E3.m1.2.2.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.1">superscript</csymbol><apply id="S3.E3.m1.2.2.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.1">subscript</csymbol><set id="S3.E3.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1"><apply id="S3.E3.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E3.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.2.2">𝐞</ci><ci id="S3.E3.m1.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.E3.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.3">𝑅</ci></apply></set><apply id="S3.E3.m1.2.2.1.1.1.1.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.3"><eq id="S3.E3.m1.2.2.1.1.1.1.3.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.3.1"></eq><ci id="S3.E3.m1.2.2.1.1.1.1.3.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.3.2">𝑖</ci><cn id="S3.E3.m1.2.2.1.1.1.1.3.3.cmml" type="integer" xref="S3.E3.m1.2.2.1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.E3.m1.2.2.1.1.1.3.cmml" xref="S3.E3.m1.2.2.1.1.1.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.2c">\mathbf{E}^{R}=f_{\rightarrow h_{2}}(\mathbf{H})=\{\mathbf{e}_{i}^{R}\}_{i=1}^%
{k},</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.2d">bold_E start_POSTSUPERSCRIPT italic_R end_POSTSUPERSCRIPT = italic_f start_POSTSUBSCRIPT → italic_h start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_H ) = { bold_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_R end_POSTSUPERSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.p2.2">where <math alttext="f_{\to h_{2}}" class="ltx_Math" display="inline" id="S3.SS4.p2.1.m1.1"><semantics id="S3.SS4.p2.1.m1.1a"><msub id="S3.SS4.p2.1.m1.1.1" xref="S3.SS4.p2.1.m1.1.1.cmml"><mi id="S3.SS4.p2.1.m1.1.1.2" xref="S3.SS4.p2.1.m1.1.1.2.cmml">f</mi><mrow id="S3.SS4.p2.1.m1.1.1.3" xref="S3.SS4.p2.1.m1.1.1.3.cmml"><mi id="S3.SS4.p2.1.m1.1.1.3.2" xref="S3.SS4.p2.1.m1.1.1.3.2.cmml"></mi><mo id="S3.SS4.p2.1.m1.1.1.3.1" stretchy="false" xref="S3.SS4.p2.1.m1.1.1.3.1.cmml">→</mo><msub id="S3.SS4.p2.1.m1.1.1.3.3" xref="S3.SS4.p2.1.m1.1.1.3.3.cmml"><mi id="S3.SS4.p2.1.m1.1.1.3.3.2" xref="S3.SS4.p2.1.m1.1.1.3.3.2.cmml">h</mi><mn id="S3.SS4.p2.1.m1.1.1.3.3.3" xref="S3.SS4.p2.1.m1.1.1.3.3.3.cmml">2</mn></msub></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.1.m1.1b"><apply id="S3.SS4.p2.1.m1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.1.m1.1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS4.p2.1.m1.1.1.2.cmml" xref="S3.SS4.p2.1.m1.1.1.2">𝑓</ci><apply id="S3.SS4.p2.1.m1.1.1.3.cmml" xref="S3.SS4.p2.1.m1.1.1.3"><ci id="S3.SS4.p2.1.m1.1.1.3.1.cmml" xref="S3.SS4.p2.1.m1.1.1.3.1">→</ci><csymbol cd="latexml" id="S3.SS4.p2.1.m1.1.1.3.2.cmml" xref="S3.SS4.p2.1.m1.1.1.3.2">absent</csymbol><apply id="S3.SS4.p2.1.m1.1.1.3.3.cmml" xref="S3.SS4.p2.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS4.p2.1.m1.1.1.3.3.1.cmml" xref="S3.SS4.p2.1.m1.1.1.3.3">subscript</csymbol><ci id="S3.SS4.p2.1.m1.1.1.3.3.2.cmml" xref="S3.SS4.p2.1.m1.1.1.3.3.2">ℎ</ci><cn id="S3.SS4.p2.1.m1.1.1.3.3.3.cmml" type="integer" xref="S3.SS4.p2.1.m1.1.1.3.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.1.m1.1c">f_{\to h_{2}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.1.m1.1d">italic_f start_POSTSUBSCRIPT → italic_h start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> is a linear projection layer via an MLP layer, and <math alttext="h_{2}" class="ltx_Math" display="inline" id="S3.SS4.p2.2.m2.1"><semantics id="S3.SS4.p2.2.m2.1a"><msub id="S3.SS4.p2.2.m2.1.1" xref="S3.SS4.p2.2.m2.1.1.cmml"><mi id="S3.SS4.p2.2.m2.1.1.2" xref="S3.SS4.p2.2.m2.1.1.2.cmml">h</mi><mn id="S3.SS4.p2.2.m2.1.1.3" xref="S3.SS4.p2.2.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.2.m2.1b"><apply id="S3.SS4.p2.2.m2.1.1.cmml" xref="S3.SS4.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.2.m2.1.1.1.cmml" xref="S3.SS4.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS4.p2.2.m2.1.1.2.cmml" xref="S3.SS4.p2.2.m2.1.1.2">ℎ</ci><cn id="S3.SS4.p2.2.m2.1.1.3.cmml" type="integer" xref="S3.SS4.p2.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.2.m2.1c">h_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.2.m2.1d">italic_h start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> is the dimension of LLM’s token embedding layer.</p>
</div>
<div class="ltx_para" id="S3.SS4.p3">
<p class="ltx_p" id="S3.SS4.p3.6">Then, we tokenize the query and documents using LLM’s tokenizer and convert them into embeddings. For example, a document <math alttext="d" class="ltx_Math" display="inline" id="S3.SS4.p3.1.m1.1"><semantics id="S3.SS4.p3.1.m1.1a"><mi id="S3.SS4.p3.1.m1.1.1" xref="S3.SS4.p3.1.m1.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.1.m1.1b"><ci id="S3.SS4.p3.1.m1.1.1.cmml" xref="S3.SS4.p3.1.m1.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.1.m1.1c">d</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.1.m1.1d">italic_d</annotation></semantics></math> is tokenized into <math alttext="\boldsymbol{t}^{d}{=}\{t_{j}^{d}\}_{j=1}^{n_{d}}" class="ltx_Math" display="inline" id="S3.SS4.p3.2.m2.1"><semantics id="S3.SS4.p3.2.m2.1a"><mrow id="S3.SS4.p3.2.m2.1.1" xref="S3.SS4.p3.2.m2.1.1.cmml"><msup id="S3.SS4.p3.2.m2.1.1.3" xref="S3.SS4.p3.2.m2.1.1.3.cmml"><mi id="S3.SS4.p3.2.m2.1.1.3.2" xref="S3.SS4.p3.2.m2.1.1.3.2.cmml">𝒕</mi><mi id="S3.SS4.p3.2.m2.1.1.3.3" xref="S3.SS4.p3.2.m2.1.1.3.3.cmml">d</mi></msup><mo id="S3.SS4.p3.2.m2.1.1.2" xref="S3.SS4.p3.2.m2.1.1.2.cmml">=</mo><msubsup id="S3.SS4.p3.2.m2.1.1.1" xref="S3.SS4.p3.2.m2.1.1.1.cmml"><mrow id="S3.SS4.p3.2.m2.1.1.1.1.1.1" xref="S3.SS4.p3.2.m2.1.1.1.1.1.2.cmml"><mo id="S3.SS4.p3.2.m2.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS4.p3.2.m2.1.1.1.1.1.2.cmml">{</mo><msubsup id="S3.SS4.p3.2.m2.1.1.1.1.1.1.1" xref="S3.SS4.p3.2.m2.1.1.1.1.1.1.1.cmml"><mi id="S3.SS4.p3.2.m2.1.1.1.1.1.1.1.2.2" xref="S3.SS4.p3.2.m2.1.1.1.1.1.1.1.2.2.cmml">t</mi><mi id="S3.SS4.p3.2.m2.1.1.1.1.1.1.1.2.3" xref="S3.SS4.p3.2.m2.1.1.1.1.1.1.1.2.3.cmml">j</mi><mi id="S3.SS4.p3.2.m2.1.1.1.1.1.1.1.3" xref="S3.SS4.p3.2.m2.1.1.1.1.1.1.1.3.cmml">d</mi></msubsup><mo id="S3.SS4.p3.2.m2.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS4.p3.2.m2.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS4.p3.2.m2.1.1.1.1.3" xref="S3.SS4.p3.2.m2.1.1.1.1.3.cmml"><mi id="S3.SS4.p3.2.m2.1.1.1.1.3.2" xref="S3.SS4.p3.2.m2.1.1.1.1.3.2.cmml">j</mi><mo id="S3.SS4.p3.2.m2.1.1.1.1.3.1" xref="S3.SS4.p3.2.m2.1.1.1.1.3.1.cmml">=</mo><mn id="S3.SS4.p3.2.m2.1.1.1.1.3.3" xref="S3.SS4.p3.2.m2.1.1.1.1.3.3.cmml">1</mn></mrow><msub id="S3.SS4.p3.2.m2.1.1.1.3" xref="S3.SS4.p3.2.m2.1.1.1.3.cmml"><mi id="S3.SS4.p3.2.m2.1.1.1.3.2" xref="S3.SS4.p3.2.m2.1.1.1.3.2.cmml">n</mi><mi id="S3.SS4.p3.2.m2.1.1.1.3.3" xref="S3.SS4.p3.2.m2.1.1.1.3.3.cmml">d</mi></msub></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.2.m2.1b"><apply id="S3.SS4.p3.2.m2.1.1.cmml" xref="S3.SS4.p3.2.m2.1.1"><eq id="S3.SS4.p3.2.m2.1.1.2.cmml" xref="S3.SS4.p3.2.m2.1.1.2"></eq><apply id="S3.SS4.p3.2.m2.1.1.3.cmml" xref="S3.SS4.p3.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p3.2.m2.1.1.3.1.cmml" xref="S3.SS4.p3.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS4.p3.2.m2.1.1.3.2.cmml" xref="S3.SS4.p3.2.m2.1.1.3.2">𝒕</ci><ci id="S3.SS4.p3.2.m2.1.1.3.3.cmml" xref="S3.SS4.p3.2.m2.1.1.3.3">𝑑</ci></apply><apply id="S3.SS4.p3.2.m2.1.1.1.cmml" xref="S3.SS4.p3.2.m2.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.2.m2.1.1.1.2.cmml" xref="S3.SS4.p3.2.m2.1.1.1">superscript</csymbol><apply id="S3.SS4.p3.2.m2.1.1.1.1.cmml" xref="S3.SS4.p3.2.m2.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.2.m2.1.1.1.1.2.cmml" xref="S3.SS4.p3.2.m2.1.1.1">subscript</csymbol><set id="S3.SS4.p3.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS4.p3.2.m2.1.1.1.1.1.1"><apply id="S3.SS4.p3.2.m2.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p3.2.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.2.m2.1.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p3.2.m2.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.SS4.p3.2.m2.1.1.1.1.1.1.1.2.cmml" xref="S3.SS4.p3.2.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.2.m2.1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS4.p3.2.m2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p3.2.m2.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS4.p3.2.m2.1.1.1.1.1.1.1.2.2">𝑡</ci><ci id="S3.SS4.p3.2.m2.1.1.1.1.1.1.1.2.3.cmml" xref="S3.SS4.p3.2.m2.1.1.1.1.1.1.1.2.3">𝑗</ci></apply><ci id="S3.SS4.p3.2.m2.1.1.1.1.1.1.1.3.cmml" xref="S3.SS4.p3.2.m2.1.1.1.1.1.1.1.3">𝑑</ci></apply></set><apply id="S3.SS4.p3.2.m2.1.1.1.1.3.cmml" xref="S3.SS4.p3.2.m2.1.1.1.1.3"><eq id="S3.SS4.p3.2.m2.1.1.1.1.3.1.cmml" xref="S3.SS4.p3.2.m2.1.1.1.1.3.1"></eq><ci id="S3.SS4.p3.2.m2.1.1.1.1.3.2.cmml" xref="S3.SS4.p3.2.m2.1.1.1.1.3.2">𝑗</ci><cn id="S3.SS4.p3.2.m2.1.1.1.1.3.3.cmml" type="integer" xref="S3.SS4.p3.2.m2.1.1.1.1.3.3">1</cn></apply></apply><apply id="S3.SS4.p3.2.m2.1.1.1.3.cmml" xref="S3.SS4.p3.2.m2.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p3.2.m2.1.1.1.3.1.cmml" xref="S3.SS4.p3.2.m2.1.1.1.3">subscript</csymbol><ci id="S3.SS4.p3.2.m2.1.1.1.3.2.cmml" xref="S3.SS4.p3.2.m2.1.1.1.3.2">𝑛</ci><ci id="S3.SS4.p3.2.m2.1.1.1.3.3.cmml" xref="S3.SS4.p3.2.m2.1.1.1.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.2.m2.1c">\boldsymbol{t}^{d}{=}\{t_{j}^{d}\}_{j=1}^{n_{d}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.2.m2.1d">bold_italic_t start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT = { italic_t start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT } start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="t_{j}^{d}" class="ltx_Math" display="inline" id="S3.SS4.p3.3.m3.1"><semantics id="S3.SS4.p3.3.m3.1a"><msubsup id="S3.SS4.p3.3.m3.1.1" xref="S3.SS4.p3.3.m3.1.1.cmml"><mi id="S3.SS4.p3.3.m3.1.1.2.2" xref="S3.SS4.p3.3.m3.1.1.2.2.cmml">t</mi><mi id="S3.SS4.p3.3.m3.1.1.2.3" xref="S3.SS4.p3.3.m3.1.1.2.3.cmml">j</mi><mi id="S3.SS4.p3.3.m3.1.1.3" xref="S3.SS4.p3.3.m3.1.1.3.cmml">d</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.3.m3.1b"><apply id="S3.SS4.p3.3.m3.1.1.cmml" xref="S3.SS4.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.3.m3.1.1.1.cmml" xref="S3.SS4.p3.3.m3.1.1">superscript</csymbol><apply id="S3.SS4.p3.3.m3.1.1.2.cmml" xref="S3.SS4.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.3.m3.1.1.2.1.cmml" xref="S3.SS4.p3.3.m3.1.1">subscript</csymbol><ci id="S3.SS4.p3.3.m3.1.1.2.2.cmml" xref="S3.SS4.p3.3.m3.1.1.2.2">𝑡</ci><ci id="S3.SS4.p3.3.m3.1.1.2.3.cmml" xref="S3.SS4.p3.3.m3.1.1.2.3">𝑗</ci></apply><ci id="S3.SS4.p3.3.m3.1.1.3.cmml" xref="S3.SS4.p3.3.m3.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.3.m3.1c">t_{j}^{d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.3.m3.1d">italic_t start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> is the <math alttext="j" class="ltx_Math" display="inline" id="S3.SS4.p3.4.m4.1"><semantics id="S3.SS4.p3.4.m4.1a"><mi id="S3.SS4.p3.4.m4.1.1" xref="S3.SS4.p3.4.m4.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.4.m4.1b"><ci id="S3.SS4.p3.4.m4.1.1.cmml" xref="S3.SS4.p3.4.m4.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.4.m4.1c">j</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.4.m4.1d">italic_j</annotation></semantics></math>-th token in the document, <math alttext="n_{d}" class="ltx_Math" display="inline" id="S3.SS4.p3.5.m5.1"><semantics id="S3.SS4.p3.5.m5.1a"><msub id="S3.SS4.p3.5.m5.1.1" xref="S3.SS4.p3.5.m5.1.1.cmml"><mi id="S3.SS4.p3.5.m5.1.1.2" xref="S3.SS4.p3.5.m5.1.1.2.cmml">n</mi><mi id="S3.SS4.p3.5.m5.1.1.3" xref="S3.SS4.p3.5.m5.1.1.3.cmml">d</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.5.m5.1b"><apply id="S3.SS4.p3.5.m5.1.1.cmml" xref="S3.SS4.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.5.m5.1.1.1.cmml" xref="S3.SS4.p3.5.m5.1.1">subscript</csymbol><ci id="S3.SS4.p3.5.m5.1.1.2.cmml" xref="S3.SS4.p3.5.m5.1.1.2">𝑛</ci><ci id="S3.SS4.p3.5.m5.1.1.3.cmml" xref="S3.SS4.p3.5.m5.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.5.m5.1c">n_{d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.5.m5.1d">italic_n start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT</annotation></semantics></math> is the number of tokens in the document <math alttext="d" class="ltx_Math" display="inline" id="S3.SS4.p3.6.m6.1"><semantics id="S3.SS4.p3.6.m6.1a"><mi id="S3.SS4.p3.6.m6.1.1" xref="S3.SS4.p3.6.m6.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.6.m6.1b"><ci id="S3.SS4.p3.6.m6.1.1.cmml" xref="S3.SS4.p3.6.m6.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.6.m6.1c">d</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.6.m6.1d">italic_d</annotation></semantics></math>. And the token embeddings can be transformed by a lookup in the token embedding layer. The process can be expressed as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{E}^{d}=f_{emb}\left(\boldsymbol{t}^{d}\right)=\{\mathbf{e}^{d}_{j}\}_{%
j=1}^{n_{d}}," class="ltx_Math" display="block" id="S3.E4.m1.1"><semantics id="S3.E4.m1.1a"><mrow id="S3.E4.m1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml"><mrow id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml"><msup id="S3.E4.m1.1.1.1.1.4" xref="S3.E4.m1.1.1.1.1.4.cmml"><mi id="S3.E4.m1.1.1.1.1.4.2" xref="S3.E4.m1.1.1.1.1.4.2.cmml">𝐄</mi><mi id="S3.E4.m1.1.1.1.1.4.3" xref="S3.E4.m1.1.1.1.1.4.3.cmml">d</mi></msup><mo id="S3.E4.m1.1.1.1.1.5" xref="S3.E4.m1.1.1.1.1.5.cmml">=</mo><mrow id="S3.E4.m1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.cmml"><msub id="S3.E4.m1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.3.cmml"><mi id="S3.E4.m1.1.1.1.1.1.3.2" xref="S3.E4.m1.1.1.1.1.1.3.2.cmml">f</mi><mrow id="S3.E4.m1.1.1.1.1.1.3.3" xref="S3.E4.m1.1.1.1.1.1.3.3.cmml"><mi id="S3.E4.m1.1.1.1.1.1.3.3.2" xref="S3.E4.m1.1.1.1.1.1.3.3.2.cmml">e</mi><mo id="S3.E4.m1.1.1.1.1.1.3.3.1" xref="S3.E4.m1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.E4.m1.1.1.1.1.1.3.3.3" xref="S3.E4.m1.1.1.1.1.1.3.3.3.cmml">m</mi><mo id="S3.E4.m1.1.1.1.1.1.3.3.1a" xref="S3.E4.m1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.E4.m1.1.1.1.1.1.3.3.4" xref="S3.E4.m1.1.1.1.1.1.3.3.4.cmml">b</mi></mrow></msub><mo id="S3.E4.m1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E4.m1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E4.m1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S3.E4.m1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.1.1.1.2.cmml">𝒕</mi><mi id="S3.E4.m1.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.1.1.1.3.cmml">d</mi></msup><mo id="S3.E4.m1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.1.1.1.1.6" xref="S3.E4.m1.1.1.1.1.6.cmml">=</mo><msubsup id="S3.E4.m1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.2.cmml"><mrow id="S3.E4.m1.1.1.1.1.2.1.1.1" xref="S3.E4.m1.1.1.1.1.2.1.1.2.cmml"><mo id="S3.E4.m1.1.1.1.1.2.1.1.1.2" stretchy="false" xref="S3.E4.m1.1.1.1.1.2.1.1.2.cmml">{</mo><msubsup id="S3.E4.m1.1.1.1.1.2.1.1.1.1" xref="S3.E4.m1.1.1.1.1.2.1.1.1.1.cmml"><mi id="S3.E4.m1.1.1.1.1.2.1.1.1.1.2.2" xref="S3.E4.m1.1.1.1.1.2.1.1.1.1.2.2.cmml">𝐞</mi><mi id="S3.E4.m1.1.1.1.1.2.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.2.1.1.1.1.3.cmml">j</mi><mi id="S3.E4.m1.1.1.1.1.2.1.1.1.1.2.3" xref="S3.E4.m1.1.1.1.1.2.1.1.1.1.2.3.cmml">d</mi></msubsup><mo id="S3.E4.m1.1.1.1.1.2.1.1.1.3" stretchy="false" xref="S3.E4.m1.1.1.1.1.2.1.1.2.cmml">}</mo></mrow><mrow id="S3.E4.m1.1.1.1.1.2.1.3" xref="S3.E4.m1.1.1.1.1.2.1.3.cmml"><mi id="S3.E4.m1.1.1.1.1.2.1.3.2" xref="S3.E4.m1.1.1.1.1.2.1.3.2.cmml">j</mi><mo id="S3.E4.m1.1.1.1.1.2.1.3.1" xref="S3.E4.m1.1.1.1.1.2.1.3.1.cmml">=</mo><mn id="S3.E4.m1.1.1.1.1.2.1.3.3" xref="S3.E4.m1.1.1.1.1.2.1.3.3.cmml">1</mn></mrow><msub id="S3.E4.m1.1.1.1.1.2.3" xref="S3.E4.m1.1.1.1.1.2.3.cmml"><mi id="S3.E4.m1.1.1.1.1.2.3.2" xref="S3.E4.m1.1.1.1.1.2.3.2.cmml">n</mi><mi id="S3.E4.m1.1.1.1.1.2.3.3" xref="S3.E4.m1.1.1.1.1.2.3.3.cmml">d</mi></msub></msubsup></mrow><mo id="S3.E4.m1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.1b"><apply id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1"><and id="S3.E4.m1.1.1.1.1a.cmml" xref="S3.E4.m1.1.1.1"></and><apply id="S3.E4.m1.1.1.1.1b.cmml" xref="S3.E4.m1.1.1.1"><eq id="S3.E4.m1.1.1.1.1.5.cmml" xref="S3.E4.m1.1.1.1.1.5"></eq><apply id="S3.E4.m1.1.1.1.1.4.cmml" xref="S3.E4.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.4.1.cmml" xref="S3.E4.m1.1.1.1.1.4">superscript</csymbol><ci id="S3.E4.m1.1.1.1.1.4.2.cmml" xref="S3.E4.m1.1.1.1.1.4.2">𝐄</ci><ci id="S3.E4.m1.1.1.1.1.4.3.cmml" xref="S3.E4.m1.1.1.1.1.4.3">𝑑</ci></apply><apply id="S3.E4.m1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1"><times id="S3.E4.m1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.2"></times><apply id="S3.E4.m1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.1.1.1.3.2">𝑓</ci><apply id="S3.E4.m1.1.1.1.1.1.3.3.cmml" xref="S3.E4.m1.1.1.1.1.1.3.3"><times id="S3.E4.m1.1.1.1.1.1.3.3.1.cmml" xref="S3.E4.m1.1.1.1.1.1.3.3.1"></times><ci id="S3.E4.m1.1.1.1.1.1.3.3.2.cmml" xref="S3.E4.m1.1.1.1.1.1.3.3.2">𝑒</ci><ci id="S3.E4.m1.1.1.1.1.1.3.3.3.cmml" xref="S3.E4.m1.1.1.1.1.1.3.3.3">𝑚</ci><ci id="S3.E4.m1.1.1.1.1.1.3.3.4.cmml" xref="S3.E4.m1.1.1.1.1.1.3.3.4">𝑏</ci></apply></apply><apply id="S3.E4.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E4.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.2">𝒕</ci><ci id="S3.E4.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.3">𝑑</ci></apply></apply></apply><apply id="S3.E4.m1.1.1.1.1c.cmml" xref="S3.E4.m1.1.1.1"><eq id="S3.E4.m1.1.1.1.1.6.cmml" xref="S3.E4.m1.1.1.1.1.6"></eq><share href="https://arxiv.org/html/2406.13249v1#S3.E4.m1.1.1.1.1.1.cmml" id="S3.E4.m1.1.1.1.1d.cmml" xref="S3.E4.m1.1.1.1"></share><apply id="S3.E4.m1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.1.1.1.1.2">superscript</csymbol><apply id="S3.E4.m1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.2.1.2.cmml" xref="S3.E4.m1.1.1.1.1.2">subscript</csymbol><set id="S3.E4.m1.1.1.1.1.2.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.2.1.1.1"><apply id="S3.E4.m1.1.1.1.1.2.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.2.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.2.1.1.1.1">subscript</csymbol><apply id="S3.E4.m1.1.1.1.1.2.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.2.1.1.1.1.2.1.cmml" xref="S3.E4.m1.1.1.1.1.2.1.1.1.1">superscript</csymbol><ci id="S3.E4.m1.1.1.1.1.2.1.1.1.1.2.2.cmml" xref="S3.E4.m1.1.1.1.1.2.1.1.1.1.2.2">𝐞</ci><ci id="S3.E4.m1.1.1.1.1.2.1.1.1.1.2.3.cmml" xref="S3.E4.m1.1.1.1.1.2.1.1.1.1.2.3">𝑑</ci></apply><ci id="S3.E4.m1.1.1.1.1.2.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.2.1.1.1.1.3">𝑗</ci></apply></set><apply id="S3.E4.m1.1.1.1.1.2.1.3.cmml" xref="S3.E4.m1.1.1.1.1.2.1.3"><eq id="S3.E4.m1.1.1.1.1.2.1.3.1.cmml" xref="S3.E4.m1.1.1.1.1.2.1.3.1"></eq><ci id="S3.E4.m1.1.1.1.1.2.1.3.2.cmml" xref="S3.E4.m1.1.1.1.1.2.1.3.2">𝑗</ci><cn id="S3.E4.m1.1.1.1.1.2.1.3.3.cmml" type="integer" xref="S3.E4.m1.1.1.1.1.2.1.3.3">1</cn></apply></apply><apply id="S3.E4.m1.1.1.1.1.2.3.cmml" xref="S3.E4.m1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.2.3.1.cmml" xref="S3.E4.m1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.2.3.2.cmml" xref="S3.E4.m1.1.1.1.1.2.3.2">𝑛</ci><ci id="S3.E4.m1.1.1.1.1.2.3.3.cmml" xref="S3.E4.m1.1.1.1.1.2.3.3">𝑑</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.1c">\mathbf{E}^{d}=f_{emb}\left(\boldsymbol{t}^{d}\right)=\{\mathbf{e}^{d}_{j}\}_{%
j=1}^{n_{d}},</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.1d">bold_E start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT = italic_f start_POSTSUBSCRIPT italic_e italic_m italic_b end_POSTSUBSCRIPT ( bold_italic_t start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT ) = { bold_e start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.p3.11">where <math alttext="f_{emb}" class="ltx_Math" display="inline" id="S3.SS4.p3.7.m1.1"><semantics id="S3.SS4.p3.7.m1.1a"><msub id="S3.SS4.p3.7.m1.1.1" xref="S3.SS4.p3.7.m1.1.1.cmml"><mi id="S3.SS4.p3.7.m1.1.1.2" xref="S3.SS4.p3.7.m1.1.1.2.cmml">f</mi><mrow id="S3.SS4.p3.7.m1.1.1.3" xref="S3.SS4.p3.7.m1.1.1.3.cmml"><mi id="S3.SS4.p3.7.m1.1.1.3.2" xref="S3.SS4.p3.7.m1.1.1.3.2.cmml">e</mi><mo id="S3.SS4.p3.7.m1.1.1.3.1" xref="S3.SS4.p3.7.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS4.p3.7.m1.1.1.3.3" xref="S3.SS4.p3.7.m1.1.1.3.3.cmml">m</mi><mo id="S3.SS4.p3.7.m1.1.1.3.1a" xref="S3.SS4.p3.7.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS4.p3.7.m1.1.1.3.4" xref="S3.SS4.p3.7.m1.1.1.3.4.cmml">b</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.7.m1.1b"><apply id="S3.SS4.p3.7.m1.1.1.cmml" xref="S3.SS4.p3.7.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.7.m1.1.1.1.cmml" xref="S3.SS4.p3.7.m1.1.1">subscript</csymbol><ci id="S3.SS4.p3.7.m1.1.1.2.cmml" xref="S3.SS4.p3.7.m1.1.1.2">𝑓</ci><apply id="S3.SS4.p3.7.m1.1.1.3.cmml" xref="S3.SS4.p3.7.m1.1.1.3"><times id="S3.SS4.p3.7.m1.1.1.3.1.cmml" xref="S3.SS4.p3.7.m1.1.1.3.1"></times><ci id="S3.SS4.p3.7.m1.1.1.3.2.cmml" xref="S3.SS4.p3.7.m1.1.1.3.2">𝑒</ci><ci id="S3.SS4.p3.7.m1.1.1.3.3.cmml" xref="S3.SS4.p3.7.m1.1.1.3.3">𝑚</ci><ci id="S3.SS4.p3.7.m1.1.1.3.4.cmml" xref="S3.SS4.p3.7.m1.1.1.3.4">𝑏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.7.m1.1c">f_{emb}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.7.m1.1d">italic_f start_POSTSUBSCRIPT italic_e italic_m italic_b end_POSTSUBSCRIPT</annotation></semantics></math> is the token embedding layer of the LLM, and <math alttext="\mathbf{E}^{d}\in\mathbb{R}^{n_{d}\times h_{2}}" class="ltx_Math" display="inline" id="S3.SS4.p3.8.m2.1"><semantics id="S3.SS4.p3.8.m2.1a"><mrow id="S3.SS4.p3.8.m2.1.1" xref="S3.SS4.p3.8.m2.1.1.cmml"><msup id="S3.SS4.p3.8.m2.1.1.2" xref="S3.SS4.p3.8.m2.1.1.2.cmml"><mi id="S3.SS4.p3.8.m2.1.1.2.2" xref="S3.SS4.p3.8.m2.1.1.2.2.cmml">𝐄</mi><mi id="S3.SS4.p3.8.m2.1.1.2.3" xref="S3.SS4.p3.8.m2.1.1.2.3.cmml">d</mi></msup><mo id="S3.SS4.p3.8.m2.1.1.1" xref="S3.SS4.p3.8.m2.1.1.1.cmml">∈</mo><msup id="S3.SS4.p3.8.m2.1.1.3" xref="S3.SS4.p3.8.m2.1.1.3.cmml"><mi id="S3.SS4.p3.8.m2.1.1.3.2" xref="S3.SS4.p3.8.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS4.p3.8.m2.1.1.3.3" xref="S3.SS4.p3.8.m2.1.1.3.3.cmml"><msub id="S3.SS4.p3.8.m2.1.1.3.3.2" xref="S3.SS4.p3.8.m2.1.1.3.3.2.cmml"><mi id="S3.SS4.p3.8.m2.1.1.3.3.2.2" xref="S3.SS4.p3.8.m2.1.1.3.3.2.2.cmml">n</mi><mi id="S3.SS4.p3.8.m2.1.1.3.3.2.3" xref="S3.SS4.p3.8.m2.1.1.3.3.2.3.cmml">d</mi></msub><mo id="S3.SS4.p3.8.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS4.p3.8.m2.1.1.3.3.1.cmml">×</mo><msub id="S3.SS4.p3.8.m2.1.1.3.3.3" xref="S3.SS4.p3.8.m2.1.1.3.3.3.cmml"><mi id="S3.SS4.p3.8.m2.1.1.3.3.3.2" xref="S3.SS4.p3.8.m2.1.1.3.3.3.2.cmml">h</mi><mn id="S3.SS4.p3.8.m2.1.1.3.3.3.3" xref="S3.SS4.p3.8.m2.1.1.3.3.3.3.cmml">2</mn></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.8.m2.1b"><apply id="S3.SS4.p3.8.m2.1.1.cmml" xref="S3.SS4.p3.8.m2.1.1"><in id="S3.SS4.p3.8.m2.1.1.1.cmml" xref="S3.SS4.p3.8.m2.1.1.1"></in><apply id="S3.SS4.p3.8.m2.1.1.2.cmml" xref="S3.SS4.p3.8.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p3.8.m2.1.1.2.1.cmml" xref="S3.SS4.p3.8.m2.1.1.2">superscript</csymbol><ci id="S3.SS4.p3.8.m2.1.1.2.2.cmml" xref="S3.SS4.p3.8.m2.1.1.2.2">𝐄</ci><ci id="S3.SS4.p3.8.m2.1.1.2.3.cmml" xref="S3.SS4.p3.8.m2.1.1.2.3">𝑑</ci></apply><apply id="S3.SS4.p3.8.m2.1.1.3.cmml" xref="S3.SS4.p3.8.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p3.8.m2.1.1.3.1.cmml" xref="S3.SS4.p3.8.m2.1.1.3">superscript</csymbol><ci id="S3.SS4.p3.8.m2.1.1.3.2.cmml" xref="S3.SS4.p3.8.m2.1.1.3.2">ℝ</ci><apply id="S3.SS4.p3.8.m2.1.1.3.3.cmml" xref="S3.SS4.p3.8.m2.1.1.3.3"><times id="S3.SS4.p3.8.m2.1.1.3.3.1.cmml" xref="S3.SS4.p3.8.m2.1.1.3.3.1"></times><apply id="S3.SS4.p3.8.m2.1.1.3.3.2.cmml" xref="S3.SS4.p3.8.m2.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS4.p3.8.m2.1.1.3.3.2.1.cmml" xref="S3.SS4.p3.8.m2.1.1.3.3.2">subscript</csymbol><ci id="S3.SS4.p3.8.m2.1.1.3.3.2.2.cmml" xref="S3.SS4.p3.8.m2.1.1.3.3.2.2">𝑛</ci><ci id="S3.SS4.p3.8.m2.1.1.3.3.2.3.cmml" xref="S3.SS4.p3.8.m2.1.1.3.3.2.3">𝑑</ci></apply><apply id="S3.SS4.p3.8.m2.1.1.3.3.3.cmml" xref="S3.SS4.p3.8.m2.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS4.p3.8.m2.1.1.3.3.3.1.cmml" xref="S3.SS4.p3.8.m2.1.1.3.3.3">subscript</csymbol><ci id="S3.SS4.p3.8.m2.1.1.3.3.3.2.cmml" xref="S3.SS4.p3.8.m2.1.1.3.3.3.2">ℎ</ci><cn id="S3.SS4.p3.8.m2.1.1.3.3.3.3.cmml" type="integer" xref="S3.SS4.p3.8.m2.1.1.3.3.3.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.8.m2.1c">\mathbf{E}^{d}\in\mathbb{R}^{n_{d}\times h_{2}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.8.m2.1d">bold_E start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_n start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT × italic_h start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> is the embeddings of document <math alttext="d" class="ltx_Math" display="inline" id="S3.SS4.p3.9.m3.1"><semantics id="S3.SS4.p3.9.m3.1a"><mi id="S3.SS4.p3.9.m3.1.1" xref="S3.SS4.p3.9.m3.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.9.m3.1b"><ci id="S3.SS4.p3.9.m3.1.1.cmml" xref="S3.SS4.p3.9.m3.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.9.m3.1c">d</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.9.m3.1d">italic_d</annotation></semantics></math>. A similar process is applied to obtain the query embeddings <math alttext="\mathbf{E}^{q}=\{\mathbf{e}^{q}_{j}\}_{j=1}^{n_{q}}" class="ltx_Math" display="inline" id="S3.SS4.p3.10.m4.1"><semantics id="S3.SS4.p3.10.m4.1a"><mrow id="S3.SS4.p3.10.m4.1.1" xref="S3.SS4.p3.10.m4.1.1.cmml"><msup id="S3.SS4.p3.10.m4.1.1.3" xref="S3.SS4.p3.10.m4.1.1.3.cmml"><mi id="S3.SS4.p3.10.m4.1.1.3.2" xref="S3.SS4.p3.10.m4.1.1.3.2.cmml">𝐄</mi><mi id="S3.SS4.p3.10.m4.1.1.3.3" xref="S3.SS4.p3.10.m4.1.1.3.3.cmml">q</mi></msup><mo id="S3.SS4.p3.10.m4.1.1.2" xref="S3.SS4.p3.10.m4.1.1.2.cmml">=</mo><msubsup id="S3.SS4.p3.10.m4.1.1.1" xref="S3.SS4.p3.10.m4.1.1.1.cmml"><mrow id="S3.SS4.p3.10.m4.1.1.1.1.1.1" xref="S3.SS4.p3.10.m4.1.1.1.1.1.2.cmml"><mo id="S3.SS4.p3.10.m4.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS4.p3.10.m4.1.1.1.1.1.2.cmml">{</mo><msubsup id="S3.SS4.p3.10.m4.1.1.1.1.1.1.1" xref="S3.SS4.p3.10.m4.1.1.1.1.1.1.1.cmml"><mi id="S3.SS4.p3.10.m4.1.1.1.1.1.1.1.2.2" xref="S3.SS4.p3.10.m4.1.1.1.1.1.1.1.2.2.cmml">𝐞</mi><mi id="S3.SS4.p3.10.m4.1.1.1.1.1.1.1.3" xref="S3.SS4.p3.10.m4.1.1.1.1.1.1.1.3.cmml">j</mi><mi id="S3.SS4.p3.10.m4.1.1.1.1.1.1.1.2.3" xref="S3.SS4.p3.10.m4.1.1.1.1.1.1.1.2.3.cmml">q</mi></msubsup><mo id="S3.SS4.p3.10.m4.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS4.p3.10.m4.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS4.p3.10.m4.1.1.1.1.3" xref="S3.SS4.p3.10.m4.1.1.1.1.3.cmml"><mi id="S3.SS4.p3.10.m4.1.1.1.1.3.2" xref="S3.SS4.p3.10.m4.1.1.1.1.3.2.cmml">j</mi><mo id="S3.SS4.p3.10.m4.1.1.1.1.3.1" xref="S3.SS4.p3.10.m4.1.1.1.1.3.1.cmml">=</mo><mn id="S3.SS4.p3.10.m4.1.1.1.1.3.3" xref="S3.SS4.p3.10.m4.1.1.1.1.3.3.cmml">1</mn></mrow><msub id="S3.SS4.p3.10.m4.1.1.1.3" xref="S3.SS4.p3.10.m4.1.1.1.3.cmml"><mi id="S3.SS4.p3.10.m4.1.1.1.3.2" xref="S3.SS4.p3.10.m4.1.1.1.3.2.cmml">n</mi><mi id="S3.SS4.p3.10.m4.1.1.1.3.3" xref="S3.SS4.p3.10.m4.1.1.1.3.3.cmml">q</mi></msub></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.10.m4.1b"><apply id="S3.SS4.p3.10.m4.1.1.cmml" xref="S3.SS4.p3.10.m4.1.1"><eq id="S3.SS4.p3.10.m4.1.1.2.cmml" xref="S3.SS4.p3.10.m4.1.1.2"></eq><apply id="S3.SS4.p3.10.m4.1.1.3.cmml" xref="S3.SS4.p3.10.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p3.10.m4.1.1.3.1.cmml" xref="S3.SS4.p3.10.m4.1.1.3">superscript</csymbol><ci id="S3.SS4.p3.10.m4.1.1.3.2.cmml" xref="S3.SS4.p3.10.m4.1.1.3.2">𝐄</ci><ci id="S3.SS4.p3.10.m4.1.1.3.3.cmml" xref="S3.SS4.p3.10.m4.1.1.3.3">𝑞</ci></apply><apply id="S3.SS4.p3.10.m4.1.1.1.cmml" xref="S3.SS4.p3.10.m4.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.10.m4.1.1.1.2.cmml" xref="S3.SS4.p3.10.m4.1.1.1">superscript</csymbol><apply id="S3.SS4.p3.10.m4.1.1.1.1.cmml" xref="S3.SS4.p3.10.m4.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.10.m4.1.1.1.1.2.cmml" xref="S3.SS4.p3.10.m4.1.1.1">subscript</csymbol><set id="S3.SS4.p3.10.m4.1.1.1.1.1.2.cmml" xref="S3.SS4.p3.10.m4.1.1.1.1.1.1"><apply id="S3.SS4.p3.10.m4.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p3.10.m4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.10.m4.1.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p3.10.m4.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.SS4.p3.10.m4.1.1.1.1.1.1.1.2.cmml" xref="S3.SS4.p3.10.m4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.10.m4.1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS4.p3.10.m4.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.SS4.p3.10.m4.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS4.p3.10.m4.1.1.1.1.1.1.1.2.2">𝐞</ci><ci id="S3.SS4.p3.10.m4.1.1.1.1.1.1.1.2.3.cmml" xref="S3.SS4.p3.10.m4.1.1.1.1.1.1.1.2.3">𝑞</ci></apply><ci id="S3.SS4.p3.10.m4.1.1.1.1.1.1.1.3.cmml" xref="S3.SS4.p3.10.m4.1.1.1.1.1.1.1.3">𝑗</ci></apply></set><apply id="S3.SS4.p3.10.m4.1.1.1.1.3.cmml" xref="S3.SS4.p3.10.m4.1.1.1.1.3"><eq id="S3.SS4.p3.10.m4.1.1.1.1.3.1.cmml" xref="S3.SS4.p3.10.m4.1.1.1.1.3.1"></eq><ci id="S3.SS4.p3.10.m4.1.1.1.1.3.2.cmml" xref="S3.SS4.p3.10.m4.1.1.1.1.3.2">𝑗</ci><cn id="S3.SS4.p3.10.m4.1.1.1.1.3.3.cmml" type="integer" xref="S3.SS4.p3.10.m4.1.1.1.1.3.3">1</cn></apply></apply><apply id="S3.SS4.p3.10.m4.1.1.1.3.cmml" xref="S3.SS4.p3.10.m4.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p3.10.m4.1.1.1.3.1.cmml" xref="S3.SS4.p3.10.m4.1.1.1.3">subscript</csymbol><ci id="S3.SS4.p3.10.m4.1.1.1.3.2.cmml" xref="S3.SS4.p3.10.m4.1.1.1.3.2">𝑛</ci><ci id="S3.SS4.p3.10.m4.1.1.1.3.3.cmml" xref="S3.SS4.p3.10.m4.1.1.1.3.3">𝑞</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.10.m4.1c">\mathbf{E}^{q}=\{\mathbf{e}^{q}_{j}\}_{j=1}^{n_{q}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.10.m4.1d">bold_E start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT = { bold_e start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="n_{q}" class="ltx_Math" display="inline" id="S3.SS4.p3.11.m5.1"><semantics id="S3.SS4.p3.11.m5.1a"><msub id="S3.SS4.p3.11.m5.1.1" xref="S3.SS4.p3.11.m5.1.1.cmml"><mi id="S3.SS4.p3.11.m5.1.1.2" xref="S3.SS4.p3.11.m5.1.1.2.cmml">n</mi><mi id="S3.SS4.p3.11.m5.1.1.3" xref="S3.SS4.p3.11.m5.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.11.m5.1b"><apply id="S3.SS4.p3.11.m5.1.1.cmml" xref="S3.SS4.p3.11.m5.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.11.m5.1.1.1.cmml" xref="S3.SS4.p3.11.m5.1.1">subscript</csymbol><ci id="S3.SS4.p3.11.m5.1.1.2.cmml" xref="S3.SS4.p3.11.m5.1.1.2">𝑛</ci><ci id="S3.SS4.p3.11.m5.1.1.3.cmml" xref="S3.SS4.p3.11.m5.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.11.m5.1c">n_{q}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.11.m5.1d">italic_n start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> is the number of query tokens.</p>
</div>
<div class="ltx_para" id="S3.SS4.p4">
<p class="ltx_p" id="S3.SS4.p4.4">For nuanced analysis of each document, the corresponding retrieval information embeddings are then prepended to the front of each document’s embeddings. They are external knowledge and function as an anchor, guiding the LLM to focus on useful documents. The final input embeddings can be arranged as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{E}=[\underbrace{\mathbf{e}_{1}^{q},\cdots,\mathbf{e}_{n_{q}}^{q}}_{%
\text{query}},\mathbf{e}^{R}_{1},\underbrace{\mathbf{e}_{1}^{d_{1}},\cdots,%
\mathbf{e}_{n_{d_{1}}}^{d_{1}}}_{\text{document}_{1}},\cdots,\mathbf{e}^{R}_{k%
},\underbrace{\mathbf{e}_{1}^{d_{k}},\cdots,\mathbf{e}_{n_{d_{k}}}^{d_{k}}}_{%
\text{document}_{k}}]," class="ltx_Math" display="block" id="S3.E5.m1.11"><semantics id="S3.E5.m1.11a"><mrow id="S3.E5.m1.11.11.1" xref="S3.E5.m1.11.11.1.1.cmml"><mrow id="S3.E5.m1.11.11.1.1" xref="S3.E5.m1.11.11.1.1.cmml"><mi id="S3.E5.m1.11.11.1.1.7" xref="S3.E5.m1.11.11.1.1.7.cmml">𝐄</mi><mo id="S3.E5.m1.11.11.1.1.6" xref="S3.E5.m1.11.11.1.1.6.cmml">=</mo><mrow id="S3.E5.m1.11.11.1.1.5.5" xref="S3.E5.m1.11.11.1.1.5.6.cmml"><mo id="S3.E5.m1.11.11.1.1.5.5.6" stretchy="false" xref="S3.E5.m1.11.11.1.1.5.6.cmml">[</mo><munder id="S3.E5.m1.11.11.1.1.1.1.1" xref="S3.E5.m1.11.11.1.1.1.1.1.cmml"><munder accentunder="true" id="S3.E5.m1.3.3" xref="S3.E5.m1.3.3.cmml"><mrow id="S3.E5.m1.3.3.3.3" xref="S3.E5.m1.3.3.3.4.cmml"><msubsup id="S3.E5.m1.2.2.2.2.1" xref="S3.E5.m1.2.2.2.2.1.cmml"><mi id="S3.E5.m1.2.2.2.2.1.2.2" xref="S3.E5.m1.2.2.2.2.1.2.2.cmml">𝐞</mi><mn id="S3.E5.m1.2.2.2.2.1.2.3" xref="S3.E5.m1.2.2.2.2.1.2.3.cmml">1</mn><mi id="S3.E5.m1.2.2.2.2.1.3" xref="S3.E5.m1.2.2.2.2.1.3.cmml">q</mi></msubsup><mo id="S3.E5.m1.3.3.3.3.3" xref="S3.E5.m1.3.3.3.4.cmml">,</mo><mi id="S3.E5.m1.1.1.1.1" mathvariant="normal" xref="S3.E5.m1.1.1.1.1.cmml">⋯</mi><mo id="S3.E5.m1.3.3.3.3.4" xref="S3.E5.m1.3.3.3.4.cmml">,</mo><msubsup id="S3.E5.m1.3.3.3.3.2" xref="S3.E5.m1.3.3.3.3.2.cmml"><mi id="S3.E5.m1.3.3.3.3.2.2.2" xref="S3.E5.m1.3.3.3.3.2.2.2.cmml">𝐞</mi><msub id="S3.E5.m1.3.3.3.3.2.2.3" xref="S3.E5.m1.3.3.3.3.2.2.3.cmml"><mi id="S3.E5.m1.3.3.3.3.2.2.3.2" xref="S3.E5.m1.3.3.3.3.2.2.3.2.cmml">n</mi><mi id="S3.E5.m1.3.3.3.3.2.2.3.3" xref="S3.E5.m1.3.3.3.3.2.2.3.3.cmml">q</mi></msub><mi id="S3.E5.m1.3.3.3.3.2.3" xref="S3.E5.m1.3.3.3.3.2.3.cmml">q</mi></msubsup></mrow><mo id="S3.E5.m1.3.3.4" xref="S3.E5.m1.3.3.4.cmml">⏟</mo></munder><mtext id="S3.E5.m1.11.11.1.1.1.1.1.2" xref="S3.E5.m1.11.11.1.1.1.1.1.2a.cmml">query</mtext></munder><mo id="S3.E5.m1.11.11.1.1.5.5.7" xref="S3.E5.m1.11.11.1.1.5.6.cmml">,</mo><msubsup id="S3.E5.m1.11.11.1.1.2.2.2" xref="S3.E5.m1.11.11.1.1.2.2.2.cmml"><mi id="S3.E5.m1.11.11.1.1.2.2.2.2.2" xref="S3.E5.m1.11.11.1.1.2.2.2.2.2.cmml">𝐞</mi><mn id="S3.E5.m1.11.11.1.1.2.2.2.3" xref="S3.E5.m1.11.11.1.1.2.2.2.3.cmml">1</mn><mi id="S3.E5.m1.11.11.1.1.2.2.2.2.3" xref="S3.E5.m1.11.11.1.1.2.2.2.2.3.cmml">R</mi></msubsup><mo id="S3.E5.m1.11.11.1.1.5.5.8" xref="S3.E5.m1.11.11.1.1.5.6.cmml">,</mo><munder id="S3.E5.m1.11.11.1.1.3.3.3" xref="S3.E5.m1.11.11.1.1.3.3.3.cmml"><munder accentunder="true" id="S3.E5.m1.6.6" xref="S3.E5.m1.6.6.cmml"><mrow id="S3.E5.m1.6.6.3.3" xref="S3.E5.m1.6.6.3.4.cmml"><msubsup id="S3.E5.m1.5.5.2.2.1" xref="S3.E5.m1.5.5.2.2.1.cmml"><mi id="S3.E5.m1.5.5.2.2.1.2.2" xref="S3.E5.m1.5.5.2.2.1.2.2.cmml">𝐞</mi><mn id="S3.E5.m1.5.5.2.2.1.2.3" xref="S3.E5.m1.5.5.2.2.1.2.3.cmml">1</mn><msub id="S3.E5.m1.5.5.2.2.1.3" xref="S3.E5.m1.5.5.2.2.1.3.cmml"><mi id="S3.E5.m1.5.5.2.2.1.3.2" xref="S3.E5.m1.5.5.2.2.1.3.2.cmml">d</mi><mn id="S3.E5.m1.5.5.2.2.1.3.3" xref="S3.E5.m1.5.5.2.2.1.3.3.cmml">1</mn></msub></msubsup><mo id="S3.E5.m1.6.6.3.3.3" xref="S3.E5.m1.6.6.3.4.cmml">,</mo><mi id="S3.E5.m1.4.4.1.1" mathvariant="normal" xref="S3.E5.m1.4.4.1.1.cmml">⋯</mi><mo id="S3.E5.m1.6.6.3.3.4" xref="S3.E5.m1.6.6.3.4.cmml">,</mo><msubsup id="S3.E5.m1.6.6.3.3.2" xref="S3.E5.m1.6.6.3.3.2.cmml"><mi id="S3.E5.m1.6.6.3.3.2.2.2" xref="S3.E5.m1.6.6.3.3.2.2.2.cmml">𝐞</mi><msub id="S3.E5.m1.6.6.3.3.2.2.3" xref="S3.E5.m1.6.6.3.3.2.2.3.cmml"><mi id="S3.E5.m1.6.6.3.3.2.2.3.2" xref="S3.E5.m1.6.6.3.3.2.2.3.2.cmml">n</mi><msub id="S3.E5.m1.6.6.3.3.2.2.3.3" xref="S3.E5.m1.6.6.3.3.2.2.3.3.cmml"><mi id="S3.E5.m1.6.6.3.3.2.2.3.3.2" xref="S3.E5.m1.6.6.3.3.2.2.3.3.2.cmml">d</mi><mn id="S3.E5.m1.6.6.3.3.2.2.3.3.3" xref="S3.E5.m1.6.6.3.3.2.2.3.3.3.cmml">1</mn></msub></msub><msub id="S3.E5.m1.6.6.3.3.2.3" xref="S3.E5.m1.6.6.3.3.2.3.cmml"><mi id="S3.E5.m1.6.6.3.3.2.3.2" xref="S3.E5.m1.6.6.3.3.2.3.2.cmml">d</mi><mn id="S3.E5.m1.6.6.3.3.2.3.3" xref="S3.E5.m1.6.6.3.3.2.3.3.cmml">1</mn></msub></msubsup></mrow><mo id="S3.E5.m1.6.6.4" xref="S3.E5.m1.6.6.4.cmml">⏟</mo></munder><msub id="S3.E5.m1.11.11.1.1.3.3.3.2" xref="S3.E5.m1.11.11.1.1.3.3.3.2.cmml"><mtext id="S3.E5.m1.11.11.1.1.3.3.3.2.2" xref="S3.E5.m1.11.11.1.1.3.3.3.2.2a.cmml">document</mtext><mn id="S3.E5.m1.11.11.1.1.3.3.3.2.3" xref="S3.E5.m1.11.11.1.1.3.3.3.2.3.cmml">1</mn></msub></munder><mo id="S3.E5.m1.11.11.1.1.5.5.9" xref="S3.E5.m1.11.11.1.1.5.6.cmml">,</mo><mi id="S3.E5.m1.10.10" mathvariant="normal" xref="S3.E5.m1.10.10.cmml">⋯</mi><mo id="S3.E5.m1.11.11.1.1.5.5.10" xref="S3.E5.m1.11.11.1.1.5.6.cmml">,</mo><msubsup id="S3.E5.m1.11.11.1.1.4.4.4" xref="S3.E5.m1.11.11.1.1.4.4.4.cmml"><mi id="S3.E5.m1.11.11.1.1.4.4.4.2.2" xref="S3.E5.m1.11.11.1.1.4.4.4.2.2.cmml">𝐞</mi><mi id="S3.E5.m1.11.11.1.1.4.4.4.3" xref="S3.E5.m1.11.11.1.1.4.4.4.3.cmml">k</mi><mi id="S3.E5.m1.11.11.1.1.4.4.4.2.3" xref="S3.E5.m1.11.11.1.1.4.4.4.2.3.cmml">R</mi></msubsup><mo id="S3.E5.m1.11.11.1.1.5.5.11" xref="S3.E5.m1.11.11.1.1.5.6.cmml">,</mo><munder id="S3.E5.m1.11.11.1.1.5.5.5" xref="S3.E5.m1.11.11.1.1.5.5.5.cmml"><munder accentunder="true" id="S3.E5.m1.9.9" xref="S3.E5.m1.9.9.cmml"><mrow id="S3.E5.m1.9.9.3.3" xref="S3.E5.m1.9.9.3.4.cmml"><msubsup id="S3.E5.m1.8.8.2.2.1" xref="S3.E5.m1.8.8.2.2.1.cmml"><mi id="S3.E5.m1.8.8.2.2.1.2.2" xref="S3.E5.m1.8.8.2.2.1.2.2.cmml">𝐞</mi><mn id="S3.E5.m1.8.8.2.2.1.2.3" xref="S3.E5.m1.8.8.2.2.1.2.3.cmml">1</mn><msub id="S3.E5.m1.8.8.2.2.1.3" xref="S3.E5.m1.8.8.2.2.1.3.cmml"><mi id="S3.E5.m1.8.8.2.2.1.3.2" xref="S3.E5.m1.8.8.2.2.1.3.2.cmml">d</mi><mi id="S3.E5.m1.8.8.2.2.1.3.3" xref="S3.E5.m1.8.8.2.2.1.3.3.cmml">k</mi></msub></msubsup><mo id="S3.E5.m1.9.9.3.3.3" xref="S3.E5.m1.9.9.3.4.cmml">,</mo><mi id="S3.E5.m1.7.7.1.1" mathvariant="normal" xref="S3.E5.m1.7.7.1.1.cmml">⋯</mi><mo id="S3.E5.m1.9.9.3.3.4" xref="S3.E5.m1.9.9.3.4.cmml">,</mo><msubsup id="S3.E5.m1.9.9.3.3.2" xref="S3.E5.m1.9.9.3.3.2.cmml"><mi id="S3.E5.m1.9.9.3.3.2.2.2" xref="S3.E5.m1.9.9.3.3.2.2.2.cmml">𝐞</mi><msub id="S3.E5.m1.9.9.3.3.2.2.3" xref="S3.E5.m1.9.9.3.3.2.2.3.cmml"><mi id="S3.E5.m1.9.9.3.3.2.2.3.2" xref="S3.E5.m1.9.9.3.3.2.2.3.2.cmml">n</mi><msub id="S3.E5.m1.9.9.3.3.2.2.3.3" xref="S3.E5.m1.9.9.3.3.2.2.3.3.cmml"><mi id="S3.E5.m1.9.9.3.3.2.2.3.3.2" xref="S3.E5.m1.9.9.3.3.2.2.3.3.2.cmml">d</mi><mi id="S3.E5.m1.9.9.3.3.2.2.3.3.3" xref="S3.E5.m1.9.9.3.3.2.2.3.3.3.cmml">k</mi></msub></msub><msub id="S3.E5.m1.9.9.3.3.2.3" xref="S3.E5.m1.9.9.3.3.2.3.cmml"><mi id="S3.E5.m1.9.9.3.3.2.3.2" xref="S3.E5.m1.9.9.3.3.2.3.2.cmml">d</mi><mi id="S3.E5.m1.9.9.3.3.2.3.3" xref="S3.E5.m1.9.9.3.3.2.3.3.cmml">k</mi></msub></msubsup></mrow><mo id="S3.E5.m1.9.9.4" xref="S3.E5.m1.9.9.4.cmml">⏟</mo></munder><msub id="S3.E5.m1.11.11.1.1.5.5.5.2" xref="S3.E5.m1.11.11.1.1.5.5.5.2.cmml"><mtext id="S3.E5.m1.11.11.1.1.5.5.5.2.2" xref="S3.E5.m1.11.11.1.1.5.5.5.2.2a.cmml">document</mtext><mi id="S3.E5.m1.11.11.1.1.5.5.5.2.3" xref="S3.E5.m1.11.11.1.1.5.5.5.2.3.cmml">k</mi></msub></munder><mo id="S3.E5.m1.11.11.1.1.5.5.12" stretchy="false" xref="S3.E5.m1.11.11.1.1.5.6.cmml">]</mo></mrow></mrow><mo id="S3.E5.m1.11.11.1.2" xref="S3.E5.m1.11.11.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.11b"><apply id="S3.E5.m1.11.11.1.1.cmml" xref="S3.E5.m1.11.11.1"><eq id="S3.E5.m1.11.11.1.1.6.cmml" xref="S3.E5.m1.11.11.1.1.6"></eq><ci id="S3.E5.m1.11.11.1.1.7.cmml" xref="S3.E5.m1.11.11.1.1.7">𝐄</ci><list id="S3.E5.m1.11.11.1.1.5.6.cmml" xref="S3.E5.m1.11.11.1.1.5.5"><apply id="S3.E5.m1.11.11.1.1.1.1.1.cmml" xref="S3.E5.m1.11.11.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.11.11.1.1.1.1.1.1.cmml" xref="S3.E5.m1.11.11.1.1.1.1.1">subscript</csymbol><apply id="S3.E5.m1.3.3.cmml" xref="S3.E5.m1.3.3"><ci id="S3.E5.m1.3.3.4.cmml" xref="S3.E5.m1.3.3.4">⏟</ci><list id="S3.E5.m1.3.3.3.4.cmml" xref="S3.E5.m1.3.3.3.3"><apply id="S3.E5.m1.2.2.2.2.1.cmml" xref="S3.E5.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.2.2.1.1.cmml" xref="S3.E5.m1.2.2.2.2.1">superscript</csymbol><apply id="S3.E5.m1.2.2.2.2.1.2.cmml" xref="S3.E5.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.2.2.1.2.1.cmml" xref="S3.E5.m1.2.2.2.2.1">subscript</csymbol><ci id="S3.E5.m1.2.2.2.2.1.2.2.cmml" xref="S3.E5.m1.2.2.2.2.1.2.2">𝐞</ci><cn id="S3.E5.m1.2.2.2.2.1.2.3.cmml" type="integer" xref="S3.E5.m1.2.2.2.2.1.2.3">1</cn></apply><ci id="S3.E5.m1.2.2.2.2.1.3.cmml" xref="S3.E5.m1.2.2.2.2.1.3">𝑞</ci></apply><ci id="S3.E5.m1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1">⋯</ci><apply id="S3.E5.m1.3.3.3.3.2.cmml" xref="S3.E5.m1.3.3.3.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.3.3.2.1.cmml" xref="S3.E5.m1.3.3.3.3.2">superscript</csymbol><apply id="S3.E5.m1.3.3.3.3.2.2.cmml" xref="S3.E5.m1.3.3.3.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.3.3.2.2.1.cmml" xref="S3.E5.m1.3.3.3.3.2">subscript</csymbol><ci id="S3.E5.m1.3.3.3.3.2.2.2.cmml" xref="S3.E5.m1.3.3.3.3.2.2.2">𝐞</ci><apply id="S3.E5.m1.3.3.3.3.2.2.3.cmml" xref="S3.E5.m1.3.3.3.3.2.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.3.3.2.2.3.1.cmml" xref="S3.E5.m1.3.3.3.3.2.2.3">subscript</csymbol><ci id="S3.E5.m1.3.3.3.3.2.2.3.2.cmml" xref="S3.E5.m1.3.3.3.3.2.2.3.2">𝑛</ci><ci id="S3.E5.m1.3.3.3.3.2.2.3.3.cmml" xref="S3.E5.m1.3.3.3.3.2.2.3.3">𝑞</ci></apply></apply><ci id="S3.E5.m1.3.3.3.3.2.3.cmml" xref="S3.E5.m1.3.3.3.3.2.3">𝑞</ci></apply></list></apply><ci id="S3.E5.m1.11.11.1.1.1.1.1.2a.cmml" xref="S3.E5.m1.11.11.1.1.1.1.1.2"><mtext id="S3.E5.m1.11.11.1.1.1.1.1.2.cmml" mathsize="70%" xref="S3.E5.m1.11.11.1.1.1.1.1.2">query</mtext></ci></apply><apply id="S3.E5.m1.11.11.1.1.2.2.2.cmml" xref="S3.E5.m1.11.11.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.11.11.1.1.2.2.2.1.cmml" xref="S3.E5.m1.11.11.1.1.2.2.2">subscript</csymbol><apply id="S3.E5.m1.11.11.1.1.2.2.2.2.cmml" xref="S3.E5.m1.11.11.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.11.11.1.1.2.2.2.2.1.cmml" xref="S3.E5.m1.11.11.1.1.2.2.2">superscript</csymbol><ci id="S3.E5.m1.11.11.1.1.2.2.2.2.2.cmml" xref="S3.E5.m1.11.11.1.1.2.2.2.2.2">𝐞</ci><ci id="S3.E5.m1.11.11.1.1.2.2.2.2.3.cmml" xref="S3.E5.m1.11.11.1.1.2.2.2.2.3">𝑅</ci></apply><cn id="S3.E5.m1.11.11.1.1.2.2.2.3.cmml" type="integer" xref="S3.E5.m1.11.11.1.1.2.2.2.3">1</cn></apply><apply id="S3.E5.m1.11.11.1.1.3.3.3.cmml" xref="S3.E5.m1.11.11.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.11.11.1.1.3.3.3.1.cmml" xref="S3.E5.m1.11.11.1.1.3.3.3">subscript</csymbol><apply id="S3.E5.m1.6.6.cmml" xref="S3.E5.m1.6.6"><ci id="S3.E5.m1.6.6.4.cmml" xref="S3.E5.m1.6.6.4">⏟</ci><list id="S3.E5.m1.6.6.3.4.cmml" xref="S3.E5.m1.6.6.3.3"><apply id="S3.E5.m1.5.5.2.2.1.cmml" xref="S3.E5.m1.5.5.2.2.1"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.2.2.1.1.cmml" xref="S3.E5.m1.5.5.2.2.1">superscript</csymbol><apply id="S3.E5.m1.5.5.2.2.1.2.cmml" xref="S3.E5.m1.5.5.2.2.1"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.2.2.1.2.1.cmml" xref="S3.E5.m1.5.5.2.2.1">subscript</csymbol><ci id="S3.E5.m1.5.5.2.2.1.2.2.cmml" xref="S3.E5.m1.5.5.2.2.1.2.2">𝐞</ci><cn id="S3.E5.m1.5.5.2.2.1.2.3.cmml" type="integer" xref="S3.E5.m1.5.5.2.2.1.2.3">1</cn></apply><apply id="S3.E5.m1.5.5.2.2.1.3.cmml" xref="S3.E5.m1.5.5.2.2.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.2.2.1.3.1.cmml" xref="S3.E5.m1.5.5.2.2.1.3">subscript</csymbol><ci id="S3.E5.m1.5.5.2.2.1.3.2.cmml" xref="S3.E5.m1.5.5.2.2.1.3.2">𝑑</ci><cn id="S3.E5.m1.5.5.2.2.1.3.3.cmml" type="integer" xref="S3.E5.m1.5.5.2.2.1.3.3">1</cn></apply></apply><ci id="S3.E5.m1.4.4.1.1.cmml" xref="S3.E5.m1.4.4.1.1">⋯</ci><apply id="S3.E5.m1.6.6.3.3.2.cmml" xref="S3.E5.m1.6.6.3.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.6.6.3.3.2.1.cmml" xref="S3.E5.m1.6.6.3.3.2">superscript</csymbol><apply id="S3.E5.m1.6.6.3.3.2.2.cmml" xref="S3.E5.m1.6.6.3.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.6.6.3.3.2.2.1.cmml" xref="S3.E5.m1.6.6.3.3.2">subscript</csymbol><ci id="S3.E5.m1.6.6.3.3.2.2.2.cmml" xref="S3.E5.m1.6.6.3.3.2.2.2">𝐞</ci><apply id="S3.E5.m1.6.6.3.3.2.2.3.cmml" xref="S3.E5.m1.6.6.3.3.2.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.6.6.3.3.2.2.3.1.cmml" xref="S3.E5.m1.6.6.3.3.2.2.3">subscript</csymbol><ci id="S3.E5.m1.6.6.3.3.2.2.3.2.cmml" xref="S3.E5.m1.6.6.3.3.2.2.3.2">𝑛</ci><apply id="S3.E5.m1.6.6.3.3.2.2.3.3.cmml" xref="S3.E5.m1.6.6.3.3.2.2.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.6.6.3.3.2.2.3.3.1.cmml" xref="S3.E5.m1.6.6.3.3.2.2.3.3">subscript</csymbol><ci id="S3.E5.m1.6.6.3.3.2.2.3.3.2.cmml" xref="S3.E5.m1.6.6.3.3.2.2.3.3.2">𝑑</ci><cn id="S3.E5.m1.6.6.3.3.2.2.3.3.3.cmml" type="integer" xref="S3.E5.m1.6.6.3.3.2.2.3.3.3">1</cn></apply></apply></apply><apply id="S3.E5.m1.6.6.3.3.2.3.cmml" xref="S3.E5.m1.6.6.3.3.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.6.6.3.3.2.3.1.cmml" xref="S3.E5.m1.6.6.3.3.2.3">subscript</csymbol><ci id="S3.E5.m1.6.6.3.3.2.3.2.cmml" xref="S3.E5.m1.6.6.3.3.2.3.2">𝑑</ci><cn id="S3.E5.m1.6.6.3.3.2.3.3.cmml" type="integer" xref="S3.E5.m1.6.6.3.3.2.3.3">1</cn></apply></apply></list></apply><apply id="S3.E5.m1.11.11.1.1.3.3.3.2.cmml" xref="S3.E5.m1.11.11.1.1.3.3.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.11.11.1.1.3.3.3.2.1.cmml" xref="S3.E5.m1.11.11.1.1.3.3.3.2">subscript</csymbol><ci id="S3.E5.m1.11.11.1.1.3.3.3.2.2a.cmml" xref="S3.E5.m1.11.11.1.1.3.3.3.2.2"><mtext id="S3.E5.m1.11.11.1.1.3.3.3.2.2.cmml" mathsize="70%" xref="S3.E5.m1.11.11.1.1.3.3.3.2.2">document</mtext></ci><cn id="S3.E5.m1.11.11.1.1.3.3.3.2.3.cmml" type="integer" xref="S3.E5.m1.11.11.1.1.3.3.3.2.3">1</cn></apply></apply><ci id="S3.E5.m1.10.10.cmml" xref="S3.E5.m1.10.10">⋯</ci><apply id="S3.E5.m1.11.11.1.1.4.4.4.cmml" xref="S3.E5.m1.11.11.1.1.4.4.4"><csymbol cd="ambiguous" id="S3.E5.m1.11.11.1.1.4.4.4.1.cmml" xref="S3.E5.m1.11.11.1.1.4.4.4">subscript</csymbol><apply id="S3.E5.m1.11.11.1.1.4.4.4.2.cmml" xref="S3.E5.m1.11.11.1.1.4.4.4"><csymbol cd="ambiguous" id="S3.E5.m1.11.11.1.1.4.4.4.2.1.cmml" xref="S3.E5.m1.11.11.1.1.4.4.4">superscript</csymbol><ci id="S3.E5.m1.11.11.1.1.4.4.4.2.2.cmml" xref="S3.E5.m1.11.11.1.1.4.4.4.2.2">𝐞</ci><ci id="S3.E5.m1.11.11.1.1.4.4.4.2.3.cmml" xref="S3.E5.m1.11.11.1.1.4.4.4.2.3">𝑅</ci></apply><ci id="S3.E5.m1.11.11.1.1.4.4.4.3.cmml" xref="S3.E5.m1.11.11.1.1.4.4.4.3">𝑘</ci></apply><apply id="S3.E5.m1.11.11.1.1.5.5.5.cmml" xref="S3.E5.m1.11.11.1.1.5.5.5"><csymbol cd="ambiguous" id="S3.E5.m1.11.11.1.1.5.5.5.1.cmml" xref="S3.E5.m1.11.11.1.1.5.5.5">subscript</csymbol><apply id="S3.E5.m1.9.9.cmml" xref="S3.E5.m1.9.9"><ci id="S3.E5.m1.9.9.4.cmml" xref="S3.E5.m1.9.9.4">⏟</ci><list id="S3.E5.m1.9.9.3.4.cmml" xref="S3.E5.m1.9.9.3.3"><apply id="S3.E5.m1.8.8.2.2.1.cmml" xref="S3.E5.m1.8.8.2.2.1"><csymbol cd="ambiguous" id="S3.E5.m1.8.8.2.2.1.1.cmml" xref="S3.E5.m1.8.8.2.2.1">superscript</csymbol><apply id="S3.E5.m1.8.8.2.2.1.2.cmml" xref="S3.E5.m1.8.8.2.2.1"><csymbol cd="ambiguous" id="S3.E5.m1.8.8.2.2.1.2.1.cmml" xref="S3.E5.m1.8.8.2.2.1">subscript</csymbol><ci id="S3.E5.m1.8.8.2.2.1.2.2.cmml" xref="S3.E5.m1.8.8.2.2.1.2.2">𝐞</ci><cn id="S3.E5.m1.8.8.2.2.1.2.3.cmml" type="integer" xref="S3.E5.m1.8.8.2.2.1.2.3">1</cn></apply><apply id="S3.E5.m1.8.8.2.2.1.3.cmml" xref="S3.E5.m1.8.8.2.2.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.8.8.2.2.1.3.1.cmml" xref="S3.E5.m1.8.8.2.2.1.3">subscript</csymbol><ci id="S3.E5.m1.8.8.2.2.1.3.2.cmml" xref="S3.E5.m1.8.8.2.2.1.3.2">𝑑</ci><ci id="S3.E5.m1.8.8.2.2.1.3.3.cmml" xref="S3.E5.m1.8.8.2.2.1.3.3">𝑘</ci></apply></apply><ci id="S3.E5.m1.7.7.1.1.cmml" xref="S3.E5.m1.7.7.1.1">⋯</ci><apply id="S3.E5.m1.9.9.3.3.2.cmml" xref="S3.E5.m1.9.9.3.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.9.9.3.3.2.1.cmml" xref="S3.E5.m1.9.9.3.3.2">superscript</csymbol><apply id="S3.E5.m1.9.9.3.3.2.2.cmml" xref="S3.E5.m1.9.9.3.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.9.9.3.3.2.2.1.cmml" xref="S3.E5.m1.9.9.3.3.2">subscript</csymbol><ci id="S3.E5.m1.9.9.3.3.2.2.2.cmml" xref="S3.E5.m1.9.9.3.3.2.2.2">𝐞</ci><apply id="S3.E5.m1.9.9.3.3.2.2.3.cmml" xref="S3.E5.m1.9.9.3.3.2.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.9.9.3.3.2.2.3.1.cmml" xref="S3.E5.m1.9.9.3.3.2.2.3">subscript</csymbol><ci id="S3.E5.m1.9.9.3.3.2.2.3.2.cmml" xref="S3.E5.m1.9.9.3.3.2.2.3.2">𝑛</ci><apply id="S3.E5.m1.9.9.3.3.2.2.3.3.cmml" xref="S3.E5.m1.9.9.3.3.2.2.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.9.9.3.3.2.2.3.3.1.cmml" xref="S3.E5.m1.9.9.3.3.2.2.3.3">subscript</csymbol><ci id="S3.E5.m1.9.9.3.3.2.2.3.3.2.cmml" xref="S3.E5.m1.9.9.3.3.2.2.3.3.2">𝑑</ci><ci id="S3.E5.m1.9.9.3.3.2.2.3.3.3.cmml" xref="S3.E5.m1.9.9.3.3.2.2.3.3.3">𝑘</ci></apply></apply></apply><apply id="S3.E5.m1.9.9.3.3.2.3.cmml" xref="S3.E5.m1.9.9.3.3.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.9.9.3.3.2.3.1.cmml" xref="S3.E5.m1.9.9.3.3.2.3">subscript</csymbol><ci id="S3.E5.m1.9.9.3.3.2.3.2.cmml" xref="S3.E5.m1.9.9.3.3.2.3.2">𝑑</ci><ci id="S3.E5.m1.9.9.3.3.2.3.3.cmml" xref="S3.E5.m1.9.9.3.3.2.3.3">𝑘</ci></apply></apply></list></apply><apply id="S3.E5.m1.11.11.1.1.5.5.5.2.cmml" xref="S3.E5.m1.11.11.1.1.5.5.5.2"><csymbol cd="ambiguous" id="S3.E5.m1.11.11.1.1.5.5.5.2.1.cmml" xref="S3.E5.m1.11.11.1.1.5.5.5.2">subscript</csymbol><ci id="S3.E5.m1.11.11.1.1.5.5.5.2.2a.cmml" xref="S3.E5.m1.11.11.1.1.5.5.5.2.2"><mtext id="S3.E5.m1.11.11.1.1.5.5.5.2.2.cmml" mathsize="70%" xref="S3.E5.m1.11.11.1.1.5.5.5.2.2">document</mtext></ci><ci id="S3.E5.m1.11.11.1.1.5.5.5.2.3.cmml" xref="S3.E5.m1.11.11.1.1.5.5.5.2.3">𝑘</ci></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.11c">\mathbf{E}=[\underbrace{\mathbf{e}_{1}^{q},\cdots,\mathbf{e}_{n_{q}}^{q}}_{%
\text{query}},\mathbf{e}^{R}_{1},\underbrace{\mathbf{e}_{1}^{d_{1}},\cdots,%
\mathbf{e}_{n_{d_{1}}}^{d_{1}}}_{\text{document}_{1}},\cdots,\mathbf{e}^{R}_{k%
},\underbrace{\mathbf{e}_{1}^{d_{k}},\cdots,\mathbf{e}_{n_{d_{k}}}^{d_{k}}}_{%
\text{document}_{k}}],</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.11d">bold_E = [ under⏟ start_ARG bold_e start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT , ⋯ , bold_e start_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT end_ARG start_POSTSUBSCRIPT query end_POSTSUBSCRIPT , bold_e start_POSTSUPERSCRIPT italic_R end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , under⏟ start_ARG bold_e start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT , ⋯ , bold_e start_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT end_ARG start_POSTSUBSCRIPT document start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , ⋯ , bold_e start_POSTSUPERSCRIPT italic_R end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , under⏟ start_ARG bold_e start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUPERSCRIPT , ⋯ , bold_e start_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUPERSCRIPT end_ARG start_POSTSUBSCRIPT document start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.p4.2">where <math alttext="\mathbf{e}_{i}^{R}" class="ltx_Math" display="inline" id="S3.SS4.p4.1.m1.1"><semantics id="S3.SS4.p4.1.m1.1a"><msubsup id="S3.SS4.p4.1.m1.1.1" xref="S3.SS4.p4.1.m1.1.1.cmml"><mi id="S3.SS4.p4.1.m1.1.1.2.2" xref="S3.SS4.p4.1.m1.1.1.2.2.cmml">𝐞</mi><mi id="S3.SS4.p4.1.m1.1.1.2.3" xref="S3.SS4.p4.1.m1.1.1.2.3.cmml">i</mi><mi id="S3.SS4.p4.1.m1.1.1.3" xref="S3.SS4.p4.1.m1.1.1.3.cmml">R</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.1.m1.1b"><apply id="S3.SS4.p4.1.m1.1.1.cmml" xref="S3.SS4.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p4.1.m1.1.1.1.cmml" xref="S3.SS4.p4.1.m1.1.1">superscript</csymbol><apply id="S3.SS4.p4.1.m1.1.1.2.cmml" xref="S3.SS4.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p4.1.m1.1.1.2.1.cmml" xref="S3.SS4.p4.1.m1.1.1">subscript</csymbol><ci id="S3.SS4.p4.1.m1.1.1.2.2.cmml" xref="S3.SS4.p4.1.m1.1.1.2.2">𝐞</ci><ci id="S3.SS4.p4.1.m1.1.1.2.3.cmml" xref="S3.SS4.p4.1.m1.1.1.2.3">𝑖</ci></apply><ci id="S3.SS4.p4.1.m1.1.1.3.cmml" xref="S3.SS4.p4.1.m1.1.1.3">𝑅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.1.m1.1c">\mathbf{e}_{i}^{R}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p4.1.m1.1d">bold_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_R end_POSTSUPERSCRIPT</annotation></semantics></math> denotes the retrieval information embedding for the <math alttext="i" class="ltx_Math" display="inline" id="S3.SS4.p4.2.m2.1"><semantics id="S3.SS4.p4.2.m2.1a"><mi id="S3.SS4.p4.2.m2.1.1" xref="S3.SS4.p4.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.2.m2.1b"><ci id="S3.SS4.p4.2.m2.1.1.cmml" xref="S3.SS4.p4.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.2.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p4.2.m2.1d">italic_i</annotation></semantics></math>-th document. In this way, the retrieval information of corresponding document can be well mixed, reducing the burden of the LLM to process all documents. Finally, we can get the responses by:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{y}=f_{\mathbf{G}}(\mathbf{E})," class="ltx_Math" display="block" id="S3.E6.m1.2"><semantics id="S3.E6.m1.2a"><mrow id="S3.E6.m1.2.2.1" xref="S3.E6.m1.2.2.1.1.cmml"><mrow id="S3.E6.m1.2.2.1.1" xref="S3.E6.m1.2.2.1.1.cmml"><mover accent="true" id="S3.E6.m1.2.2.1.1.2" xref="S3.E6.m1.2.2.1.1.2.cmml"><mi id="S3.E6.m1.2.2.1.1.2.2" xref="S3.E6.m1.2.2.1.1.2.2.cmml">y</mi><mo id="S3.E6.m1.2.2.1.1.2.1" xref="S3.E6.m1.2.2.1.1.2.1.cmml">^</mo></mover><mo id="S3.E6.m1.2.2.1.1.1" xref="S3.E6.m1.2.2.1.1.1.cmml">=</mo><mrow id="S3.E6.m1.2.2.1.1.3" xref="S3.E6.m1.2.2.1.1.3.cmml"><msub id="S3.E6.m1.2.2.1.1.3.2" xref="S3.E6.m1.2.2.1.1.3.2.cmml"><mi id="S3.E6.m1.2.2.1.1.3.2.2" xref="S3.E6.m1.2.2.1.1.3.2.2.cmml">f</mi><mi id="S3.E6.m1.2.2.1.1.3.2.3" xref="S3.E6.m1.2.2.1.1.3.2.3.cmml">𝐆</mi></msub><mo id="S3.E6.m1.2.2.1.1.3.1" xref="S3.E6.m1.2.2.1.1.3.1.cmml">⁢</mo><mrow id="S3.E6.m1.2.2.1.1.3.3.2" xref="S3.E6.m1.2.2.1.1.3.cmml"><mo id="S3.E6.m1.2.2.1.1.3.3.2.1" stretchy="false" xref="S3.E6.m1.2.2.1.1.3.cmml">(</mo><mi id="S3.E6.m1.1.1" xref="S3.E6.m1.1.1.cmml">𝐄</mi><mo id="S3.E6.m1.2.2.1.1.3.3.2.2" stretchy="false" xref="S3.E6.m1.2.2.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E6.m1.2.2.1.2" xref="S3.E6.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.2b"><apply id="S3.E6.m1.2.2.1.1.cmml" xref="S3.E6.m1.2.2.1"><eq id="S3.E6.m1.2.2.1.1.1.cmml" xref="S3.E6.m1.2.2.1.1.1"></eq><apply id="S3.E6.m1.2.2.1.1.2.cmml" xref="S3.E6.m1.2.2.1.1.2"><ci id="S3.E6.m1.2.2.1.1.2.1.cmml" xref="S3.E6.m1.2.2.1.1.2.1">^</ci><ci id="S3.E6.m1.2.2.1.1.2.2.cmml" xref="S3.E6.m1.2.2.1.1.2.2">𝑦</ci></apply><apply id="S3.E6.m1.2.2.1.1.3.cmml" xref="S3.E6.m1.2.2.1.1.3"><times id="S3.E6.m1.2.2.1.1.3.1.cmml" xref="S3.E6.m1.2.2.1.1.3.1"></times><apply id="S3.E6.m1.2.2.1.1.3.2.cmml" xref="S3.E6.m1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.1.1.3.2.1.cmml" xref="S3.E6.m1.2.2.1.1.3.2">subscript</csymbol><ci id="S3.E6.m1.2.2.1.1.3.2.2.cmml" xref="S3.E6.m1.2.2.1.1.3.2.2">𝑓</ci><ci id="S3.E6.m1.2.2.1.1.3.2.3.cmml" xref="S3.E6.m1.2.2.1.1.3.2.3">𝐆</ci></apply><ci id="S3.E6.m1.1.1.cmml" xref="S3.E6.m1.1.1">𝐄</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.2c">\hat{y}=f_{\mathbf{G}}(\mathbf{E}),</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.2d">over^ start_ARG italic_y end_ARG = italic_f start_POSTSUBSCRIPT bold_G end_POSTSUBSCRIPT ( bold_E ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.p4.3">where <math alttext="\hat{y}" class="ltx_Math" display="inline" id="S3.SS4.p4.3.m1.1"><semantics id="S3.SS4.p4.3.m1.1a"><mover accent="true" id="S3.SS4.p4.3.m1.1.1" xref="S3.SS4.p4.3.m1.1.1.cmml"><mi id="S3.SS4.p4.3.m1.1.1.2" xref="S3.SS4.p4.3.m1.1.1.2.cmml">y</mi><mo id="S3.SS4.p4.3.m1.1.1.1" xref="S3.SS4.p4.3.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.3.m1.1b"><apply id="S3.SS4.p4.3.m1.1.1.cmml" xref="S3.SS4.p4.3.m1.1.1"><ci id="S3.SS4.p4.3.m1.1.1.1.cmml" xref="S3.SS4.p4.3.m1.1.1.1">^</ci><ci id="S3.SS4.p4.3.m1.1.1.2.cmml" xref="S3.SS4.p4.3.m1.1.1.2">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.3.m1.1c">\hat{y}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p4.3.m1.1d">over^ start_ARG italic_y end_ARG</annotation></semantics></math> represents the LLM-generated results. Notably, this part simplifies the instruction prompt, and detailed descriptions and prompt templates can be found in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#A2" title="Appendix B Prompt Templates ‣ R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_tag">B</span></a>.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.5 </span>Training Strategy</h3>
<div class="ltx_para" id="S3.SS5.p1">
<p class="ltx_p" id="S3.SS5.p1.2">As the interdependence of retrieval and generation, we integrate R<sup class="ltx_sup" id="S3.SS5.p1.2.1">2</sup>-Former training and LLM alignment into one stage. The joint training allows R<sup class="ltx_sup" id="S3.SS5.p1.2.2">2</sup>-Former to better understand list-wise features from the retriever, ensuring retrieval information can be deeply interpreted by the LLM.</p>
</div>
<div class="ltx_para" id="S3.SS5.p2">
<p class="ltx_p" id="S3.SS5.p2.2">For R<sup class="ltx_sup" id="S3.SS5.p2.2.1">2</sup>-Former training, we perform a query-document matching (QDM) task that enforces R<sup class="ltx_sup" id="S3.SS5.p2.2.2">2</sup>-Former to learn the relevance relationships from list-wise features. In detail, it is a binary classification task that asks to model each document’s relevance to the query. The formula for prediction is as follows:</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S3.E7">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E7X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\hat{\mathbf{s}}=f_{\rightarrow 1}(\mathbf{H})=\{\hat{s}_{i}\}_{i%
=1}^{k}," class="ltx_Math" display="inline" id="S3.E7X.2.1.1.m1.2"><semantics id="S3.E7X.2.1.1.m1.2a"><mrow id="S3.E7X.2.1.1.m1.2.2.1" xref="S3.E7X.2.1.1.m1.2.2.1.1.cmml"><mrow id="S3.E7X.2.1.1.m1.2.2.1.1" xref="S3.E7X.2.1.1.m1.2.2.1.1.cmml"><mover accent="true" id="S3.E7X.2.1.1.m1.2.2.1.1.3" xref="S3.E7X.2.1.1.m1.2.2.1.1.3.cmml"><mi id="S3.E7X.2.1.1.m1.2.2.1.1.3.2" xref="S3.E7X.2.1.1.m1.2.2.1.1.3.2.cmml">𝐬</mi><mo id="S3.E7X.2.1.1.m1.2.2.1.1.3.1" xref="S3.E7X.2.1.1.m1.2.2.1.1.3.1.cmml">^</mo></mover><mo id="S3.E7X.2.1.1.m1.2.2.1.1.4" xref="S3.E7X.2.1.1.m1.2.2.1.1.4.cmml">=</mo><mrow id="S3.E7X.2.1.1.m1.2.2.1.1.5" xref="S3.E7X.2.1.1.m1.2.2.1.1.5.cmml"><msub id="S3.E7X.2.1.1.m1.2.2.1.1.5.2" xref="S3.E7X.2.1.1.m1.2.2.1.1.5.2.cmml"><mi id="S3.E7X.2.1.1.m1.2.2.1.1.5.2.2" xref="S3.E7X.2.1.1.m1.2.2.1.1.5.2.2.cmml">f</mi><mrow id="S3.E7X.2.1.1.m1.2.2.1.1.5.2.3" xref="S3.E7X.2.1.1.m1.2.2.1.1.5.2.3.cmml"><mi id="S3.E7X.2.1.1.m1.2.2.1.1.5.2.3.2" xref="S3.E7X.2.1.1.m1.2.2.1.1.5.2.3.2.cmml"></mi><mo id="S3.E7X.2.1.1.m1.2.2.1.1.5.2.3.1" stretchy="false" xref="S3.E7X.2.1.1.m1.2.2.1.1.5.2.3.1.cmml">→</mo><mn id="S3.E7X.2.1.1.m1.2.2.1.1.5.2.3.3" xref="S3.E7X.2.1.1.m1.2.2.1.1.5.2.3.3.cmml">1</mn></mrow></msub><mo id="S3.E7X.2.1.1.m1.2.2.1.1.5.1" xref="S3.E7X.2.1.1.m1.2.2.1.1.5.1.cmml">⁢</mo><mrow id="S3.E7X.2.1.1.m1.2.2.1.1.5.3.2" xref="S3.E7X.2.1.1.m1.2.2.1.1.5.cmml"><mo id="S3.E7X.2.1.1.m1.2.2.1.1.5.3.2.1" stretchy="false" xref="S3.E7X.2.1.1.m1.2.2.1.1.5.cmml">(</mo><mi id="S3.E7X.2.1.1.m1.1.1" xref="S3.E7X.2.1.1.m1.1.1.cmml">𝐇</mi><mo id="S3.E7X.2.1.1.m1.2.2.1.1.5.3.2.2" stretchy="false" xref="S3.E7X.2.1.1.m1.2.2.1.1.5.cmml">)</mo></mrow></mrow><mo id="S3.E7X.2.1.1.m1.2.2.1.1.6" xref="S3.E7X.2.1.1.m1.2.2.1.1.6.cmml">=</mo><msubsup id="S3.E7X.2.1.1.m1.2.2.1.1.1" xref="S3.E7X.2.1.1.m1.2.2.1.1.1.cmml"><mrow id="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.1" xref="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.2.cmml"><mo id="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.1.2" stretchy="false" xref="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.2.cmml">{</mo><msub id="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.1.1" xref="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.1.1.2" xref="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.2" xref="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.2.cmml">s</mi><mo id="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.1" xref="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.1.1.3" xref="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.1.3" stretchy="false" xref="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.E7X.2.1.1.m1.2.2.1.1.1.1.3" xref="S3.E7X.2.1.1.m1.2.2.1.1.1.1.3.cmml"><mi id="S3.E7X.2.1.1.m1.2.2.1.1.1.1.3.2" xref="S3.E7X.2.1.1.m1.2.2.1.1.1.1.3.2.cmml">i</mi><mo id="S3.E7X.2.1.1.m1.2.2.1.1.1.1.3.1" xref="S3.E7X.2.1.1.m1.2.2.1.1.1.1.3.1.cmml">=</mo><mn id="S3.E7X.2.1.1.m1.2.2.1.1.1.1.3.3" xref="S3.E7X.2.1.1.m1.2.2.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.E7X.2.1.1.m1.2.2.1.1.1.3" xref="S3.E7X.2.1.1.m1.2.2.1.1.1.3.cmml">k</mi></msubsup></mrow><mo id="S3.E7X.2.1.1.m1.2.2.1.2" xref="S3.E7X.2.1.1.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7X.2.1.1.m1.2b"><apply id="S3.E7X.2.1.1.m1.2.2.1.1.cmml" xref="S3.E7X.2.1.1.m1.2.2.1"><and id="S3.E7X.2.1.1.m1.2.2.1.1a.cmml" xref="S3.E7X.2.1.1.m1.2.2.1"></and><apply id="S3.E7X.2.1.1.m1.2.2.1.1b.cmml" xref="S3.E7X.2.1.1.m1.2.2.1"><eq id="S3.E7X.2.1.1.m1.2.2.1.1.4.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.4"></eq><apply id="S3.E7X.2.1.1.m1.2.2.1.1.3.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.3"><ci id="S3.E7X.2.1.1.m1.2.2.1.1.3.1.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.3.1">^</ci><ci id="S3.E7X.2.1.1.m1.2.2.1.1.3.2.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.3.2">𝐬</ci></apply><apply id="S3.E7X.2.1.1.m1.2.2.1.1.5.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.5"><times id="S3.E7X.2.1.1.m1.2.2.1.1.5.1.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.5.1"></times><apply id="S3.E7X.2.1.1.m1.2.2.1.1.5.2.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.5.2"><csymbol cd="ambiguous" id="S3.E7X.2.1.1.m1.2.2.1.1.5.2.1.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.5.2">subscript</csymbol><ci id="S3.E7X.2.1.1.m1.2.2.1.1.5.2.2.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.5.2.2">𝑓</ci><apply id="S3.E7X.2.1.1.m1.2.2.1.1.5.2.3.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.5.2.3"><ci id="S3.E7X.2.1.1.m1.2.2.1.1.5.2.3.1.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.5.2.3.1">→</ci><csymbol cd="latexml" id="S3.E7X.2.1.1.m1.2.2.1.1.5.2.3.2.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.5.2.3.2">absent</csymbol><cn id="S3.E7X.2.1.1.m1.2.2.1.1.5.2.3.3.cmml" type="integer" xref="S3.E7X.2.1.1.m1.2.2.1.1.5.2.3.3">1</cn></apply></apply><ci id="S3.E7X.2.1.1.m1.1.1.cmml" xref="S3.E7X.2.1.1.m1.1.1">𝐇</ci></apply></apply><apply id="S3.E7X.2.1.1.m1.2.2.1.1c.cmml" xref="S3.E7X.2.1.1.m1.2.2.1"><eq id="S3.E7X.2.1.1.m1.2.2.1.1.6.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.6"></eq><share href="https://arxiv.org/html/2406.13249v1#S3.E7X.2.1.1.m1.2.2.1.1.5.cmml" id="S3.E7X.2.1.1.m1.2.2.1.1d.cmml" xref="S3.E7X.2.1.1.m1.2.2.1"></share><apply id="S3.E7X.2.1.1.m1.2.2.1.1.1.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E7X.2.1.1.m1.2.2.1.1.1.2.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.1">superscript</csymbol><apply id="S3.E7X.2.1.1.m1.2.2.1.1.1.1.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E7X.2.1.1.m1.2.2.1.1.1.1.2.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.1">subscript</csymbol><set id="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.1"><apply id="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.1.1.2"><ci id="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.1">^</ci><ci id="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.2">𝑠</ci></apply><ci id="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S3.E7X.2.1.1.m1.2.2.1.1.1.1.3.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.1.1.3"><eq id="S3.E7X.2.1.1.m1.2.2.1.1.1.1.3.1.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.1.1.3.1"></eq><ci id="S3.E7X.2.1.1.m1.2.2.1.1.1.1.3.2.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.1.1.3.2">𝑖</ci><cn id="S3.E7X.2.1.1.m1.2.2.1.1.1.1.3.3.cmml" type="integer" xref="S3.E7X.2.1.1.m1.2.2.1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.E7X.2.1.1.m1.2.2.1.1.1.3.cmml" xref="S3.E7X.2.1.1.m1.2.2.1.1.1.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7X.2.1.1.m1.2c">\displaystyle\hat{\mathbf{s}}=f_{\rightarrow 1}(\mathbf{H})=\{\hat{s}_{i}\}_{i%
=1}^{k},</annotation><annotation encoding="application/x-llamapun" id="S3.E7X.2.1.1.m1.2d">over^ start_ARG bold_s end_ARG = italic_f start_POSTSUBSCRIPT → 1 end_POSTSUBSCRIPT ( bold_H ) = { over^ start_ARG italic_s end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(7)</span></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S3.SS5.p2.5">where <math alttext="f_{\rightarrow 1}" class="ltx_Math" display="inline" id="S3.SS5.p2.3.m1.1"><semantics id="S3.SS5.p2.3.m1.1a"><msub id="S3.SS5.p2.3.m1.1.1" xref="S3.SS5.p2.3.m1.1.1.cmml"><mi id="S3.SS5.p2.3.m1.1.1.2" xref="S3.SS5.p2.3.m1.1.1.2.cmml">f</mi><mrow id="S3.SS5.p2.3.m1.1.1.3" xref="S3.SS5.p2.3.m1.1.1.3.cmml"><mi id="S3.SS5.p2.3.m1.1.1.3.2" xref="S3.SS5.p2.3.m1.1.1.3.2.cmml"></mi><mo id="S3.SS5.p2.3.m1.1.1.3.1" stretchy="false" xref="S3.SS5.p2.3.m1.1.1.3.1.cmml">→</mo><mn id="S3.SS5.p2.3.m1.1.1.3.3" xref="S3.SS5.p2.3.m1.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.p2.3.m1.1b"><apply id="S3.SS5.p2.3.m1.1.1.cmml" xref="S3.SS5.p2.3.m1.1.1"><csymbol cd="ambiguous" id="S3.SS5.p2.3.m1.1.1.1.cmml" xref="S3.SS5.p2.3.m1.1.1">subscript</csymbol><ci id="S3.SS5.p2.3.m1.1.1.2.cmml" xref="S3.SS5.p2.3.m1.1.1.2">𝑓</ci><apply id="S3.SS5.p2.3.m1.1.1.3.cmml" xref="S3.SS5.p2.3.m1.1.1.3"><ci id="S3.SS5.p2.3.m1.1.1.3.1.cmml" xref="S3.SS5.p2.3.m1.1.1.3.1">→</ci><csymbol cd="latexml" id="S3.SS5.p2.3.m1.1.1.3.2.cmml" xref="S3.SS5.p2.3.m1.1.1.3.2">absent</csymbol><cn id="S3.SS5.p2.3.m1.1.1.3.3.cmml" type="integer" xref="S3.SS5.p2.3.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p2.3.m1.1c">f_{\rightarrow 1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p2.3.m1.1d">italic_f start_POSTSUBSCRIPT → 1 end_POSTSUBSCRIPT</annotation></semantics></math> is a binary classification head that outputs the relevance predictions <math alttext="\hat{\mathbf{s}}" class="ltx_Math" display="inline" id="S3.SS5.p2.4.m2.1"><semantics id="S3.SS5.p2.4.m2.1a"><mover accent="true" id="S3.SS5.p2.4.m2.1.1" xref="S3.SS5.p2.4.m2.1.1.cmml"><mi id="S3.SS5.p2.4.m2.1.1.2" xref="S3.SS5.p2.4.m2.1.1.2.cmml">𝐬</mi><mo id="S3.SS5.p2.4.m2.1.1.1" xref="S3.SS5.p2.4.m2.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS5.p2.4.m2.1b"><apply id="S3.SS5.p2.4.m2.1.1.cmml" xref="S3.SS5.p2.4.m2.1.1"><ci id="S3.SS5.p2.4.m2.1.1.1.cmml" xref="S3.SS5.p2.4.m2.1.1.1">^</ci><ci id="S3.SS5.p2.4.m2.1.1.2.cmml" xref="S3.SS5.p2.4.m2.1.1.2">𝐬</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p2.4.m2.1c">\hat{\mathbf{s}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p2.4.m2.1d">over^ start_ARG bold_s end_ARG</annotation></semantics></math>. Supporting <math alttext="\mathbf{s}{=}\{s_{i}\}^{k}_{i=1}" class="ltx_Math" display="inline" id="S3.SS5.p2.5.m3.1"><semantics id="S3.SS5.p2.5.m3.1a"><mrow id="S3.SS5.p2.5.m3.1.1" xref="S3.SS5.p2.5.m3.1.1.cmml"><mi id="S3.SS5.p2.5.m3.1.1.3" xref="S3.SS5.p2.5.m3.1.1.3.cmml">𝐬</mi><mo id="S3.SS5.p2.5.m3.1.1.2" xref="S3.SS5.p2.5.m3.1.1.2.cmml">=</mo><msubsup id="S3.SS5.p2.5.m3.1.1.1" xref="S3.SS5.p2.5.m3.1.1.1.cmml"><mrow id="S3.SS5.p2.5.m3.1.1.1.1.1.1" xref="S3.SS5.p2.5.m3.1.1.1.1.1.2.cmml"><mo id="S3.SS5.p2.5.m3.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS5.p2.5.m3.1.1.1.1.1.2.cmml">{</mo><msub id="S3.SS5.p2.5.m3.1.1.1.1.1.1.1" xref="S3.SS5.p2.5.m3.1.1.1.1.1.1.1.cmml"><mi id="S3.SS5.p2.5.m3.1.1.1.1.1.1.1.2" xref="S3.SS5.p2.5.m3.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S3.SS5.p2.5.m3.1.1.1.1.1.1.1.3" xref="S3.SS5.p2.5.m3.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS5.p2.5.m3.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS5.p2.5.m3.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS5.p2.5.m3.1.1.1.3" xref="S3.SS5.p2.5.m3.1.1.1.3.cmml"><mi id="S3.SS5.p2.5.m3.1.1.1.3.2" xref="S3.SS5.p2.5.m3.1.1.1.3.2.cmml">i</mi><mo id="S3.SS5.p2.5.m3.1.1.1.3.1" xref="S3.SS5.p2.5.m3.1.1.1.3.1.cmml">=</mo><mn id="S3.SS5.p2.5.m3.1.1.1.3.3" xref="S3.SS5.p2.5.m3.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.SS5.p2.5.m3.1.1.1.1.3" xref="S3.SS5.p2.5.m3.1.1.1.1.3.cmml">k</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS5.p2.5.m3.1b"><apply id="S3.SS5.p2.5.m3.1.1.cmml" xref="S3.SS5.p2.5.m3.1.1"><eq id="S3.SS5.p2.5.m3.1.1.2.cmml" xref="S3.SS5.p2.5.m3.1.1.2"></eq><ci id="S3.SS5.p2.5.m3.1.1.3.cmml" xref="S3.SS5.p2.5.m3.1.1.3">𝐬</ci><apply id="S3.SS5.p2.5.m3.1.1.1.cmml" xref="S3.SS5.p2.5.m3.1.1.1"><csymbol cd="ambiguous" id="S3.SS5.p2.5.m3.1.1.1.2.cmml" xref="S3.SS5.p2.5.m3.1.1.1">subscript</csymbol><apply id="S3.SS5.p2.5.m3.1.1.1.1.cmml" xref="S3.SS5.p2.5.m3.1.1.1"><csymbol cd="ambiguous" id="S3.SS5.p2.5.m3.1.1.1.1.2.cmml" xref="S3.SS5.p2.5.m3.1.1.1">superscript</csymbol><set id="S3.SS5.p2.5.m3.1.1.1.1.1.2.cmml" xref="S3.SS5.p2.5.m3.1.1.1.1.1.1"><apply id="S3.SS5.p2.5.m3.1.1.1.1.1.1.1.cmml" xref="S3.SS5.p2.5.m3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS5.p2.5.m3.1.1.1.1.1.1.1.1.cmml" xref="S3.SS5.p2.5.m3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS5.p2.5.m3.1.1.1.1.1.1.1.2.cmml" xref="S3.SS5.p2.5.m3.1.1.1.1.1.1.1.2">𝑠</ci><ci id="S3.SS5.p2.5.m3.1.1.1.1.1.1.1.3.cmml" xref="S3.SS5.p2.5.m3.1.1.1.1.1.1.1.3">𝑖</ci></apply></set><ci id="S3.SS5.p2.5.m3.1.1.1.1.3.cmml" xref="S3.SS5.p2.5.m3.1.1.1.1.3">𝑘</ci></apply><apply id="S3.SS5.p2.5.m3.1.1.1.3.cmml" xref="S3.SS5.p2.5.m3.1.1.1.3"><eq id="S3.SS5.p2.5.m3.1.1.1.3.1.cmml" xref="S3.SS5.p2.5.m3.1.1.1.3.1"></eq><ci id="S3.SS5.p2.5.m3.1.1.1.3.2.cmml" xref="S3.SS5.p2.5.m3.1.1.1.3.2">𝑖</ci><cn id="S3.SS5.p2.5.m3.1.1.1.3.3.cmml" type="integer" xref="S3.SS5.p2.5.m3.1.1.1.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p2.5.m3.1c">\mathbf{s}{=}\{s_{i}\}^{k}_{i=1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p2.5.m3.1d">bold_s = { italic_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT</annotation></semantics></math> are the ground-truth labels for documents, we use cross-entropy as the loss function, defined as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{QDM}(\mathbf{s},\hat{\mathbf{s}})={-}\sum_{i=1}^{k}s_{i}\log(\hat%
{s}_{i}){+}(1{-}s_{i})\log(1{-}\hat{s}_{i})." class="ltx_Math" display="block" id="S3.E8.m1.5"><semantics id="S3.E8.m1.5a"><mrow id="S3.E8.m1.5.5.1" xref="S3.E8.m1.5.5.1.1.cmml"><mrow id="S3.E8.m1.5.5.1.1" xref="S3.E8.m1.5.5.1.1.cmml"><mrow id="S3.E8.m1.5.5.1.1.5" xref="S3.E8.m1.5.5.1.1.5.cmml"><msub id="S3.E8.m1.5.5.1.1.5.2" xref="S3.E8.m1.5.5.1.1.5.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.5.5.1.1.5.2.2" xref="S3.E8.m1.5.5.1.1.5.2.2.cmml">ℒ</mi><mrow id="S3.E8.m1.5.5.1.1.5.2.3" xref="S3.E8.m1.5.5.1.1.5.2.3.cmml"><mi id="S3.E8.m1.5.5.1.1.5.2.3.2" xref="S3.E8.m1.5.5.1.1.5.2.3.2.cmml">Q</mi><mo id="S3.E8.m1.5.5.1.1.5.2.3.1" xref="S3.E8.m1.5.5.1.1.5.2.3.1.cmml">⁢</mo><mi id="S3.E8.m1.5.5.1.1.5.2.3.3" xref="S3.E8.m1.5.5.1.1.5.2.3.3.cmml">D</mi><mo id="S3.E8.m1.5.5.1.1.5.2.3.1a" xref="S3.E8.m1.5.5.1.1.5.2.3.1.cmml">⁢</mo><mi id="S3.E8.m1.5.5.1.1.5.2.3.4" xref="S3.E8.m1.5.5.1.1.5.2.3.4.cmml">M</mi></mrow></msub><mo id="S3.E8.m1.5.5.1.1.5.1" xref="S3.E8.m1.5.5.1.1.5.1.cmml">⁢</mo><mrow id="S3.E8.m1.5.5.1.1.5.3.2" xref="S3.E8.m1.5.5.1.1.5.3.1.cmml"><mo id="S3.E8.m1.5.5.1.1.5.3.2.1" stretchy="false" xref="S3.E8.m1.5.5.1.1.5.3.1.cmml">(</mo><mi id="S3.E8.m1.1.1" xref="S3.E8.m1.1.1.cmml">𝐬</mi><mo id="S3.E8.m1.5.5.1.1.5.3.2.2" xref="S3.E8.m1.5.5.1.1.5.3.1.cmml">,</mo><mover accent="true" id="S3.E8.m1.2.2" xref="S3.E8.m1.2.2.cmml"><mi id="S3.E8.m1.2.2.2" xref="S3.E8.m1.2.2.2.cmml">𝐬</mi><mo id="S3.E8.m1.2.2.1" xref="S3.E8.m1.2.2.1.cmml">^</mo></mover><mo id="S3.E8.m1.5.5.1.1.5.3.2.3" stretchy="false" xref="S3.E8.m1.5.5.1.1.5.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E8.m1.5.5.1.1.4" xref="S3.E8.m1.5.5.1.1.4.cmml">=</mo><mrow id="S3.E8.m1.5.5.1.1.3" xref="S3.E8.m1.5.5.1.1.3.cmml"><mrow id="S3.E8.m1.5.5.1.1.1.1" xref="S3.E8.m1.5.5.1.1.1.1.cmml"><mo id="S3.E8.m1.5.5.1.1.1.1a" xref="S3.E8.m1.5.5.1.1.1.1.cmml">−</mo><mrow id="S3.E8.m1.5.5.1.1.1.1.1" xref="S3.E8.m1.5.5.1.1.1.1.1.cmml"><munderover id="S3.E8.m1.5.5.1.1.1.1.1.2" xref="S3.E8.m1.5.5.1.1.1.1.1.2.cmml"><mo id="S3.E8.m1.5.5.1.1.1.1.1.2.2.2" movablelimits="false" xref="S3.E8.m1.5.5.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E8.m1.5.5.1.1.1.1.1.2.2.3" xref="S3.E8.m1.5.5.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E8.m1.5.5.1.1.1.1.1.2.2.3.2" xref="S3.E8.m1.5.5.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.E8.m1.5.5.1.1.1.1.1.2.2.3.1" xref="S3.E8.m1.5.5.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E8.m1.5.5.1.1.1.1.1.2.2.3.3" xref="S3.E8.m1.5.5.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E8.m1.5.5.1.1.1.1.1.2.3" xref="S3.E8.m1.5.5.1.1.1.1.1.2.3.cmml">k</mi></munderover><mrow id="S3.E8.m1.5.5.1.1.1.1.1.1" xref="S3.E8.m1.5.5.1.1.1.1.1.1.cmml"><msub id="S3.E8.m1.5.5.1.1.1.1.1.1.3" xref="S3.E8.m1.5.5.1.1.1.1.1.1.3.cmml"><mi id="S3.E8.m1.5.5.1.1.1.1.1.1.3.2" xref="S3.E8.m1.5.5.1.1.1.1.1.1.3.2.cmml">s</mi><mi id="S3.E8.m1.5.5.1.1.1.1.1.1.3.3" xref="S3.E8.m1.5.5.1.1.1.1.1.1.3.3.cmml">i</mi></msub><mo id="S3.E8.m1.5.5.1.1.1.1.1.1.2" lspace="0.167em" xref="S3.E8.m1.5.5.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E8.m1.3.3" xref="S3.E8.m1.3.3.cmml">log</mi><mo id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1a" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.2.cmml">(</mo><msub id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2.cmml">s</mi><mo id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.1" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.E8.m1.5.5.1.1.3.4" xref="S3.E8.m1.5.5.1.1.3.4.cmml">+</mo><mrow id="S3.E8.m1.5.5.1.1.3.3" xref="S3.E8.m1.5.5.1.1.3.3.cmml"><mrow id="S3.E8.m1.5.5.1.1.2.2.1.1" xref="S3.E8.m1.5.5.1.1.2.2.1.1.1.cmml"><mo id="S3.E8.m1.5.5.1.1.2.2.1.1.2" stretchy="false" xref="S3.E8.m1.5.5.1.1.2.2.1.1.1.cmml">(</mo><mrow id="S3.E8.m1.5.5.1.1.2.2.1.1.1" xref="S3.E8.m1.5.5.1.1.2.2.1.1.1.cmml"><mn id="S3.E8.m1.5.5.1.1.2.2.1.1.1.2" xref="S3.E8.m1.5.5.1.1.2.2.1.1.1.2.cmml">1</mn><mo id="S3.E8.m1.5.5.1.1.2.2.1.1.1.1" xref="S3.E8.m1.5.5.1.1.2.2.1.1.1.1.cmml">−</mo><msub id="S3.E8.m1.5.5.1.1.2.2.1.1.1.3" xref="S3.E8.m1.5.5.1.1.2.2.1.1.1.3.cmml"><mi id="S3.E8.m1.5.5.1.1.2.2.1.1.1.3.2" xref="S3.E8.m1.5.5.1.1.2.2.1.1.1.3.2.cmml">s</mi><mi id="S3.E8.m1.5.5.1.1.2.2.1.1.1.3.3" xref="S3.E8.m1.5.5.1.1.2.2.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S3.E8.m1.5.5.1.1.2.2.1.1.3" stretchy="false" xref="S3.E8.m1.5.5.1.1.2.2.1.1.1.cmml">)</mo></mrow><mo id="S3.E8.m1.5.5.1.1.3.3.3" lspace="0.167em" xref="S3.E8.m1.5.5.1.1.3.3.3.cmml">⁢</mo><mrow id="S3.E8.m1.5.5.1.1.3.3.2.1" xref="S3.E8.m1.5.5.1.1.3.3.2.2.cmml"><mi id="S3.E8.m1.4.4" xref="S3.E8.m1.4.4.cmml">log</mi><mo id="S3.E8.m1.5.5.1.1.3.3.2.1a" xref="S3.E8.m1.5.5.1.1.3.3.2.2.cmml">⁡</mo><mrow id="S3.E8.m1.5.5.1.1.3.3.2.1.1" xref="S3.E8.m1.5.5.1.1.3.3.2.2.cmml"><mo id="S3.E8.m1.5.5.1.1.3.3.2.1.1.2" stretchy="false" xref="S3.E8.m1.5.5.1.1.3.3.2.2.cmml">(</mo><mrow id="S3.E8.m1.5.5.1.1.3.3.2.1.1.1" xref="S3.E8.m1.5.5.1.1.3.3.2.1.1.1.cmml"><mn id="S3.E8.m1.5.5.1.1.3.3.2.1.1.1.2" xref="S3.E8.m1.5.5.1.1.3.3.2.1.1.1.2.cmml">1</mn><mo id="S3.E8.m1.5.5.1.1.3.3.2.1.1.1.1" xref="S3.E8.m1.5.5.1.1.3.3.2.1.1.1.1.cmml">−</mo><msub id="S3.E8.m1.5.5.1.1.3.3.2.1.1.1.3" xref="S3.E8.m1.5.5.1.1.3.3.2.1.1.1.3.cmml"><mover accent="true" id="S3.E8.m1.5.5.1.1.3.3.2.1.1.1.3.2" xref="S3.E8.m1.5.5.1.1.3.3.2.1.1.1.3.2.cmml"><mi id="S3.E8.m1.5.5.1.1.3.3.2.1.1.1.3.2.2" xref="S3.E8.m1.5.5.1.1.3.3.2.1.1.1.3.2.2.cmml">s</mi><mo id="S3.E8.m1.5.5.1.1.3.3.2.1.1.1.3.2.1" xref="S3.E8.m1.5.5.1.1.3.3.2.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S3.E8.m1.5.5.1.1.3.3.2.1.1.1.3.3" xref="S3.E8.m1.5.5.1.1.3.3.2.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S3.E8.m1.5.5.1.1.3.3.2.1.1.3" stretchy="false" xref="S3.E8.m1.5.5.1.1.3.3.2.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.E8.m1.5.5.1.2" lspace="0em" xref="S3.E8.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.5b"><apply id="S3.E8.m1.5.5.1.1.cmml" xref="S3.E8.m1.5.5.1"><eq id="S3.E8.m1.5.5.1.1.4.cmml" xref="S3.E8.m1.5.5.1.1.4"></eq><apply id="S3.E8.m1.5.5.1.1.5.cmml" xref="S3.E8.m1.5.5.1.1.5"><times id="S3.E8.m1.5.5.1.1.5.1.cmml" xref="S3.E8.m1.5.5.1.1.5.1"></times><apply id="S3.E8.m1.5.5.1.1.5.2.cmml" xref="S3.E8.m1.5.5.1.1.5.2"><csymbol cd="ambiguous" id="S3.E8.m1.5.5.1.1.5.2.1.cmml" xref="S3.E8.m1.5.5.1.1.5.2">subscript</csymbol><ci id="S3.E8.m1.5.5.1.1.5.2.2.cmml" xref="S3.E8.m1.5.5.1.1.5.2.2">ℒ</ci><apply id="S3.E8.m1.5.5.1.1.5.2.3.cmml" xref="S3.E8.m1.5.5.1.1.5.2.3"><times id="S3.E8.m1.5.5.1.1.5.2.3.1.cmml" xref="S3.E8.m1.5.5.1.1.5.2.3.1"></times><ci id="S3.E8.m1.5.5.1.1.5.2.3.2.cmml" xref="S3.E8.m1.5.5.1.1.5.2.3.2">𝑄</ci><ci id="S3.E8.m1.5.5.1.1.5.2.3.3.cmml" xref="S3.E8.m1.5.5.1.1.5.2.3.3">𝐷</ci><ci id="S3.E8.m1.5.5.1.1.5.2.3.4.cmml" xref="S3.E8.m1.5.5.1.1.5.2.3.4">𝑀</ci></apply></apply><interval closure="open" id="S3.E8.m1.5.5.1.1.5.3.1.cmml" xref="S3.E8.m1.5.5.1.1.5.3.2"><ci id="S3.E8.m1.1.1.cmml" xref="S3.E8.m1.1.1">𝐬</ci><apply id="S3.E8.m1.2.2.cmml" xref="S3.E8.m1.2.2"><ci id="S3.E8.m1.2.2.1.cmml" xref="S3.E8.m1.2.2.1">^</ci><ci id="S3.E8.m1.2.2.2.cmml" xref="S3.E8.m1.2.2.2">𝐬</ci></apply></interval></apply><apply id="S3.E8.m1.5.5.1.1.3.cmml" xref="S3.E8.m1.5.5.1.1.3"><plus id="S3.E8.m1.5.5.1.1.3.4.cmml" xref="S3.E8.m1.5.5.1.1.3.4"></plus><apply id="S3.E8.m1.5.5.1.1.1.1.cmml" xref="S3.E8.m1.5.5.1.1.1.1"><minus id="S3.E8.m1.5.5.1.1.1.1.2.cmml" xref="S3.E8.m1.5.5.1.1.1.1"></minus><apply id="S3.E8.m1.5.5.1.1.1.1.1.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1"><apply id="S3.E8.m1.5.5.1.1.1.1.1.2.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E8.m1.5.5.1.1.1.1.1.2.1.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E8.m1.5.5.1.1.1.1.1.2.2.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E8.m1.5.5.1.1.1.1.1.2.2.1.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.2">subscript</csymbol><sum id="S3.E8.m1.5.5.1.1.1.1.1.2.2.2.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.2.2.2"></sum><apply id="S3.E8.m1.5.5.1.1.1.1.1.2.2.3.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.2.2.3"><eq id="S3.E8.m1.5.5.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.2.2.3.1"></eq><ci id="S3.E8.m1.5.5.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.2.2.3.2">𝑖</ci><cn id="S3.E8.m1.5.5.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.E8.m1.5.5.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E8.m1.5.5.1.1.1.1.1.2.3.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.2.3">𝑘</ci></apply><apply id="S3.E8.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.1"><times id="S3.E8.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.1.2"></times><apply id="S3.E8.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.5.5.1.1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E8.m1.5.5.1.1.1.1.1.1.3.2.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.1.3.2">𝑠</ci><ci id="S3.E8.m1.5.5.1.1.1.1.1.1.3.3.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.1.3.3">𝑖</ci></apply><apply id="S3.E8.m1.5.5.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.1"><log id="S3.E8.m1.3.3.cmml" xref="S3.E8.m1.3.3"></log><apply id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.2"><ci id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.1">^</ci><ci id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2">𝑠</ci></apply><ci id="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply></apply><apply id="S3.E8.m1.5.5.1.1.3.3.cmml" xref="S3.E8.m1.5.5.1.1.3.3"><times id="S3.E8.m1.5.5.1.1.3.3.3.cmml" xref="S3.E8.m1.5.5.1.1.3.3.3"></times><apply id="S3.E8.m1.5.5.1.1.2.2.1.1.1.cmml" xref="S3.E8.m1.5.5.1.1.2.2.1.1"><minus id="S3.E8.m1.5.5.1.1.2.2.1.1.1.1.cmml" xref="S3.E8.m1.5.5.1.1.2.2.1.1.1.1"></minus><cn id="S3.E8.m1.5.5.1.1.2.2.1.1.1.2.cmml" type="integer" xref="S3.E8.m1.5.5.1.1.2.2.1.1.1.2">1</cn><apply id="S3.E8.m1.5.5.1.1.2.2.1.1.1.3.cmml" xref="S3.E8.m1.5.5.1.1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.5.5.1.1.2.2.1.1.1.3.1.cmml" xref="S3.E8.m1.5.5.1.1.2.2.1.1.1.3">subscript</csymbol><ci id="S3.E8.m1.5.5.1.1.2.2.1.1.1.3.2.cmml" xref="S3.E8.m1.5.5.1.1.2.2.1.1.1.3.2">𝑠</ci><ci id="S3.E8.m1.5.5.1.1.2.2.1.1.1.3.3.cmml" xref="S3.E8.m1.5.5.1.1.2.2.1.1.1.3.3">𝑖</ci></apply></apply><apply id="S3.E8.m1.5.5.1.1.3.3.2.2.cmml" xref="S3.E8.m1.5.5.1.1.3.3.2.1"><log id="S3.E8.m1.4.4.cmml" xref="S3.E8.m1.4.4"></log><apply id="S3.E8.m1.5.5.1.1.3.3.2.1.1.1.cmml" xref="S3.E8.m1.5.5.1.1.3.3.2.1.1.1"><minus id="S3.E8.m1.5.5.1.1.3.3.2.1.1.1.1.cmml" xref="S3.E8.m1.5.5.1.1.3.3.2.1.1.1.1"></minus><cn id="S3.E8.m1.5.5.1.1.3.3.2.1.1.1.2.cmml" type="integer" xref="S3.E8.m1.5.5.1.1.3.3.2.1.1.1.2">1</cn><apply id="S3.E8.m1.5.5.1.1.3.3.2.1.1.1.3.cmml" xref="S3.E8.m1.5.5.1.1.3.3.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.5.5.1.1.3.3.2.1.1.1.3.1.cmml" xref="S3.E8.m1.5.5.1.1.3.3.2.1.1.1.3">subscript</csymbol><apply id="S3.E8.m1.5.5.1.1.3.3.2.1.1.1.3.2.cmml" xref="S3.E8.m1.5.5.1.1.3.3.2.1.1.1.3.2"><ci id="S3.E8.m1.5.5.1.1.3.3.2.1.1.1.3.2.1.cmml" xref="S3.E8.m1.5.5.1.1.3.3.2.1.1.1.3.2.1">^</ci><ci id="S3.E8.m1.5.5.1.1.3.3.2.1.1.1.3.2.2.cmml" xref="S3.E8.m1.5.5.1.1.3.3.2.1.1.1.3.2.2">𝑠</ci></apply><ci id="S3.E8.m1.5.5.1.1.3.3.2.1.1.1.3.3.cmml" xref="S3.E8.m1.5.5.1.1.3.3.2.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.5c">\mathcal{L}_{QDM}(\mathbf{s},\hat{\mathbf{s}})={-}\sum_{i=1}^{k}s_{i}\log(\hat%
{s}_{i}){+}(1{-}s_{i})\log(1{-}\hat{s}_{i}).</annotation><annotation encoding="application/x-llamapun" id="S3.E8.m1.5d">caligraphic_L start_POSTSUBSCRIPT italic_Q italic_D italic_M end_POSTSUBSCRIPT ( bold_s , over^ start_ARG bold_s end_ARG ) = - ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT italic_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT roman_log ( over^ start_ARG italic_s end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) + ( 1 - italic_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) roman_log ( 1 - over^ start_ARG italic_s end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS5.p3">
<p class="ltx_p" id="S3.SS5.p3.1">For LLM alignment, we utilize the language modeling (LM) task, which involves learning to generate subsequent tokens based on the preceding context and retrieval information. The language modeling loss <math alttext="\mathcal{L}_{LM}" class="ltx_Math" display="inline" id="S3.SS5.p3.1.m1.1"><semantics id="S3.SS5.p3.1.m1.1a"><msub id="S3.SS5.p3.1.m1.1.1" xref="S3.SS5.p3.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS5.p3.1.m1.1.1.2" xref="S3.SS5.p3.1.m1.1.1.2.cmml">ℒ</mi><mrow id="S3.SS5.p3.1.m1.1.1.3" xref="S3.SS5.p3.1.m1.1.1.3.cmml"><mi id="S3.SS5.p3.1.m1.1.1.3.2" xref="S3.SS5.p3.1.m1.1.1.3.2.cmml">L</mi><mo id="S3.SS5.p3.1.m1.1.1.3.1" xref="S3.SS5.p3.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS5.p3.1.m1.1.1.3.3" xref="S3.SS5.p3.1.m1.1.1.3.3.cmml">M</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.p3.1.m1.1b"><apply id="S3.SS5.p3.1.m1.1.1.cmml" xref="S3.SS5.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS5.p3.1.m1.1.1.1.cmml" xref="S3.SS5.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS5.p3.1.m1.1.1.2.cmml" xref="S3.SS5.p3.1.m1.1.1.2">ℒ</ci><apply id="S3.SS5.p3.1.m1.1.1.3.cmml" xref="S3.SS5.p3.1.m1.1.1.3"><times id="S3.SS5.p3.1.m1.1.1.3.1.cmml" xref="S3.SS5.p3.1.m1.1.1.3.1"></times><ci id="S3.SS5.p3.1.m1.1.1.3.2.cmml" xref="S3.SS5.p3.1.m1.1.1.3.2">𝐿</ci><ci id="S3.SS5.p3.1.m1.1.1.3.3.cmml" xref="S3.SS5.p3.1.m1.1.1.3.3">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p3.1.m1.1c">\mathcal{L}_{LM}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p3.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_L italic_M end_POSTSUBSCRIPT</annotation></semantics></math> aims to maximize the log-likelihood of the tokens, rewarding the LLM for predicting subsequent words correctly.</p>
</div>
<div class="ltx_para" id="S3.SS5.p4">
<p class="ltx_p" id="S3.SS5.p4.1">The joint training involves instruction fine-tuning with a linear combination of QDM and LM tasks. The final loss is expressed as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}=\mathcal{L}_{QDM}{+}\mathcal{L}_{LM}." class="ltx_Math" display="block" id="S3.E9.m1.1"><semantics id="S3.E9.m1.1a"><mrow id="S3.E9.m1.1.1.1" xref="S3.E9.m1.1.1.1.1.cmml"><mrow id="S3.E9.m1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E9.m1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.2.cmml">ℒ</mi><mo id="S3.E9.m1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E9.m1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.3.cmml"><msub id="S3.E9.m1.1.1.1.1.3.2" xref="S3.E9.m1.1.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E9.m1.1.1.1.1.3.2.2" xref="S3.E9.m1.1.1.1.1.3.2.2.cmml">ℒ</mi><mrow id="S3.E9.m1.1.1.1.1.3.2.3" xref="S3.E9.m1.1.1.1.1.3.2.3.cmml"><mi id="S3.E9.m1.1.1.1.1.3.2.3.2" xref="S3.E9.m1.1.1.1.1.3.2.3.2.cmml">Q</mi><mo id="S3.E9.m1.1.1.1.1.3.2.3.1" xref="S3.E9.m1.1.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.E9.m1.1.1.1.1.3.2.3.3" xref="S3.E9.m1.1.1.1.1.3.2.3.3.cmml">D</mi><mo id="S3.E9.m1.1.1.1.1.3.2.3.1a" xref="S3.E9.m1.1.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.E9.m1.1.1.1.1.3.2.3.4" xref="S3.E9.m1.1.1.1.1.3.2.3.4.cmml">M</mi></mrow></msub><mo id="S3.E9.m1.1.1.1.1.3.1" xref="S3.E9.m1.1.1.1.1.3.1.cmml">+</mo><msub id="S3.E9.m1.1.1.1.1.3.3" xref="S3.E9.m1.1.1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E9.m1.1.1.1.1.3.3.2" xref="S3.E9.m1.1.1.1.1.3.3.2.cmml">ℒ</mi><mrow id="S3.E9.m1.1.1.1.1.3.3.3" xref="S3.E9.m1.1.1.1.1.3.3.3.cmml"><mi id="S3.E9.m1.1.1.1.1.3.3.3.2" xref="S3.E9.m1.1.1.1.1.3.3.3.2.cmml">L</mi><mo id="S3.E9.m1.1.1.1.1.3.3.3.1" xref="S3.E9.m1.1.1.1.1.3.3.3.1.cmml">⁢</mo><mi id="S3.E9.m1.1.1.1.1.3.3.3.3" xref="S3.E9.m1.1.1.1.1.3.3.3.3.cmml">M</mi></mrow></msub></mrow></mrow><mo id="S3.E9.m1.1.1.1.2" lspace="0em" xref="S3.E9.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m1.1b"><apply id="S3.E9.m1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1"><eq id="S3.E9.m1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1"></eq><ci id="S3.E9.m1.1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.1.2">ℒ</ci><apply id="S3.E9.m1.1.1.1.1.3.cmml" xref="S3.E9.m1.1.1.1.1.3"><plus id="S3.E9.m1.1.1.1.1.3.1.cmml" xref="S3.E9.m1.1.1.1.1.3.1"></plus><apply id="S3.E9.m1.1.1.1.1.3.2.cmml" xref="S3.E9.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.3.2.1.cmml" xref="S3.E9.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E9.m1.1.1.1.1.3.2.2.cmml" xref="S3.E9.m1.1.1.1.1.3.2.2">ℒ</ci><apply id="S3.E9.m1.1.1.1.1.3.2.3.cmml" xref="S3.E9.m1.1.1.1.1.3.2.3"><times id="S3.E9.m1.1.1.1.1.3.2.3.1.cmml" xref="S3.E9.m1.1.1.1.1.3.2.3.1"></times><ci id="S3.E9.m1.1.1.1.1.3.2.3.2.cmml" xref="S3.E9.m1.1.1.1.1.3.2.3.2">𝑄</ci><ci id="S3.E9.m1.1.1.1.1.3.2.3.3.cmml" xref="S3.E9.m1.1.1.1.1.3.2.3.3">𝐷</ci><ci id="S3.E9.m1.1.1.1.1.3.2.3.4.cmml" xref="S3.E9.m1.1.1.1.1.3.2.3.4">𝑀</ci></apply></apply><apply id="S3.E9.m1.1.1.1.1.3.3.cmml" xref="S3.E9.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.3.3.1.cmml" xref="S3.E9.m1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E9.m1.1.1.1.1.3.3.2.cmml" xref="S3.E9.m1.1.1.1.1.3.3.2">ℒ</ci><apply id="S3.E9.m1.1.1.1.1.3.3.3.cmml" xref="S3.E9.m1.1.1.1.1.3.3.3"><times id="S3.E9.m1.1.1.1.1.3.3.3.1.cmml" xref="S3.E9.m1.1.1.1.1.3.3.3.1"></times><ci id="S3.E9.m1.1.1.1.1.3.3.3.2.cmml" xref="S3.E9.m1.1.1.1.1.3.3.3.2">𝐿</ci><ci id="S3.E9.m1.1.1.1.1.3.3.3.3.cmml" xref="S3.E9.m1.1.1.1.1.3.3.3.3">𝑀</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.1c">\mathcal{L}=\mathcal{L}_{QDM}{+}\mathcal{L}_{LM}.</annotation><annotation encoding="application/x-llamapun" id="S3.E9.m1.1d">caligraphic_L = caligraphic_L start_POSTSUBSCRIPT italic_Q italic_D italic_M end_POSTSUBSCRIPT + caligraphic_L start_POSTSUBSCRIPT italic_L italic_M end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS5.p5">
<p class="ltx_p" id="S3.SS5.p5.2">Notably, R<sup class="ltx_sup" id="S3.SS5.p5.2.1">2</sup>AG offers the flexibility to train the R<sup class="ltx_sup" id="S3.SS5.p5.2.2">2</sup>-Former solely while freezing the LLM or to train both together for a deeper understanding of retrieval information. The decision represents a trade-off between lower computational costs and higher accuracy in real-world scenarios.</p>
</div>
<div class="ltx_para" id="S3.SS5.p6">
<p class="ltx_p" id="S3.SS5.p6.1">The R<sup class="ltx_sup" id="S3.SS5.p6.1.1">2</sup>AG algorithm is detailed in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#A3" title="Appendix C R2AG Algorithm ‣ R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_tag">C</span></a>.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Datasets and Metrics</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">We evaluate R<sup class="ltx_sup" id="S4.SS1.p1.1.1">2</sup>AG on five datasets: Natural Questions (NQ) <cite class="ltx_cite ltx_citemacro_cite">Kwiatkowski et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib21" title="">2019</a>)</cite>, HotpotQA <cite class="ltx_cite ltx_citemacro_cite">Yang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib45" title="">2018</a>)</cite>, MuSiQue <cite class="ltx_cite ltx_citemacro_cite">Trivedi et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib36" title="">2021</a>)</cite>, 2WikiMultiHopQA (2Wiki) <cite class="ltx_cite ltx_citemacro_cite">Ho et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib13" title="">2020</a>)</cite>, and DuReader <cite class="ltx_cite ltx_citemacro_cite">He et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib11" title="">2018</a>)</cite>. For NQ dataset, we utilize NQ-10, NQ-20, and NQ-30 datasets built by <cite class="ltx_cite ltx_citemacro_citet">Liu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib27" title="">2023</a>)</cite>, which contain 10, 20, and 30 total documents, respectively. DuReader is a multiple documents QA version built by <cite class="ltx_cite ltx_citemacro_citet">Bai et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib4" title="">2023b</a>)</cite>. Detailed introduction and statistics are shown in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#A4" title="Appendix D Dataset Introduction ‣ R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_tag">D</span></a>.</p>
</div>
<div class="ltx_para" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.1">Following <cite class="ltx_cite ltx_citemacro_citet">Mallen et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib29" title="">2023</a>); Liu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib27" title="">2023</a>)</cite>, we adopt accuracy (Acc) as the evaluation metric for NQ datasets. Following <cite class="ltx_cite ltx_citemacro_citet">Bai et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib4" title="">2023b</a>)</cite>, we adopt accuracy (Acc) and F1 score as evaluation metrics for HotpotQA, MuSiQue, and 2Wiki datasets. For DuReader dataset, we measure performance by F1 score and Rouge <cite class="ltx_cite ltx_citemacro_cite">Lin (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib26" title="">2004</a>)</cite>.</p>
</div>
<figure class="ltx_table" id="S4.T1">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S4.T1.6">
<tr class="ltx_tr" id="S4.T1.6.7">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="S4.T1.6.7.1" rowspan="2"><span class="ltx_text ltx_font_bold" id="S4.T1.6.7.1.1">Methods</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.6.7.2"><span class="ltx_text ltx_font_bold" id="S4.T1.6.7.2.1">NQ-10</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.6.7.3"><span class="ltx_text ltx_font_bold" id="S4.T1.6.7.3.1">NQ-20</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S4.T1.6.7.4"><span class="ltx_text ltx_font_bold" id="S4.T1.6.7.4.1">NQ-30</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="2" id="S4.T1.6.7.5"><span class="ltx_text ltx_font_bold" id="S4.T1.6.7.5.1">HotpotQA</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="2" id="S4.T1.6.7.6"><span class="ltx_text ltx_font_bold" id="S4.T1.6.7.6.1">MuSiQue</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S4.T1.6.7.7"><span class="ltx_text ltx_font_bold" id="S4.T1.6.7.7.1">2Wiki</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.8">
<td class="ltx_td ltx_align_center" id="S4.T1.6.8.1"><span class="ltx_text ltx_font_bold" id="S4.T1.6.8.1.1">Acc</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.8.2"><span class="ltx_text ltx_font_bold" id="S4.T1.6.8.2.1">Acc</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.6.8.3"><span class="ltx_text ltx_font_bold" id="S4.T1.6.8.3.1">Acc</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.8.4"><span class="ltx_text ltx_font_bold" id="S4.T1.6.8.4.1">Acc</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.6.8.5"><span class="ltx_text ltx_font_bold" id="S4.T1.6.8.5.1">F1</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.8.6"><span class="ltx_text ltx_font_bold" id="S4.T1.6.8.6.1">Acc</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.6.8.7"><span class="ltx_text ltx_font_bold" id="S4.T1.6.8.7.1">F1</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.8.8"><span class="ltx_text ltx_font_bold" id="S4.T1.6.8.8.1">Acc</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.8.9"><span class="ltx_text ltx_font_bold" id="S4.T1.6.8.9.1">F1</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.9">
<td class="ltx_td ltx_align_center ltx_border_t" colspan="10" id="S4.T1.6.9.1"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S4.T1.6.9.1.1">Frozen LLMs</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.1">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T1.1.1.1">LLaMA2<sub class="ltx_sub" id="S4.T1.1.1.1.1"><span class="ltx_text ltx_font_italic" id="S4.T1.1.1.1.1.1">7B</span></sub>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.2" style="background-color:#D9D9D9;"><span class="ltx_text" id="S4.T1.1.1.2.1" style="background-color:#D9D9D9;">0.3898</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.3">-</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.1.4">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.5" style="background-color:#D9D9D9;"><span class="ltx_text" id="S4.T1.1.1.5.1" style="background-color:#D9D9D9;">0.2630</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.1.6" style="background-color:#D9D9D9;"><span class="ltx_text" id="S4.T1.1.1.6.1" style="background-color:#D9D9D9;">0.0852</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.7" style="background-color:#D9D9D9;"><span class="ltx_text" id="S4.T1.1.1.7.1" style="background-color:#D9D9D9;">0.0546</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.1.8" style="background-color:#D9D9D9;"><span class="ltx_text" id="S4.T1.1.1.8.1" style="background-color:#D9D9D9;">0.0241</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.9" style="background-color:#D9D9D9;"><span class="ltx_text" id="S4.T1.1.1.9.1" style="background-color:#D9D9D9;">0.1205</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.10" style="background-color:#D9D9D9;"><span class="ltx_text" id="S4.T1.1.1.10.1" style="background-color:#D9D9D9;">0.0634</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.2.2">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.2.2.1">LongChat1.5<sub class="ltx_sub" id="S4.T1.2.2.1.1"><span class="ltx_text ltx_font_italic" id="S4.T1.2.2.1.1.1">7B</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S4.T1.2.2.2">0.6045</td>
<td class="ltx_td ltx_align_center" id="S4.T1.2.2.3" style="background-color:#D9D9D9;"><span class="ltx_text" id="S4.T1.2.2.3.1" style="background-color:#D9D9D9;">0.5782</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.2.2.4" style="background-color:#D9D9D9;"><span class="ltx_text" id="S4.T1.2.2.4.1" style="background-color:#D9D9D9;">0.5198</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.2.2.5">0.5424</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.2.2.6">0.3231</td>
<td class="ltx_td ltx_align_center" id="S4.T1.2.2.7">0.2808</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.2.2.8">0.1276</td>
<td class="ltx_td ltx_align_center" id="S4.T1.2.2.9"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.2.2.9.1">0.3882</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.2.2.10"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.2.2.10.1">0.2253</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.3">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.3.3.1">LLaMA3<sub class="ltx_sub" id="S4.T1.3.3.1.1"><span class="ltx_text ltx_font_italic" id="S4.T1.3.3.1.1.1">8B</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.3.2">0.5141</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.3.3">0.4991</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.3.3.4">0.5311</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.3.5">0.5901</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.3.3.6">0.2056</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.3.7">0.2427</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.3.3.8">0.0891</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.3.9"><span class="ltx_text ltx_font_bold" id="S4.T1.3.3.9.1">0.4723</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.3.10">0.1952</td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.4">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.4.4.1">LLaMA2<sub class="ltx_sub" id="S4.T1.4.4.1.1"><span class="ltx_text ltx_font_italic" id="S4.T1.4.4.1.1.1">13B</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.4.2"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.4.4.2.1">0.7684</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.4.3">-</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.4.4.4">-</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.4.5">0.3788</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.4.4.6">0.1000</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.4.7">0.0909</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.4.4.8">0.0446</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.4.9">0.2405</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.4.10">0.0898</td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.10">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.6.10.1">ChatGPT</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.10.2"><span class="ltx_text" id="S4.T1.6.10.2.1" style="color:#808080;">0.6886</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.10.3"><span class="ltx_text" id="S4.T1.6.10.3.1" style="color:#808080;">0.6761</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.6.10.4"><span class="ltx_text" id="S4.T1.6.10.4.1" style="color:#808080;">0.6347</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.10.5"><span class="ltx_text" id="S4.T1.6.10.5.1" style="color:#808080;">0.6557</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.6.10.6"><span class="ltx_text ltx_font_bold" id="S4.T1.6.10.6.1" style="color:#808080;">0.6518</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.10.7"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.6.10.7.1" style="color:#808080;">0.3376</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.6.10.8"><span class="ltx_text ltx_font_bold" id="S4.T1.6.10.8.1" style="color:#808080;">0.3321</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.10.9"><span class="ltx_text" id="S4.T1.6.10.9.1" style="color:#808080;">-</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.10.10"><span class="ltx_text" id="S4.T1.6.10.10.1" style="color:#808080;">-</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.11">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.6.11.1">GPT4</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.11.2"><span class="ltx_text ltx_font_bold" id="S4.T1.6.11.2.1" style="color:#808080;">0.7759</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.11.3"><span class="ltx_text ltx_font_bold" id="S4.T1.6.11.3.1" style="color:#808080;">0.7514</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.6.11.4"><span class="ltx_text ltx_font_bold" id="S4.T1.6.11.4.1" style="color:#808080;">0.7514</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.11.5"><span class="ltx_text ltx_font_bold" id="S4.T1.6.11.5.1" style="color:#808080;">0.7673</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.6.11.6"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.6.11.6.1" style="color:#808080;">0.6026</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.11.7"><span class="ltx_text ltx_font_bold" id="S4.T1.6.11.7.1" style="color:#808080;">0.4853</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.6.11.8"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.6.11.8.1" style="color:#808080;">0.3270</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.11.9"><span class="ltx_text" id="S4.T1.6.11.9.1" style="color:#808080;">-</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.11.10"><span class="ltx_text" id="S4.T1.6.11.10.1" style="color:#808080;">-</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.12">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T1.6.12.1">CoT</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.12.2">0.4482</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.12.3">0.6026</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.6.12.4">0.5631</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.12.5">0.2365</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.6.12.6">0.1028</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.12.7">0.0626</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.6.12.8">0.0412</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.12.9">0.1627</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.12.10">0.0969</td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.13">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.6.13.1">RECOMP</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.13.2">0.0169</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.13.3">0.2222</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.6.13.4">0.1977</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.13.5">0.2388</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.6.13.6">0.0265</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.13.7">0.0830</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.6.13.8">0.0156</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.13.9">0.2666</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.13.10">0.0329</td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.14">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.6.14.1">CRAG</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.14.2">0.3974</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.14.3">0.6441</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.6.14.4">0.6347</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.14.5">0.1194</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.6.14.6">0.0360</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.14.7">0.0262</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.6.14.8">0.0047</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.14.9">0.0768</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.14.10">0.0422</td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.15">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.6.15.1">LongLLMLingua</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.15.2">0.3635</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.15.3">-</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.6.15.4">-</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.15.5">0.4174</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.6.15.6">0.1178</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.15.7">0.1939</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.6.15.8">0.0477</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.15.9">0.2374</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.15.10">0.0888</td>
</tr>
<tr class="ltx_tr" id="S4.T1.5.5">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.5.5.1">R<sup class="ltx_sup" id="S4.T1.5.5.1.1">2</sup>AG</td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.2">0.6930</td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.3"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.5.5.3.1">0.7062</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.5.5.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.5.5.4.1">0.6704</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.5"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.5.5.5.1">0.6675</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.5.5.6">0.3605</td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.7">0.1864</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.5.5.8">0.1687</td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.9">0.3342</td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.10"><span class="ltx_text ltx_font_bold" id="S4.T1.5.5.10.1">0.3452</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.16">
<td class="ltx_td ltx_align_center ltx_border_t" colspan="10" id="S4.T1.6.16.1"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S4.T1.6.16.1.1">Fine-tuned LLMs</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.17">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T1.6.17.1">Self-RAG</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.17.2">0.1883</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.17.3">-</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.6.17.4">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.17.5">0.2475</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.6.17.6">0.1236</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.17.7">0.0701</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.6.17.8">0.0378</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.17.9">0.2611</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.17.10">0.1389</td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.18">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.6.18.1">RAFT</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.18.2">0.7514</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.18.3">0.8041</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.6.18.4">0.7307</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.18.5">0.7349</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.6.18.6"><span class="ltx_text ltx_font_bold" id="S4.T1.6.18.6.1">0.3172</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.18.7"><span class="ltx_text ltx_font_bold" id="S4.T1.6.18.7.1">0.2529</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.6.18.8">0.1502</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.18.9"><span class="ltx_text ltx_font_bold" id="S4.T1.6.18.9.1">0.7555</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.18.10">0.4869</td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.6">
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_r" id="S4.T1.6.6.1">R<sup class="ltx_sup" id="S4.T1.6.6.1.1">2</sup>AG+RAFT</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.6.6.2"><span class="ltx_text ltx_font_bold" id="S4.T1.6.6.2.1">0.8192</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.6.6.3"><span class="ltx_text ltx_font_bold" id="S4.T1.6.6.3.1">0.8060</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T1.6.6.4"><span class="ltx_text ltx_font_bold" id="S4.T1.6.6.4.1">0.7458</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.6.6.5"><span class="ltx_text ltx_font_bold" id="S4.T1.6.6.5.1">0.7351</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T1.6.6.6">0.3056</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.6.6.7">0.2295</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T1.6.6.8"><span class="ltx_text ltx_font_bold" id="S4.T1.6.6.8.1">0.1533</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.6.6.9">0.7444</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.6.6.10"><span class="ltx_text ltx_font_bold" id="S4.T1.6.6.10.1">0.6351</span></td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Main results on four English datasets. <span class="ltx_text" id="S4.T1.11.1" style="background-color:#D9D9D9;">Results</span> marked in grey background indicate the performance of foundation LLMs. <span class="ltx_text" id="S4.T1.12.2" style="color:#808080;">Results</span> in gray represent the performance of closed-source LLMs. <span class="ltx_text ltx_font_bold" id="S4.T1.13.3">Results</span> in bold and <span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.14.4">results</span> in underlined mean the best and second-best performance among current classified methods.</figcaption>
</figure>
<figure class="ltx_table" id="S4.T2">
<table class="ltx_tabular ltx_align_middle" id="S4.T2.6">
<tr class="ltx_tr" id="S4.T2.6.7">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="S4.T2.6.7.1" rowspan="2"><span class="ltx_text ltx_font_bold" id="S4.T2.6.7.1.1">Methods</span></td>
<td class="ltx_td ltx_align_center ltx_align_top ltx_border_tt" colspan="2" id="S4.T2.6.7.2"><span class="ltx_text ltx_font_bold" id="S4.T2.6.7.2.1">DuReader</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.6.8">
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T2.6.8.1">
<span class="ltx_inline-block ltx_align_top" id="S4.T2.6.8.1.1">
<span class="ltx_p" id="S4.T2.6.8.1.1.1" style="width:45.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.6.8.1.1.1.1">F1</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T2.6.8.2">
<span class="ltx_inline-block ltx_align_top" id="S4.T2.6.8.2.1">
<span class="ltx_p" id="S4.T2.6.8.2.1.1" style="width:45.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.6.8.2.1.1.1">Rouge</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T2.6.9">
<td class="ltx_td ltx_align_center ltx_border_t" colspan="3" id="S4.T2.6.9.1"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S4.T2.6.9.1.1">Frozen LLMs</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.1">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T2.1.1.1">LongChat1.5<sub class="ltx_sub" id="S4.T2.1.1.1.1"><span class="ltx_text ltx_font_italic" id="S4.T2.1.1.1.1.1">7B</span></sub>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S4.T2.1.1.2">
<span class="ltx_inline-block ltx_align_top" id="S4.T2.1.1.2.1">
<span class="ltx_p" id="S4.T2.1.1.2.1.1" style="width:45.5pt;">0.0914</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S4.T2.1.1.3">
<span class="ltx_inline-block ltx_align_top" id="S4.T2.1.1.3.1">
<span class="ltx_p" id="S4.T2.1.1.3.1.1" style="width:45.5pt;">0.1181</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.2">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T2.2.2.1">Qwen1.5<sub class="ltx_sub" id="S4.T2.2.2.1.1"><span class="ltx_text ltx_font_italic" id="S4.T2.2.2.1.1.1">0.5B</span></sub>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T2.2.2.2" style="background-color:#D9D9D9;">
<span class="ltx_inline-block ltx_align_top" id="S4.T2.2.2.2.1">
<span class="ltx_p" id="S4.T2.2.2.2.1.1" style="width:45.5pt;"><span class="ltx_text" id="S4.T2.2.2.2.1.1.1" style="background-color:#D9D9D9;">0.1395</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T2.2.2.3" style="background-color:#D9D9D9;">
<span class="ltx_inline-block ltx_align_top" id="S4.T2.2.2.3.1">
<span class="ltx_p" id="S4.T2.2.2.3.1.1" style="width:45.5pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.2.2.3.1.1.1" style="background-color:#D9D9D9;">0.1656</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T2.3.3">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T2.3.3.1">Qwen1.5<sub class="ltx_sub" id="S4.T2.3.3.1.1"><span class="ltx_text ltx_font_italic" id="S4.T2.3.3.1.1.1">1.8B</span></sub>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T2.3.3.2">
<span class="ltx_inline-block ltx_align_top" id="S4.T2.3.3.2.1">
<span class="ltx_p" id="S4.T2.3.3.2.1.1" style="width:45.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.3.3.2.1.1.1">0.1533</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T2.3.3.3">
<span class="ltx_inline-block ltx_align_top" id="S4.T2.3.3.3.1">
<span class="ltx_p" id="S4.T2.3.3.3.1.1" style="width:45.5pt;">0.1570</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.4">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T2.4.4.1">InternLM2<sub class="ltx_sub" id="S4.T2.4.4.1.1"><span class="ltx_text ltx_font_italic" id="S4.T2.4.4.1.1.1">1.8B</span></sub>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T2.4.4.2">
<span class="ltx_inline-block ltx_align_top" id="S4.T2.4.4.2.1">
<span class="ltx_p" id="S4.T2.4.4.2.1.1" style="width:45.5pt;">0.1330</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T2.4.4.3">
<span class="ltx_inline-block ltx_align_top" id="S4.T2.4.4.3.1">
<span class="ltx_p" id="S4.T2.4.4.3.1.1" style="width:45.5pt;">0.1391</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T2.5.5">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T2.5.5.1">R<sup class="ltx_sup" id="S4.T2.5.5.1.1">2</sup>AG</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S4.T2.5.5.2">
<span class="ltx_inline-block ltx_align_top" id="S4.T2.5.5.2.1">
<span class="ltx_p" id="S4.T2.5.5.2.1.1" style="width:45.5pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.5.5.2.1.1.1">0.1510</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S4.T2.5.5.3">
<span class="ltx_inline-block ltx_align_top" id="S4.T2.5.5.3.1">
<span class="ltx_p" id="S4.T2.5.5.3.1.1" style="width:45.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.5.5.3.1.1.1">0.1663</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T2.6.10">
<td class="ltx_td ltx_align_center ltx_border_t" colspan="3" id="S4.T2.6.10.1"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S4.T2.6.10.1.1">Fine-tuned LLMs</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.6.11">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T2.6.11.1">RAFT</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S4.T2.6.11.2">
<span class="ltx_inline-block ltx_align_top" id="S4.T2.6.11.2.1">
<span class="ltx_p" id="S4.T2.6.11.2.1.1" style="width:45.5pt;">0.2423</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S4.T2.6.11.3">
<span class="ltx_inline-block ltx_align_top" id="S4.T2.6.11.3.1">
<span class="ltx_p" id="S4.T2.6.11.3.1.1" style="width:45.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.6.11.3.1.1.1">0.2740</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T2.6.6">
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_r" id="S4.T2.6.6.1">R<sup class="ltx_sup" id="S4.T2.6.6.1.1">2</sup>AG+RAFT</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb" id="S4.T2.6.6.2">
<span class="ltx_inline-block ltx_align_top" id="S4.T2.6.6.2.1">
<span class="ltx_p" id="S4.T2.6.6.2.1.1" style="width:45.5pt;"><span class="ltx_text ltx_font_bold" id="S4.T2.6.6.2.1.1.1">0.2507</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb" id="S4.T2.6.6.3">
<span class="ltx_inline-block ltx_align_top" id="S4.T2.6.6.3.1">
<span class="ltx_p" id="S4.T2.6.6.3.1.1" style="width:45.5pt;">0.2734</span>
</span>
</td>
</tr>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2: </span>Performance comparison on DuReader dataset.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Baselines</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">To fully evaluate R<sup class="ltx_sup" id="S4.SS2.p1.1.1">2</sup>AG, we compared two types of methods: standard RAG using various LLMs, and enhanced RAG using the same foundation LLM.</p>
</div>
<div class="ltx_para" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.7">First, we evaluate standard RAG baselines where LLMs generate responses given the query prepended with retrieved documents. For English datasets, we use several open-source LLMs, including LLaMA2<sub class="ltx_sub" id="S4.SS2.p2.7.1"><span class="ltx_text ltx_font_italic" id="S4.SS2.p2.7.1.1">7B</span></sub>, LLaMA2<sub class="ltx_sub" id="S4.SS2.p2.7.2"><span class="ltx_text ltx_font_italic" id="S4.SS2.p2.7.2.1">13B</span></sub>, LLaMA3<sub class="ltx_sub" id="S4.SS2.p2.7.3"><span class="ltx_text ltx_font_italic" id="S4.SS2.p2.7.3.1">8B</span></sub> <cite class="ltx_cite ltx_citemacro_cite">Touvron et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib35" title="">2023</a>)</cite>, and LongChat1.5<sub class="ltx_sub" id="S4.SS2.p2.7.4"><span class="ltx_text ltx_font_italic" id="S4.SS2.p2.7.4.1">7B</span></sub> <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib23" title="">2023a</a>)</cite>. Besides, we adopt ChatGPT <cite class="ltx_cite ltx_citemacro_cite">Ouyang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib31" title="">2022</a>)</cite> and GPT4 <cite class="ltx_cite ltx_citemacro_cite">Achiam et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib1" title="">2023</a>)</cite> as baselines of closed-source LLMs. For the Chinese dataset, we employ Qwen1.5<sub class="ltx_sub" id="S4.SS2.p2.7.5"><span class="ltx_text ltx_font_italic" id="S4.SS2.p2.7.5.1">0.5B</span></sub>, Qwen1.5<sub class="ltx_sub" id="S4.SS2.p2.7.6"><span class="ltx_text ltx_font_italic" id="S4.SS2.p2.7.6.1">1.8B</span></sub> <cite class="ltx_cite ltx_citemacro_cite">Bai et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib3" title="">2023a</a>)</cite> and InternLM2<sub class="ltx_sub" id="S4.SS2.p2.7.7"><span class="ltx_text ltx_font_italic" id="S4.SS2.p2.7.7.1">1.8B</span></sub> <cite class="ltx_cite ltx_citemacro_cite">Cai et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib7" title="">2024</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S4.SS2.p3">
<p class="ltx_p" id="S4.SS2.p3.3">Secondly, we experiment with several methods that can enhance RAG, including CoT <cite class="ltx_cite ltx_citemacro_cite">Wei et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib38" title="">2022</a>)</cite>, RECOMP <cite class="ltx_cite ltx_citemacro_cite">Xu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib42" title="">2023</a>)</cite>, CRAG <cite class="ltx_cite ltx_citemacro_cite">Yan et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib44" title="">2024</a>)</cite>, Self-RAG <cite class="ltx_cite ltx_citemacro_cite">Asai et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib2" title="">2023</a>)</cite>, LongLLMLingua <cite class="ltx_cite ltx_citemacro_cite">Jiang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib16" title="">2023</a>)</cite>, and RAFT <cite class="ltx_cite ltx_citemacro_cite">Zhang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib48" title="">2024</a>)</cite>. For NQ-10, HotpotQA, MuSiQue, and 2Wiki datasets, we use LLaMA2<sub class="ltx_sub" id="S4.SS2.p3.3.1"><span class="ltx_text ltx_font_italic" id="S4.SS2.p3.3.1.1">7B</span></sub> as the foundation LLM for enhanced RAG methods, which has a maximum context length of 4k tokens. For NQ-20 and NQ-30 datasets, LongChat1.5<sub class="ltx_sub" id="S4.SS2.p3.3.2"><span class="ltx_text ltx_font_italic" id="S4.SS2.p3.3.2.1">7B</span></sub> is selected as the foundation LLM, which extends the context window to 32k tokens. For DuReader dataset, Qwen1.5<sub class="ltx_sub" id="S4.SS2.p3.3.3"><span class="ltx_text ltx_font_italic" id="S4.SS2.p3.3.3.1">0.5B</span></sub> is the foundation LLM, also with a maximum context length of 32k tokens.</p>
</div>
<div class="ltx_para" id="S4.SS2.p4">
<p class="ltx_p" id="S4.SS2.p4.1">These methods were categorized into two groups – frozen and fine-tuned – based on whether they require training the LLMs.</p>
</div>
<div class="ltx_para" id="S4.SS2.p5">
<p class="ltx_p" id="S4.SS2.p5.1">The implementation details are in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#A5" title="Appendix E Implementation Details ‣ R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_tag">E</span></a>.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Main Results</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#S4.T1" title="Table 1 ‣ 4.1 Datasets and Metrics ‣ 4 Experiments ‣ R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_tag">1</span></a> and Table <a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#S4.T2" title="Table 2 ‣ 4.1 Datasets and Metrics ‣ 4 Experiments ‣ R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_tag">2</span></a> provide the main results. We can obtain the following conclusions:</p>
</div>
<div class="ltx_para" id="S4.SS3.p2">
<p class="ltx_p" id="S4.SS3.p2.12">(1) Compared with foundation LLMs using standard RAG, R<sup class="ltx_sup" id="S4.SS3.p2.12.1">2</sup>AG can significantly increase performance. Even in multi-hot datasets, R<sup class="ltx_sup" id="S4.SS3.p2.12.2">2</sup>AG improves LLMs’ ability for complex reasoning. In DuReader dataset, with a token length of 16k, R<sup class="ltx_sup" id="S4.SS3.p2.12.3">2</sup>AG remains effective, demonstrating its robustness and efficiency in handling extensive text outputs. These results indicate that R<sup class="ltx_sup" id="S4.SS3.p2.12.4">2</sup>AG effectively enables LLMs to better understand the retrieval information and boosts their capabilities in handling provided documents.
(2) Compared with other LLMs using standard RAG, R<sup class="ltx_sup" id="S4.SS3.p2.12.5">2</sup>AG generally achieves better performance except for closed-source LLMs. GPT4 shows superior results in most datasets, establishing it as a strong baseline. Notably, R<sup class="ltx_sup" id="S4.SS3.p2.12.6">2</sup>AG excels ChatGPT in NQ and HotpotQA datasets. Using LLaMA2<sub class="ltx_sub" id="S4.SS3.p2.12.7"><span class="ltx_text ltx_font_italic" id="S4.SS3.p2.12.7.1">7B</span></sub> as the foundational LLM, R<sup class="ltx_sup" id="S4.SS3.p2.12.8">2</sup>AG competes well with LLaMA3<sub class="ltx_sub" id="S4.SS3.p2.12.9"><span class="ltx_text ltx_font_italic" id="S4.SS3.p2.12.9.1">8B</span></sub> and LLaMA2<sub class="ltx_sub" id="S4.SS3.p2.12.10"><span class="ltx_text ltx_font_italic" id="S4.SS3.p2.12.10.1">13B</span></sub> across most metrics.
(3) It is clear that R<sup class="ltx_sup" id="S4.SS3.p2.12.11">2</sup>AG significantly surpasses other enhanced RAG methods in most results, underscoring the importance of incorporating retrieval information. Although CRAG has a good result in NQ datasets, its performance significantly declines in multi-hop datasets. That is because CRAG’s simplistic approach of filtering out documents irrelevant to the query can omit crucial connections needed for understanding complex queries. Additionally, our method outperforms compression-based methods (RECOMP and LongLLMLingua). Our case studies reveal their poor performance is mainly because the coordination between the compressors and LLMs tends to result in substantial information loss and even severe hallucinations.
(4) RAFT can significantly improve the performance. When combined with R<sup class="ltx_sup" id="S4.SS3.p2.12.12">2</sup>AG, the results are the best overall, suggesting that a deeper understanding acquired through training benefits generation capabilities.</p>
</div>
<figure class="ltx_table" id="S4.T3">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S4.T3.15">
<tr class="ltx_tr" id="S4.T3.15.16">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="S4.T3.15.16.1" rowspan="2"><span class="ltx_text ltx_font_bold" id="S4.T3.15.16.1.1">Methods</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S4.T3.15.16.2"><span class="ltx_text ltx_font_bold" id="S4.T3.15.16.2.1">NQ-10</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.15.16.3"><span class="ltx_text ltx_font_bold" id="S4.T3.15.16.3.1">NQ-20</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.2.2">
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.1.1">LLaMA2<sub class="ltx_sub" id="S4.T3.1.1.1.1"><span class="ltx_text ltx_font_italic" id="S4.T3.1.1.1.1.1">7B</span></sub>
</td>
<td class="ltx_td ltx_align_center" id="S4.T3.2.2.2">LongChat1.5<sub class="ltx_sub" id="S4.T3.2.2.2.1"><span class="ltx_text ltx_font_italic" id="S4.T3.2.2.2.1.1">7B</span></sub>
</td>
</tr>
<tr class="ltx_tr" id="S4.T3.3.3">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T3.3.3.1"><span class="ltx_text ltx_font_bold" id="S4.T3.3.3.1.1">R<sup class="ltx_sup" id="S4.T3.3.3.1.1.1"><span class="ltx_text ltx_font_medium" id="S4.T3.3.3.1.1.1.1">2</span></sup>AG</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.3.3.2"><span class="ltx_text ltx_font_bold" id="S4.T3.3.3.2.1">0.6930</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.3.3.3"><span class="ltx_text ltx_font_bold" id="S4.T3.3.3.3.1">0.7062</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.6.6">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T3.4.4.1">w/o <math alttext="r" class="ltx_Math" display="inline" id="S4.T3.4.4.1.m1.1"><semantics id="S4.T3.4.4.1.m1.1a"><mi id="S4.T3.4.4.1.m1.1.1" xref="S4.T3.4.4.1.m1.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S4.T3.4.4.1.m1.1b"><ci id="S4.T3.4.4.1.m1.1.1.cmml" xref="S4.T3.4.4.1.m1.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.4.4.1.m1.1c">r</annotation><annotation encoding="application/x-llamapun" id="S4.T3.4.4.1.m1.1d">italic_r</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.5.5.2">0.6761 (<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T3.5.5.2.m1.1"><semantics id="S4.T3.5.5.2.m1.1a"><mo id="S4.T3.5.5.2.m1.1.1" stretchy="false" xref="S4.T3.5.5.2.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T3.5.5.2.m1.1b"><ci id="S4.T3.5.5.2.m1.1.1.cmml" xref="S4.T3.5.5.2.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.5.5.2.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.5.5.2.m1.1d">↓</annotation></semantics></math>2.45%)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.6.6.3">0.6798 (<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T3.6.6.3.m1.1"><semantics id="S4.T3.6.6.3.m1.1a"><mo id="S4.T3.6.6.3.m1.1.1" stretchy="false" xref="S4.T3.6.6.3.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T3.6.6.3.m1.1b"><ci id="S4.T3.6.6.3.m1.1.1.cmml" xref="S4.T3.6.6.3.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.6.6.3.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.6.6.3.m1.1d">↓</annotation></semantics></math>3.73%)</td>
</tr>
<tr class="ltx_tr" id="S4.T3.9.9">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T3.7.7.1">w/o <math alttext="\gamma" class="ltx_Math" display="inline" id="S4.T3.7.7.1.m1.1"><semantics id="S4.T3.7.7.1.m1.1a"><mi id="S4.T3.7.7.1.m1.1.1" xref="S4.T3.7.7.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.T3.7.7.1.m1.1b"><ci id="S4.T3.7.7.1.m1.1.1.cmml" xref="S4.T3.7.7.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.7.7.1.m1.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="S4.T3.7.7.1.m1.1d">italic_γ</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.8.8.2">0.6723 (<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T3.8.8.2.m1.1"><semantics id="S4.T3.8.8.2.m1.1a"><mo id="S4.T3.8.8.2.m1.1.1" stretchy="false" xref="S4.T3.8.8.2.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T3.8.8.2.m1.1b"><ci id="S4.T3.8.8.2.m1.1.1.cmml" xref="S4.T3.8.8.2.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.8.8.2.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.8.8.2.m1.1d">↓</annotation></semantics></math>2.99%)</td>
<td class="ltx_td ltx_align_center" id="S4.T3.9.9.3">0.6930 (<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T3.9.9.3.m1.1"><semantics id="S4.T3.9.9.3.m1.1a"><mo id="S4.T3.9.9.3.m1.1.1" stretchy="false" xref="S4.T3.9.9.3.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T3.9.9.3.m1.1b"><ci id="S4.T3.9.9.3.m1.1.1.cmml" xref="S4.T3.9.9.3.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.9.9.3.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.9.9.3.m1.1d">↓</annotation></semantics></math>1.87%)</td>
</tr>
<tr class="ltx_tr" id="S4.T3.12.12">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T3.10.10.1">w/o <math alttext="\zeta" class="ltx_Math" display="inline" id="S4.T3.10.10.1.m1.1"><semantics id="S4.T3.10.10.1.m1.1a"><mi id="S4.T3.10.10.1.m1.1.1" xref="S4.T3.10.10.1.m1.1.1.cmml">ζ</mi><annotation-xml encoding="MathML-Content" id="S4.T3.10.10.1.m1.1b"><ci id="S4.T3.10.10.1.m1.1.1.cmml" xref="S4.T3.10.10.1.m1.1.1">𝜁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.10.10.1.m1.1c">\zeta</annotation><annotation encoding="application/x-llamapun" id="S4.T3.10.10.1.m1.1d">italic_ζ</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.11.11.2">0.6252 (<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T3.11.11.2.m1.1"><semantics id="S4.T3.11.11.2.m1.1a"><mo id="S4.T3.11.11.2.m1.1.1" stretchy="false" xref="S4.T3.11.11.2.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T3.11.11.2.m1.1b"><ci id="S4.T3.11.11.2.m1.1.1.cmml" xref="S4.T3.11.11.2.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.11.11.2.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.11.11.2.m1.1d">↓</annotation></semantics></math>9.78%)</td>
<td class="ltx_td ltx_align_center" id="S4.T3.12.12.3">0.6855 (<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T3.12.12.3.m1.1"><semantics id="S4.T3.12.12.3.m1.1a"><mo id="S4.T3.12.12.3.m1.1.1" stretchy="false" xref="S4.T3.12.12.3.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T3.12.12.3.m1.1b"><ci id="S4.T3.12.12.3.m1.1.1.cmml" xref="S4.T3.12.12.3.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.12.12.3.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.12.12.3.m1.1d">↓</annotation></semantics></math>2.93%)</td>
</tr>
<tr class="ltx_tr" id="S4.T3.15.15">
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_r" id="S4.T3.13.13.1">w/o <math alttext="\mathcal{L}_{QDM}" class="ltx_Math" display="inline" id="S4.T3.13.13.1.m1.1"><semantics id="S4.T3.13.13.1.m1.1a"><msub id="S4.T3.13.13.1.m1.1.1" xref="S4.T3.13.13.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.T3.13.13.1.m1.1.1.2" xref="S4.T3.13.13.1.m1.1.1.2.cmml">ℒ</mi><mrow id="S4.T3.13.13.1.m1.1.1.3" xref="S4.T3.13.13.1.m1.1.1.3.cmml"><mi id="S4.T3.13.13.1.m1.1.1.3.2" xref="S4.T3.13.13.1.m1.1.1.3.2.cmml">Q</mi><mo id="S4.T3.13.13.1.m1.1.1.3.1" xref="S4.T3.13.13.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.T3.13.13.1.m1.1.1.3.3" xref="S4.T3.13.13.1.m1.1.1.3.3.cmml">D</mi><mo id="S4.T3.13.13.1.m1.1.1.3.1a" xref="S4.T3.13.13.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.T3.13.13.1.m1.1.1.3.4" xref="S4.T3.13.13.1.m1.1.1.3.4.cmml">M</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.T3.13.13.1.m1.1b"><apply id="S4.T3.13.13.1.m1.1.1.cmml" xref="S4.T3.13.13.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T3.13.13.1.m1.1.1.1.cmml" xref="S4.T3.13.13.1.m1.1.1">subscript</csymbol><ci id="S4.T3.13.13.1.m1.1.1.2.cmml" xref="S4.T3.13.13.1.m1.1.1.2">ℒ</ci><apply id="S4.T3.13.13.1.m1.1.1.3.cmml" xref="S4.T3.13.13.1.m1.1.1.3"><times id="S4.T3.13.13.1.m1.1.1.3.1.cmml" xref="S4.T3.13.13.1.m1.1.1.3.1"></times><ci id="S4.T3.13.13.1.m1.1.1.3.2.cmml" xref="S4.T3.13.13.1.m1.1.1.3.2">𝑄</ci><ci id="S4.T3.13.13.1.m1.1.1.3.3.cmml" xref="S4.T3.13.13.1.m1.1.1.3.3">𝐷</ci><ci id="S4.T3.13.13.1.m1.1.1.3.4.cmml" xref="S4.T3.13.13.1.m1.1.1.3.4">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.13.13.1.m1.1c">\mathcal{L}_{QDM}</annotation><annotation encoding="application/x-llamapun" id="S4.T3.13.13.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_Q italic_D italic_M end_POSTSUBSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T3.14.14.2">0.6441 (<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T3.14.14.2.m1.1"><semantics id="S4.T3.14.14.2.m1.1a"><mo id="S4.T3.14.14.2.m1.1.1" stretchy="false" xref="S4.T3.14.14.2.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T3.14.14.2.m1.1b"><ci id="S4.T3.14.14.2.m1.1.1.cmml" xref="S4.T3.14.14.2.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.14.14.2.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.14.14.2.m1.1d">↓</annotation></semantics></math>7.07%)</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.15.15.3">0.7043 (<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T3.15.15.3.m1.1"><semantics id="S4.T3.15.15.3.m1.1a"><mo id="S4.T3.15.15.3.m1.1.1" stretchy="false" xref="S4.T3.15.15.3.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T3.15.15.3.m1.1b"><ci id="S4.T3.15.15.3.m1.1.1.cmml" xref="S4.T3.15.15.3.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.15.15.3.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.15.15.3.m1.1d">↓</annotation></semantics></math>0.27%)</td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Ablation studies on NQ-10 and NQ-20 datasets.</figcaption>
</figure>
<figure class="ltx_figure" id="S4.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="315" id="S4.F3.g1" src="x3.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Performance of learnable tokens across different document counts on NQ-10 dataset. <span class="ltx_text ltx_font_typewriter" id="S4.F3.2.1">‘‘GT’’</span> means only retaining ground-true documents.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Ablation Studies</h3>
<div class="ltx_para" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.6">To demonstrate the effectiveness of R<sup class="ltx_sup" id="S4.SS4.p1.6.1">2</sup>AG, we create four variants. Specifically, we remove three retrieval features <math alttext="r,\gamma,\zeta" class="ltx_Math" display="inline" id="S4.SS4.p1.2.m2.3"><semantics id="S4.SS4.p1.2.m2.3a"><mrow id="S4.SS4.p1.2.m2.3.4.2" xref="S4.SS4.p1.2.m2.3.4.1.cmml"><mi id="S4.SS4.p1.2.m2.1.1" xref="S4.SS4.p1.2.m2.1.1.cmml">r</mi><mo id="S4.SS4.p1.2.m2.3.4.2.1" xref="S4.SS4.p1.2.m2.3.4.1.cmml">,</mo><mi id="S4.SS4.p1.2.m2.2.2" xref="S4.SS4.p1.2.m2.2.2.cmml">γ</mi><mo id="S4.SS4.p1.2.m2.3.4.2.2" xref="S4.SS4.p1.2.m2.3.4.1.cmml">,</mo><mi id="S4.SS4.p1.2.m2.3.3" xref="S4.SS4.p1.2.m2.3.3.cmml">ζ</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.2.m2.3b"><list id="S4.SS4.p1.2.m2.3.4.1.cmml" xref="S4.SS4.p1.2.m2.3.4.2"><ci id="S4.SS4.p1.2.m2.1.1.cmml" xref="S4.SS4.p1.2.m2.1.1">𝑟</ci><ci id="S4.SS4.p1.2.m2.2.2.cmml" xref="S4.SS4.p1.2.m2.2.2">𝛾</ci><ci id="S4.SS4.p1.2.m2.3.3.cmml" xref="S4.SS4.p1.2.m2.3.3">𝜁</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.2.m2.3c">r,\gamma,\zeta</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.2.m2.3d">italic_r , italic_γ , italic_ζ</annotation></semantics></math>, individually. For R<sup class="ltx_sup" id="S4.SS4.p1.6.2">2</sup>-Former, we remove the QDM loss <math alttext="\mathcal{L}_{QDM}" class="ltx_Math" display="inline" id="S4.SS4.p1.4.m4.1"><semantics id="S4.SS4.p1.4.m4.1a"><msub id="S4.SS4.p1.4.m4.1.1" xref="S4.SS4.p1.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS4.p1.4.m4.1.1.2" xref="S4.SS4.p1.4.m4.1.1.2.cmml">ℒ</mi><mrow id="S4.SS4.p1.4.m4.1.1.3" xref="S4.SS4.p1.4.m4.1.1.3.cmml"><mi id="S4.SS4.p1.4.m4.1.1.3.2" xref="S4.SS4.p1.4.m4.1.1.3.2.cmml">Q</mi><mo id="S4.SS4.p1.4.m4.1.1.3.1" xref="S4.SS4.p1.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S4.SS4.p1.4.m4.1.1.3.3" xref="S4.SS4.p1.4.m4.1.1.3.3.cmml">D</mi><mo id="S4.SS4.p1.4.m4.1.1.3.1a" xref="S4.SS4.p1.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S4.SS4.p1.4.m4.1.1.3.4" xref="S4.SS4.p1.4.m4.1.1.3.4.cmml">M</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.4.m4.1b"><apply id="S4.SS4.p1.4.m4.1.1.cmml" xref="S4.SS4.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.4.m4.1.1.1.cmml" xref="S4.SS4.p1.4.m4.1.1">subscript</csymbol><ci id="S4.SS4.p1.4.m4.1.1.2.cmml" xref="S4.SS4.p1.4.m4.1.1.2">ℒ</ci><apply id="S4.SS4.p1.4.m4.1.1.3.cmml" xref="S4.SS4.p1.4.m4.1.1.3"><times id="S4.SS4.p1.4.m4.1.1.3.1.cmml" xref="S4.SS4.p1.4.m4.1.1.3.1"></times><ci id="S4.SS4.p1.4.m4.1.1.3.2.cmml" xref="S4.SS4.p1.4.m4.1.1.3.2">𝑄</ci><ci id="S4.SS4.p1.4.m4.1.1.3.3.cmml" xref="S4.SS4.p1.4.m4.1.1.3.3">𝐷</ci><ci id="S4.SS4.p1.4.m4.1.1.3.4.cmml" xref="S4.SS4.p1.4.m4.1.1.3.4">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.4.m4.1c">\mathcal{L}_{QDM}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.4.m4.1d">caligraphic_L start_POSTSUBSCRIPT italic_Q italic_D italic_M end_POSTSUBSCRIPT</annotation></semantics></math>. We conduct the ablation studies on the NQ-10 and NQ-20 datasets, using LLaMA2<sub class="ltx_sub" id="S4.SS4.p1.6.3"><span class="ltx_text ltx_font_italic" id="S4.SS4.p1.6.3.1">7B</span></sub> and LongChat1.5<sub class="ltx_sub" id="S4.SS4.p1.6.4"><span class="ltx_text ltx_font_italic" id="S4.SS4.p1.6.4.1">7B</span></sub> as foundation LLMs with
results shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#S4.T3" title="Table 3 ‣ 4.3 Main Results ‣ 4 Experiments ‣ R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_tag">3</span></a>.
We can obtain the following observations: First, the performance decreases without any of the three retrieval features, underscoring their effectiveness. The results reveal that utilizing additional retrieval features can help LLMs disentangle irrelevant documents. Secondly, the performance decreases without the QDM loss, showing that the query-document matching task is indeed beneficial for exploiting retrieval information.</p>
</div>
<div class="ltx_para" id="S4.SS4.p2">
<p class="ltx_p" id="S4.SS4.p2.2">To explore the effectiveness of the retrieval-aware prompting strategy, we design an experiment on NQ-10 dataset with various top-<math alttext="k" class="ltx_Math" display="inline" id="S4.SS4.p2.1.m1.1"><semantics id="S4.SS4.p2.1.m1.1a"><mi id="S4.SS4.p2.1.m1.1.1" xref="S4.SS4.p2.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.1.m1.1b"><ci id="S4.SS4.p2.1.m1.1.1.cmml" xref="S4.SS4.p2.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.1.m1.1d">italic_k</annotation></semantics></math> retrieved documents where the retrieval information is set as learnable tokens. This means R<sup class="ltx_sup" id="S4.SS4.p2.2.1">2</sup>AG only uses these soft prompts without additional features when training and inference. From the results shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#S4.F3" title="Figure 3 ‣ 4.3 Main Results ‣ 4 Experiments ‣ R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_tag">3</span></a>, we can find that: (1) When retrieval results are largely relevant, with few or no redundant documents, learnable tokens do not aid the LLM and may instead become redundant information for the generation. (2) As the number of documents increases, it is natural to observe a decline performance. Surprisingly, learnable tokens significantly enhance the performance of the LLM. These findings demonstrate that the retrieval-aware prompting strategy effectively assists LLMs in processing multiple documents, especially when those documents include irrelevant information.</p>
</div>
<figure class="ltx_figure" id="S4.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="461" id="S4.F4.g1" src="x4.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Performance comparison of R<sup class="ltx_sup" id="S4.F4.4.1">2</sup>AG with various retrievers on NQ-10 dataset.</figcaption>
</figure>
<figure class="ltx_figure" id="S4.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="297" id="S4.F5.g1" src="x5.png" width="829"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Performance of R<sup class="ltx_sup" id="S4.F5.19.1">2</sup>AG<sub class="ltx_sub" id="S4.F5.20.2"><span class="ltx_text ltx_font_italic" id="S4.F5.20.2.1">7B</span></sub> and R<sup class="ltx_sup" id="S4.F5.21.3">2</sup>AG<sub class="ltx_sub" id="S4.F5.22.4"><span class="ltx_text ltx_font_italic" id="S4.F5.22.4.1">13B</span></sub>. Darker parts mean the difference value of R<sup class="ltx_sup" id="S4.F5.23.5">2</sup>AG<sub class="ltx_sub" id="S4.F5.24.6"><span class="ltx_text ltx_font_italic" id="S4.F5.24.6.1">13B</span></sub>. </figcaption>
</figure>
<figure class="ltx_figure" id="S4.F6">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F6.1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="173" id="S4.F6.1.g1" src="x6.png" width="830"/>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F6.2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="176" id="S4.F6.2.g1" src="x7.png" width="830"/>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Heatmaps of self-attention distribution of the last token, broken out by token position (X-axis) and layer (Y-axis). Each attention layer comprises 8 heads, and the attention weights are the mean of all the heads. Darker yellow means higher attention weights. <math alttext="\mathbf{e}^{R}_{i}" class="ltx_Math" display="inline" id="S4.F6.5.m1.1"><semantics id="S4.F6.5.m1.1b"><msubsup id="S4.F6.5.m1.1.1" xref="S4.F6.5.m1.1.1.cmml"><mi id="S4.F6.5.m1.1.1.2.2" xref="S4.F6.5.m1.1.1.2.2.cmml">𝐞</mi><mi id="S4.F6.5.m1.1.1.3" xref="S4.F6.5.m1.1.1.3.cmml">i</mi><mi id="S4.F6.5.m1.1.1.2.3" xref="S4.F6.5.m1.1.1.2.3.cmml">R</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.F6.5.m1.1c"><apply id="S4.F6.5.m1.1.1.cmml" xref="S4.F6.5.m1.1.1"><csymbol cd="ambiguous" id="S4.F6.5.m1.1.1.1.cmml" xref="S4.F6.5.m1.1.1">subscript</csymbol><apply id="S4.F6.5.m1.1.1.2.cmml" xref="S4.F6.5.m1.1.1"><csymbol cd="ambiguous" id="S4.F6.5.m1.1.1.2.1.cmml" xref="S4.F6.5.m1.1.1">superscript</csymbol><ci id="S4.F6.5.m1.1.1.2.2.cmml" xref="S4.F6.5.m1.1.1.2.2">𝐞</ci><ci id="S4.F6.5.m1.1.1.2.3.cmml" xref="S4.F6.5.m1.1.1.2.3">𝑅</ci></apply><ci id="S4.F6.5.m1.1.1.3.cmml" xref="S4.F6.5.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F6.5.m1.1d">\mathbf{e}^{R}_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.F6.5.m1.1e">bold_e start_POSTSUPERSCRIPT italic_R end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is the retrieval information embedding for <math alttext="i" class="ltx_Math" display="inline" id="S4.F6.6.m2.1"><semantics id="S4.F6.6.m2.1b"><mi id="S4.F6.6.m2.1.1" xref="S4.F6.6.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.F6.6.m2.1c"><ci id="S4.F6.6.m2.1.1.cmml" xref="S4.F6.6.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F6.6.m2.1d">i</annotation><annotation encoding="application/x-llamapun" id="S4.F6.6.m2.1e">italic_i</annotation></semantics></math>-th document.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5 </span>Discussions</h3>
<section class="ltx_paragraph" id="S4.SS5.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">The Impact of Performance of Retrievers and LLMs.</h4>
<div class="ltx_para" id="S4.SS5.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS5.SSS0.Px1.p1.3">As mentioned in Section <a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#S1" title="1 Introduction ‣ R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_tag">1</span></a>, the quality of retrieved documents can heavily influence the performance of LLMs in RAG. From the main results, R<sup class="ltx_sup" id="S4.SS5.SSS0.Px1.p1.3.1">2</sup>AG achieves improvements even when the retrieval performance is poor, as observed in MuSiQue and DuReader datasets. Furthermore, we conduct experiments on NQ-10 dataset with five non-trained retrievers, specifically BGE-Reranker <cite class="ltx_cite ltx_citemacro_cite">Xiao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib41" title="">2023</a>)</cite>, BERT <cite class="ltx_cite ltx_citemacro_cite">Devlin et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib8" title="">2019</a>)</cite>, Contriever <cite class="ltx_cite ltx_citemacro_cite">Izacard et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib15" title="">2022</a>)</cite>, and OpenAI Embedding models (small and large) <cite class="ltx_cite ltx_citemacro_cite">Neelakantan et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib30" title="">2022</a>)</cite>, with 1024, 768, 768, 1536, and 3072 dimensions, respectively. Note that OpenAI Embedding models are closed-source. From the results presented in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#S4.F4" title="Figure 4 ‣ 4.4 Ablation Studies ‣ 4 Experiments ‣ R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_tag">4</span></a>, we easily observe that a stronger retriever leads to better performance, both standard RAG and R<sup class="ltx_sup" id="S4.SS5.SSS0.Px1.p1.3.2">2</sup>AG. Importantly, R<sup class="ltx_sup" id="S4.SS5.SSS0.Px1.p1.3.3">2</sup>AG significantly enhances the effectiveness of LLMs, even when the retrieval performance is poor.</p>
</div>
<div class="ltx_para" id="S4.SS5.SSS0.Px1.p2">
<p class="ltx_p" id="S4.SS5.SSS0.Px1.p2.9">We conduct experiments on HotpotQA, MuSiQue, and 2Wiki datasets using LLaMA2<sub class="ltx_sub" id="S4.SS5.SSS0.Px1.p2.9.1"><span class="ltx_text ltx_font_italic" id="S4.SS5.SSS0.Px1.p2.9.1.1">13B</span></sub> as the foundation LLM. Results shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#S4.F5" title="Figure 5 ‣ 4.4 Ablation Studies ‣ 4 Experiments ‣ R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_tag">5</span></a> indicate that R<sup class="ltx_sup" id="S4.SS5.SSS0.Px1.p2.9.2">2</sup>AG<sub class="ltx_sub" id="S4.SS5.SSS0.Px1.p2.9.3"><span class="ltx_text ltx_font_italic" id="S4.SS5.SSS0.Px1.p2.9.3.1">13B</span></sub> outperforms R<sup class="ltx_sup" id="S4.SS5.SSS0.Px1.p2.9.4">2</sup>AG<sub class="ltx_sub" id="S4.SS5.SSS0.Px1.p2.9.5"><span class="ltx_text ltx_font_italic" id="S4.SS5.SSS0.Px1.p2.9.5.1">7B</span></sub>, particularly in the accuracy metric. Specially, there is a decline performance in F1 scores for HotpotQA and MuSiQue datasets. We find this primarily because larger LLMs usually tend to output longer answers with explanations (the average response token count in HotpotQA dataset for R<sup class="ltx_sup" id="S4.SS5.SSS0.Px1.p2.9.6">2</sup>AG<sub class="ltx_sub" id="S4.SS5.SSS0.Px1.p2.9.7"><span class="ltx_text ltx_font_italic" id="S4.SS5.SSS0.Px1.p2.9.7.1">7B</span></sub> is 37.44, compared to 49.71 for R<sup class="ltx_sup" id="S4.SS5.SSS0.Px1.p2.9.8">2</sup>AG<sub class="ltx_sub" id="S4.SS5.SSS0.Px1.p2.9.9"><span class="ltx_text ltx_font_italic" id="S4.SS5.SSS0.Px1.p2.9.9.1">13B</span></sub>). This tendency also can be observed from the results of ChatGPT and GPT4.</p>
</div>
<div class="ltx_para" id="S4.SS5.SSS0.Px1.p3">
<p class="ltx_p" id="S4.SS5.SSS0.Px1.p3.1">These results reveal that both a stronger LLM and a more effective retriever lead to better performance, validating that R<sup class="ltx_sup" id="S4.SS5.SSS0.Px1.p3.1.1">2</sup>AG is a genetic method that can be efficiently applied in various scenarios.</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS5.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">The Effect of Retrieval Information.</h4>
<div class="ltx_para" id="S4.SS5.SSS0.Px2.p1">
<p class="ltx_p" id="S4.SS5.SSS0.Px2.p1.2">For a deeper and more intuitive exploration of how retrieval information improves LLMs’ generation, we present a visualization of the self-attention distribution in R<sup class="ltx_sup" id="S4.SS5.SSS0.Px2.p1.2.1">2</sup>AG compared with standard RAG. In detail, we analyze a case in NQ-10 dataset in which the foundation LLM is LLaMA2<sub class="ltx_sub" id="S4.SS5.SSS0.Px2.p1.2.2"><span class="ltx_text ltx_font_italic" id="S4.SS5.SSS0.Px2.p1.2.2.1">7B</span></sub>. We extract the self-attention weights in different layers from LLM’s outputs and visualize the last token’s attention distribution for other tokens. The relevant document is ranked in position 2 in our selected case, while the 1st document is potentially confusing. For a clear illustration, we select attention distribution for tokens in top-4 documents. From Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#S4.F6" title="Figure 6 ‣ 4.4 Ablation Studies ‣ 4 Experiments ‣ R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_tag">6</span></a>, it is evident that the retrieval information receives higher attention scores even in deeper layers, and the relevant document can get more attention within 1-4 layers. That means the retrieval information effectively acts as an anchor, guiding the LLM to focus on useful documents.</p>
</div>
<div class="ltx_para" id="S4.SS5.SSS0.Px2.p2">
<p class="ltx_p" id="S4.SS5.SSS0.Px2.p2.1">Further discussions and case studies are available in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#A6" title="Appendix F Further Discussion ‣ R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_tag">F</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#A7" title="Appendix G Case Studies ‣ R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_tag">G</span></a>.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion and Future Work</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.5">This paper proposed a novel enhanced RAG framework named R<sup class="ltx_sup" id="S5.p1.5.1">2</sup>AG to bridge the semantic gap between the retrievers and LLMs. By incorporating retrieval information from retrievers into LLMs’ generation process, R<sup class="ltx_sup" id="S5.p1.5.2">2</sup>AG captures a comprehensive understanding of retrieved documents. Experimental results show that R<sup class="ltx_sup" id="S5.p1.5.3">2</sup>AG outperforms other competitors. In addition, the robustness and effectiveness of R<sup class="ltx_sup" id="S5.p1.5.4">2</sup>AG are further confirmed by detailed analysis. In future work, more retrieval features could be applied to R<sup class="ltx_sup" id="S5.p1.5.5">2</sup>AG framework.</p>
</div>
</section>
<section class="ltx_section" id="Sx1">
<h2 class="ltx_title ltx_title_section">Limitations</h2>
<div class="ltx_para" id="Sx1.p1">
<p class="ltx_p" id="Sx1.p1.6">The following are the limitations associated with R<sup class="ltx_sup" id="Sx1.p1.6.1">2</sup>AG:
First, R<sup class="ltx_sup" id="Sx1.p1.6.2">2</sup>AG depends on the semantic representations modeled by encoder-based retrievers. The suitability of other types of retrievers, such as sparse and cross-encoder retrievers, requires further exploration. Secondly, as mentioned in Section <a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#S4.SS5" title="4.5 Discussions ‣ 4 Experiments ‣ R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_tag">4.5</span></a>, R<sup class="ltx_sup" id="Sx1.p1.6.3">2</sup>AG relies on the ability of the foundation LLM, and more powerful closed-source LLMs may not be compatible with R<sup class="ltx_sup" id="Sx1.p1.6.4">2</sup>AG. Thirdly, there may be other informative features besides the three retrieval features - relevance, precedent similarity, and neighbor similarity scores. Lastly, R<sup class="ltx_sup" id="Sx1.p1.6.5">2</sup>AG is evaluated on five datasets, of which relevant documents are provided. However, situations where no relevant documents are available need to be considered. R<sup class="ltx_sup" id="Sx1.p1.6.6">2</sup>AG may benefit from integrating techniques like self-RAG to better handle such situations.</p>
</div>
</section>
<section class="ltx_section" id="Sx2">
<h2 class="ltx_title ltx_title_section">Ethics Statement</h2>
<div class="ltx_para" id="Sx2.p1">
<p class="ltx_p" id="Sx2.p1.1">LLMs can generate incorrect and potentially harmful answers. Our proposed method aims to alleviate this issue by providing LLMs with retrieved documents and retrieval information, thereby enhancing LLMs’ capability of generation. In the development and execution of our work, we strictly adhered to ethical guidelines established by the broader academic and open-source community. All the datasets and models used in this work are publicly available. No conflicts of interest exist for any of the authors involved in this work.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Achiam et al. (2023)</span>
<span class="ltx_bibblock">
OpenAI Josh Achiam, Steven Adler, Sandhini Agarwal, Lama Ahmad, Ilge Akkaya, Florencia Leoni Aleman, Diogo Almeida, and et al. 2023.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.48550/arXiv.2303.08774" title="">Gpt-4 technical report</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Asai et al. (2023)</span>
<span class="ltx_bibblock">
Akari Asai, Zeqiu Wu, Yizhong Wang, Avirup Sil, and Hannaneh Hajishirzi. 2023.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.48550/arXiv.2310.11511" title="">Self-rag: Learning to retrieve, generate, and critique through self-reflection</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">ArXiv</em>, abs/2310.11511.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bai et al. (2023a)</span>
<span class="ltx_bibblock">
Jinze Bai, Shuai Bai, Yunfei Chu, Zeyu Cui, Kai Dang, Xiaodong Deng, Yang Fan, Wenhang Ge, Yu Han, Fei Huang, Binyuan Hui, Luo Ji, Mei Li, and et al. 2023a.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.48550/arXiv.2309.16609" title="">Qwen technical report</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">ArXiv</em>, abs/2309.16609.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bai et al. (2023b)</span>
<span class="ltx_bibblock">
Yushi Bai, Xin Lv, Jiajie Zhang, Hong Lyu, Jiankai Tang, Zhidian Huang, Zhengxiao Du, Xiao Liu, Aohan Zeng, Lei Hou, Yuxiao Dong, Jie Tang, and Juanzi Li. 2023b.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.48550/arXiv.2308.14508" title="">Longbench: A bilingual, multitask benchmark for long context understanding</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">ArXiv</em>, abs/2308.14508.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Barnett et al. (2024)</span>
<span class="ltx_bibblock">
Scott Barnett, Stefanus Kurniawan, Srikanth Thudumu, Zach Brannelly, and Mohamed Abdelrazek. 2024.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.48550/arXiv.2401.05856" title="">Seven failure points when engineering a retrieval augmented generation system</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">ArXiv</em>, abs/2401.05856.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">BehnamGhader et al. (2022)</span>
<span class="ltx_bibblock">
Parishad BehnamGhader, Santiago Miret, and Siva Reddy. 2022.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.48550/arXiv.2212.09146" title="">Can retriever-augmented language models reason? the blame game between the retriever and the language model</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">ArXiv</em>, abs/2212.09146.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cai et al. (2024)</span>
<span class="ltx_bibblock">
Zheng Cai, Maosong Cao, Haojiong Chen, Kai Chen, Keyu Chen, Xin Chen, Xun Chen, Zehui Chen, Zhi Chen, Pei Chu, Xiao wen Dong, and et al. 2024.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.48550/arXiv.2403.17297" title="">Internlm2 technical report</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">ArXiv</em>, abs/2403.17297.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Devlin et al. (2019)</span>
<span class="ltx_bibblock">
Jacob Devlin, Ming-Wei Chang, Kenton Lee, and Kristina Toutanova. 2019.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.18653/v1/N19-1423" title="">BERT: Pre-training of deep bidirectional transformers for language understanding</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">Proceedings of the 2019 Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies, Volume 1 (Long and Short Papers)</em>, pages 4171–4186, Minneapolis, Minnesota. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Douze et al. (2024)</span>
<span class="ltx_bibblock">
Matthijs Douze, Alexandr Guzhva, Chengqi Deng, Jeff Johnson, Gergely Szilvasy, Pierre-Emmanuel Mazar’e, Maria Lomeli, Lucas Hosseini, and Herv’e J’egou. 2024.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.48550/arXiv.2401.08281" title="">The faiss library</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">ArXiv</em>, abs/2401.08281.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gao et al. (2023)</span>
<span class="ltx_bibblock">
Yunfan Gao, Yun Xiong, Xinyu Gao, Kangxiang Jia, Jinliu Pan, Yuxi Bi, Yi Dai, Jiawei Sun, Qianyu Guo, Meng Wang, and Haofen Wang. 2023.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.48550/arXiv.2312.10997" title="">Retrieval-augmented generation for large language models: A survey</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">ArXiv</em>, abs/2312.10997.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al. (2018)</span>
<span class="ltx_bibblock">
Wei He, Kai Liu, Jing Liu, Yajuan Lyu, Shiqi Zhao, Xinyan Xiao, Yuan Liu, Yizhong Wang, Hua Wu, Qiaoqiao She, Xuan Liu, Tian Wu, and Haifeng Wang. 2018.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.18653/v1/W18-2605" title="">DuReader: a Chinese machine reading comprehension dataset from real-world applications</a>.

</span>
<span class="ltx_bibblock">pages 37–46.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al. (2024)</span>
<span class="ltx_bibblock">
Xiaoxin He, Yijun Tian, Yifei Sun, N. Chawla, Thomas Laurent, Yann LeCun, Xavier Bresson, and Bryan Hooi. 2024.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.48550/arXiv.2402.07630" title="">G-retriever: Retrieval-augmented generation for textual graph understanding and question answering</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">ArXiv</em>, abs/2402.07630.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ho et al. (2020)</span>
<span class="ltx_bibblock">
Xanh Ho, Anh-Khoa Duong Nguyen, Saku Sugawara, and Akiko Aizawa. 2020.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.18653/v1/2020.coling-main.580" title="">Constructing a multi-hop QA dataset for comprehensive evaluation of reasoning steps</a>.

</span>
<span class="ltx_bibblock">pages 6609–6625.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu et al. (2021)</span>
<span class="ltx_bibblock">
J. Edward Hu, Yelong Shen, Phillip Wallis, Zeyuan Allen-Zhu, Yuanzhi Li, Shean Wang, and Weizhu Chen. 2021.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.48550/arXiv.2106.09685" title="">Lora: Low-rank adaptation of large language models</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">ArXiv</em>, abs/2106.09685.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Izacard et al. (2022)</span>
<span class="ltx_bibblock">
Gautier Izacard, Patrick Lewis, Maria Lomeli, Lucas Hosseini, Fabio Petroni, Timo Schick, Jane A. Yu, Armand Joulin, Sebastian Riedel, and Edouard Grave. 2022.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.48550/arXiv.2208.03299" title="">Atlas: Few-shot learning with retrieval augmented language models</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">ArXiv</em>, abs/2208.03299.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang et al. (2023)</span>
<span class="ltx_bibblock">
Huiqiang Jiang, Qianhui Wu, Xufang Luo, Dongsheng Li, Chin-Yew Lin, Yuqing Yang, and Lili Qiu. 2023.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.48550/arXiv.2310.06839" title="">Longllmlingua: Accelerating and enhancing llms in long context scenarios via prompt compression</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">ArXiv</em>, abs/2310.06839.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kandpal et al. (2022)</span>
<span class="ltx_bibblock">
Nikhil Kandpal, H. Deng, Adam Roberts, Eric Wallace, and Colin Raffel. 2022.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.48550/arXiv.2211.08411" title="">Large language models struggle to learn long-tail knowledge</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">International Conference on Machine Learning</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ke et al. (2024)</span>
<span class="ltx_bibblock">
Zixuan Ke, Weize Kong, Cheng Li, Mingyang Zhang, Qiaozhu Mei, and Michael Bendersky. 2024.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.48550/arXiv.2401.06954" title="">Bridging the preference gap between retrievers and llms</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">ArXiv</em>, abs/2401.06954.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kingma and Ba (2014)</span>
<span class="ltx_bibblock">
Diederik P. Kingma and Jimmy Ba. 2014.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.48550/arXiv.1412.6980" title="">Adam: A method for stochastic optimization</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">CoRR</em>, abs/1412.6980.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Koizumi et al. (2020)</span>
<span class="ltx_bibblock">
Yuma Koizumi, Yasunori Ohishi, Daisuke Niizumi, Daiki Takeuchi, and Masahiro Yasuda. 2020.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.48550/arXiv.2012.07331" title="">Audio captioning using pre-trained large-scale language model guided by audio-based similar caption retrieval</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">ArXiv</em>, abs/2012.07331.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kwiatkowski et al. (2019)</span>
<span class="ltx_bibblock">
Tom Kwiatkowski, Jennimaria Palomaki, Olivia Redfield, Michael Collins, Ankur P. Parikh, Chris Alberti, Danielle Epstein, Illia Polosukhin, and et al. 2019.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.1162/tacl_a_00276" title="">Natural questions: A benchmark for question answering research</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">Transactions of the Association for Computational Linguistics</em>, 7:453–466.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lewis et al. (2020)</span>
<span class="ltx_bibblock">
Patrick Lewis, Ethan Perez, Aleksandara Piktus, Fabio Petroni, Vladimir Karpukhin, Naman Goyal, Heinrich Kuttler, Mike Lewis, and et al. 2020.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.48550/arXiv.2005.11401" title="">Retrieval-augmented generation for knowledge-intensive nlp tasks</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">ArXiv</em>, abs/2005.11401.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2023a)</span>
<span class="ltx_bibblock">
Dacheng Li, Rulin Shao, Anze Xie, Ying Sheng, Lianmin Zheng, Joseph E. Gonzalez, Ion Stoica, Xuezhe Ma, and Hao Zhang. 2023a.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://lmsys.org/blog/2023-06-29-longchat" title="">How long can open-source LLMs truly promise on context length?</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2022)</span>
<span class="ltx_bibblock">
Dongxu Li, Junnan Li, Hung Le, Guangsen Wang, Silvio Savarese, and Steven C. H. Hoi. 2022.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.48550/arXiv.2209.09019" title="">Lavis: A library for language-vision intelligence</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">ArXiv</em>, abs/2209.09019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2023b)</span>
<span class="ltx_bibblock">
Junnan Li, Dongxu Li, Silvio Savarese, and Steven C. H. Hoi. 2023b.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.48550/arXiv.2301.12597" title="">Blip-2: Bootstrapping language-image pre-training with frozen image encoders and large language models</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">International Conference on Machine Learning</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin (2004)</span>
<span class="ltx_bibblock">
Chin-Yew Lin. 2004.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://aclanthology.org/W04-1013" title="">ROUGE: A package for automatic evaluation of summaries</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">Text Summarization Branches Out</em>, pages 74–81, Barcelona, Spain. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2023)</span>
<span class="ltx_bibblock">
Nelson F. Liu, Kevin Lin, John Hewitt, Ashwin Paranjape, Michele Bevilacqua, Fabio Petroni, and Percy Liang. 2023.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.1162/tacl_a_00638" title="">Lost in the middle: How language models use long contexts</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">Transactions of the Association for Computational Linguistics</em>, 12:157–173.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ma et al. (2022)</span>
<span class="ltx_bibblock">
Yixiao Ma, Qingyao Ai, Yueyue Wu, Yunqiu Shao, Yiqun Liu, M. Zhang, and Shaoping Ma. 2022.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.1145/3477495.3531998" title="">Incorporating retrieval information into the truncation of ranking lists for better legal search</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">Proceedings of the 45th International ACM SIGIR Conference on Research and Development in Information Retrieval</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mallen et al. (2023)</span>
<span class="ltx_bibblock">
Alex Mallen, Akari Asai, Victor Zhong, Rajarshi Das, Daniel Khashabi, and Hannaneh Hajishirzi. 2023.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.18653/v1/2023.acl-long.546" title="">When not to trust language models: Investigating effectiveness of parametric and non-parametric memories</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">Proceedings of the 61st Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers)</em>, pages 9802–9822, Toronto, Canada. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Neelakantan et al. (2022)</span>
<span class="ltx_bibblock">
Arvind Neelakantan, Tao Xu, Raul Puri, Alec Radford, Jesse Michael Han, Jerry Tworek, Qiming Yuan, Nikolas A. Tezak, Jong Wook Kim, and et al. 2022.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.48550/arXiv.2201.10005" title="">Text and code embeddings by contrastive pre-training</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">ArXiv</em>, abs/2201.10005.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ouyang et al. (2022)</span>
<span class="ltx_bibblock">
Long Ouyang, Jeff Wu, Xu Jiang, Diogo Almeida, Carroll L. Wainwright, Pamela Mishkin, Chong Zhang, Sandhini Agarwal, and et al. 2022.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.48550/arXiv.2203.02155" title="">Training language models to follow instructions with human feedback</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">ArXiv</em>, abs/2203.02155.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Paszke et al. (2019)</span>
<span class="ltx_bibblock">
Adam Paszke, Sam Gross, Francisco Massa, Adam Lerer, James Bradbury, Gregory Chanan, Trevor Killeen, Zeming Lin, Natalia Gimelshein, and et al. 2019.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.48550/arXiv.1912.01703" title="">Pytorch: An imperative style, high-performance deep learning library</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">ArXiv</em>, abs/1912.01703.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Reimers and Gurevych (2019)</span>
<span class="ltx_bibblock">
Nils Reimers and Iryna Gurevych. 2019.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.18653/v1/D19-1410" title="">Sentence-BERT: Sentence embeddings using Siamese BERT-networks</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">Proceedings of the 2019 Conference on Empirical Methods in Natural Language Processing and the 9th International Joint Conference on Natural Language Processing (EMNLP-IJCNLP)</em>, pages 3982–3992, Hong Kong, China. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shi et al. (2023)</span>
<span class="ltx_bibblock">
Weijia Shi, Sewon Min, Michihiro Yasunaga, Minjoon Seo, Rich James, Mike Lewis, Luke Zettlemoyer, and Wen tau Yih. 2023.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.48550/arXiv.2301.12652" title="">Replug: Retrieval-augmented black-box language models</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">ArXiv</em>, abs/2301.12652.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et al. (2023)</span>
<span class="ltx_bibblock">
Hugo Touvron, Louis Martin, Kevin R. Stone, Peter Albert, Amjad Almahairi, Yasmine Babaei, Nikolay Bashlykov, Soumya Batra, and et al. 2023.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.48550/arXiv.2307.09288" title="">Llama 2: Open foundation and fine-tuned chat models</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">ArXiv</em>, abs/2307.09288.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Trivedi et al. (2021)</span>
<span class="ltx_bibblock">
H. Trivedi, Niranjan Balasubramanian, Tushar Khot, and Ashish Sabharwal. 2021.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.1162/tacl_a_00475" title="">Musique: Multihop questions via single-hop question composition</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">Transactions of the Association for Computational Linguistics</em>, 10:539–554.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et al. (2017)</span>
<span class="ltx_bibblock">
Ashish Vaswani, Noam M. Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones, Aidan N. Gomez, Lukasz Kaiser, and Illia Polosukhin. 2017.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.48550/arXiv.1706.03762" title="">Attention is all you need</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">Neural Information Processing Systems</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wei et al. (2022)</span>
<span class="ltx_bibblock">
Jason Wei, Xuezhi Wang, Dale Schuurmans, Maarten Bosma, Ed Huai hsin Chi, F. Xia, Quoc Le, and Denny Zhou. 2022.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.48550/arXiv.2201.11903" title="">Chain of thought prompting elicits reasoning in large language models</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">ArXiv</em>, abs/2201.11903.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wolf et al. (2020)</span>
<span class="ltx_bibblock">
Thomas Wolf, Lysandre Debut, Victor Sanh, Julien Chaumond, Clement Delangue, Anthony Moi, Pierric Cistac, Tim Rault, Remi Louf, and et al. 2020.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.18653/v1/2020.emnlp-demos.6" title="">Transformers: State-of-the-art natural language processing</a>.

</span>
<span class="ltx_bibblock">pages 38–45.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al. (2024)</span>
<span class="ltx_bibblock">
Siye Wu, Jian Xie, Jiangjie Chen, Tinghui Zhu, Kai Zhang, and Yanghua Xiao. 2024.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.48550/arXiv.2404.03302" title="">How easily do irrelevant inputs skew the responses of large language models?</a>
</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">ArXiv</em>, abs/2404.03302.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xiao et al. (2023)</span>
<span class="ltx_bibblock">
Shitao Xiao, Zheng Liu, Peitian Zhang, and Niklas Muennighoff. 2023.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.48550/arXiv.2309.07597" title="">C-pack: Packaged resources to advance general chinese embedding</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">ArXiv</em>, abs/2309.07597.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et al. (2023)</span>
<span class="ltx_bibblock">
Fangyuan Xu, Weijia Shi, and Eunsol Choi. 2023.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.48550/arXiv.2310.04408" title="">Recomp: Improving retrieval-augmented lms with compression and selective augmentation</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib42.1.1">ArXiv</em>, abs/2310.04408.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et al. (2024)</span>
<span class="ltx_bibblock">
Shicheng Xu, Liang Pang, Jun Xu, Huawei Shen, and Xueqi Cheng. 2024.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.1145/3589334.3645336" title="">List-aware reranking-truncation joint model for search and retrieval-augmented generation</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib43.1.1">The Web Conference</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yan et al. (2024)</span>
<span class="ltx_bibblock">
Shi-Qi Yan, Jia-Chen Gu, Yun Zhu, and Zhen-Hua Ling. 2024.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.48550/arXiv.2401.15884" title="">Corrective retrieval augmented generation</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib44.1.1">ArXiv</em>, abs/2401.15884.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. (2018)</span>
<span class="ltx_bibblock">
Zhilin Yang, Peng Qi, Saizheng Zhang, Yoshua Bengio, William W. Cohen, Ruslan Salakhutdinov, and Christopher D. Manning. 2018.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.18653/v1%2FD18-1259" title="">Hotpotqa: A dataset for diverse, explainable multi-hop question answering</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib45.1.1">Conference on Empirical Methods in Natural Language Processing</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yasunaga et al. (2023)</span>
<span class="ltx_bibblock">
Michihiro Yasunaga, Armen Aghajanyan, Weijia Shi, Rich James, Jure Leskovec, Percy Liang, Mike Lewis, Luke Zettlemoyer, and Wen tau Yih. 2023.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.48550/arXiv.2211.12561" title="">Retrieval-augmented multimodal language modeling</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib46.1.1">ArXiv</em>, abs/2211.12561.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ye and Li (2024)</span>
<span class="ltx_bibblock">
Fuda Ye and Shuangyin Li. 2024.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.1145/3589334.3645349" title="">Milecut: A multi-view truncation framework for legal case retrieval</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib47.1.1">The Web Conference</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2024)</span>
<span class="ltx_bibblock">
Tianjun Zhang, Shishir G. Patil, Naman Jain, Sheng Shen, Matei A. Zaharia, Ion Stoica, and Joseph E. Gonzalez. 2024.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.48550/arXiv.2403.10131" title="">Raft: Adapting language model to domain specific rag</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib48.1.1">ArXiv</em>, abs/2403.10131.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al. (2024)</span>
<span class="ltx_bibblock">
Penghao Zhao, Hailin Zhang, Qinhan Yu, Zhengren Wang, Yunteng Geng, Fangcheng Fu, Ling Yang, Wentao Zhang, and Bin Cui. 2024.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.48550/arXiv.2402.19473" title="">Retrieval-augmented generation for ai-generated content: A survey</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib49.1.1">ArXiv</em>, abs/2402.19473.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al. (2022)</span>
<span class="ltx_bibblock">
Wayne Xin Zhao, Jing Liu, Ruiyang Ren, and Ji rong Wen. 2022.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.1145/3637870" title="">Dense text retrieval based on pretrained language models: A survey</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib50.1.1">ACM Transactions on Information Systems</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al. (2023)</span>
<span class="ltx_bibblock">
Wayne Xin Zhao, Kun Zhou, Junyi Li, Tianyi Tang, Xiaolei Wang, Yupeng Hou, Yingqian Min, Beichen Zhang, Junjie Zhang, Zican Dong, and et al. 2023.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.48550/arXiv.2303.18223" title="">A survey of large language models</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib51.1.1">ArXiv</em>, abs/2303.18223.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhu et al. (2023a)</span>
<span class="ltx_bibblock">
Deyao Zhu, Jun Chen, Xiaoqian Shen, Xiang Li, and Mohamed Elhoseiny. 2023a.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.48550/arXiv.2304.10592" title="">Minigpt-4: Enhancing vision-language understanding with advanced large language models</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib52.1.1">ArXiv</em>, abs/2304.10592.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhu et al. (2023b)</span>
<span class="ltx_bibblock">
Yutao Zhu, Huaying Yuan, Shuting Wang, Jiongnan Liu, Wenhan Liu, Chenlong Deng, Zhicheng Dou, and Ji rong Wen. 2023b.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.48550/arXiv.2308.07107" title="">Large language models for information retrieval: A survey</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib53.1.1">ArXiv</em>, abs/2308.07107.

</span>
</li>
</ul>
</section>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Retrieval Feature Extraction Details</h2>
<div class="ltx_para" id="A1.p1">
<p class="ltx_p" id="A1.p1.1">Formally, the relevance between the query and the <math alttext="i" class="ltx_Math" display="inline" id="A1.p1.1.m1.1"><semantics id="A1.p1.1.m1.1a"><mi id="A1.p1.1.m1.1.1" xref="A1.p1.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A1.p1.1.m1.1b"><ci id="A1.p1.1.m1.1.1.cmml" xref="A1.p1.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.1.m1.1c">i</annotation><annotation encoding="application/x-llamapun" id="A1.p1.1.m1.1d">italic_i</annotation></semantics></math>-th document is calculated as:</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="r_{i}=\text{sim}\left(\mathbf{x}^{q},\mathbf{x}^{d}_{i}\right)," class="ltx_Math" display="block" id="A1.E10.m1.1"><semantics id="A1.E10.m1.1a"><mrow id="A1.E10.m1.1.1.1" xref="A1.E10.m1.1.1.1.1.cmml"><mrow id="A1.E10.m1.1.1.1.1" xref="A1.E10.m1.1.1.1.1.cmml"><msub id="A1.E10.m1.1.1.1.1.4" xref="A1.E10.m1.1.1.1.1.4.cmml"><mi id="A1.E10.m1.1.1.1.1.4.2" xref="A1.E10.m1.1.1.1.1.4.2.cmml">r</mi><mi id="A1.E10.m1.1.1.1.1.4.3" xref="A1.E10.m1.1.1.1.1.4.3.cmml">i</mi></msub><mo id="A1.E10.m1.1.1.1.1.3" xref="A1.E10.m1.1.1.1.1.3.cmml">=</mo><mrow id="A1.E10.m1.1.1.1.1.2" xref="A1.E10.m1.1.1.1.1.2.cmml"><mtext id="A1.E10.m1.1.1.1.1.2.4" xref="A1.E10.m1.1.1.1.1.2.4a.cmml">sim</mtext><mo id="A1.E10.m1.1.1.1.1.2.3" xref="A1.E10.m1.1.1.1.1.2.3.cmml">⁢</mo><mrow id="A1.E10.m1.1.1.1.1.2.2.2" xref="A1.E10.m1.1.1.1.1.2.2.3.cmml"><mo id="A1.E10.m1.1.1.1.1.2.2.2.3" xref="A1.E10.m1.1.1.1.1.2.2.3.cmml">(</mo><msup id="A1.E10.m1.1.1.1.1.1.1.1.1" xref="A1.E10.m1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E10.m1.1.1.1.1.1.1.1.1.2" xref="A1.E10.m1.1.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="A1.E10.m1.1.1.1.1.1.1.1.1.3" xref="A1.E10.m1.1.1.1.1.1.1.1.1.3.cmml">q</mi></msup><mo id="A1.E10.m1.1.1.1.1.2.2.2.4" xref="A1.E10.m1.1.1.1.1.2.2.3.cmml">,</mo><msubsup id="A1.E10.m1.1.1.1.1.2.2.2.2" xref="A1.E10.m1.1.1.1.1.2.2.2.2.cmml"><mi id="A1.E10.m1.1.1.1.1.2.2.2.2.2.2" xref="A1.E10.m1.1.1.1.1.2.2.2.2.2.2.cmml">𝐱</mi><mi id="A1.E10.m1.1.1.1.1.2.2.2.2.3" xref="A1.E10.m1.1.1.1.1.2.2.2.2.3.cmml">i</mi><mi id="A1.E10.m1.1.1.1.1.2.2.2.2.2.3" xref="A1.E10.m1.1.1.1.1.2.2.2.2.2.3.cmml">d</mi></msubsup><mo id="A1.E10.m1.1.1.1.1.2.2.2.5" xref="A1.E10.m1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E10.m1.1.1.1.2" xref="A1.E10.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E10.m1.1b"><apply id="A1.E10.m1.1.1.1.1.cmml" xref="A1.E10.m1.1.1.1"><eq id="A1.E10.m1.1.1.1.1.3.cmml" xref="A1.E10.m1.1.1.1.1.3"></eq><apply id="A1.E10.m1.1.1.1.1.4.cmml" xref="A1.E10.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="A1.E10.m1.1.1.1.1.4.1.cmml" xref="A1.E10.m1.1.1.1.1.4">subscript</csymbol><ci id="A1.E10.m1.1.1.1.1.4.2.cmml" xref="A1.E10.m1.1.1.1.1.4.2">𝑟</ci><ci id="A1.E10.m1.1.1.1.1.4.3.cmml" xref="A1.E10.m1.1.1.1.1.4.3">𝑖</ci></apply><apply id="A1.E10.m1.1.1.1.1.2.cmml" xref="A1.E10.m1.1.1.1.1.2"><times id="A1.E10.m1.1.1.1.1.2.3.cmml" xref="A1.E10.m1.1.1.1.1.2.3"></times><ci id="A1.E10.m1.1.1.1.1.2.4a.cmml" xref="A1.E10.m1.1.1.1.1.2.4"><mtext id="A1.E10.m1.1.1.1.1.2.4.cmml" xref="A1.E10.m1.1.1.1.1.2.4">sim</mtext></ci><interval closure="open" id="A1.E10.m1.1.1.1.1.2.2.3.cmml" xref="A1.E10.m1.1.1.1.1.2.2.2"><apply id="A1.E10.m1.1.1.1.1.1.1.1.1.cmml" xref="A1.E10.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E10.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E10.m1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="A1.E10.m1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E10.m1.1.1.1.1.1.1.1.1.2">𝐱</ci><ci id="A1.E10.m1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E10.m1.1.1.1.1.1.1.1.1.3">𝑞</ci></apply><apply id="A1.E10.m1.1.1.1.1.2.2.2.2.cmml" xref="A1.E10.m1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="A1.E10.m1.1.1.1.1.2.2.2.2.1.cmml" xref="A1.E10.m1.1.1.1.1.2.2.2.2">subscript</csymbol><apply id="A1.E10.m1.1.1.1.1.2.2.2.2.2.cmml" xref="A1.E10.m1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="A1.E10.m1.1.1.1.1.2.2.2.2.2.1.cmml" xref="A1.E10.m1.1.1.1.1.2.2.2.2">superscript</csymbol><ci id="A1.E10.m1.1.1.1.1.2.2.2.2.2.2.cmml" xref="A1.E10.m1.1.1.1.1.2.2.2.2.2.2">𝐱</ci><ci id="A1.E10.m1.1.1.1.1.2.2.2.2.2.3.cmml" xref="A1.E10.m1.1.1.1.1.2.2.2.2.2.3">𝑑</ci></apply><ci id="A1.E10.m1.1.1.1.1.2.2.2.2.3.cmml" xref="A1.E10.m1.1.1.1.1.2.2.2.2.3">𝑖</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E10.m1.1c">r_{i}=\text{sim}\left(\mathbf{x}^{q},\mathbf{x}^{d}_{i}\right),</annotation><annotation encoding="application/x-llamapun" id="A1.E10.m1.1d">italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = sim ( bold_x start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT , bold_x start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.p1.5">where <span class="ltx_text ltx_markedasmath" id="A1.p1.5.1">sim</span> is a similarity function such as dot product or cosine similarity, <math alttext="\mathbf{x}^{q}" class="ltx_Math" display="inline" id="A1.p1.3.m2.1"><semantics id="A1.p1.3.m2.1a"><msup id="A1.p1.3.m2.1.1" xref="A1.p1.3.m2.1.1.cmml"><mi id="A1.p1.3.m2.1.1.2" xref="A1.p1.3.m2.1.1.2.cmml">𝐱</mi><mi id="A1.p1.3.m2.1.1.3" xref="A1.p1.3.m2.1.1.3.cmml">q</mi></msup><annotation-xml encoding="MathML-Content" id="A1.p1.3.m2.1b"><apply id="A1.p1.3.m2.1.1.cmml" xref="A1.p1.3.m2.1.1"><csymbol cd="ambiguous" id="A1.p1.3.m2.1.1.1.cmml" xref="A1.p1.3.m2.1.1">superscript</csymbol><ci id="A1.p1.3.m2.1.1.2.cmml" xref="A1.p1.3.m2.1.1.2">𝐱</ci><ci id="A1.p1.3.m2.1.1.3.cmml" xref="A1.p1.3.m2.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.3.m2.1c">\mathbf{x}^{q}</annotation><annotation encoding="application/x-llamapun" id="A1.p1.3.m2.1d">bold_x start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{x}^{d}_{i}" class="ltx_Math" display="inline" id="A1.p1.4.m3.1"><semantics id="A1.p1.4.m3.1a"><msubsup id="A1.p1.4.m3.1.1" xref="A1.p1.4.m3.1.1.cmml"><mi id="A1.p1.4.m3.1.1.2.2" xref="A1.p1.4.m3.1.1.2.2.cmml">𝐱</mi><mi id="A1.p1.4.m3.1.1.3" xref="A1.p1.4.m3.1.1.3.cmml">i</mi><mi id="A1.p1.4.m3.1.1.2.3" xref="A1.p1.4.m3.1.1.2.3.cmml">d</mi></msubsup><annotation-xml encoding="MathML-Content" id="A1.p1.4.m3.1b"><apply id="A1.p1.4.m3.1.1.cmml" xref="A1.p1.4.m3.1.1"><csymbol cd="ambiguous" id="A1.p1.4.m3.1.1.1.cmml" xref="A1.p1.4.m3.1.1">subscript</csymbol><apply id="A1.p1.4.m3.1.1.2.cmml" xref="A1.p1.4.m3.1.1"><csymbol cd="ambiguous" id="A1.p1.4.m3.1.1.2.1.cmml" xref="A1.p1.4.m3.1.1">superscript</csymbol><ci id="A1.p1.4.m3.1.1.2.2.cmml" xref="A1.p1.4.m3.1.1.2.2">𝐱</ci><ci id="A1.p1.4.m3.1.1.2.3.cmml" xref="A1.p1.4.m3.1.1.2.3">𝑑</ci></apply><ci id="A1.p1.4.m3.1.1.3.cmml" xref="A1.p1.4.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.4.m3.1c">\mathbf{x}^{d}_{i}</annotation><annotation encoding="application/x-llamapun" id="A1.p1.4.m3.1d">bold_x start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> are representations of query and <math alttext="i" class="ltx_Math" display="inline" id="A1.p1.5.m4.1"><semantics id="A1.p1.5.m4.1a"><mi id="A1.p1.5.m4.1.1" xref="A1.p1.5.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A1.p1.5.m4.1b"><ci id="A1.p1.5.m4.1.1.cmml" xref="A1.p1.5.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.5.m4.1c">i</annotation><annotation encoding="application/x-llamapun" id="A1.p1.5.m4.1d">italic_i</annotation></semantics></math>-th document, respectively.</p>
</div>
<div class="ltx_para" id="A1.p2">
<p class="ltx_p" id="A1.p2.5">The precedent similarity computes the similarity score between case representation and its precedent-weighted representations in the ranking list as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\gamma_{i}{=}\text{sim}\left(\mathbf{x}^{d}_{i},\sum_{j=1}^{i-1}w_{j}\cdot%
\mathbf{x}^{d}_{j}\right),w_{j}{=}\frac{\text{exp}(r_{j})}{\sum^{k}_{\ell=1}%
\text{exp}(r_{\ell})}," class="ltx_Math" display="block" id="A1.E11.m1.3"><semantics id="A1.E11.m1.3a"><mrow id="A1.E11.m1.3.3.1"><mrow id="A1.E11.m1.3.3.1.1.2" xref="A1.E11.m1.3.3.1.1.3.cmml"><mrow id="A1.E11.m1.3.3.1.1.1.1" xref="A1.E11.m1.3.3.1.1.1.1.cmml"><msub id="A1.E11.m1.3.3.1.1.1.1.4" xref="A1.E11.m1.3.3.1.1.1.1.4.cmml"><mi id="A1.E11.m1.3.3.1.1.1.1.4.2" xref="A1.E11.m1.3.3.1.1.1.1.4.2.cmml">γ</mi><mi id="A1.E11.m1.3.3.1.1.1.1.4.3" xref="A1.E11.m1.3.3.1.1.1.1.4.3.cmml">i</mi></msub><mo id="A1.E11.m1.3.3.1.1.1.1.3" xref="A1.E11.m1.3.3.1.1.1.1.3.cmml">=</mo><mrow id="A1.E11.m1.3.3.1.1.1.1.2" xref="A1.E11.m1.3.3.1.1.1.1.2.cmml"><mtext id="A1.E11.m1.3.3.1.1.1.1.2.4" xref="A1.E11.m1.3.3.1.1.1.1.2.4a.cmml">sim</mtext><mo id="A1.E11.m1.3.3.1.1.1.1.2.3" xref="A1.E11.m1.3.3.1.1.1.1.2.3.cmml">⁢</mo><mrow id="A1.E11.m1.3.3.1.1.1.1.2.2.2" xref="A1.E11.m1.3.3.1.1.1.1.2.2.3.cmml"><mo id="A1.E11.m1.3.3.1.1.1.1.2.2.2.3" xref="A1.E11.m1.3.3.1.1.1.1.2.2.3.cmml">(</mo><msubsup id="A1.E11.m1.3.3.1.1.1.1.1.1.1.1" xref="A1.E11.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E11.m1.3.3.1.1.1.1.1.1.1.1.2.2" xref="A1.E11.m1.3.3.1.1.1.1.1.1.1.1.2.2.cmml">𝐱</mi><mi id="A1.E11.m1.3.3.1.1.1.1.1.1.1.1.3" xref="A1.E11.m1.3.3.1.1.1.1.1.1.1.1.3.cmml">i</mi><mi id="A1.E11.m1.3.3.1.1.1.1.1.1.1.1.2.3" xref="A1.E11.m1.3.3.1.1.1.1.1.1.1.1.2.3.cmml">d</mi></msubsup><mo id="A1.E11.m1.3.3.1.1.1.1.2.2.2.4" rspace="0em" xref="A1.E11.m1.3.3.1.1.1.1.2.2.3.cmml">,</mo><mrow id="A1.E11.m1.3.3.1.1.1.1.2.2.2.2" xref="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.cmml"><munderover id="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.1" xref="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.1.cmml"><mo id="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.1.2.2" movablelimits="false" xref="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.1.2.2.cmml">∑</mo><mrow id="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.1.2.3" xref="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.1.2.3.cmml"><mi id="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.1.2.3.2" xref="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.1.2.3.2.cmml">j</mi><mo id="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.1.2.3.1" xref="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.1.2.3.1.cmml">=</mo><mn id="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.1.2.3.3" xref="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.1.2.3.3.cmml">1</mn></mrow><mrow id="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.1.3" xref="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.1.3.cmml"><mi id="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.1.3.2" xref="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.1.3.2.cmml">i</mi><mo id="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.1.3.1" xref="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.1.3.1.cmml">−</mo><mn id="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.1.3.3" xref="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.1.3.3.cmml">1</mn></mrow></munderover><mrow id="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.2" xref="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.2.cmml"><msub id="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.2.2" xref="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.2.2.cmml"><mi id="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.2.2.2" xref="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.2.2.2.cmml">w</mi><mi id="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.2.2.3" xref="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.2.2.3.cmml">j</mi></msub><mo id="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.2.1" lspace="0.222em" rspace="0.222em" xref="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.2.1.cmml">⋅</mo><msubsup id="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.2.3" xref="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.2.3.cmml"><mi id="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.2.3.2.2" xref="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.2.3.2.2.cmml">𝐱</mi><mi id="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.2.3.3" xref="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.2.3.3.cmml">j</mi><mi id="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.2.3.2.3" xref="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.2.3.2.3.cmml">d</mi></msubsup></mrow></mrow><mo id="A1.E11.m1.3.3.1.1.1.1.2.2.2.5" xref="A1.E11.m1.3.3.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E11.m1.3.3.1.1.2.3" xref="A1.E11.m1.3.3.1.1.3a.cmml">,</mo><mrow id="A1.E11.m1.3.3.1.1.2.2" xref="A1.E11.m1.3.3.1.1.2.2.cmml"><msub id="A1.E11.m1.3.3.1.1.2.2.2" xref="A1.E11.m1.3.3.1.1.2.2.2.cmml"><mi id="A1.E11.m1.3.3.1.1.2.2.2.2" xref="A1.E11.m1.3.3.1.1.2.2.2.2.cmml">w</mi><mi id="A1.E11.m1.3.3.1.1.2.2.2.3" xref="A1.E11.m1.3.3.1.1.2.2.2.3.cmml">j</mi></msub><mo id="A1.E11.m1.3.3.1.1.2.2.1" xref="A1.E11.m1.3.3.1.1.2.2.1.cmml">=</mo><mfrac id="A1.E11.m1.2.2" xref="A1.E11.m1.2.2.cmml"><mrow id="A1.E11.m1.1.1.1" xref="A1.E11.m1.1.1.1.cmml"><mtext id="A1.E11.m1.1.1.1.3" xref="A1.E11.m1.1.1.1.3a.cmml">exp</mtext><mo id="A1.E11.m1.1.1.1.2" xref="A1.E11.m1.1.1.1.2.cmml">⁢</mo><mrow id="A1.E11.m1.1.1.1.1.1" xref="A1.E11.m1.1.1.1.1.1.1.cmml"><mo id="A1.E11.m1.1.1.1.1.1.2" stretchy="false" xref="A1.E11.m1.1.1.1.1.1.1.cmml">(</mo><msub id="A1.E11.m1.1.1.1.1.1.1" xref="A1.E11.m1.1.1.1.1.1.1.cmml"><mi id="A1.E11.m1.1.1.1.1.1.1.2" xref="A1.E11.m1.1.1.1.1.1.1.2.cmml">r</mi><mi id="A1.E11.m1.1.1.1.1.1.1.3" xref="A1.E11.m1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="A1.E11.m1.1.1.1.1.1.3" stretchy="false" xref="A1.E11.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="A1.E11.m1.2.2.2" xref="A1.E11.m1.2.2.2.cmml"><msubsup id="A1.E11.m1.2.2.2.2" xref="A1.E11.m1.2.2.2.2.cmml"><mo id="A1.E11.m1.2.2.2.2.2.2" xref="A1.E11.m1.2.2.2.2.2.2.cmml">∑</mo><mrow id="A1.E11.m1.2.2.2.2.3" xref="A1.E11.m1.2.2.2.2.3.cmml"><mi id="A1.E11.m1.2.2.2.2.3.2" mathvariant="normal" xref="A1.E11.m1.2.2.2.2.3.2.cmml">ℓ</mi><mo id="A1.E11.m1.2.2.2.2.3.1" xref="A1.E11.m1.2.2.2.2.3.1.cmml">=</mo><mn id="A1.E11.m1.2.2.2.2.3.3" xref="A1.E11.m1.2.2.2.2.3.3.cmml">1</mn></mrow><mi id="A1.E11.m1.2.2.2.2.2.3" xref="A1.E11.m1.2.2.2.2.2.3.cmml">k</mi></msubsup><mrow id="A1.E11.m1.2.2.2.1" xref="A1.E11.m1.2.2.2.1.cmml"><mtext id="A1.E11.m1.2.2.2.1.3" xref="A1.E11.m1.2.2.2.1.3a.cmml">exp</mtext><mo id="A1.E11.m1.2.2.2.1.2" xref="A1.E11.m1.2.2.2.1.2.cmml">⁢</mo><mrow id="A1.E11.m1.2.2.2.1.1.1" xref="A1.E11.m1.2.2.2.1.1.1.1.cmml"><mo id="A1.E11.m1.2.2.2.1.1.1.2" stretchy="false" xref="A1.E11.m1.2.2.2.1.1.1.1.cmml">(</mo><msub id="A1.E11.m1.2.2.2.1.1.1.1" xref="A1.E11.m1.2.2.2.1.1.1.1.cmml"><mi id="A1.E11.m1.2.2.2.1.1.1.1.2" xref="A1.E11.m1.2.2.2.1.1.1.1.2.cmml">r</mi><mi id="A1.E11.m1.2.2.2.1.1.1.1.3" mathvariant="normal" xref="A1.E11.m1.2.2.2.1.1.1.1.3.cmml">ℓ</mi></msub><mo id="A1.E11.m1.2.2.2.1.1.1.3" stretchy="false" xref="A1.E11.m1.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow></mrow><mo id="A1.E11.m1.3.3.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E11.m1.3b"><apply id="A1.E11.m1.3.3.1.1.3.cmml" xref="A1.E11.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="A1.E11.m1.3.3.1.1.3a.cmml" xref="A1.E11.m1.3.3.1.1.2.3">formulae-sequence</csymbol><apply id="A1.E11.m1.3.3.1.1.1.1.cmml" xref="A1.E11.m1.3.3.1.1.1.1"><eq id="A1.E11.m1.3.3.1.1.1.1.3.cmml" xref="A1.E11.m1.3.3.1.1.1.1.3"></eq><apply id="A1.E11.m1.3.3.1.1.1.1.4.cmml" xref="A1.E11.m1.3.3.1.1.1.1.4"><csymbol cd="ambiguous" id="A1.E11.m1.3.3.1.1.1.1.4.1.cmml" xref="A1.E11.m1.3.3.1.1.1.1.4">subscript</csymbol><ci id="A1.E11.m1.3.3.1.1.1.1.4.2.cmml" xref="A1.E11.m1.3.3.1.1.1.1.4.2">𝛾</ci><ci id="A1.E11.m1.3.3.1.1.1.1.4.3.cmml" xref="A1.E11.m1.3.3.1.1.1.1.4.3">𝑖</ci></apply><apply id="A1.E11.m1.3.3.1.1.1.1.2.cmml" xref="A1.E11.m1.3.3.1.1.1.1.2"><times id="A1.E11.m1.3.3.1.1.1.1.2.3.cmml" xref="A1.E11.m1.3.3.1.1.1.1.2.3"></times><ci id="A1.E11.m1.3.3.1.1.1.1.2.4a.cmml" xref="A1.E11.m1.3.3.1.1.1.1.2.4"><mtext id="A1.E11.m1.3.3.1.1.1.1.2.4.cmml" xref="A1.E11.m1.3.3.1.1.1.1.2.4">sim</mtext></ci><interval closure="open" id="A1.E11.m1.3.3.1.1.1.1.2.2.3.cmml" xref="A1.E11.m1.3.3.1.1.1.1.2.2.2"><apply id="A1.E11.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="A1.E11.m1.3.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E11.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E11.m1.3.3.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="A1.E11.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E11.m1.3.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E11.m1.3.3.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E11.m1.3.3.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="A1.E11.m1.3.3.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E11.m1.3.3.1.1.1.1.1.1.1.1.2.2">𝐱</ci><ci id="A1.E11.m1.3.3.1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.E11.m1.3.3.1.1.1.1.1.1.1.1.2.3">𝑑</ci></apply><ci id="A1.E11.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E11.m1.3.3.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.cmml" xref="A1.E11.m1.3.3.1.1.1.1.2.2.2.2"><apply id="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.1.cmml" xref="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.1"><csymbol cd="ambiguous" id="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.1.1.cmml" xref="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.1">superscript</csymbol><apply id="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.1.2.cmml" xref="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.1"><csymbol cd="ambiguous" id="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.1.2.1.cmml" xref="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.1">subscript</csymbol><sum id="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.1.2.2.cmml" xref="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.1.2.2"></sum><apply id="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.1.2.3.cmml" xref="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.1.2.3"><eq id="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.1.2.3.1.cmml" xref="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.1.2.3.1"></eq><ci id="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.1.2.3.2.cmml" xref="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.1.2.3.2">𝑗</ci><cn id="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.1.2.3.3.cmml" type="integer" xref="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.1.2.3.3">1</cn></apply></apply><apply id="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.1.3.cmml" xref="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.1.3"><minus id="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.1.3.1.cmml" xref="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.1.3.1"></minus><ci id="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.1.3.2.cmml" xref="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.1.3.2">𝑖</ci><cn id="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.1.3.3.cmml" type="integer" xref="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.1.3.3">1</cn></apply></apply><apply id="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.2.cmml" xref="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.2"><ci id="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.2.1.cmml" xref="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.2.1">⋅</ci><apply id="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.2.2.cmml" xref="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.2.2.1.cmml" xref="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.2.2">subscript</csymbol><ci id="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.2.2.2.cmml" xref="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.2.2.2">𝑤</ci><ci id="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.2.2.3.cmml" xref="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.2.2.3">𝑗</ci></apply><apply id="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.2.3.cmml" xref="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.2.3"><csymbol cd="ambiguous" id="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.2.3.1.cmml" xref="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.2.3">subscript</csymbol><apply id="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.2.3.2.cmml" xref="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.2.3"><csymbol cd="ambiguous" id="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.2.3.2.1.cmml" xref="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.2.3">superscript</csymbol><ci id="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.2.3.2.2.cmml" xref="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.2.3.2.2">𝐱</ci><ci id="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.2.3.2.3.cmml" xref="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.2.3.2.3">𝑑</ci></apply><ci id="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.2.3.3.cmml" xref="A1.E11.m1.3.3.1.1.1.1.2.2.2.2.2.3.3">𝑗</ci></apply></apply></apply></interval></apply></apply><apply id="A1.E11.m1.3.3.1.1.2.2.cmml" xref="A1.E11.m1.3.3.1.1.2.2"><eq id="A1.E11.m1.3.3.1.1.2.2.1.cmml" xref="A1.E11.m1.3.3.1.1.2.2.1"></eq><apply id="A1.E11.m1.3.3.1.1.2.2.2.cmml" xref="A1.E11.m1.3.3.1.1.2.2.2"><csymbol cd="ambiguous" id="A1.E11.m1.3.3.1.1.2.2.2.1.cmml" xref="A1.E11.m1.3.3.1.1.2.2.2">subscript</csymbol><ci id="A1.E11.m1.3.3.1.1.2.2.2.2.cmml" xref="A1.E11.m1.3.3.1.1.2.2.2.2">𝑤</ci><ci id="A1.E11.m1.3.3.1.1.2.2.2.3.cmml" xref="A1.E11.m1.3.3.1.1.2.2.2.3">𝑗</ci></apply><apply id="A1.E11.m1.2.2.cmml" xref="A1.E11.m1.2.2"><divide id="A1.E11.m1.2.2.3.cmml" xref="A1.E11.m1.2.2"></divide><apply id="A1.E11.m1.1.1.1.cmml" xref="A1.E11.m1.1.1.1"><times id="A1.E11.m1.1.1.1.2.cmml" xref="A1.E11.m1.1.1.1.2"></times><ci id="A1.E11.m1.1.1.1.3a.cmml" xref="A1.E11.m1.1.1.1.3"><mtext id="A1.E11.m1.1.1.1.3.cmml" xref="A1.E11.m1.1.1.1.3">exp</mtext></ci><apply id="A1.E11.m1.1.1.1.1.1.1.cmml" xref="A1.E11.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E11.m1.1.1.1.1.1.1.1.cmml" xref="A1.E11.m1.1.1.1.1.1">subscript</csymbol><ci id="A1.E11.m1.1.1.1.1.1.1.2.cmml" xref="A1.E11.m1.1.1.1.1.1.1.2">𝑟</ci><ci id="A1.E11.m1.1.1.1.1.1.1.3.cmml" xref="A1.E11.m1.1.1.1.1.1.1.3">𝑗</ci></apply></apply><apply id="A1.E11.m1.2.2.2.cmml" xref="A1.E11.m1.2.2.2"><apply id="A1.E11.m1.2.2.2.2.cmml" xref="A1.E11.m1.2.2.2.2"><csymbol cd="ambiguous" id="A1.E11.m1.2.2.2.2.1.cmml" xref="A1.E11.m1.2.2.2.2">subscript</csymbol><apply id="A1.E11.m1.2.2.2.2.2.cmml" xref="A1.E11.m1.2.2.2.2"><csymbol cd="ambiguous" id="A1.E11.m1.2.2.2.2.2.1.cmml" xref="A1.E11.m1.2.2.2.2">superscript</csymbol><sum id="A1.E11.m1.2.2.2.2.2.2.cmml" xref="A1.E11.m1.2.2.2.2.2.2"></sum><ci id="A1.E11.m1.2.2.2.2.2.3.cmml" xref="A1.E11.m1.2.2.2.2.2.3">𝑘</ci></apply><apply id="A1.E11.m1.2.2.2.2.3.cmml" xref="A1.E11.m1.2.2.2.2.3"><eq id="A1.E11.m1.2.2.2.2.3.1.cmml" xref="A1.E11.m1.2.2.2.2.3.1"></eq><ci id="A1.E11.m1.2.2.2.2.3.2.cmml" xref="A1.E11.m1.2.2.2.2.3.2">ℓ</ci><cn id="A1.E11.m1.2.2.2.2.3.3.cmml" type="integer" xref="A1.E11.m1.2.2.2.2.3.3">1</cn></apply></apply><apply id="A1.E11.m1.2.2.2.1.cmml" xref="A1.E11.m1.2.2.2.1"><times id="A1.E11.m1.2.2.2.1.2.cmml" xref="A1.E11.m1.2.2.2.1.2"></times><ci id="A1.E11.m1.2.2.2.1.3a.cmml" xref="A1.E11.m1.2.2.2.1.3"><mtext id="A1.E11.m1.2.2.2.1.3.cmml" xref="A1.E11.m1.2.2.2.1.3">exp</mtext></ci><apply id="A1.E11.m1.2.2.2.1.1.1.1.cmml" xref="A1.E11.m1.2.2.2.1.1.1"><csymbol cd="ambiguous" id="A1.E11.m1.2.2.2.1.1.1.1.1.cmml" xref="A1.E11.m1.2.2.2.1.1.1">subscript</csymbol><ci id="A1.E11.m1.2.2.2.1.1.1.1.2.cmml" xref="A1.E11.m1.2.2.2.1.1.1.1.2">𝑟</ci><ci id="A1.E11.m1.2.2.2.1.1.1.1.3.cmml" xref="A1.E11.m1.2.2.2.1.1.1.1.3">ℓ</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E11.m1.3c">\gamma_{i}{=}\text{sim}\left(\mathbf{x}^{d}_{i},\sum_{j=1}^{i-1}w_{j}\cdot%
\mathbf{x}^{d}_{j}\right),w_{j}{=}\frac{\text{exp}(r_{j})}{\sum^{k}_{\ell=1}%
\text{exp}(r_{\ell})},</annotation><annotation encoding="application/x-llamapun" id="A1.E11.m1.3d">italic_γ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = sim ( bold_x start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i - 1 end_POSTSUPERSCRIPT italic_w start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ⋅ bold_x start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) , italic_w start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT = divide start_ARG exp ( italic_r start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) end_ARG start_ARG ∑ start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT start_POSTSUBSCRIPT roman_ℓ = 1 end_POSTSUBSCRIPT exp ( italic_r start_POSTSUBSCRIPT roman_ℓ end_POSTSUBSCRIPT ) end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.p2.4">where <math alttext="\gamma_{i}" class="ltx_Math" display="inline" id="A1.p2.1.m1.1"><semantics id="A1.p2.1.m1.1a"><msub id="A1.p2.1.m1.1.1" xref="A1.p2.1.m1.1.1.cmml"><mi id="A1.p2.1.m1.1.1.2" xref="A1.p2.1.m1.1.1.2.cmml">γ</mi><mi id="A1.p2.1.m1.1.1.3" xref="A1.p2.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.p2.1.m1.1b"><apply id="A1.p2.1.m1.1.1.cmml" xref="A1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="A1.p2.1.m1.1.1.1.cmml" xref="A1.p2.1.m1.1.1">subscript</csymbol><ci id="A1.p2.1.m1.1.1.2.cmml" xref="A1.p2.1.m1.1.1.2">𝛾</ci><ci id="A1.p2.1.m1.1.1.3.cmml" xref="A1.p2.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.1.m1.1c">\gamma_{i}</annotation><annotation encoding="application/x-llamapun" id="A1.p2.1.m1.1d">italic_γ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is the precedent similarity between <math alttext="i" class="ltx_Math" display="inline" id="A1.p2.2.m2.1"><semantics id="A1.p2.2.m2.1a"><mi id="A1.p2.2.m2.1.1" xref="A1.p2.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A1.p2.2.m2.1b"><ci id="A1.p2.2.m2.1.1.cmml" xref="A1.p2.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.2.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="A1.p2.2.m2.1d">italic_i</annotation></semantics></math>-th document and its precedents in the ranking list, and <math alttext="r_{i}" class="ltx_Math" display="inline" id="A1.p2.3.m3.1"><semantics id="A1.p2.3.m3.1a"><msub id="A1.p2.3.m3.1.1" xref="A1.p2.3.m3.1.1.cmml"><mi id="A1.p2.3.m3.1.1.2" xref="A1.p2.3.m3.1.1.2.cmml">r</mi><mi id="A1.p2.3.m3.1.1.3" xref="A1.p2.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.p2.3.m3.1b"><apply id="A1.p2.3.m3.1.1.cmml" xref="A1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="A1.p2.3.m3.1.1.1.cmml" xref="A1.p2.3.m3.1.1">subscript</csymbol><ci id="A1.p2.3.m3.1.1.2.cmml" xref="A1.p2.3.m3.1.1.2">𝑟</ci><ci id="A1.p2.3.m3.1.1.3.cmml" xref="A1.p2.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.3.m3.1c">r_{i}</annotation><annotation encoding="application/x-llamapun" id="A1.p2.3.m3.1d">italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is relevance between the query and <math alttext="i" class="ltx_Math" display="inline" id="A1.p2.4.m4.1"><semantics id="A1.p2.4.m4.1a"><mi id="A1.p2.4.m4.1.1" xref="A1.p2.4.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A1.p2.4.m4.1b"><ci id="A1.p2.4.m4.1.1.cmml" xref="A1.p2.4.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.4.m4.1c">i</annotation><annotation encoding="application/x-llamapun" id="A1.p2.4.m4.1d">italic_i</annotation></semantics></math>-th document.</p>
</div>
<div class="ltx_para" id="A1.p3">
<p class="ltx_p" id="A1.p3.1">Neighbor similarity represents the average similarity of <math alttext="i" class="ltx_Math" display="inline" id="A1.p3.1.m1.1"><semantics id="A1.p3.1.m1.1a"><mi id="A1.p3.1.m1.1.1" xref="A1.p3.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A1.p3.1.m1.1b"><ci id="A1.p3.1.m1.1.1.cmml" xref="A1.p3.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.1.m1.1c">i</annotation><annotation encoding="application/x-llamapun" id="A1.p3.1.m1.1d">italic_i</annotation></semantics></math>-th document to its adjacent documents. Specifically, the neighbor similarity of a case in the ranking list is given by:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A7.EGx1">
<tbody id="A1.E12"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\zeta_{i}=\begin{cases}\text{sim}(\mathbf{x}^{d}_{1},\mathbf{x}^{%
d}_{2}),&amp;i=1\\
[\text{sim}(\mathbf{x}^{d}_{i{-}1},\mathbf{x}^{d}_{i})+\text{sim}(\mathbf{x}^{%
d}_{i},\mathbf{x}^{d}_{i{+}1})]/2,&amp;i\in[2,k)\\
\text{sim}(\mathbf{x}^{d}_{k-1},\mathbf{x}^{d}_{k}),&amp;i=k\end{cases}," class="ltx_Math" display="inline" id="A1.E12.m1.7"><semantics id="A1.E12.m1.7a"><mrow id="A1.E12.m1.7.7.1" xref="A1.E12.m1.7.7.1.1.cmml"><mrow id="A1.E12.m1.7.7.1.1" xref="A1.E12.m1.7.7.1.1.cmml"><msub id="A1.E12.m1.7.7.1.1.2" xref="A1.E12.m1.7.7.1.1.2.cmml"><mi id="A1.E12.m1.7.7.1.1.2.2" xref="A1.E12.m1.7.7.1.1.2.2.cmml">ζ</mi><mi id="A1.E12.m1.7.7.1.1.2.3" xref="A1.E12.m1.7.7.1.1.2.3.cmml">i</mi></msub><mo id="A1.E12.m1.7.7.1.1.1" xref="A1.E12.m1.7.7.1.1.1.cmml">=</mo><mrow id="A1.E12.m1.6.6a" xref="A1.E12.m1.7.7.1.1.3.1.cmml"><mo id="A1.E12.m1.6.6a.7" xref="A1.E12.m1.7.7.1.1.3.1.1.cmml">{</mo><mtable columnspacing="5pt" id="A1.E12.m1.6.6.6a" rowspacing="0pt" xref="A1.E12.m1.7.7.1.1.3.1.cmml"><mtr id="A1.E12.m1.6.6.6aa" xref="A1.E12.m1.7.7.1.1.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="A1.E12.m1.6.6.6ab" xref="A1.E12.m1.7.7.1.1.3.1.cmml"><mrow id="A1.E12.m1.1.1.1.1.1.1.1" xref="A1.E12.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="A1.E12.m1.1.1.1.1.1.1.1.1" xref="A1.E12.m1.1.1.1.1.1.1.1.1.cmml"><mtext id="A1.E12.m1.1.1.1.1.1.1.1.1.4" xref="A1.E12.m1.1.1.1.1.1.1.1.1.4a.cmml">sim</mtext><mo id="A1.E12.m1.1.1.1.1.1.1.1.1.3" xref="A1.E12.m1.1.1.1.1.1.1.1.1.3.cmml">⁢</mo><mrow id="A1.E12.m1.1.1.1.1.1.1.1.1.2.2" xref="A1.E12.m1.1.1.1.1.1.1.1.1.2.3.cmml"><mo id="A1.E12.m1.1.1.1.1.1.1.1.1.2.2.3" stretchy="false" xref="A1.E12.m1.1.1.1.1.1.1.1.1.2.3.cmml">(</mo><msubsup id="A1.E12.m1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E12.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E12.m1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="A1.E12.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐱</mi><mn id="A1.E12.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A1.E12.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">1</mn><mi id="A1.E12.m1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="A1.E12.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">d</mi></msubsup><mo id="A1.E12.m1.1.1.1.1.1.1.1.1.2.2.4" xref="A1.E12.m1.1.1.1.1.1.1.1.1.2.3.cmml">,</mo><msubsup id="A1.E12.m1.1.1.1.1.1.1.1.1.2.2.2" xref="A1.E12.m1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="A1.E12.m1.1.1.1.1.1.1.1.1.2.2.2.2.2" xref="A1.E12.m1.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml">𝐱</mi><mn id="A1.E12.m1.1.1.1.1.1.1.1.1.2.2.2.3" xref="A1.E12.m1.1.1.1.1.1.1.1.1.2.2.2.3.cmml">2</mn><mi id="A1.E12.m1.1.1.1.1.1.1.1.1.2.2.2.2.3" xref="A1.E12.m1.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml">d</mi></msubsup><mo id="A1.E12.m1.1.1.1.1.1.1.1.1.2.2.5" stretchy="false" xref="A1.E12.m1.1.1.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="A1.E12.m1.1.1.1.1.1.1.1.2" xref="A1.E12.m1.1.1.1.1.1.1.1.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="A1.E12.m1.6.6.6ac" xref="A1.E12.m1.7.7.1.1.3.1.cmml"><mrow id="A1.E12.m1.2.2.2.2.2.1" xref="A1.E12.m1.2.2.2.2.2.1.cmml"><mi id="A1.E12.m1.2.2.2.2.2.1.2" xref="A1.E12.m1.2.2.2.2.2.1.2.cmml">i</mi><mo id="A1.E12.m1.2.2.2.2.2.1.1" xref="A1.E12.m1.2.2.2.2.2.1.1.cmml">=</mo><mn id="A1.E12.m1.2.2.2.2.2.1.3" xref="A1.E12.m1.2.2.2.2.2.1.3.cmml">1</mn></mrow></mtd></mtr><mtr id="A1.E12.m1.6.6.6ad" xref="A1.E12.m1.7.7.1.1.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="A1.E12.m1.6.6.6ae" xref="A1.E12.m1.7.7.1.1.3.1.cmml"><mrow id="A1.E12.m1.3.3.3.3.1.1.1" xref="A1.E12.m1.3.3.3.3.1.1.1.1.cmml"><mrow id="A1.E12.m1.3.3.3.3.1.1.1.1" xref="A1.E12.m1.3.3.3.3.1.1.1.1.cmml"><mrow id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.2.cmml"><mo id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.2" stretchy="false" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.2.1.cmml">[</mo><mrow id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.cmml"><mrow id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.2" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.2.cmml"><mtext id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.2.4" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.2.4a.cmml">sim</mtext><mo id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.2.3" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.2.3.cmml">⁢</mo><mrow id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.2.2.2" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.2.2.3.cmml"><mo id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.2.2.2.3" stretchy="false" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.2.2.3.cmml">(</mo><msubsup id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐱</mi><mrow id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.3" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.3.1" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">d</mi></msubsup><mo id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.2.2.2.4" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.2.2.3.cmml">,</mo><msubsup id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.2.2.2.2" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.2.2.2.2.cmml"><mi id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.2.2.2.2.2.2" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.2.2.2.2.2.2.cmml">𝐱</mi><mi id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.2.2.2.2.3" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.2.2.2.2.3.cmml">i</mi><mi id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.2.2.2.2.2.3" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.2.2.2.2.2.3.cmml">d</mi></msubsup><mo id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.2.2.2.5" stretchy="false" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.5" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.5.cmml">+</mo><mrow id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.4" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.4.cmml"><mtext id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.4.4" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.4.4a.cmml">sim</mtext><mo id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.4.3" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.4.3.cmml">⁢</mo><mrow id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.4.2.2" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.4.2.3.cmml"><mo id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.4.2.2.3" stretchy="false" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.4.2.3.cmml">(</mo><msubsup id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.3.1.1.1" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.3.1.1.1.cmml"><mi id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.3.1.1.1.2.2" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.3.1.1.1.2.2.cmml">𝐱</mi><mi id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.3.1.1.1.3" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.3.1.1.1.3.cmml">i</mi><mi id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.3.1.1.1.2.3" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.3.1.1.1.2.3.cmml">d</mi></msubsup><mo id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.4.2.2.4" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.4.2.3.cmml">,</mo><msubsup id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.4.2.2.2" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.4.2.2.2.cmml"><mi id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.4.2.2.2.2.2" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.4.2.2.2.2.2.cmml">𝐱</mi><mrow id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.4.2.2.2.3" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.4.2.2.2.3.cmml"><mi id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.4.2.2.2.3.2" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.4.2.2.2.3.2.cmml">i</mi><mo id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.4.2.2.2.3.1" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.4.2.2.2.3.1.cmml">+</mo><mn id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.4.2.2.2.3.3" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.4.2.2.2.3.3.cmml">1</mn></mrow><mi id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.4.2.2.2.2.3" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.4.2.2.2.2.3.cmml">d</mi></msubsup><mo id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.4.2.2.5" stretchy="false" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.4.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.3" stretchy="false" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.2.1.cmml">]</mo></mrow><mo id="A1.E12.m1.3.3.3.3.1.1.1.1.2" xref="A1.E12.m1.3.3.3.3.1.1.1.1.2.cmml">/</mo><mn id="A1.E12.m1.3.3.3.3.1.1.1.1.3" xref="A1.E12.m1.3.3.3.3.1.1.1.1.3.cmml">2</mn></mrow><mo id="A1.E12.m1.3.3.3.3.1.1.1.2" xref="A1.E12.m1.3.3.3.3.1.1.1.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="A1.E12.m1.6.6.6af" xref="A1.E12.m1.7.7.1.1.3.1.cmml"><mrow id="A1.E12.m1.4.4.4.4.2.1" xref="A1.E12.m1.4.4.4.4.2.1.cmml"><mi id="A1.E12.m1.4.4.4.4.2.1.4" xref="A1.E12.m1.4.4.4.4.2.1.4.cmml">i</mi><mo id="A1.E12.m1.4.4.4.4.2.1.3" xref="A1.E12.m1.4.4.4.4.2.1.3.cmml">∈</mo><mrow id="A1.E12.m1.4.4.4.4.2.1.5.2" xref="A1.E12.m1.4.4.4.4.2.1.5.1.cmml"><mo id="A1.E12.m1.4.4.4.4.2.1.5.2.1" stretchy="false" xref="A1.E12.m1.4.4.4.4.2.1.5.1.cmml">[</mo><mn id="A1.E12.m1.4.4.4.4.2.1.1" xref="A1.E12.m1.4.4.4.4.2.1.1.cmml">2</mn><mo id="A1.E12.m1.4.4.4.4.2.1.5.2.2" xref="A1.E12.m1.4.4.4.4.2.1.5.1.cmml">,</mo><mi id="A1.E12.m1.4.4.4.4.2.1.2" xref="A1.E12.m1.4.4.4.4.2.1.2.cmml">k</mi><mo id="A1.E12.m1.4.4.4.4.2.1.5.2.3" stretchy="false" xref="A1.E12.m1.4.4.4.4.2.1.5.1.cmml">)</mo></mrow></mrow></mtd></mtr><mtr id="A1.E12.m1.6.6.6ag" xref="A1.E12.m1.7.7.1.1.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="A1.E12.m1.6.6.6ah" xref="A1.E12.m1.7.7.1.1.3.1.cmml"><mrow id="A1.E12.m1.5.5.5.5.1.1.1" xref="A1.E12.m1.5.5.5.5.1.1.1.1.cmml"><mrow id="A1.E12.m1.5.5.5.5.1.1.1.1" xref="A1.E12.m1.5.5.5.5.1.1.1.1.cmml"><mtext id="A1.E12.m1.5.5.5.5.1.1.1.1.4" xref="A1.E12.m1.5.5.5.5.1.1.1.1.4a.cmml">sim</mtext><mo id="A1.E12.m1.5.5.5.5.1.1.1.1.3" xref="A1.E12.m1.5.5.5.5.1.1.1.1.3.cmml">⁢</mo><mrow id="A1.E12.m1.5.5.5.5.1.1.1.1.2.2" xref="A1.E12.m1.5.5.5.5.1.1.1.1.2.3.cmml"><mo id="A1.E12.m1.5.5.5.5.1.1.1.1.2.2.3" stretchy="false" xref="A1.E12.m1.5.5.5.5.1.1.1.1.2.3.cmml">(</mo><msubsup id="A1.E12.m1.5.5.5.5.1.1.1.1.1.1.1" xref="A1.E12.m1.5.5.5.5.1.1.1.1.1.1.1.cmml"><mi id="A1.E12.m1.5.5.5.5.1.1.1.1.1.1.1.2.2" xref="A1.E12.m1.5.5.5.5.1.1.1.1.1.1.1.2.2.cmml">𝐱</mi><mrow id="A1.E12.m1.5.5.5.5.1.1.1.1.1.1.1.3" xref="A1.E12.m1.5.5.5.5.1.1.1.1.1.1.1.3.cmml"><mi id="A1.E12.m1.5.5.5.5.1.1.1.1.1.1.1.3.2" xref="A1.E12.m1.5.5.5.5.1.1.1.1.1.1.1.3.2.cmml">k</mi><mo id="A1.E12.m1.5.5.5.5.1.1.1.1.1.1.1.3.1" xref="A1.E12.m1.5.5.5.5.1.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="A1.E12.m1.5.5.5.5.1.1.1.1.1.1.1.3.3" xref="A1.E12.m1.5.5.5.5.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="A1.E12.m1.5.5.5.5.1.1.1.1.1.1.1.2.3" xref="A1.E12.m1.5.5.5.5.1.1.1.1.1.1.1.2.3.cmml">d</mi></msubsup><mo id="A1.E12.m1.5.5.5.5.1.1.1.1.2.2.4" xref="A1.E12.m1.5.5.5.5.1.1.1.1.2.3.cmml">,</mo><msubsup id="A1.E12.m1.5.5.5.5.1.1.1.1.2.2.2" xref="A1.E12.m1.5.5.5.5.1.1.1.1.2.2.2.cmml"><mi id="A1.E12.m1.5.5.5.5.1.1.1.1.2.2.2.2.2" xref="A1.E12.m1.5.5.5.5.1.1.1.1.2.2.2.2.2.cmml">𝐱</mi><mi id="A1.E12.m1.5.5.5.5.1.1.1.1.2.2.2.3" xref="A1.E12.m1.5.5.5.5.1.1.1.1.2.2.2.3.cmml">k</mi><mi id="A1.E12.m1.5.5.5.5.1.1.1.1.2.2.2.2.3" xref="A1.E12.m1.5.5.5.5.1.1.1.1.2.2.2.2.3.cmml">d</mi></msubsup><mo id="A1.E12.m1.5.5.5.5.1.1.1.1.2.2.5" stretchy="false" xref="A1.E12.m1.5.5.5.5.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="A1.E12.m1.5.5.5.5.1.1.1.2" xref="A1.E12.m1.5.5.5.5.1.1.1.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="A1.E12.m1.6.6.6ai" xref="A1.E12.m1.7.7.1.1.3.1.cmml"><mrow id="A1.E12.m1.6.6.6.6.2.1" xref="A1.E12.m1.6.6.6.6.2.1.cmml"><mi id="A1.E12.m1.6.6.6.6.2.1.2" xref="A1.E12.m1.6.6.6.6.2.1.2.cmml">i</mi><mo id="A1.E12.m1.6.6.6.6.2.1.1" xref="A1.E12.m1.6.6.6.6.2.1.1.cmml">=</mo><mi id="A1.E12.m1.6.6.6.6.2.1.3" xref="A1.E12.m1.6.6.6.6.2.1.3.cmml">k</mi></mrow></mtd></mtr></mtable></mrow></mrow><mo id="A1.E12.m1.7.7.1.2" xref="A1.E12.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E12.m1.7b"><apply id="A1.E12.m1.7.7.1.1.cmml" xref="A1.E12.m1.7.7.1"><eq id="A1.E12.m1.7.7.1.1.1.cmml" xref="A1.E12.m1.7.7.1.1.1"></eq><apply id="A1.E12.m1.7.7.1.1.2.cmml" xref="A1.E12.m1.7.7.1.1.2"><csymbol cd="ambiguous" id="A1.E12.m1.7.7.1.1.2.1.cmml" xref="A1.E12.m1.7.7.1.1.2">subscript</csymbol><ci id="A1.E12.m1.7.7.1.1.2.2.cmml" xref="A1.E12.m1.7.7.1.1.2.2">𝜁</ci><ci id="A1.E12.m1.7.7.1.1.2.3.cmml" xref="A1.E12.m1.7.7.1.1.2.3">𝑖</ci></apply><apply id="A1.E12.m1.7.7.1.1.3.1.cmml" xref="A1.E12.m1.6.6a"><csymbol cd="latexml" id="A1.E12.m1.7.7.1.1.3.1.1.cmml" xref="A1.E12.m1.6.6a.7">cases</csymbol><apply id="A1.E12.m1.1.1.1.1.1.1.1.1.cmml" xref="A1.E12.m1.1.1.1.1.1.1.1"><times id="A1.E12.m1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E12.m1.1.1.1.1.1.1.1.1.3"></times><ci id="A1.E12.m1.1.1.1.1.1.1.1.1.4a.cmml" xref="A1.E12.m1.1.1.1.1.1.1.1.1.4"><mtext id="A1.E12.m1.1.1.1.1.1.1.1.1.4.cmml" xref="A1.E12.m1.1.1.1.1.1.1.1.1.4">sim</mtext></ci><interval closure="open" id="A1.E12.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.E12.m1.1.1.1.1.1.1.1.1.2.2"><apply id="A1.E12.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E12.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E12.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E12.m1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="A1.E12.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E12.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E12.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E12.m1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="A1.E12.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E12.m1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝐱</ci><ci id="A1.E12.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.E12.m1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑑</ci></apply><cn id="A1.E12.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="A1.E12.m1.1.1.1.1.1.1.1.1.1.1.1.3">1</cn></apply><apply id="A1.E12.m1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="A1.E12.m1.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A1.E12.m1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="A1.E12.m1.1.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><apply id="A1.E12.m1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="A1.E12.m1.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A1.E12.m1.1.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="A1.E12.m1.1.1.1.1.1.1.1.1.2.2.2">superscript</csymbol><ci id="A1.E12.m1.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="A1.E12.m1.1.1.1.1.1.1.1.1.2.2.2.2.2">𝐱</ci><ci id="A1.E12.m1.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="A1.E12.m1.1.1.1.1.1.1.1.1.2.2.2.2.3">𝑑</ci></apply><cn id="A1.E12.m1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" type="integer" xref="A1.E12.m1.1.1.1.1.1.1.1.1.2.2.2.3">2</cn></apply></interval></apply><apply id="A1.E12.m1.2.2.2.2.2.1.cmml" xref="A1.E12.m1.2.2.2.2.2.1"><eq id="A1.E12.m1.2.2.2.2.2.1.1.cmml" xref="A1.E12.m1.2.2.2.2.2.1.1"></eq><ci id="A1.E12.m1.2.2.2.2.2.1.2.cmml" xref="A1.E12.m1.2.2.2.2.2.1.2">𝑖</ci><cn id="A1.E12.m1.2.2.2.2.2.1.3.cmml" type="integer" xref="A1.E12.m1.2.2.2.2.2.1.3">1</cn></apply><apply id="A1.E12.m1.3.3.3.3.1.1.1.1.cmml" xref="A1.E12.m1.3.3.3.3.1.1.1"><divide id="A1.E12.m1.3.3.3.3.1.1.1.1.2.cmml" xref="A1.E12.m1.3.3.3.3.1.1.1.1.2"></divide><apply id="A1.E12.m1.3.3.3.3.1.1.1.1.1.2.cmml" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.E12.m1.3.3.3.3.1.1.1.1.1.2.1.cmml" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.cmml" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1"><plus id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.5.cmml" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.5"></plus><apply id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.2.cmml" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.2"><times id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.2.3.cmml" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.2.3"></times><ci id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.2.4a.cmml" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.2.4"><mtext id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.2.4.cmml" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.2.4">sim</mtext></ci><interval closure="open" id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.2.2.3.cmml" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.2.2.2"><apply id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2">𝐱</ci><ci id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑑</ci></apply><apply id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.3"><minus id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.3.1"></minus><ci id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑖</ci><cn id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.2.2.2.2">subscript</csymbol><apply id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.2.2.2.2.2.1.cmml" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.2.2.2.2">superscript</csymbol><ci id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.2.2.2.2.2.2.cmml" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.2.2.2.2.2.2">𝐱</ci><ci id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.2.2.2.2.2.3.cmml" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.2.2.2.2.2.3">𝑑</ci></apply><ci id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.2.2.2.2.3">𝑖</ci></apply></interval></apply><apply id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.4.cmml" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.4"><times id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.4.3.cmml" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.4.3"></times><ci id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.4.4a.cmml" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.4.4"><mtext id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.4.4.cmml" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.4.4">sim</mtext></ci><interval closure="open" id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.4.2.3.cmml" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.4.2.2"><apply id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.3.1.1.1.cmml" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.3.1.1.1"><csymbol cd="ambiguous" id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.3.1.1.1.1.cmml" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.3.1.1.1">subscript</csymbol><apply id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.3.1.1.1.2.cmml" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.3.1.1.1"><csymbol cd="ambiguous" id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.3.1.1.1.2.1.cmml" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.3.1.1.1">superscript</csymbol><ci id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.3.1.1.1.2.2.cmml" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.3.1.1.1.2.2">𝐱</ci><ci id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.3.1.1.1.2.3.cmml" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.3.1.1.1.2.3">𝑑</ci></apply><ci id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.3.1.1.1.3.cmml" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.3.1.1.1.3">𝑖</ci></apply><apply id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.4.2.2.2.cmml" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.4.2.2.2"><csymbol cd="ambiguous" id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.4.2.2.2.1.cmml" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.4.2.2.2">subscript</csymbol><apply id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.4.2.2.2.2.cmml" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.4.2.2.2"><csymbol cd="ambiguous" id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.4.2.2.2.2.1.cmml" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.4.2.2.2">superscript</csymbol><ci id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.4.2.2.2.2.2.cmml" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.4.2.2.2.2.2">𝐱</ci><ci id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.4.2.2.2.2.3.cmml" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.4.2.2.2.2.3">𝑑</ci></apply><apply id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.4.2.2.2.3.cmml" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.4.2.2.2.3"><plus id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.4.2.2.2.3.1.cmml" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.4.2.2.2.3.1"></plus><ci id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.4.2.2.2.3.2.cmml" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.4.2.2.2.3.2">𝑖</ci><cn id="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.4.2.2.2.3.3.cmml" type="integer" xref="A1.E12.m1.3.3.3.3.1.1.1.1.1.1.1.4.2.2.2.3.3">1</cn></apply></apply></interval></apply></apply></apply><cn id="A1.E12.m1.3.3.3.3.1.1.1.1.3.cmml" type="integer" xref="A1.E12.m1.3.3.3.3.1.1.1.1.3">2</cn></apply><apply id="A1.E12.m1.4.4.4.4.2.1.cmml" xref="A1.E12.m1.4.4.4.4.2.1"><in id="A1.E12.m1.4.4.4.4.2.1.3.cmml" xref="A1.E12.m1.4.4.4.4.2.1.3"></in><ci id="A1.E12.m1.4.4.4.4.2.1.4.cmml" xref="A1.E12.m1.4.4.4.4.2.1.4">𝑖</ci><interval closure="closed-open" id="A1.E12.m1.4.4.4.4.2.1.5.1.cmml" xref="A1.E12.m1.4.4.4.4.2.1.5.2"><cn id="A1.E12.m1.4.4.4.4.2.1.1.cmml" type="integer" xref="A1.E12.m1.4.4.4.4.2.1.1">2</cn><ci id="A1.E12.m1.4.4.4.4.2.1.2.cmml" xref="A1.E12.m1.4.4.4.4.2.1.2">𝑘</ci></interval></apply><apply id="A1.E12.m1.5.5.5.5.1.1.1.1.cmml" xref="A1.E12.m1.5.5.5.5.1.1.1"><times id="A1.E12.m1.5.5.5.5.1.1.1.1.3.cmml" xref="A1.E12.m1.5.5.5.5.1.1.1.1.3"></times><ci id="A1.E12.m1.5.5.5.5.1.1.1.1.4a.cmml" xref="A1.E12.m1.5.5.5.5.1.1.1.1.4"><mtext id="A1.E12.m1.5.5.5.5.1.1.1.1.4.cmml" xref="A1.E12.m1.5.5.5.5.1.1.1.1.4">sim</mtext></ci><interval closure="open" id="A1.E12.m1.5.5.5.5.1.1.1.1.2.3.cmml" xref="A1.E12.m1.5.5.5.5.1.1.1.1.2.2"><apply id="A1.E12.m1.5.5.5.5.1.1.1.1.1.1.1.cmml" xref="A1.E12.m1.5.5.5.5.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E12.m1.5.5.5.5.1.1.1.1.1.1.1.1.cmml" xref="A1.E12.m1.5.5.5.5.1.1.1.1.1.1.1">subscript</csymbol><apply id="A1.E12.m1.5.5.5.5.1.1.1.1.1.1.1.2.cmml" xref="A1.E12.m1.5.5.5.5.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E12.m1.5.5.5.5.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E12.m1.5.5.5.5.1.1.1.1.1.1.1">superscript</csymbol><ci id="A1.E12.m1.5.5.5.5.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E12.m1.5.5.5.5.1.1.1.1.1.1.1.2.2">𝐱</ci><ci id="A1.E12.m1.5.5.5.5.1.1.1.1.1.1.1.2.3.cmml" xref="A1.E12.m1.5.5.5.5.1.1.1.1.1.1.1.2.3">𝑑</ci></apply><apply id="A1.E12.m1.5.5.5.5.1.1.1.1.1.1.1.3.cmml" xref="A1.E12.m1.5.5.5.5.1.1.1.1.1.1.1.3"><minus id="A1.E12.m1.5.5.5.5.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E12.m1.5.5.5.5.1.1.1.1.1.1.1.3.1"></minus><ci id="A1.E12.m1.5.5.5.5.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E12.m1.5.5.5.5.1.1.1.1.1.1.1.3.2">𝑘</ci><cn id="A1.E12.m1.5.5.5.5.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="A1.E12.m1.5.5.5.5.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="A1.E12.m1.5.5.5.5.1.1.1.1.2.2.2.cmml" xref="A1.E12.m1.5.5.5.5.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A1.E12.m1.5.5.5.5.1.1.1.1.2.2.2.1.cmml" xref="A1.E12.m1.5.5.5.5.1.1.1.1.2.2.2">subscript</csymbol><apply id="A1.E12.m1.5.5.5.5.1.1.1.1.2.2.2.2.cmml" xref="A1.E12.m1.5.5.5.5.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A1.E12.m1.5.5.5.5.1.1.1.1.2.2.2.2.1.cmml" xref="A1.E12.m1.5.5.5.5.1.1.1.1.2.2.2">superscript</csymbol><ci id="A1.E12.m1.5.5.5.5.1.1.1.1.2.2.2.2.2.cmml" xref="A1.E12.m1.5.5.5.5.1.1.1.1.2.2.2.2.2">𝐱</ci><ci id="A1.E12.m1.5.5.5.5.1.1.1.1.2.2.2.2.3.cmml" xref="A1.E12.m1.5.5.5.5.1.1.1.1.2.2.2.2.3">𝑑</ci></apply><ci id="A1.E12.m1.5.5.5.5.1.1.1.1.2.2.2.3.cmml" xref="A1.E12.m1.5.5.5.5.1.1.1.1.2.2.2.3">𝑘</ci></apply></interval></apply><apply id="A1.E12.m1.6.6.6.6.2.1.cmml" xref="A1.E12.m1.6.6.6.6.2.1"><eq id="A1.E12.m1.6.6.6.6.2.1.1.cmml" xref="A1.E12.m1.6.6.6.6.2.1.1"></eq><ci id="A1.E12.m1.6.6.6.6.2.1.2.cmml" xref="A1.E12.m1.6.6.6.6.2.1.2">𝑖</ci><ci id="A1.E12.m1.6.6.6.6.2.1.3.cmml" xref="A1.E12.m1.6.6.6.6.2.1.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E12.m1.7c">\displaystyle\zeta_{i}=\begin{cases}\text{sim}(\mathbf{x}^{d}_{1},\mathbf{x}^{%
d}_{2}),&amp;i=1\\
[\text{sim}(\mathbf{x}^{d}_{i{-}1},\mathbf{x}^{d}_{i})+\text{sim}(\mathbf{x}^{%
d}_{i},\mathbf{x}^{d}_{i{+}1})]/2,&amp;i\in[2,k)\\
\text{sim}(\mathbf{x}^{d}_{k-1},\mathbf{x}^{d}_{k}),&amp;i=k\end{cases},</annotation><annotation encoding="application/x-llamapun" id="A1.E12.m1.7d">italic_ζ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = { start_ROW start_CELL sim ( bold_x start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , bold_x start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) , end_CELL start_CELL italic_i = 1 end_CELL end_ROW start_ROW start_CELL [ sim ( bold_x start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i - 1 end_POSTSUBSCRIPT , bold_x start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) + sim ( bold_x start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , bold_x start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT ) ] / 2 , end_CELL start_CELL italic_i ∈ [ 2 , italic_k ) end_CELL end_ROW start_ROW start_CELL sim ( bold_x start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k - 1 end_POSTSUBSCRIPT , bold_x start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) , end_CELL start_CELL italic_i = italic_k end_CELL end_ROW ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.p3.3">where <math alttext="\zeta_{i}" class="ltx_Math" display="inline" id="A1.p3.2.m1.1"><semantics id="A1.p3.2.m1.1a"><msub id="A1.p3.2.m1.1.1" xref="A1.p3.2.m1.1.1.cmml"><mi id="A1.p3.2.m1.1.1.2" xref="A1.p3.2.m1.1.1.2.cmml">ζ</mi><mi id="A1.p3.2.m1.1.1.3" xref="A1.p3.2.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A1.p3.2.m1.1b"><apply id="A1.p3.2.m1.1.1.cmml" xref="A1.p3.2.m1.1.1"><csymbol cd="ambiguous" id="A1.p3.2.m1.1.1.1.cmml" xref="A1.p3.2.m1.1.1">subscript</csymbol><ci id="A1.p3.2.m1.1.1.2.cmml" xref="A1.p3.2.m1.1.1.2">𝜁</ci><ci id="A1.p3.2.m1.1.1.3.cmml" xref="A1.p3.2.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.2.m1.1c">\zeta_{i}</annotation><annotation encoding="application/x-llamapun" id="A1.p3.2.m1.1d">italic_ζ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> represents the average similarity of <math alttext="i" class="ltx_Math" display="inline" id="A1.p3.3.m2.1"><semantics id="A1.p3.3.m2.1a"><mi id="A1.p3.3.m2.1.1" xref="A1.p3.3.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A1.p3.3.m2.1b"><ci id="A1.p3.3.m2.1.1.cmml" xref="A1.p3.3.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.3.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="A1.p3.3.m2.1d">italic_i</annotation></semantics></math>-th document to its adjacent documents. Such that we can get the list-wise features among documents.</p>
</div>
<figure class="ltx_table" id="A1.T4">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="A1.T4.7">
<tr class="ltx_tr" id="A1.T4.7.8">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="A1.T4.7.8.1"><span class="ltx_text ltx_font_bold" id="A1.T4.7.8.1.1">Datasets</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A1.T4.7.8.2"><span class="ltx_text ltx_font_bold" id="A1.T4.7.8.2.1">Language</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A1.T4.7.8.3"><span class="ltx_text ltx_font_bold" id="A1.T4.7.8.3.1"># Query</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A1.T4.7.8.4"><span class="ltx_text ltx_font_bold" id="A1.T4.7.8.4.1"># Train/Test</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A1.T4.7.8.5"><span class="ltx_text ltx_font_bold" id="A1.T4.7.8.5.1"># Tokens</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A1.T4.7.8.6"><span class="ltx_text ltx_font_bold" id="A1.T4.7.8.6.1"># Rel/Docs</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A1.T4.7.8.7"><span class="ltx_text ltx_font_bold" id="A1.T4.7.8.7.1">MAP</span></td>
</tr>
<tr class="ltx_tr" id="A1.T4.1.1">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A1.T4.1.1.2">NQ-10</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T4.1.1.3">English</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T4.1.1.4">2655</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T4.1.1.5">2124/531</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T4.1.1.1">
<math alttext="\sim" class="ltx_Math" display="inline" id="A1.T4.1.1.1.m1.1"><semantics id="A1.T4.1.1.1.m1.1a"><mo id="A1.T4.1.1.1.m1.1.1" xref="A1.T4.1.1.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="A1.T4.1.1.1.m1.1b"><csymbol cd="latexml" id="A1.T4.1.1.1.m1.1.1.cmml" xref="A1.T4.1.1.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.1.1.1.m1.1c">\sim</annotation><annotation encoding="application/x-llamapun" id="A1.T4.1.1.1.m1.1d">∼</annotation></semantics></math>2k</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T4.1.1.6">1/10</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T4.1.1.7">0.9602</td>
</tr>
<tr class="ltx_tr" id="A1.T4.2.2">
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T4.2.2.2">NQ-20</td>
<td class="ltx_td ltx_align_center" id="A1.T4.2.2.3">English</td>
<td class="ltx_td ltx_align_center" id="A1.T4.2.2.4">2655</td>
<td class="ltx_td ltx_align_center" id="A1.T4.2.2.5">2124/531</td>
<td class="ltx_td ltx_align_center" id="A1.T4.2.2.1">
<math alttext="\sim" class="ltx_Math" display="inline" id="A1.T4.2.2.1.m1.1"><semantics id="A1.T4.2.2.1.m1.1a"><mo id="A1.T4.2.2.1.m1.1.1" xref="A1.T4.2.2.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="A1.T4.2.2.1.m1.1b"><csymbol cd="latexml" id="A1.T4.2.2.1.m1.1.1.cmml" xref="A1.T4.2.2.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.2.2.1.m1.1c">\sim</annotation><annotation encoding="application/x-llamapun" id="A1.T4.2.2.1.m1.1d">∼</annotation></semantics></math>4k</td>
<td class="ltx_td ltx_align_center" id="A1.T4.2.2.6">1/20</td>
<td class="ltx_td ltx_align_center" id="A1.T4.2.2.7">0.9287</td>
</tr>
<tr class="ltx_tr" id="A1.T4.3.3">
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T4.3.3.2">NQ-30</td>
<td class="ltx_td ltx_align_center" id="A1.T4.3.3.3">English</td>
<td class="ltx_td ltx_align_center" id="A1.T4.3.3.4">2655</td>
<td class="ltx_td ltx_align_center" id="A1.T4.3.3.5">2124/531</td>
<td class="ltx_td ltx_align_center" id="A1.T4.3.3.1">
<math alttext="\sim" class="ltx_Math" display="inline" id="A1.T4.3.3.1.m1.1"><semantics id="A1.T4.3.3.1.m1.1a"><mo id="A1.T4.3.3.1.m1.1.1" xref="A1.T4.3.3.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="A1.T4.3.3.1.m1.1b"><csymbol cd="latexml" id="A1.T4.3.3.1.m1.1.1.cmml" xref="A1.T4.3.3.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.3.3.1.m1.1c">\sim</annotation><annotation encoding="application/x-llamapun" id="A1.T4.3.3.1.m1.1d">∼</annotation></semantics></math>6k</td>
<td class="ltx_td ltx_align_center" id="A1.T4.3.3.6">1/30</td>
<td class="ltx_td ltx_align_center" id="A1.T4.3.3.7">0.9215</td>
</tr>
<tr class="ltx_tr" id="A1.T4.4.4">
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T4.4.4.2">HotpotQA</td>
<td class="ltx_td ltx_align_center" id="A1.T4.4.4.3">English</td>
<td class="ltx_td ltx_align_center" id="A1.T4.4.4.4">97852</td>
<td class="ltx_td ltx_align_center" id="A1.T4.4.4.5">90447/7405</td>
<td class="ltx_td ltx_align_center" id="A1.T4.4.4.1">
<math alttext="\sim" class="ltx_Math" display="inline" id="A1.T4.4.4.1.m1.1"><semantics id="A1.T4.4.4.1.m1.1a"><mo id="A1.T4.4.4.1.m1.1.1" xref="A1.T4.4.4.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="A1.T4.4.4.1.m1.1b"><csymbol cd="latexml" id="A1.T4.4.4.1.m1.1.1.cmml" xref="A1.T4.4.4.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.4.4.1.m1.1c">\sim</annotation><annotation encoding="application/x-llamapun" id="A1.T4.4.4.1.m1.1d">∼</annotation></semantics></math>2k</td>
<td class="ltx_td ltx_align_center" id="A1.T4.4.4.6">2.36/10</td>
<td class="ltx_td ltx_align_center" id="A1.T4.4.4.7">0.9138</td>
</tr>
<tr class="ltx_tr" id="A1.T4.5.5">
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T4.5.5.2">MuSiQue</td>
<td class="ltx_td ltx_align_center" id="A1.T4.5.5.3">English</td>
<td class="ltx_td ltx_align_center" id="A1.T4.5.5.4">22355</td>
<td class="ltx_td ltx_align_center" id="A1.T4.5.5.5">19938/2417</td>
<td class="ltx_td ltx_align_center" id="A1.T4.5.5.1">
<math alttext="\sim" class="ltx_Math" display="inline" id="A1.T4.5.5.1.m1.1"><semantics id="A1.T4.5.5.1.m1.1a"><mo id="A1.T4.5.5.1.m1.1.1" xref="A1.T4.5.5.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="A1.T4.5.5.1.m1.1b"><csymbol cd="latexml" id="A1.T4.5.5.1.m1.1.1.cmml" xref="A1.T4.5.5.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.5.5.1.m1.1c">\sim</annotation><annotation encoding="application/x-llamapun" id="A1.T4.5.5.1.m1.1d">∼</annotation></semantics></math>3k</td>
<td class="ltx_td ltx_align_center" id="A1.T4.5.5.6">2.37/20</td>
<td class="ltx_td ltx_align_center" id="A1.T4.5.5.7">0.5726</td>
</tr>
<tr class="ltx_tr" id="A1.T4.6.6">
<td class="ltx_td ltx_align_center ltx_border_r" id="A1.T4.6.6.2">2Wiki</td>
<td class="ltx_td ltx_align_center" id="A1.T4.6.6.3">English</td>
<td class="ltx_td ltx_align_center" id="A1.T4.6.6.4">180030</td>
<td class="ltx_td ltx_align_center" id="A1.T4.6.6.5">167454/12576</td>
<td class="ltx_td ltx_align_center" id="A1.T4.6.6.1">
<math alttext="\sim" class="ltx_Math" display="inline" id="A1.T4.6.6.1.m1.1"><semantics id="A1.T4.6.6.1.m1.1a"><mo id="A1.T4.6.6.1.m1.1.1" xref="A1.T4.6.6.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="A1.T4.6.6.1.m1.1b"><csymbol cd="latexml" id="A1.T4.6.6.1.m1.1.1.cmml" xref="A1.T4.6.6.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.6.6.1.m1.1c">\sim</annotation><annotation encoding="application/x-llamapun" id="A1.T4.6.6.1.m1.1d">∼</annotation></semantics></math>2k</td>
<td class="ltx_td ltx_align_center" id="A1.T4.6.6.6">2.42/10</td>
<td class="ltx_td ltx_align_center" id="A1.T4.6.6.7">0.9637</td>
</tr>
<tr class="ltx_tr" id="A1.T4.7.7">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="A1.T4.7.7.2">DuReader</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T4.7.7.3">Chinese</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T4.7.7.4">200</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T4.7.7.5">160/40</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T4.7.7.1">
<math alttext="\sim" class="ltx_Math" display="inline" id="A1.T4.7.7.1.m1.1"><semantics id="A1.T4.7.7.1.m1.1a"><mo id="A1.T4.7.7.1.m1.1.1" xref="A1.T4.7.7.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="A1.T4.7.7.1.m1.1b"><csymbol cd="latexml" id="A1.T4.7.7.1.m1.1.1.cmml" xref="A1.T4.7.7.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.7.7.1.m1.1c">\sim</annotation><annotation encoding="application/x-llamapun" id="A1.T4.7.7.1.m1.1d">∼</annotation></semantics></math>16k</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T4.7.7.6">1.82/20</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T4.7.7.7">0.7169</td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>Statistics of datasets. “# Rel/Docs” denotes the number of relevant documents and the total number of documents for each query. “MAP” represents the Mean Average Precision, a common retrieval metric.</figcaption>
</figure>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Prompt Templates</h2>
<div class="ltx_para" id="A2.p1">
<p class="ltx_p" id="A2.p1.2">In R<sup class="ltx_sup" id="A2.p1.2.1">2</sup>AG, retrieval information, we append <math alttext="k" class="ltx_Math" display="inline" id="A2.p1.2.m2.1"><semantics id="A2.p1.2.m2.1a"><mi id="A2.p1.2.m2.1.1" xref="A2.p1.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A2.p1.2.m2.1b"><ci id="A2.p1.2.m2.1.1.cmml" xref="A2.p1.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.2.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="A2.p1.2.m2.1d">italic_k</annotation></semantics></math> special tokens (<span class="ltx_text ltx_font_typewriter" id="A2.p1.2.2">‘‘&lt;R&gt;’’</span>) in front of each document to facilitate the incorporation of retrieval information. These tokens do not carry meaningful semantics but serve as placeholders for the retrieval information within the prompt. This special token facilitates the integration of retrieval information into the generation process.</p>
</div>
<div class="ltx_para" id="A2.p2">
<p class="ltx_p" id="A2.p2.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#A4.T5" title="Table 5 ‣ DuReader ‣ Appendix D Dataset Introduction ‣ R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_tag">5</span></a> shows the prompt templates for R<sup class="ltx_sup" id="A2.p2.1.1">2</sup>AG and other baselines. The prompt templates of DuReader dataset can be found in our source code.</p>
</div>
</section>
<section class="ltx_appendix" id="A3">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>R<sup class="ltx_sup" id="A3.3.1">2</sup>AG Algorithm</h2>
<div class="ltx_para" id="A3.p1">
<p class="ltx_p" id="A3.p1.1">Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#algorithm1" title="In Appendix C R2AG Algorithm ‣ R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_tag">1</span></a> is the implementation of R<sup class="ltx_sup" id="A3.p1.1.1">2</sup>AG.</p>
</div>
<figure class="ltx_float ltx_algorithm" id="algorithm1">
<div class="ltx_listing ltx_lst_numbers_left ltx_listing" id="algorithm1.26">
<div class="ltx_listingline" id="algorithm1.26.25">
</div>
<div class="ltx_listingline" id="algorithm1.4.2">
<span class="ltx_text ltx_font_bold" id="algorithm1.4.2.1">Input :</span> Query <math alttext="q" class="ltx_Math" display="inline" id="algorithm1.3.1.m1.1"><semantics id="algorithm1.3.1.m1.1a"><mi id="algorithm1.3.1.m1.1.1" xref="algorithm1.3.1.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="algorithm1.3.1.m1.1b"><ci id="algorithm1.3.1.m1.1.1.cmml" xref="algorithm1.3.1.m1.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.3.1.m1.1c">q</annotation><annotation encoding="application/x-llamapun" id="algorithm1.3.1.m1.1d">italic_q</annotation></semantics></math>, retrieved documents <math alttext="\mathcal{D}{=}\{d_{i}\}_{i=1}^{k}." class="ltx_Math" display="inline" id="algorithm1.4.2.m2.1"><semantics id="algorithm1.4.2.m2.1a"><mrow id="algorithm1.4.2.m2.1.1.1" xref="algorithm1.4.2.m2.1.1.1.1.cmml"><mrow id="algorithm1.4.2.m2.1.1.1.1" xref="algorithm1.4.2.m2.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.4.2.m2.1.1.1.1.3" xref="algorithm1.4.2.m2.1.1.1.1.3.cmml">𝒟</mi><mo id="algorithm1.4.2.m2.1.1.1.1.2" xref="algorithm1.4.2.m2.1.1.1.1.2.cmml">=</mo><msubsup id="algorithm1.4.2.m2.1.1.1.1.1" xref="algorithm1.4.2.m2.1.1.1.1.1.cmml"><mrow id="algorithm1.4.2.m2.1.1.1.1.1.1.1.1" xref="algorithm1.4.2.m2.1.1.1.1.1.1.1.2.cmml"><mo id="algorithm1.4.2.m2.1.1.1.1.1.1.1.1.2" stretchy="false" xref="algorithm1.4.2.m2.1.1.1.1.1.1.1.2.cmml">{</mo><msub id="algorithm1.4.2.m2.1.1.1.1.1.1.1.1.1" xref="algorithm1.4.2.m2.1.1.1.1.1.1.1.1.1.cmml"><mi id="algorithm1.4.2.m2.1.1.1.1.1.1.1.1.1.2" xref="algorithm1.4.2.m2.1.1.1.1.1.1.1.1.1.2.cmml">d</mi><mi id="algorithm1.4.2.m2.1.1.1.1.1.1.1.1.1.3" xref="algorithm1.4.2.m2.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="algorithm1.4.2.m2.1.1.1.1.1.1.1.1.3" stretchy="false" xref="algorithm1.4.2.m2.1.1.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="algorithm1.4.2.m2.1.1.1.1.1.1.3" xref="algorithm1.4.2.m2.1.1.1.1.1.1.3.cmml"><mi id="algorithm1.4.2.m2.1.1.1.1.1.1.3.2" xref="algorithm1.4.2.m2.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="algorithm1.4.2.m2.1.1.1.1.1.1.3.1" xref="algorithm1.4.2.m2.1.1.1.1.1.1.3.1.cmml">=</mo><mn id="algorithm1.4.2.m2.1.1.1.1.1.1.3.3" xref="algorithm1.4.2.m2.1.1.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="algorithm1.4.2.m2.1.1.1.1.1.3" xref="algorithm1.4.2.m2.1.1.1.1.1.3.cmml">k</mi></msubsup></mrow><mo id="algorithm1.4.2.m2.1.1.1.2" lspace="0em" xref="algorithm1.4.2.m2.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.4.2.m2.1b"><apply id="algorithm1.4.2.m2.1.1.1.1.cmml" xref="algorithm1.4.2.m2.1.1.1"><eq id="algorithm1.4.2.m2.1.1.1.1.2.cmml" xref="algorithm1.4.2.m2.1.1.1.1.2"></eq><ci id="algorithm1.4.2.m2.1.1.1.1.3.cmml" xref="algorithm1.4.2.m2.1.1.1.1.3">𝒟</ci><apply id="algorithm1.4.2.m2.1.1.1.1.1.cmml" xref="algorithm1.4.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.4.2.m2.1.1.1.1.1.2.cmml" xref="algorithm1.4.2.m2.1.1.1.1.1">superscript</csymbol><apply id="algorithm1.4.2.m2.1.1.1.1.1.1.cmml" xref="algorithm1.4.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.4.2.m2.1.1.1.1.1.1.2.cmml" xref="algorithm1.4.2.m2.1.1.1.1.1">subscript</csymbol><set id="algorithm1.4.2.m2.1.1.1.1.1.1.1.2.cmml" xref="algorithm1.4.2.m2.1.1.1.1.1.1.1.1"><apply id="algorithm1.4.2.m2.1.1.1.1.1.1.1.1.1.cmml" xref="algorithm1.4.2.m2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.4.2.m2.1.1.1.1.1.1.1.1.1.1.cmml" xref="algorithm1.4.2.m2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="algorithm1.4.2.m2.1.1.1.1.1.1.1.1.1.2.cmml" xref="algorithm1.4.2.m2.1.1.1.1.1.1.1.1.1.2">𝑑</ci><ci id="algorithm1.4.2.m2.1.1.1.1.1.1.1.1.1.3.cmml" xref="algorithm1.4.2.m2.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="algorithm1.4.2.m2.1.1.1.1.1.1.3.cmml" xref="algorithm1.4.2.m2.1.1.1.1.1.1.3"><eq id="algorithm1.4.2.m2.1.1.1.1.1.1.3.1.cmml" xref="algorithm1.4.2.m2.1.1.1.1.1.1.3.1"></eq><ci id="algorithm1.4.2.m2.1.1.1.1.1.1.3.2.cmml" xref="algorithm1.4.2.m2.1.1.1.1.1.1.3.2">𝑖</ci><cn id="algorithm1.4.2.m2.1.1.1.1.1.1.3.3.cmml" type="integer" xref="algorithm1.4.2.m2.1.1.1.1.1.1.3.3">1</cn></apply></apply><ci id="algorithm1.4.2.m2.1.1.1.1.1.3.cmml" xref="algorithm1.4.2.m2.1.1.1.1.1.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.4.2.m2.1c">\mathcal{D}{=}\{d_{i}\}_{i=1}^{k}.</annotation><annotation encoding="application/x-llamapun" id="algorithm1.4.2.m2.1d">caligraphic_D = { italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT .</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm1.26.26">
</div>
<div class="ltx_listingline" id="algorithm1.5.3">
<span class="ltx_text ltx_font_bold" id="algorithm1.5.3.1">Output :</span> Answer <math alttext="y" class="ltx_Math" display="inline" id="algorithm1.5.3.m1.1"><semantics id="algorithm1.5.3.m1.1a"><mi id="algorithm1.5.3.m1.1.1" xref="algorithm1.5.3.m1.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="algorithm1.5.3.m1.1b"><ci id="algorithm1.5.3.m1.1.1.cmml" xref="algorithm1.5.3.m1.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.5.3.m1.1c">y</annotation><annotation encoding="application/x-llamapun" id="algorithm1.5.3.m1.1d">italic_y</annotation></semantics></math>.
</div>
<div class="ltx_listingline" id="algorithm1.26.27">
</div>
<div class="ltx_listingline" id="algorithm1.26.28">
</div>
<div class="ltx_listingline" id="algorithm1.9.7">
<span class="ltx_tag ltx_tag_listingline">1</span>Initialize R<sup class="ltx_sup" id="algorithm1.9.7.1">2</sup>-Former parameters <math alttext="\Theta_{R}" class="ltx_Math" display="inline" id="algorithm1.7.5.m2.1"><semantics id="algorithm1.7.5.m2.1a"><msub id="algorithm1.7.5.m2.1.1" xref="algorithm1.7.5.m2.1.1.cmml"><mi id="algorithm1.7.5.m2.1.1.2" mathvariant="normal" xref="algorithm1.7.5.m2.1.1.2.cmml">Θ</mi><mi id="algorithm1.7.5.m2.1.1.3" xref="algorithm1.7.5.m2.1.1.3.cmml">R</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm1.7.5.m2.1b"><apply id="algorithm1.7.5.m2.1.1.cmml" xref="algorithm1.7.5.m2.1.1"><csymbol cd="ambiguous" id="algorithm1.7.5.m2.1.1.1.cmml" xref="algorithm1.7.5.m2.1.1">subscript</csymbol><ci id="algorithm1.7.5.m2.1.1.2.cmml" xref="algorithm1.7.5.m2.1.1.2">Θ</ci><ci id="algorithm1.7.5.m2.1.1.3.cmml" xref="algorithm1.7.5.m2.1.1.3">𝑅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.7.5.m2.1c">\Theta_{R}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.7.5.m2.1d">roman_Θ start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT</annotation></semantics></math>, retriever <math alttext="f_{\mathbf{R}}" class="ltx_Math" display="inline" id="algorithm1.8.6.m3.1"><semantics id="algorithm1.8.6.m3.1a"><msub id="algorithm1.8.6.m3.1.1" xref="algorithm1.8.6.m3.1.1.cmml"><mi id="algorithm1.8.6.m3.1.1.2" xref="algorithm1.8.6.m3.1.1.2.cmml">f</mi><mi id="algorithm1.8.6.m3.1.1.3" xref="algorithm1.8.6.m3.1.1.3.cmml">𝐑</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm1.8.6.m3.1b"><apply id="algorithm1.8.6.m3.1.1.cmml" xref="algorithm1.8.6.m3.1.1"><csymbol cd="ambiguous" id="algorithm1.8.6.m3.1.1.1.cmml" xref="algorithm1.8.6.m3.1.1">subscript</csymbol><ci id="algorithm1.8.6.m3.1.1.2.cmml" xref="algorithm1.8.6.m3.1.1.2">𝑓</ci><ci id="algorithm1.8.6.m3.1.1.3.cmml" xref="algorithm1.8.6.m3.1.1.3">𝐑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.8.6.m3.1c">f_{\mathbf{R}}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.8.6.m3.1d">italic_f start_POSTSUBSCRIPT bold_R end_POSTSUBSCRIPT</annotation></semantics></math>, and LLM <math alttext="f_{\mathbf{G}}" class="ltx_Math" display="inline" id="algorithm1.9.7.m4.1"><semantics id="algorithm1.9.7.m4.1a"><msub id="algorithm1.9.7.m4.1.1" xref="algorithm1.9.7.m4.1.1.cmml"><mi id="algorithm1.9.7.m4.1.1.2" xref="algorithm1.9.7.m4.1.1.2.cmml">f</mi><mi id="algorithm1.9.7.m4.1.1.3" xref="algorithm1.9.7.m4.1.1.3.cmml">𝐆</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm1.9.7.m4.1b"><apply id="algorithm1.9.7.m4.1.1.cmml" xref="algorithm1.9.7.m4.1.1"><csymbol cd="ambiguous" id="algorithm1.9.7.m4.1.1.1.cmml" xref="algorithm1.9.7.m4.1.1">subscript</csymbol><ci id="algorithm1.9.7.m4.1.1.2.cmml" xref="algorithm1.9.7.m4.1.1.2">𝑓</ci><ci id="algorithm1.9.7.m4.1.1.3.cmml" xref="algorithm1.9.7.m4.1.1.3">𝐆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.9.7.m4.1c">f_{\mathbf{G}}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.9.7.m4.1d">italic_f start_POSTSUBSCRIPT bold_G end_POSTSUBSCRIPT</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="algorithm1.12.10">
<span class="ltx_tag ltx_tag_listingline">2</span>Get query and documents semantic representation (<math alttext="\mathbf{x}^{q}" class="ltx_Math" display="inline" id="algorithm1.10.8.m1.1"><semantics id="algorithm1.10.8.m1.1a"><msup id="algorithm1.10.8.m1.1.1" xref="algorithm1.10.8.m1.1.1.cmml"><mi id="algorithm1.10.8.m1.1.1.2" xref="algorithm1.10.8.m1.1.1.2.cmml">𝐱</mi><mi id="algorithm1.10.8.m1.1.1.3" xref="algorithm1.10.8.m1.1.1.3.cmml">q</mi></msup><annotation-xml encoding="MathML-Content" id="algorithm1.10.8.m1.1b"><apply id="algorithm1.10.8.m1.1.1.cmml" xref="algorithm1.10.8.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.10.8.m1.1.1.1.cmml" xref="algorithm1.10.8.m1.1.1">superscript</csymbol><ci id="algorithm1.10.8.m1.1.1.2.cmml" xref="algorithm1.10.8.m1.1.1.2">𝐱</ci><ci id="algorithm1.10.8.m1.1.1.3.cmml" xref="algorithm1.10.8.m1.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.10.8.m1.1c">\mathbf{x}^{q}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.10.8.m1.1d">bold_x start_POSTSUPERSCRIPT italic_q end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{x}^{d}" class="ltx_Math" display="inline" id="algorithm1.11.9.m2.1"><semantics id="algorithm1.11.9.m2.1a"><msup id="algorithm1.11.9.m2.1.1" xref="algorithm1.11.9.m2.1.1.cmml"><mi id="algorithm1.11.9.m2.1.1.2" xref="algorithm1.11.9.m2.1.1.2.cmml">𝐱</mi><mi id="algorithm1.11.9.m2.1.1.3" xref="algorithm1.11.9.m2.1.1.3.cmml">d</mi></msup><annotation-xml encoding="MathML-Content" id="algorithm1.11.9.m2.1b"><apply id="algorithm1.11.9.m2.1.1.cmml" xref="algorithm1.11.9.m2.1.1"><csymbol cd="ambiguous" id="algorithm1.11.9.m2.1.1.1.cmml" xref="algorithm1.11.9.m2.1.1">superscript</csymbol><ci id="algorithm1.11.9.m2.1.1.2.cmml" xref="algorithm1.11.9.m2.1.1.2">𝐱</ci><ci id="algorithm1.11.9.m2.1.1.3.cmml" xref="algorithm1.11.9.m2.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.11.9.m2.1c">\mathbf{x}^{d}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.11.9.m2.1d">bold_x start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>) from retriever <math alttext="f_{\mathbf{R}}" class="ltx_Math" display="inline" id="algorithm1.12.10.m3.1"><semantics id="algorithm1.12.10.m3.1a"><msub id="algorithm1.12.10.m3.1.1" xref="algorithm1.12.10.m3.1.1.cmml"><mi id="algorithm1.12.10.m3.1.1.2" xref="algorithm1.12.10.m3.1.1.2.cmml">f</mi><mi id="algorithm1.12.10.m3.1.1.3" xref="algorithm1.12.10.m3.1.1.3.cmml">𝐑</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm1.12.10.m3.1b"><apply id="algorithm1.12.10.m3.1.1.cmml" xref="algorithm1.12.10.m3.1.1"><csymbol cd="ambiguous" id="algorithm1.12.10.m3.1.1.1.cmml" xref="algorithm1.12.10.m3.1.1">subscript</csymbol><ci id="algorithm1.12.10.m3.1.1.2.cmml" xref="algorithm1.12.10.m3.1.1.2">𝑓</ci><ci id="algorithm1.12.10.m3.1.1.3.cmml" xref="algorithm1.12.10.m3.1.1.3">𝐑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.12.10.m3.1c">f_{\mathbf{R}}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.12.10.m3.1d">italic_f start_POSTSUBSCRIPT bold_R end_POSTSUBSCRIPT</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="algorithm1.26.29">
<span class="ltx_text ltx_font_typewriter" id="algorithm1.26.29.1">// </span><span class="ltx_text ltx_font_typewriter" id="algorithm1.26.29.2">Retrieval feature extraction </span>
</div>
<div class="ltx_listingline" id="algorithm1.14.12">
<span class="ltx_tag ltx_tag_listingline">3</span>
<span class="ltx_text ltx_font_bold" id="algorithm1.14.12.3">for</span> <em class="ltx_emph ltx_font_italic" id="algorithm1.14.12.2"><math alttext="d_{i}" class="ltx_Math" display="inline" id="algorithm1.13.11.1.m1.1"><semantics id="algorithm1.13.11.1.m1.1a"><msub id="algorithm1.13.11.1.m1.1.1" xref="algorithm1.13.11.1.m1.1.1.cmml"><mi id="algorithm1.13.11.1.m1.1.1.2" xref="algorithm1.13.11.1.m1.1.1.2.cmml">d</mi><mi id="algorithm1.13.11.1.m1.1.1.3" xref="algorithm1.13.11.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm1.13.11.1.m1.1b"><apply id="algorithm1.13.11.1.m1.1.1.cmml" xref="algorithm1.13.11.1.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.13.11.1.m1.1.1.1.cmml" xref="algorithm1.13.11.1.m1.1.1">subscript</csymbol><ci id="algorithm1.13.11.1.m1.1.1.2.cmml" xref="algorithm1.13.11.1.m1.1.1.2">𝑑</ci><ci id="algorithm1.13.11.1.m1.1.1.3.cmml" xref="algorithm1.13.11.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.13.11.1.m1.1c">d_{i}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.13.11.1.m1.1d">italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> in <math alttext="D" class="ltx_Math" display="inline" id="algorithm1.14.12.2.m2.1"><semantics id="algorithm1.14.12.2.m2.1a"><mi id="algorithm1.14.12.2.m2.1.1" xref="algorithm1.14.12.2.m2.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="algorithm1.14.12.2.m2.1b"><ci id="algorithm1.14.12.2.m2.1.1.cmml" xref="algorithm1.14.12.2.m2.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.14.12.2.m2.1c">D</annotation><annotation encoding="application/x-llamapun" id="algorithm1.14.12.2.m2.1d">italic_D</annotation></semantics></math></em> <span class="ltx_text ltx_font_bold" id="algorithm1.14.12.4">do</span>
</div>
<div class="ltx_listingline" id="algorithm1.15.13">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Calculate <math alttext="\text{input}_{i}" class="ltx_Math" display="inline" id="algorithm1.15.13.m1.1"><semantics id="algorithm1.15.13.m1.1a"><msub id="algorithm1.15.13.m1.1.1" xref="algorithm1.15.13.m1.1.1.cmml"><mtext id="algorithm1.15.13.m1.1.1.2" xref="algorithm1.15.13.m1.1.1.2a.cmml">input</mtext><mi id="algorithm1.15.13.m1.1.1.3" xref="algorithm1.15.13.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm1.15.13.m1.1b"><apply id="algorithm1.15.13.m1.1.1.cmml" xref="algorithm1.15.13.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.15.13.m1.1.1.1.cmml" xref="algorithm1.15.13.m1.1.1">subscript</csymbol><ci id="algorithm1.15.13.m1.1.1.2a.cmml" xref="algorithm1.15.13.m1.1.1.2"><mtext id="algorithm1.15.13.m1.1.1.2.cmml" xref="algorithm1.15.13.m1.1.1.2">input</mtext></ci><ci id="algorithm1.15.13.m1.1.1.3.cmml" xref="algorithm1.15.13.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.15.13.m1.1c">\text{input}_{i}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.15.13.m1.1d">input start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>. <span class="ltx_text ltx_font_typewriter" id="algorithm1.15.13.1">// </span><span class="ltx_text ltx_font_typewriter" id="algorithm1.15.13.2">{Eq.<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#A1.E10" title="In Appendix A Retrieval Feature Extraction Details ‣ R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_tag">10</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#A1.E11" title="In Appendix A Retrieval Feature Extraction Details ‣ R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_tag">11</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#A1.E12" title="In Appendix A Retrieval Feature Extraction Details ‣ R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_tag">12</span></a>} </span>
</div>
<div class="ltx_listingline" id="algorithm1.26.30">
<span class="ltx_tag ltx_tag_listingline">4</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div class="ltx_listingline" id="algorithm1.26.31">
<span class="ltx_tag ltx_tag_listingline">5</span> end for
</div>
<div class="ltx_listingline" id="algorithm1.26.32">
<span class="ltx_tag ltx_tag_listingline">6</span>
</div>
<div class="ltx_listingline" id="algorithm1.16.14">
<span class="ltx_text ltx_font_typewriter" id="algorithm1.16.14.2">// </span><span class="ltx_text ltx_font_typewriter" id="algorithm1.16.14.1">R<sup class="ltx_sup" id="algorithm1.16.14.1.1"><span class="ltx_text ltx_font_serif" id="algorithm1.16.14.1.1.1">2</span></sup>-Former </span>
</div>
<div class="ltx_listingline" id="algorithm1.17.15">
Calculate hidden states <span class="ltx_text ltx_markedasmath ltx_font_bold" id="algorithm1.17.15.1">H</span>; <span class="ltx_text ltx_font_typewriter" id="algorithm1.17.15.2">// </span><span class="ltx_text ltx_font_typewriter" id="algorithm1.17.15.3">{Eq. <a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#S3.E2" title="In 3.3 R2-Former ‣ 3 R2AG ‣ R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_tag">2</span></a>} </span>
</div>
<div class="ltx_listingline" id="algorithm1.26.33">
<span class="ltx_tag ltx_tag_listingline">7</span>
</div>
<div class="ltx_listingline" id="algorithm1.26.34">
<span class="ltx_text ltx_font_typewriter" id="algorithm1.26.34.1">// </span><span class="ltx_text ltx_font_typewriter" id="algorithm1.26.34.2">Retrieval-aware prompting </span>
</div>
<div class="ltx_listingline" id="algorithm1.18.16">
Calculate hidden state <math alttext="\textbf{E}^{R}" class="ltx_Math" display="inline" id="algorithm1.18.16.m1.1"><semantics id="algorithm1.18.16.m1.1a"><msup id="algorithm1.18.16.m1.1.1" xref="algorithm1.18.16.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="algorithm1.18.16.m1.1.1.2" xref="algorithm1.18.16.m1.1.1.2a.cmml">E</mtext><mi id="algorithm1.18.16.m1.1.1.3" xref="algorithm1.18.16.m1.1.1.3.cmml">R</mi></msup><annotation-xml encoding="MathML-Content" id="algorithm1.18.16.m1.1b"><apply id="algorithm1.18.16.m1.1.1.cmml" xref="algorithm1.18.16.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.18.16.m1.1.1.1.cmml" xref="algorithm1.18.16.m1.1.1">superscript</csymbol><ci id="algorithm1.18.16.m1.1.1.2a.cmml" xref="algorithm1.18.16.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="algorithm1.18.16.m1.1.1.2.cmml" xref="algorithm1.18.16.m1.1.1.2">E</mtext></ci><ci id="algorithm1.18.16.m1.1.1.3.cmml" xref="algorithm1.18.16.m1.1.1.3">𝑅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.18.16.m1.1c">\textbf{E}^{R}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.18.16.m1.1d">E start_POSTSUPERSCRIPT italic_R end_POSTSUPERSCRIPT</annotation></semantics></math>; <span class="ltx_text ltx_font_typewriter" id="algorithm1.18.16.1">// </span><span class="ltx_text ltx_font_typewriter" id="algorithm1.18.16.2">{Eq. <a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#S3.E3" title="In 3.4 Retrieval-Aware Prompting ‣ 3 R2AG ‣ R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_tag">3</span></a>} </span>
</div>
<div class="ltx_listingline" id="algorithm1.26.35">
<span class="ltx_tag ltx_tag_listingline">8</span>
</div>
<div class="ltx_listingline" id="algorithm1.26.36">Embedding lookup for text tokens; <span class="ltx_text ltx_font_typewriter" id="algorithm1.26.36.1">// </span><span class="ltx_text ltx_font_typewriter" id="algorithm1.26.36.2">{Eq. <a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#S3.E4" title="In 3.4 Retrieval-Aware Prompting ‣ 3 R2AG ‣ R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_tag">4</span></a>} </span>
</div>
<div class="ltx_listingline" id="algorithm1.26.37">
<span class="ltx_tag ltx_tag_listingline">9</span>
</div>
<div class="ltx_listingline" id="algorithm1.19.17">Fuse into final input embeddings <span class="ltx_text ltx_markedasmath ltx_font_bold" id="algorithm1.19.17.1">E</span>; <span class="ltx_text ltx_font_typewriter" id="algorithm1.19.17.2">// </span><span class="ltx_text ltx_font_typewriter" id="algorithm1.19.17.3">{Eq. <a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#S3.E5" title="In 3.4 Retrieval-Aware Prompting ‣ 3 R2AG ‣ R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_tag">5</span></a>} </span>
</div>
<div class="ltx_listingline" id="algorithm1.26.38">
<span class="ltx_tag ltx_tag_listingline">10</span>
</div>
<div class="ltx_listingline" id="algorithm1.21.19">Get the response <math alttext="{y}" class="ltx_Math" display="inline" id="algorithm1.20.18.m1.1"><semantics id="algorithm1.20.18.m1.1a"><mi id="algorithm1.20.18.m1.1.1" xref="algorithm1.20.18.m1.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="algorithm1.20.18.m1.1b"><ci id="algorithm1.20.18.m1.1.1.cmml" xref="algorithm1.20.18.m1.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.20.18.m1.1c">{y}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.20.18.m1.1d">italic_y</annotation></semantics></math> from LLM <math alttext="f_{\mathbf{G}}" class="ltx_Math" display="inline" id="algorithm1.21.19.m2.1"><semantics id="algorithm1.21.19.m2.1a"><msub id="algorithm1.21.19.m2.1.1" xref="algorithm1.21.19.m2.1.1.cmml"><mi id="algorithm1.21.19.m2.1.1.2" xref="algorithm1.21.19.m2.1.1.2.cmml">f</mi><mi id="algorithm1.21.19.m2.1.1.3" xref="algorithm1.21.19.m2.1.1.3.cmml">𝐆</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm1.21.19.m2.1b"><apply id="algorithm1.21.19.m2.1.1.cmml" xref="algorithm1.21.19.m2.1.1"><csymbol cd="ambiguous" id="algorithm1.21.19.m2.1.1.1.cmml" xref="algorithm1.21.19.m2.1.1">subscript</csymbol><ci id="algorithm1.21.19.m2.1.1.2.cmml" xref="algorithm1.21.19.m2.1.1.2">𝑓</ci><ci id="algorithm1.21.19.m2.1.1.3.cmml" xref="algorithm1.21.19.m2.1.1.3">𝐆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.21.19.m2.1c">f_{\mathbf{G}}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.21.19.m2.1d">italic_f start_POSTSUBSCRIPT bold_G end_POSTSUBSCRIPT</annotation></semantics></math>; <span class="ltx_text ltx_font_typewriter" id="algorithm1.21.19.1">// </span><span class="ltx_text ltx_font_typewriter" id="algorithm1.21.19.2">{Eq. <a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#S3.E6" title="In 3.4 Retrieval-Aware Prompting ‣ 3 R2AG ‣ R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_tag">6</span></a>} </span>
</div>
<div class="ltx_listingline" id="algorithm1.26.39">
<span class="ltx_tag ltx_tag_listingline">11</span>
</div>
<div class="ltx_listingline" id="algorithm1.26.40">
<span class="ltx_text ltx_font_typewriter" id="algorithm1.26.40.1">// </span><span class="ltx_text ltx_font_typewriter" id="algorithm1.26.40.2">Training strategy </span>
</div>
<div class="ltx_listingline" id="algorithm1.26.41">
<span class="ltx_tag ltx_tag_listingline">12</span>
<span class="ltx_text ltx_font_bold" id="algorithm1.26.41.1">if</span> <em class="ltx_emph ltx_font_italic" id="algorithm1.26.41.2">is training</em> <span class="ltx_text ltx_font_bold" id="algorithm1.26.41.3">then</span>
</div>
<div class="ltx_listingline" id="algorithm1.22.20">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Project the relevance scores <math alttext="S" class="ltx_Math" display="inline" id="algorithm1.22.20.m1.1"><semantics id="algorithm1.22.20.m1.1a"><mi id="algorithm1.22.20.m1.1.1" xref="algorithm1.22.20.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="algorithm1.22.20.m1.1b"><ci id="algorithm1.22.20.m1.1.1.cmml" xref="algorithm1.22.20.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.22.20.m1.1c">S</annotation><annotation encoding="application/x-llamapun" id="algorithm1.22.20.m1.1d">italic_S</annotation></semantics></math>; <span class="ltx_text ltx_font_typewriter" id="algorithm1.22.20.1">// </span><span class="ltx_text ltx_font_typewriter" id="algorithm1.22.20.2">{Eq. <a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#S3.E7" title="In 3.5 Training Strategy ‣ 3 R2AG ‣ R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_tag">7</span></a>} </span>
</div>
<div class="ltx_listingline" id="algorithm1.26.42">
<span class="ltx_tag ltx_tag_listingline">13</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div class="ltx_listingline" id="algorithm1.23.21">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   Calculate <math alttext="\mathcal{L}_{QDM}" class="ltx_Math" display="inline" id="algorithm1.23.21.m1.1"><semantics id="algorithm1.23.21.m1.1a"><msub id="algorithm1.23.21.m1.1.1" xref="algorithm1.23.21.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.23.21.m1.1.1.2" xref="algorithm1.23.21.m1.1.1.2.cmml">ℒ</mi><mrow id="algorithm1.23.21.m1.1.1.3" xref="algorithm1.23.21.m1.1.1.3.cmml"><mi id="algorithm1.23.21.m1.1.1.3.2" xref="algorithm1.23.21.m1.1.1.3.2.cmml">Q</mi><mo id="algorithm1.23.21.m1.1.1.3.1" xref="algorithm1.23.21.m1.1.1.3.1.cmml">⁢</mo><mi id="algorithm1.23.21.m1.1.1.3.3" xref="algorithm1.23.21.m1.1.1.3.3.cmml">D</mi><mo id="algorithm1.23.21.m1.1.1.3.1a" xref="algorithm1.23.21.m1.1.1.3.1.cmml">⁢</mo><mi id="algorithm1.23.21.m1.1.1.3.4" xref="algorithm1.23.21.m1.1.1.3.4.cmml">M</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="algorithm1.23.21.m1.1b"><apply id="algorithm1.23.21.m1.1.1.cmml" xref="algorithm1.23.21.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.23.21.m1.1.1.1.cmml" xref="algorithm1.23.21.m1.1.1">subscript</csymbol><ci id="algorithm1.23.21.m1.1.1.2.cmml" xref="algorithm1.23.21.m1.1.1.2">ℒ</ci><apply id="algorithm1.23.21.m1.1.1.3.cmml" xref="algorithm1.23.21.m1.1.1.3"><times id="algorithm1.23.21.m1.1.1.3.1.cmml" xref="algorithm1.23.21.m1.1.1.3.1"></times><ci id="algorithm1.23.21.m1.1.1.3.2.cmml" xref="algorithm1.23.21.m1.1.1.3.2">𝑄</ci><ci id="algorithm1.23.21.m1.1.1.3.3.cmml" xref="algorithm1.23.21.m1.1.1.3.3">𝐷</ci><ci id="algorithm1.23.21.m1.1.1.3.4.cmml" xref="algorithm1.23.21.m1.1.1.3.4">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.23.21.m1.1c">\mathcal{L}_{QDM}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.23.21.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_Q italic_D italic_M end_POSTSUBSCRIPT</annotation></semantics></math>; <span class="ltx_text ltx_font_typewriter" id="algorithm1.23.21.1">// </span><span class="ltx_text ltx_font_typewriter" id="algorithm1.23.21.2">{Eq. <a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#S3.E8" title="In 3.5 Training Strategy ‣ 3 R2AG ‣ R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_tag">8</span></a>} </span>
</div>
<div class="ltx_listingline" id="algorithm1.26.43">
<span class="ltx_tag ltx_tag_listingline">14</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div class="ltx_listingline" id="algorithm1.24.22">
<span class="ltx_tag ltx_tag_listingline">15</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   Calculate <math alttext="\mathcal{L}_{LM}" class="ltx_Math" display="inline" id="algorithm1.24.22.m1.1"><semantics id="algorithm1.24.22.m1.1a"><msub id="algorithm1.24.22.m1.1.1" xref="algorithm1.24.22.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.24.22.m1.1.1.2" xref="algorithm1.24.22.m1.1.1.2.cmml">ℒ</mi><mrow id="algorithm1.24.22.m1.1.1.3" xref="algorithm1.24.22.m1.1.1.3.cmml"><mi id="algorithm1.24.22.m1.1.1.3.2" xref="algorithm1.24.22.m1.1.1.3.2.cmml">L</mi><mo id="algorithm1.24.22.m1.1.1.3.1" xref="algorithm1.24.22.m1.1.1.3.1.cmml">⁢</mo><mi id="algorithm1.24.22.m1.1.1.3.3" xref="algorithm1.24.22.m1.1.1.3.3.cmml">M</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="algorithm1.24.22.m1.1b"><apply id="algorithm1.24.22.m1.1.1.cmml" xref="algorithm1.24.22.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.24.22.m1.1.1.1.cmml" xref="algorithm1.24.22.m1.1.1">subscript</csymbol><ci id="algorithm1.24.22.m1.1.1.2.cmml" xref="algorithm1.24.22.m1.1.1.2">ℒ</ci><apply id="algorithm1.24.22.m1.1.1.3.cmml" xref="algorithm1.24.22.m1.1.1.3"><times id="algorithm1.24.22.m1.1.1.3.1.cmml" xref="algorithm1.24.22.m1.1.1.3.1"></times><ci id="algorithm1.24.22.m1.1.1.3.2.cmml" xref="algorithm1.24.22.m1.1.1.3.2">𝐿</ci><ci id="algorithm1.24.22.m1.1.1.3.3.cmml" xref="algorithm1.24.22.m1.1.1.3.3">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.24.22.m1.1c">\mathcal{L}_{LM}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.24.22.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_L italic_M end_POSTSUBSCRIPT</annotation></semantics></math>;

</div>
<div class="ltx_listingline" id="algorithm1.25.23">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   Calculate final loss <math alttext="\mathcal{L}" class="ltx_Math" display="inline" id="algorithm1.25.23.m1.1"><semantics id="algorithm1.25.23.m1.1a"><mi class="ltx_font_mathcaligraphic" id="algorithm1.25.23.m1.1.1" xref="algorithm1.25.23.m1.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="algorithm1.25.23.m1.1b"><ci id="algorithm1.25.23.m1.1.1.cmml" xref="algorithm1.25.23.m1.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.25.23.m1.1c">\mathcal{L}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.25.23.m1.1d">caligraphic_L</annotation></semantics></math>; <span class="ltx_text ltx_font_typewriter" id="algorithm1.25.23.1">// </span><span class="ltx_text ltx_font_typewriter" id="algorithm1.25.23.2">{Eq. <a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#S3.E9" title="In 3.5 Training Strategy ‣ 3 R2AG ‣ R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_tag">9</span></a>} </span>
</div>
<div class="ltx_listingline" id="algorithm1.26.44">
<span class="ltx_tag ltx_tag_listingline">16</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div class="ltx_listingline" id="algorithm1.26.45">
<span class="ltx_tag ltx_tag_listingline">17</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   Update parameters.

</div>
<div class="ltx_listingline" id="algorithm1.26.46">
<span class="ltx_tag ltx_tag_listingline">18</span> end if
</div>
<div class="ltx_listingline" id="algorithm1.26.47">
<span class="ltx_tag ltx_tag_listingline">19</span>
</div>
<div class="ltx_listingline" id="algorithm1.26.24">
<span class="ltx_text ltx_font_bold" id="algorithm1.26.24.2">return</span> <em class="ltx_emph ltx_font_italic" id="algorithm1.26.24.1"><math alttext="{y}" class="ltx_Math" display="inline" id="algorithm1.26.24.1.m1.1"><semantics id="algorithm1.26.24.1.m1.1a"><mi id="algorithm1.26.24.1.m1.1.1" xref="algorithm1.26.24.1.m1.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="algorithm1.26.24.1.m1.1b"><ci id="algorithm1.26.24.1.m1.1.1.cmml" xref="algorithm1.26.24.1.m1.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.26.24.1.m1.1c">{y}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.26.24.1.m1.1d">italic_y</annotation></semantics></math></em>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="algorithm1.29.1.1">Algorithm 1</span> </span>R<sup class="ltx_sup" id="algorithm1.30.2">2</sup>AG</figcaption>
</figure>
</section>
<section class="ltx_appendix" id="A4">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Dataset Introduction</h2>
<div class="ltx_para" id="A4.p1">
<p class="ltx_p" id="A4.p1.1">We conduct evaluations on five datasets, including:</p>
</div>
<section class="ltx_paragraph" id="A4.SS0.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Natural Questions (NQ)</h4>
<div class="ltx_para" id="A4.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="A4.SS0.SSS0.Px1.p1.2"><cite class="ltx_cite ltx_citemacro_cite">Kwiatkowski et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib21" title="">2019</a>)</cite> is developed from Google Search and contains questions coupled with human-annotated answers extracted from Wikipedia. Further, <cite class="ltx_cite ltx_citemacro_citet">Liu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib27" title="">2023</a>)</cite> collect <math alttext="k{-}1" class="ltx_Math" display="inline" id="A4.SS0.SSS0.Px1.p1.1.m1.1"><semantics id="A4.SS0.SSS0.Px1.p1.1.m1.1a"><mrow id="A4.SS0.SSS0.Px1.p1.1.m1.1.1" xref="A4.SS0.SSS0.Px1.p1.1.m1.1.1.cmml"><mi id="A4.SS0.SSS0.Px1.p1.1.m1.1.1.2" xref="A4.SS0.SSS0.Px1.p1.1.m1.1.1.2.cmml">k</mi><mo id="A4.SS0.SSS0.Px1.p1.1.m1.1.1.1" xref="A4.SS0.SSS0.Px1.p1.1.m1.1.1.1.cmml">−</mo><mn id="A4.SS0.SSS0.Px1.p1.1.m1.1.1.3" xref="A4.SS0.SSS0.Px1.p1.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.SS0.SSS0.Px1.p1.1.m1.1b"><apply id="A4.SS0.SSS0.Px1.p1.1.m1.1.1.cmml" xref="A4.SS0.SSS0.Px1.p1.1.m1.1.1"><minus id="A4.SS0.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="A4.SS0.SSS0.Px1.p1.1.m1.1.1.1"></minus><ci id="A4.SS0.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="A4.SS0.SSS0.Px1.p1.1.m1.1.1.2">𝑘</ci><cn id="A4.SS0.SSS0.Px1.p1.1.m1.1.1.3.cmml" type="integer" xref="A4.SS0.SSS0.Px1.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS0.SSS0.Px1.p1.1.m1.1c">k{-}1</annotation><annotation encoding="application/x-llamapun" id="A4.SS0.SSS0.Px1.p1.1.m1.1d">italic_k - 1</annotation></semantics></math> distractor documents from Wikipedia that do not contain the answers, where <math alttext="k" class="ltx_Math" display="inline" id="A4.SS0.SSS0.Px1.p1.2.m2.1"><semantics id="A4.SS0.SSS0.Px1.p1.2.m2.1a"><mi id="A4.SS0.SSS0.Px1.p1.2.m2.1.1" xref="A4.SS0.SSS0.Px1.p1.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A4.SS0.SSS0.Px1.p1.2.m2.1b"><ci id="A4.SS0.SSS0.Px1.p1.2.m2.1.1.cmml" xref="A4.SS0.SSS0.Px1.p1.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.SS0.SSS0.Px1.p1.2.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="A4.SS0.SSS0.Px1.p1.2.m2.1d">italic_k</annotation></semantics></math> is the total document number for each question. This dataset has three versions: NQ-10, NQ-20, and NQ-30, with total document numbers of 10, 20, and 30, respectively.</p>
</div>
</section>
<section class="ltx_paragraph" id="A4.SS0.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">HotpotQA</h4>
<div class="ltx_para" id="A4.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="A4.SS0.SSS0.Px2.p1.1"><cite class="ltx_cite ltx_citemacro_cite">Yang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib45" title="">2018</a>)</cite> is a well-known multi-hop question answering dataset based on Wikipedia. This dataset involves questions requiring finding and reasoning over multiple supporting facts from 10 documents. There are two reasoning types of questions: bridging and comparison.</p>
</div>
</section>
<section class="ltx_paragraph" id="A4.SS0.SSS0.Px3">
<h4 class="ltx_title ltx_title_paragraph">MuSiQue</h4>
<div class="ltx_para" id="A4.SS0.SSS0.Px3.p1">
<p class="ltx_p" id="A4.SS0.SSS0.Px3.p1.1"><cite class="ltx_cite ltx_citemacro_cite">Trivedi et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib36" title="">2021</a>)</cite> has questions that involve 2-4 hops and six types of reasoning chains. The dataset is constructed through a bottom–up process by carefully selecting and composing single-hop questions. The final answer to each question in the distractor setting is extracted from 20 documents.</p>
</div>
</section>
<section class="ltx_paragraph" id="A4.SS0.SSS0.Px4">
<h4 class="ltx_title ltx_title_paragraph">2WikiMultiHopQA (2Wiki)</h4>
<div class="ltx_para" id="A4.SS0.SSS0.Px4.p1">
<p class="ltx_p" id="A4.SS0.SSS0.Px4.p1.1"><cite class="ltx_cite ltx_citemacro_cite">Ho et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib13" title="">2020</a>)</cite> consists of up to 5-hop questions, each associated with 10 documents. Unlike HotpotQA, this dataset needs to evaluate the interpretability of models not only with supporting evidence but also with entity-relation tuples.</p>
</div>
</section>
<section class="ltx_paragraph" id="A4.SS0.SSS0.Px5">
<h4 class="ltx_title ltx_title_paragraph">DuReader</h4>
<div class="ltx_para" id="A4.SS0.SSS0.Px5.p1">
<p class="ltx_p" id="A4.SS0.SSS0.Px5.p1.1"><cite class="ltx_cite ltx_citemacro_cite">He et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib11" title="">2018</a>)</cite> is a Chinese dataset developed based on Baidu Search and Baidu Zhidao. To adapt it for assessing long context ability, for each question, <cite class="ltx_cite ltx_citemacro_citet">Bai et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib4" title="">2023b</a>)</cite> arbitrarily select several documents from the total corpus as distractors until each question is associated with 20 candidate documents.</p>
</div>
<div class="ltx_para" id="A4.SS0.SSS0.Px5.p2">
<p class="ltx_p" id="A4.SS0.SSS0.Px5.p2.1">Detailed statistics can be found in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#A1.T4" title="Table 4 ‣ Appendix A Retrieval Feature Extraction Details ‣ R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<figure class="ltx_table" id="A4.T5">
<table class="ltx_tabular ltx_align_middle" id="A4.T5.17">
<tr class="ltx_tr" id="A4.T5.17.18">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="A4.T5.17.18.1"><span class="ltx_text ltx_font_bold" id="A4.T5.17.18.1.1">Methods</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_tt" id="A4.T5.17.18.2">
<span class="ltx_inline-block ltx_align_top" id="A4.T5.17.18.2.1">
<span class="ltx_p" id="A4.T5.17.18.2.1.1" style="width:346.9pt;"><span class="ltx_text ltx_font_bold" id="A4.T5.17.18.2.1.1.1">Prompts</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A4.T5.5.5">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A4.T5.5.5.6">RAG</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="A4.T5.5.5.5">
<span class="ltx_inline-block ltx_align_top" id="A4.T5.5.5.5.5">
<span class="ltx_p" id="A4.T5.5.5.5.5.6" style="width:346.9pt;">Write a high-quality answer for the given question using only the provided search results (some of which might be irrelevant). Only give me the answer and do not output any other words.</span>
<span class="ltx_p" id="A4.T5.1.1.1.1.1">[1]{#<math alttext="d_{1}" class="ltx_Math" display="inline" id="A4.T5.1.1.1.1.1.m1.1"><semantics id="A4.T5.1.1.1.1.1.m1.1a"><msub id="A4.T5.1.1.1.1.1.m1.1.1" xref="A4.T5.1.1.1.1.1.m1.1.1.cmml"><mi id="A4.T5.1.1.1.1.1.m1.1.1.2" xref="A4.T5.1.1.1.1.1.m1.1.1.2.cmml">d</mi><mn id="A4.T5.1.1.1.1.1.m1.1.1.3" xref="A4.T5.1.1.1.1.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="A4.T5.1.1.1.1.1.m1.1b"><apply id="A4.T5.1.1.1.1.1.m1.1.1.cmml" xref="A4.T5.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="A4.T5.1.1.1.1.1.m1.1.1.1.cmml" xref="A4.T5.1.1.1.1.1.m1.1.1">subscript</csymbol><ci id="A4.T5.1.1.1.1.1.m1.1.1.2.cmml" xref="A4.T5.1.1.1.1.1.m1.1.1.2">𝑑</ci><cn id="A4.T5.1.1.1.1.1.m1.1.1.3.cmml" type="integer" xref="A4.T5.1.1.1.1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.1.1.1.1.1.m1.1c">d_{1}</annotation><annotation encoding="application/x-llamapun" id="A4.T5.1.1.1.1.1.m1.1d">italic_d start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>}</span>
<span class="ltx_p" id="A4.T5.2.2.2.2.2">[2]{#<math alttext="d_{2}" class="ltx_Math" display="inline" id="A4.T5.2.2.2.2.2.m1.1"><semantics id="A4.T5.2.2.2.2.2.m1.1a"><msub id="A4.T5.2.2.2.2.2.m1.1.1" xref="A4.T5.2.2.2.2.2.m1.1.1.cmml"><mi id="A4.T5.2.2.2.2.2.m1.1.1.2" xref="A4.T5.2.2.2.2.2.m1.1.1.2.cmml">d</mi><mn id="A4.T5.2.2.2.2.2.m1.1.1.3" xref="A4.T5.2.2.2.2.2.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="A4.T5.2.2.2.2.2.m1.1b"><apply id="A4.T5.2.2.2.2.2.m1.1.1.cmml" xref="A4.T5.2.2.2.2.2.m1.1.1"><csymbol cd="ambiguous" id="A4.T5.2.2.2.2.2.m1.1.1.1.cmml" xref="A4.T5.2.2.2.2.2.m1.1.1">subscript</csymbol><ci id="A4.T5.2.2.2.2.2.m1.1.1.2.cmml" xref="A4.T5.2.2.2.2.2.m1.1.1.2">𝑑</ci><cn id="A4.T5.2.2.2.2.2.m1.1.1.3.cmml" type="integer" xref="A4.T5.2.2.2.2.2.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.2.2.2.2.2.m1.1c">d_{2}</annotation><annotation encoding="application/x-llamapun" id="A4.T5.2.2.2.2.2.m1.1d">italic_d start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>}</span>
<span class="ltx_p" id="A4.T5.5.5.5.5.7">…</span>
<span class="ltx_p" id="A4.T5.4.4.4.4.4">[<math alttext="k" class="ltx_Math" display="inline" id="A4.T5.3.3.3.3.3.m1.1"><semantics id="A4.T5.3.3.3.3.3.m1.1a"><mi id="A4.T5.3.3.3.3.3.m1.1.1" xref="A4.T5.3.3.3.3.3.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A4.T5.3.3.3.3.3.m1.1b"><ci id="A4.T5.3.3.3.3.3.m1.1.1.cmml" xref="A4.T5.3.3.3.3.3.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.3.3.3.3.3.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="A4.T5.3.3.3.3.3.m1.1d">italic_k</annotation></semantics></math>]{#<math alttext="d_{k}" class="ltx_Math" display="inline" id="A4.T5.4.4.4.4.4.m2.1"><semantics id="A4.T5.4.4.4.4.4.m2.1a"><msub id="A4.T5.4.4.4.4.4.m2.1.1" xref="A4.T5.4.4.4.4.4.m2.1.1.cmml"><mi id="A4.T5.4.4.4.4.4.m2.1.1.2" xref="A4.T5.4.4.4.4.4.m2.1.1.2.cmml">d</mi><mi id="A4.T5.4.4.4.4.4.m2.1.1.3" xref="A4.T5.4.4.4.4.4.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="A4.T5.4.4.4.4.4.m2.1b"><apply id="A4.T5.4.4.4.4.4.m2.1.1.cmml" xref="A4.T5.4.4.4.4.4.m2.1.1"><csymbol cd="ambiguous" id="A4.T5.4.4.4.4.4.m2.1.1.1.cmml" xref="A4.T5.4.4.4.4.4.m2.1.1">subscript</csymbol><ci id="A4.T5.4.4.4.4.4.m2.1.1.2.cmml" xref="A4.T5.4.4.4.4.4.m2.1.1.2">𝑑</ci><ci id="A4.T5.4.4.4.4.4.m2.1.1.3.cmml" xref="A4.T5.4.4.4.4.4.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.4.4.4.4.4.m2.1c">d_{k}</annotation><annotation encoding="application/x-llamapun" id="A4.T5.4.4.4.4.4.m2.1d">italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>}</span>
<span class="ltx_p" id="A4.T5.5.5.5.5.8">Only give me the answer and do not output any other words.</span>
<span class="ltx_p" id="A4.T5.5.5.5.5.5">Question: {#<math alttext="q" class="ltx_Math" display="inline" id="A4.T5.5.5.5.5.5.m1.1"><semantics id="A4.T5.5.5.5.5.5.m1.1a"><mi id="A4.T5.5.5.5.5.5.m1.1.1" xref="A4.T5.5.5.5.5.5.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="A4.T5.5.5.5.5.5.m1.1b"><ci id="A4.T5.5.5.5.5.5.m1.1.1.cmml" xref="A4.T5.5.5.5.5.5.m1.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.5.5.5.5.5.m1.1c">q</annotation><annotation encoding="application/x-llamapun" id="A4.T5.5.5.5.5.5.m1.1d">italic_q</annotation></semantics></math>}</span>
<span class="ltx_p" id="A4.T5.5.5.5.5.9">Answer:</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A4.T5.10.10">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A4.T5.10.10.6">CoT</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="A4.T5.10.10.5">
<span class="ltx_inline-block ltx_align_top" id="A4.T5.10.10.5.5">
<span class="ltx_p" id="A4.T5.10.10.5.5.6" style="width:346.9pt;">Write a high-quality answer for the given question using only the provided search results (some of which might be irrelevant). Only give me the answer and do not output any other words.</span>
<span class="ltx_p" id="A4.T5.6.6.1.1.1">[1]{#<math alttext="d_{1}" class="ltx_Math" display="inline" id="A4.T5.6.6.1.1.1.m1.1"><semantics id="A4.T5.6.6.1.1.1.m1.1a"><msub id="A4.T5.6.6.1.1.1.m1.1.1" xref="A4.T5.6.6.1.1.1.m1.1.1.cmml"><mi id="A4.T5.6.6.1.1.1.m1.1.1.2" xref="A4.T5.6.6.1.1.1.m1.1.1.2.cmml">d</mi><mn id="A4.T5.6.6.1.1.1.m1.1.1.3" xref="A4.T5.6.6.1.1.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="A4.T5.6.6.1.1.1.m1.1b"><apply id="A4.T5.6.6.1.1.1.m1.1.1.cmml" xref="A4.T5.6.6.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="A4.T5.6.6.1.1.1.m1.1.1.1.cmml" xref="A4.T5.6.6.1.1.1.m1.1.1">subscript</csymbol><ci id="A4.T5.6.6.1.1.1.m1.1.1.2.cmml" xref="A4.T5.6.6.1.1.1.m1.1.1.2">𝑑</ci><cn id="A4.T5.6.6.1.1.1.m1.1.1.3.cmml" type="integer" xref="A4.T5.6.6.1.1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.6.6.1.1.1.m1.1c">d_{1}</annotation><annotation encoding="application/x-llamapun" id="A4.T5.6.6.1.1.1.m1.1d">italic_d start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>}</span>
<span class="ltx_p" id="A4.T5.7.7.2.2.2">[2]{#<math alttext="d_{2}" class="ltx_Math" display="inline" id="A4.T5.7.7.2.2.2.m1.1"><semantics id="A4.T5.7.7.2.2.2.m1.1a"><msub id="A4.T5.7.7.2.2.2.m1.1.1" xref="A4.T5.7.7.2.2.2.m1.1.1.cmml"><mi id="A4.T5.7.7.2.2.2.m1.1.1.2" xref="A4.T5.7.7.2.2.2.m1.1.1.2.cmml">d</mi><mn id="A4.T5.7.7.2.2.2.m1.1.1.3" xref="A4.T5.7.7.2.2.2.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="A4.T5.7.7.2.2.2.m1.1b"><apply id="A4.T5.7.7.2.2.2.m1.1.1.cmml" xref="A4.T5.7.7.2.2.2.m1.1.1"><csymbol cd="ambiguous" id="A4.T5.7.7.2.2.2.m1.1.1.1.cmml" xref="A4.T5.7.7.2.2.2.m1.1.1">subscript</csymbol><ci id="A4.T5.7.7.2.2.2.m1.1.1.2.cmml" xref="A4.T5.7.7.2.2.2.m1.1.1.2">𝑑</ci><cn id="A4.T5.7.7.2.2.2.m1.1.1.3.cmml" type="integer" xref="A4.T5.7.7.2.2.2.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.7.7.2.2.2.m1.1c">d_{2}</annotation><annotation encoding="application/x-llamapun" id="A4.T5.7.7.2.2.2.m1.1d">italic_d start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>}</span>
<span class="ltx_p" id="A4.T5.10.10.5.5.7">…</span>
<span class="ltx_p" id="A4.T5.9.9.4.4.4">[<math alttext="k" class="ltx_Math" display="inline" id="A4.T5.8.8.3.3.3.m1.1"><semantics id="A4.T5.8.8.3.3.3.m1.1a"><mi id="A4.T5.8.8.3.3.3.m1.1.1" xref="A4.T5.8.8.3.3.3.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A4.T5.8.8.3.3.3.m1.1b"><ci id="A4.T5.8.8.3.3.3.m1.1.1.cmml" xref="A4.T5.8.8.3.3.3.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.8.8.3.3.3.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="A4.T5.8.8.3.3.3.m1.1d">italic_k</annotation></semantics></math>]{#<math alttext="d_{k}" class="ltx_Math" display="inline" id="A4.T5.9.9.4.4.4.m2.1"><semantics id="A4.T5.9.9.4.4.4.m2.1a"><msub id="A4.T5.9.9.4.4.4.m2.1.1" xref="A4.T5.9.9.4.4.4.m2.1.1.cmml"><mi id="A4.T5.9.9.4.4.4.m2.1.1.2" xref="A4.T5.9.9.4.4.4.m2.1.1.2.cmml">d</mi><mi id="A4.T5.9.9.4.4.4.m2.1.1.3" xref="A4.T5.9.9.4.4.4.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="A4.T5.9.9.4.4.4.m2.1b"><apply id="A4.T5.9.9.4.4.4.m2.1.1.cmml" xref="A4.T5.9.9.4.4.4.m2.1.1"><csymbol cd="ambiguous" id="A4.T5.9.9.4.4.4.m2.1.1.1.cmml" xref="A4.T5.9.9.4.4.4.m2.1.1">subscript</csymbol><ci id="A4.T5.9.9.4.4.4.m2.1.1.2.cmml" xref="A4.T5.9.9.4.4.4.m2.1.1.2">𝑑</ci><ci id="A4.T5.9.9.4.4.4.m2.1.1.3.cmml" xref="A4.T5.9.9.4.4.4.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.9.9.4.4.4.m2.1c">d_{k}</annotation><annotation encoding="application/x-llamapun" id="A4.T5.9.9.4.4.4.m2.1d">italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>}</span>
<span class="ltx_p" id="A4.T5.10.10.5.5.8">Only give me the answer and do not output any other words.</span>
<span class="ltx_p" id="A4.T5.10.10.5.5.5">Question: {#<math alttext="q" class="ltx_Math" display="inline" id="A4.T5.10.10.5.5.5.m1.1"><semantics id="A4.T5.10.10.5.5.5.m1.1a"><mi id="A4.T5.10.10.5.5.5.m1.1.1" xref="A4.T5.10.10.5.5.5.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="A4.T5.10.10.5.5.5.m1.1b"><ci id="A4.T5.10.10.5.5.5.m1.1.1.cmml" xref="A4.T5.10.10.5.5.5.m1.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.10.10.5.5.5.m1.1c">q</annotation><annotation encoding="application/x-llamapun" id="A4.T5.10.10.5.5.5.m1.1d">italic_q</annotation></semantics></math>}</span>
<span class="ltx_p" id="A4.T5.10.10.5.5.9">Let’s think it step by step.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A4.T5.11.11">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A4.T5.11.11.2">
<span class="ltx_text" id="A4.T5.11.11.2.1"></span> <span class="ltx_text" id="A4.T5.11.11.2.2">
<span class="ltx_tabular ltx_align_middle" id="A4.T5.11.11.2.2.1">
<span class="ltx_tr" id="A4.T5.11.11.2.2.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="A4.T5.11.11.2.2.1.1.1">Comps</span></span>
</span></span><span class="ltx_text" id="A4.T5.11.11.2.3"></span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="A4.T5.11.11.1">
<span class="ltx_inline-block ltx_align_top" id="A4.T5.11.11.1.1">
<span class="ltx_p" id="A4.T5.11.11.1.1.2" style="width:346.9pt;">Write a high-quality answer for the given question using only the provided search results (some of which might be irrelevant). Only give me the answer and do not output any other words.</span>
<span class="ltx_p" id="A4.T5.11.11.1.1.3">{#<span class="ltx_text ltx_font_italic" id="A4.T5.11.11.1.1.3.1">Compressed documents</span>}</span>
<span class="ltx_p" id="A4.T5.11.11.1.1.4">Only give me the answer and do not output any other words.</span>
<span class="ltx_p" id="A4.T5.11.11.1.1.1">Question: {#<math alttext="q" class="ltx_Math" display="inline" id="A4.T5.11.11.1.1.1.m1.1"><semantics id="A4.T5.11.11.1.1.1.m1.1a"><mi id="A4.T5.11.11.1.1.1.m1.1.1" xref="A4.T5.11.11.1.1.1.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="A4.T5.11.11.1.1.1.m1.1b"><ci id="A4.T5.11.11.1.1.1.m1.1.1.cmml" xref="A4.T5.11.11.1.1.1.m1.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.11.11.1.1.1.m1.1c">q</annotation><annotation encoding="application/x-llamapun" id="A4.T5.11.11.1.1.1.m1.1d">italic_q</annotation></semantics></math>}</span>
<span class="ltx_p" id="A4.T5.11.11.1.1.5">Answer:</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A4.T5.17.17">
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_r ltx_border_t" id="A4.T5.12.12.1">R<sup class="ltx_sup" id="A4.T5.12.12.1.1">2</sup>AG</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_t" id="A4.T5.17.17.6">
<span class="ltx_inline-block ltx_align_top" id="A4.T5.17.17.6.5">
<span class="ltx_p" id="A4.T5.17.17.6.5.6" style="width:346.9pt;">Write a high-quality answer for the given question using only the provided search results (some of which might be irrelevant). Only give me the answer and do not output any other words. The similarity information is provided in front of search results.</span>
<span class="ltx_p" id="A4.T5.13.13.2.1.1">[1]similarity: <span class="ltx_text ltx_font_typewriter" id="A4.T5.13.13.2.1.1.1">&lt;R&gt;</span>{#<math alttext="d_{1}" class="ltx_Math" display="inline" id="A4.T5.13.13.2.1.1.m1.1"><semantics id="A4.T5.13.13.2.1.1.m1.1a"><msub id="A4.T5.13.13.2.1.1.m1.1.1" xref="A4.T5.13.13.2.1.1.m1.1.1.cmml"><mi id="A4.T5.13.13.2.1.1.m1.1.1.2" xref="A4.T5.13.13.2.1.1.m1.1.1.2.cmml">d</mi><mn id="A4.T5.13.13.2.1.1.m1.1.1.3" xref="A4.T5.13.13.2.1.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="A4.T5.13.13.2.1.1.m1.1b"><apply id="A4.T5.13.13.2.1.1.m1.1.1.cmml" xref="A4.T5.13.13.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="A4.T5.13.13.2.1.1.m1.1.1.1.cmml" xref="A4.T5.13.13.2.1.1.m1.1.1">subscript</csymbol><ci id="A4.T5.13.13.2.1.1.m1.1.1.2.cmml" xref="A4.T5.13.13.2.1.1.m1.1.1.2">𝑑</ci><cn id="A4.T5.13.13.2.1.1.m1.1.1.3.cmml" type="integer" xref="A4.T5.13.13.2.1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.13.13.2.1.1.m1.1c">d_{1}</annotation><annotation encoding="application/x-llamapun" id="A4.T5.13.13.2.1.1.m1.1d">italic_d start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>}</span>
<span class="ltx_p" id="A4.T5.14.14.3.2.2">[2]similarity: <span class="ltx_text ltx_font_typewriter" id="A4.T5.14.14.3.2.2.1">&lt;R&gt;</span>{#<math alttext="d_{2}" class="ltx_Math" display="inline" id="A4.T5.14.14.3.2.2.m1.1"><semantics id="A4.T5.14.14.3.2.2.m1.1a"><msub id="A4.T5.14.14.3.2.2.m1.1.1" xref="A4.T5.14.14.3.2.2.m1.1.1.cmml"><mi id="A4.T5.14.14.3.2.2.m1.1.1.2" xref="A4.T5.14.14.3.2.2.m1.1.1.2.cmml">d</mi><mn id="A4.T5.14.14.3.2.2.m1.1.1.3" xref="A4.T5.14.14.3.2.2.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="A4.T5.14.14.3.2.2.m1.1b"><apply id="A4.T5.14.14.3.2.2.m1.1.1.cmml" xref="A4.T5.14.14.3.2.2.m1.1.1"><csymbol cd="ambiguous" id="A4.T5.14.14.3.2.2.m1.1.1.1.cmml" xref="A4.T5.14.14.3.2.2.m1.1.1">subscript</csymbol><ci id="A4.T5.14.14.3.2.2.m1.1.1.2.cmml" xref="A4.T5.14.14.3.2.2.m1.1.1.2">𝑑</ci><cn id="A4.T5.14.14.3.2.2.m1.1.1.3.cmml" type="integer" xref="A4.T5.14.14.3.2.2.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.14.14.3.2.2.m1.1c">d_{2}</annotation><annotation encoding="application/x-llamapun" id="A4.T5.14.14.3.2.2.m1.1d">italic_d start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>}</span>
<span class="ltx_p" id="A4.T5.17.17.6.5.7">…</span>
<span class="ltx_p" id="A4.T5.16.16.5.4.4">[<math alttext="k" class="ltx_Math" display="inline" id="A4.T5.15.15.4.3.3.m1.1"><semantics id="A4.T5.15.15.4.3.3.m1.1a"><mi id="A4.T5.15.15.4.3.3.m1.1.1" xref="A4.T5.15.15.4.3.3.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A4.T5.15.15.4.3.3.m1.1b"><ci id="A4.T5.15.15.4.3.3.m1.1.1.cmml" xref="A4.T5.15.15.4.3.3.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.15.15.4.3.3.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="A4.T5.15.15.4.3.3.m1.1d">italic_k</annotation></semantics></math>]similarity: <span class="ltx_text ltx_font_typewriter" id="A4.T5.16.16.5.4.4.1">&lt;R&gt;</span>{#<math alttext="d_{k}" class="ltx_Math" display="inline" id="A4.T5.16.16.5.4.4.m2.1"><semantics id="A4.T5.16.16.5.4.4.m2.1a"><msub id="A4.T5.16.16.5.4.4.m2.1.1" xref="A4.T5.16.16.5.4.4.m2.1.1.cmml"><mi id="A4.T5.16.16.5.4.4.m2.1.1.2" xref="A4.T5.16.16.5.4.4.m2.1.1.2.cmml">d</mi><mi id="A4.T5.16.16.5.4.4.m2.1.1.3" xref="A4.T5.16.16.5.4.4.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="A4.T5.16.16.5.4.4.m2.1b"><apply id="A4.T5.16.16.5.4.4.m2.1.1.cmml" xref="A4.T5.16.16.5.4.4.m2.1.1"><csymbol cd="ambiguous" id="A4.T5.16.16.5.4.4.m2.1.1.1.cmml" xref="A4.T5.16.16.5.4.4.m2.1.1">subscript</csymbol><ci id="A4.T5.16.16.5.4.4.m2.1.1.2.cmml" xref="A4.T5.16.16.5.4.4.m2.1.1.2">𝑑</ci><ci id="A4.T5.16.16.5.4.4.m2.1.1.3.cmml" xref="A4.T5.16.16.5.4.4.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.16.16.5.4.4.m2.1c">d_{k}</annotation><annotation encoding="application/x-llamapun" id="A4.T5.16.16.5.4.4.m2.1d">italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>}</span>
<span class="ltx_p" id="A4.T5.17.17.6.5.8">Only give me the answer and do not output any other words.</span>
<span class="ltx_p" id="A4.T5.17.17.6.5.5">Question: {#<math alttext="q" class="ltx_Math" display="inline" id="A4.T5.17.17.6.5.5.m1.1"><semantics id="A4.T5.17.17.6.5.5.m1.1a"><mi id="A4.T5.17.17.6.5.5.m1.1.1" xref="A4.T5.17.17.6.5.5.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="A4.T5.17.17.6.5.5.m1.1b"><ci id="A4.T5.17.17.6.5.5.m1.1.1.cmml" xref="A4.T5.17.17.6.5.5.m1.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.T5.17.17.6.5.5.m1.1c">q</annotation><annotation encoding="application/x-llamapun" id="A4.T5.17.17.6.5.5.m1.1d">italic_q</annotation></semantics></math>}</span>
<span class="ltx_p" id="A4.T5.17.17.6.5.9">Answer:</span>
</span>
</td>
</tr>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 5: </span>Prompt templates of different methods. “Comps” means compression-based methods, including RECOMP and LongLLMLingua. <span class="ltx_text ltx_font_typewriter" id="A4.T5.19.1">‘‘&lt;R&gt;’’</span> is the placeholder for retrieval information.</figcaption>
</figure>
</section>
</section>
<section class="ltx_appendix" id="A5">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix E </span>Implementation Details</h2>
<div class="ltx_para" id="A5.p1">
<p class="ltx_p" id="A5.p1.1">Unlike some works <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib25" title="">2023b</a>); Zhu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib52" title="">2023a</a>)</cite> built on LAVIS <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib24" title="">2022</a>)</cite>, we completely implement R<sup class="ltx_sup" id="A5.p1.1.1">2</sup>AG on PyTorch <cite class="ltx_cite ltx_citemacro_cite">Paszke et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib32" title="">2019</a>)</cite> and Transformers <cite class="ltx_cite ltx_citemacro_cite">Wolf et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib39" title="">2020</a>)</cite> libraries for easy usage.</p>
</div>
<div class="ltx_para" id="A5.p2">
<p class="ltx_p" id="A5.p2.1">For the retrieval task, we utilize the Sentence-Transformer <cite class="ltx_cite ltx_citemacro_cite">Reimers and Gurevych (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib33" title="">2019</a>)</cite> to fine-tune a BERT <cite class="ltx_cite ltx_citemacro_cite">Devlin et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib8" title="">2019</a>)</cite> model as the retriever, which is a siamese dual encoder with shared parameters. The models <span class="ltx_text ltx_font_typewriter" id="A5.p2.1.1">‘‘bert-base-uncased’’</span> and <span class="ltx_text ltx_font_typewriter" id="A5.p2.1.2">‘‘bert-base-chinese’’</span> are used for English datasets and the Chinese dataset, respectively. All retrievers adopt default hyper-parameter settings with 768 embedding dimensions. Cosine similarity is employed as the scoring function for retrieval and feature extraction. The retrieval performance across datasets is shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#A1.T4" title="Table 4 ‣ Appendix A Retrieval Feature Extraction Details ‣ R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_tag">4</span></a>. Contrary to some works <cite class="ltx_cite ltx_citemacro_cite">Liu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib27" title="">2023</a>); Jiang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib16" title="">2023</a>)</cite> that artificially place ground truth documents in fixed positions, this paper considers that candidate documents are ranked by the retriever to simulate real-world scenarios.</p>
</div>
<div class="ltx_para" id="A5.p3">
<p class="ltx_p" id="A5.p3.1">For R<sup class="ltx_sup" id="A5.p3.1.1">2</sup>-Former, we determine the learning rate as 2e-4 and dropout as 0.1. The number of attention heads and hidden size in Transformer encoder are 4 and 256, respectively. Adam <cite class="ltx_cite ltx_citemacro_cite">Kingma and Ba (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib19" title="">2014</a>)</cite> is adopted as the optimization algorithm.</p>
</div>
<div class="ltx_para" id="A5.p4">
<p class="ltx_p" id="A5.p4.1">For LLMs, all methods use default settings and adopt greedy decoding for fair comparison. The ChatGPT version is <span class="ltx_text ltx_font_typewriter" id="A5.p4.1.1">‘‘gpt-3.5-turbo-0125’’</span> with a 16k context window size, and the GPT4 version is <span class="ltx_text ltx_font_typewriter" id="A5.p4.1.2">‘‘gpt-4-turbo-2024-04-09’’</span> with a 128k context window size. In CRAG, the retrieval evaluator only triggered <span class="ltx_text ltx_font_typewriter" id="A5.p4.1.3">{Correct, Ambiguous}</span> actions to next knowledge refinement process as there are at least one relevant document in retrieval results. In the RAFT method, we employ LoRA <cite class="ltx_cite ltx_citemacro_cite">Hu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib14" title="">2021</a>)</cite> to effectively fine-tune LLMs, with LoRA rank set at 16, alpha at 32, and dropout at 0.1.</p>
</div>
</section>
<section class="ltx_appendix" id="A6">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix F </span>Further Discussion</h2>
<section class="ltx_paragraph" id="A6.SS0.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Different Document Number</h4>
<div class="ltx_para" id="A6.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="A6.SS0.SSS0.Px1.p1.4">Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#A6.F7" title="Figure 7 ‣ Different Document Number ‣ Appendix F Further Discussion ‣ R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_tag">7</span></a> displays the performance comparison with different document numbers on NQ-30 dataset using LongChat1.5<sub class="ltx_sub" id="A6.SS0.SSS0.Px1.p1.4.1"><span class="ltx_text ltx_font_italic" id="A6.SS0.SSS0.Px1.p1.4.1.1">7B</span></sub>. For both models, there is a notable trend where the performance metric generally decreases as the number of documents increases. However, this decline is steeper for LongChat1.5<sub class="ltx_sub" id="A6.SS0.SSS0.Px1.p1.4.2"><span class="ltx_text ltx_font_italic" id="A6.SS0.SSS0.Px1.p1.4.2.1">7B</span></sub> compared to R<sup class="ltx_sup" id="A6.SS0.SSS0.Px1.p1.4.3">2</sup>AG. It indicates that R<sup class="ltx_sup" id="A6.SS0.SSS0.Px1.p1.4.4">2</sup>AG is particularly effective in scenarios where the number of documents can vary.</p>
</div>
<figure class="ltx_figure" id="A6.F7"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="337" id="A6.F7.g1" src="x8.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Performance comparison with different document numbers on NQ-30 dataset.</figcaption>
</figure>
</section>
<section class="ltx_paragraph" id="A6.SS0.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Efficiency of R<sup class="ltx_sup" id="A6.SS0.SSS0.Px2.2.1">2</sup>AG</h4>
<div class="ltx_para" id="A6.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="A6.SS0.SSS0.Px2.p1.9">In default settings, R<sup class="ltx_sup" id="A6.SS0.SSS0.Px2.p1.9.1">2</sup>AG is designed to train only the R<sup class="ltx_sup" id="A6.SS0.SSS0.Px2.p1.9.2">2</sup>-Former and the projection layer. The time complexity primarily depends on the number of the retrieval documents (<math alttext="k" class="ltx_Math" display="inline" id="A6.SS0.SSS0.Px2.p1.3.m3.1"><semantics id="A6.SS0.SSS0.Px2.p1.3.m3.1a"><mi id="A6.SS0.SSS0.Px2.p1.3.m3.1.1" xref="A6.SS0.SSS0.Px2.p1.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A6.SS0.SSS0.Px2.p1.3.m3.1b"><ci id="A6.SS0.SSS0.Px2.p1.3.m3.1.1.cmml" xref="A6.SS0.SSS0.Px2.p1.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.SS0.SSS0.Px2.p1.3.m3.1c">k</annotation><annotation encoding="application/x-llamapun" id="A6.SS0.SSS0.Px2.p1.3.m3.1d">italic_k</annotation></semantics></math>), the number of features (3 in our work), and the size of hidden layer in Transformer (<math alttext="h_{1}" class="ltx_Math" display="inline" id="A6.SS0.SSS0.Px2.p1.4.m4.1"><semantics id="A6.SS0.SSS0.Px2.p1.4.m4.1a"><msub id="A6.SS0.SSS0.Px2.p1.4.m4.1.1" xref="A6.SS0.SSS0.Px2.p1.4.m4.1.1.cmml"><mi id="A6.SS0.SSS0.Px2.p1.4.m4.1.1.2" xref="A6.SS0.SSS0.Px2.p1.4.m4.1.1.2.cmml">h</mi><mn id="A6.SS0.SSS0.Px2.p1.4.m4.1.1.3" xref="A6.SS0.SSS0.Px2.p1.4.m4.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="A6.SS0.SSS0.Px2.p1.4.m4.1b"><apply id="A6.SS0.SSS0.Px2.p1.4.m4.1.1.cmml" xref="A6.SS0.SSS0.Px2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="A6.SS0.SSS0.Px2.p1.4.m4.1.1.1.cmml" xref="A6.SS0.SSS0.Px2.p1.4.m4.1.1">subscript</csymbol><ci id="A6.SS0.SSS0.Px2.p1.4.m4.1.1.2.cmml" xref="A6.SS0.SSS0.Px2.p1.4.m4.1.1.2">ℎ</ci><cn id="A6.SS0.SSS0.Px2.p1.4.m4.1.1.3.cmml" type="integer" xref="A6.SS0.SSS0.Px2.p1.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.SS0.SSS0.Px2.p1.4.m4.1c">h_{1}</annotation><annotation encoding="application/x-llamapun" id="A6.SS0.SSS0.Px2.p1.4.m4.1d">italic_h start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>). In Table <a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#A6.T6" title="Table 6 ‣ Efficiency of R2AG ‣ Appendix F Further Discussion ‣ R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_tag">6</span></a>, we analyze the parameter count, including trainable and total parameters. The results indicate that the R<sup class="ltx_sup" id="A6.SS0.SSS0.Px2.p1.9.3">2</sup>-Former only has few trainable parameters, and resource requirements of R<sup class="ltx_sup" id="A6.SS0.SSS0.Px2.p1.9.4">2</sup>AG are substantially low. In the inference stage, R<sup class="ltx_sup" id="A6.SS0.SSS0.Px2.p1.9.5">2</sup>AG incorporates retrieval information into LLMs’ embedding space, which theoretically increases the embeddings with <math alttext="k" class="ltx_Math" display="inline" id="A6.SS0.SSS0.Px2.p1.8.m8.1"><semantics id="A6.SS0.SSS0.Px2.p1.8.m8.1a"><mi id="A6.SS0.SSS0.Px2.p1.8.m8.1.1" xref="A6.SS0.SSS0.Px2.p1.8.m8.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A6.SS0.SSS0.Px2.p1.8.m8.1b"><ci id="A6.SS0.SSS0.Px2.p1.8.m8.1.1.cmml" xref="A6.SS0.SSS0.Px2.p1.8.m8.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.SS0.SSS0.Px2.p1.8.m8.1c">k</annotation><annotation encoding="application/x-llamapun" id="A6.SS0.SSS0.Px2.p1.8.m8.1d">italic_k</annotation></semantics></math> tokens. To provide a practical comparison, we calculate the inference time on 2Wiki dataset using a single A800 GPU. The results indicate that the inference time increases by only 0.8%, making R<sup class="ltx_sup" id="A6.SS0.SSS0.Px2.p1.9.6">2</sup>AG suitable for real-world applications. In practical scenarios, retrieved documents can be pre-encoded and stored in a vector database using tools like Faiss <cite class="ltx_cite ltx_citemacro_cite">Douze et al. (<a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#bib.bib9" title="">2024</a>)</cite> for efficient inference.</p>
</div>
<figure class="ltx_table" id="A6.T6">
<table class="ltx_tabular ltx_align_middle" id="A6.T6.5">
<tr class="ltx_tr" id="A6.T6.1.1">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_tt" id="A6.T6.1.1.2">
<span class="ltx_inline-block ltx_align_top" id="A6.T6.1.1.2.1">
<span class="ltx_p" id="A6.T6.1.1.2.1.1" style="width:56.9pt;"><span class="ltx_text ltx_font_bold" id="A6.T6.1.1.2.1.1.1">Methods</span></span>
</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A6.T6.1.1.3"><span class="ltx_text ltx_font_bold" id="A6.T6.1.1.3.1"># Trainable Params</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A6.T6.1.1.4"><span class="ltx_text ltx_font_bold" id="A6.T6.1.1.4.1"># Total Params</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A6.T6.1.1.1"><span class="ltx_text ltx_font_bold" id="A6.T6.1.1.1.1">Inference Time(<math alttext="k{=}10" class="ltx_Math" display="inline" id="A6.T6.1.1.1.1.m1.1"><semantics id="A6.T6.1.1.1.1.m1.1a"><mrow id="A6.T6.1.1.1.1.m1.1.1" xref="A6.T6.1.1.1.1.m1.1.1.cmml"><mi id="A6.T6.1.1.1.1.m1.1.1.2" xref="A6.T6.1.1.1.1.m1.1.1.2.cmml">k</mi><mo id="A6.T6.1.1.1.1.m1.1.1.1" xref="A6.T6.1.1.1.1.m1.1.1.1.cmml">=</mo><mn id="A6.T6.1.1.1.1.m1.1.1.3" xref="A6.T6.1.1.1.1.m1.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="A6.T6.1.1.1.1.m1.1b"><apply id="A6.T6.1.1.1.1.m1.1.1.cmml" xref="A6.T6.1.1.1.1.m1.1.1"><eq id="A6.T6.1.1.1.1.m1.1.1.1.cmml" xref="A6.T6.1.1.1.1.m1.1.1.1"></eq><ci id="A6.T6.1.1.1.1.m1.1.1.2.cmml" xref="A6.T6.1.1.1.1.m1.1.1.2">𝑘</ci><cn id="A6.T6.1.1.1.1.m1.1.1.3.cmml" type="integer" xref="A6.T6.1.1.1.1.m1.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.T6.1.1.1.1.m1.1c">k{=}10</annotation><annotation encoding="application/x-llamapun" id="A6.T6.1.1.1.1.m1.1d">italic_k = 10</annotation></semantics></math>)</span></td>
</tr>
<tr class="ltx_tr" id="A6.T6.2.2">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="A6.T6.2.2.1">
<span class="ltx_inline-block ltx_align_top" id="A6.T6.2.2.1.1">
<span class="ltx_p" id="A6.T6.2.2.1.1.1" style="width:56.9pt;">LLaMA2<sub class="ltx_sub" id="A6.T6.2.2.1.1.1.1"><span class="ltx_text ltx_font_italic" id="A6.T6.2.2.1.1.1.1.1">7B</span></sub></span>
</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T6.2.2.2">0</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T6.2.2.3">6.738B</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A6.T6.2.2.4">3.154s</td>
</tr>
<tr class="ltx_tr" id="A6.T6.3.3">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="A6.T6.3.3.1">
<span class="ltx_inline-block ltx_align_top" id="A6.T6.3.3.1.1">
<span class="ltx_p" id="A6.T6.3.3.1.1.1" style="width:56.9pt;">R<sup class="ltx_sup" id="A6.T6.3.3.1.1.1.1">2</sup>-Former</span>
</span>
</td>
<td class="ltx_td ltx_align_center" id="A6.T6.3.3.2">1.319M</td>
<td class="ltx_td ltx_align_center" id="A6.T6.3.3.3">1.319M</td>
<td class="ltx_td ltx_align_center" id="A6.T6.3.3.4">0.499ms</td>
</tr>
<tr class="ltx_tr" id="A6.T6.5.5">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_r" id="A6.T6.4.4.1">
<span class="ltx_inline-block ltx_align_top" id="A6.T6.4.4.1.1">
<span class="ltx_p" id="A6.T6.4.4.1.1.1" style="width:56.9pt;">R<sup class="ltx_sup" id="A6.T6.4.4.1.1.1.1">2</sup>AG</span>
</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T6.5.5.3">2.372M</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T6.5.5.4">6.741B</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T6.5.5.2">3.180s(<math alttext="\uparrow" class="ltx_Math" display="inline" id="A6.T6.5.5.2.m1.1"><semantics id="A6.T6.5.5.2.m1.1a"><mo id="A6.T6.5.5.2.m1.1.1" stretchy="false" xref="A6.T6.5.5.2.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="A6.T6.5.5.2.m1.1b"><ci id="A6.T6.5.5.2.m1.1.1.cmml" xref="A6.T6.5.5.2.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.T6.5.5.2.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="A6.T6.5.5.2.m1.1d">↑</annotation></semantics></math> 0.8%)</td>
</tr>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 6: </span>Efficiency of R<sup class="ltx_sup" id="A6.T6.9.1">2</sup>AG. </figcaption>
</figure>
</section>
</section>
<section class="ltx_appendix" id="A7">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix G </span>Case Studies</h2>
<div class="ltx_para" id="A7.p1">
<p class="ltx_p" id="A7.p1.3">Table <a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#A7.T7" title="Table 7 ‣ Appendix G Case Studies ‣ R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_tag">7</span></a> presents a case study on HotpotQA dataset, comparing R<sup class="ltx_sup" id="A7.p1.3.1">2</sup>AG with compression-based methods. In this case, the 1st and 3rd documents are relevant, and the 2nd document is a hard distractor. Only R<sup class="ltx_sup" id="A7.p1.3.2">2</sup>AG successfully provides the correct answer. In contrast, LongLLMLingua compresses the documents but retains their original order, which leads to ineffective outputs. Meanwhile, RECOMP confuses the 2nd and 3rd documents, resulting in hallucinations. More cases compared R<sup class="ltx_sup" id="A7.p1.3.3">2</sup>AG with standard RAG are shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.13249v1#A7.T8" title="Table 8 ‣ Appendix G Case Studies ‣ R2AG: Incorporating Retrieval Information into Retrieval Augmented Generation"><span class="ltx_text ltx_ref_tag">8</span></a>.</p>
</div>
<figure class="ltx_table" id="A7.T7">
<table class="ltx_tabular ltx_align_middle" id="A7.T7.1">
<tr class="ltx_tr" id="A7.T7.1.2">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="A7.T7.1.2.1"><span class="ltx_text ltx_font_bold" id="A7.T7.1.2.1.1">Case</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_tt" id="A7.T7.1.2.2">
<span class="ltx_inline-block ltx_align_top" id="A7.T7.1.2.2.1">
<span class="ltx_p" id="A7.T7.1.2.2.1.1" style="width:346.9pt;"><span class="ltx_text ltx_font_bold" id="A7.T7.1.2.2.1.1.1">Question</span>:Bordan Tkachuk was the CEO of a company that provides what sort of products?</span>
<span class="ltx_p" id="A7.T7.1.2.2.1.2"><span class="ltx_text ltx_font_bold" id="A7.T7.1.2.2.1.2.1">Relevant Documents</span>: 1st, 3rd documents</span>
<span class="ltx_p" id="A7.T7.1.2.2.1.3"><span class="ltx_text ltx_font_bold" id="A7.T7.1.2.2.1.3.1">Gold Answer</span>: IT products and services</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A7.T7.1.1">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A7.T7.1.1.1">R<sup class="ltx_sup" id="A7.T7.1.1.1.1">2</sup>AG</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="A7.T7.1.1.2">
<span class="ltx_inline-block ltx_align_top" id="A7.T7.1.1.2.1">
<span class="ltx_p" id="A7.T7.1.1.2.1.1" style="width:346.9pt;"><span class="ltx_text ltx_font_bold" id="A7.T7.1.1.2.1.1.1">Input Documents</span></span>
<span class="ltx_p" id="A7.T7.1.1.2.1.2"><span class="ltx_text ltx_font_bold" id="A7.T7.1.1.2.1.2.1">[1]</span>similarity: <span class="ltx_text ltx_font_typewriter" id="A7.T7.1.1.2.1.2.2">&lt;R&gt;</span>(Title: Bordan Tkachuk) Bordan Tkachuk ( ) is a British business executive, the former CEO of Viglen, also known from his appearances on the BBC-produced British version of "The Apprentice," interviewing for his boss Lord Sugar.</span>
<span class="ltx_p" id="A7.T7.1.1.2.1.3"><span class="ltx_text ltx_font_bold" id="A7.T7.1.1.2.1.3.1">[2]</span>similarity: <span class="ltx_text ltx_font_typewriter" id="A7.T7.1.1.2.1.3.2">&lt;R&gt;</span>(Title: BankUnited) BankUnited, Inc., with total consolidated assets of $27.9 billion at December 31, 2016, is a bank holding company with one wholly owned subsidiary, BankUnited, collectively, the Company. BankUnited, a national banking association headquartered in Miami Lakes, Florida, provides a full range of banking services to individual and corporate customers through 94 banking centers located in 15 Florida counties and 6 banking centers in the New York metropolitan area. The Bank also provides certain commercial lending and deposit products on a national platform. The Company endeavors to provide, through experienced lending and relationship banking teams, personalized customer service and offers a full range of traditional banking products and services to both commercial and retail customers.</span>
<span class="ltx_p" id="A7.T7.1.1.2.1.4"><span class="ltx_text ltx_font_bold" id="A7.T7.1.1.2.1.4.1">[3]</span>similarity: <span class="ltx_text ltx_font_typewriter" id="A7.T7.1.1.2.1.4.2">&lt;R&gt;</span>(Title: Viglen) Viglen Ltd provides IT products and services, including storage systems, servers, workstations and data/voice communications equipment and services.</span>
<span class="ltx_p" id="A7.T7.1.1.2.1.5"><span class="ltx_text ltx_font_bold" id="A7.T7.1.1.2.1.5.1">[4]</span>similarity: <span class="ltx_text ltx_font_typewriter" id="A7.T7.1.1.2.1.5.2">&lt;R&gt;</span>(Title: Cardinal Health) Cardinal Health, Inc. is a Fortune 500 health care services company based in Dublin, Ohio. The company specializes in distribution of pharmaceuticals and medical products, serving more than 100,000 locations. The company also manufactures medical and surgical products, including gloves, surgical apparel and fluid management products. In addition, it operates the nation’s largest network of radiopharmacies. Cardinal Health provides medical products to over 75 percent of hospitals in the United States. In December 2013, it was announced that Cardinal Health would team up with CVS Caremark, which would form the largest generic drug sourcing operation in the United States. The venture was named Red Oak Sourcing and began operations in July 2014.</span>
<span class="ltx_p" id="A7.T7.1.1.2.1.6"><span class="ltx_text ltx_font_bold" id="A7.T7.1.1.2.1.6.1">[5]</span>similarity: <span class="ltx_text ltx_font_typewriter" id="A7.T7.1.1.2.1.6.2">&lt;R&gt;</span>(Title: Kingstone Companies) Kingstone Companies, Inc., which has its headquarters …</span>
<span class="ltx_p" id="A7.T7.1.1.2.1.7"><span class="ltx_text ltx_font_bold" id="A7.T7.1.1.2.1.7.1">[6]</span>similarity: <span class="ltx_text ltx_font_typewriter" id="A7.T7.1.1.2.1.7.2">&lt;R&gt;</span>(Title: Compass Minerals) Compass Minerals International, Inc is a United States …</span>
<span class="ltx_p" id="A7.T7.1.1.2.1.8"><span class="ltx_text ltx_font_bold" id="A7.T7.1.1.2.1.8.1">[7]</span>similarity: <span class="ltx_text ltx_font_typewriter" id="A7.T7.1.1.2.1.8.2">&lt;R&gt;</span>(Title: Jonathan Michael Ansell) Jonathan M. Ansell (born August 13, 1950 …</span>
<span class="ltx_p" id="A7.T7.1.1.2.1.9"><span class="ltx_text ltx_font_bold" id="A7.T7.1.1.2.1.9.1">[8]</span>similarity: <span class="ltx_text ltx_font_typewriter" id="A7.T7.1.1.2.1.9.2">&lt;R&gt;</span>(Title: Terren Peizer) Terren Scott Peizer dubbed the "Zelig of Wall Street" …</span>
<span class="ltx_p" id="A7.T7.1.1.2.1.10"><span class="ltx_text ltx_font_bold" id="A7.T7.1.1.2.1.10.1">[9]</span>similarity: <span class="ltx_text ltx_font_typewriter" id="A7.T7.1.1.2.1.10.2">&lt;R&gt;</span>(Title: Owens Minor) Owens &amp; Minor () is a Fortune 500 company based in …</span>
<span class="ltx_p" id="A7.T7.1.1.2.1.11"><span class="ltx_text ltx_font_bold" id="A7.T7.1.1.2.1.11.1">[10]</span>similarity: <span class="ltx_text ltx_font_typewriter" id="A7.T7.1.1.2.1.11.2">&lt;R&gt;</span>(Title: Clean Power Finance) Clean Power Finance, headquartered in San Francisco …</span>
<span class="ltx_p" id="A7.T7.1.1.2.1.12"><span class="ltx_text ltx_font_bold" id="A7.T7.1.1.2.1.12.1">LLM’s Response</span></span>
<span class="ltx_p" id="A7.T7.1.1.2.1.13">IT products and services, including storage systems, servers, workstations and data/voice communications equipment and services.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A7.T7.1.3">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A7.T7.1.3.1">LongLLMLingua</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="A7.T7.1.3.2">
<span class="ltx_inline-block ltx_align_top" id="A7.T7.1.3.2.1">
<span class="ltx_p" id="A7.T7.1.3.2.1.1" style="width:346.9pt;"><span class="ltx_text ltx_font_bold" id="A7.T7.1.3.2.1.1.1">Compressed Prompt</span></span>
<span class="ltx_p" id="A7.T7.1.3.2.1.2">(Title: Bordan Tkachuk) Bordan Tkachuk ( ) is a British business executive, the former CEO of Viglen, also known from his appearances on the BBC-produced British version of "The Apprentice," interviewing for his boss Lord Sugar.</span>
<span class="ltx_p" id="A7.T7.1.3.2.1.3">(Title: Cardinal Health) Cardinal Health, Inc. is a Fortune 500 health care services company based in Dublin, Ohio. The company specializes in distribution of pharmaceuticals and medical products, serving more than 100,000 locations. The company also manufactures medical and surgical products, including gloves, surgical apparel and fluid management products. In addition, it operates the nation’s largest network of radiopharmacies. Cardinal Health provides medical products to over 75 percent of hospitals in the United States. In December 2013, it was announced that Cardinal Health would team up with CVS Caremark, which would form the largest generic drug sourcing operation in the United States. The venture was named Red Oak Sourcing and began operations in July 2014.</span>
<span class="ltx_p" id="A7.T7.1.3.2.1.4">(Title Clean Power Finance) Clean Power Finance headquartered in San Francisco, California, is a financial services and software company for the residential solar industry. Clean Power Finance operates the CPF Market, an online business-to-business platform that connects institutional investors and lenders with residential solar professionals who need solar finance products to grow their businesses. Clean Power Finance provides the solar industry with CPF Tools, a solar sales, quoting and design software-as-a-Service (SaaS) solution: qualified residential solar channel partners access finance products through the software. Third-party investors create solar project finance funds; Clean Power Finance provides origination, underwriting and asset management services to the fund investors and markets investor capital to solar professionals as residential finance products, including solar leases and power purchase agreements (PPAs).</span>
<span class="ltx_p" id="A7.T7.1.3.2.1.5">(: Viglen) Viglen IT products and services, including storage systems, servers, workst and/voice communications and services.</span>
<span class="ltx_p" id="A7.T7.1.3.2.1.6">Title: Ow amp; Minor) Owens Minor () Fortune 500 company based Mechanicsville, Virginia, just of Richmond Owens Inc is health logistics specializing ining of healthcare products for hospitals Owens andt́agline is "Connect the World of Medical Product to Point of Care". The company supply chain services to healthcare providers and manufacturers healthcareable supplies as well devices and impl. Owens Minor logistics operations the United States Europe, where three quarters healthcare spending occurs. Ow Minor’ customers span the healthcare market independent hospitals large integrated healthcare networks as well group purchasing organizations, healthcare products manufacturers, the federal government. Owens &amp; Minor is headquartered in Mechanicsville, Virginia and has annualized reven exceeding $9 billion</span>
<span class="ltx_p" id="A7.T7.1.3.2.1.7">:stone Compies) Kingstone Companies,., which its headquarters in Kingston New York, property and casualty insurance …</span>
<span class="ltx_p" id="A7.T7.1.3.2.1.8">:Un) BankUn, Inc., with total consolidated assets $2. billion at December 3 2016, is a bank holding wh owned subsidiary …</span>
<span class="ltx_p" id="A7.T7.1.3.2.1.9">: Compass Minerals) Compass Minerals International, Inc a United public company that its subsidiaries is leading producer …</span>
<span class="ltx_p" id="A7.T7.1.3.2.1.10"><span class="ltx_text ltx_font_bold" id="A7.T7.1.3.2.1.10.1">LLM’s Response</span></span>
<span class="ltx_p" id="A7.T7.1.3.2.1.11"><span class="ltx_text ltx_font_italic" id="A7.T7.1.3.2.1.11.1">No valid answer.</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A7.T7.1.4">
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_r ltx_border_t" id="A7.T7.1.4.1">RECOMP</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_t" id="A7.T7.1.4.2">
<span class="ltx_inline-block ltx_align_top" id="A7.T7.1.4.2.1">
<span class="ltx_p" id="A7.T7.1.4.2.1.1" style="width:346.9pt;"><span class="ltx_text ltx_font_bold" id="A7.T7.1.4.2.1.1.1">Compressed Prompt</span></span>
<span class="ltx_p" id="A7.T7.1.4.2.1.2">Bordan Tkachuk is a British business executive. He was the CEO of Viglen. He was also known from his appearances on the BBC-produced British version of "The Apprentice," interviewing for his boss Lord Sugar. The company provides a variety of products and services. It offers IT products and services, including storage systems, servers, workstations, and data/voice communications equipment and services. The company also provides health care services, indicating a focus on the medical industry. The company manufactures medical and surgical products, including gloves, surgical apparel and fluid management products. …</span>
<span class="ltx_p" id="A7.T7.1.4.2.1.3"><span class="ltx_text ltx_font_bold" id="A7.T7.1.4.2.1.3.1">LLM’s Response</span></span>
<span class="ltx_p" id="A7.T7.1.4.2.1.4">Answer: health care services company</span>
</span>
</td>
</tr>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 7: </span>Case studies of R<sup class="ltx_sup" id="A7.T7.5.1">2</sup>AG and compression-based methods.</figcaption>
</figure>
<figure class="ltx_table" id="A7.T8">
<table class="ltx_tabular ltx_align_middle" id="A7.T8.6">
<tr class="ltx_tr" id="A7.T8.6.7">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="A7.T8.6.7.1"><span class="ltx_text ltx_font_bold" id="A7.T8.6.7.1.1">Case</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_tt" id="A7.T8.6.7.2">
<span class="ltx_inline-block ltx_align_top" id="A7.T8.6.7.2.1">
<span class="ltx_p" id="A7.T8.6.7.2.1.1" style="width:346.9pt;"><span class="ltx_text ltx_font_bold" id="A7.T8.6.7.2.1.1.1">Question</span>:When did the animated series Kent Scott wrote end after beginning in September of 2002 on "Nick on CBS"?</span>
<span class="ltx_p" id="A7.T8.6.7.2.1.2"><span class="ltx_text ltx_font_bold" id="A7.T8.6.7.2.1.2.1">Relevant Documents</span>: 1st, 4th documents</span>
<span class="ltx_p" id="A7.T8.6.7.2.1.3"><span class="ltx_text ltx_font_bold" id="A7.T8.6.7.2.1.3.1">Gold Answer</span>: November</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A7.T8.1.1">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A7.T8.1.1.1">R<sup class="ltx_sup" id="A7.T8.1.1.1.1">2</sup>AG</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="A7.T8.1.1.2">
<span class="ltx_inline-block ltx_align_top" id="A7.T8.1.1.2.1">
<span class="ltx_p" id="A7.T8.1.1.2.1.1" style="width:346.9pt;"><span class="ltx_text ltx_font_bold" id="A7.T8.1.1.2.1.1.1">Input Documents</span></span>
<span class="ltx_p" id="A7.T8.1.1.2.1.2"><span class="ltx_text ltx_font_bold" id="A7.T8.1.1.2.1.2.1">[1]</span>similarity: <span class="ltx_text ltx_font_typewriter" id="A7.T8.1.1.2.1.2.2">&lt;R&gt;</span>(Title: Hawaii Five-0 (2010 TV series)) Hawaii Five-0 is an American action police procedural television series, which premiered on Monday, September 20, 2010 on CBS. The series is a reboot of the original series, which aired on CBS from 1968 to 1980. Like the original, it follows an elite state police task force set up to fight crime in the state of Hawaii. The series is produced by K/O Paper Products and 101st Street Television in association with CBS Productions, originally an in-name-only unit of but folded into CBS Television Studios, which has produced the series since the beginning of season three. On March 25, 2016, CBS renewed the series for a seventh season, which premiered on September 23, 2016. On March 23, 2017, CBS renewed the series for an eighth season, which premiered on September 29, 2017.</span>
<span class="ltx_p" id="A7.T8.1.1.2.1.3"><span class="ltx_text ltx_font_bold" id="A7.T8.1.1.2.1.3.1">[2]</span>similarity: <span class="ltx_text ltx_font_typewriter" id="A7.T8.1.1.2.1.3.2">&lt;R&gt;</span>(Title: Pelswick) Pelswick is an animated television series co-produced …</span>
<span class="ltx_p" id="A7.T8.1.1.2.1.4"><span class="ltx_text ltx_font_bold" id="A7.T8.1.1.2.1.4.1">[3]</span>similarity: <span class="ltx_text ltx_font_typewriter" id="A7.T8.1.1.2.1.4.2">&lt;R&gt;</span>(Title: Kenn Scott) Kenn Scott is a Toronto-based screenwriter noted for …</span>
<span class="ltx_p" id="A7.T8.1.1.2.1.5"><span class="ltx_text ltx_font_bold" id="A7.T8.1.1.2.1.5.1">[4]</span>similarity: <span class="ltx_text ltx_font_typewriter" id="A7.T8.1.1.2.1.5.2">&lt;R&gt;</span>(Title: Scott McCord) William Scott McCord (born April 19, 1971) is a Canadian actor, voice actor, musician, and composer currently based in Brooklyn. A versatile performer, he has appeared in the films "16 Blocks", "Shoot Ém Up", and the animated feature "The Nut Job". On television, he is best known for his voice over work in popular animated series. He plays Dan Kuso in "Bakugan Battle Brawlers", Tetsuya Watarigani in "Beyblade Metal Fusion", Owen and Trent in Fresh Animationś "Total Drama" series, Skull Boy in "Ruby Gloom", McGee in "Camp Lakebottom", and Jake in the animated TVOKids/Nickelodeon television series, "PAW Patrol". He is also Co-Artistic Director of Toronto-based Criminal Theatre, along with playwright and actor Rosa Laborde. In 2016, he won the Canada Screens Award for Best Performance in an Animated Series for his role as Squidgy on Guruś Justin Time. In 2002 he was nominated for a Dora Mavor Moore Award with Best Performance by a Male in Independent Theatre for his performance in Jacob Richmondś The Qualities of Zero. He has released two albums, the solo effort Blues For Sunshine (2009) and Scott McCord and the Bonafide Truth (2012). The latter is also the name of the soul/jazz/blues/rock eight piece band that was created for touring the first album. Scott McCord and the Bonafide Truth were nominated for Best Artist of the Year at the 2010 Maple Blues Awards.</span>
<span class="ltx_p" id="A7.T8.1.1.2.1.6"><span class="ltx_text ltx_font_bold" id="A7.T8.1.1.2.1.6.1">[5]</span>similarity: <span class="ltx_text ltx_font_typewriter" id="A7.T8.1.1.2.1.6.2">&lt;R&gt;</span>(Title: Project G.e.e.K.e.R.) Project G.e.e.K.e.R. is an animated television …</span>
<span class="ltx_p" id="A7.T8.1.1.2.1.7"><span class="ltx_text ltx_font_bold" id="A7.T8.1.1.2.1.7.1">[6]</span>similarity: <span class="ltx_text ltx_font_typewriter" id="A7.T8.1.1.2.1.7.2">&lt;R&gt;</span>(Title: Dora the Explorer) Dora the Explorer is an American educational …</span>
<span class="ltx_p" id="A7.T8.1.1.2.1.8"><span class="ltx_text ltx_font_bold" id="A7.T8.1.1.2.1.8.1">[7]</span>similarity: <span class="ltx_text ltx_font_typewriter" id="A7.T8.1.1.2.1.8.2">&lt;R&gt;</span>(Title: Duane Capizzi) Duane Capizzi is an American writer and television …</span>
<span class="ltx_p" id="A7.T8.1.1.2.1.9"><span class="ltx_text ltx_font_bold" id="A7.T8.1.1.2.1.9.1">[8]</span>similarity: <span class="ltx_text ltx_font_typewriter" id="A7.T8.1.1.2.1.9.2">&lt;R&gt;</span>(Title: Horseland (TV series)) Horseland is an American animated series …</span>
<span class="ltx_p" id="A7.T8.1.1.2.1.10"><span class="ltx_text ltx_font_bold" id="A7.T8.1.1.2.1.10.1">[9]</span>similarity: <span class="ltx_text ltx_font_typewriter" id="A7.T8.1.1.2.1.10.2">&lt;R&gt;</span>(Title: Henry Gilroy) Henry Gilroy is an American television screenwriter …</span>
<span class="ltx_p" id="A7.T8.1.1.2.1.11"><span class="ltx_text ltx_font_bold" id="A7.T8.1.1.2.1.11.1">[10]</span>similarity: <span class="ltx_text ltx_font_typewriter" id="A7.T8.1.1.2.1.11.2">&lt;R&gt;</span>(Title: David W. Zucker) David W. Zucker is President of Television …</span>
<span class="ltx_p" id="A7.T8.1.1.2.1.12"><span class="ltx_text ltx_font_bold" id="A7.T8.1.1.2.1.12.1">LLM’s Response</span></span>
<span class="ltx_p" id="A7.T8.1.1.2.1.13">November of that year.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A7.T8.2.2">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A7.T8.2.2.1">LLaMA2<sub class="ltx_sub" id="A7.T8.2.2.1.1"><span class="ltx_text ltx_font_italic" id="A7.T8.2.2.1.1.1">7B</span></sub>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="A7.T8.2.2.2">
<span class="ltx_inline-block ltx_align_top" id="A7.T8.2.2.2.1">
<span class="ltx_p" id="A7.T8.2.2.2.1.1" style="width:346.9pt;"><span class="ltx_text ltx_font_bold" id="A7.T8.2.2.2.1.1.1">Input Documents</span></span>
<span class="ltx_p" id="A7.T8.2.2.2.1.2"><span class="ltx_text ltx_font_italic" id="A7.T8.2.2.2.1.2.1">As above but without retrieval information.</span></span>
<span class="ltx_p" id="A7.T8.2.2.2.1.3"><span class="ltx_text ltx_font_bold" id="A7.T8.2.2.2.1.3.1">LLM’s Response</span></span>
<span class="ltx_p" id="A7.T8.2.2.2.1.4">Pelswick</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A7.T8.6.8">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="A7.T8.6.8.1"><span class="ltx_text ltx_font_bold" id="A7.T8.6.8.1.1">Case</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_tt" id="A7.T8.6.8.2">
<span class="ltx_inline-block ltx_align_top" id="A7.T8.6.8.2.1">
<span class="ltx_p" id="A7.T8.6.8.2.1.1" style="width:346.9pt;"><span class="ltx_text ltx_font_bold" id="A7.T8.6.8.2.1.1.1">Question</span>:When was the female co-founder of the organization that published the "Daily Word" devotional born?</span>
<span class="ltx_p" id="A7.T8.6.8.2.1.2"><span class="ltx_text ltx_font_bold" id="A7.T8.6.8.2.1.2.1">Relevant Documents</span>: 2nd, 3rd documents</span>
<span class="ltx_p" id="A7.T8.6.8.2.1.3"><span class="ltx_text ltx_font_bold" id="A7.T8.6.8.2.1.3.1">Gold Answer</span>: August 6, 1845</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A7.T8.3.3">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A7.T8.3.3.1">R<sup class="ltx_sup" id="A7.T8.3.3.1.1">2</sup>AG</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="A7.T8.3.3.2">
<span class="ltx_inline-block ltx_align_top" id="A7.T8.3.3.2.1">
<span class="ltx_p" id="A7.T8.3.3.2.1.1" style="width:346.9pt;"><span class="ltx_text ltx_font_bold" id="A7.T8.3.3.2.1.1.1">Input Documents</span></span>
<span class="ltx_p" id="A7.T8.3.3.2.1.2"><span class="ltx_text ltx_font_bold" id="A7.T8.3.3.2.1.2.1">[1]</span>similarity: <span class="ltx_text ltx_font_typewriter" id="A7.T8.3.3.2.1.2.2">&lt;R&gt;</span>(Title: The Word For Today) The Word For Today (known as The Word For You Today in some countries) …</span>
<span class="ltx_p" id="A7.T8.3.3.2.1.3"><span class="ltx_text ltx_font_bold" id="A7.T8.3.3.2.1.3.1">[2]</span>similarity: <span class="ltx_text ltx_font_typewriter" id="A7.T8.3.3.2.1.3.2">&lt;R&gt;</span>(Title: Unity Church) Unity, known informally as Unity Church, is a New Thought Christian organization that publishes the "Daily Word" devotional publication. It describes itself as a "positive, practical Christianity" which "teach[es] the effective daily application of the principles of Truth taught and exemplified by Jesus Christ" and promotes "a way of life that leads to health, prosperity, happiness, and peace of mind."</span>
<span class="ltx_p" id="A7.T8.3.3.2.1.4"><span class="ltx_text ltx_font_bold" id="A7.T8.3.3.2.1.4.1">[3]</span>similarity: <span class="ltx_text ltx_font_typewriter" id="A7.T8.3.3.2.1.4.2">&lt;R&gt;</span>(Title: Myrtle Fillmore) Mary Caroline "Myrtle" Page Fillmore (August 6, 1845 - October 6, 1931) was co-founder of Unity, a church within the New Thought Christian movement, along with her husband Charles Fillmore. Prior to that time, she worked as a schoolteacher.</span>
<span class="ltx_p" id="A7.T8.3.3.2.1.5"><span class="ltx_text ltx_font_bold" id="A7.T8.3.3.2.1.5.1">[4]</span>similarity: <span class="ltx_text ltx_font_typewriter" id="A7.T8.3.3.2.1.5.2">&lt;R&gt;</span>(Title: Daily Word) The Daily Word is a daily inspirational message provided …</span>
<span class="ltx_p" id="A7.T8.3.3.2.1.6"><span class="ltx_text ltx_font_bold" id="A7.T8.3.3.2.1.6.1">[5]</span>similarity: <span class="ltx_text ltx_font_typewriter" id="A7.T8.3.3.2.1.6.2">&lt;R&gt;</span>(Title: My Utmost for His Highest) My Utmost for His Highest is a daily devotional by …</span>
<span class="ltx_p" id="A7.T8.3.3.2.1.7"><span class="ltx_text ltx_font_bold" id="A7.T8.3.3.2.1.7.1">[6]</span>similarity: <span class="ltx_text ltx_font_typewriter" id="A7.T8.3.3.2.1.7.2">&lt;R&gt;</span>(Title: Our Daily Bread Ministries) Our Daily Bread Ministries (formerly RBC Ministries) is …</span>
<span class="ltx_p" id="A7.T8.3.3.2.1.8"><span class="ltx_text ltx_font_bold" id="A7.T8.3.3.2.1.8.1">[7]</span>similarity: <span class="ltx_text ltx_font_typewriter" id="A7.T8.3.3.2.1.8.2">&lt;R&gt;</span>(Title: Daily Light on the Daily Path) Daily Light on the Daily Path or Daily Light is …</span>
<span class="ltx_p" id="A7.T8.3.3.2.1.9"><span class="ltx_text ltx_font_bold" id="A7.T8.3.3.2.1.9.1">[8]</span>similarity: <span class="ltx_text ltx_font_typewriter" id="A7.T8.3.3.2.1.9.2">&lt;R&gt;</span>(Title: Our Daily Bread) Our Daily Bread is a devotional calendar-style booklet …</span>
<span class="ltx_p" id="A7.T8.3.3.2.1.10"><span class="ltx_text ltx_font_bold" id="A7.T8.3.3.2.1.10.1">[9]</span>similarity: <span class="ltx_text ltx_font_typewriter" id="A7.T8.3.3.2.1.10.2">&lt;R&gt;</span>(Title: The Clear Word) The Clear Word, originally published in March 1994 as …</span>
<span class="ltx_p" id="A7.T8.3.3.2.1.11"><span class="ltx_text ltx_font_bold" id="A7.T8.3.3.2.1.11.1">[10]</span>similarity: <span class="ltx_text ltx_font_typewriter" id="A7.T8.3.3.2.1.11.2">&lt;R&gt;</span>(Title: Weili Dai) Weili Dai () is a Chinese-born American businesswoman. She is the Director, …</span>
<span class="ltx_p" id="A7.T8.3.3.2.1.12"><span class="ltx_text ltx_font_bold" id="A7.T8.3.3.2.1.12.1">LLM’s Response</span></span>
<span class="ltx_p" id="A7.T8.3.3.2.1.13">August 6, 1845"</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A7.T8.4.4">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A7.T8.4.4.1">LLaMA2<sub class="ltx_sub" id="A7.T8.4.4.1.1"><span class="ltx_text ltx_font_italic" id="A7.T8.4.4.1.1.1">7B</span></sub>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="A7.T8.4.4.2">
<span class="ltx_inline-block ltx_align_top" id="A7.T8.4.4.2.1">
<span class="ltx_p" id="A7.T8.4.4.2.1.1" style="width:346.9pt;"><span class="ltx_text ltx_font_bold" id="A7.T8.4.4.2.1.1.1">Input Documents</span></span>
<span class="ltx_p" id="A7.T8.4.4.2.1.2"><span class="ltx_text ltx_font_italic" id="A7.T8.4.4.2.1.2.1">As above but without retrieval information.</span></span>
<span class="ltx_p" id="A7.T8.4.4.2.1.3"><span class="ltx_text ltx_font_bold" id="A7.T8.4.4.2.1.3.1">LLM’s Response</span></span>
<span class="ltx_p" id="A7.T8.4.4.2.1.4">The female co-founder of the organization that published the "Daily Word" devotional was born on 1952-09-20.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A7.T8.6.9">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="A7.T8.6.9.1"><span class="ltx_text ltx_font_bold" id="A7.T8.6.9.1.1">Case</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_tt" id="A7.T8.6.9.2">
<span class="ltx_inline-block ltx_align_top" id="A7.T8.6.9.2.1">
<span class="ltx_p" id="A7.T8.6.9.2.1.1" style="width:346.9pt;"><span class="ltx_text ltx_font_bold" id="A7.T8.6.9.2.1.1.1">Question</span>:What pop band features an Argentine actress that appeared in the television series "Chiquititas"?</span>
<span class="ltx_p" id="A7.T8.6.9.2.1.2"><span class="ltx_text ltx_font_bold" id="A7.T8.6.9.2.1.2.1">Relevant Documents</span>: 1st, 4th documents</span>
<span class="ltx_p" id="A7.T8.6.9.2.1.3"><span class="ltx_text ltx_font_bold" id="A7.T8.6.9.2.1.3.1">Gold Answer</span>: Erreway</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A7.T8.5.5">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A7.T8.5.5.1">R<sup class="ltx_sup" id="A7.T8.5.5.1.1">2</sup>AG</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="A7.T8.5.5.2">
<span class="ltx_inline-block ltx_align_top" id="A7.T8.5.5.2.1">
<span class="ltx_p" id="A7.T8.5.5.2.1.1" style="width:346.9pt;"><span class="ltx_text ltx_font_bold" id="A7.T8.5.5.2.1.1.1">Input Documents</span></span>
<span class="ltx_p" id="A7.T8.5.5.2.1.2"><span class="ltx_text ltx_font_bold" id="A7.T8.5.5.2.1.2.1">[1]</span>similarity: <span class="ltx_text ltx_font_typewriter" id="A7.T8.5.5.2.1.2.2">&lt;R&gt;</span>(Title: Luisana Lopilato) Luisana Lopilato ] (born May 18, 1987) is an Argentine actress and model. She has appeared in the television series "Chiquititas", "Rebelde Way", "Alma Pirata", "Casados con Hijos" and "Atracción x4".</span>
<span class="ltx_p" id="A7.T8.5.5.2.1.3"><span class="ltx_text ltx_font_bold" id="A7.T8.5.5.2.1.3.1">[2]</span>similarity: <span class="ltx_text ltx_font_typewriter" id="A7.T8.5.5.2.1.3.2">&lt;R&gt;</span>(Title: Celeste Cid) María Celeste Cid (] ; born 19 January 1984) is an …</span>
<span class="ltx_p" id="A7.T8.5.5.2.1.4"><span class="ltx_text ltx_font_bold" id="A7.T8.5.5.2.1.4.1">[3]</span>similarity: <span class="ltx_text ltx_font_typewriter" id="A7.T8.5.5.2.1.4.2">&lt;R&gt;</span>(Title: Nadia Di Cello) Nadia Mariel Di Cello (] ; born January 20, 1989 …</span>
<span class="ltx_p" id="A7.T8.5.5.2.1.5"><span class="ltx_text ltx_font_bold" id="A7.T8.5.5.2.1.5.1">[4]</span>similarity: <span class="ltx_text ltx_font_typewriter" id="A7.T8.5.5.2.1.5.2">&lt;R&gt;</span>(Title: Camila Bordonaba) Camila Bordonaba Roldán (] ; born September 4, 1984 in El Palomar, Buenos Aires, Argentina) (nicknamed Cami or Cato) is an Argentine actress, singer-songwriter, dancer, musician, Theatre director and former occasional model. She is best known for her roles in "Chiquititas", "Rebelde Way", "Son de Fierro" and "Atracción x4" and as a member of Argentine band Erreway.</span>
<span class="ltx_p" id="A7.T8.5.5.2.1.6"><span class="ltx_text ltx_font_bold" id="A7.T8.5.5.2.1.6.1">[5]</span>similarity: <span class="ltx_text ltx_font_typewriter" id="A7.T8.5.5.2.1.6.2">&lt;R&gt;</span>(Title: Milagros Flores) María de los Milagros Flores (born 26 April 1990 …</span>
<span class="ltx_p" id="A7.T8.5.5.2.1.7"><span class="ltx_text ltx_font_bold" id="A7.T8.5.5.2.1.7.1">[6]</span>similarity: <span class="ltx_text ltx_font_typewriter" id="A7.T8.5.5.2.1.7.2">&lt;R&gt;</span>(Title: Romina Yan) Romina Yankelevich (5 September 1974 – 28 September 2010) …</span>
<span class="ltx_p" id="A7.T8.5.5.2.1.8"><span class="ltx_text ltx_font_bold" id="A7.T8.5.5.2.1.8.1">[7]</span>similarity: <span class="ltx_text ltx_font_typewriter" id="A7.T8.5.5.2.1.8.2">&lt;R&gt;</span>(Title: Sweet Baby (Erreway song)) "Sweet Baby" is the debut single …</span>
<span class="ltx_p" id="A7.T8.5.5.2.1.9"><span class="ltx_text ltx_font_bold" id="A7.T8.5.5.2.1.9.1">[8]</span>similarity: <span class="ltx_text ltx_font_typewriter" id="A7.T8.5.5.2.1.9.2">&lt;R&gt;</span>(Title: Marcela Kloosterboer) Marcela Kloosterboer (born 5 July 1983) is …</span>
<span class="ltx_p" id="A7.T8.5.5.2.1.10"><span class="ltx_text ltx_font_bold" id="A7.T8.5.5.2.1.10.1">[9]</span>similarity: <span class="ltx_text ltx_font_typewriter" id="A7.T8.5.5.2.1.10.2">&lt;R&gt;</span>(Title: Mili Urién) Milagros Urién, simply known as Mili, is a fictional …</span>
<span class="ltx_p" id="A7.T8.5.5.2.1.11"><span class="ltx_text ltx_font_bold" id="A7.T8.5.5.2.1.11.1">[10]</span>similarity: <span class="ltx_text ltx_font_typewriter" id="A7.T8.5.5.2.1.11.2">&lt;R&gt;</span>(Title: Rincón de Luz (orphanage)) Rincón de Luz is a fictional orphanage and …</span>
<span class="ltx_p" id="A7.T8.5.5.2.1.12"><span class="ltx_text ltx_font_bold" id="A7.T8.5.5.2.1.12.1">LLM’s Response</span></span>
<span class="ltx_p" id="A7.T8.5.5.2.1.13">Erreway</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A7.T8.6.6">
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_r ltx_border_t" id="A7.T8.6.6.1">LLaMA2<sub class="ltx_sub" id="A7.T8.6.6.1.1"><span class="ltx_text ltx_font_italic" id="A7.T8.6.6.1.1.1">7B</span></sub>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_t" id="A7.T8.6.6.2">
<span class="ltx_inline-block ltx_align_top" id="A7.T8.6.6.2.1">
<span class="ltx_p" id="A7.T8.6.6.2.1.1" style="width:346.9pt;"><span class="ltx_text ltx_font_bold" id="A7.T8.6.6.2.1.1.1">Input Documents</span></span>
<span class="ltx_p" id="A7.T8.6.6.2.1.2"><span class="ltx_text ltx_font_italic" id="A7.T8.6.6.2.1.2.1">As above but without retrieval information.</span></span>
<span class="ltx_p" id="A7.T8.6.6.2.1.3"><span class="ltx_text ltx_font_bold" id="A7.T8.6.6.2.1.3.1">LLM’s Response</span></span>
<span class="ltx_p" id="A7.T8.6.6.2.1.4">Luisana Lopilato</span>
</span>
</td>
</tr>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 8: </span>Case studies of R<sup class="ltx_sup" id="A7.T8.10.1">2</sup>AG.</figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Wed Jun 19 06:05:58 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
